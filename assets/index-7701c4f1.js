function _mergeNamespaces(a,o){for(var _e=0;_e<o.length;_e++){const et=o[_e];if(typeof et!="string"&&!Array.isArray(et)){for(const rt in et)if(rt!=="default"&&!(rt in a)){const lt=Object.getOwnPropertyDescriptor(et,rt);lt&&Object.defineProperty(a,rt,lt.get?lt:{enumerable:!0,get:()=>et[rt]})}}}return Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const rt of document.querySelectorAll('link[rel="modulepreload"]'))et(rt);new MutationObserver(rt=>{for(const lt of rt)if(lt.type==="childList")for(const it of lt.addedNodes)it.tagName==="LINK"&&it.rel==="modulepreload"&&et(it)}).observe(document,{childList:!0,subtree:!0});function _e(rt){const lt={};return rt.integrity&&(lt.integrity=rt.integrity),rt.referrerPolicy&&(lt.referrerPolicy=rt.referrerPolicy),rt.crossOrigin==="use-credentials"?lt.credentials="include":rt.crossOrigin==="anonymous"?lt.credentials="omit":lt.credentials="same-origin",lt}function et(rt){if(rt.ep)return;rt.ep=!0;const lt=_e(rt);fetch(rt.href,lt)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$3=Symbol.for("react.element"),n$3=Symbol.for("react.portal"),p$4=Symbol.for("react.fragment"),q$4=Symbol.for("react.strict_mode"),r$2=Symbol.for("react.profiler"),t$2=Symbol.for("react.provider"),u$2=Symbol.for("react.context"),v$4=Symbol.for("react.forward_ref"),w$3=Symbol.for("react.suspense"),x$2=Symbol.for("react.memo"),y$2=Symbol.for("react.lazy"),z$3=Symbol.iterator;function A$4(a){return a===null||typeof a!="object"?null:(a=z$3&&a[z$3]||a["@@iterator"],typeof a=="function"?a:null)}var B$2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$2={};function E$1(a,o,_e){this.props=a,this.context=o,this.refs=D$2,this.updater=_e||B$2}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(a,o){if(typeof a!="object"&&typeof a!="function"&&a!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,a,o,"setState")};E$1.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};function F$1(){}F$1.prototype=E$1.prototype;function G$2(a,o,_e){this.props=a,this.context=o,this.refs=D$2,this.updater=_e||B$2}var H$1=G$2.prototype=new F$1;H$1.constructor=G$2;C$2(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$2=Array.isArray,J=Object.prototype.hasOwnProperty,K$2={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$2(a,o,_e){var et,rt={},lt=null,it=null;if(o!=null)for(et in o.ref!==void 0&&(it=o.ref),o.key!==void 0&&(lt=""+o.key),o)J.call(o,et)&&!L$1.hasOwnProperty(et)&&(rt[et]=o[et]);var ut=arguments.length-2;if(ut===1)rt.children=_e;else if(1<ut){for(var s=Array(ut),tt=0;tt<ut;tt++)s[tt]=arguments[tt+2];rt.children=s}if(a&&a.defaultProps)for(et in ut=a.defaultProps,ut)rt[et]===void 0&&(rt[et]=ut[et]);return{$$typeof:l$3,type:a,key:lt,ref:it,props:rt,_owner:K$2.current}}function N$3(a,o){return{$$typeof:l$3,type:a.type,key:o,ref:a.ref,props:a.props,_owner:a._owner}}function O$2(a){return typeof a=="object"&&a!==null&&a.$$typeof===l$3}function escape$1(a){var o={"=":"=0",":":"=2"};return"$"+a.replace(/[=:]/g,function(_e){return o[_e]})}var P$1=/\/+/g;function Q$2(a,o){return typeof a=="object"&&a!==null&&a.key!=null?escape$1(""+a.key):o.toString(36)}function R$2(a,o,_e,et,rt){var lt=typeof a;(lt==="undefined"||lt==="boolean")&&(a=null);var it=!1;if(a===null)it=!0;else switch(lt){case"string":case"number":it=!0;break;case"object":switch(a.$$typeof){case l$3:case n$3:it=!0}}if(it)return it=a,rt=rt(it),a=et===""?"."+Q$2(it,0):et,I$2(rt)?(_e="",a!=null&&(_e=a.replace(P$1,"$&/")+"/"),R$2(rt,o,_e,"",function(tt){return tt})):rt!=null&&(O$2(rt)&&(rt=N$3(rt,_e+(!rt.key||it&&it.key===rt.key?"":(""+rt.key).replace(P$1,"$&/")+"/")+a)),o.push(rt)),1;if(it=0,et=et===""?".":et+":",I$2(a))for(var ut=0;ut<a.length;ut++){lt=a[ut];var s=et+Q$2(lt,ut);it+=R$2(lt,o,_e,s,rt)}else if(s=A$4(a),typeof s=="function")for(a=s.call(a),ut=0;!(lt=a.next()).done;)lt=lt.value,s=et+Q$2(lt,ut++),it+=R$2(lt,o,_e,s,rt);else if(lt==="object")throw o=String(a),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return it}function S$3(a,o,_e){if(a==null)return a;var et=[],rt=0;return R$2(a,et,"","",function(lt){return o.call(_e,lt,rt++)}),et}function T$1(a){if(a._status===-1){var o=a._result;o=o(),o.then(function(_e){(a._status===0||a._status===-1)&&(a._status=1,a._result=_e)},function(_e){(a._status===0||a._status===-1)&&(a._status=2,a._result=_e)}),a._status===-1&&(a._status=0,a._result=o)}if(a._status===1)return a._result.default;throw a._result}var U$1={current:null},V$1={transition:null},W$2={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$2};react_production_min.Children={map:S$3,forEach:function(a,o,_e){S$3(a,function(){o.apply(this,arguments)},_e)},count:function(a){var o=0;return S$3(a,function(){o++}),o},toArray:function(a){return S$3(a,function(o){return o})||[]},only:function(a){if(!O$2(a))throw Error("React.Children.only expected to receive a single React element child.");return a}};react_production_min.Component=E$1;react_production_min.Fragment=p$4;react_production_min.Profiler=r$2;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$4;react_production_min.Suspense=w$3;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.cloneElement=function(a,o,_e){if(a==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+a+".");var et=C$2({},a.props),rt=a.key,lt=a.ref,it=a._owner;if(o!=null){if(o.ref!==void 0&&(lt=o.ref,it=K$2.current),o.key!==void 0&&(rt=""+o.key),a.type&&a.type.defaultProps)var ut=a.type.defaultProps;for(s in o)J.call(o,s)&&!L$1.hasOwnProperty(s)&&(et[s]=o[s]===void 0&&ut!==void 0?ut[s]:o[s])}var s=arguments.length-2;if(s===1)et.children=_e;else if(1<s){ut=Array(s);for(var tt=0;tt<s;tt++)ut[tt]=arguments[tt+2];et.children=ut}return{$$typeof:l$3,type:a.type,key:rt,ref:lt,props:et,_owner:it}};react_production_min.createContext=function(a){return a={$$typeof:u$2,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},a.Provider={$$typeof:t$2,_context:a},a.Consumer=a};react_production_min.createElement=M$2;react_production_min.createFactory=function(a){var o=M$2.bind(null,a);return o.type=a,o};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(a){return{$$typeof:v$4,render:a}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(a){return{$$typeof:y$2,_payload:{_status:-1,_result:a},_init:T$1}};react_production_min.memo=function(a,o){return{$$typeof:x$2,type:a,compare:o===void 0?null:o}};react_production_min.startTransition=function(a){var o=V$1.transition;V$1.transition={};try{a()}finally{V$1.transition=o}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(a,o){return U$1.current.useCallback(a,o)};react_production_min.useContext=function(a){return U$1.current.useContext(a)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(a){return U$1.current.useDeferredValue(a)};react_production_min.useEffect=function(a,o){return U$1.current.useEffect(a,o)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(a,o,_e){return U$1.current.useImperativeHandle(a,o,_e)};react_production_min.useInsertionEffect=function(a,o){return U$1.current.useInsertionEffect(a,o)};react_production_min.useLayoutEffect=function(a,o){return U$1.current.useLayoutEffect(a,o)};react_production_min.useMemo=function(a,o){return U$1.current.useMemo(a,o)};react_production_min.useReducer=function(a,o,_e){return U$1.current.useReducer(a,o,_e)};react_production_min.useRef=function(a){return U$1.current.useRef(a)};react_production_min.useState=function(a){return U$1.current.useState(a)};react_production_min.useSyncExternalStore=function(a,o,_e){return U$1.current.useSyncExternalStore(a,o,_e)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;const React$1=getDefaultExportFromCjs(reactExports),React$2=_mergeNamespaces({__proto__:null,default:React$1},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$2=reactExports,k$2=Symbol.for("react.element"),l$2=Symbol.for("react.fragment"),m$4=Object.prototype.hasOwnProperty,n$2=f$2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$3={key:!0,ref:!0,__self:!0,__source:!0};function q$3(a,o,_e){var et,rt={},lt=null,it=null;_e!==void 0&&(lt=""+_e),o.key!==void 0&&(lt=""+o.key),o.ref!==void 0&&(it=o.ref);for(et in o)m$4.call(o,et)&&!p$3.hasOwnProperty(et)&&(rt[et]=o[et]);if(a&&a.defaultProps)for(et in o=a.defaultProps,o)rt[et]===void 0&&(rt[et]=o[et]);return{$$typeof:k$2,type:a,key:lt,ref:it,props:rt,_owner:n$2.current}}reactJsxRuntime_production_min.Fragment=l$2;reactJsxRuntime_production_min.jsx=q$3;reactJsxRuntime_production_min.jsxs=q$3;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(a){function o(Gt,fn){var Cn=Gt.length;Gt.push(fn);e:for(;0<Cn;){var Tn=Cn-1>>>1,dn=Gt[Tn];if(0<rt(dn,fn))Gt[Tn]=fn,Gt[Cn]=dn,Cn=Tn;else break e}}function _e(Gt){return Gt.length===0?null:Gt[0]}function et(Gt){if(Gt.length===0)return null;var fn=Gt[0],Cn=Gt.pop();if(Cn!==fn){Gt[0]=Cn;e:for(var Tn=0,dn=Gt.length,mn=dn>>>1;Tn<mn;){var yn=2*(Tn+1)-1,pn=Gt[yn],In=yn+1,On=Gt[In];if(0>rt(pn,Cn))In<dn&&0>rt(On,pn)?(Gt[Tn]=On,Gt[In]=Cn,Tn=In):(Gt[Tn]=pn,Gt[yn]=Cn,Tn=yn);else if(In<dn&&0>rt(On,Cn))Gt[Tn]=On,Gt[In]=Cn,Tn=In;else break e}}return fn}function rt(Gt,fn){var Cn=Gt.sortIndex-fn.sortIndex;return Cn!==0?Cn:Gt.id-fn.id}if(typeof performance=="object"&&typeof performance.now=="function"){var lt=performance;a.unstable_now=function(){return lt.now()}}else{var it=Date,ut=it.now();a.unstable_now=function(){return it.now()-ut}}var s=[],tt=[],ot=1,ct=null,yt=3,pt=!1,gt=!1,st=!1,ft=typeof setTimeout=="function"?setTimeout:null,at=typeof clearTimeout=="function"?clearTimeout:null,ht=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function mt(Gt){for(var fn=_e(tt);fn!==null;){if(fn.callback===null)et(tt);else if(fn.startTime<=Gt)et(tt),fn.sortIndex=fn.expirationTime,o(s,fn);else break;fn=_e(tt)}}function St(Gt){if(st=!1,mt(Gt),!gt)if(_e(s)!==null)gt=!0,gn(It);else{var fn=_e(tt);fn!==null&&tn(St,fn.startTime-Gt)}}function It(Gt,fn){gt=!1,st&&(st=!1,at(Nt),Nt=-1),pt=!0;var Cn=yt;try{for(mt(fn),ct=_e(s);ct!==null&&(!(ct.expirationTime>fn)||Gt&&!bt());){var Tn=ct.callback;if(typeof Tn=="function"){ct.callback=null,yt=ct.priorityLevel;var dn=Tn(ct.expirationTime<=fn);fn=a.unstable_now(),typeof dn=="function"?ct.callback=dn:ct===_e(s)&&et(s),mt(fn)}else et(s);ct=_e(s)}if(ct!==null)var mn=!0;else{var yn=_e(tt);yn!==null&&tn(St,yn.startTime-fn),mn=!1}return mn}finally{ct=null,yt=Cn,pt=!1}}var xt=!1,At=null,Nt=-1,kt=5,Mt=-1;function bt(){return!(a.unstable_now()-Mt<kt)}function Bt(){if(At!==null){var Gt=a.unstable_now();Mt=Gt;var fn=!0;try{fn=At(!0,Gt)}finally{fn?Ht():(xt=!1,At=null)}}else xt=!1}var Ht;if(typeof ht=="function")Ht=function(){ht(Bt)};else if(typeof MessageChannel<"u"){var Wt=new MessageChannel,nn=Wt.port2;Wt.port1.onmessage=Bt,Ht=function(){nn.postMessage(null)}}else Ht=function(){ft(Bt,0)};function gn(Gt){At=Gt,xt||(xt=!0,Ht())}function tn(Gt,fn){Nt=ft(function(){Gt(a.unstable_now())},fn)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(Gt){Gt.callback=null},a.unstable_continueExecution=function(){gt||pt||(gt=!0,gn(It))},a.unstable_forceFrameRate=function(Gt){0>Gt||125<Gt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):kt=0<Gt?Math.floor(1e3/Gt):5},a.unstable_getCurrentPriorityLevel=function(){return yt},a.unstable_getFirstCallbackNode=function(){return _e(s)},a.unstable_next=function(Gt){switch(yt){case 1:case 2:case 3:var fn=3;break;default:fn=yt}var Cn=yt;yt=fn;try{return Gt()}finally{yt=Cn}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(Gt,fn){switch(Gt){case 1:case 2:case 3:case 4:case 5:break;default:Gt=3}var Cn=yt;yt=Gt;try{return fn()}finally{yt=Cn}},a.unstable_scheduleCallback=function(Gt,fn,Cn){var Tn=a.unstable_now();switch(typeof Cn=="object"&&Cn!==null?(Cn=Cn.delay,Cn=typeof Cn=="number"&&0<Cn?Tn+Cn:Tn):Cn=Tn,Gt){case 1:var dn=-1;break;case 2:dn=250;break;case 5:dn=1073741823;break;case 4:dn=1e4;break;default:dn=5e3}return dn=Cn+dn,Gt={id:ot++,callback:fn,priorityLevel:Gt,startTime:Cn,expirationTime:dn,sortIndex:-1},Cn>Tn?(Gt.sortIndex=Cn,o(tt,Gt),_e(s)===null&&Gt===_e(tt)&&(st?(at(Nt),Nt=-1):st=!0,tn(St,Cn-Tn))):(Gt.sortIndex=dn,o(s,Gt),gt||pt||(gt=!0,gn(It))),Gt},a.unstable_shouldYield=bt,a.unstable_wrapCallback=function(Gt){var fn=yt;return function(){var Cn=yt;yt=fn;try{return Gt.apply(this,arguments)}finally{yt=Cn}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$2(a){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+a,_e=1;_e<arguments.length;_e++)o+="&args[]="+encodeURIComponent(arguments[_e]);return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(a,o){ha(a,o),ha(a+"Capture",o)}function ha(a,o){for(ea[a]=o,a=0;a<o.length;a++)da.add(o[a])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(a){return ja.call(ma,a)?!0:ja.call(la,a)?!1:ka.test(a)?ma[a]=!0:(la[a]=!0,!1)}function pa(a,o,_e,et){if(_e!==null&&_e.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return et?!1:_e!==null?!_e.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function qa(a,o,_e,et){if(o===null||typeof o>"u"||pa(a,o,_e,et))return!0;if(et)return!1;if(_e!==null)switch(_e.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function v$3(a,o,_e,et,rt,lt,it){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=et,this.attributeNamespace=rt,this.mustUseProperty=_e,this.propertyName=a,this.type=o,this.sanitizeURL=lt,this.removeEmptyString=it}var z$2={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){z$2[a]=new v$3(a,0,!1,a,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var o=a[0];z$2[o]=new v$3(o,1,!1,a[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){z$2[a]=new v$3(a,2,!1,a.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){z$2[a]=new v$3(a,2,!1,a,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){z$2[a]=new v$3(a,3,!1,a.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(a){z$2[a]=new v$3(a,3,!0,a,null,!1,!1)});["capture","download"].forEach(function(a){z$2[a]=new v$3(a,4,!1,a,null,!1,!1)});["cols","rows","size","span"].forEach(function(a){z$2[a]=new v$3(a,6,!1,a,null,!1,!1)});["rowSpan","start"].forEach(function(a){z$2[a]=new v$3(a,5,!1,a.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var o=a.replace(ra,sa);z$2[o]=new v$3(o,1,!1,a,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var o=a.replace(ra,sa);z$2[o]=new v$3(o,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var o=a.replace(ra,sa);z$2[o]=new v$3(o,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(a){z$2[a]=new v$3(a,1,!1,a.toLowerCase(),null,!1,!1)});z$2.xlinkHref=new v$3("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(a){z$2[a]=new v$3(a,1,!1,a.toLowerCase(),null,!0,!0)});function ta(a,o,_e,et){var rt=z$2.hasOwnProperty(o)?z$2[o]:null;(rt!==null?rt.type!==0:et||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(qa(o,_e,rt,et)&&(_e=null),et||rt===null?oa(o)&&(_e===null?a.removeAttribute(o):a.setAttribute(o,""+_e)):rt.mustUseProperty?a[rt.propertyName]=_e===null?rt.type===3?!1:"":_e:(o=rt.attributeName,et=rt.attributeNamespace,_e===null?a.removeAttribute(o):(rt=rt.type,_e=rt===3||rt===4&&_e===!0?"":""+_e,et?a.setAttributeNS(et,o,_e):a.setAttribute(o,_e))))}var ua$1=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(a){return a===null||typeof a!="object"?null:(a=Ja&&a[Ja]||a["@@iterator"],typeof a=="function"?a:null)}var A$3=Object.assign,La;function Ma(a){if(La===void 0)try{throw Error()}catch(_e){var o=_e.stack.trim().match(/\n( *(at )?)/);La=o&&o[1]||""}return`
`+La+a}var Na=!1;function Oa(a,o){if(!a||Na)return"";Na=!0;var _e=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(tt){var et=tt}Reflect.construct(a,[],o)}else{try{o.call()}catch(tt){et=tt}a.call(o.prototype)}else{try{throw Error()}catch(tt){et=tt}a()}}catch(tt){if(tt&&et&&typeof tt.stack=="string"){for(var rt=tt.stack.split(`
`),lt=et.stack.split(`
`),it=rt.length-1,ut=lt.length-1;1<=it&&0<=ut&&rt[it]!==lt[ut];)ut--;for(;1<=it&&0<=ut;it--,ut--)if(rt[it]!==lt[ut]){if(it!==1||ut!==1)do if(it--,ut--,0>ut||rt[it]!==lt[ut]){var s=`
`+rt[it].replace(" at new "," at ");return a.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",a.displayName)),s}while(1<=it&&0<=ut);break}}}finally{Na=!1,Error.prepareStackTrace=_e}return(a=a?a.displayName||a.name:"")?Ma(a):""}function Pa(a){switch(a.tag){case 5:return Ma(a.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return a=Oa(a.type,!1),a;case 11:return a=Oa(a.type.render,!1),a;case 1:return a=Oa(a.type,!0),a;default:return""}}function Qa(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case Ca:return(a.displayName||"Context")+".Consumer";case Ba:return(a._context.displayName||"Context")+".Provider";case Da:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Ga:return o=a.displayName||null,o!==null?o:Qa(a.type)||"Memo";case Ha:o=a._payload,a=a._init;try{return Qa(a(o))}catch{}}return null}function Ra(a){var o=a.type;switch(a.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=o.render,a=a.displayName||a.name||"",o.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(o);case 8:return o===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Sa(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ta(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ua(a){var o=Ta(a)?"checked":"value",_e=Object.getOwnPropertyDescriptor(a.constructor.prototype,o),et=""+a[o];if(!a.hasOwnProperty(o)&&typeof _e<"u"&&typeof _e.get=="function"&&typeof _e.set=="function"){var rt=_e.get,lt=_e.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return rt.call(this)},set:function(it){et=""+it,lt.call(this,it)}}),Object.defineProperty(a,o,{enumerable:_e.enumerable}),{getValue:function(){return et},setValue:function(it){et=""+it},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function Va(a){a._valueTracker||(a._valueTracker=Ua(a))}function Wa(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var _e=o.getValue(),et="";return a&&(et=Ta(a)?a.checked?"true":"false":a.value),a=et,a!==_e?(o.setValue(a),!0):!1}function Xa(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Ya(a,o){var _e=o.checked;return A$3({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:_e??a._wrapperState.initialChecked})}function Za(a,o){var _e=o.defaultValue==null?"":o.defaultValue,et=o.checked!=null?o.checked:o.defaultChecked;_e=Sa(o.value!=null?o.value:_e),a._wrapperState={initialChecked:et,initialValue:_e,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ab(a,o){o=o.checked,o!=null&&ta(a,"checked",o,!1)}function bb(a,o){ab(a,o);var _e=Sa(o.value),et=o.type;if(_e!=null)et==="number"?(_e===0&&a.value===""||a.value!=_e)&&(a.value=""+_e):a.value!==""+_e&&(a.value=""+_e);else if(et==="submit"||et==="reset"){a.removeAttribute("value");return}o.hasOwnProperty("value")?cb(a,o.type,_e):o.hasOwnProperty("defaultValue")&&cb(a,o.type,Sa(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(a.defaultChecked=!!o.defaultChecked)}function db(a,o,_e){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var et=o.type;if(!(et!=="submit"&&et!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+a._wrapperState.initialValue,_e||o===a.value||(a.value=o),a.defaultValue=o}_e=a.name,_e!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,_e!==""&&(a.name=_e)}function cb(a,o,_e){(o!=="number"||Xa(a.ownerDocument)!==a)&&(_e==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+_e&&(a.defaultValue=""+_e))}var eb=Array.isArray;function fb(a,o,_e,et){if(a=a.options,o){o={};for(var rt=0;rt<_e.length;rt++)o["$"+_e[rt]]=!0;for(_e=0;_e<a.length;_e++)rt=o.hasOwnProperty("$"+a[_e].value),a[_e].selected!==rt&&(a[_e].selected=rt),rt&&et&&(a[_e].defaultSelected=!0)}else{for(_e=""+Sa(_e),o=null,rt=0;rt<a.length;rt++){if(a[rt].value===_e){a[rt].selected=!0,et&&(a[rt].defaultSelected=!0);return}o!==null||a[rt].disabled||(o=a[rt])}o!==null&&(o.selected=!0)}}function gb(a,o){if(o.dangerouslySetInnerHTML!=null)throw Error(p$2(91));return A$3({},o,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function hb(a,o){var _e=o.value;if(_e==null){if(_e=o.children,o=o.defaultValue,_e!=null){if(o!=null)throw Error(p$2(92));if(eb(_e)){if(1<_e.length)throw Error(p$2(93));_e=_e[0]}o=_e}o==null&&(o=""),_e=o}a._wrapperState={initialValue:Sa(_e)}}function ib(a,o){var _e=Sa(o.value),et=Sa(o.defaultValue);_e!=null&&(_e=""+_e,_e!==a.value&&(a.value=_e),o.defaultValue==null&&a.defaultValue!==_e&&(a.defaultValue=_e)),et!=null&&(a.defaultValue=""+et)}function jb(a){var o=a.textContent;o===a._wrapperState.initialValue&&o!==""&&o!==null&&(a.value=o)}function kb(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(a,o){return a==null||a==="http://www.w3.org/1999/xhtml"?kb(o):a==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var mb,nb=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,_e,et,rt){MSApp.execUnsafeLocalFunction(function(){return a(o,_e,et,rt)})}:a}(function(a,o){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=o;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=mb.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;o.firstChild;)a.appendChild(o.firstChild)}});function ob(a,o){if(o){var _e=a.firstChild;if(_e&&_e===a.lastChild&&_e.nodeType===3){_e.nodeValue=o;return}}a.textContent=o}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(a){qb.forEach(function(o){o=o+a.charAt(0).toUpperCase()+a.substring(1),pb[o]=pb[a]})});function rb(a,o,_e){return o==null||typeof o=="boolean"||o===""?"":_e||typeof o!="number"||o===0||pb.hasOwnProperty(a)&&pb[a]?(""+o).trim():o+"px"}function sb(a,o){a=a.style;for(var _e in o)if(o.hasOwnProperty(_e)){var et=_e.indexOf("--")===0,rt=rb(_e,o[_e],et);_e==="float"&&(_e="cssFloat"),et?a.setProperty(_e,rt):a[_e]=rt}}var tb=A$3({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(a,o){if(o){if(tb[a]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(p$2(137,a));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(p$2(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(p$2(61))}if(o.style!=null&&typeof o.style!="object")throw Error(p$2(62))}}function vb(a,o){if(a.indexOf("-")===-1)return typeof o.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var yb=null,zb=null,Ab=null;function Bb(a){if(a=Cb(a)){if(typeof yb!="function")throw Error(p$2(280));var o=a.stateNode;o&&(o=Db(o),yb(a.stateNode,a.type,o))}}function Eb(a){zb?Ab?Ab.push(a):Ab=[a]:zb=a}function Fb(){if(zb){var a=zb,o=Ab;if(Ab=zb=null,Bb(a),o)for(a=0;a<o.length;a++)Bb(o[a])}}function Gb(a,o){return a(o)}function Hb(){}var Ib=!1;function Jb(a,o,_e){if(Ib)return a(o,_e);Ib=!0;try{return Gb(a,o,_e)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(a,o){var _e=a.stateNode;if(_e===null)return null;var et=Db(_e);if(et===null)return null;_e=et[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(et=!et.disabled)||(a=a.type,et=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!et;break e;default:a=!1}if(a)return null;if(_e&&typeof _e!="function")throw Error(p$2(231,o,typeof _e));return _e}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(a,o,_e,et,rt,lt,it,ut,s){var tt=Array.prototype.slice.call(arguments,3);try{o.apply(_e,tt)}catch(ot){this.onError(ot)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(a){Ob=!0,Pb=a}};function Tb(a,o,_e,et,rt,lt,it,ut,s){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(a,o,_e,et,rt,lt,it,ut,s){if(Tb.apply(this,arguments),Ob){if(Ob){var tt=Pb;Ob=!1,Pb=null}else throw Error(p$2(198));Qb||(Qb=!0,Rb=tt)}}function Vb(a){var o=a,_e=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,o.flags&4098&&(_e=o.return),a=o.return;while(a)}return o.tag===3?_e:null}function Wb(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function Xb(a){if(Vb(a)!==a)throw Error(p$2(188))}function Yb(a){var o=a.alternate;if(!o){if(o=Vb(a),o===null)throw Error(p$2(188));return o!==a?null:a}for(var _e=a,et=o;;){var rt=_e.return;if(rt===null)break;var lt=rt.alternate;if(lt===null){if(et=rt.return,et!==null){_e=et;continue}break}if(rt.child===lt.child){for(lt=rt.child;lt;){if(lt===_e)return Xb(rt),a;if(lt===et)return Xb(rt),o;lt=lt.sibling}throw Error(p$2(188))}if(_e.return!==et.return)_e=rt,et=lt;else{for(var it=!1,ut=rt.child;ut;){if(ut===_e){it=!0,_e=rt,et=lt;break}if(ut===et){it=!0,et=rt,_e=lt;break}ut=ut.sibling}if(!it){for(ut=lt.child;ut;){if(ut===_e){it=!0,_e=lt,et=rt;break}if(ut===et){it=!0,et=lt,_e=rt;break}ut=ut.sibling}if(!it)throw Error(p$2(189))}}if(_e.alternate!==et)throw Error(p$2(190))}if(_e.tag!==3)throw Error(p$2(188));return _e.stateNode.current===_e?a:o}function Zb(a){return a=Yb(a),a!==null?$b(a):null}function $b(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var o=$b(a);if(o!==null)return o;a=a.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$1=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(a){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,a,void 0,(a.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(a){return a>>>=0,a===0?32:31-(pc(a)/qc|0)|0}var rc=64,sc=4194304;function tc(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function uc(a,o){var _e=a.pendingLanes;if(_e===0)return 0;var et=0,rt=a.suspendedLanes,lt=a.pingedLanes,it=_e&268435455;if(it!==0){var ut=it&~rt;ut!==0?et=tc(ut):(lt&=it,lt!==0&&(et=tc(lt)))}else it=_e&~rt,it!==0?et=tc(it):lt!==0&&(et=tc(lt));if(et===0)return 0;if(o!==0&&o!==et&&!(o&rt)&&(rt=et&-et,lt=o&-o,rt>=lt||rt===16&&(lt&4194240)!==0))return o;if(et&4&&(et|=_e&16),o=a.entangledLanes,o!==0)for(a=a.entanglements,o&=et;0<o;)_e=31-oc(o),rt=1<<_e,et|=a[_e],o&=~rt;return et}function vc(a,o){switch(a){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(a,o){for(var _e=a.suspendedLanes,et=a.pingedLanes,rt=a.expirationTimes,lt=a.pendingLanes;0<lt;){var it=31-oc(lt),ut=1<<it,s=rt[it];s===-1?(!(ut&_e)||ut&et)&&(rt[it]=vc(ut,o)):s<=o&&(a.expiredLanes|=ut),lt&=~ut}}function xc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function yc(){var a=rc;return rc<<=1,!(rc&4194240)&&(rc=64),a}function zc(a){for(var o=[],_e=0;31>_e;_e++)o.push(a);return o}function Ac(a,o,_e){a.pendingLanes|=o,o!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,o=31-oc(o),a[o]=_e}function Bc(a,o){var _e=a.pendingLanes&~o;a.pendingLanes=o,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=o,a.mutableReadLanes&=o,a.entangledLanes&=o,o=a.entanglements;var et=a.eventTimes;for(a=a.expirationTimes;0<_e;){var rt=31-oc(_e),lt=1<<rt;o[rt]=0,et[rt]=-1,a[rt]=-1,_e&=~lt}}function Cc(a,o){var _e=a.entangledLanes|=o;for(a=a.entanglements;_e;){var et=31-oc(_e),rt=1<<et;rt&o|a[et]&o&&(a[et]|=o),_e&=~rt}}var C$1=0;function Dc(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(a,o){switch(a){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(o.pointerId)}}function Tc(a,o,_e,et,rt,lt){return a===null||a.nativeEvent!==lt?(a={blockedOn:o,domEventName:_e,eventSystemFlags:et,nativeEvent:lt,targetContainers:[rt]},o!==null&&(o=Cb(o),o!==null&&Fc(o)),a):(a.eventSystemFlags|=et,o=a.targetContainers,rt!==null&&o.indexOf(rt)===-1&&o.push(rt),a)}function Uc(a,o,_e,et,rt){switch(o){case"focusin":return Lc=Tc(Lc,a,o,_e,et,rt),!0;case"dragenter":return Mc=Tc(Mc,a,o,_e,et,rt),!0;case"mouseover":return Nc=Tc(Nc,a,o,_e,et,rt),!0;case"pointerover":var lt=rt.pointerId;return Oc.set(lt,Tc(Oc.get(lt)||null,a,o,_e,et,rt)),!0;case"gotpointercapture":return lt=rt.pointerId,Pc.set(lt,Tc(Pc.get(lt)||null,a,o,_e,et,rt)),!0}return!1}function Vc(a){var o=Wc(a.target);if(o!==null){var _e=Vb(o);if(_e!==null){if(o=_e.tag,o===13){if(o=Wb(_e),o!==null){a.blockedOn=o,Ic(a.priority,function(){Gc(_e)});return}}else if(o===3&&_e.stateNode.current.memoizedState.isDehydrated){a.blockedOn=_e.tag===3?_e.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Xc(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var _e=Yc(a.domEventName,a.eventSystemFlags,o[0],a.nativeEvent);if(_e===null){_e=a.nativeEvent;var et=new _e.constructor(_e.type,_e);wb=et,_e.target.dispatchEvent(et),wb=null}else return o=Cb(_e),o!==null&&Fc(o),a.blockedOn=_e,!1;o.shift()}return!0}function Zc(a,o,_e){Xc(a)&&_e.delete(o)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(a,o){a.blockedOn===o&&(a.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(a){function o(rt){return ad(rt,a)}if(0<Kc.length){ad(Kc[0],a);for(var _e=1;_e<Kc.length;_e++){var et=Kc[_e];et.blockedOn===a&&(et.blockedOn=null)}}for(Lc!==null&&ad(Lc,a),Mc!==null&&ad(Mc,a),Nc!==null&&ad(Nc,a),Oc.forEach(o),Pc.forEach(o),_e=0;_e<Qc.length;_e++)et=Qc[_e],et.blockedOn===a&&(et.blockedOn=null);for(;0<Qc.length&&(_e=Qc[0],_e.blockedOn===null);)Vc(_e),_e.blockedOn===null&&Qc.shift()}var cd=ua$1.ReactCurrentBatchConfig,dd=!0;function ed(a,o,_e,et){var rt=C$1,lt=cd.transition;cd.transition=null;try{C$1=1,fd(a,o,_e,et)}finally{C$1=rt,cd.transition=lt}}function gd(a,o,_e,et){var rt=C$1,lt=cd.transition;cd.transition=null;try{C$1=4,fd(a,o,_e,et)}finally{C$1=rt,cd.transition=lt}}function fd(a,o,_e,et){if(dd){var rt=Yc(a,o,_e,et);if(rt===null)hd(a,o,et,id,_e),Sc(a,et);else if(Uc(rt,a,o,_e,et))et.stopPropagation();else if(Sc(a,et),o&4&&-1<Rc.indexOf(a)){for(;rt!==null;){var lt=Cb(rt);if(lt!==null&&Ec(lt),lt=Yc(a,o,_e,et),lt===null&&hd(a,o,et,id,_e),lt===rt)break;rt=lt}rt!==null&&et.stopPropagation()}else hd(a,o,et,null,_e)}}var id=null;function Yc(a,o,_e,et){if(id=null,a=xb(et),a=Wc(a),a!==null)if(o=Vb(a),o===null)a=null;else if(_e=o.tag,_e===13){if(a=Wb(o),a!==null)return a;a=null}else if(_e===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null);return id=a,null}function jd(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var a,o=ld,_e=o.length,et,rt="value"in kd?kd.value:kd.textContent,lt=rt.length;for(a=0;a<_e&&o[a]===rt[a];a++);var it=_e-a;for(et=1;et<=it&&o[_e-et]===rt[lt-et];et++);return md=rt.slice(a,1<et?1-et:void 0)}function od(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function pd(){return!0}function qd(){return!1}function rd(a){function o(_e,et,rt,lt,it){this._reactName=_e,this._targetInst=rt,this.type=et,this.nativeEvent=lt,this.target=it,this.currentTarget=null;for(var ut in a)a.hasOwnProperty(ut)&&(_e=a[ut],this[ut]=_e?_e(lt):lt[ut]);return this.isDefaultPrevented=(lt.defaultPrevented!=null?lt.defaultPrevented:lt.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$3(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _e=this.nativeEvent;_e&&(_e.preventDefault?_e.preventDefault():typeof _e.returnValue!="unknown"&&(_e.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var _e=this.nativeEvent;_e&&(_e.stopPropagation?_e.stopPropagation():typeof _e.cancelBubble!="unknown"&&(_e.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),o}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$3({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$3({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==yd&&(yd&&a.type==="mousemove"?(wd=a.screenX-yd.screenX,xd=a.screenY-yd.screenY):xd=wd=0,yd=a),wd)},movementY:function(a){return"movementY"in a?a.movementY:xd}}),Bd=rd(Ad),Cd=A$3({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$3({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$3({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$3({},sd,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$3({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=Od[a])?!!o[a]:!1}function zd(){return Pd}var Qd=A$3({},ud,{key:function(a){if(a.key){var o=Md[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=od(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Nd[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(a){return a.type==="keypress"?od(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?od(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Rd=rd(Qd),Sd=A$3({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$3({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$3({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$3({},Ad,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee$1=String.fromCharCode(32),fe=!1;function ge(a,o){switch(a){case"keyup":return $d.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var ie=!1;function je(a,o){switch(a){case"compositionend":return he(o);case"keypress":return o.which!==32?null:(fe=!0,ee$1);case"textInput":return a=o.data,a===ee$1&&fe?null:a;default:return null}}function ke(a,o){if(ie)return a==="compositionend"||!ae&&ge(a,o)?(a=nd(),md=ld=kd=null,ie=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return de&&o.locale!=="ko"?null:o.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!le[a.type]:o==="textarea"}function ne(a,o,_e,et){Eb(et),o=oe(o,"onChange"),0<o.length&&(_e=new td("onChange","change",null,_e,et),a.push({event:_e,listeners:o}))}var pe=null,qe=null;function re(a){se(a,0)}function te$1(a){var o=ue(a);if(Wa(o))return a}function ve(a,o){if(a==="change")return o}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(a){if(a.propertyName==="value"&&te$1(qe)){var o=[];ne(o,qe,a,xb(a)),Jb(re,o)}}function Ce(a,o,_e){a==="focusin"?(Ae(),pe=o,qe=_e,pe.attachEvent("onpropertychange",Be)):a==="focusout"&&Ae()}function De(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return te$1(qe)}function Ee(a,o){if(a==="click")return te$1(o)}function Fe(a,o){if(a==="input"||a==="change")return te$1(o)}function Ge(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(a,o){if(He(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var _e=Object.keys(a),et=Object.keys(o);if(_e.length!==et.length)return!1;for(et=0;et<_e.length;et++){var rt=_e[et];if(!ja.call(o,rt)||!He(a[rt],o[rt]))return!1}return!0}function Je(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Ke(a,o){var _e=Je(a);a=0;for(var et;_e;){if(_e.nodeType===3){if(et=a+_e.textContent.length,a<=o&&et>=o)return{node:_e,offset:o-a};a=et}e:{for(;_e;){if(_e.nextSibling){_e=_e.nextSibling;break e}_e=_e.parentNode}_e=void 0}_e=Je(_e)}}function Le(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?Le(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function Me(){for(var a=window,o=Xa();o instanceof a.HTMLIFrameElement;){try{var _e=typeof o.contentWindow.location.href=="string"}catch{_e=!1}if(_e)a=o.contentWindow;else break;o=Xa(a.document)}return o}function Ne(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}function Oe(a){var o=Me(),_e=a.focusedElem,et=a.selectionRange;if(o!==_e&&_e&&_e.ownerDocument&&Le(_e.ownerDocument.documentElement,_e)){if(et!==null&&Ne(_e)){if(o=et.start,a=et.end,a===void 0&&(a=o),"selectionStart"in _e)_e.selectionStart=o,_e.selectionEnd=Math.min(a,_e.value.length);else if(a=(o=_e.ownerDocument||document)&&o.defaultView||window,a.getSelection){a=a.getSelection();var rt=_e.textContent.length,lt=Math.min(et.start,rt);et=et.end===void 0?lt:Math.min(et.end,rt),!a.extend&&lt>et&&(rt=et,et=lt,lt=rt),rt=Ke(_e,lt);var it=Ke(_e,et);rt&&it&&(a.rangeCount!==1||a.anchorNode!==rt.node||a.anchorOffset!==rt.offset||a.focusNode!==it.node||a.focusOffset!==it.offset)&&(o=o.createRange(),o.setStart(rt.node,rt.offset),a.removeAllRanges(),lt>et?(a.addRange(o),a.extend(it.node,it.offset)):(o.setEnd(it.node,it.offset),a.addRange(o)))}}for(o=[],a=_e;a=a.parentNode;)a.nodeType===1&&o.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof _e.focus=="function"&&_e.focus(),_e=0;_e<o.length;_e++)a=o[_e],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(a,o,_e){var et=_e.window===_e?_e.document:_e.nodeType===9?_e:_e.ownerDocument;Te||Qe==null||Qe!==Xa(et)||(et=Qe,"selectionStart"in et&&Ne(et)?et={start:et.selectionStart,end:et.selectionEnd}:(et=(et.ownerDocument&&et.ownerDocument.defaultView||window).getSelection(),et={anchorNode:et.anchorNode,anchorOffset:et.anchorOffset,focusNode:et.focusNode,focusOffset:et.focusOffset}),Se&&Ie(Se,et)||(Se=et,et=oe(Re,"onSelect"),0<et.length&&(o=new td("onSelect","select",null,o,_e),a.push({event:o,listeners:et}),o.target=Qe)))}function Ve(a,o){var _e={};return _e[a.toLowerCase()]=o.toLowerCase(),_e["Webkit"+a]="webkit"+o,_e["Moz"+a]="moz"+o,_e}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(a){if(Xe[a])return Xe[a];if(!We[a])return a;var o=We[a],_e;for(_e in o)if(o.hasOwnProperty(_e)&&_e in Ye)return Xe[a]=o[_e];return a}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(a,o){df.set(a,o),fa(o,[a])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(a,o,_e){var et=a.type||"unknown-event";a.currentTarget=_e,Ub(et,o,void 0,a),a.currentTarget=null}function se(a,o){o=(o&4)!==0;for(var _e=0;_e<a.length;_e++){var et=a[_e],rt=et.event;et=et.listeners;e:{var lt=void 0;if(o)for(var it=et.length-1;0<=it;it--){var ut=et[it],s=ut.instance,tt=ut.currentTarget;if(ut=ut.listener,s!==lt&&rt.isPropagationStopped())break e;nf(rt,ut,tt),lt=s}else for(it=0;it<et.length;it++){if(ut=et[it],s=ut.instance,tt=ut.currentTarget,ut=ut.listener,s!==lt&&rt.isPropagationStopped())break e;nf(rt,ut,tt),lt=s}}}if(Qb)throw a=Rb,Qb=!1,Rb=null,a}function D$1(a,o){var _e=o[of];_e===void 0&&(_e=o[of]=new Set);var et=a+"__bubble";_e.has(et)||(pf(o,a,2,!1),_e.add(et))}function qf(a,o,_e){var et=0;o&&(et|=4),pf(_e,a,et,o)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(a){if(!a[rf]){a[rf]=!0,da.forEach(function(_e){_e!=="selectionchange"&&(mf.has(_e)||qf(_e,!1,a),qf(_e,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[rf]||(o[rf]=!0,qf("selectionchange",!1,o))}}function pf(a,o,_e,et){switch(jd(o)){case 1:var rt=ed;break;case 4:rt=gd;break;default:rt=fd}_e=rt.bind(null,o,_e,a),rt=void 0,!Lb||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(rt=!0),et?rt!==void 0?a.addEventListener(o,_e,{capture:!0,passive:rt}):a.addEventListener(o,_e,!0):rt!==void 0?a.addEventListener(o,_e,{passive:rt}):a.addEventListener(o,_e,!1)}function hd(a,o,_e,et,rt){var lt=et;if(!(o&1)&&!(o&2)&&et!==null)e:for(;;){if(et===null)return;var it=et.tag;if(it===3||it===4){var ut=et.stateNode.containerInfo;if(ut===rt||ut.nodeType===8&&ut.parentNode===rt)break;if(it===4)for(it=et.return;it!==null;){var s=it.tag;if((s===3||s===4)&&(s=it.stateNode.containerInfo,s===rt||s.nodeType===8&&s.parentNode===rt))return;it=it.return}for(;ut!==null;){if(it=Wc(ut),it===null)return;if(s=it.tag,s===5||s===6){et=lt=it;continue e}ut=ut.parentNode}}et=et.return}Jb(function(){var tt=lt,ot=xb(_e),ct=[];e:{var yt=df.get(a);if(yt!==void 0){var pt=td,gt=a;switch(a){case"keypress":if(od(_e)===0)break e;case"keydown":case"keyup":pt=Rd;break;case"focusin":gt="focus",pt=Fd;break;case"focusout":gt="blur",pt=Fd;break;case"beforeblur":case"afterblur":pt=Fd;break;case"click":if(_e.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pt=Vd;break;case $e:case af:case bf:pt=Hd;break;case cf:pt=Xd;break;case"scroll":pt=vd;break;case"wheel":pt=Zd;break;case"copy":case"cut":case"paste":pt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pt=Td}var st=(o&4)!==0,ft=!st&&a==="scroll",at=st?yt!==null?yt+"Capture":null:yt;st=[];for(var ht=tt,mt;ht!==null;){mt=ht;var St=mt.stateNode;if(mt.tag===5&&St!==null&&(mt=St,at!==null&&(St=Kb(ht,at),St!=null&&st.push(tf(ht,St,mt)))),ft)break;ht=ht.return}0<st.length&&(yt=new pt(yt,gt,null,_e,ot),ct.push({event:yt,listeners:st}))}}if(!(o&7)){e:{if(yt=a==="mouseover"||a==="pointerover",pt=a==="mouseout"||a==="pointerout",yt&&_e!==wb&&(gt=_e.relatedTarget||_e.fromElement)&&(Wc(gt)||gt[uf]))break e;if((pt||yt)&&(yt=ot.window===ot?ot:(yt=ot.ownerDocument)?yt.defaultView||yt.parentWindow:window,pt?(gt=_e.relatedTarget||_e.toElement,pt=tt,gt=gt?Wc(gt):null,gt!==null&&(ft=Vb(gt),gt!==ft||gt.tag!==5&&gt.tag!==6)&&(gt=null)):(pt=null,gt=tt),pt!==gt)){if(st=Bd,St="onMouseLeave",at="onMouseEnter",ht="mouse",(a==="pointerout"||a==="pointerover")&&(st=Td,St="onPointerLeave",at="onPointerEnter",ht="pointer"),ft=pt==null?yt:ue(pt),mt=gt==null?yt:ue(gt),yt=new st(St,ht+"leave",pt,_e,ot),yt.target=ft,yt.relatedTarget=mt,St=null,Wc(ot)===tt&&(st=new st(at,ht+"enter",gt,_e,ot),st.target=mt,st.relatedTarget=ft,St=st),ft=St,pt&&gt)t:{for(st=pt,at=gt,ht=0,mt=st;mt;mt=vf(mt))ht++;for(mt=0,St=at;St;St=vf(St))mt++;for(;0<ht-mt;)st=vf(st),ht--;for(;0<mt-ht;)at=vf(at),mt--;for(;ht--;){if(st===at||at!==null&&st===at.alternate)break t;st=vf(st),at=vf(at)}st=null}else st=null;pt!==null&&wf(ct,yt,pt,st,!1),gt!==null&&ft!==null&&wf(ct,ft,gt,st,!0)}}e:{if(yt=tt?ue(tt):window,pt=yt.nodeName&&yt.nodeName.toLowerCase(),pt==="select"||pt==="input"&&yt.type==="file")var It=ve;else if(me(yt))if(we)It=Fe;else{It=De;var xt=Ce}else(pt=yt.nodeName)&&pt.toLowerCase()==="input"&&(yt.type==="checkbox"||yt.type==="radio")&&(It=Ee);if(It&&(It=It(a,tt))){ne(ct,It,_e,ot);break e}xt&&xt(a,yt,tt),a==="focusout"&&(xt=yt._wrapperState)&&xt.controlled&&yt.type==="number"&&cb(yt,"number",yt.value)}switch(xt=tt?ue(tt):window,a){case"focusin":(me(xt)||xt.contentEditable==="true")&&(Qe=xt,Re=tt,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(ct,_e,ot);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(ct,_e,ot)}var At;if(ae)e:{switch(a){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else ie?ge(a,_e)&&(Nt="onCompositionEnd"):a==="keydown"&&_e.keyCode===229&&(Nt="onCompositionStart");Nt&&(de&&_e.locale!=="ko"&&(ie||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&ie&&(At=nd()):(kd=ot,ld="value"in kd?kd.value:kd.textContent,ie=!0)),xt=oe(tt,Nt),0<xt.length&&(Nt=new Ld(Nt,a,null,_e,ot),ct.push({event:Nt,listeners:xt}),At?Nt.data=At:(At=he(_e),At!==null&&(Nt.data=At)))),(At=ce?je(a,_e):ke(a,_e))&&(tt=oe(tt,"onBeforeInput"),0<tt.length&&(ot=new Ld("onBeforeInput","beforeinput",null,_e,ot),ct.push({event:ot,listeners:tt}),ot.data=At))}se(ct,o)})}function tf(a,o,_e){return{instance:a,listener:o,currentTarget:_e}}function oe(a,o){for(var _e=o+"Capture",et=[];a!==null;){var rt=a,lt=rt.stateNode;rt.tag===5&&lt!==null&&(rt=lt,lt=Kb(a,_e),lt!=null&&et.unshift(tf(a,lt,rt)),lt=Kb(a,o),lt!=null&&et.push(tf(a,lt,rt))),a=a.return}return et}function vf(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function wf(a,o,_e,et,rt){for(var lt=o._reactName,it=[];_e!==null&&_e!==et;){var ut=_e,s=ut.alternate,tt=ut.stateNode;if(s!==null&&s===et)break;ut.tag===5&&tt!==null&&(ut=tt,rt?(s=Kb(_e,lt),s!=null&&it.unshift(tf(_e,s,ut))):rt||(s=Kb(_e,lt),s!=null&&it.push(tf(_e,s,ut)))),_e=_e.return}it.length!==0&&a.push({event:o,listeners:it})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(a){return(typeof a=="string"?a:""+a).replace(xf,`
`).replace(yf,"")}function Af(a,o,_e){if(o=zf(o),zf(a)!==o&&_e)throw Error(p$2(425))}function Bf(){}var Cf=null,Df=null;function Ef(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(a){return Hf.resolve(null).then(a).catch(If)}:Ff;function If(a){setTimeout(function(){throw a})}function Kf(a,o){var _e=o,et=0;do{var rt=_e.nextSibling;if(a.removeChild(_e),rt&&rt.nodeType===8)if(_e=rt.data,_e==="/$"){if(et===0){a.removeChild(rt),bd(o);return}et--}else _e!=="$"&&_e!=="$?"&&_e!=="$!"||et++;_e=rt}while(_e);bd(o)}function Lf(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return a}function Mf(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var _e=a.data;if(_e==="$"||_e==="$!"||_e==="$?"){if(o===0)return a;o--}else _e==="/$"&&o++}a=a.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(a){var o=a[Of];if(o)return o;for(var _e=a.parentNode;_e;){if(o=_e[uf]||_e[Of]){if(_e=o.alternate,o.child!==null||_e!==null&&_e.child!==null)for(a=Mf(a);a!==null;){if(_e=a[Of])return _e;a=Mf(a)}return o}a=_e,_e=a.parentNode}return null}function Cb(a){return a=a[Of]||a[uf],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function ue(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(p$2(33))}function Db(a){return a[Pf]||null}var Sf=[],Tf=-1;function Uf(a){return{current:a}}function E(a){0>Tf||(a.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$1(a,o){Tf++,Sf[Tf]=a.current,a.current=o}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(a,o){var _e=a.type.contextTypes;if(!_e)return Vf;var et=a.stateNode;if(et&&et.__reactInternalMemoizedUnmaskedChildContext===o)return et.__reactInternalMemoizedMaskedChildContext;var rt={},lt;for(lt in _e)rt[lt]=o[lt];return et&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=o,a.__reactInternalMemoizedMaskedChildContext=rt),rt}function Zf(a){return a=a.childContextTypes,a!=null}function $f(){E(Wf),E(H)}function ag(a,o,_e){if(H.current!==Vf)throw Error(p$2(168));G$1(H,o),G$1(Wf,_e)}function bg(a,o,_e){var et=a.stateNode;if(o=o.childContextTypes,typeof et.getChildContext!="function")return _e;et=et.getChildContext();for(var rt in et)if(!(rt in o))throw Error(p$2(108,Ra(a)||"Unknown",rt));return A$3({},_e,et)}function cg(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G$1(H,a),G$1(Wf,Wf.current),!0}function dg(a,o,_e){var et=a.stateNode;if(!et)throw Error(p$2(169));_e?(a=bg(a,o,Xf),et.__reactInternalMemoizedMergedChildContext=a,E(Wf),E(H),G$1(H,a)):E(Wf),G$1(Wf,_e)}var eg=null,fg=!1,gg=!1;function hg(a){eg===null?eg=[a]:eg.push(a)}function ig(a){fg=!0,hg(a)}function jg(){if(!gg&&eg!==null){gg=!0;var a=0,o=C$1;try{var _e=eg;for(C$1=1;a<_e.length;a++){var et=_e[a];do et=et(!0);while(et!==null)}eg=null,fg=!1}catch(rt){throw eg!==null&&(eg=eg.slice(a+1)),ac(fc,jg),rt}finally{C$1=o,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(a,o){kg[lg++]=ng,kg[lg++]=mg,mg=a,ng=o}function ug(a,o,_e){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=a;var et=rg;a=sg;var rt=32-oc(et)-1;et&=~(1<<rt),_e+=1;var lt=32-oc(o)+rt;if(30<lt){var it=rt-rt%5;lt=(et&(1<<it)-1).toString(32),et>>=it,rt-=it,rg=1<<32-oc(o)+rt|_e<<rt|et,sg=lt+a}else rg=1<<lt|_e<<rt|et,sg=a}function vg(a){a.return!==null&&(tg(a,1),ug(a,1,0))}function wg(a){for(;a===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;a===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$1=!1,zg=null;function Ag(a,o){var _e=Bg(5,null,null,0);_e.elementType="DELETED",_e.stateNode=o,_e.return=a,o=a.deletions,o===null?(a.deletions=[_e],a.flags|=16):o.push(_e)}function Cg(a,o){switch(a.tag){case 5:var _e=a.type;return o=o.nodeType!==1||_e.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(a.stateNode=o,xg=a,yg=Lf(o.firstChild),!0):!1;case 6:return o=a.pendingProps===""||o.nodeType!==3?null:o,o!==null?(a.stateNode=o,xg=a,yg=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(_e=qg!==null?{id:rg,overflow:sg}:null,a.memoizedState={dehydrated:o,treeContext:_e,retryLane:1073741824},_e=Bg(18,null,null,0),_e.stateNode=o,_e.return=a,a.child=_e,xg=a,yg=null,!0):!1;default:return!1}}function Dg(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Eg(a){if(I$1){var o=yg;if(o){var _e=o;if(!Cg(a,o)){if(Dg(a))throw Error(p$2(418));o=Lf(_e.nextSibling);var et=xg;o&&Cg(a,o)?Ag(et,_e):(a.flags=a.flags&-4097|2,I$1=!1,xg=a)}}else{if(Dg(a))throw Error(p$2(418));a.flags=a.flags&-4097|2,I$1=!1,xg=a}}}function Fg(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;xg=a}function Gg(a){if(a!==xg)return!1;if(!I$1)return Fg(a),I$1=!0,!1;var o;if((o=a.tag!==3)&&!(o=a.tag!==5)&&(o=a.type,o=o!=="head"&&o!=="body"&&!Ef(a.type,a.memoizedProps)),o&&(o=yg)){if(Dg(a))throw Hg(),Error(p$2(418));for(;o;)Ag(a,o),o=Lf(o.nextSibling)}if(Fg(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(p$2(317));e:{for(a=a.nextSibling,o=0;a;){if(a.nodeType===8){var _e=a.data;if(_e==="/$"){if(o===0){yg=Lf(a.nextSibling);break e}o--}else _e!=="$"&&_e!=="$!"&&_e!=="$?"||o++}a=a.nextSibling}yg=null}}else yg=xg?Lf(a.stateNode.nextSibling):null;return!0}function Hg(){for(var a=yg;a;)a=Lf(a.nextSibling)}function Ig(){yg=xg=null,I$1=!1}function Jg(a){zg===null?zg=[a]:zg.push(a)}var Kg=ua$1.ReactCurrentBatchConfig;function Lg(a,o){if(a&&a.defaultProps){o=A$3({},o),a=a.defaultProps;for(var _e in a)o[_e]===void 0&&(o[_e]=a[_e]);return o}return o}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(a){var o=Mg.current;E(Mg),a._currentValue=o}function Sg(a,o,_e){for(;a!==null;){var et=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,et!==null&&(et.childLanes|=o)):et!==null&&(et.childLanes&o)!==o&&(et.childLanes|=o),a===_e)break;a=a.return}}function Tg(a,o){Ng=a,Pg=Og=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&o&&(Ug=!0),a.firstContext=null)}function Vg(a){var o=a._currentValue;if(Pg!==a)if(a={context:a,memoizedValue:o,next:null},Og===null){if(Ng===null)throw Error(p$2(308));Og=a,Ng.dependencies={lanes:0,firstContext:a}}else Og=Og.next=a;return o}var Wg=null;function Xg(a){Wg===null?Wg=[a]:Wg.push(a)}function Yg(a,o,_e,et){var rt=o.interleaved;return rt===null?(_e.next=_e,Xg(o)):(_e.next=rt.next,rt.next=_e),o.interleaved=_e,Zg(a,et)}function Zg(a,o){a.lanes|=o;var _e=a.alternate;for(_e!==null&&(_e.lanes|=o),_e=a,a=a.return;a!==null;)a.childLanes|=o,_e=a.alternate,_e!==null&&(_e.childLanes|=o),_e=a,a=a.return;return _e.tag===3?_e.stateNode:null}var $g=!1;function ah(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ch(a,o){return{eventTime:a,lane:o,tag:0,payload:null,callback:null,next:null}}function dh(a,o,_e){var et=a.updateQueue;if(et===null)return null;if(et=et.shared,K$1&2){var rt=et.pending;return rt===null?o.next=o:(o.next=rt.next,rt.next=o),et.pending=o,Zg(a,_e)}return rt=et.interleaved,rt===null?(o.next=o,Xg(et)):(o.next=rt.next,rt.next=o),et.interleaved=o,Zg(a,_e)}function eh(a,o,_e){if(o=o.updateQueue,o!==null&&(o=o.shared,(_e&4194240)!==0)){var et=o.lanes;et&=a.pendingLanes,_e|=et,o.lanes=_e,Cc(a,_e)}}function fh(a,o){var _e=a.updateQueue,et=a.alternate;if(et!==null&&(et=et.updateQueue,_e===et)){var rt=null,lt=null;if(_e=_e.firstBaseUpdate,_e!==null){do{var it={eventTime:_e.eventTime,lane:_e.lane,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null};lt===null?rt=lt=it:lt=lt.next=it,_e=_e.next}while(_e!==null);lt===null?rt=lt=o:lt=lt.next=o}else rt=lt=o;_e={baseState:et.baseState,firstBaseUpdate:rt,lastBaseUpdate:lt,shared:et.shared,effects:et.effects},a.updateQueue=_e;return}a=_e.lastBaseUpdate,a===null?_e.firstBaseUpdate=o:a.next=o,_e.lastBaseUpdate=o}function gh(a,o,_e,et){var rt=a.updateQueue;$g=!1;var lt=rt.firstBaseUpdate,it=rt.lastBaseUpdate,ut=rt.shared.pending;if(ut!==null){rt.shared.pending=null;var s=ut,tt=s.next;s.next=null,it===null?lt=tt:it.next=tt,it=s;var ot=a.alternate;ot!==null&&(ot=ot.updateQueue,ut=ot.lastBaseUpdate,ut!==it&&(ut===null?ot.firstBaseUpdate=tt:ut.next=tt,ot.lastBaseUpdate=s))}if(lt!==null){var ct=rt.baseState;it=0,ot=tt=s=null,ut=lt;do{var yt=ut.lane,pt=ut.eventTime;if((et&yt)===yt){ot!==null&&(ot=ot.next={eventTime:pt,lane:0,tag:ut.tag,payload:ut.payload,callback:ut.callback,next:null});e:{var gt=a,st=ut;switch(yt=o,pt=_e,st.tag){case 1:if(gt=st.payload,typeof gt=="function"){ct=gt.call(pt,ct,yt);break e}ct=gt;break e;case 3:gt.flags=gt.flags&-65537|128;case 0:if(gt=st.payload,yt=typeof gt=="function"?gt.call(pt,ct,yt):gt,yt==null)break e;ct=A$3({},ct,yt);break e;case 2:$g=!0}}ut.callback!==null&&ut.lane!==0&&(a.flags|=64,yt=rt.effects,yt===null?rt.effects=[ut]:yt.push(ut))}else pt={eventTime:pt,lane:yt,tag:ut.tag,payload:ut.payload,callback:ut.callback,next:null},ot===null?(tt=ot=pt,s=ct):ot=ot.next=pt,it|=yt;if(ut=ut.next,ut===null){if(ut=rt.shared.pending,ut===null)break;yt=ut,ut=yt.next,yt.next=null,rt.lastBaseUpdate=yt,rt.shared.pending=null}}while(1);if(ot===null&&(s=ct),rt.baseState=s,rt.firstBaseUpdate=tt,rt.lastBaseUpdate=ot,o=rt.shared.interleaved,o!==null){rt=o;do it|=rt.lane,rt=rt.next;while(rt!==o)}else lt===null&&(rt.shared.lanes=0);hh|=it,a.lanes=it,a.memoizedState=ct}}function ih(a,o,_e){if(a=o.effects,o.effects=null,a!==null)for(o=0;o<a.length;o++){var et=a[o],rt=et.callback;if(rt!==null){if(et.callback=null,et=_e,typeof rt!="function")throw Error(p$2(191,rt));rt.call(et)}}}var jh=new aa.Component().refs;function kh(a,o,_e,et){o=a.memoizedState,_e=_e(et,o),_e=_e==null?o:A$3({},o,_e),a.memoizedState=_e,a.lanes===0&&(a.updateQueue.baseState=_e)}var nh={isMounted:function(a){return(a=a._reactInternals)?Vb(a)===a:!1},enqueueSetState:function(a,o,_e){a=a._reactInternals;var et=L(),rt=lh(a),lt=ch(et,rt);lt.payload=o,_e!=null&&(lt.callback=_e),o=dh(a,lt,rt),o!==null&&(mh(o,a,rt,et),eh(o,a,rt))},enqueueReplaceState:function(a,o,_e){a=a._reactInternals;var et=L(),rt=lh(a),lt=ch(et,rt);lt.tag=1,lt.payload=o,_e!=null&&(lt.callback=_e),o=dh(a,lt,rt),o!==null&&(mh(o,a,rt,et),eh(o,a,rt))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var _e=L(),et=lh(a),rt=ch(_e,et);rt.tag=2,o!=null&&(rt.callback=o),o=dh(a,rt,et),o!==null&&(mh(o,a,et,_e),eh(o,a,et))}};function oh(a,o,_e,et,rt,lt,it){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(et,lt,it):o.prototype&&o.prototype.isPureReactComponent?!Ie(_e,et)||!Ie(rt,lt):!0}function ph(a,o,_e){var et=!1,rt=Vf,lt=o.contextType;return typeof lt=="object"&&lt!==null?lt=Vg(lt):(rt=Zf(o)?Xf:H.current,et=o.contextTypes,lt=(et=et!=null)?Yf(a,rt):Vf),o=new o(_e,lt),a.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=nh,a.stateNode=o,o._reactInternals=a,et&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=rt,a.__reactInternalMemoizedMaskedChildContext=lt),o}function qh(a,o,_e,et){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(_e,et),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(_e,et),o.state!==a&&nh.enqueueReplaceState(o,o.state,null)}function rh(a,o,_e,et){var rt=a.stateNode;rt.props=_e,rt.state=a.memoizedState,rt.refs=jh,ah(a);var lt=o.contextType;typeof lt=="object"&&lt!==null?rt.context=Vg(lt):(lt=Zf(o)?Xf:H.current,rt.context=Yf(a,lt)),rt.state=a.memoizedState,lt=o.getDerivedStateFromProps,typeof lt=="function"&&(kh(a,o,lt,_e),rt.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof rt.getSnapshotBeforeUpdate=="function"||typeof rt.UNSAFE_componentWillMount!="function"&&typeof rt.componentWillMount!="function"||(o=rt.state,typeof rt.componentWillMount=="function"&&rt.componentWillMount(),typeof rt.UNSAFE_componentWillMount=="function"&&rt.UNSAFE_componentWillMount(),o!==rt.state&&nh.enqueueReplaceState(rt,rt.state,null),gh(a,_e,rt,et),rt.state=a.memoizedState),typeof rt.componentDidMount=="function"&&(a.flags|=4194308)}function sh(a,o,_e){if(a=_e.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(_e._owner){if(_e=_e._owner,_e){if(_e.tag!==1)throw Error(p$2(309));var et=_e.stateNode}if(!et)throw Error(p$2(147,a));var rt=et,lt=""+a;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===lt?o.ref:(o=function(it){var ut=rt.refs;ut===jh&&(ut=rt.refs={}),it===null?delete ut[lt]:ut[lt]=it},o._stringRef=lt,o)}if(typeof a!="string")throw Error(p$2(284));if(!_e._owner)throw Error(p$2(290,a))}return a}function th(a,o){throw a=Object.prototype.toString.call(o),Error(p$2(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a))}function uh(a){var o=a._init;return o(a._payload)}function vh(a){function o(at,ht){if(a){var mt=at.deletions;mt===null?(at.deletions=[ht],at.flags|=16):mt.push(ht)}}function _e(at,ht){if(!a)return null;for(;ht!==null;)o(at,ht),ht=ht.sibling;return null}function et(at,ht){for(at=new Map;ht!==null;)ht.key!==null?at.set(ht.key,ht):at.set(ht.index,ht),ht=ht.sibling;return at}function rt(at,ht){return at=wh(at,ht),at.index=0,at.sibling=null,at}function lt(at,ht,mt){return at.index=mt,a?(mt=at.alternate,mt!==null?(mt=mt.index,mt<ht?(at.flags|=2,ht):mt):(at.flags|=2,ht)):(at.flags|=1048576,ht)}function it(at){return a&&at.alternate===null&&(at.flags|=2),at}function ut(at,ht,mt,St){return ht===null||ht.tag!==6?(ht=xh(mt,at.mode,St),ht.return=at,ht):(ht=rt(ht,mt),ht.return=at,ht)}function s(at,ht,mt,St){var It=mt.type;return It===ya?ot(at,ht,mt.props.children,St,mt.key):ht!==null&&(ht.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===Ha&&uh(It)===ht.type)?(St=rt(ht,mt.props),St.ref=sh(at,ht,mt),St.return=at,St):(St=yh(mt.type,mt.key,mt.props,null,at.mode,St),St.ref=sh(at,ht,mt),St.return=at,St)}function tt(at,ht,mt,St){return ht===null||ht.tag!==4||ht.stateNode.containerInfo!==mt.containerInfo||ht.stateNode.implementation!==mt.implementation?(ht=zh(mt,at.mode,St),ht.return=at,ht):(ht=rt(ht,mt.children||[]),ht.return=at,ht)}function ot(at,ht,mt,St,It){return ht===null||ht.tag!==7?(ht=Ah(mt,at.mode,St,It),ht.return=at,ht):(ht=rt(ht,mt),ht.return=at,ht)}function ct(at,ht,mt){if(typeof ht=="string"&&ht!==""||typeof ht=="number")return ht=xh(""+ht,at.mode,mt),ht.return=at,ht;if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case va:return mt=yh(ht.type,ht.key,ht.props,null,at.mode,mt),mt.ref=sh(at,null,ht),mt.return=at,mt;case wa:return ht=zh(ht,at.mode,mt),ht.return=at,ht;case Ha:var St=ht._init;return ct(at,St(ht._payload),mt)}if(eb(ht)||Ka(ht))return ht=Ah(ht,at.mode,mt,null),ht.return=at,ht;th(at,ht)}return null}function yt(at,ht,mt,St){var It=ht!==null?ht.key:null;if(typeof mt=="string"&&mt!==""||typeof mt=="number")return It!==null?null:ut(at,ht,""+mt,St);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:return mt.key===It?s(at,ht,mt,St):null;case wa:return mt.key===It?tt(at,ht,mt,St):null;case Ha:return It=mt._init,yt(at,ht,It(mt._payload),St)}if(eb(mt)||Ka(mt))return It!==null?null:ot(at,ht,mt,St,null);th(at,mt)}return null}function pt(at,ht,mt,St,It){if(typeof St=="string"&&St!==""||typeof St=="number")return at=at.get(mt)||null,ut(ht,at,""+St,It);if(typeof St=="object"&&St!==null){switch(St.$$typeof){case va:return at=at.get(St.key===null?mt:St.key)||null,s(ht,at,St,It);case wa:return at=at.get(St.key===null?mt:St.key)||null,tt(ht,at,St,It);case Ha:var xt=St._init;return pt(at,ht,mt,xt(St._payload),It)}if(eb(St)||Ka(St))return at=at.get(mt)||null,ot(ht,at,St,It,null);th(ht,St)}return null}function gt(at,ht,mt,St){for(var It=null,xt=null,At=ht,Nt=ht=0,kt=null;At!==null&&Nt<mt.length;Nt++){At.index>Nt?(kt=At,At=null):kt=At.sibling;var Mt=yt(at,At,mt[Nt],St);if(Mt===null){At===null&&(At=kt);break}a&&At&&Mt.alternate===null&&o(at,At),ht=lt(Mt,ht,Nt),xt===null?It=Mt:xt.sibling=Mt,xt=Mt,At=kt}if(Nt===mt.length)return _e(at,At),I$1&&tg(at,Nt),It;if(At===null){for(;Nt<mt.length;Nt++)At=ct(at,mt[Nt],St),At!==null&&(ht=lt(At,ht,Nt),xt===null?It=At:xt.sibling=At,xt=At);return I$1&&tg(at,Nt),It}for(At=et(at,At);Nt<mt.length;Nt++)kt=pt(At,at,Nt,mt[Nt],St),kt!==null&&(a&&kt.alternate!==null&&At.delete(kt.key===null?Nt:kt.key),ht=lt(kt,ht,Nt),xt===null?It=kt:xt.sibling=kt,xt=kt);return a&&At.forEach(function(bt){return o(at,bt)}),I$1&&tg(at,Nt),It}function st(at,ht,mt,St){var It=Ka(mt);if(typeof It!="function")throw Error(p$2(150));if(mt=It.call(mt),mt==null)throw Error(p$2(151));for(var xt=It=null,At=ht,Nt=ht=0,kt=null,Mt=mt.next();At!==null&&!Mt.done;Nt++,Mt=mt.next()){At.index>Nt?(kt=At,At=null):kt=At.sibling;var bt=yt(at,At,Mt.value,St);if(bt===null){At===null&&(At=kt);break}a&&At&&bt.alternate===null&&o(at,At),ht=lt(bt,ht,Nt),xt===null?It=bt:xt.sibling=bt,xt=bt,At=kt}if(Mt.done)return _e(at,At),I$1&&tg(at,Nt),It;if(At===null){for(;!Mt.done;Nt++,Mt=mt.next())Mt=ct(at,Mt.value,St),Mt!==null&&(ht=lt(Mt,ht,Nt),xt===null?It=Mt:xt.sibling=Mt,xt=Mt);return I$1&&tg(at,Nt),It}for(At=et(at,At);!Mt.done;Nt++,Mt=mt.next())Mt=pt(At,at,Nt,Mt.value,St),Mt!==null&&(a&&Mt.alternate!==null&&At.delete(Mt.key===null?Nt:Mt.key),ht=lt(Mt,ht,Nt),xt===null?It=Mt:xt.sibling=Mt,xt=Mt);return a&&At.forEach(function(Bt){return o(at,Bt)}),I$1&&tg(at,Nt),It}function ft(at,ht,mt,St){if(typeof mt=="object"&&mt!==null&&mt.type===ya&&mt.key===null&&(mt=mt.props.children),typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:e:{for(var It=mt.key,xt=ht;xt!==null;){if(xt.key===It){if(It=mt.type,It===ya){if(xt.tag===7){_e(at,xt.sibling),ht=rt(xt,mt.props.children),ht.return=at,at=ht;break e}}else if(xt.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===Ha&&uh(It)===xt.type){_e(at,xt.sibling),ht=rt(xt,mt.props),ht.ref=sh(at,xt,mt),ht.return=at,at=ht;break e}_e(at,xt);break}else o(at,xt);xt=xt.sibling}mt.type===ya?(ht=Ah(mt.props.children,at.mode,St,mt.key),ht.return=at,at=ht):(St=yh(mt.type,mt.key,mt.props,null,at.mode,St),St.ref=sh(at,ht,mt),St.return=at,at=St)}return it(at);case wa:e:{for(xt=mt.key;ht!==null;){if(ht.key===xt)if(ht.tag===4&&ht.stateNode.containerInfo===mt.containerInfo&&ht.stateNode.implementation===mt.implementation){_e(at,ht.sibling),ht=rt(ht,mt.children||[]),ht.return=at,at=ht;break e}else{_e(at,ht);break}else o(at,ht);ht=ht.sibling}ht=zh(mt,at.mode,St),ht.return=at,at=ht}return it(at);case Ha:return xt=mt._init,ft(at,ht,xt(mt._payload),St)}if(eb(mt))return gt(at,ht,mt,St);if(Ka(mt))return st(at,ht,mt,St);th(at,mt)}return typeof mt=="string"&&mt!==""||typeof mt=="number"?(mt=""+mt,ht!==null&&ht.tag===6?(_e(at,ht.sibling),ht=rt(ht,mt),ht.return=at,at=ht):(_e(at,ht),ht=xh(mt,at.mode,St),ht.return=at,at=ht),it(at)):_e(at,ht)}return ft}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(a){if(a===Dh)throw Error(p$2(174));return a}function Ih(a,o){switch(G$1(Gh,o),G$1(Fh,a),G$1(Eh,Dh),a=o.nodeType,a){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:lb(null,"");break;default:a=a===8?o.parentNode:o,o=a.namespaceURI||null,a=a.tagName,o=lb(o,a)}E(Eh),G$1(Eh,o)}function Jh(){E(Eh),E(Fh),E(Gh)}function Kh(a){Hh(Gh.current);var o=Hh(Eh.current),_e=lb(o,a.type);o!==_e&&(G$1(Fh,a),G$1(Eh,_e))}function Lh(a){Fh.current===a&&(E(Eh),E(Fh))}var M$1=Uf(0);function Mh(a){for(var o=a;o!==null;){if(o.tag===13){var _e=o.memoizedState;if(_e!==null&&(_e=_e.dehydrated,_e===null||_e.data==="$?"||_e.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Nh=[];function Oh(){for(var a=0;a<Nh.length;a++)Nh[a]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua$1.ReactCurrentDispatcher,Qh=ua$1.ReactCurrentBatchConfig,Rh=0,N$2=null,O$1=null,P=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q$1(){throw Error(p$2(321))}function Wh(a,o){if(o===null)return!1;for(var _e=0;_e<o.length&&_e<a.length;_e++)if(!He(a[_e],o[_e]))return!1;return!0}function Xh(a,o,_e,et,rt,lt){if(Rh=lt,N$2=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ph.current=a===null||a.memoizedState===null?Yh:Zh,a=_e(et,rt),Th){lt=0;do{if(Th=!1,Uh=0,25<=lt)throw Error(p$2(301));lt+=1,P=O$1=null,o.updateQueue=null,Ph.current=$h,a=_e(et,rt)}while(Th)}if(Ph.current=ai,o=O$1!==null&&O$1.next!==null,Rh=0,P=O$1=N$2=null,Sh=!1,o)throw Error(p$2(300));return a}function bi(){var a=Uh!==0;return Uh=0,a}function ci(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P===null?N$2.memoizedState=P=a:P=P.next=a,P}function di(){if(O$1===null){var a=N$2.alternate;a=a!==null?a.memoizedState:null}else a=O$1.next;var o=P===null?N$2.memoizedState:P.next;if(o!==null)P=o,O$1=a;else{if(a===null)throw Error(p$2(310));O$1=a,a={memoizedState:O$1.memoizedState,baseState:O$1.baseState,baseQueue:O$1.baseQueue,queue:O$1.queue,next:null},P===null?N$2.memoizedState=P=a:P=P.next=a}return P}function ei(a,o){return typeof o=="function"?o(a):o}function fi(a){var o=di(),_e=o.queue;if(_e===null)throw Error(p$2(311));_e.lastRenderedReducer=a;var et=O$1,rt=et.baseQueue,lt=_e.pending;if(lt!==null){if(rt!==null){var it=rt.next;rt.next=lt.next,lt.next=it}et.baseQueue=rt=lt,_e.pending=null}if(rt!==null){lt=rt.next,et=et.baseState;var ut=it=null,s=null,tt=lt;do{var ot=tt.lane;if((Rh&ot)===ot)s!==null&&(s=s.next={lane:0,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null}),et=tt.hasEagerState?tt.eagerState:a(et,tt.action);else{var ct={lane:ot,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null};s===null?(ut=s=ct,it=et):s=s.next=ct,N$2.lanes|=ot,hh|=ot}tt=tt.next}while(tt!==null&&tt!==lt);s===null?it=et:s.next=ut,He(et,o.memoizedState)||(Ug=!0),o.memoizedState=et,o.baseState=it,o.baseQueue=s,_e.lastRenderedState=et}if(a=_e.interleaved,a!==null){rt=a;do lt=rt.lane,N$2.lanes|=lt,hh|=lt,rt=rt.next;while(rt!==a)}else rt===null&&(_e.lanes=0);return[o.memoizedState,_e.dispatch]}function gi(a){var o=di(),_e=o.queue;if(_e===null)throw Error(p$2(311));_e.lastRenderedReducer=a;var et=_e.dispatch,rt=_e.pending,lt=o.memoizedState;if(rt!==null){_e.pending=null;var it=rt=rt.next;do lt=a(lt,it.action),it=it.next;while(it!==rt);He(lt,o.memoizedState)||(Ug=!0),o.memoizedState=lt,o.baseQueue===null&&(o.baseState=lt),_e.lastRenderedState=lt}return[lt,et]}function hi(){}function ii(a,o){var _e=N$2,et=di(),rt=o(),lt=!He(et.memoizedState,rt);if(lt&&(et.memoizedState=rt,Ug=!0),et=et.queue,ji(ki.bind(null,_e,et,a),[a]),et.getSnapshot!==o||lt||P!==null&&P.memoizedState.tag&1){if(_e.flags|=2048,li(9,mi.bind(null,_e,et,rt,o),void 0,null),R$1===null)throw Error(p$2(349));Rh&30||ni(_e,o,rt)}return rt}function ni(a,o,_e){a.flags|=16384,a={getSnapshot:o,value:_e},o=N$2.updateQueue,o===null?(o={lastEffect:null,stores:null},N$2.updateQueue=o,o.stores=[a]):(_e=o.stores,_e===null?o.stores=[a]:_e.push(a))}function mi(a,o,_e,et){o.value=_e,o.getSnapshot=et,oi(o)&&pi(a)}function ki(a,o,_e){return _e(function(){oi(o)&&pi(a)})}function oi(a){var o=a.getSnapshot;a=a.value;try{var _e=o();return!He(a,_e)}catch{return!0}}function pi(a){var o=Zg(a,1);o!==null&&mh(o,a,1,-1)}function qi(a){var o=ci();return typeof a=="function"&&(a=a()),o.memoizedState=o.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:a},o.queue=a,a=a.dispatch=ri.bind(null,N$2,a),[o.memoizedState,a]}function li(a,o,_e,et){return a={tag:a,create:o,destroy:_e,deps:et,next:null},o=N$2.updateQueue,o===null?(o={lastEffect:null,stores:null},N$2.updateQueue=o,o.lastEffect=a.next=a):(_e=o.lastEffect,_e===null?o.lastEffect=a.next=a:(et=_e.next,_e.next=a,a.next=et,o.lastEffect=a)),a}function si(){return di().memoizedState}function ti(a,o,_e,et){var rt=ci();N$2.flags|=a,rt.memoizedState=li(1|o,_e,void 0,et===void 0?null:et)}function ui(a,o,_e,et){var rt=di();et=et===void 0?null:et;var lt=void 0;if(O$1!==null){var it=O$1.memoizedState;if(lt=it.destroy,et!==null&&Wh(et,it.deps)){rt.memoizedState=li(o,_e,lt,et);return}}N$2.flags|=a,rt.memoizedState=li(1|o,_e,lt,et)}function vi(a,o){return ti(8390656,8,a,o)}function ji(a,o){return ui(2048,8,a,o)}function wi(a,o){return ui(4,2,a,o)}function xi(a,o){return ui(4,4,a,o)}function yi(a,o){if(typeof o=="function")return a=a(),o(a),function(){o(null)};if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function zi(a,o,_e){return _e=_e!=null?_e.concat([a]):null,ui(4,4,yi.bind(null,o,a),_e)}function Ai(){}function Bi(a,o){var _e=di();o=o===void 0?null:o;var et=_e.memoizedState;return et!==null&&o!==null&&Wh(o,et[1])?et[0]:(_e.memoizedState=[a,o],a)}function Ci(a,o){var _e=di();o=o===void 0?null:o;var et=_e.memoizedState;return et!==null&&o!==null&&Wh(o,et[1])?et[0]:(a=a(),_e.memoizedState=[a,o],a)}function Di(a,o,_e){return Rh&21?(He(_e,o)||(_e=yc(),N$2.lanes|=_e,hh|=_e,a.baseState=!0),o):(a.baseState&&(a.baseState=!1,Ug=!0),a.memoizedState=_e)}function Ei(a,o){var _e=C$1;C$1=_e!==0&&4>_e?_e:4,a(!0);var et=Qh.transition;Qh.transition={};try{a(!1),o()}finally{C$1=_e,Qh.transition=et}}function Fi(){return di().memoizedState}function Gi(a,o,_e){var et=lh(a);if(_e={lane:et,action:_e,hasEagerState:!1,eagerState:null,next:null},Hi(a))Ii(o,_e);else if(_e=Yg(a,o,_e,et),_e!==null){var rt=L();mh(_e,a,et,rt),Ji(_e,o,et)}}function ri(a,o,_e){var et=lh(a),rt={lane:et,action:_e,hasEagerState:!1,eagerState:null,next:null};if(Hi(a))Ii(o,rt);else{var lt=a.alternate;if(a.lanes===0&&(lt===null||lt.lanes===0)&&(lt=o.lastRenderedReducer,lt!==null))try{var it=o.lastRenderedState,ut=lt(it,_e);if(rt.hasEagerState=!0,rt.eagerState=ut,He(ut,it)){var s=o.interleaved;s===null?(rt.next=rt,Xg(o)):(rt.next=s.next,s.next=rt),o.interleaved=rt;return}}catch{}finally{}_e=Yg(a,o,rt,et),_e!==null&&(rt=L(),mh(_e,a,et,rt),Ji(_e,o,et))}}function Hi(a){var o=a.alternate;return a===N$2||o!==null&&o===N$2}function Ii(a,o){Th=Sh=!0;var _e=a.pending;_e===null?o.next=o:(o.next=_e.next,_e.next=o),a.pending=o}function Ji(a,o,_e){if(_e&4194240){var et=o.lanes;et&=a.pendingLanes,_e|=et,o.lanes=_e,Cc(a,_e)}}var ai={readContext:Vg,useCallback:Q$1,useContext:Q$1,useEffect:Q$1,useImperativeHandle:Q$1,useInsertionEffect:Q$1,useLayoutEffect:Q$1,useMemo:Q$1,useReducer:Q$1,useRef:Q$1,useState:Q$1,useDebugValue:Q$1,useDeferredValue:Q$1,useTransition:Q$1,useMutableSource:Q$1,useSyncExternalStore:Q$1,useId:Q$1,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(a,o){return ci().memoizedState=[a,o===void 0?null:o],a},useContext:Vg,useEffect:vi,useImperativeHandle:function(a,o,_e){return _e=_e!=null?_e.concat([a]):null,ti(4194308,4,yi.bind(null,o,a),_e)},useLayoutEffect:function(a,o){return ti(4194308,4,a,o)},useInsertionEffect:function(a,o){return ti(4,2,a,o)},useMemo:function(a,o){var _e=ci();return o=o===void 0?null:o,a=a(),_e.memoizedState=[a,o],a},useReducer:function(a,o,_e){var et=ci();return o=_e!==void 0?_e(o):o,et.memoizedState=et.baseState=o,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:o},et.queue=a,a=a.dispatch=Gi.bind(null,N$2,a),[et.memoizedState,a]},useRef:function(a){var o=ci();return a={current:a},o.memoizedState=a},useState:qi,useDebugValue:Ai,useDeferredValue:function(a){return ci().memoizedState=a},useTransition:function(){var a=qi(!1),o=a[0];return a=Ei.bind(null,a[1]),ci().memoizedState=a,[o,a]},useMutableSource:function(){},useSyncExternalStore:function(a,o,_e){var et=N$2,rt=ci();if(I$1){if(_e===void 0)throw Error(p$2(407));_e=_e()}else{if(_e=o(),R$1===null)throw Error(p$2(349));Rh&30||ni(et,o,_e)}rt.memoizedState=_e;var lt={value:_e,getSnapshot:o};return rt.queue=lt,vi(ki.bind(null,et,lt,a),[a]),et.flags|=2048,li(9,mi.bind(null,et,lt,_e,o),void 0,null),_e},useId:function(){var a=ci(),o=R$1.identifierPrefix;if(I$1){var _e=sg,et=rg;_e=(et&~(1<<32-oc(et)-1)).toString(32)+_e,o=":"+o+"R"+_e,_e=Uh++,0<_e&&(o+="H"+_e.toString(32)),o+=":"}else _e=Vh++,o=":"+o+"r"+_e.toString(32)+":";return a.memoizedState=o},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(a){var o=di();return Di(o,O$1.memoizedState,a)},useTransition:function(){var a=fi(ei)[0],o=di().memoizedState;return[a,o]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(a){var o=di();return O$1===null?o.memoizedState=a:Di(o,O$1.memoizedState,a)},useTransition:function(){var a=gi(ei)[0],o=di().memoizedState;return[a,o]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(a,o){try{var _e="",et=o;do _e+=Pa(et),et=et.return;while(et);var rt=_e}catch(lt){rt=`
Error generating stack: `+lt.message+`
`+lt.stack}return{value:a,source:o,stack:rt,digest:null}}function Li(a,o,_e){return{value:a,source:null,stack:_e??null,digest:o??null}}function Mi(a,o){try{console.error(o.value)}catch(_e){setTimeout(function(){throw _e})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(a,o,_e){_e=ch(-1,_e),_e.tag=3,_e.payload={element:null};var et=o.value;return _e.callback=function(){Pi||(Pi=!0,Qi=et),Mi(a,o)},_e}function Ri(a,o,_e){_e=ch(-1,_e),_e.tag=3;var et=a.type.getDerivedStateFromError;if(typeof et=="function"){var rt=o.value;_e.payload=function(){return et(rt)},_e.callback=function(){Mi(a,o)}}var lt=a.stateNode;return lt!==null&&typeof lt.componentDidCatch=="function"&&(_e.callback=function(){Mi(a,o),typeof et!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var it=o.stack;this.componentDidCatch(o.value,{componentStack:it!==null?it:""})}),_e}function Ti(a,o,_e){var et=a.pingCache;if(et===null){et=a.pingCache=new Ni;var rt=new Set;et.set(o,rt)}else rt=et.get(o),rt===void 0&&(rt=new Set,et.set(o,rt));rt.has(_e)||(rt.add(_e),a=Ui.bind(null,a,o,_e),o.then(a,a))}function Vi(a){do{var o;if((o=a.tag===13)&&(o=a.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return a;a=a.return}while(a!==null);return null}function Wi(a,o,_e,et,rt){return a.mode&1?(a.flags|=65536,a.lanes=rt,a):(a===o?a.flags|=65536:(a.flags|=128,_e.flags|=131072,_e.flags&=-52805,_e.tag===1&&(_e.alternate===null?_e.tag=17:(o=ch(-1,1),o.tag=2,dh(_e,o,1))),_e.lanes|=1),a)}var Xi=ua$1.ReactCurrentOwner,Ug=!1;function Yi(a,o,_e,et){o.child=a===null?Ch(o,null,_e,et):Bh(o,a.child,_e,et)}function Zi(a,o,_e,et,rt){_e=_e.render;var lt=o.ref;return Tg(o,rt),et=Xh(a,o,_e,et,lt,rt),_e=bi(),a!==null&&!Ug?(o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~rt,$i(a,o,rt)):(I$1&&_e&&vg(o),o.flags|=1,Yi(a,o,et,rt),o.child)}function aj(a,o,_e,et,rt){if(a===null){var lt=_e.type;return typeof lt=="function"&&!bj(lt)&&lt.defaultProps===void 0&&_e.compare===null&&_e.defaultProps===void 0?(o.tag=15,o.type=lt,cj(a,o,lt,et,rt)):(a=yh(_e.type,null,et,o,o.mode,rt),a.ref=o.ref,a.return=o,o.child=a)}if(lt=a.child,!(a.lanes&rt)){var it=lt.memoizedProps;if(_e=_e.compare,_e=_e!==null?_e:Ie,_e(it,et)&&a.ref===o.ref)return $i(a,o,rt)}return o.flags|=1,a=wh(lt,et),a.ref=o.ref,a.return=o,o.child=a}function cj(a,o,_e,et,rt){if(a!==null){var lt=a.memoizedProps;if(Ie(lt,et)&&a.ref===o.ref)if(Ug=!1,o.pendingProps=et=lt,(a.lanes&rt)!==0)a.flags&131072&&(Ug=!0);else return o.lanes=a.lanes,$i(a,o,rt)}return dj(a,o,_e,et,rt)}function ej(a,o,_e){var et=o.pendingProps,rt=et.children,lt=a!==null?a.memoizedState:null;if(et.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(fj,gj),gj|=_e;else{if(!(_e&1073741824))return a=lt!==null?lt.baseLanes|_e:_e,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:a,cachePool:null,transitions:null},o.updateQueue=null,G$1(fj,gj),gj|=a,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},et=lt!==null?lt.baseLanes:_e,G$1(fj,gj),gj|=et}else lt!==null?(et=lt.baseLanes|_e,o.memoizedState=null):et=_e,G$1(fj,gj),gj|=et;return Yi(a,o,rt,_e),o.child}function hj(a,o){var _e=o.ref;(a===null&&_e!==null||a!==null&&a.ref!==_e)&&(o.flags|=512,o.flags|=2097152)}function dj(a,o,_e,et,rt){var lt=Zf(_e)?Xf:H.current;return lt=Yf(o,lt),Tg(o,rt),_e=Xh(a,o,_e,et,lt,rt),et=bi(),a!==null&&!Ug?(o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~rt,$i(a,o,rt)):(I$1&&et&&vg(o),o.flags|=1,Yi(a,o,_e,rt),o.child)}function ij(a,o,_e,et,rt){if(Zf(_e)){var lt=!0;cg(o)}else lt=!1;if(Tg(o,rt),o.stateNode===null)jj(a,o),ph(o,_e,et),rh(o,_e,et,rt),et=!0;else if(a===null){var it=o.stateNode,ut=o.memoizedProps;it.props=ut;var s=it.context,tt=_e.contextType;typeof tt=="object"&&tt!==null?tt=Vg(tt):(tt=Zf(_e)?Xf:H.current,tt=Yf(o,tt));var ot=_e.getDerivedStateFromProps,ct=typeof ot=="function"||typeof it.getSnapshotBeforeUpdate=="function";ct||typeof it.UNSAFE_componentWillReceiveProps!="function"&&typeof it.componentWillReceiveProps!="function"||(ut!==et||s!==tt)&&qh(o,it,et,tt),$g=!1;var yt=o.memoizedState;it.state=yt,gh(o,et,it,rt),s=o.memoizedState,ut!==et||yt!==s||Wf.current||$g?(typeof ot=="function"&&(kh(o,_e,ot,et),s=o.memoizedState),(ut=$g||oh(o,_e,ut,et,yt,s,tt))?(ct||typeof it.UNSAFE_componentWillMount!="function"&&typeof it.componentWillMount!="function"||(typeof it.componentWillMount=="function"&&it.componentWillMount(),typeof it.UNSAFE_componentWillMount=="function"&&it.UNSAFE_componentWillMount()),typeof it.componentDidMount=="function"&&(o.flags|=4194308)):(typeof it.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=et,o.memoizedState=s),it.props=et,it.state=s,it.context=tt,et=ut):(typeof it.componentDidMount=="function"&&(o.flags|=4194308),et=!1)}else{it=o.stateNode,bh(a,o),ut=o.memoizedProps,tt=o.type===o.elementType?ut:Lg(o.type,ut),it.props=tt,ct=o.pendingProps,yt=it.context,s=_e.contextType,typeof s=="object"&&s!==null?s=Vg(s):(s=Zf(_e)?Xf:H.current,s=Yf(o,s));var pt=_e.getDerivedStateFromProps;(ot=typeof pt=="function"||typeof it.getSnapshotBeforeUpdate=="function")||typeof it.UNSAFE_componentWillReceiveProps!="function"&&typeof it.componentWillReceiveProps!="function"||(ut!==ct||yt!==s)&&qh(o,it,et,s),$g=!1,yt=o.memoizedState,it.state=yt,gh(o,et,it,rt);var gt=o.memoizedState;ut!==ct||yt!==gt||Wf.current||$g?(typeof pt=="function"&&(kh(o,_e,pt,et),gt=o.memoizedState),(tt=$g||oh(o,_e,tt,et,yt,gt,s)||!1)?(ot||typeof it.UNSAFE_componentWillUpdate!="function"&&typeof it.componentWillUpdate!="function"||(typeof it.componentWillUpdate=="function"&&it.componentWillUpdate(et,gt,s),typeof it.UNSAFE_componentWillUpdate=="function"&&it.UNSAFE_componentWillUpdate(et,gt,s)),typeof it.componentDidUpdate=="function"&&(o.flags|=4),typeof it.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof it.componentDidUpdate!="function"||ut===a.memoizedProps&&yt===a.memoizedState||(o.flags|=4),typeof it.getSnapshotBeforeUpdate!="function"||ut===a.memoizedProps&&yt===a.memoizedState||(o.flags|=1024),o.memoizedProps=et,o.memoizedState=gt),it.props=et,it.state=gt,it.context=s,et=tt):(typeof it.componentDidUpdate!="function"||ut===a.memoizedProps&&yt===a.memoizedState||(o.flags|=4),typeof it.getSnapshotBeforeUpdate!="function"||ut===a.memoizedProps&&yt===a.memoizedState||(o.flags|=1024),et=!1)}return kj(a,o,_e,et,lt,rt)}function kj(a,o,_e,et,rt,lt){hj(a,o);var it=(o.flags&128)!==0;if(!et&&!it)return rt&&dg(o,_e,!1),$i(a,o,lt);et=o.stateNode,Xi.current=o;var ut=it&&typeof _e.getDerivedStateFromError!="function"?null:et.render();return o.flags|=1,a!==null&&it?(o.child=Bh(o,a.child,null,lt),o.child=Bh(o,null,ut,lt)):Yi(a,o,ut,lt),o.memoizedState=et.state,rt&&dg(o,_e,!0),o.child}function lj(a){var o=a.stateNode;o.pendingContext?ag(a,o.pendingContext,o.pendingContext!==o.context):o.context&&ag(a,o.context,!1),Ih(a,o.containerInfo)}function mj(a,o,_e,et,rt){return Ig(),Jg(rt),o.flags|=256,Yi(a,o,_e,et),o.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(a){return{baseLanes:a,cachePool:null,transitions:null}}function pj(a,o,_e){var et=o.pendingProps,rt=M$1.current,lt=!1,it=(o.flags&128)!==0,ut;if((ut=it)||(ut=a!==null&&a.memoizedState===null?!1:(rt&2)!==0),ut?(lt=!0,o.flags&=-129):(a===null||a.memoizedState!==null)&&(rt|=1),G$1(M$1,rt&1),a===null)return Eg(o),a=o.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(o.mode&1?a.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(it=et.children,a=et.fallback,lt?(et=o.mode,lt=o.child,it={mode:"hidden",children:it},!(et&1)&&lt!==null?(lt.childLanes=0,lt.pendingProps=it):lt=qj(it,et,0,null),a=Ah(a,et,_e,null),lt.return=o,a.return=o,lt.sibling=a,o.child=lt,o.child.memoizedState=oj(_e),o.memoizedState=nj,a):rj(o,it));if(rt=a.memoizedState,rt!==null&&(ut=rt.dehydrated,ut!==null))return sj(a,o,it,et,ut,rt,_e);if(lt){lt=et.fallback,it=o.mode,rt=a.child,ut=rt.sibling;var s={mode:"hidden",children:et.children};return!(it&1)&&o.child!==rt?(et=o.child,et.childLanes=0,et.pendingProps=s,o.deletions=null):(et=wh(rt,s),et.subtreeFlags=rt.subtreeFlags&14680064),ut!==null?lt=wh(ut,lt):(lt=Ah(lt,it,_e,null),lt.flags|=2),lt.return=o,et.return=o,et.sibling=lt,o.child=et,et=lt,lt=o.child,it=a.child.memoizedState,it=it===null?oj(_e):{baseLanes:it.baseLanes|_e,cachePool:null,transitions:it.transitions},lt.memoizedState=it,lt.childLanes=a.childLanes&~_e,o.memoizedState=nj,et}return lt=a.child,a=lt.sibling,et=wh(lt,{mode:"visible",children:et.children}),!(o.mode&1)&&(et.lanes=_e),et.return=o,et.sibling=null,a!==null&&(_e=o.deletions,_e===null?(o.deletions=[a],o.flags|=16):_e.push(a)),o.child=et,o.memoizedState=null,et}function rj(a,o){return o=qj({mode:"visible",children:o},a.mode,0,null),o.return=a,a.child=o}function tj(a,o,_e,et){return et!==null&&Jg(et),Bh(o,a.child,null,_e),a=rj(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function sj(a,o,_e,et,rt,lt,it){if(_e)return o.flags&256?(o.flags&=-257,et=Li(Error(p$2(422))),tj(a,o,it,et)):o.memoizedState!==null?(o.child=a.child,o.flags|=128,null):(lt=et.fallback,rt=o.mode,et=qj({mode:"visible",children:et.children},rt,0,null),lt=Ah(lt,rt,it,null),lt.flags|=2,et.return=o,lt.return=o,et.sibling=lt,o.child=et,o.mode&1&&Bh(o,a.child,null,it),o.child.memoizedState=oj(it),o.memoizedState=nj,lt);if(!(o.mode&1))return tj(a,o,it,null);if(rt.data==="$!"){if(et=rt.nextSibling&&rt.nextSibling.dataset,et)var ut=et.dgst;return et=ut,lt=Error(p$2(419)),et=Li(lt,et,void 0),tj(a,o,it,et)}if(ut=(it&a.childLanes)!==0,Ug||ut){if(et=R$1,et!==null){switch(it&-it){case 4:rt=2;break;case 16:rt=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:rt=32;break;case 536870912:rt=268435456;break;default:rt=0}rt=rt&(et.suspendedLanes|it)?0:rt,rt!==0&&rt!==lt.retryLane&&(lt.retryLane=rt,Zg(a,rt),mh(et,a,rt,-1))}return uj(),et=Li(Error(p$2(421))),tj(a,o,it,et)}return rt.data==="$?"?(o.flags|=128,o.child=a.child,o=vj.bind(null,a),rt._reactRetry=o,null):(a=lt.treeContext,yg=Lf(rt.nextSibling),xg=o,I$1=!0,zg=null,a!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=a.id,sg=a.overflow,qg=o),o=rj(o,et.children),o.flags|=4096,o)}function wj(a,o,_e){a.lanes|=o;var et=a.alternate;et!==null&&(et.lanes|=o),Sg(a.return,o,_e)}function xj(a,o,_e,et,rt){var lt=a.memoizedState;lt===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:et,tail:_e,tailMode:rt}:(lt.isBackwards=o,lt.rendering=null,lt.renderingStartTime=0,lt.last=et,lt.tail=_e,lt.tailMode=rt)}function yj(a,o,_e){var et=o.pendingProps,rt=et.revealOrder,lt=et.tail;if(Yi(a,o,et.children,_e),et=M$1.current,et&2)et=et&1|2,o.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&wj(a,_e,o);else if(a.tag===19)wj(a,_e,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}et&=1}if(G$1(M$1,et),!(o.mode&1))o.memoizedState=null;else switch(rt){case"forwards":for(_e=o.child,rt=null;_e!==null;)a=_e.alternate,a!==null&&Mh(a)===null&&(rt=_e),_e=_e.sibling;_e=rt,_e===null?(rt=o.child,o.child=null):(rt=_e.sibling,_e.sibling=null),xj(o,!1,rt,_e,lt);break;case"backwards":for(_e=null,rt=o.child,o.child=null;rt!==null;){if(a=rt.alternate,a!==null&&Mh(a)===null){o.child=rt;break}a=rt.sibling,rt.sibling=_e,_e=rt,rt=a}xj(o,!0,_e,null,lt);break;case"together":xj(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function jj(a,o){!(o.mode&1)&&a!==null&&(a.alternate=null,o.alternate=null,o.flags|=2)}function $i(a,o,_e){if(a!==null&&(o.dependencies=a.dependencies),hh|=o.lanes,!(_e&o.childLanes))return null;if(a!==null&&o.child!==a.child)throw Error(p$2(153));if(o.child!==null){for(a=o.child,_e=wh(a,a.pendingProps),o.child=_e,_e.return=o;a.sibling!==null;)a=a.sibling,_e=_e.sibling=wh(a,a.pendingProps),_e.return=o;_e.sibling=null}return o.child}function zj(a,o,_e){switch(o.tag){case 3:lj(o),Ig();break;case 5:Kh(o);break;case 1:Zf(o.type)&&cg(o);break;case 4:Ih(o,o.stateNode.containerInfo);break;case 10:var et=o.type._context,rt=o.memoizedProps.value;G$1(Mg,et._currentValue),et._currentValue=rt;break;case 13:if(et=o.memoizedState,et!==null)return et.dehydrated!==null?(G$1(M$1,M$1.current&1),o.flags|=128,null):_e&o.child.childLanes?pj(a,o,_e):(G$1(M$1,M$1.current&1),a=$i(a,o,_e),a!==null?a.sibling:null);G$1(M$1,M$1.current&1);break;case 19:if(et=(_e&o.childLanes)!==0,a.flags&128){if(et)return yj(a,o,_e);o.flags|=128}if(rt=o.memoizedState,rt!==null&&(rt.rendering=null,rt.tail=null,rt.lastEffect=null),G$1(M$1,M$1.current),et)break;return null;case 22:case 23:return o.lanes=0,ej(a,o,_e)}return $i(a,o,_e)}var Aj,Bj,Cj,Dj;Aj=function(a,o){for(var _e=o.child;_e!==null;){if(_e.tag===5||_e.tag===6)a.appendChild(_e.stateNode);else if(_e.tag!==4&&_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===o)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===o)return;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}};Bj=function(){};Cj=function(a,o,_e,et){var rt=a.memoizedProps;if(rt!==et){a=o.stateNode,Hh(Eh.current);var lt=null;switch(_e){case"input":rt=Ya(a,rt),et=Ya(a,et),lt=[];break;case"select":rt=A$3({},rt,{value:void 0}),et=A$3({},et,{value:void 0}),lt=[];break;case"textarea":rt=gb(a,rt),et=gb(a,et),lt=[];break;default:typeof rt.onClick!="function"&&typeof et.onClick=="function"&&(a.onclick=Bf)}ub(_e,et);var it;_e=null;for(tt in rt)if(!et.hasOwnProperty(tt)&&rt.hasOwnProperty(tt)&&rt[tt]!=null)if(tt==="style"){var ut=rt[tt];for(it in ut)ut.hasOwnProperty(it)&&(_e||(_e={}),_e[it]="")}else tt!=="dangerouslySetInnerHTML"&&tt!=="children"&&tt!=="suppressContentEditableWarning"&&tt!=="suppressHydrationWarning"&&tt!=="autoFocus"&&(ea.hasOwnProperty(tt)?lt||(lt=[]):(lt=lt||[]).push(tt,null));for(tt in et){var s=et[tt];if(ut=rt!=null?rt[tt]:void 0,et.hasOwnProperty(tt)&&s!==ut&&(s!=null||ut!=null))if(tt==="style")if(ut){for(it in ut)!ut.hasOwnProperty(it)||s&&s.hasOwnProperty(it)||(_e||(_e={}),_e[it]="");for(it in s)s.hasOwnProperty(it)&&ut[it]!==s[it]&&(_e||(_e={}),_e[it]=s[it])}else _e||(lt||(lt=[]),lt.push(tt,_e)),_e=s;else tt==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,ut=ut?ut.__html:void 0,s!=null&&ut!==s&&(lt=lt||[]).push(tt,s)):tt==="children"?typeof s!="string"&&typeof s!="number"||(lt=lt||[]).push(tt,""+s):tt!=="suppressContentEditableWarning"&&tt!=="suppressHydrationWarning"&&(ea.hasOwnProperty(tt)?(s!=null&&tt==="onScroll"&&D$1("scroll",a),lt||ut===s||(lt=[])):(lt=lt||[]).push(tt,s))}_e&&(lt=lt||[]).push("style",_e);var tt=lt;(o.updateQueue=tt)&&(o.flags|=4)}};Dj=function(a,o,_e,et){_e!==et&&(o.flags|=4)};function Ej(a,o){if(!I$1)switch(a.tailMode){case"hidden":o=a.tail;for(var _e=null;o!==null;)o.alternate!==null&&(_e=o),o=o.sibling;_e===null?a.tail=null:_e.sibling=null;break;case"collapsed":_e=a.tail;for(var et=null;_e!==null;)_e.alternate!==null&&(et=_e),_e=_e.sibling;et===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:et.sibling=null}}function S$2(a){var o=a.alternate!==null&&a.alternate.child===a.child,_e=0,et=0;if(o)for(var rt=a.child;rt!==null;)_e|=rt.lanes|rt.childLanes,et|=rt.subtreeFlags&14680064,et|=rt.flags&14680064,rt.return=a,rt=rt.sibling;else for(rt=a.child;rt!==null;)_e|=rt.lanes|rt.childLanes,et|=rt.subtreeFlags,et|=rt.flags,rt.return=a,rt=rt.sibling;return a.subtreeFlags|=et,a.childLanes=_e,o}function Fj(a,o,_e){var et=o.pendingProps;switch(wg(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$2(o),null;case 1:return Zf(o.type)&&$f(),S$2(o),null;case 3:return et=o.stateNode,Jh(),E(Wf),E(H),Oh(),et.pendingContext&&(et.context=et.pendingContext,et.pendingContext=null),(a===null||a.child===null)&&(Gg(o)?o.flags|=4:a===null||a.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(a,o),S$2(o),null;case 5:Lh(o);var rt=Hh(Gh.current);if(_e=o.type,a!==null&&o.stateNode!=null)Cj(a,o,_e,et,rt),a.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!et){if(o.stateNode===null)throw Error(p$2(166));return S$2(o),null}if(a=Hh(Eh.current),Gg(o)){et=o.stateNode,_e=o.type;var lt=o.memoizedProps;switch(et[Of]=o,et[Pf]=lt,a=(o.mode&1)!==0,_e){case"dialog":D$1("cancel",et),D$1("close",et);break;case"iframe":case"object":case"embed":D$1("load",et);break;case"video":case"audio":for(rt=0;rt<lf.length;rt++)D$1(lf[rt],et);break;case"source":D$1("error",et);break;case"img":case"image":case"link":D$1("error",et),D$1("load",et);break;case"details":D$1("toggle",et);break;case"input":Za(et,lt),D$1("invalid",et);break;case"select":et._wrapperState={wasMultiple:!!lt.multiple},D$1("invalid",et);break;case"textarea":hb(et,lt),D$1("invalid",et)}ub(_e,lt),rt=null;for(var it in lt)if(lt.hasOwnProperty(it)){var ut=lt[it];it==="children"?typeof ut=="string"?et.textContent!==ut&&(lt.suppressHydrationWarning!==!0&&Af(et.textContent,ut,a),rt=["children",ut]):typeof ut=="number"&&et.textContent!==""+ut&&(lt.suppressHydrationWarning!==!0&&Af(et.textContent,ut,a),rt=["children",""+ut]):ea.hasOwnProperty(it)&&ut!=null&&it==="onScroll"&&D$1("scroll",et)}switch(_e){case"input":Va(et),db(et,lt,!0);break;case"textarea":Va(et),jb(et);break;case"select":case"option":break;default:typeof lt.onClick=="function"&&(et.onclick=Bf)}et=rt,o.updateQueue=et,et!==null&&(o.flags|=4)}else{it=rt.nodeType===9?rt:rt.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=kb(_e)),a==="http://www.w3.org/1999/xhtml"?_e==="script"?(a=it.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof et.is=="string"?a=it.createElement(_e,{is:et.is}):(a=it.createElement(_e),_e==="select"&&(it=a,et.multiple?it.multiple=!0:et.size&&(it.size=et.size))):a=it.createElementNS(a,_e),a[Of]=o,a[Pf]=et,Aj(a,o,!1,!1),o.stateNode=a;e:{switch(it=vb(_e,et),_e){case"dialog":D$1("cancel",a),D$1("close",a),rt=et;break;case"iframe":case"object":case"embed":D$1("load",a),rt=et;break;case"video":case"audio":for(rt=0;rt<lf.length;rt++)D$1(lf[rt],a);rt=et;break;case"source":D$1("error",a),rt=et;break;case"img":case"image":case"link":D$1("error",a),D$1("load",a),rt=et;break;case"details":D$1("toggle",a),rt=et;break;case"input":Za(a,et),rt=Ya(a,et),D$1("invalid",a);break;case"option":rt=et;break;case"select":a._wrapperState={wasMultiple:!!et.multiple},rt=A$3({},et,{value:void 0}),D$1("invalid",a);break;case"textarea":hb(a,et),rt=gb(a,et),D$1("invalid",a);break;default:rt=et}ub(_e,rt),ut=rt;for(lt in ut)if(ut.hasOwnProperty(lt)){var s=ut[lt];lt==="style"?sb(a,s):lt==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,s!=null&&nb(a,s)):lt==="children"?typeof s=="string"?(_e!=="textarea"||s!=="")&&ob(a,s):typeof s=="number"&&ob(a,""+s):lt!=="suppressContentEditableWarning"&&lt!=="suppressHydrationWarning"&&lt!=="autoFocus"&&(ea.hasOwnProperty(lt)?s!=null&&lt==="onScroll"&&D$1("scroll",a):s!=null&&ta(a,lt,s,it))}switch(_e){case"input":Va(a),db(a,et,!1);break;case"textarea":Va(a),jb(a);break;case"option":et.value!=null&&a.setAttribute("value",""+Sa(et.value));break;case"select":a.multiple=!!et.multiple,lt=et.value,lt!=null?fb(a,!!et.multiple,lt,!1):et.defaultValue!=null&&fb(a,!!et.multiple,et.defaultValue,!0);break;default:typeof rt.onClick=="function"&&(a.onclick=Bf)}switch(_e){case"button":case"input":case"select":case"textarea":et=!!et.autoFocus;break e;case"img":et=!0;break e;default:et=!1}}et&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return S$2(o),null;case 6:if(a&&o.stateNode!=null)Dj(a,o,a.memoizedProps,et);else{if(typeof et!="string"&&o.stateNode===null)throw Error(p$2(166));if(_e=Hh(Gh.current),Hh(Eh.current),Gg(o)){if(et=o.stateNode,_e=o.memoizedProps,et[Of]=o,(lt=et.nodeValue!==_e)&&(a=xg,a!==null))switch(a.tag){case 3:Af(et.nodeValue,_e,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Af(et.nodeValue,_e,(a.mode&1)!==0)}lt&&(o.flags|=4)}else et=(_e.nodeType===9?_e:_e.ownerDocument).createTextNode(et),et[Of]=o,o.stateNode=et}return S$2(o),null;case 13:if(E(M$1),et=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(I$1&&yg!==null&&o.mode&1&&!(o.flags&128))Hg(),Ig(),o.flags|=98560,lt=!1;else if(lt=Gg(o),et!==null&&et.dehydrated!==null){if(a===null){if(!lt)throw Error(p$2(318));if(lt=o.memoizedState,lt=lt!==null?lt.dehydrated:null,!lt)throw Error(p$2(317));lt[Of]=o}else Ig(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;S$2(o),lt=!1}else zg!==null&&(Gj(zg),zg=null),lt=!0;if(!lt)return o.flags&65536?o:null}return o.flags&128?(o.lanes=_e,o):(et=et!==null,et!==(a!==null&&a.memoizedState!==null)&&et&&(o.child.flags|=8192,o.mode&1&&(a===null||M$1.current&1?T===0&&(T=3):uj())),o.updateQueue!==null&&(o.flags|=4),S$2(o),null);case 4:return Jh(),Bj(a,o),a===null&&sf(o.stateNode.containerInfo),S$2(o),null;case 10:return Rg(o.type._context),S$2(o),null;case 17:return Zf(o.type)&&$f(),S$2(o),null;case 19:if(E(M$1),lt=o.memoizedState,lt===null)return S$2(o),null;if(et=(o.flags&128)!==0,it=lt.rendering,it===null)if(et)Ej(lt,!1);else{if(T!==0||a!==null&&a.flags&128)for(a=o.child;a!==null;){if(it=Mh(a),it!==null){for(o.flags|=128,Ej(lt,!1),et=it.updateQueue,et!==null&&(o.updateQueue=et,o.flags|=4),o.subtreeFlags=0,et=_e,_e=o.child;_e!==null;)lt=_e,a=et,lt.flags&=14680066,it=lt.alternate,it===null?(lt.childLanes=0,lt.lanes=a,lt.child=null,lt.subtreeFlags=0,lt.memoizedProps=null,lt.memoizedState=null,lt.updateQueue=null,lt.dependencies=null,lt.stateNode=null):(lt.childLanes=it.childLanes,lt.lanes=it.lanes,lt.child=it.child,lt.subtreeFlags=0,lt.deletions=null,lt.memoizedProps=it.memoizedProps,lt.memoizedState=it.memoizedState,lt.updateQueue=it.updateQueue,lt.type=it.type,a=it.dependencies,lt.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),_e=_e.sibling;return G$1(M$1,M$1.current&1|2),o.child}a=a.sibling}lt.tail!==null&&B$1()>Hj&&(o.flags|=128,et=!0,Ej(lt,!1),o.lanes=4194304)}else{if(!et)if(a=Mh(it),a!==null){if(o.flags|=128,et=!0,_e=a.updateQueue,_e!==null&&(o.updateQueue=_e,o.flags|=4),Ej(lt,!0),lt.tail===null&&lt.tailMode==="hidden"&&!it.alternate&&!I$1)return S$2(o),null}else 2*B$1()-lt.renderingStartTime>Hj&&_e!==1073741824&&(o.flags|=128,et=!0,Ej(lt,!1),o.lanes=4194304);lt.isBackwards?(it.sibling=o.child,o.child=it):(_e=lt.last,_e!==null?_e.sibling=it:o.child=it,lt.last=it)}return lt.tail!==null?(o=lt.tail,lt.rendering=o,lt.tail=o.sibling,lt.renderingStartTime=B$1(),o.sibling=null,_e=M$1.current,G$1(M$1,et?_e&1|2:_e&1),o):(S$2(o),null);case 22:case 23:return Ij(),et=o.memoizedState!==null,a!==null&&a.memoizedState!==null!==et&&(o.flags|=8192),et&&o.mode&1?gj&1073741824&&(S$2(o),o.subtreeFlags&6&&(o.flags|=8192)):S$2(o),null;case 24:return null;case 25:return null}throw Error(p$2(156,o.tag))}function Jj(a,o){switch(wg(o),o.tag){case 1:return Zf(o.type)&&$f(),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return Jh(),E(Wf),E(H),Oh(),a=o.flags,a&65536&&!(a&128)?(o.flags=a&-65537|128,o):null;case 5:return Lh(o),null;case 13:if(E(M$1),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(p$2(340));Ig()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return E(M$1),null;case 4:return Jh(),null;case 10:return Rg(o.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Mj(a,o){var _e=a.ref;if(_e!==null)if(typeof _e=="function")try{_e(null)}catch(et){W$1(a,o,et)}else _e.current=null}function Nj(a,o,_e){try{_e()}catch(et){W$1(a,o,et)}}var Oj=!1;function Pj(a,o){if(Cf=dd,a=Me(),Ne(a)){if("selectionStart"in a)var _e={start:a.selectionStart,end:a.selectionEnd};else e:{_e=(_e=a.ownerDocument)&&_e.defaultView||window;var et=_e.getSelection&&_e.getSelection();if(et&&et.rangeCount!==0){_e=et.anchorNode;var rt=et.anchorOffset,lt=et.focusNode;et=et.focusOffset;try{_e.nodeType,lt.nodeType}catch{_e=null;break e}var it=0,ut=-1,s=-1,tt=0,ot=0,ct=a,yt=null;t:for(;;){for(var pt;ct!==_e||rt!==0&&ct.nodeType!==3||(ut=it+rt),ct!==lt||et!==0&&ct.nodeType!==3||(s=it+et),ct.nodeType===3&&(it+=ct.nodeValue.length),(pt=ct.firstChild)!==null;)yt=ct,ct=pt;for(;;){if(ct===a)break t;if(yt===_e&&++tt===rt&&(ut=it),yt===lt&&++ot===et&&(s=it),(pt=ct.nextSibling)!==null)break;ct=yt,yt=ct.parentNode}ct=pt}_e=ut===-1||s===-1?null:{start:ut,end:s}}else _e=null}_e=_e||{start:0,end:0}}else _e=null;for(Df={focusedElem:a,selectionRange:_e},dd=!1,V=o;V!==null;)if(o=V,a=o.child,(o.subtreeFlags&1028)!==0&&a!==null)a.return=o,V=a;else for(;V!==null;){o=V;try{var gt=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(gt!==null){var st=gt.memoizedProps,ft=gt.memoizedState,at=o.stateNode,ht=at.getSnapshotBeforeUpdate(o.elementType===o.type?st:Lg(o.type,st),ft);at.__reactInternalSnapshotBeforeUpdate=ht}break;case 3:var mt=o.stateNode.containerInfo;mt.nodeType===1?mt.textContent="":mt.nodeType===9&&mt.documentElement&&mt.removeChild(mt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$2(163))}}catch(St){W$1(o,o.return,St)}if(a=o.sibling,a!==null){a.return=o.return,V=a;break}V=o.return}return gt=Oj,Oj=!1,gt}function Qj(a,o,_e){var et=o.updateQueue;if(et=et!==null?et.lastEffect:null,et!==null){var rt=et=et.next;do{if((rt.tag&a)===a){var lt=rt.destroy;rt.destroy=void 0,lt!==void 0&&Nj(o,_e,lt)}rt=rt.next}while(rt!==et)}}function Rj(a,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var _e=o=o.next;do{if((_e.tag&a)===a){var et=_e.create;_e.destroy=et()}_e=_e.next}while(_e!==o)}}function Sj(a){var o=a.ref;if(o!==null){var _e=a.stateNode;switch(a.tag){case 5:a=_e;break;default:a=_e}typeof o=="function"?o(a):o.current=a}}function Tj(a){var o=a.alternate;o!==null&&(a.alternate=null,Tj(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&(delete o[Of],delete o[Pf],delete o[of],delete o[Qf],delete o[Rf])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function Uj(a){return a.tag===5||a.tag===3||a.tag===4}function Vj(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Uj(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Wj(a,o,_e){var et=a.tag;if(et===5||et===6)a=a.stateNode,o?_e.nodeType===8?_e.parentNode.insertBefore(a,o):_e.insertBefore(a,o):(_e.nodeType===8?(o=_e.parentNode,o.insertBefore(a,_e)):(o=_e,o.appendChild(a)),_e=_e._reactRootContainer,_e!=null||o.onclick!==null||(o.onclick=Bf));else if(et!==4&&(a=a.child,a!==null))for(Wj(a,o,_e),a=a.sibling;a!==null;)Wj(a,o,_e),a=a.sibling}function Xj(a,o,_e){var et=a.tag;if(et===5||et===6)a=a.stateNode,o?_e.insertBefore(a,o):_e.appendChild(a);else if(et!==4&&(a=a.child,a!==null))for(Xj(a,o,_e),a=a.sibling;a!==null;)Xj(a,o,_e),a=a.sibling}var X$1=null,Yj=!1;function Zj(a,o,_e){for(_e=_e.child;_e!==null;)ak(a,o,_e),_e=_e.sibling}function ak(a,o,_e){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,_e)}catch{}switch(_e.tag){case 5:U||Mj(_e,o);case 6:var et=X$1,rt=Yj;X$1=null,Zj(a,o,_e),X$1=et,Yj=rt,X$1!==null&&(Yj?(a=X$1,_e=_e.stateNode,a.nodeType===8?a.parentNode.removeChild(_e):a.removeChild(_e)):X$1.removeChild(_e.stateNode));break;case 18:X$1!==null&&(Yj?(a=X$1,_e=_e.stateNode,a.nodeType===8?Kf(a.parentNode,_e):a.nodeType===1&&Kf(a,_e),bd(a)):Kf(X$1,_e.stateNode));break;case 4:et=X$1,rt=Yj,X$1=_e.stateNode.containerInfo,Yj=!0,Zj(a,o,_e),X$1=et,Yj=rt;break;case 0:case 11:case 14:case 15:if(!U&&(et=_e.updateQueue,et!==null&&(et=et.lastEffect,et!==null))){rt=et=et.next;do{var lt=rt,it=lt.destroy;lt=lt.tag,it!==void 0&&(lt&2||lt&4)&&Nj(_e,o,it),rt=rt.next}while(rt!==et)}Zj(a,o,_e);break;case 1:if(!U&&(Mj(_e,o),et=_e.stateNode,typeof et.componentWillUnmount=="function"))try{et.props=_e.memoizedProps,et.state=_e.memoizedState,et.componentWillUnmount()}catch(ut){W$1(_e,o,ut)}Zj(a,o,_e);break;case 21:Zj(a,o,_e);break;case 22:_e.mode&1?(U=(et=U)||_e.memoizedState!==null,Zj(a,o,_e),U=et):Zj(a,o,_e);break;default:Zj(a,o,_e)}}function bk(a){var o=a.updateQueue;if(o!==null){a.updateQueue=null;var _e=a.stateNode;_e===null&&(_e=a.stateNode=new Lj),o.forEach(function(et){var rt=ck.bind(null,a,et);_e.has(et)||(_e.add(et),et.then(rt,rt))})}}function dk(a,o){var _e=o.deletions;if(_e!==null)for(var et=0;et<_e.length;et++){var rt=_e[et];try{var lt=a,it=o,ut=it;e:for(;ut!==null;){switch(ut.tag){case 5:X$1=ut.stateNode,Yj=!1;break e;case 3:X$1=ut.stateNode.containerInfo,Yj=!0;break e;case 4:X$1=ut.stateNode.containerInfo,Yj=!0;break e}ut=ut.return}if(X$1===null)throw Error(p$2(160));ak(lt,it,rt),X$1=null,Yj=!1;var s=rt.alternate;s!==null&&(s.return=null),rt.return=null}catch(tt){W$1(rt,o,tt)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)ek(o,a),o=o.sibling}function ek(a,o){var _e=a.alternate,et=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(dk(o,a),fk(a),et&4){try{Qj(3,a,a.return),Rj(3,a)}catch(st){W$1(a,a.return,st)}try{Qj(5,a,a.return)}catch(st){W$1(a,a.return,st)}}break;case 1:dk(o,a),fk(a),et&512&&_e!==null&&Mj(_e,_e.return);break;case 5:if(dk(o,a),fk(a),et&512&&_e!==null&&Mj(_e,_e.return),a.flags&32){var rt=a.stateNode;try{ob(rt,"")}catch(st){W$1(a,a.return,st)}}if(et&4&&(rt=a.stateNode,rt!=null)){var lt=a.memoizedProps,it=_e!==null?_e.memoizedProps:lt,ut=a.type,s=a.updateQueue;if(a.updateQueue=null,s!==null)try{ut==="input"&&lt.type==="radio"&&lt.name!=null&&ab(rt,lt),vb(ut,it);var tt=vb(ut,lt);for(it=0;it<s.length;it+=2){var ot=s[it],ct=s[it+1];ot==="style"?sb(rt,ct):ot==="dangerouslySetInnerHTML"?nb(rt,ct):ot==="children"?ob(rt,ct):ta(rt,ot,ct,tt)}switch(ut){case"input":bb(rt,lt);break;case"textarea":ib(rt,lt);break;case"select":var yt=rt._wrapperState.wasMultiple;rt._wrapperState.wasMultiple=!!lt.multiple;var pt=lt.value;pt!=null?fb(rt,!!lt.multiple,pt,!1):yt!==!!lt.multiple&&(lt.defaultValue!=null?fb(rt,!!lt.multiple,lt.defaultValue,!0):fb(rt,!!lt.multiple,lt.multiple?[]:"",!1))}rt[Pf]=lt}catch(st){W$1(a,a.return,st)}}break;case 6:if(dk(o,a),fk(a),et&4){if(a.stateNode===null)throw Error(p$2(162));rt=a.stateNode,lt=a.memoizedProps;try{rt.nodeValue=lt}catch(st){W$1(a,a.return,st)}}break;case 3:if(dk(o,a),fk(a),et&4&&_e!==null&&_e.memoizedState.isDehydrated)try{bd(o.containerInfo)}catch(st){W$1(a,a.return,st)}break;case 4:dk(o,a),fk(a);break;case 13:dk(o,a),fk(a),rt=a.child,rt.flags&8192&&(lt=rt.memoizedState!==null,rt.stateNode.isHidden=lt,!lt||rt.alternate!==null&&rt.alternate.memoizedState!==null||(gk=B$1())),et&4&&bk(a);break;case 22:if(ot=_e!==null&&_e.memoizedState!==null,a.mode&1?(U=(tt=U)||ot,dk(o,a),U=tt):dk(o,a),fk(a),et&8192){if(tt=a.memoizedState!==null,(a.stateNode.isHidden=tt)&&!ot&&a.mode&1)for(V=a,ot=a.child;ot!==null;){for(ct=V=ot;V!==null;){switch(yt=V,pt=yt.child,yt.tag){case 0:case 11:case 14:case 15:Qj(4,yt,yt.return);break;case 1:Mj(yt,yt.return);var gt=yt.stateNode;if(typeof gt.componentWillUnmount=="function"){et=yt,_e=yt.return;try{o=et,gt.props=o.memoizedProps,gt.state=o.memoizedState,gt.componentWillUnmount()}catch(st){W$1(et,_e,st)}}break;case 5:Mj(yt,yt.return);break;case 22:if(yt.memoizedState!==null){hk(ct);continue}}pt!==null?(pt.return=yt,V=pt):hk(ct)}ot=ot.sibling}e:for(ot=null,ct=a;;){if(ct.tag===5){if(ot===null){ot=ct;try{rt=ct.stateNode,tt?(lt=rt.style,typeof lt.setProperty=="function"?lt.setProperty("display","none","important"):lt.display="none"):(ut=ct.stateNode,s=ct.memoizedProps.style,it=s!=null&&s.hasOwnProperty("display")?s.display:null,ut.style.display=rb("display",it))}catch(st){W$1(a,a.return,st)}}}else if(ct.tag===6){if(ot===null)try{ct.stateNode.nodeValue=tt?"":ct.memoizedProps}catch(st){W$1(a,a.return,st)}}else if((ct.tag!==22&&ct.tag!==23||ct.memoizedState===null||ct===a)&&ct.child!==null){ct.child.return=ct,ct=ct.child;continue}if(ct===a)break e;for(;ct.sibling===null;){if(ct.return===null||ct.return===a)break e;ot===ct&&(ot=null),ct=ct.return}ot===ct&&(ot=null),ct.sibling.return=ct.return,ct=ct.sibling}}break;case 19:dk(o,a),fk(a),et&4&&bk(a);break;case 21:break;default:dk(o,a),fk(a)}}function fk(a){var o=a.flags;if(o&2){try{e:{for(var _e=a.return;_e!==null;){if(Uj(_e)){var et=_e;break e}_e=_e.return}throw Error(p$2(160))}switch(et.tag){case 5:var rt=et.stateNode;et.flags&32&&(ob(rt,""),et.flags&=-33);var lt=Vj(a);Xj(a,lt,rt);break;case 3:case 4:var it=et.stateNode.containerInfo,ut=Vj(a);Wj(a,ut,it);break;default:throw Error(p$2(161))}}catch(s){W$1(a,a.return,s)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function ik(a,o,_e){V=a,jk(a)}function jk(a,o,_e){for(var et=(a.mode&1)!==0;V!==null;){var rt=V,lt=rt.child;if(rt.tag===22&&et){var it=rt.memoizedState!==null||Kj;if(!it){var ut=rt.alternate,s=ut!==null&&ut.memoizedState!==null||U;ut=Kj;var tt=U;if(Kj=it,(U=s)&&!tt)for(V=rt;V!==null;)it=V,s=it.child,it.tag===22&&it.memoizedState!==null?kk(rt):s!==null?(s.return=it,V=s):kk(rt);for(;lt!==null;)V=lt,jk(lt),lt=lt.sibling;V=rt,Kj=ut,U=tt}lk(a)}else rt.subtreeFlags&8772&&lt!==null?(lt.return=rt,V=lt):lk(a)}}function lk(a){for(;V!==null;){var o=V;if(o.flags&8772){var _e=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:U||Rj(5,o);break;case 1:var et=o.stateNode;if(o.flags&4&&!U)if(_e===null)et.componentDidMount();else{var rt=o.elementType===o.type?_e.memoizedProps:Lg(o.type,_e.memoizedProps);et.componentDidUpdate(rt,_e.memoizedState,et.__reactInternalSnapshotBeforeUpdate)}var lt=o.updateQueue;lt!==null&&ih(o,lt,et);break;case 3:var it=o.updateQueue;if(it!==null){if(_e=null,o.child!==null)switch(o.child.tag){case 5:_e=o.child.stateNode;break;case 1:_e=o.child.stateNode}ih(o,it,_e)}break;case 5:var ut=o.stateNode;if(_e===null&&o.flags&4){_e=ut;var s=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":s.autoFocus&&_e.focus();break;case"img":s.src&&(_e.src=s.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var tt=o.alternate;if(tt!==null){var ot=tt.memoizedState;if(ot!==null){var ct=ot.dehydrated;ct!==null&&bd(ct)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$2(163))}U||o.flags&512&&Sj(o)}catch(yt){W$1(o,o.return,yt)}}if(o===a){V=null;break}if(_e=o.sibling,_e!==null){_e.return=o.return,V=_e;break}V=o.return}}function hk(a){for(;V!==null;){var o=V;if(o===a){V=null;break}var _e=o.sibling;if(_e!==null){_e.return=o.return,V=_e;break}V=o.return}}function kk(a){for(;V!==null;){var o=V;try{switch(o.tag){case 0:case 11:case 15:var _e=o.return;try{Rj(4,o)}catch(s){W$1(o,_e,s)}break;case 1:var et=o.stateNode;if(typeof et.componentDidMount=="function"){var rt=o.return;try{et.componentDidMount()}catch(s){W$1(o,rt,s)}}var lt=o.return;try{Sj(o)}catch(s){W$1(o,lt,s)}break;case 5:var it=o.return;try{Sj(o)}catch(s){W$1(o,it,s)}}}catch(s){W$1(o,o.return,s)}if(o===a){V=null;break}var ut=o.sibling;if(ut!==null){ut.return=o.return,V=ut;break}V=o.return}}var mk=Math.ceil,nk=ua$1.ReactCurrentDispatcher,ok=ua$1.ReactCurrentOwner,pk=ua$1.ReactCurrentBatchConfig,K$1=0,R$1=null,Y$1=null,Z$1=0,gj=0,fj=Uf(0),T=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return K$1&6?B$1():Bk!==-1?Bk:Bk=B$1()}function lh(a){return a.mode&1?K$1&2&&Z$1!==0?Z$1&-Z$1:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(a=C$1,a!==0||(a=window.event,a=a===void 0?16:jd(a.type)),a):1}function mh(a,o,_e,et){if(50<zk)throw zk=0,Ak=null,Error(p$2(185));Ac(a,_e,et),(!(K$1&2)||a!==R$1)&&(a===R$1&&(!(K$1&2)&&(rk|=_e),T===4&&Dk(a,Z$1)),Ek(a,et),_e===1&&K$1===0&&!(o.mode&1)&&(Hj=B$1()+500,fg&&jg()))}function Ek(a,o){var _e=a.callbackNode;wc(a,o);var et=uc(a,a===R$1?Z$1:0);if(et===0)_e!==null&&bc(_e),a.callbackNode=null,a.callbackPriority=0;else if(o=et&-et,a.callbackPriority!==o){if(_e!=null&&bc(_e),o===1)a.tag===0?ig(Fk.bind(null,a)):hg(Fk.bind(null,a)),Jf(function(){!(K$1&6)&&jg()}),_e=null;else{switch(Dc(et)){case 1:_e=fc;break;case 4:_e=gc;break;case 16:_e=hc;break;case 536870912:_e=jc;break;default:_e=hc}_e=Gk(_e,Hk.bind(null,a))}a.callbackPriority=o,a.callbackNode=_e}}function Hk(a,o){if(Bk=-1,Ck=0,K$1&6)throw Error(p$2(327));var _e=a.callbackNode;if(Ik()&&a.callbackNode!==_e)return null;var et=uc(a,a===R$1?Z$1:0);if(et===0)return null;if(et&30||et&a.expiredLanes||o)o=Jk(a,et);else{o=et;var rt=K$1;K$1|=2;var lt=Kk();(R$1!==a||Z$1!==o)&&(vk=null,Hj=B$1()+500,Lk(a,o));do try{Mk();break}catch(ut){Nk(a,ut)}while(1);Qg(),nk.current=lt,K$1=rt,Y$1!==null?o=0:(R$1=null,Z$1=0,o=T)}if(o!==0){if(o===2&&(rt=xc(a),rt!==0&&(et=rt,o=Ok(a,rt))),o===1)throw _e=qk,Lk(a,0),Dk(a,et),Ek(a,B$1()),_e;if(o===6)Dk(a,et);else{if(rt=a.current.alternate,!(et&30)&&!Pk(rt)&&(o=Jk(a,et),o===2&&(lt=xc(a),lt!==0&&(et=lt,o=Ok(a,lt))),o===1))throw _e=qk,Lk(a,0),Dk(a,et),Ek(a,B$1()),_e;switch(a.finishedWork=rt,a.finishedLanes=et,o){case 0:case 1:throw Error(p$2(345));case 2:Qk(a,uk,vk);break;case 3:if(Dk(a,et),(et&130023424)===et&&(o=gk+500-B$1(),10<o)){if(uc(a,0)!==0)break;if(rt=a.suspendedLanes,(rt&et)!==et){L(),a.pingedLanes|=a.suspendedLanes&rt;break}a.timeoutHandle=Ff(Qk.bind(null,a,uk,vk),o);break}Qk(a,uk,vk);break;case 4:if(Dk(a,et),(et&4194240)===et)break;for(o=a.eventTimes,rt=-1;0<et;){var it=31-oc(et);lt=1<<it,it=o[it],it>rt&&(rt=it),et&=~lt}if(et=rt,et=B$1()-et,et=(120>et?120:480>et?480:1080>et?1080:1920>et?1920:3e3>et?3e3:4320>et?4320:1960*mk(et/1960))-et,10<et){a.timeoutHandle=Ff(Qk.bind(null,a,uk,vk),et);break}Qk(a,uk,vk);break;case 5:Qk(a,uk,vk);break;default:throw Error(p$2(329))}}}return Ek(a,B$1()),a.callbackNode===_e?Hk.bind(null,a):null}function Ok(a,o){var _e=tk;return a.current.memoizedState.isDehydrated&&(Lk(a,o).flags|=256),a=Jk(a,o),a!==2&&(o=uk,uk=_e,o!==null&&Gj(o)),a}function Gj(a){uk===null?uk=a:uk.push.apply(uk,a)}function Pk(a){for(var o=a;;){if(o.flags&16384){var _e=o.updateQueue;if(_e!==null&&(_e=_e.stores,_e!==null))for(var et=0;et<_e.length;et++){var rt=_e[et],lt=rt.getSnapshot;rt=rt.value;try{if(!He(lt(),rt))return!1}catch{return!1}}}if(_e=o.child,o.subtreeFlags&16384&&_e!==null)_e.return=o,o=_e;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Dk(a,o){for(o&=~sk,o&=~rk,a.suspendedLanes|=o,a.pingedLanes&=~o,a=a.expirationTimes;0<o;){var _e=31-oc(o),et=1<<_e;a[_e]=-1,o&=~et}}function Fk(a){if(K$1&6)throw Error(p$2(327));Ik();var o=uc(a,0);if(!(o&1))return Ek(a,B$1()),null;var _e=Jk(a,o);if(a.tag!==0&&_e===2){var et=xc(a);et!==0&&(o=et,_e=Ok(a,et))}if(_e===1)throw _e=qk,Lk(a,0),Dk(a,o),Ek(a,B$1()),_e;if(_e===6)throw Error(p$2(345));return a.finishedWork=a.current.alternate,a.finishedLanes=o,Qk(a,uk,vk),Ek(a,B$1()),null}function Rk(a,o){var _e=K$1;K$1|=1;try{return a(o)}finally{K$1=_e,K$1===0&&(Hj=B$1()+500,fg&&jg())}}function Sk(a){xk!==null&&xk.tag===0&&!(K$1&6)&&Ik();var o=K$1;K$1|=1;var _e=pk.transition,et=C$1;try{if(pk.transition=null,C$1=1,a)return a()}finally{C$1=et,pk.transition=_e,K$1=o,!(K$1&6)&&jg()}}function Ij(){gj=fj.current,E(fj)}function Lk(a,o){a.finishedWork=null,a.finishedLanes=0;var _e=a.timeoutHandle;if(_e!==-1&&(a.timeoutHandle=-1,Gf(_e)),Y$1!==null)for(_e=Y$1.return;_e!==null;){var et=_e;switch(wg(et),et.tag){case 1:et=et.type.childContextTypes,et!=null&&$f();break;case 3:Jh(),E(Wf),E(H),Oh();break;case 5:Lh(et);break;case 4:Jh();break;case 13:E(M$1);break;case 19:E(M$1);break;case 10:Rg(et.type._context);break;case 22:case 23:Ij()}_e=_e.return}if(R$1=a,Y$1=a=wh(a.current,null),Z$1=gj=o,T=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(o=0;o<Wg.length;o++)if(_e=Wg[o],et=_e.interleaved,et!==null){_e.interleaved=null;var rt=et.next,lt=_e.pending;if(lt!==null){var it=lt.next;lt.next=rt,et.next=it}_e.pending=et}Wg=null}return a}function Nk(a,o){do{var _e=Y$1;try{if(Qg(),Ph.current=ai,Sh){for(var et=N$2.memoizedState;et!==null;){var rt=et.queue;rt!==null&&(rt.pending=null),et=et.next}Sh=!1}if(Rh=0,P=O$1=N$2=null,Th=!1,Uh=0,ok.current=null,_e===null||_e.return===null){T=1,qk=o,Y$1=null;break}e:{var lt=a,it=_e.return,ut=_e,s=o;if(o=Z$1,ut.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){var tt=s,ot=ut,ct=ot.tag;if(!(ot.mode&1)&&(ct===0||ct===11||ct===15)){var yt=ot.alternate;yt?(ot.updateQueue=yt.updateQueue,ot.memoizedState=yt.memoizedState,ot.lanes=yt.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var pt=Vi(it);if(pt!==null){pt.flags&=-257,Wi(pt,it,ut,lt,o),pt.mode&1&&Ti(lt,tt,o),o=pt,s=tt;var gt=o.updateQueue;if(gt===null){var st=new Set;st.add(s),o.updateQueue=st}else gt.add(s);break e}else{if(!(o&1)){Ti(lt,tt,o),uj();break e}s=Error(p$2(426))}}else if(I$1&&ut.mode&1){var ft=Vi(it);if(ft!==null){!(ft.flags&65536)&&(ft.flags|=256),Wi(ft,it,ut,lt,o),Jg(Ki(s,ut));break e}}lt=s=Ki(s,ut),T!==4&&(T=2),tk===null?tk=[lt]:tk.push(lt),lt=it;do{switch(lt.tag){case 3:lt.flags|=65536,o&=-o,lt.lanes|=o;var at=Oi(lt,s,o);fh(lt,at);break e;case 1:ut=s;var ht=lt.type,mt=lt.stateNode;if(!(lt.flags&128)&&(typeof ht.getDerivedStateFromError=="function"||mt!==null&&typeof mt.componentDidCatch=="function"&&(Si===null||!Si.has(mt)))){lt.flags|=65536,o&=-o,lt.lanes|=o;var St=Ri(lt,ut,o);fh(lt,St);break e}}lt=lt.return}while(lt!==null)}Tk(_e)}catch(It){o=It,Y$1===_e&&_e!==null&&(Y$1=_e=_e.return);continue}break}while(1)}function Kk(){var a=nk.current;return nk.current=ai,a===null?ai:a}function uj(){(T===0||T===3||T===2)&&(T=4),R$1===null||!(hh&268435455)&&!(rk&268435455)||Dk(R$1,Z$1)}function Jk(a,o){var _e=K$1;K$1|=2;var et=Kk();(R$1!==a||Z$1!==o)&&(vk=null,Lk(a,o));do try{Uk();break}catch(rt){Nk(a,rt)}while(1);if(Qg(),K$1=_e,nk.current=et,Y$1!==null)throw Error(p$2(261));return R$1=null,Z$1=0,T}function Uk(){for(;Y$1!==null;)Vk(Y$1)}function Mk(){for(;Y$1!==null&&!cc();)Vk(Y$1)}function Vk(a){var o=Wk(a.alternate,a,gj);a.memoizedProps=a.pendingProps,o===null?Tk(a):Y$1=o,ok.current=null}function Tk(a){var o=a;do{var _e=o.alternate;if(a=o.return,o.flags&32768){if(_e=Jj(_e,o),_e!==null){_e.flags&=32767,Y$1=_e;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{T=6,Y$1=null;return}}else if(_e=Fj(_e,o,gj),_e!==null){Y$1=_e;return}if(o=o.sibling,o!==null){Y$1=o;return}Y$1=o=a}while(o!==null);T===0&&(T=5)}function Qk(a,o,_e){var et=C$1,rt=pk.transition;try{pk.transition=null,C$1=1,Xk(a,o,_e,et)}finally{pk.transition=rt,C$1=et}return null}function Xk(a,o,_e,et){do Ik();while(xk!==null);if(K$1&6)throw Error(p$2(327));_e=a.finishedWork;var rt=a.finishedLanes;if(_e===null)return null;if(a.finishedWork=null,a.finishedLanes=0,_e===a.current)throw Error(p$2(177));a.callbackNode=null,a.callbackPriority=0;var lt=_e.lanes|_e.childLanes;if(Bc(a,lt),a===R$1&&(Y$1=R$1=null,Z$1=0),!(_e.subtreeFlags&2064)&&!(_e.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),lt=(_e.flags&15990)!==0,_e.subtreeFlags&15990||lt){lt=pk.transition,pk.transition=null;var it=C$1;C$1=1;var ut=K$1;K$1|=4,ok.current=null,Pj(a,_e),ek(_e,a),Oe(Df),dd=!!Cf,Df=Cf=null,a.current=_e,ik(_e),dc(),K$1=ut,C$1=it,pk.transition=lt}else a.current=_e;if(wk&&(wk=!1,xk=a,yk=rt),lt=a.pendingLanes,lt===0&&(Si=null),mc(_e.stateNode),Ek(a,B$1()),o!==null)for(et=a.onRecoverableError,_e=0;_e<o.length;_e++)rt=o[_e],et(rt.value,{componentStack:rt.stack,digest:rt.digest});if(Pi)throw Pi=!1,a=Qi,Qi=null,a;return yk&1&&a.tag!==0&&Ik(),lt=a.pendingLanes,lt&1?a===Ak?zk++:(zk=0,Ak=a):zk=0,jg(),null}function Ik(){if(xk!==null){var a=Dc(yk),o=pk.transition,_e=C$1;try{if(pk.transition=null,C$1=16>a?16:a,xk===null)var et=!1;else{if(a=xk,xk=null,yk=0,K$1&6)throw Error(p$2(331));var rt=K$1;for(K$1|=4,V=a.current;V!==null;){var lt=V,it=lt.child;if(V.flags&16){var ut=lt.deletions;if(ut!==null){for(var s=0;s<ut.length;s++){var tt=ut[s];for(V=tt;V!==null;){var ot=V;switch(ot.tag){case 0:case 11:case 15:Qj(8,ot,lt)}var ct=ot.child;if(ct!==null)ct.return=ot,V=ct;else for(;V!==null;){ot=V;var yt=ot.sibling,pt=ot.return;if(Tj(ot),ot===tt){V=null;break}if(yt!==null){yt.return=pt,V=yt;break}V=pt}}}var gt=lt.alternate;if(gt!==null){var st=gt.child;if(st!==null){gt.child=null;do{var ft=st.sibling;st.sibling=null,st=ft}while(st!==null)}}V=lt}}if(lt.subtreeFlags&2064&&it!==null)it.return=lt,V=it;else e:for(;V!==null;){if(lt=V,lt.flags&2048)switch(lt.tag){case 0:case 11:case 15:Qj(9,lt,lt.return)}var at=lt.sibling;if(at!==null){at.return=lt.return,V=at;break e}V=lt.return}}var ht=a.current;for(V=ht;V!==null;){it=V;var mt=it.child;if(it.subtreeFlags&2064&&mt!==null)mt.return=it,V=mt;else e:for(it=ht;V!==null;){if(ut=V,ut.flags&2048)try{switch(ut.tag){case 0:case 11:case 15:Rj(9,ut)}}catch(It){W$1(ut,ut.return,It)}if(ut===it){V=null;break e}var St=ut.sibling;if(St!==null){St.return=ut.return,V=St;break e}V=ut.return}}if(K$1=rt,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,a)}catch{}et=!0}return et}finally{C$1=_e,pk.transition=o}}return!1}function Yk(a,o,_e){o=Ki(_e,o),o=Oi(a,o,1),a=dh(a,o,1),o=L(),a!==null&&(Ac(a,1,o),Ek(a,o))}function W$1(a,o,_e){if(a.tag===3)Yk(a,a,_e);else for(;o!==null;){if(o.tag===3){Yk(o,a,_e);break}else if(o.tag===1){var et=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof et.componentDidCatch=="function"&&(Si===null||!Si.has(et))){a=Ki(_e,a),a=Ri(o,a,1),o=dh(o,a,1),a=L(),o!==null&&(Ac(o,1,a),Ek(o,a));break}}o=o.return}}function Ui(a,o,_e){var et=a.pingCache;et!==null&&et.delete(o),o=L(),a.pingedLanes|=a.suspendedLanes&_e,R$1===a&&(Z$1&_e)===_e&&(T===4||T===3&&(Z$1&130023424)===Z$1&&500>B$1()-gk?Lk(a,0):sk|=_e),Ek(a,o)}function Zk(a,o){o===0&&(a.mode&1?(o=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):o=1);var _e=L();a=Zg(a,o),a!==null&&(Ac(a,o,_e),Ek(a,_e))}function vj(a){var o=a.memoizedState,_e=0;o!==null&&(_e=o.retryLane),Zk(a,_e)}function ck(a,o){var _e=0;switch(a.tag){case 13:var et=a.stateNode,rt=a.memoizedState;rt!==null&&(_e=rt.retryLane);break;case 19:et=a.stateNode;break;default:throw Error(p$2(314))}et!==null&&et.delete(o),Zk(a,_e)}var Wk;Wk=function(a,o,_e){if(a!==null)if(a.memoizedProps!==o.pendingProps||Wf.current)Ug=!0;else{if(!(a.lanes&_e)&&!(o.flags&128))return Ug=!1,zj(a,o,_e);Ug=!!(a.flags&131072)}else Ug=!1,I$1&&o.flags&1048576&&ug(o,ng,o.index);switch(o.lanes=0,o.tag){case 2:var et=o.type;jj(a,o),a=o.pendingProps;var rt=Yf(o,H.current);Tg(o,_e),rt=Xh(null,o,et,a,rt,_e);var lt=bi();return o.flags|=1,typeof rt=="object"&&rt!==null&&typeof rt.render=="function"&&rt.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Zf(et)?(lt=!0,cg(o)):lt=!1,o.memoizedState=rt.state!==null&&rt.state!==void 0?rt.state:null,ah(o),rt.updater=nh,o.stateNode=rt,rt._reactInternals=o,rh(o,et,a,_e),o=kj(null,o,et,!0,lt,_e)):(o.tag=0,I$1&&lt&&vg(o),Yi(null,o,rt,_e),o=o.child),o;case 16:et=o.elementType;e:{switch(jj(a,o),a=o.pendingProps,rt=et._init,et=rt(et._payload),o.type=et,rt=o.tag=$k(et),a=Lg(et,a),rt){case 0:o=dj(null,o,et,a,_e);break e;case 1:o=ij(null,o,et,a,_e);break e;case 11:o=Zi(null,o,et,a,_e);break e;case 14:o=aj(null,o,et,Lg(et.type,a),_e);break e}throw Error(p$2(306,et,""))}return o;case 0:return et=o.type,rt=o.pendingProps,rt=o.elementType===et?rt:Lg(et,rt),dj(a,o,et,rt,_e);case 1:return et=o.type,rt=o.pendingProps,rt=o.elementType===et?rt:Lg(et,rt),ij(a,o,et,rt,_e);case 3:e:{if(lj(o),a===null)throw Error(p$2(387));et=o.pendingProps,lt=o.memoizedState,rt=lt.element,bh(a,o),gh(o,et,null,_e);var it=o.memoizedState;if(et=it.element,lt.isDehydrated)if(lt={element:et,isDehydrated:!1,cache:it.cache,pendingSuspenseBoundaries:it.pendingSuspenseBoundaries,transitions:it.transitions},o.updateQueue.baseState=lt,o.memoizedState=lt,o.flags&256){rt=Ki(Error(p$2(423)),o),o=mj(a,o,et,_e,rt);break e}else if(et!==rt){rt=Ki(Error(p$2(424)),o),o=mj(a,o,et,_e,rt);break e}else for(yg=Lf(o.stateNode.containerInfo.firstChild),xg=o,I$1=!0,zg=null,_e=Ch(o,null,et,_e),o.child=_e;_e;)_e.flags=_e.flags&-3|4096,_e=_e.sibling;else{if(Ig(),et===rt){o=$i(a,o,_e);break e}Yi(a,o,et,_e)}o=o.child}return o;case 5:return Kh(o),a===null&&Eg(o),et=o.type,rt=o.pendingProps,lt=a!==null?a.memoizedProps:null,it=rt.children,Ef(et,rt)?it=null:lt!==null&&Ef(et,lt)&&(o.flags|=32),hj(a,o),Yi(a,o,it,_e),o.child;case 6:return a===null&&Eg(o),null;case 13:return pj(a,o,_e);case 4:return Ih(o,o.stateNode.containerInfo),et=o.pendingProps,a===null?o.child=Bh(o,null,et,_e):Yi(a,o,et,_e),o.child;case 11:return et=o.type,rt=o.pendingProps,rt=o.elementType===et?rt:Lg(et,rt),Zi(a,o,et,rt,_e);case 7:return Yi(a,o,o.pendingProps,_e),o.child;case 8:return Yi(a,o,o.pendingProps.children,_e),o.child;case 12:return Yi(a,o,o.pendingProps.children,_e),o.child;case 10:e:{if(et=o.type._context,rt=o.pendingProps,lt=o.memoizedProps,it=rt.value,G$1(Mg,et._currentValue),et._currentValue=it,lt!==null)if(He(lt.value,it)){if(lt.children===rt.children&&!Wf.current){o=$i(a,o,_e);break e}}else for(lt=o.child,lt!==null&&(lt.return=o);lt!==null;){var ut=lt.dependencies;if(ut!==null){it=lt.child;for(var s=ut.firstContext;s!==null;){if(s.context===et){if(lt.tag===1){s=ch(-1,_e&-_e),s.tag=2;var tt=lt.updateQueue;if(tt!==null){tt=tt.shared;var ot=tt.pending;ot===null?s.next=s:(s.next=ot.next,ot.next=s),tt.pending=s}}lt.lanes|=_e,s=lt.alternate,s!==null&&(s.lanes|=_e),Sg(lt.return,_e,o),ut.lanes|=_e;break}s=s.next}}else if(lt.tag===10)it=lt.type===o.type?null:lt.child;else if(lt.tag===18){if(it=lt.return,it===null)throw Error(p$2(341));it.lanes|=_e,ut=it.alternate,ut!==null&&(ut.lanes|=_e),Sg(it,_e,o),it=lt.sibling}else it=lt.child;if(it!==null)it.return=lt;else for(it=lt;it!==null;){if(it===o){it=null;break}if(lt=it.sibling,lt!==null){lt.return=it.return,it=lt;break}it=it.return}lt=it}Yi(a,o,rt.children,_e),o=o.child}return o;case 9:return rt=o.type,et=o.pendingProps.children,Tg(o,_e),rt=Vg(rt),et=et(rt),o.flags|=1,Yi(a,o,et,_e),o.child;case 14:return et=o.type,rt=Lg(et,o.pendingProps),rt=Lg(et.type,rt),aj(a,o,et,rt,_e);case 15:return cj(a,o,o.type,o.pendingProps,_e);case 17:return et=o.type,rt=o.pendingProps,rt=o.elementType===et?rt:Lg(et,rt),jj(a,o),o.tag=1,Zf(et)?(a=!0,cg(o)):a=!1,Tg(o,_e),ph(o,et,rt),rh(o,et,rt,_e),kj(null,o,et,!0,a,_e);case 19:return yj(a,o,_e);case 22:return ej(a,o,_e)}throw Error(p$2(156,o.tag))};function Gk(a,o){return ac(a,o)}function al(a,o,_e,et){this.tag=a,this.key=_e,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=et,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(a,o,_e,et){return new al(a,o,_e,et)}function bj(a){return a=a.prototype,!(!a||!a.isReactComponent)}function $k(a){if(typeof a=="function")return bj(a)?1:0;if(a!=null){if(a=a.$$typeof,a===Da)return 11;if(a===Ga)return 14}return 2}function wh(a,o){var _e=a.alternate;return _e===null?(_e=Bg(a.tag,o,a.key,a.mode),_e.elementType=a.elementType,_e.type=a.type,_e.stateNode=a.stateNode,_e.alternate=a,a.alternate=_e):(_e.pendingProps=o,_e.type=a.type,_e.flags=0,_e.subtreeFlags=0,_e.deletions=null),_e.flags=a.flags&14680064,_e.childLanes=a.childLanes,_e.lanes=a.lanes,_e.child=a.child,_e.memoizedProps=a.memoizedProps,_e.memoizedState=a.memoizedState,_e.updateQueue=a.updateQueue,o=a.dependencies,_e.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},_e.sibling=a.sibling,_e.index=a.index,_e.ref=a.ref,_e}function yh(a,o,_e,et,rt,lt){var it=2;if(et=a,typeof a=="function")bj(a)&&(it=1);else if(typeof a=="string")it=5;else e:switch(a){case ya:return Ah(_e.children,rt,lt,o);case za:it=8,rt|=8;break;case Aa:return a=Bg(12,_e,o,rt|2),a.elementType=Aa,a.lanes=lt,a;case Ea:return a=Bg(13,_e,o,rt),a.elementType=Ea,a.lanes=lt,a;case Fa:return a=Bg(19,_e,o,rt),a.elementType=Fa,a.lanes=lt,a;case Ia:return qj(_e,rt,lt,o);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case Ba:it=10;break e;case Ca:it=9;break e;case Da:it=11;break e;case Ga:it=14;break e;case Ha:it=16,et=null;break e}throw Error(p$2(130,a==null?a:typeof a,""))}return o=Bg(it,_e,o,rt),o.elementType=a,o.type=et,o.lanes=lt,o}function Ah(a,o,_e,et){return a=Bg(7,a,et,o),a.lanes=_e,a}function qj(a,o,_e,et){return a=Bg(22,a,et,o),a.elementType=Ia,a.lanes=_e,a.stateNode={isHidden:!1},a}function xh(a,o,_e){return a=Bg(6,a,null,o),a.lanes=_e,a}function zh(a,o,_e){return o=Bg(4,a.children!==null?a.children:[],a.key,o),o.lanes=_e,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}function bl(a,o,_e,et,rt){this.tag=o,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=et,this.onRecoverableError=rt,this.mutableSourceEagerHydrationData=null}function cl(a,o,_e,et,rt,lt,it,ut,s){return a=new bl(a,o,_e,ut,s),o===1?(o=1,lt===!0&&(o|=8)):o=0,lt=Bg(3,null,null,o),a.current=lt,lt.stateNode=a,lt.memoizedState={element:et,isDehydrated:_e,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(lt),a}function dl(a,o,_e){var et=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:et==null?null:""+et,children:a,containerInfo:o,implementation:_e}}function el(a){if(!a)return Vf;a=a._reactInternals;e:{if(Vb(a)!==a||a.tag!==1)throw Error(p$2(170));var o=a;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Zf(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(p$2(171))}if(a.tag===1){var _e=a.type;if(Zf(_e))return bg(a,_e,o)}return o}function fl(a,o,_e,et,rt,lt,it,ut,s){return a=cl(_e,et,!0,a,rt,lt,it,ut,s),a.context=el(null),_e=a.current,et=L(),rt=lh(_e),lt=ch(et,rt),lt.callback=o??null,dh(_e,lt,rt),a.current.lanes=rt,Ac(a,rt,et),Ek(a,et),a}function gl(a,o,_e,et){var rt=o.current,lt=L(),it=lh(rt);return _e=el(_e),o.context===null?o.context=_e:o.pendingContext=_e,o=ch(lt,it),o.payload={element:a},et=et===void 0?null:et,et!==null&&(o.callback=et),a=dh(rt,o,it),a!==null&&(mh(a,rt,it,lt),eh(a,rt,it)),it}function hl(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function il(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var _e=a.retryLane;a.retryLane=_e!==0&&_e<o?_e:o}}function jl(a,o){il(a,o),(a=a.alternate)&&il(a,o)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(a){console.error(a)};function ml(a){this._internalRoot=a}nl.prototype.render=ml.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(p$2(409));gl(a,o,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;Sk(function(){gl(null,a,null,null)}),o[uf]=null}};function nl(a){this._internalRoot=a}nl.prototype.unstable_scheduleHydration=function(a){if(a){var o=Hc();a={blockedOn:null,target:a,priority:o};for(var _e=0;_e<Qc.length&&o!==0&&o<Qc[_e].priority;_e++);Qc.splice(_e,0,a),_e===0&&Vc(a)}};function ol(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function pl(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(a,o,_e,et,rt){if(rt){if(typeof et=="function"){var lt=et;et=function(){var tt=hl(it);lt.call(tt)}}var it=fl(o,et,a,0,null,!1,!1,"",ql);return a._reactRootContainer=it,a[uf]=it.current,sf(a.nodeType===8?a.parentNode:a),Sk(),it}for(;rt=a.lastChild;)a.removeChild(rt);if(typeof et=="function"){var ut=et;et=function(){var tt=hl(s);ut.call(tt)}}var s=cl(a,0,!1,null,null,!1,!1,"",ql);return a._reactRootContainer=s,a[uf]=s.current,sf(a.nodeType===8?a.parentNode:a),Sk(function(){gl(o,s,_e,et)}),s}function sl(a,o,_e,et,rt){var lt=_e._reactRootContainer;if(lt){var it=lt;if(typeof rt=="function"){var ut=rt;rt=function(){var s=hl(it);ut.call(s)}}gl(o,it,a,rt)}else it=rl(_e,o,a,rt,et);return hl(it)}Ec=function(a){switch(a.tag){case 3:var o=a.stateNode;if(o.current.memoizedState.isDehydrated){var _e=tc(o.pendingLanes);_e!==0&&(Cc(o,_e|1),Ek(o,B$1()),!(K$1&6)&&(Hj=B$1()+500,jg()))}break;case 13:Sk(function(){var et=Zg(a,1);if(et!==null){var rt=L();mh(et,a,1,rt)}}),jl(a,1)}};Fc=function(a){if(a.tag===13){var o=Zg(a,134217728);if(o!==null){var _e=L();mh(o,a,134217728,_e)}jl(a,134217728)}};Gc=function(a){if(a.tag===13){var o=lh(a),_e=Zg(a,o);if(_e!==null){var et=L();mh(_e,a,o,et)}jl(a,o)}};Hc=function(){return C$1};Ic=function(a,o){var _e=C$1;try{return C$1=a,o()}finally{C$1=_e}};yb=function(a,o,_e){switch(o){case"input":if(bb(a,_e),o=_e.name,_e.type==="radio"&&o!=null){for(_e=a;_e.parentNode;)_e=_e.parentNode;for(_e=_e.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<_e.length;o++){var et=_e[o];if(et!==a&&et.form===a.form){var rt=Db(et);if(!rt)throw Error(p$2(90));Wa(et),bb(et,rt)}}}break;case"textarea":ib(a,_e);break;case"select":o=_e.value,o!=null&&fb(a,!!_e.multiple,o,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua$1.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Zb(a),a===null?null:a.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(a,o){var _e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(o))throw Error(p$2(200));return dl(a,o,null,_e)};reactDom_production_min.createRoot=function(a,o){if(!ol(a))throw Error(p$2(299));var _e=!1,et="",rt=ll;return o!=null&&(o.unstable_strictMode===!0&&(_e=!0),o.identifierPrefix!==void 0&&(et=o.identifierPrefix),o.onRecoverableError!==void 0&&(rt=o.onRecoverableError)),o=cl(a,1,!1,null,null,_e,!1,et,rt),a[uf]=o.current,sf(a.nodeType===8?a.parentNode:a),new ml(o)};reactDom_production_min.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(p$2(188)):(a=Object.keys(a).join(","),Error(p$2(268,a)));return a=Zb(o),a=a===null?null:a.stateNode,a};reactDom_production_min.flushSync=function(a){return Sk(a)};reactDom_production_min.hydrate=function(a,o,_e){if(!pl(o))throw Error(p$2(200));return sl(null,a,o,!0,_e)};reactDom_production_min.hydrateRoot=function(a,o,_e){if(!ol(a))throw Error(p$2(405));var et=_e!=null&&_e.hydratedSources||null,rt=!1,lt="",it=ll;if(_e!=null&&(_e.unstable_strictMode===!0&&(rt=!0),_e.identifierPrefix!==void 0&&(lt=_e.identifierPrefix),_e.onRecoverableError!==void 0&&(it=_e.onRecoverableError)),o=fl(o,null,a,1,_e??null,rt,!1,lt,it),a[uf]=o.current,sf(a),et)for(a=0;a<et.length;a++)_e=et[a],rt=_e._getVersion,rt=rt(_e._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[_e,rt]:o.mutableSourceEagerHydrationData.push(_e,rt);return new nl(o)};reactDom_production_min.render=function(a,o,_e){if(!pl(o))throw Error(p$2(200));return sl(null,a,o,!1,_e)};reactDom_production_min.unmountComponentAtNode=function(a){if(!pl(a))throw Error(p$2(40));return a._reactRootContainer?(Sk(function(){sl(null,null,a,!1,function(){a._reactRootContainer=null,a[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(a,o,_e,et){if(!pl(_e))throw Error(p$2(200));if(a==null||a._reactInternals===void 0)throw Error(p$2(38));return sl(a,o,_e,!1,et)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(a){console.error(a)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs(reactDomExports);var createRoot,m$3=reactDomExports;createRoot=m$3.createRoot,m$3.hydrateRoot;/**
 * @remix-run/router v1.5.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o];for(var et in _e)Object.prototype.hasOwnProperty.call(_e,et)&&(a[et]=_e[et])}return a},_extends$3.apply(this,arguments)}var Action;(function(a){a.Pop="POP",a.Push="PUSH",a.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(a){a===void 0&&(a={});function o(et,rt){let{pathname:lt,search:it,hash:ut}=et.location;return createLocation("",{pathname:lt,search:it,hash:ut},rt.state&&rt.state.usr||null,rt.state&&rt.state.key||"default")}function _e(et,rt){return typeof rt=="string"?rt:createPath(rt)}return getUrlBasedHistory(o,_e,null,a)}function invariant(a,o){if(a===!1||a===null||typeof a>"u")throw new Error(o)}function warning(a,o){if(!a){typeof console<"u"&&console.warn(o);try{throw new Error(o)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(a,o){return{usr:a.state,key:a.key,idx:o}}function createLocation(a,o,_e,et){return _e===void 0&&(_e=null),_extends$3({pathname:typeof a=="string"?a:a.pathname,search:"",hash:""},typeof o=="string"?parsePath(o):o,{state:_e,key:o&&o.key||et||createKey()})}function createPath(a){let{pathname:o="/",search:_e="",hash:et=""}=a;return _e&&_e!=="?"&&(o+=_e.charAt(0)==="?"?_e:"?"+_e),et&&et!=="#"&&(o+=et.charAt(0)==="#"?et:"#"+et),o}function parsePath(a){let o={};if(a){let _e=a.indexOf("#");_e>=0&&(o.hash=a.substr(_e),a=a.substr(0,_e));let et=a.indexOf("?");et>=0&&(o.search=a.substr(et),a=a.substr(0,et)),a&&(o.pathname=a)}return o}function getUrlBasedHistory(a,o,_e,et){et===void 0&&(et={});let{window:rt=document.defaultView,v5Compat:lt=!1}=et,it=rt.history,ut=Action.Pop,s=null,tt=ot();tt==null&&(tt=0,it.replaceState(_extends$3({},it.state,{idx:tt}),""));function ot(){return(it.state||{idx:null}).idx}function ct(){ut=Action.Pop;let ft=ot(),at=ft==null?null:ft-tt;tt=ft,s&&s({action:ut,location:st.location,delta:at})}function yt(ft,at){ut=Action.Push;let ht=createLocation(st.location,ft,at);_e&&_e(ht,ft),tt=ot()+1;let mt=getHistoryState(ht,tt),St=st.createHref(ht);try{it.pushState(mt,"",St)}catch{rt.location.assign(St)}lt&&s&&s({action:ut,location:st.location,delta:1})}function pt(ft,at){ut=Action.Replace;let ht=createLocation(st.location,ft,at);_e&&_e(ht,ft),tt=ot();let mt=getHistoryState(ht,tt),St=st.createHref(ht);it.replaceState(mt,"",St),lt&&s&&s({action:ut,location:st.location,delta:0})}function gt(ft){let at=rt.location.origin!=="null"?rt.location.origin:rt.location.href,ht=typeof ft=="string"?ft:createPath(ft);return invariant(at,"No window.location.(origin|href) available to create URL for href: "+ht),new URL(ht,at)}let st={get action(){return ut},get location(){return a(rt,it)},listen(ft){if(s)throw new Error("A history only accepts one active listener");return rt.addEventListener(PopStateEventType,ct),s=ft,()=>{rt.removeEventListener(PopStateEventType,ct),s=null}},createHref(ft){return o(rt,ft)},createURL:gt,encodeLocation(ft){let at=gt(ft);return{pathname:at.pathname,search:at.search,hash:at.hash}},push:yt,replace:pt,go(ft){return it.go(ft)}};return st}var ResultType;(function(a){a.data="data",a.deferred="deferred",a.redirect="redirect",a.error="error"})(ResultType||(ResultType={}));function matchRoutes(a,o,_e){_e===void 0&&(_e="/");let et=typeof o=="string"?parsePath(o):o,rt=stripBasename(et.pathname||"/",_e);if(rt==null)return null;let lt=flattenRoutes(a);rankRouteBranches(lt);let it=null;for(let ut=0;it==null&&ut<lt.length;++ut)it=matchRouteBranch(lt[ut],safelyDecodeURI(rt));return it}function flattenRoutes(a,o,_e,et){o===void 0&&(o=[]),_e===void 0&&(_e=[]),et===void 0&&(et="");let rt=(lt,it,ut)=>{let s={relativePath:ut===void 0?lt.path||"":ut,caseSensitive:lt.caseSensitive===!0,childrenIndex:it,route:lt};s.relativePath.startsWith("/")&&(invariant(s.relativePath.startsWith(et),'Absolute route path "'+s.relativePath+'" nested under path '+('"'+et+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),s.relativePath=s.relativePath.slice(et.length));let tt=joinPaths([et,s.relativePath]),ot=_e.concat(s);lt.children&&lt.children.length>0&&(invariant(lt.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+tt+'".')),flattenRoutes(lt.children,o,ot,tt)),!(lt.path==null&&!lt.index)&&o.push({path:tt,score:computeScore(tt,lt.index),routesMeta:ot})};return a.forEach((lt,it)=>{var ut;if(lt.path===""||!((ut=lt.path)!=null&&ut.includes("?")))rt(lt,it);else for(let s of explodeOptionalSegments(lt.path))rt(lt,it,s)}),o}function explodeOptionalSegments(a){let o=a.split("/");if(o.length===0)return[];let[_e,...et]=o,rt=_e.endsWith("?"),lt=_e.replace(/\?$/,"");if(et.length===0)return rt?[lt,""]:[lt];let it=explodeOptionalSegments(et.join("/")),ut=[];return ut.push(...it.map(s=>s===""?lt:[lt,s].join("/"))),rt&&ut.push(...it),ut.map(s=>a.startsWith("/")&&s===""?"/":s)}function rankRouteBranches(a){a.sort((o,_e)=>o.score!==_e.score?_e.score-o.score:compareIndexes(o.routesMeta.map(et=>et.childrenIndex),_e.routesMeta.map(et=>et.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=a=>a==="*";function computeScore(a,o){let _e=a.split("/"),et=_e.length;return _e.some(isSplat)&&(et+=splatPenalty),o&&(et+=indexRouteValue),_e.filter(rt=>!isSplat(rt)).reduce((rt,lt)=>rt+(paramRe.test(lt)?dynamicSegmentValue:lt===""?emptySegmentValue:staticSegmentValue),et)}function compareIndexes(a,o){return a.length===o.length&&a.slice(0,-1).every((et,rt)=>et===o[rt])?a[a.length-1]-o[o.length-1]:0}function matchRouteBranch(a,o){let{routesMeta:_e}=a,et={},rt="/",lt=[];for(let it=0;it<_e.length;++it){let ut=_e[it],s=it===_e.length-1,tt=rt==="/"?o:o.slice(rt.length)||"/",ot=matchPath({path:ut.relativePath,caseSensitive:ut.caseSensitive,end:s},tt);if(!ot)return null;Object.assign(et,ot.params);let ct=ut.route;lt.push({params:et,pathname:joinPaths([rt,ot.pathname]),pathnameBase:normalizePathname(joinPaths([rt,ot.pathnameBase])),route:ct}),ot.pathnameBase!=="/"&&(rt=joinPaths([rt,ot.pathnameBase]))}return lt}function matchPath(a,o){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[_e,et]=compilePath(a.path,a.caseSensitive,a.end),rt=o.match(_e);if(!rt)return null;let lt=rt[0],it=lt.replace(/(.)\/+$/,"$1"),ut=rt.slice(1);return{params:et.reduce((tt,ot,ct)=>{if(ot==="*"){let yt=ut[ct]||"";it=lt.slice(0,lt.length-yt.length).replace(/(.)\/+$/,"$1")}return tt[ot]=safelyDecodeURIComponent(ut[ct]||"",ot),tt},{}),pathname:lt,pathnameBase:it,pattern:a}}function compilePath(a,o,_e){o===void 0&&(o=!1),_e===void 0&&(_e=!0),warning(a==="*"||!a.endsWith("*")||a.endsWith("/*"),'Route path "'+a+'" will be treated as if it were '+('"'+a.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+a.replace(/\*$/,"/*")+'".'));let et=[],rt="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(it,ut)=>(et.push(ut),"/([^\\/]+)"));return a.endsWith("*")?(et.push("*"),rt+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):_e?rt+="\\/*$":a!==""&&a!=="/"&&(rt+="(?:(?=\\/|$))"),[new RegExp(rt,o?void 0:"i"),et]}function safelyDecodeURI(a){try{return decodeURI(a)}catch(o){return warning(!1,'The URL path "'+a+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+o+").")),a}}function safelyDecodeURIComponent(a,o){try{return decodeURIComponent(a)}catch(_e){return warning(!1,'The value for the URL param "'+o+'" will not be decoded because'+(' the string "'+a+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+_e+").")),a}}function stripBasename(a,o){if(o==="/")return a;if(!a.toLowerCase().startsWith(o.toLowerCase()))return null;let _e=o.endsWith("/")?o.length-1:o.length,et=a.charAt(_e);return et&&et!=="/"?null:a.slice(_e)||"/"}function resolvePath(a,o){o===void 0&&(o="/");let{pathname:_e,search:et="",hash:rt=""}=typeof a=="string"?parsePath(a):a;return{pathname:_e?_e.startsWith("/")?_e:resolvePathname(_e,o):o,search:normalizeSearch(et),hash:normalizeHash(rt)}}function resolvePathname(a,o){let _e=o.replace(/\/+$/,"").split("/");return a.split("/").forEach(rt=>{rt===".."?_e.length>1&&_e.pop():rt!=="."&&_e.push(rt)}),_e.length>1?_e.join("/"):"/"}function getInvalidPathError(a,o,_e,et){return"Cannot include a '"+a+"' character in a manually specified "+("`to."+o+"` field ["+JSON.stringify(et)+"].  Please separate it out to the ")+("`to."+_e+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(a){return a.filter((o,_e)=>_e===0||o.route.path&&o.route.path.length>0)}function resolveTo(a,o,_e,et){et===void 0&&(et=!1);let rt;typeof a=="string"?rt=parsePath(a):(rt=_extends$3({},a),invariant(!rt.pathname||!rt.pathname.includes("?"),getInvalidPathError("?","pathname","search",rt)),invariant(!rt.pathname||!rt.pathname.includes("#"),getInvalidPathError("#","pathname","hash",rt)),invariant(!rt.search||!rt.search.includes("#"),getInvalidPathError("#","search","hash",rt)));let lt=a===""||rt.pathname==="",it=lt?"/":rt.pathname,ut;if(et||it==null)ut=_e;else{let ct=o.length-1;if(it.startsWith("..")){let yt=it.split("/");for(;yt[0]==="..";)yt.shift(),ct-=1;rt.pathname=yt.join("/")}ut=ct>=0?o[ct]:"/"}let s=resolvePath(rt,ut),tt=it&&it!=="/"&&it.endsWith("/"),ot=(lt||it===".")&&_e.endsWith("/");return!s.pathname.endsWith("/")&&(tt||ot)&&(s.pathname+="/"),s}const joinPaths=a=>a.join("/").replace(/\/\/+/g,"/"),normalizePathname=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,normalizeHash=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a;function isRouteErrorResponse(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.10.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function isPolyfill(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}const is=typeof Object.is=="function"?Object.is:isPolyfill,{useState,useEffect,useLayoutEffect,useDebugValue}=React$2;function useSyncExternalStore$2(a,o,_e){const et=o(),[{inst:rt},lt]=useState({inst:{value:et,getSnapshot:o}});return useLayoutEffect(()=>{rt.value=et,rt.getSnapshot=o,checkIfSnapshotChanged(rt)&&lt({inst:rt})},[a,et,o]),useEffect(()=>(checkIfSnapshotChanged(rt)&&lt({inst:rt}),a(()=>{checkIfSnapshotChanged(rt)&&lt({inst:rt})})),[a]),useDebugValue(et),et}function checkIfSnapshotChanged(a){const o=a.getSnapshot,_e=a.value;try{const et=o();return!is(_e,et)}catch{return!0}}function useSyncExternalStore$1(a,o,_e){return o()}const canUseDOM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",isServerEnvironment=!canUseDOM,shim=isServerEnvironment?useSyncExternalStore$1:useSyncExternalStore$2;"useSyncExternalStore"in React$2&&(a=>a.useSyncExternalStore)(React$2);const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[]}),RouteErrorContext=reactExports.createContext(null);function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o];for(var et in _e)Object.prototype.hasOwnProperty.call(_e,et)&&(a[et]=_e[et])}return a},_extends$2.apply(this,arguments)}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useNavigate(){useInRouterContext()||invariant(!1);let{basename:a,navigator:o}=reactExports.useContext(NavigationContext),{matches:_e}=reactExports.useContext(RouteContext),{pathname:et}=useLocation(),rt=JSON.stringify(getPathContributingMatches(_e).map(ut=>ut.pathnameBase)),lt=reactExports.useRef(!1);return reactExports.useEffect(()=>{lt.current=!0}),reactExports.useCallback(function(ut,s){if(s===void 0&&(s={}),!lt.current)return;if(typeof ut=="number"){o.go(ut);return}let tt=resolveTo(ut,JSON.parse(rt),et,s.relative==="path");a!=="/"&&(tt.pathname=tt.pathname==="/"?a:joinPaths([a,tt.pathname])),(s.replace?o.replace:o.push)(tt,s.state,s)},[a,o,rt,et])}function useParams(){let{matches:a}=reactExports.useContext(RouteContext),o=a[a.length-1];return o?o.params:{}}function useRoutes(a,o){useInRouterContext()||invariant(!1);let{navigator:_e}=reactExports.useContext(NavigationContext),et=reactExports.useContext(DataRouterStateContext),{matches:rt}=reactExports.useContext(RouteContext),lt=rt[rt.length-1],it=lt?lt.params:{};lt&&lt.pathname;let ut=lt?lt.pathnameBase:"/";lt&&lt.route;let s=useLocation(),tt;if(o){var ot;let st=typeof o=="string"?parsePath(o):o;ut==="/"||(ot=st.pathname)!=null&&ot.startsWith(ut)||invariant(!1),tt=st}else tt=s;let ct=tt.pathname||"/",yt=ut==="/"?ct:ct.slice(ut.length)||"/",pt=matchRoutes(a,{pathname:yt}),gt=_renderMatches(pt&&pt.map(st=>Object.assign({},st,{params:Object.assign({},it,st.params),pathname:joinPaths([ut,_e.encodeLocation?_e.encodeLocation(st.pathname).pathname:st.pathname]),pathnameBase:st.pathnameBase==="/"?ut:joinPaths([ut,_e.encodeLocation?_e.encodeLocation(st.pathnameBase).pathname:st.pathnameBase])})),rt,et||void 0);return o&&gt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$2({pathname:"/",search:"",hash:"",state:null,key:"default"},tt),navigationType:Action.Pop}},gt):gt}function DefaultErrorComponent(){let a=useRouteError(),o=isRouteErrorResponse(a)?a.status+" "+a.statusText:a instanceof Error?a.message:JSON.stringify(a),_e=a instanceof Error?a.stack:null,rt={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},lt=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},o),_e?reactExports.createElement("pre",{style:rt},_e):null,lt)}class RenderErrorBoundary extends reactExports.Component{constructor(o){super(o),this.state={location:o.location,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,_e){return _e.location!==o.location?{error:o.error,location:o.location}:{error:o.error||_e.error,location:_e.location}}componentDidCatch(o,_e){console.error("React Router caught the following error during render",o,_e)}render(){return this.state.error?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(a){let{routeContext:o,match:_e,children:et}=a,rt=reactExports.useContext(DataRouterContext);return rt&&rt.static&&rt.staticContext&&(_e.route.errorElement||_e.route.ErrorBoundary)&&(rt.staticContext._deepestRenderedBoundaryId=_e.route.id),reactExports.createElement(RouteContext.Provider,{value:o},et)}function _renderMatches(a,o,_e){if(o===void 0&&(o=[]),a==null)if(_e!=null&&_e.errors)a=_e.matches;else return null;let et=a,rt=_e==null?void 0:_e.errors;if(rt!=null){let lt=et.findIndex(it=>it.route.id&&(rt==null?void 0:rt[it.route.id]));lt>=0||invariant(!1),et=et.slice(0,Math.min(et.length,lt+1))}return et.reduceRight((lt,it,ut)=>{let s=it.route.id?rt==null?void 0:rt[it.route.id]:null,tt=null;_e&&(it.route.ErrorBoundary?tt=reactExports.createElement(it.route.ErrorBoundary,null):it.route.errorElement?tt=it.route.errorElement:tt=reactExports.createElement(DefaultErrorComponent,null));let ot=o.concat(et.slice(0,ut+1)),ct=()=>{let yt=lt;return s?yt=tt:it.route.Component?yt=reactExports.createElement(it.route.Component,null):it.route.element&&(yt=it.route.element),reactExports.createElement(RenderedRoute,{match:it,routeContext:{outlet:lt,matches:ot},children:yt})};return _e&&(it.route.ErrorBoundary||it.route.errorElement||ut===0)?reactExports.createElement(RenderErrorBoundary,{location:_e.location,component:tt,error:s,children:ct(),routeContext:{outlet:null,matches:ot}}):ct()},null)}var DataRouterHook$1;(function(a){a.UseBlocker="useBlocker",a.UseRevalidator="useRevalidator"})(DataRouterHook$1||(DataRouterHook$1={}));var DataRouterStateHook$1;(function(a){a.UseBlocker="useBlocker",a.UseLoaderData="useLoaderData",a.UseActionData="useActionData",a.UseRouteError="useRouteError",a.UseNavigation="useNavigation",a.UseRouteLoaderData="useRouteLoaderData",a.UseMatches="useMatches",a.UseRevalidator="useRevalidator"})(DataRouterStateHook$1||(DataRouterStateHook$1={}));function useDataRouterState(a){let o=reactExports.useContext(DataRouterStateContext);return o||invariant(!1),o}function useRouteContext(a){let o=reactExports.useContext(RouteContext);return o||invariant(!1),o}function useCurrentRouteId(a){let o=useRouteContext(),_e=o.matches[o.matches.length-1];return _e.route.id||invariant(!1),_e.route.id}function useRouteError(){var a;let o=reactExports.useContext(RouteErrorContext),_e=useDataRouterState(DataRouterStateHook$1.UseRouteError),et=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return o||((a=_e.errors)==null?void 0:a[et])}function Route(a){invariant(!1)}function Router(a){let{basename:o="/",children:_e=null,location:et,navigationType:rt=Action.Pop,navigator:lt,static:it=!1}=a;useInRouterContext()&&invariant(!1);let ut=o.replace(/^\/*/,"/"),s=reactExports.useMemo(()=>({basename:ut,navigator:lt,static:it}),[ut,lt,it]);typeof et=="string"&&(et=parsePath(et));let{pathname:tt="/",search:ot="",hash:ct="",state:yt=null,key:pt="default"}=et,gt=reactExports.useMemo(()=>{let st=stripBasename(tt,ut);return st==null?null:{location:{pathname:st,search:ot,hash:ct,state:yt,key:pt},navigationType:rt}},[ut,tt,ot,ct,yt,pt,rt]);return gt==null?null:reactExports.createElement(NavigationContext.Provider,{value:s},reactExports.createElement(LocationContext.Provider,{children:_e,value:gt}))}function Routes(a){let{children:o,location:_e}=a,et=reactExports.useContext(DataRouterContext),rt=et&&!o?et.router.routes:createRoutesFromChildren(o);return useRoutes(rt,_e)}var AwaitRenderStatus;(function(a){a[a.pending=0]="pending",a[a.success=1]="success",a[a.error=2]="error"})(AwaitRenderStatus||(AwaitRenderStatus={}));new Promise(()=>{});function createRoutesFromChildren(a,o){o===void 0&&(o=[]);let _e=[];return reactExports.Children.forEach(a,(et,rt)=>{if(!reactExports.isValidElement(et))return;let lt=[...o,rt];if(et.type===reactExports.Fragment){_e.push.apply(_e,createRoutesFromChildren(et.props.children,lt));return}et.type!==Route&&invariant(!1),!et.props.index||!et.props.children||invariant(!1);let it={id:et.props.id||lt.join("-"),caseSensitive:et.props.caseSensitive,element:et.props.element,Component:et.props.Component,index:et.props.index,path:et.props.path,loader:et.props.loader,action:et.props.action,errorElement:et.props.errorElement,ErrorBoundary:et.props.ErrorBoundary,hasErrorBoundary:et.props.ErrorBoundary!=null||et.props.errorElement!=null,shouldRevalidate:et.props.shouldRevalidate,handle:et.props.handle,lazy:et.props.lazy};et.props.children&&(it.children=createRoutesFromChildren(et.props.children,lt)),_e.push(it)}),_e}/**
 * React Router DOM v6.10.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function createSearchParams(a){return a===void 0&&(a=""),new URLSearchParams(typeof a=="string"||Array.isArray(a)||a instanceof URLSearchParams?a:Object.keys(a).reduce((o,_e)=>{let et=a[_e];return o.concat(Array.isArray(et)?et.map(rt=>[_e,rt]):[[_e,et]])},[]))}function getSearchParamsForLocation(a,o){let _e=createSearchParams(a);if(o)for(let et of o.keys())_e.has(et)||o.getAll(et).forEach(rt=>{_e.append(et,rt)});return _e}function BrowserRouter(a){let{basename:o,children:_e,window:et}=a,rt=reactExports.useRef();rt.current==null&&(rt.current=createBrowserHistory({window:et,v5Compat:!0}));let lt=rt.current,[it,ut]=reactExports.useState({action:lt.action,location:lt.location});return reactExports.useLayoutEffect(()=>lt.listen(ut),[lt]),reactExports.createElement(Router,{basename:o,children:_e,location:it.location,navigationType:it.action,navigator:lt})}var DataRouterHook;(function(a){a.UseScrollRestoration="useScrollRestoration",a.UseSubmitImpl="useSubmitImpl",a.UseFetcher="useFetcher"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(a){a.UseFetchers="useFetchers",a.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useSearchParams(a){let o=reactExports.useRef(createSearchParams(a)),_e=reactExports.useRef(!1),et=useLocation(),rt=reactExports.useMemo(()=>getSearchParamsForLocation(et.search,_e.current?null:o.current),[et.search]),lt=useNavigate(),it=reactExports.useCallback((ut,s)=>{const tt=createSearchParams(typeof ut=="function"?ut(rt):ut);_e.current=!0,lt("?"+tt,s)},[lt,rt]);return[rt,it]}var lib={},uaParser_min={exports:{}};(function(a,o){(function(_e,et){var rt="1.0.36",lt="",it="?",ut="function",s="undefined",tt="object",ot="string",ct="major",yt="model",pt="name",gt="type",st="vendor",ft="version",at="architecture",ht="console",mt="mobile",St="tablet",It="smarttv",xt="wearable",At="embedded",Nt=350,kt="Amazon",Mt="Apple",bt="ASUS",Bt="BlackBerry",Ht="Browser",Wt="Chrome",nn="Edge",gn="Firefox",tn="Google",Gt="Huawei",fn="LG",Cn="Microsoft",Tn="Motorola",dn="Opera",mn="Samsung",yn="Sharp",pn="Sony",In="Xiaomi",On="Zebra",_n="Facebook",Mn="Chromium OS",Nn="Mac OS",wn=function(xn,Un){var vn={};for(var kn in xn)Un[kn]&&Un[kn].length%2===0?vn[kn]=Un[kn].concat(xn[kn]):vn[kn]=xn[kn];return vn},Pn=function(xn){for(var Un={},vn=0;vn<xn.length;vn++)Un[xn[vn].toUpperCase()]=xn[vn];return Un},Fn=function(xn,Un){return typeof xn===ot?ar(Un).indexOf(ar(xn))!==-1:!1},ar=function(xn){return xn.toLowerCase()},Yn=function(xn){return typeof xn===ot?xn.replace(/[^\d\.]/g,lt).split(".")[0]:et},Xn=function(xn,Un){if(typeof xn===ot)return xn=xn.replace(/^\s\s*/,lt),typeof Un===s?xn:xn.substring(0,Nt)},tr=function(xn,Un){for(var vn=0,kn,qt,Rt,nt,vt,Tt;vn<Un.length&&!vt;){var Pt=Un[vn],wt=Un[vn+1];for(kn=qt=0;kn<Pt.length&&!vt&&Pt[kn];)if(vt=Pt[kn++].exec(xn),vt)for(Rt=0;Rt<wt.length;Rt++)Tt=vt[++qt],nt=wt[Rt],typeof nt===tt&&nt.length>0?nt.length===2?typeof nt[1]==ut?this[nt[0]]=nt[1].call(this,Tt):this[nt[0]]=nt[1]:nt.length===3?typeof nt[1]===ut&&!(nt[1].exec&&nt[1].test)?this[nt[0]]=Tt?nt[1].call(this,Tt,nt[2]):et:this[nt[0]]=Tt?Tt.replace(nt[1],nt[2]):et:nt.length===4&&(this[nt[0]]=Tt?nt[3].call(this,Tt.replace(nt[1],nt[2])):et):this[nt]=Tt||et;vn+=2}},cn=function(xn,Un){for(var vn in Un)if(typeof Un[vn]===tt&&Un[vn].length>0){for(var kn=0;kn<Un[vn].length;kn++)if(Fn(Un[vn][kn],xn))return vn===it?et:vn}else if(Fn(Un[vn],xn))return vn===it?et:vn;return xn},Hn={"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Qn={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},or={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[ft,[pt,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[ft,[pt,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[pt,ft],[/opios[\/ ]+([\w\.]+)/i],[ft,[pt,dn+" Mini"]],[/\bopr\/([\w\.]+)/i],[ft,[pt,dn]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[pt,ft],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[ft,[pt,"UC"+Ht]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[ft,[pt,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[ft,[pt,"WeChat"]],[/konqueror\/([\w\.]+)/i],[ft,[pt,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[ft,[pt,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[ft,[pt,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[pt,/(.+)/,"$1 Secure "+Ht],ft],[/\bfocus\/([\w\.]+)/i],[ft,[pt,gn+" Focus"]],[/\bopt\/([\w\.]+)/i],[ft,[pt,dn+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[ft,[pt,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[ft,[pt,"Dolphin"]],[/coast\/([\w\.]+)/i],[ft,[pt,dn+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[ft,[pt,"MIUI "+Ht]],[/fxios\/([-\w\.]+)/i],[ft,[pt,gn]],[/\bqihu|(qi?ho?o?|360)browser/i],[[pt,"360 "+Ht]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[pt,/(.+)/,"$1 "+Ht],ft],[/(comodo_dragon)\/([\w\.]+)/i],[[pt,/_/g," "],ft],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[pt,ft],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[pt],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[pt,_n],ft],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[pt,ft],[/\bgsa\/([\w\.]+) .*safari\//i],[ft,[pt,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[ft,[pt,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[ft,[pt,Wt+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[pt,Wt+" WebView"],ft],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[ft,[pt,"Android "+Ht]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[pt,ft],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[ft,[pt,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[ft,pt],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[pt,[ft,cn,Hn]],[/(webkit|khtml)\/([\w\.]+)/i],[pt,ft],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[pt,"Netscape"],ft],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[ft,[pt,gn+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[pt,ft],[/(cobalt)\/([\w\.]+)/i],[pt,[ft,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[at,"amd64"]],[/(ia32(?=;))/i],[[at,ar]],[/((?:i[346]|x)86)[;\)]/i],[[at,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[at,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[at,"armhf"]],[/windows (ce|mobile); ppc;/i],[[at,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[at,/ower/,lt,ar]],[/(sun4\w)[;\)]/i],[[at,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[at,ar]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[yt,[st,mn],[gt,St]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[yt,[st,mn],[gt,mt]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[yt,[st,Mt],[gt,mt]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[yt,[st,Mt],[gt,St]],[/(macintosh);/i],[yt,[st,Mt]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[yt,[st,yn],[gt,mt]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[yt,[st,Gt],[gt,St]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[yt,[st,Gt],[gt,mt]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[yt,/_/g," "],[st,In],[gt,mt]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[yt,/_/g," "],[st,In],[gt,St]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[yt,[st,"OPPO"],[gt,mt]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[yt,[st,"Vivo"],[gt,mt]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[yt,[st,"Realme"],[gt,mt]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[yt,[st,Tn],[gt,mt]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[yt,[st,Tn],[gt,St]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[yt,[st,fn],[gt,St]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[yt,[st,fn],[gt,mt]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[yt,[st,"Lenovo"],[gt,St]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[yt,/_/g," "],[st,"Nokia"],[gt,mt]],[/(pixel c)\b/i],[yt,[st,tn],[gt,St]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[yt,[st,tn],[gt,mt]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[yt,[st,pn],[gt,mt]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[yt,"Xperia Tablet"],[st,pn],[gt,St]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[yt,[st,"OnePlus"],[gt,mt]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[yt,[st,kt],[gt,St]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[yt,/(.+)/g,"Fire Phone $1"],[st,kt],[gt,mt]],[/(playbook);[-\w\),; ]+(rim)/i],[yt,st,[gt,St]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[yt,[st,Bt],[gt,mt]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[yt,[st,bt],[gt,St]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[yt,[st,bt],[gt,mt]],[/(nexus 9)/i],[yt,[st,"HTC"],[gt,St]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[st,[yt,/_/g," "],[gt,mt]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[yt,[st,"Acer"],[gt,St]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[yt,[st,"Meizu"],[gt,mt]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[st,yt,[gt,mt]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[st,yt,[gt,St]],[/(surface duo)/i],[yt,[st,Cn],[gt,St]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[yt,[st,"Fairphone"],[gt,mt]],[/(u304aa)/i],[yt,[st,"AT&T"],[gt,mt]],[/\bsie-(\w*)/i],[yt,[st,"Siemens"],[gt,mt]],[/\b(rct\w+) b/i],[yt,[st,"RCA"],[gt,St]],[/\b(venue[\d ]{2,7}) b/i],[yt,[st,"Dell"],[gt,St]],[/\b(q(?:mv|ta)\w+) b/i],[yt,[st,"Verizon"],[gt,St]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[yt,[st,"Barnes & Noble"],[gt,St]],[/\b(tm\d{3}\w+) b/i],[yt,[st,"NuVision"],[gt,St]],[/\b(k88) b/i],[yt,[st,"ZTE"],[gt,St]],[/\b(nx\d{3}j) b/i],[yt,[st,"ZTE"],[gt,mt]],[/\b(gen\d{3}) b.+49h/i],[yt,[st,"Swiss"],[gt,mt]],[/\b(zur\d{3}) b/i],[yt,[st,"Swiss"],[gt,St]],[/\b((zeki)?tb.*\b) b/i],[yt,[st,"Zeki"],[gt,St]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[st,"Dragon Touch"],yt,[gt,St]],[/\b(ns-?\w{0,9}) b/i],[yt,[st,"Insignia"],[gt,St]],[/\b((nxa|next)-?\w{0,9}) b/i],[yt,[st,"NextBook"],[gt,St]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[st,"Voice"],yt,[gt,mt]],[/\b(lvtel\-)?(v1[12]) b/i],[[st,"LvTel"],yt,[gt,mt]],[/\b(ph-1) /i],[yt,[st,"Essential"],[gt,mt]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[yt,[st,"Envizen"],[gt,St]],[/\b(trio[-\w\. ]+) b/i],[yt,[st,"MachSpeed"],[gt,St]],[/\btu_(1491) b/i],[yt,[st,"Rotor"],[gt,St]],[/(shield[\w ]+) b/i],[yt,[st,"Nvidia"],[gt,St]],[/(sprint) (\w+)/i],[st,yt,[gt,mt]],[/(kin\.[onetw]{3})/i],[[yt,/\./g," "],[st,Cn],[gt,mt]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[yt,[st,On],[gt,St]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[yt,[st,On],[gt,mt]],[/smart-tv.+(samsung)/i],[st,[gt,It]],[/hbbtv.+maple;(\d+)/i],[[yt,/^/,"SmartTV"],[st,mn],[gt,It]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[st,fn],[gt,It]],[/(apple) ?tv/i],[st,[yt,Mt+" TV"],[gt,It]],[/crkey/i],[[yt,Wt+"cast"],[st,tn],[gt,It]],[/droid.+aft(\w+)( bui|\))/i],[yt,[st,kt],[gt,It]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[yt,[st,yn],[gt,It]],[/(bravia[\w ]+)( bui|\))/i],[yt,[st,pn],[gt,It]],[/(mitv-\w{5}) bui/i],[yt,[st,In],[gt,It]],[/Hbbtv.*(technisat) (.*);/i],[st,yt,[gt,It]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[st,Xn],[yt,Xn],[gt,It]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[gt,It]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[st,yt,[gt,ht]],[/droid.+; (shield) bui/i],[yt,[st,"Nvidia"],[gt,ht]],[/(playstation [345portablevi]+)/i],[yt,[st,pn],[gt,ht]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[yt,[st,Cn],[gt,ht]],[/((pebble))app/i],[st,yt,[gt,xt]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[yt,[st,Mt],[gt,xt]],[/droid.+; (glass) \d/i],[yt,[st,tn],[gt,xt]],[/droid.+; (wt63?0{2,3})\)/i],[yt,[st,On],[gt,xt]],[/(quest( 2| pro)?)/i],[yt,[st,_n],[gt,xt]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[st,[gt,At]],[/(aeobc)\b/i],[yt,[st,kt],[gt,At]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[yt,[gt,mt]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[yt,[gt,St]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[gt,St]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[gt,mt]],[/(android[-\w\. ]{0,9});.+buil/i],[yt,[st,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[ft,[pt,nn+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[ft,[pt,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[pt,ft],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[ft,pt]],os:[[/microsoft (windows) (vista|xp)/i],[pt,ft],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[pt,[ft,cn,Qn]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[pt,"Windows"],[ft,cn,Qn]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[ft,/_/g,"."],[pt,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[pt,Nn],[ft,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[ft,pt],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[pt,ft],[/\(bb(10);/i],[ft,[pt,Bt]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[ft,[pt,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[ft,[pt,gn+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[ft,[pt,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[ft,[pt,"watchOS"]],[/crkey\/([\d\.]+)/i],[ft,[pt,Wt+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[pt,Mn],ft],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[pt,ft],[/(sunos) ?([\w\.\d]*)/i],[[pt,"Solaris"],ft],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[pt,ft]]},Wn=function(xn,Un){if(typeof xn===tt&&(Un=xn,xn=et),!(this instanceof Wn))return new Wn(xn,Un).getResult();var vn=typeof _e!==s&&_e.navigator?_e.navigator:et,kn=xn||(vn&&vn.userAgent?vn.userAgent:lt),qt=vn&&vn.userAgentData?vn.userAgentData:et,Rt=Un?wn(or,Un):or,nt=vn&&vn.userAgent==kn;return this.getBrowser=function(){var vt={};return vt[pt]=et,vt[ft]=et,tr.call(vt,kn,Rt.browser),vt[ct]=Yn(vt[ft]),nt&&vn&&vn.brave&&typeof vn.brave.isBrave==ut&&(vt[pt]="Brave"),vt},this.getCPU=function(){var vt={};return vt[at]=et,tr.call(vt,kn,Rt.cpu),vt},this.getDevice=function(){var vt={};return vt[st]=et,vt[yt]=et,vt[gt]=et,tr.call(vt,kn,Rt.device),nt&&!vt[gt]&&qt&&qt.mobile&&(vt[gt]=mt),nt&&vt[yt]=="Macintosh"&&vn&&typeof vn.standalone!==s&&vn.maxTouchPoints&&vn.maxTouchPoints>2&&(vt[yt]="iPad",vt[gt]=St),vt},this.getEngine=function(){var vt={};return vt[pt]=et,vt[ft]=et,tr.call(vt,kn,Rt.engine),vt},this.getOS=function(){var vt={};return vt[pt]=et,vt[ft]=et,tr.call(vt,kn,Rt.os),nt&&!vt[pt]&&qt&&qt.platform!="Unknown"&&(vt[pt]=qt.platform.replace(/chrome os/i,Mn).replace(/macos/i,Nn)),vt},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return kn},this.setUA=function(vt){return kn=typeof vt===ot&&vt.length>Nt?Xn(vt,Nt):vt,this},this.setUA(kn),this};Wn.VERSION=rt,Wn.BROWSER=Pn([pt,ft,ct]),Wn.CPU=Pn([at]),Wn.DEVICE=Pn([yt,st,gt,ht,mt,It,St,xt,At]),Wn.ENGINE=Wn.OS=Pn([pt,ft]),a.exports&&(o=a.exports=Wn),o.UAParser=Wn;var ir=typeof _e!==s&&(_e.jQuery||_e.Zepto);if(ir&&!ir.ua){var nr=new Wn;ir.ua=nr.getResult(),ir.ua.get=function(){return nr.getUA()},ir.ua.set=function(xn){nr.setUA(xn);var Un=nr.getResult();for(var vn in Un)ir.ua[vn]=Un[vn]}}})(typeof window=="object"?window:commonjsGlobal)})(uaParser_min,uaParser_min.exports);var uaParser_minExports=uaParser_min.exports;Object.defineProperty(lib,"__esModule",{value:!0});function _interopDefault(a){return a&&typeof a=="object"&&"default"in a?a.default:a}var React=reactExports,React__default=_interopDefault(React),UAParser$1=uaParser_minExports,ClientUAInstance=new UAParser$1,browser=ClientUAInstance.getBrowser(),cpu=ClientUAInstance.getCPU(),device=ClientUAInstance.getDevice(),engine=ClientUAInstance.getEngine(),os=ClientUAInstance.getOS(),ua=ClientUAInstance.getUA(),setUa=function(o){return ClientUAInstance.setUA(o)},parseUserAgent=function(o){if(!o){console.error("No userAgent string was provided");return}var _e=new UAParser$1(o);return{UA:_e,browser:_e.getBrowser(),cpu:_e.getCPU(),device:_e.getDevice(),engine:_e.getEngine(),os:_e.getOS(),ua:_e.getUA(),setUserAgent:function(rt){return _e.setUA(rt)}}},UAHelper=Object.freeze({ClientUAInstance,browser,cpu,device,engine,os,ua,setUa,parseUserAgent});function ownKeys(a,o){var _e=Object.keys(a);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(a);o&&(et=et.filter(function(rt){return Object.getOwnPropertyDescriptor(a,rt).enumerable})),_e.push.apply(_e,et)}return _e}function _objectSpread2(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o]!=null?arguments[o]:{};o%2?ownKeys(Object(_e),!0).forEach(function(et){_defineProperty(a,et,_e[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(_e)):ownKeys(Object(_e)).forEach(function(et){Object.defineProperty(a,et,Object.getOwnPropertyDescriptor(_e,et))})}return a}function _typeof(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof=function(o){return typeof o}:_typeof=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(a)}function _classCallCheck(a,o){if(!(a instanceof o))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,o){for(var _e=0;_e<o.length;_e++){var et=o[_e];et.enumerable=et.enumerable||!1,et.configurable=!0,"value"in et&&(et.writable=!0),Object.defineProperty(a,et.key,et)}}function _createClass(a,o,_e){return o&&_defineProperties(a.prototype,o),_e&&_defineProperties(a,_e),a}function _defineProperty(a,o,_e){return o in a?Object.defineProperty(a,o,{value:_e,enumerable:!0,configurable:!0,writable:!0}):a[o]=_e,a}function _extends$1(){return _extends$1=Object.assign||function(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o];for(var et in _e)Object.prototype.hasOwnProperty.call(_e,et)&&(a[et]=_e[et])}return a},_extends$1.apply(this,arguments)}function _inherits(a,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(o&&o.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),o&&_setPrototypeOf$1(a,o)}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(_e){return _e.__proto__||Object.getPrototypeOf(_e)},_getPrototypeOf(a)}function _setPrototypeOf$1(a,o){return _setPrototypeOf$1=Object.setPrototypeOf||function(et,rt){return et.__proto__=rt,et},_setPrototypeOf$1(a,o)}function _objectWithoutPropertiesLoose$1(a,o){if(a==null)return{};var _e={},et=Object.keys(a),rt,lt;for(lt=0;lt<et.length;lt++)rt=et[lt],!(o.indexOf(rt)>=0)&&(_e[rt]=a[rt]);return _e}function _objectWithoutProperties(a,o){if(a==null)return{};var _e=_objectWithoutPropertiesLoose$1(a,o),et,rt;if(Object.getOwnPropertySymbols){var lt=Object.getOwnPropertySymbols(a);for(rt=0;rt<lt.length;rt++)et=lt[rt],!(o.indexOf(et)>=0)&&Object.prototype.propertyIsEnumerable.call(a,et)&&(_e[et]=a[et])}return _e}function _assertThisInitialized$1(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _possibleConstructorReturn(a,o){if(o&&(typeof o=="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1(a)}function _slicedToArray(a,o){return _arrayWithHoles(a)||_iterableToArrayLimit(a,o)||_unsupportedIterableToArray(a,o)||_nonIterableRest()}function _arrayWithHoles(a){if(Array.isArray(a))return a}function _iterableToArrayLimit(a,o){var _e=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(_e!=null){var et=[],rt=!0,lt=!1,it,ut;try{for(_e=_e.call(a);!(rt=(it=_e.next()).done)&&(et.push(it.value),!(o&&et.length===o));rt=!0);}catch(s){lt=!0,ut=s}finally{try{!rt&&_e.return!=null&&_e.return()}finally{if(lt)throw ut}}return et}}function _unsupportedIterableToArray(a,o){if(a){if(typeof a=="string")return _arrayLikeToArray(a,o);var _e=Object.prototype.toString.call(a).slice(8,-1);if(_e==="Object"&&a.constructor&&(_e=a.constructor.name),_e==="Map"||_e==="Set")return Array.from(a);if(_e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_e))return _arrayLikeToArray(a,o)}}function _arrayLikeToArray(a,o){(o==null||o>a.length)&&(o=a.length);for(var _e=0,et=new Array(o);_e<o;_e++)et[_e]=a[_e];return et}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var DeviceTypes={Mobile:"mobile",Tablet:"tablet",SmartTv:"smarttv",Console:"console",Wearable:"wearable",Embedded:"embedded",Browser:void 0},BrowserTypes={Chrome:"Chrome",Firefox:"Firefox",Opera:"Opera",Yandex:"Yandex",Safari:"Safari",InternetExplorer:"Internet Explorer",Edge:"Edge",Chromium:"Chromium",Ie:"IE",MobileSafari:"Mobile Safari",EdgeChromium:"Edge Chromium",MIUI:"MIUI Browser",SamsungBrowser:"Samsung Browser"},OsTypes={IOS:"iOS",Android:"Android",WindowsPhone:"Windows Phone",Windows:"Windows",MAC_OS:"Mac OS"},InitialDeviceTypes={isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1},checkDeviceType=function(o){switch(o){case DeviceTypes.Mobile:return{isMobile:!0};case DeviceTypes.Tablet:return{isTablet:!0};case DeviceTypes.SmartTv:return{isSmartTV:!0};case DeviceTypes.Console:return{isConsole:!0};case DeviceTypes.Wearable:return{isWearable:!0};case DeviceTypes.Browser:return{isBrowser:!0};case DeviceTypes.Embedded:return{isEmbedded:!0};default:return InitialDeviceTypes}},setUserAgent=function(o){return setUa(o)},setDefaults=function(o){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none";return o||_e},getNavigatorInstance=function(){return typeof window<"u"&&(window.navigator||navigator)?window.navigator||navigator:!1},isIOS13Check=function(o){var _e=getNavigatorInstance();return _e&&_e.platform&&(_e.platform.indexOf(o)!==-1||_e.platform==="MacIntel"&&_e.maxTouchPoints>1&&!window.MSStream)},browserPayload=function(o,_e,et,rt,lt){return{isBrowser:o,browserMajorVersion:setDefaults(_e.major),browserFullVersion:setDefaults(_e.version),browserName:setDefaults(_e.name),engineName:setDefaults(et.name),engineVersion:setDefaults(et.version),osName:setDefaults(rt.name),osVersion:setDefaults(rt.version),userAgent:setDefaults(lt)}},mobilePayload=function(o,_e,et,rt){return _objectSpread2({},o,{vendor:setDefaults(_e.vendor),model:setDefaults(_e.model),os:setDefaults(et.name),osVersion:setDefaults(et.version),ua:setDefaults(rt)})},smartTvPayload=function(o,_e,et,rt){return{isSmartTV:o,engineName:setDefaults(_e.name),engineVersion:setDefaults(_e.version),osName:setDefaults(et.name),osVersion:setDefaults(et.version),userAgent:setDefaults(rt)}},consolePayload=function(o,_e,et,rt){return{isConsole:o,engineName:setDefaults(_e.name),engineVersion:setDefaults(_e.version),osName:setDefaults(et.name),osVersion:setDefaults(et.version),userAgent:setDefaults(rt)}},wearablePayload=function(o,_e,et,rt){return{isWearable:o,engineName:setDefaults(_e.name),engineVersion:setDefaults(_e.version),osName:setDefaults(et.name),osVersion:setDefaults(et.version),userAgent:setDefaults(rt)}},embeddedPayload=function(o,_e,et,rt,lt){return{isEmbedded:o,vendor:setDefaults(_e.vendor),model:setDefaults(_e.model),engineName:setDefaults(et.name),engineVersion:setDefaults(et.version),osName:setDefaults(rt.name),osVersion:setDefaults(rt.version),userAgent:setDefaults(lt)}};function deviceDetect(a){var o=a?parseUserAgent(a):UAHelper,_e=o.device,et=o.browser,rt=o.engine,lt=o.os,it=o.ua,ut=checkDeviceType(_e.type),s=ut.isBrowser,tt=ut.isMobile,ot=ut.isTablet,ct=ut.isSmartTV,yt=ut.isConsole,pt=ut.isWearable,gt=ut.isEmbedded;if(s)return browserPayload(s,et,rt,lt,it);if(ct)return smartTvPayload(ct,rt,lt,it);if(yt)return consolePayload(yt,rt,lt,it);if(tt||ot)return mobilePayload(ut,_e,lt,it);if(pt)return wearablePayload(pt,rt,lt,it);if(gt)return embeddedPayload(gt,_e,rt,lt,it)}var isMobileType=function(o){var _e=o.type;return _e===DeviceTypes.Mobile},isTabletType=function(o){var _e=o.type;return _e===DeviceTypes.Tablet},isMobileAndTabletType=function(o){var _e=o.type;return _e===DeviceTypes.Mobile||_e===DeviceTypes.Tablet},isSmartTVType=function(o){var _e=o.type;return _e===DeviceTypes.SmartTv},isBrowserType=function(o){var _e=o.type;return _e===DeviceTypes.Browser},isWearableType=function(o){var _e=o.type;return _e===DeviceTypes.Wearable},isConsoleType=function(o){var _e=o.type;return _e===DeviceTypes.Console},isEmbeddedType=function(o){var _e=o.type;return _e===DeviceTypes.Embedded},getMobileVendor=function(o){var _e=o.vendor;return setDefaults(_e)},getMobileModel=function(o){var _e=o.model;return setDefaults(_e)},getDeviceType=function(o){var _e=o.type;return setDefaults(_e,"browser")},isAndroidType=function(o){var _e=o.name;return _e===OsTypes.Android},isWindowsType=function(o){var _e=o.name;return _e===OsTypes.Windows},isMacOsType=function(o){var _e=o.name;return _e===OsTypes.MAC_OS},isWinPhoneType=function(o){var _e=o.name;return _e===OsTypes.WindowsPhone},isIOSType=function(o){var _e=o.name;return _e===OsTypes.IOS},getOsVersion=function(o){var _e=o.version;return setDefaults(_e)},getOsName=function(o){var _e=o.name;return setDefaults(_e)},isChromeType=function(o){var _e=o.name;return _e===BrowserTypes.Chrome},isFirefoxType=function(o){var _e=o.name;return _e===BrowserTypes.Firefox},isChromiumType=function(o){var _e=o.name;return _e===BrowserTypes.Chromium},isEdgeType=function(o){var _e=o.name;return _e===BrowserTypes.Edge},isYandexType=function(o){var _e=o.name;return _e===BrowserTypes.Yandex},isSafariType=function(o){var _e=o.name;return _e===BrowserTypes.Safari||_e===BrowserTypes.MobileSafari},isMobileSafariType=function(o){var _e=o.name;return _e===BrowserTypes.MobileSafari},isOperaType=function(o){var _e=o.name;return _e===BrowserTypes.Opera},isIEType=function(o){var _e=o.name;return _e===BrowserTypes.InternetExplorer||_e===BrowserTypes.Ie},isMIUIType=function(o){var _e=o.name;return _e===BrowserTypes.MIUI},isSamsungBrowserType=function(o){var _e=o.name;return _e===BrowserTypes.SamsungBrowser},getBrowserFullVersion=function(o){var _e=o.version;return setDefaults(_e)},getBrowserVersion=function(o){var _e=o.major;return setDefaults(_e)},getBrowserName=function(o){var _e=o.name;return setDefaults(_e)},getEngineName=function(o){var _e=o.name;return setDefaults(_e)},getEngineVersion=function(o){var _e=o.version;return setDefaults(_e)},isElectronType=function(){var o=getNavigatorInstance(),_e=o&&o.userAgent&&o.userAgent.toLowerCase();return typeof _e=="string"?/electron/.test(_e):!1},isEdgeChromiumType=function(o){return typeof o=="string"&&o.indexOf("Edg/")!==-1},getIOS13=function(){var o=getNavigatorInstance();return o&&(/iPad|iPhone|iPod/.test(o.platform)||o.platform==="MacIntel"&&o.maxTouchPoints>1)&&!window.MSStream},getIPad13=function(){return isIOS13Check("iPad")},getIphone13=function(){return isIOS13Check("iPhone")},getIPod13=function(){return isIOS13Check("iPod")},getUseragent=function(o){return setDefaults(o)};function buildSelectorsObject(a){var o=a||UAHelper,_e=o.device,et=o.browser,rt=o.os,lt=o.engine,it=o.ua;return{isSmartTV:isSmartTVType(_e),isConsole:isConsoleType(_e),isWearable:isWearableType(_e),isEmbedded:isEmbeddedType(_e),isMobileSafari:isMobileSafariType(et)||getIPad13(),isChromium:isChromiumType(et),isMobile:isMobileAndTabletType(_e)||getIPad13(),isMobileOnly:isMobileType(_e),isTablet:isTabletType(_e)||getIPad13(),isBrowser:isBrowserType(_e),isDesktop:isBrowserType(_e),isAndroid:isAndroidType(rt),isWinPhone:isWinPhoneType(rt),isIOS:isIOSType(rt)||getIPad13(),isChrome:isChromeType(et),isFirefox:isFirefoxType(et),isSafari:isSafariType(et),isOpera:isOperaType(et),isIE:isIEType(et),osVersion:getOsVersion(rt),osName:getOsName(rt),fullBrowserVersion:getBrowserFullVersion(et),browserVersion:getBrowserVersion(et),browserName:getBrowserName(et),mobileVendor:getMobileVendor(_e),mobileModel:getMobileModel(_e),engineName:getEngineName(lt),engineVersion:getEngineVersion(lt),getUA:getUseragent(it),isEdge:isEdgeType(et)||isEdgeChromiumType(it),isYandex:isYandexType(et),deviceType:getDeviceType(_e),isIOS13:getIOS13(),isIPad13:getIPad13(),isIPhone13:getIphone13(),isIPod13:getIPod13(),isElectron:isElectronType(),isEdgeChromium:isEdgeChromiumType(it),isLegacyEdge:isEdgeType(et)&&!isEdgeChromiumType(it),isWindows:isWindowsType(rt),isMacOs:isMacOsType(rt),isMIUI:isMIUIType(et),isSamsungBrowser:isSamsungBrowserType(et)}}var isSmartTV=isSmartTVType(device),isConsole=isConsoleType(device),isWearable=isWearableType(device),isEmbedded=isEmbeddedType(device),isMobileSafari=isMobileSafariType(browser)||getIPad13(),isChromium=isChromiumType(browser),isMobile=isMobileAndTabletType(device)||getIPad13(),isMobileOnly=isMobileType(device),isTablet=isTabletType(device)||getIPad13(),isBrowser$1=isBrowserType(device),isDesktop=isBrowserType(device),isAndroid=isAndroidType(os),isWinPhone=isWinPhoneType(os),isIOS=isIOSType(os)||getIPad13(),isChrome=isChromeType(browser),isFirefox=isFirefoxType(browser),isSafari=isSafariType(browser),isOpera=isOperaType(browser),isIE=isIEType(browser),osVersion=getOsVersion(os),osName=getOsName(os),fullBrowserVersion=getBrowserFullVersion(browser),browserVersion=getBrowserVersion(browser),browserName=getBrowserName(browser),mobileVendor=getMobileVendor(device),mobileModel=getMobileModel(device),engineName=getEngineName(engine),engineVersion=getEngineVersion(engine),getUA=getUseragent(ua),isEdge=isEdgeType(browser)||isEdgeChromiumType(ua),isYandex=isYandexType(browser),deviceType=getDeviceType(device),isIOS13=getIOS13(),isIPad13=getIPad13(),isIPhone13=getIphone13(),isIPod13=getIPod13(),isElectron=isElectronType(),isEdgeChromium=isEdgeChromiumType(ua),isLegacyEdge=isEdgeType(browser)&&!isEdgeChromiumType(ua),isWindows=isWindowsType(os),isMacOs=isMacOsType(os),isMIUI=isMIUIType(browser),isSamsungBrowser=isSamsungBrowserType(browser),getSelectorsByUserAgent=function(o){if(!o||typeof o!="string"){console.error("No valid user agent string was provided");return}var _e=parseUserAgent(o),et=_e.device,rt=_e.browser,lt=_e.os,it=_e.engine,ut=_e.ua;return buildSelectorsObject({device:et,browser:rt,os:lt,engine:it,ua:ut})},AndroidView=function(o){var _e=o.renderWithFragment,et=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isAndroid?_e?React__default.createElement(React.Fragment,null,et):React__default.createElement("div",rt,et):null},BrowserView=function(o){var _e=o.renderWithFragment,et=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isBrowser$1?_e?React__default.createElement(React.Fragment,null,et):React__default.createElement("div",rt,et):null},IEView=function(o){var _e=o.renderWithFragment,et=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isIE?_e?React__default.createElement(React.Fragment,null,et):React__default.createElement("div",rt,et):null},IOSView=function(o){var _e=o.renderWithFragment,et=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isIOS?_e?React__default.createElement(React.Fragment,null,et):React__default.createElement("div",rt,et):null},MobileView=function(o){var _e=o.renderWithFragment,et=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isMobile?_e?React__default.createElement(React.Fragment,null,et):React__default.createElement("div",rt,et):null},TabletView=function(o){var _e=o.renderWithFragment,et=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isTablet?_e?React__default.createElement(React.Fragment,null,et):React__default.createElement("div",rt,et):null},WinPhoneView=function(o){var _e=o.renderWithFragment,et=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isWinPhone?_e?React__default.createElement(React.Fragment,null,et):React__default.createElement("div",rt,et):null},MobileOnlyView=function(o){var _e=o.renderWithFragment,et=o.children;o.viewClassName,o.style;var rt=_objectWithoutProperties(o,["renderWithFragment","children","viewClassName","style"]);return isMobileOnly?_e?React__default.createElement(React.Fragment,null,et):React__default.createElement("div",rt,et):null},SmartTVView=function(o){var _e=o.renderWithFragment,et=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isSmartTV?_e?React__default.createElement(React.Fragment,null,et):React__default.createElement("div",rt,et):null},ConsoleView=function(o){var _e=o.renderWithFragment,et=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isConsole?_e?React__default.createElement(React.Fragment,null,et):React__default.createElement("div",rt,et):null},WearableView=function(o){var _e=o.renderWithFragment,et=o.children,rt=_objectWithoutProperties(o,["renderWithFragment","children"]);return isWearable?_e?React__default.createElement(React.Fragment,null,et):React__default.createElement("div",rt,et):null},CustomView=function(o){var _e=o.renderWithFragment,et=o.children;o.viewClassName,o.style;var rt=o.condition,lt=_objectWithoutProperties(o,["renderWithFragment","children","viewClassName","style","condition"]);return rt?_e?React__default.createElement(React.Fragment,null,et):React__default.createElement("div",lt,et):null};function withOrientationChange(a){return function(o){_inherits(_e,o);function _e(et){var rt;return _classCallCheck(this,_e),rt=_possibleConstructorReturn(this,_getPrototypeOf(_e).call(this,et)),rt.isEventListenerAdded=!1,rt.handleOrientationChange=rt.handleOrientationChange.bind(_assertThisInitialized$1(rt)),rt.onOrientationChange=rt.onOrientationChange.bind(_assertThisInitialized$1(rt)),rt.onPageLoad=rt.onPageLoad.bind(_assertThisInitialized$1(rt)),rt.state={isLandscape:!1,isPortrait:!1},rt}return _createClass(_e,[{key:"handleOrientationChange",value:function(){this.isEventListenerAdded||(this.isEventListenerAdded=!0);var rt=window.innerWidth>window.innerHeight?90:0;this.setState({isPortrait:rt===0,isLandscape:rt===90})}},{key:"onOrientationChange",value:function(){this.handleOrientationChange()}},{key:"onPageLoad",value:function(){this.handleOrientationChange()}},{key:"componentDidMount",value:function(){(typeof window>"u"?"undefined":_typeof(window))!==void 0&&isMobile&&(this.isEventListenerAdded?window.removeEventListener("load",this.onPageLoad,!1):(this.handleOrientationChange(),window.addEventListener("load",this.onPageLoad,!1)),window.addEventListener("resize",this.onOrientationChange,!1))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onOrientationChange,!1)}},{key:"render",value:function(){return React__default.createElement(a,_extends$1({},this.props,{isLandscape:this.state.isLandscape,isPortrait:this.state.isPortrait}))}}]),_e}(React__default.Component)}function useMobileOrientation(){var a=React.useState(function(){var lt=window.innerWidth>window.innerHeight?90:0;return{isPortrait:lt===0,isLandscape:lt===90,orientation:lt===0?"portrait":"landscape"}}),o=_slicedToArray(a,2),_e=o[0],et=o[1],rt=React.useCallback(function(){var lt=window.innerWidth>window.innerHeight?90:0,it={isPortrait:lt===0,isLandscape:lt===90,orientation:lt===0?"portrait":"landscape"};_e.orientation!==it.orientation&&et(it)},[_e.orientation]);return React.useEffect(function(){return(typeof window>"u"?"undefined":_typeof(window))!==void 0&&isMobile&&(rt(),window.addEventListener("load",rt,!1),window.addEventListener("resize",rt,!1)),function(){window.removeEventListener("resize",rt,!1),window.removeEventListener("load",rt,!1)}},[rt]),_e}function useDeviceData(a){var o=a||window.navigator.userAgent;return parseUserAgent(o)}function useDeviceSelectors(a){var o=a||window.navigator.userAgent,_e=useDeviceData(o),et=buildSelectorsObject(_e);return[et,_e]}lib.AndroidView=AndroidView;lib.BrowserTypes=BrowserTypes;lib.BrowserView=BrowserView;lib.ConsoleView=ConsoleView;lib.CustomView=CustomView;lib.IEView=IEView;lib.IOSView=IOSView;lib.MobileOnlyView=MobileOnlyView;lib.MobileView=MobileView;lib.OsTypes=OsTypes;lib.SmartTVView=SmartTVView;lib.TabletView=TabletView;lib.WearableView=WearableView;lib.WinPhoneView=WinPhoneView;lib.browserName=browserName;lib.browserVersion=browserVersion;lib.deviceDetect=deviceDetect;lib.deviceType=deviceType;lib.engineName=engineName;lib.engineVersion=engineVersion;lib.fullBrowserVersion=fullBrowserVersion;lib.getSelectorsByUserAgent=getSelectorsByUserAgent;lib.getUA=getUA;lib.isAndroid=isAndroid;lib.isBrowser=isBrowser$1;lib.isChrome=isChrome;lib.isChromium=isChromium;lib.isConsole=isConsole;lib.isDesktop=isDesktop;lib.isEdge=isEdge;lib.isEdgeChromium=isEdgeChromium;lib.isElectron=isElectron;lib.isEmbedded=isEmbedded;lib.isFirefox=isFirefox;lib.isIE=isIE;lib.isIOS=isIOS;lib.isIOS13=isIOS13;lib.isIPad13=isIPad13;lib.isIPhone13=isIPhone13;lib.isIPod13=isIPod13;lib.isLegacyEdge=isLegacyEdge;lib.isMIUI=isMIUI;lib.isMacOs=isMacOs;var isMobile_1=lib.isMobile=isMobile;lib.isMobileOnly=isMobileOnly;lib.isMobileSafari=isMobileSafari;lib.isOpera=isOpera;lib.isSafari=isSafari;lib.isSamsungBrowser=isSamsungBrowser;lib.isSmartTV=isSmartTV;lib.isTablet=isTablet;lib.isWearable=isWearable;lib.isWinPhone=isWinPhone;lib.isWindows=isWindows;lib.isYandex=isYandex;lib.mobileModel=mobileModel;lib.mobileVendor=mobileVendor;lib.osName=osName;lib.osVersion=osVersion;lib.parseUserAgent=parseUserAgent;lib.setUserAgent=setUserAgent;lib.useDeviceData=useDeviceData;lib.useDeviceSelectors=useDeviceSelectors;lib.useMobileOrientation=useMobileOrientation;lib.withOrientationChange=withOrientationChange;var uaParser={exports:{}};(function(a,o){(function(_e,et){var rt="1.0.35",lt="",it="?",ut="function",s="undefined",tt="object",ot="string",ct="major",yt="model",pt="name",gt="type",st="vendor",ft="version",at="architecture",ht="console",mt="mobile",St="tablet",It="smarttv",xt="wearable",At="embedded",Nt=350,kt="Amazon",Mt="Apple",bt="ASUS",Bt="BlackBerry",Ht="Browser",Wt="Chrome",nn="Edge",gn="Firefox",tn="Google",Gt="Huawei",fn="LG",Cn="Microsoft",Tn="Motorola",dn="Opera",mn="Samsung",yn="Sharp",pn="Sony",In="Xiaomi",On="Zebra",_n="Facebook",Mn="Chromium OS",Nn="Mac OS",wn=function(xn,Un){var vn={};for(var kn in xn)Un[kn]&&Un[kn].length%2===0?vn[kn]=Un[kn].concat(xn[kn]):vn[kn]=xn[kn];return vn},Pn=function(xn){for(var Un={},vn=0;vn<xn.length;vn++)Un[xn[vn].toUpperCase()]=xn[vn];return Un},Fn=function(xn,Un){return typeof xn===ot?ar(Un).indexOf(ar(xn))!==-1:!1},ar=function(xn){return xn.toLowerCase()},Yn=function(xn){return typeof xn===ot?xn.replace(/[^\d\.]/g,lt).split(".")[0]:et},Xn=function(xn,Un){if(typeof xn===ot)return xn=xn.replace(/^\s\s*/,lt),typeof Un===s?xn:xn.substring(0,Nt)},tr=function(xn,Un){for(var vn=0,kn,qt,Rt,nt,vt,Tt;vn<Un.length&&!vt;){var Pt=Un[vn],wt=Un[vn+1];for(kn=qt=0;kn<Pt.length&&!vt&&Pt[kn];)if(vt=Pt[kn++].exec(xn),vt)for(Rt=0;Rt<wt.length;Rt++)Tt=vt[++qt],nt=wt[Rt],typeof nt===tt&&nt.length>0?nt.length===2?typeof nt[1]==ut?this[nt[0]]=nt[1].call(this,Tt):this[nt[0]]=nt[1]:nt.length===3?typeof nt[1]===ut&&!(nt[1].exec&&nt[1].test)?this[nt[0]]=Tt?nt[1].call(this,Tt,nt[2]):et:this[nt[0]]=Tt?Tt.replace(nt[1],nt[2]):et:nt.length===4&&(this[nt[0]]=Tt?nt[3].call(this,Tt.replace(nt[1],nt[2])):et):this[nt]=Tt||et;vn+=2}},cn=function(xn,Un){for(var vn in Un)if(typeof Un[vn]===tt&&Un[vn].length>0){for(var kn=0;kn<Un[vn].length;kn++)if(Fn(Un[vn][kn],xn))return vn===it?et:vn}else if(Fn(Un[vn],xn))return vn===it?et:vn;return xn},Hn={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Qn={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},or={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[ft,[pt,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[ft,[pt,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[pt,ft],[/opios[\/ ]+([\w\.]+)/i],[ft,[pt,dn+" Mini"]],[/\bopr\/([\w\.]+)/i],[ft,[pt,dn]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[pt,ft],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[ft,[pt,"UC"+Ht]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[ft,[pt,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[ft,[pt,"WeChat"]],[/konqueror\/([\w\.]+)/i],[ft,[pt,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[ft,[pt,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[ft,[pt,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[pt,/(.+)/,"$1 Secure "+Ht],ft],[/\bfocus\/([\w\.]+)/i],[ft,[pt,gn+" Focus"]],[/\bopt\/([\w\.]+)/i],[ft,[pt,dn+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[ft,[pt,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[ft,[pt,"Dolphin"]],[/coast\/([\w\.]+)/i],[ft,[pt,dn+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[ft,[pt,"MIUI "+Ht]],[/fxios\/([-\w\.]+)/i],[ft,[pt,gn]],[/\bqihu|(qi?ho?o?|360)browser/i],[[pt,"360 "+Ht]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[pt,/(.+)/,"$1 "+Ht],ft],[/(comodo_dragon)\/([\w\.]+)/i],[[pt,/_/g," "],ft],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[pt,ft],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[pt],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[pt,_n],ft],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[pt,ft],[/\bgsa\/([\w\.]+) .*safari\//i],[ft,[pt,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[ft,[pt,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[ft,[pt,Wt+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[pt,Wt+" WebView"],ft],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[ft,[pt,"Android "+Ht]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[pt,ft],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[ft,[pt,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[ft,pt],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[pt,[ft,cn,Hn]],[/(webkit|khtml)\/([\w\.]+)/i],[pt,ft],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[pt,"Netscape"],ft],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[ft,[pt,gn+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[pt,ft],[/(cobalt)\/([\w\.]+)/i],[pt,[ft,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[at,"amd64"]],[/(ia32(?=;))/i],[[at,ar]],[/((?:i[346]|x)86)[;\)]/i],[[at,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[at,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[at,"armhf"]],[/windows (ce|mobile); ppc;/i],[[at,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[at,/ower/,lt,ar]],[/(sun4\w)[;\)]/i],[[at,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[at,ar]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[yt,[st,mn],[gt,St]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[yt,[st,mn],[gt,mt]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[yt,[st,Mt],[gt,mt]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[yt,[st,Mt],[gt,St]],[/(macintosh);/i],[yt,[st,Mt]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[yt,[st,yn],[gt,mt]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[yt,[st,Gt],[gt,St]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[yt,[st,Gt],[gt,mt]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[yt,/_/g," "],[st,In],[gt,mt]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[yt,/_/g," "],[st,In],[gt,St]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[yt,[st,"OPPO"],[gt,mt]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[yt,[st,"Vivo"],[gt,mt]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[yt,[st,"Realme"],[gt,mt]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[yt,[st,Tn],[gt,mt]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[yt,[st,Tn],[gt,St]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[yt,[st,fn],[gt,St]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[yt,[st,fn],[gt,mt]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[yt,[st,"Lenovo"],[gt,St]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[yt,/_/g," "],[st,"Nokia"],[gt,mt]],[/(pixel c)\b/i],[yt,[st,tn],[gt,St]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[yt,[st,tn],[gt,mt]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[yt,[st,pn],[gt,mt]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[yt,"Xperia Tablet"],[st,pn],[gt,St]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[yt,[st,"OnePlus"],[gt,mt]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[yt,[st,kt],[gt,St]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[yt,/(.+)/g,"Fire Phone $1"],[st,kt],[gt,mt]],[/(playbook);[-\w\),; ]+(rim)/i],[yt,st,[gt,St]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[yt,[st,Bt],[gt,mt]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[yt,[st,bt],[gt,St]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[yt,[st,bt],[gt,mt]],[/(nexus 9)/i],[yt,[st,"HTC"],[gt,St]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[st,[yt,/_/g," "],[gt,mt]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[yt,[st,"Acer"],[gt,St]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[yt,[st,"Meizu"],[gt,mt]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[st,yt,[gt,mt]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[st,yt,[gt,St]],[/(surface duo)/i],[yt,[st,Cn],[gt,St]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[yt,[st,"Fairphone"],[gt,mt]],[/(u304aa)/i],[yt,[st,"AT&T"],[gt,mt]],[/\bsie-(\w*)/i],[yt,[st,"Siemens"],[gt,mt]],[/\b(rct\w+) b/i],[yt,[st,"RCA"],[gt,St]],[/\b(venue[\d ]{2,7}) b/i],[yt,[st,"Dell"],[gt,St]],[/\b(q(?:mv|ta)\w+) b/i],[yt,[st,"Verizon"],[gt,St]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[yt,[st,"Barnes & Noble"],[gt,St]],[/\b(tm\d{3}\w+) b/i],[yt,[st,"NuVision"],[gt,St]],[/\b(k88) b/i],[yt,[st,"ZTE"],[gt,St]],[/\b(nx\d{3}j) b/i],[yt,[st,"ZTE"],[gt,mt]],[/\b(gen\d{3}) b.+49h/i],[yt,[st,"Swiss"],[gt,mt]],[/\b(zur\d{3}) b/i],[yt,[st,"Swiss"],[gt,St]],[/\b((zeki)?tb.*\b) b/i],[yt,[st,"Zeki"],[gt,St]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[st,"Dragon Touch"],yt,[gt,St]],[/\b(ns-?\w{0,9}) b/i],[yt,[st,"Insignia"],[gt,St]],[/\b((nxa|next)-?\w{0,9}) b/i],[yt,[st,"NextBook"],[gt,St]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[st,"Voice"],yt,[gt,mt]],[/\b(lvtel\-)?(v1[12]) b/i],[[st,"LvTel"],yt,[gt,mt]],[/\b(ph-1) /i],[yt,[st,"Essential"],[gt,mt]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[yt,[st,"Envizen"],[gt,St]],[/\b(trio[-\w\. ]+) b/i],[yt,[st,"MachSpeed"],[gt,St]],[/\btu_(1491) b/i],[yt,[st,"Rotor"],[gt,St]],[/(shield[\w ]+) b/i],[yt,[st,"Nvidia"],[gt,St]],[/(sprint) (\w+)/i],[st,yt,[gt,mt]],[/(kin\.[onetw]{3})/i],[[yt,/\./g," "],[st,Cn],[gt,mt]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[yt,[st,On],[gt,St]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[yt,[st,On],[gt,mt]],[/smart-tv.+(samsung)/i],[st,[gt,It]],[/hbbtv.+maple;(\d+)/i],[[yt,/^/,"SmartTV"],[st,mn],[gt,It]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[st,fn],[gt,It]],[/(apple) ?tv/i],[st,[yt,Mt+" TV"],[gt,It]],[/crkey/i],[[yt,Wt+"cast"],[st,tn],[gt,It]],[/droid.+aft(\w)( bui|\))/i],[yt,[st,kt],[gt,It]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[yt,[st,yn],[gt,It]],[/(bravia[\w ]+)( bui|\))/i],[yt,[st,pn],[gt,It]],[/(mitv-\w{5}) bui/i],[yt,[st,In],[gt,It]],[/Hbbtv.*(technisat) (.*);/i],[st,yt,[gt,It]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[st,Xn],[yt,Xn],[gt,It]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[gt,It]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[st,yt,[gt,ht]],[/droid.+; (shield) bui/i],[yt,[st,"Nvidia"],[gt,ht]],[/(playstation [345portablevi]+)/i],[yt,[st,pn],[gt,ht]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[yt,[st,Cn],[gt,ht]],[/((pebble))app/i],[st,yt,[gt,xt]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[yt,[st,Mt],[gt,xt]],[/droid.+; (glass) \d/i],[yt,[st,tn],[gt,xt]],[/droid.+; (wt63?0{2,3})\)/i],[yt,[st,On],[gt,xt]],[/(quest( 2| pro)?)/i],[yt,[st,_n],[gt,xt]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[st,[gt,At]],[/(aeobc)\b/i],[yt,[st,kt],[gt,At]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[yt,[gt,mt]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[yt,[gt,St]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[gt,St]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[gt,mt]],[/(android[-\w\. ]{0,9});.+buil/i],[yt,[st,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[ft,[pt,nn+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[ft,[pt,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[pt,ft],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[ft,pt]],os:[[/microsoft (windows) (vista|xp)/i],[pt,ft],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[pt,[ft,cn,Qn]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[pt,"Windows"],[ft,cn,Qn]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[ft,/_/g,"."],[pt,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[pt,Nn],[ft,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[ft,pt],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[pt,ft],[/\(bb(10);/i],[ft,[pt,Bt]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[ft,[pt,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[ft,[pt,gn+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[ft,[pt,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[ft,[pt,"watchOS"]],[/crkey\/([\d\.]+)/i],[ft,[pt,Wt+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[pt,Mn],ft],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[pt,ft],[/(sunos) ?([\w\.\d]*)/i],[[pt,"Solaris"],ft],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[pt,ft]]},Wn=function(xn,Un){if(typeof xn===tt&&(Un=xn,xn=et),!(this instanceof Wn))return new Wn(xn,Un).getResult();var vn=typeof _e!==s&&_e.navigator?_e.navigator:et,kn=xn||(vn&&vn.userAgent?vn.userAgent:lt),qt=vn&&vn.userAgentData?vn.userAgentData:et,Rt=Un?wn(or,Un):or,nt=vn&&vn.userAgent==kn;return this.getBrowser=function(){var vt={};return vt[pt]=et,vt[ft]=et,tr.call(vt,kn,Rt.browser),vt[ct]=Yn(vt[ft]),nt&&vn&&vn.brave&&typeof vn.brave.isBrave==ut&&(vt[pt]="Brave"),vt},this.getCPU=function(){var vt={};return vt[at]=et,tr.call(vt,kn,Rt.cpu),vt},this.getDevice=function(){var vt={};return vt[st]=et,vt[yt]=et,vt[gt]=et,tr.call(vt,kn,Rt.device),nt&&!vt[gt]&&qt&&qt.mobile&&(vt[gt]=mt),nt&&vt[yt]=="Macintosh"&&vn&&typeof vn.standalone!==s&&vn.maxTouchPoints&&vn.maxTouchPoints>2&&(vt[yt]="iPad",vt[gt]=St),vt},this.getEngine=function(){var vt={};return vt[pt]=et,vt[ft]=et,tr.call(vt,kn,Rt.engine),vt},this.getOS=function(){var vt={};return vt[pt]=et,vt[ft]=et,tr.call(vt,kn,Rt.os),nt&&!vt[pt]&&qt&&qt.platform!="Unknown"&&(vt[pt]=qt.platform.replace(/chrome os/i,Mn).replace(/macos/i,Nn)),vt},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return kn},this.setUA=function(vt){return kn=typeof vt===ot&&vt.length>Nt?Xn(vt,Nt):vt,this},this.setUA(kn),this};Wn.VERSION=rt,Wn.BROWSER=Pn([pt,ft,ct]),Wn.CPU=Pn([at]),Wn.DEVICE=Pn([yt,st,gt,ht,mt,It,St,xt,At]),Wn.ENGINE=Wn.OS=Pn([pt,ft]),a.exports&&(o=a.exports=Wn),o.UAParser=Wn;var ir=typeof _e!==s&&(_e.jQuery||_e.Zepto);if(ir&&!ir.ua){var nr=new Wn;ir.ua=nr.getResult(),ir.ua.get=function(){return nr.getUA()},ir.ua.set=function(xn){nr.setUA(xn);var Un=nr.getResult();for(var vn in Un)ir.ua[vn]=Un[vn]}}})(typeof window=="object"?window:commonjsGlobal)})(uaParser,uaParser.exports);var uaParserExports=uaParser.exports,base64={exports:{}};/*! https://mths.be/base64 v1.0.0 by @mathias | MIT license */base64.exports;(function(a,o){(function(_e){var et=o,rt=a&&a.exports==et&&a,lt=typeof commonjsGlobal=="object"&&commonjsGlobal;(lt.global===lt||lt.window===lt)&&(_e=lt);var it=function(gt){this.message=gt};it.prototype=new Error,it.prototype.name="InvalidCharacterError";var ut=function(gt){throw new it(gt)},s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",tt=/[\t\n\f\r ]/g,ot=function(gt){gt=String(gt).replace(tt,"");var st=gt.length;st%4==0&&(gt=gt.replace(/==?$/,""),st=gt.length),(st%4==1||/[^+a-zA-Z0-9/]/.test(gt))&&ut("Invalid character: the string to be decoded is not correctly encoded.");for(var ft=0,at,ht,mt="",St=-1;++St<st;)ht=s.indexOf(gt.charAt(St)),at=ft%4?at*64+ht:ht,ft++%4&&(mt+=String.fromCharCode(255&at>>(-2*ft&6)));return mt},ct=function(gt){gt=String(gt),/[^\0-\xFF]/.test(gt)&&ut("The string to be encoded contains characters outside of the Latin1 range.");for(var st=gt.length%3,ft="",at=-1,ht,mt,St,It,xt=gt.length-st;++at<xt;)ht=gt.charCodeAt(at)<<16,mt=gt.charCodeAt(++at)<<8,St=gt.charCodeAt(++at),It=ht+mt+St,ft+=s.charAt(It>>18&63)+s.charAt(It>>12&63)+s.charAt(It>>6&63)+s.charAt(It&63);return st==2?(ht=gt.charCodeAt(at)<<8,mt=gt.charCodeAt(++at),It=ht+mt,ft+=s.charAt(It>>10)+s.charAt(It>>4&63)+s.charAt(It<<2&63)+"="):st==1&&(It=gt.charCodeAt(at),ft+=s.charAt(It>>2)+s.charAt(It<<4&63)+"=="),ft},yt={encode:ct,decode:ot,version:"1.0.0"};if(et&&!et.nodeType)if(rt)rt.exports=yt;else for(var pt in yt)yt.hasOwnProperty(pt)&&(et[pt]=yt[pt]);else _e.base64=yt})(commonjsGlobal)})(base64,base64.exports);var base64Exports=base64.exports;function commonjsRequire(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var apiRTC_min={exports:{}};(function(a,o){(function(et){a.exports=et()})(function(){return function(){function et(rt,lt,it){function ut(ot,ct){if(!lt[ot]){if(!rt[ot]){var yt=typeof commonjsRequire=="function"&&commonjsRequire;if(!ct&&yt)return yt(ot,!0);if(s)return s(ot,!0);var pt=new Error("Cannot find module '"+ot+"'");throw pt.code="MODULE_NOT_FOUND",pt}var gt=lt[ot]={exports:{}};rt[ot][0].call(gt.exports,function(st){return ut(rt[ot][1][st]||st)},gt,gt.exports,et,rt,lt,it)}return lt[ot].exports}for(var s=typeof commonjsRequire=="function"&&commonjsRequire,tt=0;tt<it.length;tt++)ut(it[tt]);return ut}return et}()({1:[function(et,rt,lt){var it=(0,et("./adapter_factory.js").adapterFactory)({window});rt.exports=it},{"./adapter_factory.js":2}],2:[function(et,rt,lt){function it(pt){if(pt&&pt.__esModule)return pt;var gt={};if(pt!=null)for(var st in pt)Object.prototype.hasOwnProperty.call(pt,st)&&(gt[st]=pt[st]);return gt.default=pt,gt}Object.defineProperty(lt,"__esModule",{value:!0}),lt.adapterFactory=function(){var pt=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).window,gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},st=ut.log,ft=ut.detectBrowser(pt),at={browserDetails:ft,commonShim:yt,extractVersion:ut.extractVersion,disableLog:ut.disableLog,disableWarnings:ut.disableWarnings};switch(ft.browser){case"chrome":if(!s||!s.shimPeerConnection||!gt.shimChrome)return st("Chrome shim is not included in this adapter release."),at;st("adapter.js shimming chrome."),at.browserShim=s,s.shimGetUserMedia(pt),s.shimMediaStream(pt),s.shimPeerConnection(pt),s.shimOnTrack(pt),s.shimAddTrackRemoveTrack(pt),s.shimGetSendersWithDtmf(pt),s.shimGetStats(pt),s.shimSenderReceiverGetStats(pt),s.fixNegotiationNeeded(pt),yt.shimRTCIceCandidate(pt),yt.shimConnectionState(pt),yt.shimMaxMessageSize(pt),yt.shimSendThrowTypeError(pt),yt.removeAllowExtmapMixed(pt);break;case"firefox":if(!ot||!ot.shimPeerConnection||!gt.shimFirefox)return st("Firefox shim is not included in this adapter release."),at;st("adapter.js shimming firefox."),at.browserShim=ot,ot.shimGetUserMedia(pt),ot.shimPeerConnection(pt),ot.shimOnTrack(pt),ot.shimRemoveStream(pt),ot.shimSenderGetStats(pt),ot.shimReceiverGetStats(pt),ot.shimRTCDataChannel(pt),yt.shimRTCIceCandidate(pt),yt.shimConnectionState(pt),yt.shimMaxMessageSize(pt),yt.shimSendThrowTypeError(pt);break;case"edge":if(!tt||!tt.shimPeerConnection||!gt.shimEdge)return st("MS edge shim is not included in this adapter release."),at;st("adapter.js shimming edge."),at.browserShim=tt,tt.shimGetUserMedia(pt),tt.shimGetDisplayMedia(pt),tt.shimPeerConnection(pt),tt.shimReplaceTrack(pt),yt.shimMaxMessageSize(pt),yt.shimSendThrowTypeError(pt);break;case"safari":if(!ct||!gt.shimSafari)return st("Safari shim is not included in this adapter release."),at;st("adapter.js shimming safari."),at.browserShim=ct,ct.shimRTCIceServerUrls(pt),ct.shimCreateOfferLegacy(pt),ct.shimCallbacksAPI(pt),ct.shimLocalStreamsAPI(pt),ct.shimRemoteStreamsAPI(pt),ct.shimTrackEventTransceiver(pt),ct.shimGetUserMedia(pt),yt.shimRTCIceCandidate(pt),yt.shimMaxMessageSize(pt),yt.shimSendThrowTypeError(pt),yt.removeAllowExtmapMixed(pt);break;default:st("Unsupported browser!")}return at};var ut=it(et("./utils")),s=it(et("./chrome/chrome_shim")),tt=it(et("./edge/edge_shim")),ot=it(et("./firefox/firefox_shim")),ct=it(et("./safari/safari_shim")),yt=it(et("./common_shim"))},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(et,rt,lt){function it(ct){ct.RTCPeerConnection.prototype.getLocalStreams=function(){var ft=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(at){return ft._shimmedLocalStreams[at][0]})};var yt=ct.RTCPeerConnection.prototype.addTrack;ct.RTCPeerConnection.prototype.addTrack=function(ft,at){if(!at)return yt.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var ht=yt.apply(this,arguments);return this._shimmedLocalStreams[at.id]?this._shimmedLocalStreams[at.id].indexOf(ht)===-1&&this._shimmedLocalStreams[at.id].push(ht):this._shimmedLocalStreams[at.id]=[at,ht],ht};var pt=ct.RTCPeerConnection.prototype.addStream;ct.RTCPeerConnection.prototype.addStream=function(ft){var at=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},ft.getTracks().forEach(function(St){if(at.getSenders().find(function(It){return It.track===St}))throw new DOMException("Track already exists.","InvalidAccessError")});var ht=this.getSenders();pt.apply(this,arguments);var mt=this.getSenders().filter(function(St){return ht.indexOf(St)===-1});this._shimmedLocalStreams[ft.id]=[ft].concat(mt)};var gt=ct.RTCPeerConnection.prototype.removeStream;ct.RTCPeerConnection.prototype.removeStream=function(ft){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[ft.id],gt.apply(this,arguments)};var st=ct.RTCPeerConnection.prototype.removeTrack;ct.RTCPeerConnection.prototype.removeTrack=function(ft){var at=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},ft&&Object.keys(this._shimmedLocalStreams).forEach(function(ht){var mt=at._shimmedLocalStreams[ht].indexOf(ft);mt!==-1&&at._shimmedLocalStreams[ht].splice(mt,1),at._shimmedLocalStreams[ht].length===1&&delete at._shimmedLocalStreams[ht]}),st.apply(this,arguments)}}Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetDisplayMedia=lt.shimGetUserMedia=void 0;var ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ct){return typeof ct}:function(ct){return ct&&typeof Symbol=="function"&&ct.constructor===Symbol&&ct!==Symbol.prototype?"symbol":typeof ct},s=et("./getusermedia");Object.defineProperty(lt,"shimGetUserMedia",{enumerable:!0,get:function(){return s.shimGetUserMedia}});var tt=et("./getdisplaymedia");Object.defineProperty(lt,"shimGetDisplayMedia",{enumerable:!0,get:function(){return tt.shimGetDisplayMedia}}),lt.shimMediaStream=function(ct){ct.MediaStream=ct.MediaStream||ct.webkitMediaStream},lt.shimOnTrack=function(ct){if((ct===void 0?"undefined":ut(ct))!=="object"||!ct.RTCPeerConnection||"ontrack"in ct.RTCPeerConnection.prototype)ot.wrapPeerConnectionEvent(ct,"track",function(pt){return pt.transceiver||Object.defineProperty(pt,"transceiver",{value:{receiver:pt.receiver}}),pt});else{Object.defineProperty(ct.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(pt){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=pt)},enumerable:!0,configurable:!0});var yt=ct.RTCPeerConnection.prototype.setRemoteDescription;ct.RTCPeerConnection.prototype.setRemoteDescription=function(){var pt=this;return this._ontrackpoly||(this._ontrackpoly=function(gt){gt.stream.addEventListener("addtrack",function(st){var ft=void 0;ft=ct.RTCPeerConnection.prototype.getReceivers?pt.getReceivers().find(function(ht){return ht.track&&ht.track.id===st.track.id}):{track:st.track};var at=new Event("track");at.track=st.track,at.receiver=ft,at.transceiver={receiver:ft},at.streams=[gt.stream],pt.dispatchEvent(at)}),gt.stream.getTracks().forEach(function(st){var ft=void 0;ft=ct.RTCPeerConnection.prototype.getReceivers?pt.getReceivers().find(function(ht){return ht.track&&ht.track.id===st.id}):{track:st};var at=new Event("track");at.track=st,at.receiver=ft,at.transceiver={receiver:ft},at.streams=[gt.stream],pt.dispatchEvent(at)})},this.addEventListener("addstream",this._ontrackpoly)),yt.apply(this,arguments)}}},lt.shimGetSendersWithDtmf=function(ct){if((ct===void 0?"undefined":ut(ct))==="object"&&ct.RTCPeerConnection&&!("getSenders"in ct.RTCPeerConnection.prototype)&&"createDTMFSender"in ct.RTCPeerConnection.prototype){var yt=function(ht,mt){return{track:mt,get dtmf(){return this._dtmf===void 0&&(mt.kind==="audio"?this._dtmf=ht.createDTMFSender(mt):this._dtmf=null),this._dtmf},_pc:ht}};if(!ct.RTCPeerConnection.prototype.getSenders){ct.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var pt=ct.RTCPeerConnection.prototype.addTrack;ct.RTCPeerConnection.prototype.addTrack=function(ht,mt){var St=pt.apply(this,arguments);return St||(St=yt(this,ht),this._senders.push(St)),St};var gt=ct.RTCPeerConnection.prototype.removeTrack;ct.RTCPeerConnection.prototype.removeTrack=function(ht){gt.apply(this,arguments);var mt=this._senders.indexOf(ht);mt!==-1&&this._senders.splice(mt,1)}}var st=ct.RTCPeerConnection.prototype.addStream;ct.RTCPeerConnection.prototype.addStream=function(ht){var mt=this;this._senders=this._senders||[],st.apply(this,[ht]),ht.getTracks().forEach(function(St){mt._senders.push(yt(mt,St))})};var ft=ct.RTCPeerConnection.prototype.removeStream;ct.RTCPeerConnection.prototype.removeStream=function(ht){var mt=this;this._senders=this._senders||[],ft.apply(this,[ht]),ht.getTracks().forEach(function(St){var It=mt._senders.find(function(xt){return xt.track===St});It&&mt._senders.splice(mt._senders.indexOf(It),1)})}}else if((ct===void 0?"undefined":ut(ct))==="object"&&ct.RTCPeerConnection&&"getSenders"in ct.RTCPeerConnection.prototype&&"createDTMFSender"in ct.RTCPeerConnection.prototype&&ct.RTCRtpSender&&!("dtmf"in ct.RTCRtpSender.prototype)){var at=ct.RTCPeerConnection.prototype.getSenders;ct.RTCPeerConnection.prototype.getSenders=function(){var ht=this,mt=at.apply(this,[]);return mt.forEach(function(St){return St._pc=ht}),mt},Object.defineProperty(ct.RTCRtpSender.prototype,"dtmf",{get:function(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},lt.shimGetStats=function(ct){if(ct.RTCPeerConnection){var yt=ct.RTCPeerConnection.prototype.getStats;ct.RTCPeerConnection.prototype.getStats=function(pt,gt,st){var ft=this,at=arguments;if(arguments.length>0&&typeof pt=="function")return yt.apply(this,arguments);if(yt.length===0&&(arguments.length===0||typeof arguments[0]!="function"))return yt.apply(this,[]);var ht=function(It){var xt={};return It.result().forEach(function(At){var Nt={id:At.id,timestamp:At.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[At.type]||At.type};At.names().forEach(function(kt){Nt[kt]=At.stat(kt)}),xt[Nt.id]=Nt}),xt},mt=function(It){return new Map(Object.keys(It).map(function(xt){return[xt,It[xt]]}))};if(arguments.length>=2){var St=function(It){at[1](mt(ht(It)))};return yt.apply(this,[St,arguments[0]])}return new Promise(function(It,xt){yt.apply(ft,[function(At){It(mt(ht(At)))},xt])}).then(gt,st)}}},lt.shimSenderReceiverGetStats=function(ct){if((ct===void 0?"undefined":ut(ct))==="object"&&ct.RTCPeerConnection&&ct.RTCRtpSender&&ct.RTCRtpReceiver){if(!("getStats"in ct.RTCRtpSender.prototype)){var yt=ct.RTCPeerConnection.prototype.getSenders;yt&&(ct.RTCPeerConnection.prototype.getSenders=function(){var ft=this,at=yt.apply(this,[]);return at.forEach(function(ht){return ht._pc=ft}),at});var pt=ct.RTCPeerConnection.prototype.addTrack;pt&&(ct.RTCPeerConnection.prototype.addTrack=function(){var ft=pt.apply(this,arguments);return ft._pc=this,ft}),ct.RTCRtpSender.prototype.getStats=function(){var ft=this;return this._pc.getStats().then(function(at){return ot.filterStats(at,ft.track,!0)})}}if(!("getStats"in ct.RTCRtpReceiver.prototype)){var gt=ct.RTCPeerConnection.prototype.getReceivers;gt&&(ct.RTCPeerConnection.prototype.getReceivers=function(){var ft=this,at=gt.apply(this,[]);return at.forEach(function(ht){return ht._pc=ft}),at}),ot.wrapPeerConnectionEvent(ct,"track",function(ft){return ft.receiver._pc=ft.srcElement,ft}),ct.RTCRtpReceiver.prototype.getStats=function(){var ft=this;return this._pc.getStats().then(function(at){return ot.filterStats(at,ft.track,!1)})}}if("getStats"in ct.RTCRtpSender.prototype&&"getStats"in ct.RTCRtpReceiver.prototype){var st=ct.RTCPeerConnection.prototype.getStats;ct.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof ct.MediaStreamTrack){var ft=arguments[0],at=void 0,ht=void 0,mt=void 0;return this.getSenders().forEach(function(St){St.track===ft&&(at?mt=!0:at=St)}),this.getReceivers().forEach(function(St){return St.track===ft&&(ht?mt=!0:ht=St),St.track===ft}),mt||at&&ht?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):at?at.getStats():ht?ht.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return st.apply(this,arguments)}}}},lt.shimAddTrackRemoveTrackWithNative=it,lt.shimAddTrackRemoveTrack=function(ct){function yt(St,It){var xt=It.sdp;return Object.keys(St._reverseStreams||[]).forEach(function(At){var Nt=St._reverseStreams[At],kt=St._streams[Nt.id];xt=xt.replace(new RegExp(kt.id,"g"),Nt.id)}),new RTCSessionDescription({type:It.type,sdp:xt})}function pt(St,It){var xt=It.sdp;return Object.keys(St._reverseStreams||[]).forEach(function(At){var Nt=St._reverseStreams[At],kt=St._streams[Nt.id];xt=xt.replace(new RegExp(Nt.id,"g"),kt.id)}),new RTCSessionDescription({type:It.type,sdp:xt})}if(ct.RTCPeerConnection){var gt=ot.detectBrowser(ct);if(ct.RTCPeerConnection.prototype.addTrack&&gt.version>=65)return it(ct);var st=ct.RTCPeerConnection.prototype.getLocalStreams;ct.RTCPeerConnection.prototype.getLocalStreams=function(){var St=this,It=st.apply(this);return this._reverseStreams=this._reverseStreams||{},It.map(function(xt){return St._reverseStreams[xt.id]})};var ft=ct.RTCPeerConnection.prototype.addStream;ct.RTCPeerConnection.prototype.addStream=function(St){var It=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},St.getTracks().forEach(function(At){if(It.getSenders().find(function(Nt){return Nt.track===At}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[St.id]){var xt=new ct.MediaStream(St.getTracks());this._streams[St.id]=xt,this._reverseStreams[xt.id]=St,St=xt}ft.apply(this,[St])};var at=ct.RTCPeerConnection.prototype.removeStream;ct.RTCPeerConnection.prototype.removeStream=function(St){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},at.apply(this,[this._streams[St.id]||St]),delete this._reverseStreams[this._streams[St.id]?this._streams[St.id].id:St.id],delete this._streams[St.id]},ct.RTCPeerConnection.prototype.addTrack=function(St,It){var xt=this;if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var At=[].slice.call(arguments,1);if(At.length!==1||!At[0].getTracks().find(function(Mt){return Mt===St}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(Mt){return Mt.track===St}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var Nt=this._streams[It.id];if(Nt)Nt.addTrack(St),Promise.resolve().then(function(){xt.dispatchEvent(new Event("negotiationneeded"))});else{var kt=new ct.MediaStream([St]);this._streams[It.id]=kt,this._reverseStreams[kt.id]=It,this.addStream(kt)}return this.getSenders().find(function(Mt){return Mt.track===St})},["createOffer","createAnswer"].forEach(function(St){var It=ct.RTCPeerConnection.prototype[St];ct.RTCPeerConnection.prototype[St]=function(){var xt=this,At=arguments;return arguments.length&&typeof arguments[0]=="function"?It.apply(this,[function(Nt){var kt=yt(xt,Nt);At[0].apply(null,[kt])},function(Nt){At[1]&&At[1].apply(null,Nt)},arguments[2]]):It.apply(this,arguments).then(function(Nt){return yt(xt,Nt)})}});var ht=ct.RTCPeerConnection.prototype.setLocalDescription;ct.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=pt(this,arguments[0]),ht.apply(this,arguments)):ht.apply(this,arguments)};var mt=Object.getOwnPropertyDescriptor(ct.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(ct.RTCPeerConnection.prototype,"localDescription",{get:function(){var St=mt.get.apply(this);return St.type===""?St:yt(this,St)}}),ct.RTCPeerConnection.prototype.removeTrack=function(St){var It=this;if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!St._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(St._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var xt=void 0;Object.keys(this._streams).forEach(function(At){It._streams[At].getTracks().find(function(Nt){return St.track===Nt})&&(xt=It._streams[At])}),xt&&(xt.getTracks().length===1?this.removeStream(this._reverseStreams[xt.id]):xt.removeTrack(St.track),this.dispatchEvent(new Event("negotiationneeded")))}}},lt.shimPeerConnection=function(ct){if(!ct.RTCPeerConnection&&ct.webkitRTCPeerConnection&&(ct.RTCPeerConnection=ct.webkitRTCPeerConnection),ct.RTCPeerConnection){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(pt){var gt=ct.RTCPeerConnection.prototype[pt];ct.RTCPeerConnection.prototype[pt]=function(){return arguments[0]=new(pt==="addIceCandidate"?ct.RTCIceCandidate:ct.RTCSessionDescription)(arguments[0]),gt.apply(this,arguments)}});var yt=ct.RTCPeerConnection.prototype.addIceCandidate;ct.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?yt.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},lt.fixNegotiationNeeded=function(ct){ot.wrapPeerConnectionEvent(ct,"negotiationneeded",function(yt){if(yt.target.signalingState==="stable")return yt})};var ot=function(ct){if(ct&&ct.__esModule)return ct;var yt={};if(ct!=null)for(var pt in ct)Object.prototype.hasOwnProperty.call(ct,pt)&&(yt[pt]=ct[pt]);return yt.default=ct,yt}(et("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(et,rt,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetDisplayMedia=function(it,ut){it.navigator.mediaDevices&&"getDisplayMedia"in it.navigator.mediaDevices||it.navigator.mediaDevices&&(typeof ut=="function"?it.navigator.mediaDevices.getDisplayMedia=function(s){return ut(s).then(function(tt){var ot=s.video&&s.video.width,ct=s.video&&s.video.height,yt=s.video&&s.video.frameRate;return s.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:tt,maxFrameRate:yt||3}},ot&&(s.video.mandatory.maxWidth=ot),ct&&(s.video.mandatory.maxHeight=ct),it.navigator.mediaDevices.getUserMedia(s)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],5:[function(et,rt,lt){Object.defineProperty(lt,"__esModule",{value:!0});var it=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(tt){return typeof tt}:function(tt){return tt&&typeof Symbol=="function"&&tt.constructor===Symbol&&tt!==Symbol.prototype?"symbol":typeof tt};lt.shimGetUserMedia=function(tt){var ot=tt&&tt.navigator;if(ot.mediaDevices){var ct=ut.detectBrowser(tt),yt=function(ft){if((ft===void 0?"undefined":it(ft))!=="object"||ft.mandatory||ft.optional)return ft;var at={};return Object.keys(ft).forEach(function(ht){if(ht!=="require"&&ht!=="advanced"&&ht!=="mediaSource"){var mt=it(ft[ht])==="object"?ft[ht]:{ideal:ft[ht]};mt.exact!==void 0&&typeof mt.exact=="number"&&(mt.min=mt.max=mt.exact);var St=function(xt,At){return xt?xt+At.charAt(0).toUpperCase()+At.slice(1):At==="deviceId"?"sourceId":At};if(mt.ideal!==void 0){at.optional=at.optional||[];var It={};typeof mt.ideal=="number"?(It[St("min",ht)]=mt.ideal,at.optional.push(It),(It={})[St("max",ht)]=mt.ideal,at.optional.push(It)):(It[St("",ht)]=mt.ideal,at.optional.push(It))}mt.exact!==void 0&&typeof mt.exact!="number"?(at.mandatory=at.mandatory||{},at.mandatory[St("",ht)]=mt.exact):["min","max"].forEach(function(xt){mt[xt]!==void 0&&(at.mandatory=at.mandatory||{},at.mandatory[St(xt,ht)]=mt[xt])})}}),ft.advanced&&(at.optional=(at.optional||[]).concat(ft.advanced)),at},pt=function(ft,at){if(ct.version>=61)return at(ft);if((ft=JSON.parse(JSON.stringify(ft)))&&it(ft.audio)==="object"){var ht=function(xt,At,Nt){At in xt&&!(Nt in xt)&&(xt[Nt]=xt[At],delete xt[At])};ht((ft=JSON.parse(JSON.stringify(ft))).audio,"autoGainControl","googAutoGainControl"),ht(ft.audio,"noiseSuppression","googNoiseSuppression"),ft.audio=yt(ft.audio)}if(ft&&it(ft.video)==="object"){var mt=ft.video.facingMode;mt=mt&&((mt===void 0?"undefined":it(mt))==="object"?mt:{ideal:mt});var St=ct.version<66;if(mt&&(mt.exact==="user"||mt.exact==="environment"||mt.ideal==="user"||mt.ideal==="environment")&&(!ot.mediaDevices.getSupportedConstraints||!ot.mediaDevices.getSupportedConstraints().facingMode||St)){delete ft.video.facingMode;var It=void 0;if(mt.exact==="environment"||mt.ideal==="environment"?It=["back","rear"]:mt.exact!=="user"&&mt.ideal!=="user"||(It=["front"]),It)return ot.mediaDevices.enumerateDevices().then(function(xt){var At=(xt=xt.filter(function(Nt){return Nt.kind==="videoinput"})).find(function(Nt){return It.some(function(kt){return Nt.label.toLowerCase().includes(kt)})});return!At&&xt.length&&It.includes("back")&&(At=xt[xt.length-1]),At&&(ft.video.deviceId=mt.exact?{exact:At.deviceId}:{ideal:At.deviceId}),ft.video=yt(ft.video),s("chrome: "+JSON.stringify(ft)),at(ft)})}ft.video=yt(ft.video)}return s("chrome: "+JSON.stringify(ft)),at(ft)},gt=function(ft){return ct.version>=64?ft:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[ft.name]||ft.name,message:ft.message,constraint:ft.constraint||ft.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(ot.getUserMedia=(function(ft,at,ht){pt(ft,function(mt){ot.webkitGetUserMedia(mt,at,function(St){ht&&ht(gt(St))})})}).bind(ot),ot.mediaDevices.getUserMedia){var st=ot.mediaDevices.getUserMedia.bind(ot.mediaDevices);ot.mediaDevices.getUserMedia=function(ft){return pt(ft,function(at){return st(at).then(function(ht){if(at.audio&&!ht.getAudioTracks().length||at.video&&!ht.getVideoTracks().length)throw ht.getTracks().forEach(function(mt){mt.stop()}),new DOMException("","NotFoundError");return ht},function(ht){return Promise.reject(gt(ht))})})}}}};var ut=function(tt){if(tt&&tt.__esModule)return tt;var ot={};if(tt!=null)for(var ct in tt)Object.prototype.hasOwnProperty.call(tt,ct)&&(ot[ct]=tt[ct]);return ot.default=tt,ot}(et("../utils.js")),s=ut.log},{"../utils.js":15}],6:[function(et,rt,lt){Object.defineProperty(lt,"__esModule",{value:!0});var it=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(tt){return typeof tt}:function(tt){return tt&&typeof Symbol=="function"&&tt.constructor===Symbol&&tt!==Symbol.prototype?"symbol":typeof tt};lt.shimRTCIceCandidate=function(tt){if(tt.RTCIceCandidate&&!(tt.RTCIceCandidate&&"foundation"in tt.RTCIceCandidate.prototype)){var ot=tt.RTCIceCandidate;tt.RTCIceCandidate=function(ct){if((ct===void 0?"undefined":it(ct))==="object"&&ct.candidate&&ct.candidate.indexOf("a=")===0&&((ct=JSON.parse(JSON.stringify(ct))).candidate=ct.candidate.substr(2)),ct.candidate&&ct.candidate.length){var yt=new ot(ct),pt=ut.default.parseCandidate(ct.candidate),gt=Object.assign(yt,pt);return gt.toJSON=function(){return{candidate:gt.candidate,sdpMid:gt.sdpMid,sdpMLineIndex:gt.sdpMLineIndex,usernameFragment:gt.usernameFragment}},gt}return new ot(ct)},tt.RTCIceCandidate.prototype=ot.prototype,s.wrapPeerConnectionEvent(tt,"icecandidate",function(ct){return ct.candidate&&Object.defineProperty(ct,"candidate",{value:new tt.RTCIceCandidate(ct.candidate),writable:"false"}),ct})}},lt.shimMaxMessageSize=function(tt){if(!tt.RTCSctpTransport&&tt.RTCPeerConnection){var ot=s.detectBrowser(tt);"sctp"in tt.RTCPeerConnection.prototype||Object.defineProperty(tt.RTCPeerConnection.prototype,"sctp",{get:function(){return this._sctp===void 0?null:this._sctp}});var ct=function(ft){if(!ft||!ft.sdp)return!1;var at=ut.default.splitSections(ft.sdp);return at.shift(),at.some(function(ht){var mt=ut.default.parseMLine(ht);return mt&&mt.kind==="application"&&mt.protocol.indexOf("SCTP")!==-1})},yt=function(ft){var at=ft.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(at===null||at.length<2)return-1;var ht=parseInt(at[1],10);return ht!==ht?-1:ht},pt=function(ft){var at=65536;return ot.browser==="firefox"&&(at=ot.version<57?ft===-1?16384:2147483637:ot.version<60?ot.version===57?65535:65536:2147483637),at},gt=function(ft,at){var ht=65536;ot.browser==="firefox"&&ot.version===57&&(ht=65535);var mt=ut.default.matchPrefix(ft.sdp,"a=max-message-size:");return mt.length>0?ht=parseInt(mt[0].substr(19),10):ot.browser==="firefox"&&at!==-1&&(ht=2147483637),ht},st=tt.RTCPeerConnection.prototype.setRemoteDescription;tt.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,ct(arguments[0])){var ft=yt(arguments[0]),at=pt(ft),ht=gt(arguments[0],ft),mt=void 0;mt=at===0&&ht===0?Number.POSITIVE_INFINITY:at===0||ht===0?Math.max(at,ht):Math.min(at,ht);var St={};Object.defineProperty(St,"maxMessageSize",{get:function(){return mt}}),this._sctp=St}return st.apply(this,arguments)}}},lt.shimSendThrowTypeError=function(tt){function ot(yt,pt){var gt=yt.send;yt.send=function(){var st=arguments[0],ft=st.length||st.size||st.byteLength;if(yt.readyState==="open"&&pt.sctp&&ft>pt.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+pt.sctp.maxMessageSize+" bytes)");return gt.apply(yt,arguments)}}if(tt.RTCPeerConnection&&"createDataChannel"in tt.RTCPeerConnection.prototype){var ct=tt.RTCPeerConnection.prototype.createDataChannel;tt.RTCPeerConnection.prototype.createDataChannel=function(){var yt=ct.apply(this,arguments);return ot(yt,this),yt},s.wrapPeerConnectionEvent(tt,"datachannel",function(yt){return ot(yt.channel,yt.target),yt})}},lt.shimConnectionState=function(tt){if(tt.RTCPeerConnection&&!("connectionState"in tt.RTCPeerConnection.prototype)){var ot=tt.RTCPeerConnection.prototype;Object.defineProperty(ot,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(ot,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(ct){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),ct&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=ct)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(ct){var yt=ot[ct];ot[ct]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(pt){var gt=pt.target;if(gt._lastConnectionState!==gt.connectionState){gt._lastConnectionState=gt.connectionState;var st=new Event("connectionstatechange",pt);gt.dispatchEvent(st)}return pt},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),yt.apply(this,arguments)}})}},lt.removeAllowExtmapMixed=function(tt){if(tt.RTCPeerConnection){var ot=s.detectBrowser(tt);if(!(ot.browser==="chrome"&&ot.version>=71||ot.browser==="safari"&&ot.version>=605)){var ct=tt.RTCPeerConnection.prototype.setRemoteDescription;tt.RTCPeerConnection.prototype.setRemoteDescription=function(yt){return yt&&yt.sdp&&yt.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1&&(yt.sdp=yt.sdp.split(`
`).filter(function(pt){return pt.trim()!=="a=extmap-allow-mixed"}).join(`
`)),ct.apply(this,arguments)}}}};var ut=function(tt){return tt&&tt.__esModule?tt:{default:tt}}(et("sdp")),s=function(tt){if(tt&&tt.__esModule)return tt;var ot={};if(tt!=null)for(var ct in tt)Object.prototype.hasOwnProperty.call(tt,ct)&&(ot[ct]=tt[ct]);return ot.default=tt,ot}(et("./utils"))},{"./utils":15,sdp:17}],7:[function(et,rt,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetDisplayMedia=lt.shimGetUserMedia=void 0;var it=et("./getusermedia");Object.defineProperty(lt,"shimGetUserMedia",{enumerable:!0,get:function(){return it.shimGetUserMedia}});var ut=et("./getdisplaymedia");Object.defineProperty(lt,"shimGetDisplayMedia",{enumerable:!0,get:function(){return ut.shimGetDisplayMedia}}),lt.shimPeerConnection=function(ct){var yt=s.detectBrowser(ct);if(ct.RTCIceGatherer&&(ct.RTCIceCandidate||(ct.RTCIceCandidate=function(st){return st}),ct.RTCSessionDescription||(ct.RTCSessionDescription=function(st){return st}),yt.version<15025)){var pt=Object.getOwnPropertyDescriptor(ct.MediaStreamTrack.prototype,"enabled");Object.defineProperty(ct.MediaStreamTrack.prototype,"enabled",{set:function(st){pt.set.call(this,st);var ft=new Event("enabled");ft.enabled=st,this.dispatchEvent(ft)}})}!ct.RTCRtpSender||"dtmf"in ct.RTCRtpSender.prototype||Object.defineProperty(ct.RTCRtpSender.prototype,"dtmf",{get:function(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new ct.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),ct.RTCDtmfSender&&!ct.RTCDTMFSender&&(ct.RTCDTMFSender=ct.RTCDtmfSender);var gt=(0,ot.default)(ct,yt.version);ct.RTCPeerConnection=function(st){return st&&st.iceServers&&(st.iceServers=(0,tt.filterIceServers)(st.iceServers,yt.version),s.log("ICE servers after filtering:",st.iceServers)),new gt(st)},ct.RTCPeerConnection.prototype=gt.prototype},lt.shimReplaceTrack=function(ct){!ct.RTCRtpSender||"replaceTrack"in ct.RTCRtpSender.prototype||(ct.RTCRtpSender.prototype.replaceTrack=ct.RTCRtpSender.prototype.setTrack)};var s=function(ct){if(ct&&ct.__esModule)return ct;var yt={};if(ct!=null)for(var pt in ct)Object.prototype.hasOwnProperty.call(ct,pt)&&(yt[pt]=ct[pt]);return yt.default=ct,yt}(et("../utils")),tt=et("./filtericeservers"),ot=function(ct){return ct&&ct.__esModule?ct:{default:ct}}(et("rtcpeerconnection-shim"))},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(et,rt,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.filterIceServers=function(ut,s){var tt=!1;return(ut=JSON.parse(JSON.stringify(ut))).filter(function(ot){if(ot&&(ot.urls||ot.url)){var ct=ot.urls||ot.url;ot.url&&!ot.urls&&it.deprecated("RTCIceServer.url","RTCIceServer.urls");var yt=typeof ct=="string";return yt&&(ct=[ct]),ct=ct.filter(function(pt){if(pt.indexOf("stun:")===0)return!1;var gt=pt.startsWith("turn")&&!pt.startsWith("turn:[")&&pt.includes("transport=udp");return gt&&!tt?(tt=!0,!0):gt&&!tt}),delete ot.url,ot.urls=yt?ct[0]:ct,!!ct.length}})};var it=function(ut){if(ut&&ut.__esModule)return ut;var s={};if(ut!=null)for(var tt in ut)Object.prototype.hasOwnProperty.call(ut,tt)&&(s[tt]=ut[tt]);return s.default=ut,s}(et("../utils"))},{"../utils":15}],9:[function(et,rt,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetDisplayMedia=function(it){"getDisplayMedia"in it.navigator&&it.navigator.mediaDevices&&(it.navigator.mediaDevices&&"getDisplayMedia"in it.navigator.mediaDevices||(it.navigator.mediaDevices.getDisplayMedia=it.navigator.getDisplayMedia.bind(it.navigator)))}},{}],10:[function(et,rt,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetUserMedia=function(it){var ut=it&&it.navigator,s=function(ot){return{name:{PermissionDeniedError:"NotAllowedError"}[ot.name]||ot.name,message:ot.message,constraint:ot.constraint,toString:function(){return this.name}}},tt=ut.mediaDevices.getUserMedia.bind(ut.mediaDevices);ut.mediaDevices.getUserMedia=function(ot){return tt(ot).catch(function(ct){return Promise.reject(s(ct))})}}},{}],11:[function(et,rt,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetDisplayMedia=lt.shimGetUserMedia=void 0;var it=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ot){return typeof ot}:function(ot){return ot&&typeof Symbol=="function"&&ot.constructor===Symbol&&ot!==Symbol.prototype?"symbol":typeof ot},ut=et("./getusermedia");Object.defineProperty(lt,"shimGetUserMedia",{enumerable:!0,get:function(){return ut.shimGetUserMedia}});var s=et("./getdisplaymedia");Object.defineProperty(lt,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}}),lt.shimOnTrack=function(ot){(ot===void 0?"undefined":it(ot))==="object"&&ot.RTCTrackEvent&&"receiver"in ot.RTCTrackEvent.prototype&&!("transceiver"in ot.RTCTrackEvent.prototype)&&Object.defineProperty(ot.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},lt.shimPeerConnection=function(ot){var ct=tt.detectBrowser(ot);if((ot===void 0?"undefined":it(ot))==="object"&&(ot.RTCPeerConnection||ot.mozRTCPeerConnection)){!ot.RTCPeerConnection&&ot.mozRTCPeerConnection&&(ot.RTCPeerConnection=ot.mozRTCPeerConnection),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(st){var ft=ot.RTCPeerConnection.prototype[st];ot.RTCPeerConnection.prototype[st]=function(){return arguments[0]=new(st==="addIceCandidate"?ot.RTCIceCandidate:ot.RTCSessionDescription)(arguments[0]),ft.apply(this,arguments)}});var yt=ot.RTCPeerConnection.prototype.addIceCandidate;ot.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?yt.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var pt={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},gt=ot.RTCPeerConnection.prototype.getStats;ot.RTCPeerConnection.prototype.getStats=function(st,ft,at){return gt.apply(this,[st||null]).then(function(ht){if(ct.version<53&&!ft)try{ht.forEach(function(mt){mt.type=pt[mt.type]||mt.type})}catch(mt){if(mt.name!=="TypeError")throw mt;ht.forEach(function(St,It){ht.set(It,Object.assign({},St,{type:pt[St.type]||St.type}))})}return ht}).then(ft,at)}}},lt.shimSenderGetStats=function(ot){if((ot===void 0?"undefined":it(ot))==="object"&&ot.RTCPeerConnection&&ot.RTCRtpSender&&!(ot.RTCRtpSender&&"getStats"in ot.RTCRtpSender.prototype)){var ct=ot.RTCPeerConnection.prototype.getSenders;ct&&(ot.RTCPeerConnection.prototype.getSenders=function(){var pt=this,gt=ct.apply(this,[]);return gt.forEach(function(st){return st._pc=pt}),gt});var yt=ot.RTCPeerConnection.prototype.addTrack;yt&&(ot.RTCPeerConnection.prototype.addTrack=function(){var pt=yt.apply(this,arguments);return pt._pc=this,pt}),ot.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},lt.shimReceiverGetStats=function(ot){if((ot===void 0?"undefined":it(ot))==="object"&&ot.RTCPeerConnection&&ot.RTCRtpSender&&!(ot.RTCRtpSender&&"getStats"in ot.RTCRtpReceiver.prototype)){var ct=ot.RTCPeerConnection.prototype.getReceivers;ct&&(ot.RTCPeerConnection.prototype.getReceivers=function(){var yt=this,pt=ct.apply(this,[]);return pt.forEach(function(gt){return gt._pc=yt}),pt}),tt.wrapPeerConnectionEvent(ot,"track",function(yt){return yt.receiver._pc=yt.srcElement,yt}),ot.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},lt.shimRemoveStream=function(ot){!ot.RTCPeerConnection||"removeStream"in ot.RTCPeerConnection.prototype||(ot.RTCPeerConnection.prototype.removeStream=function(ct){var yt=this;tt.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(pt){pt.track&&ct.getTracks().includes(pt.track)&&yt.removeTrack(pt)})})},lt.shimRTCDataChannel=function(ot){ot.DataChannel&&!ot.RTCDataChannel&&(ot.RTCDataChannel=ot.DataChannel)};var tt=function(ot){if(ot&&ot.__esModule)return ot;var ct={};if(ot!=null)for(var yt in ot)Object.prototype.hasOwnProperty.call(ot,yt)&&(ct[yt]=ot[yt]);return ct.default=ot,ct}(et("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(et,rt,lt){Object.defineProperty(lt,"__esModule",{value:!0}),lt.shimGetDisplayMedia=function(it,ut){it.navigator.mediaDevices&&"getDisplayMedia"in it.navigator.mediaDevices||it.navigator.mediaDevices&&(it.navigator.mediaDevices.getDisplayMedia=function(s){if(!s||!s.video){var tt=new DOMException("getDisplayMedia without video constraints is undefined");return tt.name="NotFoundError",tt.code=8,Promise.reject(tt)}return s.video===!0?s.video={mediaSource:ut}:s.video.mediaSource=ut,it.navigator.mediaDevices.getUserMedia(s)})}},{}],13:[function(et,rt,lt){Object.defineProperty(lt,"__esModule",{value:!0});var it=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s};lt.shimGetUserMedia=function(s){var tt=ut.detectBrowser(s),ot=s&&s.navigator,ct=s&&s.MediaStreamTrack;if(ot.getUserMedia=function(ft,at,ht){ut.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),ot.mediaDevices.getUserMedia(ft).then(at,ht)},!(tt.version>55&&"autoGainControl"in ot.mediaDevices.getSupportedConstraints())){var yt=function(ft,at,ht){at in ft&&!(ht in ft)&&(ft[ht]=ft[at],delete ft[at])},pt=ot.mediaDevices.getUserMedia.bind(ot.mediaDevices);if(ot.mediaDevices.getUserMedia=function(ft){return(ft===void 0?"undefined":it(ft))==="object"&&it(ft.audio)==="object"&&(ft=JSON.parse(JSON.stringify(ft)),yt(ft.audio,"autoGainControl","mozAutoGainControl"),yt(ft.audio,"noiseSuppression","mozNoiseSuppression")),pt(ft)},ct&&ct.prototype.getSettings){var gt=ct.prototype.getSettings;ct.prototype.getSettings=function(){var ft=gt.apply(this,arguments);return yt(ft,"mozAutoGainControl","autoGainControl"),yt(ft,"mozNoiseSuppression","noiseSuppression"),ft}}if(ct&&ct.prototype.applyConstraints){var st=ct.prototype.applyConstraints;ct.prototype.applyConstraints=function(ft){return this.kind==="audio"&&(ft===void 0?"undefined":it(ft))==="object"&&(ft=JSON.parse(JSON.stringify(ft)),yt(ft,"autoGainControl","mozAutoGainControl"),yt(ft,"noiseSuppression","mozNoiseSuppression")),st.apply(this,[ft])}}}};var ut=function(s){if(s&&s.__esModule)return s;var tt={};if(s!=null)for(var ot in s)Object.prototype.hasOwnProperty.call(s,ot)&&(tt[ot]=s[ot]);return tt.default=s,tt}(et("../utils"))},{"../utils":15}],14:[function(et,rt,lt){function it(tt){return tt&&tt.video!==void 0?Object.assign({},tt,{video:s.compactObject(tt.video)}):tt}Object.defineProperty(lt,"__esModule",{value:!0});var ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(tt){return typeof tt}:function(tt){return tt&&typeof Symbol=="function"&&tt.constructor===Symbol&&tt!==Symbol.prototype?"symbol":typeof tt};lt.shimLocalStreamsAPI=function(tt){if((tt===void 0?"undefined":ut(tt))==="object"&&tt.RTCPeerConnection){if("getLocalStreams"in tt.RTCPeerConnection.prototype||(tt.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in tt.RTCPeerConnection.prototype)){var ot=tt.RTCPeerConnection.prototype.addTrack;tt.RTCPeerConnection.prototype.addStream=function(ct){var yt=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(ct)||this._localStreams.push(ct),ct.getTracks().forEach(function(pt){return ot.call(yt,pt,ct)})},tt.RTCPeerConnection.prototype.addTrack=function(ct,yt){return yt&&(this._localStreams?this._localStreams.includes(yt)||this._localStreams.push(yt):this._localStreams=[yt]),ot.call(this,ct,yt)}}"removeStream"in tt.RTCPeerConnection.prototype||(tt.RTCPeerConnection.prototype.removeStream=function(ct){var yt=this;this._localStreams||(this._localStreams=[]);var pt=this._localStreams.indexOf(ct);if(pt!==-1){this._localStreams.splice(pt,1);var gt=ct.getTracks();this.getSenders().forEach(function(st){gt.includes(st.track)&&yt.removeTrack(st)})}})}},lt.shimRemoteStreamsAPI=function(tt){if((tt===void 0?"undefined":ut(tt))==="object"&&tt.RTCPeerConnection&&("getRemoteStreams"in tt.RTCPeerConnection.prototype||(tt.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in tt.RTCPeerConnection.prototype))){Object.defineProperty(tt.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(ct){var yt=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=ct),this.addEventListener("track",this._onaddstreampoly=function(pt){pt.streams.forEach(function(gt){if(yt._remoteStreams||(yt._remoteStreams=[]),!yt._remoteStreams.includes(gt)){yt._remoteStreams.push(gt);var st=new Event("addstream");st.stream=gt,yt.dispatchEvent(st)}})})}});var ot=tt.RTCPeerConnection.prototype.setRemoteDescription;tt.RTCPeerConnection.prototype.setRemoteDescription=function(){var ct=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(yt){yt.streams.forEach(function(pt){if(ct._remoteStreams||(ct._remoteStreams=[]),!(ct._remoteStreams.indexOf(pt)>=0)){ct._remoteStreams.push(pt);var gt=new Event("addstream");gt.stream=pt,ct.dispatchEvent(gt)}})}),ot.apply(ct,arguments)}}},lt.shimCallbacksAPI=function(tt){if((tt===void 0?"undefined":ut(tt))==="object"&&tt.RTCPeerConnection){var ot=tt.RTCPeerConnection.prototype,ct=ot.createOffer,yt=ot.createAnswer,pt=ot.setLocalDescription,gt=ot.setRemoteDescription,st=ot.addIceCandidate;ot.createOffer=function(at,ht){var mt=arguments.length>=2?arguments[2]:arguments[0],St=ct.apply(this,[mt]);return ht?(St.then(at,ht),Promise.resolve()):St},ot.createAnswer=function(at,ht){var mt=arguments.length>=2?arguments[2]:arguments[0],St=yt.apply(this,[mt]);return ht?(St.then(at,ht),Promise.resolve()):St};var ft=function(at,ht,mt){var St=pt.apply(this,[at]);return mt?(St.then(ht,mt),Promise.resolve()):St};ot.setLocalDescription=ft,ft=function(at,ht,mt){var St=gt.apply(this,[at]);return mt?(St.then(ht,mt),Promise.resolve()):St},ot.setRemoteDescription=ft,ft=function(at,ht,mt){var St=st.apply(this,[at]);return mt?(St.then(ht,mt),Promise.resolve()):St},ot.addIceCandidate=ft}},lt.shimGetUserMedia=function(tt){var ot=tt&&tt.navigator;if(ot.mediaDevices&&ot.mediaDevices.getUserMedia){var ct=ot.mediaDevices,yt=ct.getUserMedia.bind(ct);ot.mediaDevices.getUserMedia=function(pt){return yt(it(pt))}}!ot.getUserMedia&&ot.mediaDevices&&ot.mediaDevices.getUserMedia&&(ot.getUserMedia=(function(pt,gt,st){ot.mediaDevices.getUserMedia(pt).then(gt,st)}).bind(ot))},lt.shimConstraints=it,lt.shimRTCIceServerUrls=function(tt){var ot=tt.RTCPeerConnection;tt.RTCPeerConnection=function(ct,yt){if(ct&&ct.iceServers){for(var pt=[],gt=0;gt<ct.iceServers.length;gt++){var st=ct.iceServers[gt];!st.hasOwnProperty("urls")&&st.hasOwnProperty("url")?(s.deprecated("RTCIceServer.url","RTCIceServer.urls"),(st=JSON.parse(JSON.stringify(st))).urls=st.url,delete st.url,pt.push(st)):pt.push(ct.iceServers[gt])}ct.iceServers=pt}return new ot(ct,yt)},tt.RTCPeerConnection.prototype=ot.prototype,"generateCertificate"in tt.RTCPeerConnection&&Object.defineProperty(tt.RTCPeerConnection,"generateCertificate",{get:function(){return ot.generateCertificate}})},lt.shimTrackEventTransceiver=function(tt){(tt===void 0?"undefined":ut(tt))==="object"&&tt.RTCPeerConnection&&"receiver"in tt.RTCTrackEvent.prototype&&!tt.RTCTransceiver&&Object.defineProperty(tt.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},lt.shimCreateOfferLegacy=function(tt){var ot=tt.RTCPeerConnection.prototype.createOffer;tt.RTCPeerConnection.prototype.createOffer=function(ct){if(ct){ct.offerToReceiveAudio!==void 0&&(ct.offerToReceiveAudio=!!ct.offerToReceiveAudio);var yt=this.getTransceivers().find(function(gt){return gt.receiver.track.kind==="audio"});ct.offerToReceiveAudio===!1&&yt?yt.direction==="sendrecv"?yt.setDirection?yt.setDirection("sendonly"):yt.direction="sendonly":yt.direction==="recvonly"&&(yt.setDirection?yt.setDirection("inactive"):yt.direction="inactive"):ct.offerToReceiveAudio!==!0||yt||this.addTransceiver("audio"),ct.offerToReceiveVideo!==void 0&&(ct.offerToReceiveVideo=!!ct.offerToReceiveVideo);var pt=this.getTransceivers().find(function(gt){return gt.receiver.track.kind==="video"});ct.offerToReceiveVideo===!1&&pt?pt.direction==="sendrecv"?pt.setDirection?pt.setDirection("sendonly"):pt.direction="sendonly":pt.direction==="recvonly"&&(pt.setDirection?pt.setDirection("inactive"):pt.direction="inactive"):ct.offerToReceiveVideo!==!0||pt||this.addTransceiver("video")}return ot.apply(this,arguments)}};var s=function(tt){if(tt&&tt.__esModule)return tt;var ot={};if(tt!=null)for(var ct in tt)Object.prototype.hasOwnProperty.call(tt,ct)&&(ot[ct]=tt[ct]);return ot.default=tt,ot}(et("../utils"))},{"../utils":15}],15:[function(et,rt,lt){function it(pt,gt,st){return gt in pt?Object.defineProperty(pt,gt,{value:st,enumerable:!0,configurable:!0,writable:!0}):pt[gt]=st,pt}function ut(pt,gt,st){var ft=pt.match(gt);return ft&&ft.length>=st&&parseInt(ft[st],10)}function s(pt){return(pt===void 0?"undefined":ot(pt))!=="object"?pt:Object.keys(pt).reduce(function(gt,st){var ft=ot(pt[st])==="object",at=ft?s(pt[st]):pt[st],ht=ft&&!Object.keys(at).length;return at===void 0||ht?gt:Object.assign(gt,it({},st,at))},{})}function tt(pt,gt,st){gt&&!st.has(gt.id)&&(st.set(gt.id,gt),Object.keys(gt).forEach(function(ft){ft.endsWith("Id")?tt(pt,pt.get(gt[ft]),st):ft.endsWith("Ids")&&gt[ft].forEach(function(at){tt(pt,pt.get(at),st)})}))}Object.defineProperty(lt,"__esModule",{value:!0});var ot=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(pt){return typeof pt}:function(pt){return pt&&typeof Symbol=="function"&&pt.constructor===Symbol&&pt!==Symbol.prototype?"symbol":typeof pt};lt.extractVersion=ut,lt.wrapPeerConnectionEvent=function(pt,gt,st){if(pt.RTCPeerConnection){var ft=pt.RTCPeerConnection.prototype,at=ft.addEventListener;ft.addEventListener=function(mt,St){if(mt!==gt)return at.apply(this,arguments);var It=function(xt){var At=st(xt);At&&St(At)};return this._eventMap=this._eventMap||{},this._eventMap[St]=It,at.apply(this,[mt,It])};var ht=ft.removeEventListener;ft.removeEventListener=function(mt,St){if(mt!==gt||!this._eventMap||!this._eventMap[St])return ht.apply(this,arguments);var It=this._eventMap[St];return delete this._eventMap[St],ht.apply(this,[mt,It])},Object.defineProperty(ft,"on"+gt,{get:function(){return this["_on"+gt]},set:function(mt){this["_on"+gt]&&(this.removeEventListener(gt,this["_on"+gt]),delete this["_on"+gt]),mt&&this.addEventListener(gt,this["_on"+gt]=mt)},enumerable:!0,configurable:!0})}},lt.disableLog=function(pt){return typeof pt!="boolean"?new Error("Argument type: "+(pt===void 0?"undefined":ot(pt))+". Please use a boolean."):(ct=pt,pt?"adapter.js logging disabled":"adapter.js logging enabled")},lt.disableWarnings=function(pt){return typeof pt!="boolean"?new Error("Argument type: "+(pt===void 0?"undefined":ot(pt))+". Please use a boolean."):(yt=!pt,"adapter.js deprecation warnings "+(pt?"disabled":"enabled"))},lt.log=function(){if((typeof window>"u"?"undefined":ot(window))==="object"){if(ct)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}},lt.deprecated=function(pt,gt){yt&&console.warn(pt+" is deprecated, please use "+gt+" instead.")},lt.detectBrowser=function(pt){var gt=pt.navigator,st={browser:null,version:null};if(pt===void 0||!pt.navigator)return st.browser="Not a browser.",st;if(gt.mozGetUserMedia)st.browser="firefox",st.version=ut(gt.userAgent,/Firefox\/(\d+)\./,1);else if(gt.webkitGetUserMedia||pt.isSecureContext===!1&&pt.webkitRTCPeerConnection&&!pt.RTCIceGatherer)st.browser="chrome",st.version=ut(gt.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(gt.mediaDevices&&gt.userAgent.match(/Edge\/(\d+).(\d+)$/))st.browser="edge",st.version=ut(gt.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!pt.RTCPeerConnection||!gt.userAgent.match(/AppleWebKit\/(\d+)\./))return st.browser="Not a supported browser.",st;st.browser="safari",st.version=ut(gt.userAgent,/AppleWebKit\/(\d+)\./,1)}return st},lt.compactObject=s,lt.walkStats=tt,lt.filterStats=function(pt,gt,st){var ft=st?"outbound-rtp":"inbound-rtp",at=new Map;if(gt===null)return at;var ht=[];return pt.forEach(function(mt){mt.type==="track"&&mt.trackIdentifier===gt.id&&ht.push(mt)}),ht.forEach(function(mt){pt.forEach(function(St){St.type===ft&&St.trackId===mt.id&&tt(pt,St,at)})}),at};var ct=!0,yt=!0},{}],16:[function(et,rt,lt){function it(gt){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[gt.type]||gt.type}function ut(gt,st,ft,at,ht){var mt=pt.writeRtpDescription(gt.kind,st);if(mt+=pt.writeIceParameters(gt.iceGatherer.getLocalParameters()),mt+=pt.writeDtlsParameters(gt.dtlsTransport.getLocalParameters(),ft==="offer"?"actpass":ht||"active"),mt+="a=mid:"+gt.mid+`\r
`,gt.rtpSender&&gt.rtpReceiver?mt+=`a=sendrecv\r
`:gt.rtpSender?mt+=`a=sendonly\r
`:gt.rtpReceiver?mt+=`a=recvonly\r
`:mt+=`a=inactive\r
`,gt.rtpSender){var St=gt.rtpSender._initialTrackId||gt.rtpSender.track.id;gt.rtpSender._initialTrackId=St;var It="msid:"+(at?at.id:"-")+" "+St+`\r
`;mt+="a="+It,mt+="a=ssrc:"+gt.sendEncodingParameters[0].ssrc+" "+It,gt.sendEncodingParameters[0].rtx&&(mt+="a=ssrc:"+gt.sendEncodingParameters[0].rtx.ssrc+" "+It,mt+="a=ssrc-group:FID "+gt.sendEncodingParameters[0].ssrc+" "+gt.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return mt+="a=ssrc:"+gt.sendEncodingParameters[0].ssrc+" cname:"+pt.localCName+`\r
`,gt.rtpSender&&gt.sendEncodingParameters[0].rtx&&(mt+="a=ssrc:"+gt.sendEncodingParameters[0].rtx.ssrc+" cname:"+pt.localCName+`\r
`),mt}function s(gt,st){var ft=!1;return(gt=JSON.parse(JSON.stringify(gt))).filter(function(at){if(at&&(at.urls||at.url)){var ht=at.urls||at.url;at.url&&!at.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var mt=typeof ht=="string";return mt&&(ht=[ht]),ht=ht.filter(function(St){return St.indexOf("turn:")===0&&St.indexOf("transport=udp")!==-1&&St.indexOf("turn:[")===-1&&!ft?(ft=!0,!0):St.indexOf("stun:")===0&&st>=14393&&St.indexOf("?transport=udp")===-1}),delete at.url,at.urls=mt?ht[0]:ht,!!ht.length}})}function tt(gt,st){var ft={codecs:[],headerExtensions:[],fecMechanisms:[]},at=function(mt,St){mt=parseInt(mt,10);for(var It=0;It<St.length;It++)if(St[It].payloadType===mt||St[It].preferredPayloadType===mt)return St[It]},ht=function(mt,St,It,xt){var At=at(mt.parameters.apt,It),Nt=at(St.parameters.apt,xt);return At&&Nt&&At.name.toLowerCase()===Nt.name.toLowerCase()};return gt.codecs.forEach(function(mt){for(var St=0;St<st.codecs.length;St++){var It=st.codecs[St];if(mt.name.toLowerCase()===It.name.toLowerCase()&&mt.clockRate===It.clockRate){if(mt.name.toLowerCase()==="rtx"&&mt.parameters&&It.parameters.apt&&!ht(mt,It,gt.codecs,st.codecs))continue;(It=JSON.parse(JSON.stringify(It))).numChannels=Math.min(mt.numChannels,It.numChannels),ft.codecs.push(It),It.rtcpFeedback=It.rtcpFeedback.filter(function(xt){for(var At=0;At<mt.rtcpFeedback.length;At++)if(mt.rtcpFeedback[At].type===xt.type&&mt.rtcpFeedback[At].parameter===xt.parameter)return!0;return!1});break}}}),gt.headerExtensions.forEach(function(mt){for(var St=0;St<st.headerExtensions.length;St++){var It=st.headerExtensions[St];if(mt.uri===It.uri){ft.headerExtensions.push(It);break}}}),ft}function ot(gt,st,ft){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[st][gt].indexOf(ft)!==-1}function ct(gt,st){var ft=gt.getRemoteCandidates().find(function(at){return st.foundation===at.foundation&&st.ip===at.ip&&st.port===at.port&&st.priority===at.priority&&st.protocol===at.protocol&&st.type===at.type});return ft||gt.addRemoteCandidate(st),!ft}function yt(gt,st){var ft=new Error(st);return ft.name=gt,ft.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[gt],ft}var pt=et("sdp");rt.exports=function(gt,st){function ft(It,xt){xt.addTrack(It),xt.dispatchEvent(new gt.MediaStreamTrackEvent("addtrack",{track:It}))}function at(It,xt){xt.removeTrack(It),xt.dispatchEvent(new gt.MediaStreamTrackEvent("removetrack",{track:It}))}function ht(It,xt,At,Nt){var kt=new Event("track");kt.track=xt,kt.receiver=At,kt.transceiver={receiver:At},kt.streams=Nt,gt.setTimeout(function(){It._dispatchEvent("track",kt)})}var mt=function(It){var xt=this,At=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(kt){xt[kt]=At[kt].bind(At)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",It=JSON.parse(JSON.stringify(It||{})),this.usingBundle=It.bundlePolicy==="max-bundle",It.rtcpMuxPolicy==="negotiate")throw yt("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(It.rtcpMuxPolicy||(It.rtcpMuxPolicy="require"),It.iceTransportPolicy){case"all":case"relay":break;default:It.iceTransportPolicy="all"}switch(It.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:It.bundlePolicy="balanced"}if(It.iceServers=s(It.iceServers||[],st),this._iceGatherers=[],It.iceCandidatePoolSize)for(var Nt=It.iceCandidatePoolSize;Nt>0;Nt--)this._iceGatherers.push(new gt.RTCIceGatherer({iceServers:It.iceServers,gatherPolicy:It.iceTransportPolicy}));else It.iceCandidatePoolSize=0;this._config=It,this.transceivers=[],this._sdpSessionId=pt.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(mt.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(mt.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),mt.prototype.onicecandidate=null,mt.prototype.onaddstream=null,mt.prototype.ontrack=null,mt.prototype.onremovestream=null,mt.prototype.onsignalingstatechange=null,mt.prototype.oniceconnectionstatechange=null,mt.prototype.onconnectionstatechange=null,mt.prototype.onicegatheringstatechange=null,mt.prototype.onnegotiationneeded=null,mt.prototype.ondatachannel=null,mt.prototype._dispatchEvent=function(It,xt){this._isClosed||(this.dispatchEvent(xt),typeof this["on"+It]=="function"&&this["on"+It](xt))},mt.prototype._emitGatheringStateChange=function(){var It=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",It)},mt.prototype.getConfiguration=function(){return this._config},mt.prototype.getLocalStreams=function(){return this.localStreams},mt.prototype.getRemoteStreams=function(){return this.remoteStreams},mt.prototype._createTransceiver=function(It,xt){var At=this.transceivers.length>0,Nt={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:It,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&At)Nt.iceTransport=this.transceivers[0].iceTransport,Nt.dtlsTransport=this.transceivers[0].dtlsTransport;else{var kt=this._createIceAndDtlsTransports();Nt.iceTransport=kt.iceTransport,Nt.dtlsTransport=kt.dtlsTransport}return xt||this.transceivers.push(Nt),Nt},mt.prototype.addTrack=function(It,xt){if(this._isClosed)throw yt("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(kt){return kt.track===It}))throw yt("InvalidAccessError","Track already exists.");for(var At,Nt=0;Nt<this.transceivers.length;Nt++)this.transceivers[Nt].track||this.transceivers[Nt].kind!==It.kind||(At=this.transceivers[Nt]);return At||(At=this._createTransceiver(It.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(xt)===-1&&this.localStreams.push(xt),At.track=It,At.stream=xt,At.rtpSender=new gt.RTCRtpSender(It,At.dtlsTransport),At.rtpSender},mt.prototype.addStream=function(It){var xt=this;if(st>=15025)It.getTracks().forEach(function(Nt){xt.addTrack(Nt,It)});else{var At=It.clone();It.getTracks().forEach(function(Nt,kt){var Mt=At.getTracks()[kt];Nt.addEventListener("enabled",function(bt){Mt.enabled=bt.enabled})}),At.getTracks().forEach(function(Nt){xt.addTrack(Nt,At)})}},mt.prototype.removeTrack=function(It){if(this._isClosed)throw yt("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(It instanceof gt.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var xt=this.transceivers.find(function(Nt){return Nt.rtpSender===It});if(!xt)throw yt("InvalidAccessError","Sender was not created by this connection.");var At=xt.stream;xt.rtpSender.stop(),xt.rtpSender=null,xt.track=null,xt.stream=null,this.transceivers.map(function(Nt){return Nt.stream}).indexOf(At)===-1&&this.localStreams.indexOf(At)>-1&&this.localStreams.splice(this.localStreams.indexOf(At),1),this._maybeFireNegotiationNeeded()},mt.prototype.removeStream=function(It){var xt=this;It.getTracks().forEach(function(At){var Nt=xt.getSenders().find(function(kt){return kt.track===At});Nt&&xt.removeTrack(Nt)})},mt.prototype.getSenders=function(){return this.transceivers.filter(function(It){return!!It.rtpSender}).map(function(It){return It.rtpSender})},mt.prototype.getReceivers=function(){return this.transceivers.filter(function(It){return!!It.rtpReceiver}).map(function(It){return It.rtpReceiver})},mt.prototype._createIceGatherer=function(It,xt){var At=this;if(xt&&It>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var Nt=new gt.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(Nt,"state",{value:"new",writable:!0}),this.transceivers[It].bufferedCandidateEvents=[],this.transceivers[It].bufferCandidates=function(kt){var Mt=!kt.candidate||Object.keys(kt.candidate).length===0;Nt.state=Mt?"completed":"gathering",At.transceivers[It].bufferedCandidateEvents!==null&&At.transceivers[It].bufferedCandidateEvents.push(kt)},Nt.addEventListener("localcandidate",this.transceivers[It].bufferCandidates),Nt},mt.prototype._gather=function(It,xt){var At=this,Nt=this.transceivers[xt].iceGatherer;if(!Nt.onlocalcandidate){var kt=this.transceivers[xt].bufferedCandidateEvents;this.transceivers[xt].bufferedCandidateEvents=null,Nt.removeEventListener("localcandidate",this.transceivers[xt].bufferCandidates),Nt.onlocalcandidate=function(Mt){if(!(At.usingBundle&&xt>0)){var bt=new Event("icecandidate");bt.candidate={sdpMid:It,sdpMLineIndex:xt};var Bt=Mt.candidate,Ht=!Bt||Object.keys(Bt).length===0;if(Ht)Nt.state!=="new"&&Nt.state!=="gathering"||(Nt.state="completed");else{Nt.state==="new"&&(Nt.state="gathering"),Bt.component=1,Bt.ufrag=Nt.getLocalParameters().usernameFragment;var Wt=pt.writeCandidate(Bt);bt.candidate=Object.assign(bt.candidate,pt.parseCandidate(Wt)),bt.candidate.candidate=Wt,bt.candidate.toJSON=function(){return{candidate:bt.candidate.candidate,sdpMid:bt.candidate.sdpMid,sdpMLineIndex:bt.candidate.sdpMLineIndex,usernameFragment:bt.candidate.usernameFragment}}}var nn=pt.getMediaSections(At._localDescription.sdp);nn[bt.candidate.sdpMLineIndex]+=Ht?`a=end-of-candidates\r
`:"a="+bt.candidate.candidate+`\r
`,At._localDescription.sdp=pt.getDescription(At._localDescription.sdp)+nn.join("");var gn=At.transceivers.every(function(tn){return tn.iceGatherer&&tn.iceGatherer.state==="completed"});At.iceGatheringState!=="gathering"&&(At.iceGatheringState="gathering",At._emitGatheringStateChange()),Ht||At._dispatchEvent("icecandidate",bt),gn&&(At._dispatchEvent("icecandidate",new Event("icecandidate")),At.iceGatheringState="complete",At._emitGatheringStateChange())}},gt.setTimeout(function(){kt.forEach(function(Mt){Nt.onlocalcandidate(Mt)})},0)}},mt.prototype._createIceAndDtlsTransports=function(){var It=this,xt=new gt.RTCIceTransport(null);xt.onicestatechange=function(){It._updateIceConnectionState(),It._updateConnectionState()};var At=new gt.RTCDtlsTransport(xt);return At.ondtlsstatechange=function(){It._updateConnectionState()},At.onerror=function(){Object.defineProperty(At,"state",{value:"failed",writable:!0}),It._updateConnectionState()},{iceTransport:xt,dtlsTransport:At}},mt.prototype._disposeIceAndDtlsTransports=function(It){var xt=this.transceivers[It].iceGatherer;xt&&(delete xt.onlocalcandidate,delete this.transceivers[It].iceGatherer);var At=this.transceivers[It].iceTransport;At&&(delete At.onicestatechange,delete this.transceivers[It].iceTransport);var Nt=this.transceivers[It].dtlsTransport;Nt&&(delete Nt.ondtlsstatechange,delete Nt.onerror,delete this.transceivers[It].dtlsTransport)},mt.prototype._transceive=function(It,xt,At){var Nt=tt(It.localCapabilities,It.remoteCapabilities);xt&&It.rtpSender&&(Nt.encodings=It.sendEncodingParameters,Nt.rtcp={cname:pt.localCName,compound:It.rtcpParameters.compound},It.recvEncodingParameters.length&&(Nt.rtcp.ssrc=It.recvEncodingParameters[0].ssrc),It.rtpSender.send(Nt)),At&&It.rtpReceiver&&Nt.codecs.length>0&&(It.kind==="video"&&It.recvEncodingParameters&&st<15019&&It.recvEncodingParameters.forEach(function(kt){delete kt.rtx}),It.recvEncodingParameters.length?Nt.encodings=It.recvEncodingParameters:Nt.encodings=[{}],Nt.rtcp={compound:It.rtcpParameters.compound},It.rtcpParameters.cname&&(Nt.rtcp.cname=It.rtcpParameters.cname),It.sendEncodingParameters.length&&(Nt.rtcp.ssrc=It.sendEncodingParameters[0].ssrc),It.rtpReceiver.receive(Nt))},mt.prototype.setLocalDescription=function(It){var xt=this;if(["offer","answer"].indexOf(It.type)===-1)return Promise.reject(yt("TypeError",'Unsupported type "'+It.type+'"'));if(!ot("setLocalDescription",It.type,xt.signalingState)||xt._isClosed)return Promise.reject(yt("InvalidStateError","Can not set local "+It.type+" in state "+xt.signalingState));var At,Nt;if(It.type==="offer")At=pt.splitSections(It.sdp),Nt=At.shift(),At.forEach(function(Mt,bt){var Bt=pt.parseRtpParameters(Mt);xt.transceivers[bt].localCapabilities=Bt}),xt.transceivers.forEach(function(Mt,bt){xt._gather(Mt.mid,bt)});else if(It.type==="answer"){At=pt.splitSections(xt._remoteDescription.sdp),Nt=At.shift();var kt=pt.matchPrefix(Nt,"a=ice-lite").length>0;At.forEach(function(Mt,bt){var Bt=xt.transceivers[bt],Ht=Bt.iceGatherer,Wt=Bt.iceTransport,nn=Bt.dtlsTransport,gn=Bt.localCapabilities,tn=Bt.remoteCapabilities;if(!(pt.isRejected(Mt)&&pt.matchPrefix(Mt,"a=bundle-only").length===0)&&!Bt.rejected){var Gt=pt.getIceParameters(Mt,Nt),fn=pt.getDtlsParameters(Mt,Nt);kt&&(fn.role="server"),xt.usingBundle&&bt!==0||(xt._gather(Bt.mid,bt),Wt.state==="new"&&Wt.start(Ht,Gt,kt?"controlling":"controlled"),nn.state==="new"&&nn.start(fn));var Cn=tt(gn,tn);xt._transceive(Bt,Cn.codecs.length>0,!1)}})}return xt._localDescription={type:It.type,sdp:It.sdp},It.type==="offer"?xt._updateSignalingState("have-local-offer"):xt._updateSignalingState("stable"),Promise.resolve()},mt.prototype.setRemoteDescription=function(It){var xt=this;if(["offer","answer"].indexOf(It.type)===-1)return Promise.reject(yt("TypeError",'Unsupported type "'+It.type+'"'));if(!ot("setRemoteDescription",It.type,xt.signalingState)||xt._isClosed)return Promise.reject(yt("InvalidStateError","Can not set remote "+It.type+" in state "+xt.signalingState));var At={};xt.remoteStreams.forEach(function(Wt){At[Wt.id]=Wt});var Nt=[],kt=pt.splitSections(It.sdp),Mt=kt.shift(),bt=pt.matchPrefix(Mt,"a=ice-lite").length>0,Bt=pt.matchPrefix(Mt,"a=group:BUNDLE ").length>0;xt.usingBundle=Bt;var Ht=pt.matchPrefix(Mt,"a=ice-options:")[0];return xt.canTrickleIceCandidates=!!Ht&&Ht.substr(14).split(" ").indexOf("trickle")>=0,kt.forEach(function(Wt,nn){var gn=pt.splitLines(Wt),tn=pt.getKind(Wt),Gt=pt.isRejected(Wt)&&pt.matchPrefix(Wt,"a=bundle-only").length===0,fn=gn[0].substr(2).split(" ")[2],Cn=pt.getDirection(Wt,Mt),Tn=pt.parseMsid(Wt),dn=pt.getMid(Wt)||pt.generateIdentifier();if(Gt||tn==="application"&&(fn==="DTLS/SCTP"||fn==="UDP/DTLS/SCTP"))xt.transceivers[nn]={mid:dn,kind:tn,protocol:fn,rejected:!0};else{!Gt&&xt.transceivers[nn]&&xt.transceivers[nn].rejected&&(xt.transceivers[nn]=xt._createTransceiver(tn,!0));var mn,yn,pn,In,On,_n,Mn,Nn,wn,Pn,Fn,ar=pt.parseRtpParameters(Wt);Gt||(Pn=pt.getIceParameters(Wt,Mt),(Fn=pt.getDtlsParameters(Wt,Mt)).role="client"),Mn=pt.parseRtpEncodingParameters(Wt);var Yn=pt.parseRtcpParameters(Wt),Xn=pt.matchPrefix(Wt,"a=end-of-candidates",Mt).length>0,tr=pt.matchPrefix(Wt,"a=candidate:").map(function(Qn){return pt.parseCandidate(Qn)}).filter(function(Qn){return Qn.component===1});if((It.type==="offer"||It.type==="answer")&&!Gt&&Bt&&nn>0&&xt.transceivers[nn]&&(xt._disposeIceAndDtlsTransports(nn),xt.transceivers[nn].iceGatherer=xt.transceivers[0].iceGatherer,xt.transceivers[nn].iceTransport=xt.transceivers[0].iceTransport,xt.transceivers[nn].dtlsTransport=xt.transceivers[0].dtlsTransport,xt.transceivers[nn].rtpSender&&xt.transceivers[nn].rtpSender.setTransport(xt.transceivers[0].dtlsTransport),xt.transceivers[nn].rtpReceiver&&xt.transceivers[nn].rtpReceiver.setTransport(xt.transceivers[0].dtlsTransport)),It.type!=="offer"||Gt)It.type!=="answer"||Gt||(yn=(mn=xt.transceivers[nn]).iceGatherer,pn=mn.iceTransport,In=mn.dtlsTransport,On=mn.rtpReceiver,_n=mn.sendEncodingParameters,Nn=mn.localCapabilities,xt.transceivers[nn].recvEncodingParameters=Mn,xt.transceivers[nn].remoteCapabilities=ar,xt.transceivers[nn].rtcpParameters=Yn,tr.length&&pn.state==="new"&&(!bt&&!Xn||Bt&&nn!==0?tr.forEach(function(Qn){ct(mn.iceTransport,Qn)}):pn.setRemoteCandidates(tr)),Bt&&nn!==0||(pn.state==="new"&&pn.start(yn,Pn,"controlling"),In.state==="new"&&In.start(Fn)),!tt(mn.localCapabilities,mn.remoteCapabilities).codecs.filter(function(Qn){return Qn.name.toLowerCase()==="rtx"}).length&&mn.sendEncodingParameters[0].rtx&&delete mn.sendEncodingParameters[0].rtx,xt._transceive(mn,Cn==="sendrecv"||Cn==="recvonly",Cn==="sendrecv"||Cn==="sendonly"),!On||Cn!=="sendrecv"&&Cn!=="sendonly"?delete mn.rtpReceiver:(wn=On.track,Tn?(At[Tn.stream]||(At[Tn.stream]=new gt.MediaStream),ft(wn,At[Tn.stream]),Nt.push([wn,On,At[Tn.stream]])):(At.default||(At.default=new gt.MediaStream),ft(wn,At.default),Nt.push([wn,On,At.default]))));else{(mn=xt.transceivers[nn]||xt._createTransceiver(tn)).mid=dn,mn.iceGatherer||(mn.iceGatherer=xt._createIceGatherer(nn,Bt)),tr.length&&mn.iceTransport.state==="new"&&(!Xn||Bt&&nn!==0?tr.forEach(function(Qn){ct(mn.iceTransport,Qn)}):mn.iceTransport.setRemoteCandidates(tr)),Nn=gt.RTCRtpReceiver.getCapabilities(tn),st<15019&&(Nn.codecs=Nn.codecs.filter(function(Qn){return Qn.name!=="rtx"})),_n=mn.sendEncodingParameters||[{ssrc:1001*(2*nn+2)}];var cn=!1;if(Cn==="sendrecv"||Cn==="sendonly"){if(cn=!mn.rtpReceiver,On=mn.rtpReceiver||new gt.RTCRtpReceiver(mn.dtlsTransport,tn),cn){var Hn;wn=On.track,Tn&&Tn.stream==="-"||(Tn?(At[Tn.stream]||(At[Tn.stream]=new gt.MediaStream,Object.defineProperty(At[Tn.stream],"id",{get:function(){return Tn.stream}})),Object.defineProperty(wn,"id",{get:function(){return Tn.track}}),Hn=At[Tn.stream]):(At.default||(At.default=new gt.MediaStream),Hn=At.default)),Hn&&(ft(wn,Hn),mn.associatedRemoteMediaStreams.push(Hn)),Nt.push([wn,On,Hn])}}else mn.rtpReceiver&&mn.rtpReceiver.track&&(mn.associatedRemoteMediaStreams.forEach(function(Qn){var or=Qn.getTracks().find(function(Wn){return Wn.id===mn.rtpReceiver.track.id});or&&at(or,Qn)}),mn.associatedRemoteMediaStreams=[]);mn.localCapabilities=Nn,mn.remoteCapabilities=ar,mn.rtpReceiver=On,mn.rtcpParameters=Yn,mn.sendEncodingParameters=_n,mn.recvEncodingParameters=Mn,xt._transceive(xt.transceivers[nn],!1,cn)}}}),xt._dtlsRole===void 0&&(xt._dtlsRole=It.type==="offer"?"active":"passive"),xt._remoteDescription={type:It.type,sdp:It.sdp},It.type==="offer"?xt._updateSignalingState("have-remote-offer"):xt._updateSignalingState("stable"),Object.keys(At).forEach(function(Wt){var nn=At[Wt];if(nn.getTracks().length){if(xt.remoteStreams.indexOf(nn)===-1){xt.remoteStreams.push(nn);var gn=new Event("addstream");gn.stream=nn,gt.setTimeout(function(){xt._dispatchEvent("addstream",gn)})}Nt.forEach(function(tn){var Gt=tn[0],fn=tn[1];nn.id===tn[2].id&&ht(xt,Gt,fn,[nn])})}}),Nt.forEach(function(Wt){Wt[2]||ht(xt,Wt[0],Wt[1],[])}),gt.setTimeout(function(){xt&&xt.transceivers&&xt.transceivers.forEach(function(Wt){Wt.iceTransport&&Wt.iceTransport.state==="new"&&Wt.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),Wt.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},mt.prototype.close=function(){this.transceivers.forEach(function(It){It.iceTransport&&It.iceTransport.stop(),It.dtlsTransport&&It.dtlsTransport.stop(),It.rtpSender&&It.rtpSender.stop(),It.rtpReceiver&&It.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},mt.prototype._updateSignalingState=function(It){this.signalingState=It;var xt=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",xt)},mt.prototype._maybeFireNegotiationNeeded=function(){var It=this;this.signalingState==="stable"&&this.needNegotiation!==!0&&(this.needNegotiation=!0,gt.setTimeout(function(){if(It.needNegotiation){It.needNegotiation=!1;var xt=new Event("negotiationneeded");It._dispatchEvent("negotiationneeded",xt)}},0))},mt.prototype._updateIceConnectionState=function(){var It,xt={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(Nt){Nt.iceTransport&&!Nt.rejected&&xt[Nt.iceTransport.state]++}),It="new",xt.failed>0?It="failed":xt.checking>0?It="checking":xt.disconnected>0?It="disconnected":xt.new>0?It="new":xt.connected>0?It="connected":xt.completed>0&&(It="completed"),It!==this.iceConnectionState){this.iceConnectionState=It;var At=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",At)}},mt.prototype._updateConnectionState=function(){var It,xt={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(Nt){Nt.iceTransport&&Nt.dtlsTransport&&!Nt.rejected&&(xt[Nt.iceTransport.state]++,xt[Nt.dtlsTransport.state]++)}),xt.connected+=xt.completed,It="new",xt.failed>0?It="failed":xt.connecting>0?It="connecting":xt.disconnected>0?It="disconnected":xt.new>0?It="new":xt.connected>0&&(It="connected"),It!==this.connectionState){this.connectionState=It;var At=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",At)}},mt.prototype.createOffer=function(){var It=this;if(It._isClosed)return Promise.reject(yt("InvalidStateError","Can not call createOffer after close"));var xt=It.transceivers.filter(function(bt){return bt.kind==="audio"}).length,At=It.transceivers.filter(function(bt){return bt.kind==="video"}).length,Nt=arguments[0];if(Nt){if(Nt.mandatory||Nt.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");Nt.offerToReceiveAudio!==void 0&&(xt=Nt.offerToReceiveAudio===!0?1:Nt.offerToReceiveAudio===!1?0:Nt.offerToReceiveAudio),Nt.offerToReceiveVideo!==void 0&&(At=Nt.offerToReceiveVideo===!0?1:Nt.offerToReceiveVideo===!1?0:Nt.offerToReceiveVideo)}for(It.transceivers.forEach(function(bt){bt.kind==="audio"?--xt<0&&(bt.wantReceive=!1):bt.kind==="video"&&--At<0&&(bt.wantReceive=!1)});xt>0||At>0;)xt>0&&(It._createTransceiver("audio"),xt--),At>0&&(It._createTransceiver("video"),At--);var kt=pt.writeSessionBoilerplate(It._sdpSessionId,It._sdpSessionVersion++);It.transceivers.forEach(function(bt,Bt){var Ht=bt.track,Wt=bt.kind,nn=bt.mid||pt.generateIdentifier();bt.mid=nn,bt.iceGatherer||(bt.iceGatherer=It._createIceGatherer(Bt,It.usingBundle));var gn=gt.RTCRtpSender.getCapabilities(Wt);st<15019&&(gn.codecs=gn.codecs.filter(function(Gt){return Gt.name!=="rtx"})),gn.codecs.forEach(function(Gt){Gt.name==="H264"&&Gt.parameters["level-asymmetry-allowed"]===void 0&&(Gt.parameters["level-asymmetry-allowed"]="1"),bt.remoteCapabilities&&bt.remoteCapabilities.codecs&&bt.remoteCapabilities.codecs.forEach(function(fn){Gt.name.toLowerCase()===fn.name.toLowerCase()&&Gt.clockRate===fn.clockRate&&(Gt.preferredPayloadType=fn.payloadType)})}),gn.headerExtensions.forEach(function(Gt){(bt.remoteCapabilities&&bt.remoteCapabilities.headerExtensions||[]).forEach(function(fn){Gt.uri===fn.uri&&(Gt.id=fn.id)})});var tn=bt.sendEncodingParameters||[{ssrc:1001*(2*Bt+1)}];Ht&&st>=15019&&Wt==="video"&&!tn[0].rtx&&(tn[0].rtx={ssrc:tn[0].ssrc+1}),bt.wantReceive&&(bt.rtpReceiver=new gt.RTCRtpReceiver(bt.dtlsTransport,Wt)),bt.localCapabilities=gn,bt.sendEncodingParameters=tn}),It._config.bundlePolicy!=="max-compat"&&(kt+="a=group:BUNDLE "+It.transceivers.map(function(bt){return bt.mid}).join(" ")+`\r
`),kt+=`a=ice-options:trickle\r
`,It.transceivers.forEach(function(bt,Bt){kt+=ut(bt,bt.localCapabilities,"offer",bt.stream,It._dtlsRole),kt+=`a=rtcp-rsize\r
`,!bt.iceGatherer||It.iceGatheringState==="new"||Bt!==0&&It.usingBundle||(bt.iceGatherer.getLocalCandidates().forEach(function(Ht){Ht.component=1,kt+="a="+pt.writeCandidate(Ht)+`\r
`}),bt.iceGatherer.state==="completed"&&(kt+=`a=end-of-candidates\r
`))});var Mt=new gt.RTCSessionDescription({type:"offer",sdp:kt});return Promise.resolve(Mt)},mt.prototype.createAnswer=function(){var It=this;if(It._isClosed)return Promise.reject(yt("InvalidStateError","Can not call createAnswer after close"));if(It.signalingState!=="have-remote-offer"&&It.signalingState!=="have-local-pranswer")return Promise.reject(yt("InvalidStateError","Can not call createAnswer in signalingState "+It.signalingState));var xt=pt.writeSessionBoilerplate(It._sdpSessionId,It._sdpSessionVersion++);It.usingBundle&&(xt+="a=group:BUNDLE "+It.transceivers.map(function(kt){return kt.mid}).join(" ")+`\r
`),xt+=`a=ice-options:trickle\r
`;var At=pt.getMediaSections(It._remoteDescription.sdp).length;It.transceivers.forEach(function(kt,Mt){if(!(Mt+1>At)){if(kt.rejected)return kt.kind==="application"?kt.protocol==="DTLS/SCTP"?xt+=`m=application 0 DTLS/SCTP 5000\r
`:xt+="m=application 0 "+kt.protocol+` webrtc-datachannel\r
`:kt.kind==="audio"?xt+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:kt.kind==="video"&&(xt+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),void(xt+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+kt.mid+`\r
`);if(kt.stream){var bt;kt.kind==="audio"?bt=kt.stream.getAudioTracks()[0]:kt.kind==="video"&&(bt=kt.stream.getVideoTracks()[0]),bt&&st>=15019&&kt.kind==="video"&&!kt.sendEncodingParameters[0].rtx&&(kt.sendEncodingParameters[0].rtx={ssrc:kt.sendEncodingParameters[0].ssrc+1})}var Bt=tt(kt.localCapabilities,kt.remoteCapabilities);!Bt.codecs.filter(function(Ht){return Ht.name.toLowerCase()==="rtx"}).length&&kt.sendEncodingParameters[0].rtx&&delete kt.sendEncodingParameters[0].rtx,xt+=ut(kt,Bt,"answer",kt.stream,It._dtlsRole),kt.rtcpParameters&&kt.rtcpParameters.reducedSize&&(xt+=`a=rtcp-rsize\r
`)}});var Nt=new gt.RTCSessionDescription({type:"answer",sdp:xt});return Promise.resolve(Nt)},mt.prototype.addIceCandidate=function(It){var xt,At=this;return It&&It.sdpMLineIndex===void 0&&!It.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(Nt,kt){if(!At._remoteDescription)return kt(yt("InvalidStateError","Can not add ICE candidate without a remote description"));if(It&&It.candidate!==""){var Mt=It.sdpMLineIndex;if(It.sdpMid){for(var bt=0;bt<At.transceivers.length;bt++)if(At.transceivers[bt].mid===It.sdpMid){Mt=bt;break}}var Bt=At.transceivers[Mt];if(!Bt)return kt(yt("OperationError","Can not add ICE candidate"));if(Bt.rejected)return Nt();var Ht=Object.keys(It.candidate).length>0?pt.parseCandidate(It.candidate):{};if(Ht.protocol==="tcp"&&(Ht.port===0||Ht.port===9)||Ht.component&&Ht.component!==1)return Nt();if((Mt===0||Mt>0&&Bt.iceTransport!==At.transceivers[0].iceTransport)&&!ct(Bt.iceTransport,Ht))return kt(yt("OperationError","Can not add ICE candidate"));var Wt=It.candidate.trim();Wt.indexOf("a=")===0&&(Wt=Wt.substr(2)),(xt=pt.getMediaSections(At._remoteDescription.sdp))[Mt]+="a="+(Ht.type?Wt:"end-of-candidates")+`\r
`,At._remoteDescription.sdp=pt.getDescription(At._remoteDescription.sdp)+xt.join("")}else for(var nn=0;nn<At.transceivers.length&&(At.transceivers[nn].rejected||(At.transceivers[nn].iceTransport.addRemoteCandidate({}),xt=pt.getMediaSections(At._remoteDescription.sdp),xt[nn]+=`a=end-of-candidates\r
`,At._remoteDescription.sdp=pt.getDescription(At._remoteDescription.sdp)+xt.join(""),!At.usingBundle));nn++);Nt()})},mt.prototype.getStats=function(It){if(It&&It instanceof gt.MediaStreamTrack){var xt=null;if(this.transceivers.forEach(function(Nt){Nt.rtpSender&&Nt.rtpSender.track===It?xt=Nt.rtpSender:Nt.rtpReceiver&&Nt.rtpReceiver.track===It&&(xt=Nt.rtpReceiver)}),!xt)throw yt("InvalidAccessError","Invalid selector.");return xt.getStats()}var At=[];return this.transceivers.forEach(function(Nt){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(kt){Nt[kt]&&At.push(Nt[kt].getStats())})}),Promise.all(At).then(function(Nt){var kt=new Map;return Nt.forEach(function(Mt){Mt.forEach(function(bt){kt.set(bt.id,bt)})}),kt})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(It){var xt=gt[It];if(xt&&xt.prototype&&xt.prototype.getStats){var At=xt.prototype.getStats;xt.prototype.getStats=function(){return At.apply(this).then(function(Nt){var kt=new Map;return Object.keys(Nt).forEach(function(Mt){Nt[Mt].type=it(Nt[Mt]),kt.set(Mt,Nt[Mt])}),kt})}}});var St=["createOffer","createAnswer"];return St.forEach(function(It){var xt=mt.prototype[It];mt.prototype[It]=function(){var At=arguments;return typeof At[0]=="function"||typeof At[1]=="function"?xt.apply(this,[arguments[2]]).then(function(Nt){typeof At[0]=="function"&&At[0].apply(null,[Nt])},function(Nt){typeof At[1]=="function"&&At[1].apply(null,[Nt])}):xt.apply(this,arguments)}}),(St=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(It){var xt=mt.prototype[It];mt.prototype[It]=function(){var At=arguments;return typeof At[1]=="function"||typeof At[2]=="function"?xt.apply(this,arguments).then(function(){typeof At[1]=="function"&&At[1].apply(null)},function(Nt){typeof At[2]=="function"&&At[2].apply(null,[Nt])}):xt.apply(this,arguments)}}),["getStats"].forEach(function(It){var xt=mt.prototype[It];mt.prototype[It]=function(){var At=arguments;return typeof At[1]=="function"?xt.apply(this,arguments).then(function(){typeof At[1]=="function"&&At[1].apply(null)}):xt.apply(this,arguments)}}),mt}},{sdp:17}],17:[function(et,rt,lt){var it={};it.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},it.localCName=it.generateIdentifier(),it.splitLines=function(ut){return ut.trim().split(`
`).map(function(s){return s.trim()})},it.splitSections=function(ut){return ut.split(`
m=`).map(function(s,tt){return(tt>0?"m="+s:s).trim()+`\r
`})},it.getDescription=function(ut){var s=it.splitSections(ut);return s&&s[0]},it.getMediaSections=function(ut){var s=it.splitSections(ut);return s.shift(),s},it.matchPrefix=function(ut,s){return it.splitLines(ut).filter(function(tt){return tt.indexOf(s)===0})},it.parseCandidate=function(ut){for(var s,tt={foundation:(s=ut.indexOf("a=candidate:")===0?ut.substring(12).split(" "):ut.substring(10).split(" "))[0],component:parseInt(s[1],10),protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]},ot=8;ot<s.length;ot+=2)switch(s[ot]){case"raddr":tt.relatedAddress=s[ot+1];break;case"rport":tt.relatedPort=parseInt(s[ot+1],10);break;case"tcptype":tt.tcpType=s[ot+1];break;case"ufrag":tt.ufrag=s[ot+1],tt.usernameFragment=s[ot+1];break;default:tt[s[ot]]=s[ot+1]}return tt},it.writeCandidate=function(ut){var s=[];s.push(ut.foundation),s.push(ut.component),s.push(ut.protocol.toUpperCase()),s.push(ut.priority),s.push(ut.address||ut.ip),s.push(ut.port);var tt=ut.type;return s.push("typ"),s.push(tt),tt!=="host"&&ut.relatedAddress&&ut.relatedPort&&(s.push("raddr"),s.push(ut.relatedAddress),s.push("rport"),s.push(ut.relatedPort)),ut.tcpType&&ut.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(ut.tcpType)),(ut.usernameFragment||ut.ufrag)&&(s.push("ufrag"),s.push(ut.usernameFragment||ut.ufrag)),"candidate:"+s.join(" ")},it.parseIceOptions=function(ut){return ut.substr(14).split(" ")},it.parseRtpMap=function(ut){var s=ut.substr(9).split(" "),tt={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),tt.name=s[0],tt.clockRate=parseInt(s[1],10),tt.channels=s.length===3?parseInt(s[2],10):1,tt.numChannels=tt.channels,tt},it.writeRtpMap=function(ut){var s=ut.payloadType;ut.preferredPayloadType!==void 0&&(s=ut.preferredPayloadType);var tt=ut.channels||ut.numChannels||1;return"a=rtpmap:"+s+" "+ut.name+"/"+ut.clockRate+(tt!==1?"/"+tt:"")+`\r
`},it.parseExtmap=function(ut){var s=ut.substr(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1]}},it.writeExtmap=function(ut){return"a=extmap:"+(ut.id||ut.preferredId)+(ut.direction&&ut.direction!=="sendrecv"?"/"+ut.direction:"")+" "+ut.uri+`\r
`},it.parseFmtp=function(ut){for(var s,tt={},ot=ut.substr(ut.indexOf(" ")+1).split(";"),ct=0;ct<ot.length;ct++)tt[(s=ot[ct].trim().split("="))[0].trim()]=s[1];return tt},it.writeFmtp=function(ut){var s="",tt=ut.payloadType;if(ut.preferredPayloadType!==void 0&&(tt=ut.preferredPayloadType),ut.parameters&&Object.keys(ut.parameters).length){var ot=[];Object.keys(ut.parameters).forEach(function(ct){ut.parameters[ct]?ot.push(ct+"="+ut.parameters[ct]):ot.push(ct)}),s+="a=fmtp:"+tt+" "+ot.join(";")+`\r
`}return s},it.parseRtcpFb=function(ut){var s=ut.substr(ut.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},it.writeRtcpFb=function(ut){var s="",tt=ut.payloadType;return ut.preferredPayloadType!==void 0&&(tt=ut.preferredPayloadType),ut.rtcpFeedback&&ut.rtcpFeedback.length&&ut.rtcpFeedback.forEach(function(ot){s+="a=rtcp-fb:"+tt+" "+ot.type+(ot.parameter&&ot.parameter.length?" "+ot.parameter:"")+`\r
`}),s},it.parseSsrcMedia=function(ut){var s=ut.indexOf(" "),tt={ssrc:parseInt(ut.substr(7,s-7),10)},ot=ut.indexOf(":",s);return ot>-1?(tt.attribute=ut.substr(s+1,ot-s-1),tt.value=ut.substr(ot+1)):tt.attribute=ut.substr(s+1),tt},it.parseSsrcGroup=function(ut){var s=ut.substr(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(function(tt){return parseInt(tt,10)})}},it.getMid=function(ut){var s=it.matchPrefix(ut,"a=mid:")[0];if(s)return s.substr(6)},it.parseFingerprint=function(ut){var s=ut.substr(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1]}},it.getDtlsParameters=function(ut,s){return{role:"auto",fingerprints:it.matchPrefix(ut+s,"a=fingerprint:").map(it.parseFingerprint)}},it.writeDtlsParameters=function(ut,s){var tt="a=setup:"+s+`\r
`;return ut.fingerprints.forEach(function(ot){tt+="a=fingerprint:"+ot.algorithm+" "+ot.value+`\r
`}),tt},it.getIceParameters=function(ut,s){var tt=it.splitLines(ut);return{usernameFragment:(tt=tt.concat(it.splitLines(s))).filter(function(ot){return ot.indexOf("a=ice-ufrag:")===0})[0].substr(12),password:tt.filter(function(ot){return ot.indexOf("a=ice-pwd:")===0})[0].substr(10)}},it.writeIceParameters=function(ut){return"a=ice-ufrag:"+ut.usernameFragment+`\r
a=ice-pwd:`+ut.password+`\r
`},it.parseRtpParameters=function(ut){for(var s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},tt=it.splitLines(ut)[0].split(" "),ot=3;ot<tt.length;ot++){var ct=tt[ot],yt=it.matchPrefix(ut,"a=rtpmap:"+ct+" ")[0];if(yt){var pt=it.parseRtpMap(yt),gt=it.matchPrefix(ut,"a=fmtp:"+ct+" ");switch(pt.parameters=gt.length?it.parseFmtp(gt[0]):{},pt.rtcpFeedback=it.matchPrefix(ut,"a=rtcp-fb:"+ct+" ").map(it.parseRtcpFb),s.codecs.push(pt),pt.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(pt.name.toUpperCase())}}}return it.matchPrefix(ut,"a=extmap:").forEach(function(st){s.headerExtensions.push(it.parseExtmap(st))}),s},it.writeRtpDescription=function(ut,s){var tt="";tt+="m="+ut+" ",tt+=s.codecs.length>0?"9":"0",tt+=" UDP/TLS/RTP/SAVPF ",tt+=s.codecs.map(function(ct){return ct.preferredPayloadType!==void 0?ct.preferredPayloadType:ct.payloadType}).join(" ")+`\r
`,tt+=`c=IN IP4 0.0.0.0\r
`,tt+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(function(ct){tt+=it.writeRtpMap(ct),tt+=it.writeFmtp(ct),tt+=it.writeRtcpFb(ct)});var ot=0;return s.codecs.forEach(function(ct){ct.maxptime>ot&&(ot=ct.maxptime)}),ot>0&&(tt+="a=maxptime:"+ot+`\r
`),tt+=`a=rtcp-mux\r
`,s.headerExtensions&&s.headerExtensions.forEach(function(ct){tt+=it.writeExtmap(ct)}),tt},it.parseRtpEncodingParameters=function(ut){var s,tt=[],ot=it.parseRtpParameters(ut),ct=ot.fecMechanisms.indexOf("RED")!==-1,yt=ot.fecMechanisms.indexOf("ULPFEC")!==-1,pt=it.matchPrefix(ut,"a=ssrc:").map(function(at){return it.parseSsrcMedia(at)}).filter(function(at){return at.attribute==="cname"}),gt=pt.length>0&&pt[0].ssrc,st=it.matchPrefix(ut,"a=ssrc-group:FID").map(function(at){return at.substr(17).split(" ").map(function(ht){return parseInt(ht,10)})});st.length>0&&st[0].length>1&&st[0][0]===gt&&(s=st[0][1]),ot.codecs.forEach(function(at){if(at.name.toUpperCase()==="RTX"&&at.parameters.apt){var ht={ssrc:gt,codecPayloadType:parseInt(at.parameters.apt,10)};gt&&s&&(ht.rtx={ssrc:s}),tt.push(ht),ct&&((ht=JSON.parse(JSON.stringify(ht))).fec={ssrc:gt,mechanism:yt?"red+ulpfec":"red"},tt.push(ht))}}),tt.length===0&&gt&&tt.push({ssrc:gt});var ft=it.matchPrefix(ut,"b=");return ft.length&&(ft=ft[0].indexOf("b=TIAS:")===0?parseInt(ft[0].substr(7),10):ft[0].indexOf("b=AS:")===0?1e3*parseInt(ft[0].substr(5),10)*.95-16e3:void 0,tt.forEach(function(at){at.maxBitrate=ft})),tt},it.parseRtcpParameters=function(ut){var s={},tt=it.matchPrefix(ut,"a=ssrc:").map(function(yt){return it.parseSsrcMedia(yt)}).filter(function(yt){return yt.attribute==="cname"})[0];tt&&(s.cname=tt.value,s.ssrc=tt.ssrc);var ot=it.matchPrefix(ut,"a=rtcp-rsize");s.reducedSize=ot.length>0,s.compound=ot.length===0;var ct=it.matchPrefix(ut,"a=rtcp-mux");return s.mux=ct.length>0,s},it.parseMsid=function(ut){var s,tt=it.matchPrefix(ut,"a=msid:");if(tt.length===1)return s=tt[0].substr(7).split(" "),{stream:s[0],track:s[1]};var ot=it.matchPrefix(ut,"a=ssrc:").map(function(ct){return it.parseSsrcMedia(ct)}).filter(function(ct){return ct.attribute==="msid"});return ot.length>0?(s=ot[0].value.split(" "),{stream:s[0],track:s[1]}):void 0},it.generateSessionId=function(){return Math.random().toString().substr(2,21)},it.writeSessionBoilerplate=function(ut,s,tt){var ot,ct=s!==void 0?s:2;return ot=ut||it.generateSessionId(),`v=0\r
o=`+(tt||"thisisadapterortc")+" "+ot+" "+ct+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},it.writeMediaSection=function(ut,s,tt,ot){var ct=it.writeRtpDescription(ut.kind,s);if(ct+=it.writeIceParameters(ut.iceGatherer.getLocalParameters()),ct+=it.writeDtlsParameters(ut.dtlsTransport.getLocalParameters(),tt==="offer"?"actpass":"active"),ct+="a=mid:"+ut.mid+`\r
`,ut.direction?ct+="a="+ut.direction+`\r
`:ut.rtpSender&&ut.rtpReceiver?ct+=`a=sendrecv\r
`:ut.rtpSender?ct+=`a=sendonly\r
`:ut.rtpReceiver?ct+=`a=recvonly\r
`:ct+=`a=inactive\r
`,ut.rtpSender){var yt="msid:"+ot.id+" "+ut.rtpSender.track.id+`\r
`;ct+="a="+yt,ct+="a=ssrc:"+ut.sendEncodingParameters[0].ssrc+" "+yt,ut.sendEncodingParameters[0].rtx&&(ct+="a=ssrc:"+ut.sendEncodingParameters[0].rtx.ssrc+" "+yt,ct+="a=ssrc-group:FID "+ut.sendEncodingParameters[0].ssrc+" "+ut.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return ct+="a=ssrc:"+ut.sendEncodingParameters[0].ssrc+" cname:"+it.localCName+`\r
`,ut.rtpSender&&ut.sendEncodingParameters[0].rtx&&(ct+="a=ssrc:"+ut.sendEncodingParameters[0].rtx.ssrc+" cname:"+it.localCName+`\r
`),ct},it.getDirection=function(ut,s){for(var tt=it.splitLines(ut),ot=0;ot<tt.length;ot++)switch(tt[ot]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return tt[ot].substr(2)}return s?it.getDirection(s):"sendrecv"},it.getKind=function(ut){return it.splitLines(ut)[0].split(" ")[0].substr(2)},it.isRejected=function(ut){return ut.split(" ",2)[1]==="0"},it.parseMLine=function(ut){var s=it.splitLines(ut)[0].substr(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},it.parseOLine=function(ut){var s=it.matchPrefix(ut,"o=")[0].substr(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},it.isValidSDP=function(ut){if(typeof ut!="string"||ut.length===0)return!1;for(var s=it.splitLines(ut),tt=0;tt<s.length;tt++)if(s[tt].length<2||s[tt].charAt(1)!=="=")return!1;return!0},typeof rt=="object"&&(rt.exports=it)},{}]},{},[1])(1)}),function(et){function rt(Mt){if(typeof Mt!="string"&&(Mt=String(Mt)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(Mt))throw new TypeError("Invalid character in header field name");return Mt.toLowerCase()}function lt(Mt){return typeof Mt!="string"&&(Mt=String(Mt)),Mt}function it(Mt){var bt={next:function(){var Bt=Mt.shift();return{done:Bt===void 0,value:Bt}}};return St.iterable&&(bt[Symbol.iterator]=function(){return bt}),bt}function ut(Mt){this.map={},Mt instanceof ut?Mt.forEach(function(bt,Bt){this.append(Bt,bt)},this):Array.isArray(Mt)?Mt.forEach(function(bt){this.append(bt[0],bt[1])},this):Mt&&Object.getOwnPropertyNames(Mt).forEach(function(bt){this.append(bt,Mt[bt])},this)}function s(Mt){if(Mt.bodyUsed)return Promise.reject(new TypeError("Already read"));Mt.bodyUsed=!0}function tt(Mt){return new Promise(function(bt,Bt){Mt.onload=function(){bt(Mt.result)},Mt.onerror=function(){Bt(Mt.error)}})}function ot(Mt){var bt=new FileReader,Bt=tt(bt);return bt.readAsArrayBuffer(Mt),Bt}function ct(Mt){var bt=new FileReader,Bt=tt(bt);return bt.readAsText(Mt),Bt}function yt(Mt){for(var bt=new Uint8Array(Mt),Bt=new Array(bt.length),Ht=0;Ht<bt.length;Ht++)Bt[Ht]=String.fromCharCode(bt[Ht]);return Bt.join("")}function pt(Mt){if(Mt.slice)return Mt.slice(0);var bt=new Uint8Array(Mt.byteLength);return bt.set(new Uint8Array(Mt)),bt.buffer}function gt(){return this.bodyUsed=!1,this._initBody=function(Mt){if(this._bodyInit=Mt,Mt)if(typeof Mt=="string")this._bodyText=Mt;else if(St.blob&&Blob.prototype.isPrototypeOf(Mt))this._bodyBlob=Mt;else if(St.formData&&FormData.prototype.isPrototypeOf(Mt))this._bodyFormData=Mt;else if(St.searchParams&&URLSearchParams.prototype.isPrototypeOf(Mt))this._bodyText=Mt.toString();else if(St.arrayBuffer&&St.blob&&xt(Mt))this._bodyArrayBuffer=pt(Mt.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!St.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(Mt)&&!At(Mt))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=pt(Mt)}else this._bodyText="";this.headers.get("content-type")||(typeof Mt=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):St.searchParams&&URLSearchParams.prototype.isPrototypeOf(Mt)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},St.blob&&(this.blob=function(){var Mt=s(this);if(Mt)return Mt;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?s(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ot)}),this.text=function(){var Mt=s(this);if(Mt)return Mt;if(this._bodyBlob)return ct(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(yt(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},St.formData&&(this.formData=function(){return this.text().then(at)}),this.json=function(){return this.text().then(JSON.parse)},this}function st(Mt){var bt=Mt.toUpperCase();return Nt.indexOf(bt)>-1?bt:Mt}function ft(Mt,bt){var Bt=(bt=bt||{}).body;if(Mt instanceof ft){if(Mt.bodyUsed)throw new TypeError("Already read");this.url=Mt.url,this.credentials=Mt.credentials,bt.headers||(this.headers=new ut(Mt.headers)),this.method=Mt.method,this.mode=Mt.mode,Bt||Mt._bodyInit==null||(Bt=Mt._bodyInit,Mt.bodyUsed=!0)}else this.url=String(Mt);if(this.credentials=bt.credentials||this.credentials||"omit",!bt.headers&&this.headers||(this.headers=new ut(bt.headers)),this.method=st(bt.method||this.method||"GET"),this.mode=bt.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Bt)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Bt)}function at(Mt){var bt=new FormData;return Mt.trim().split("&").forEach(function(Bt){if(Bt){var Ht=Bt.split("="),Wt=Ht.shift().replace(/\+/g," "),nn=Ht.join("=").replace(/\+/g," ");bt.append(decodeURIComponent(Wt),decodeURIComponent(nn))}}),bt}function ht(Mt){var bt=new ut;return Mt.split(/\r?\n/).forEach(function(Bt){var Ht=Bt.split(":"),Wt=Ht.shift().trim();if(Wt){var nn=Ht.join(":").trim();bt.append(Wt,nn)}}),bt}function mt(Mt,bt){bt||(bt={}),this.type="default",this.status="status"in bt?bt.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in bt?bt.statusText:"OK",this.headers=new ut(bt.headers),this.url=bt.url||"",this._initBody(Mt)}if(!et.fetch){var St={searchParams:"URLSearchParams"in et,iterable:"Symbol"in et&&"iterator"in Symbol,blob:"FileReader"in et&&"Blob"in et&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in et,arrayBuffer:"ArrayBuffer"in et};if(St.arrayBuffer)var It=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],xt=function(Mt){return Mt&&DataView.prototype.isPrototypeOf(Mt)},At=ArrayBuffer.isView||function(Mt){return Mt&&It.indexOf(Object.prototype.toString.call(Mt))>-1};ut.prototype.append=function(Mt,bt){Mt=rt(Mt),bt=lt(bt);var Bt=this.map[Mt];this.map[Mt]=Bt?Bt+","+bt:bt},ut.prototype.delete=function(Mt){delete this.map[rt(Mt)]},ut.prototype.get=function(Mt){return Mt=rt(Mt),this.has(Mt)?this.map[Mt]:null},ut.prototype.has=function(Mt){return this.map.hasOwnProperty(rt(Mt))},ut.prototype.set=function(Mt,bt){this.map[rt(Mt)]=lt(bt)},ut.prototype.forEach=function(Mt,bt){for(var Bt in this.map)this.map.hasOwnProperty(Bt)&&Mt.call(bt,this.map[Bt],Bt,this)},ut.prototype.keys=function(){var Mt=[];return this.forEach(function(bt,Bt){Mt.push(Bt)}),it(Mt)},ut.prototype.values=function(){var Mt=[];return this.forEach(function(bt){Mt.push(bt)}),it(Mt)},ut.prototype.entries=function(){var Mt=[];return this.forEach(function(bt,Bt){Mt.push([Bt,bt])}),it(Mt)},St.iterable&&(ut.prototype[Symbol.iterator]=ut.prototype.entries);var Nt=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];ft.prototype.clone=function(){return new ft(this,{body:this._bodyInit})},gt.call(ft.prototype),gt.call(mt.prototype),mt.prototype.clone=function(){return new mt(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new ut(this.headers),url:this.url})},mt.error=function(){var Mt=new mt(null,{status:0,statusText:""});return Mt.type="error",Mt};var kt=[301,302,303,307,308];mt.redirect=function(Mt,bt){if(kt.indexOf(bt)===-1)throw new RangeError("Invalid status code");return new mt(null,{status:bt,headers:{location:Mt}})},et.Headers=ut,et.Request=ft,et.Response=mt,et.fetch=function(Mt,bt){return new Promise(function(Bt,Ht){var Wt=new ft(Mt,bt),nn=new XMLHttpRequest;nn.onload=function(){var gn={status:nn.status,statusText:nn.statusText,headers:ht(nn.getAllResponseHeaders()||"")};gn.url="responseURL"in nn?nn.responseURL:gn.headers.get("X-Request-URL");var tn="response"in nn?nn.response:nn.responseText;Bt(new mt(tn,gn))},nn.onerror=function(){Ht(new TypeError("Network request failed"))},nn.ontimeout=function(){Ht(new TypeError("Network request failed"))},nn.open(Wt.method,Wt.url,!0),Wt.credentials==="include"&&(nn.withCredentials=!0),"responseType"in nn&&St.blob&&(nn.responseType="blob"),Wt.headers.forEach(function(gn,tn){nn.setRequestHeader(tn,gn)}),nn.send(Wt._bodyInit===void 0?null:Wt._bodyInit)})},et.fetch.polyfill=!0}}(typeof self<"u"?self:commonjsGlobal);var _e={};_e=function(){function et(gt,st){var ft,at,ht,mt=[],St=(gt=gt.push?gt:[gt]).length,It=St;for(ft=function(xt,At){At.length&&mt.push(xt),--It||st(mt)};St--;)at=gt[St],(ht=ct[at])?ft(at,ht):(yt[at]=yt[at]||[]).push(ft)}function rt(gt,st){if(gt){var ft=yt[gt];if(ct[gt]=st,ft)for(;ft.length;)ft[0](gt,st),ft.splice(0,1)}}function lt(gt,st){gt.call&&(gt={success:gt}),st.length?(gt.error||tt)(st):(gt.success||tt)(gt)}function it(gt,st,ft,at){var ht,mt,St=document,It=ft.async,xt=(ft.numRetries||0)+1,At=ft.before||tt,Nt=gt.replace(/^(css|img)!/,""),kt=ft.reqdelay||0;at=at||0,/(^css!|\.css$)/.test(gt)?(ht=!0,(mt=St.createElement("link")).rel="stylesheet",mt.href=Nt):/(^img!|\.(png|gif|jpg|svg)$)/.test(gt)?(mt=St.createElement("img")).src=Nt:((mt=St.createElement("script")).src=gt,mt.async=It===void 0||It),mt.onload=mt.onerror=mt.onbeforeload=function(Mt){var bt=Mt.type[0];if(ht&&"hideFocus"in mt)try{mt.sheet.cssText.length||(bt="e")}catch{bt="e"}if(bt=="e"&&(at+=1)<xt)return pt=kt*at,setTimeout(function(){it(gt,st,ft,at)},pt),void(ft.retrycb&&ft.retrycb(at,pt));st(gt,bt,Mt.defaultPrevented)},At(gt,mt)!==!1&&St.head.appendChild(mt)}function ut(gt,st,ft){var at,ht,mt=(gt=gt.push?gt:[gt]).length,St=mt,It=[];for(at=function(xt,At,Nt){if(At=="e"&&It.push(xt),At=="b"){if(!Nt)return;It.push(xt)}--mt||st(It)},ht=0;ht<St;ht++)it(gt[ht],at,ft)}function s(gt,st,ft){var at,ht;st&&st.trim&&(at=st),ut(gt,function(mt){lt(ht,mt),rt(at,mt)},ht=(at?ft:st)||{})}var tt=function(){},ot={},ct={},yt={},pt=0;return s.ready=function(gt,st){return et(gt,function(ft){lt(st,ft)}),s},s.done=function(gt){rt(gt,[])},s.reset=function(){ot={},ct={},yt={}},s.isDefined=function(gt){return gt in ot},s}(),function(et,rt){var lt={};lt.load=function(it,ut,s){if(typeof _e!==void 0&&typeof apiRTC_React>"u"){var tt={async:!0,numRetries:ut.extJsLoadingRetryNb||100,reqdelay:ut.extJsLoadingRetryDelay||200,success:function(){et.rtcio=io,s.success()},error:function(ot){console.error("socket.io loading error"),s.error()},retrycb:function(ot,ct){console.warn("socket.io loading retry :"+ot+" ,delay before retry :"+ct),s.retrycb()}};ut.socketioUrl!==void 0?_e([ut.socketioUrl],"socketio",tt):_e([it+"://"+ut.ccsServer+"/socket.io/v3/socket.io.js"],"socketio",tt)}else console.log("Else loadjs io"),et.rtcio=io,s.success()},et.apiRTC_sioLoader=lt}(window);/*! For license information please see apiRTC-srcTmp.js.LICENSE.txt */(function(et,rt){a.exports=rt()})(self,()=>(()=>{var et={8364:function(it,ut,s){var tt,ot=this&&this.__extends||(tt=function(xt,At){return(tt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(Nt,kt){Nt.__proto__=kt}:function(Nt,kt){for(var Mt in kt)Object.prototype.hasOwnProperty.call(kt,Mt)&&(Nt[Mt]=kt[Mt])}))(xt,At)},function(xt,At){if(typeof At!="function"&&At!==null)throw new TypeError("Class extends value "+String(At)+" is not a constructor or null");function Nt(){this.constructor=xt}tt(xt,At),xt.prototype=At===null?Object.create(At):(Nt.prototype=At.prototype,new Nt)}),ct=(Object.defineProperty(ut,"__esModule",{value:!0}),s(2043)),yt=s(7987),pt=ct.getLogger("CloudAPI"),gt=(yt.reg(ct),yt.apply(pt,{format:function(xt,At,Nt){return"".concat(Nt," - [").concat(xt,"] ").concat(At," : ")}}),pt.setDefaultLevel("error"),pt.setLevel("error"),"https://cloud.apizee.com"),st="/api/v2/media/upload",ft="/api/v2/conversation/{convId}/media",at="/api/v2/conferences",ht={updateWebconfTags:{fetchRetryCount:3,fetchRetryDelay:500}},mt=null,St=function(){function xt(){if(this.cloudUrl=gt,this.JWTApzToken="",this.fetchRetries=100,this.fetchRetryDelay=200,mt!==null)return pt.debug("Cannot construct multiple CloudAPI, this is a singleton."),mt;mt=this}return xt.get=function(){return mt=mt===null?new xt:mt},xt.prototype.setLogLevel=function(At){pt.setLevel(At)},xt.prototype.getLogLevel=function(){var At="";switch(pt.getLevel()){case 0:At="trace";break;case 1:At="debug";break;case 2:At="info";break;case 3:At="warn";break;case 4:At="error";break;case 5:At="silent"}return At},xt.prototype.setCloudURL=function(At){pt.debug("setCloudURL :",At),this.cloudUrl=At},xt.prototype.setJWTApzToken=function(At){this.JWTApzToken=At},xt.prototype.setFetchRetries=function(At){pt.debug("setFetchRetries :",At),At!=null&&(this.fetchRetries=At)},xt.prototype.setFetchRetryDelay=function(At){pt.log("setFetchRetryDelay :",At),At!=null&&(this.fetchRetryDelay=At)},xt.prototype.request=function(At,Nt,kt,Mt,bt,Bt){bt===void 0&&(bt={}),Bt===void 0&&(Bt={});var Ht=At.indexOf(this.cloudUrl)===-1?this.cloudUrl+At:At,Wt=null;return new Promise(function(nn,gn){var tn,Gt=new XMLHttpRequest;if(Bt.hasOwnProperty("withCredentials")&&(Gt.withCredentials=Bt.withCredentials),Gt.onreadystatechange=function(yn){if(Gt.readyState===XMLHttpRequest.DONE)if(pt.debug("request onreadystatechange status :",Gt.status),200<=Gt.status&&Gt.status<300)if(Gt.responseText){var pn=null;try{pn=JSON.parse(Gt.responseText)}catch{pn=Gt.responseText}nn(pn)}else nn("No_responseTest");else{if(pn={status:Gt.status,text:Gt.statusText},Gt.responseText)try{pn.response=JSON.parse(Gt.responseText)}catch{pn.responseText=Gt.responseText}gn(pn)}},Gt.onprogress=function(yn){typeof Mt=="function"&&Mt(yn)},Gt.onerror=function(yn){gn(yn)},kt==="GET")0<Object.keys(Nt).length&&(tn=new URLSearchParams(Nt),pt.debug("johann",tn,tn.toString,Nt),Ht+="?"+tn.toString());else{Wt=new FormData;for(var fn=0,Cn=Object.keys(Nt);fn<Cn.length;fn++){var Tn=Cn[fn];Wt.append(Tn,Nt[Tn])}}if(Gt.open(kt,Ht,!0),bt!=null)for(var dn=0,mn=Object.keys(bt);dn<mn.length;dn++)Tn=mn[dn],Gt.setRequestHeader(Tn,bt[Tn]);Gt.send(Wt)})},xt.prototype.get=function(At,Nt,kt,Mt){return kt===void 0&&(kt={}),Mt===void 0&&(Mt={}),pt.log("Send HTTP request : GET ".concat(At)),this.request(At,Nt,"GET",null,kt,Mt)},xt.prototype.post=function(At,Nt,kt,Mt){return pt.log("Send HTTP request : POST ".concat(At)),this.request(At,Nt,"POST",kt,Mt)},xt.prototype.put=function(At,Nt,kt,Mt){return pt.log("Send HTTP request : PUT ".concat(At)),(Nt=Nt!==null&&typeof Nt=="object"?Nt:{})._method="PUT",this.request(At,Nt,"POST",kt,Mt)},xt.prototype.delete=function(At,Nt,kt){return pt.log("Send HTTP request : DELETE ".concat(At)),(Nt=Nt!==null&&typeof Nt=="object"?Nt:{})._method="DELETE",this.request(At,Nt,"POST",null,kt)},xt.prototype.cloudRequest=function(At,Nt,kt,Mt){var bt=this;return Mt===void 0&&(Mt={}),new Promise(function(Bt,Ht){pt.trace(kt+" cloudRequest to "+mt.cloudUrl,Nt);var Wt={method:kt.toUpperCase()},nn=mt.cloudUrl+At;if(Wt.method==="GET")0<Object.keys(Nt).length&&(nn+="?"+new URLSearchParams(Nt).toString());else{for(var gn=new FormData,tn=0,Gt=Object.keys(Nt);tn<Gt.length;tn++){var fn=Gt[tn];gn.append(fn,Nt[fn])}Wt.body=gn}Mt.hasOwnProperty("bearerToken")?Wt.headers={Authorization:"Bearer "+Mt.bearerToken}:bt.JWTApzToken!==""&&(Wt.headers={Authorization:"Bearer "+bt.JWTApzToken}),Mt.hasOwnProperty("fetchRetryCount")?Wt.retries=Mt.fetchRetryCount:Wt.retries=bt.fetchRetries,Mt.hasOwnProperty("fetchRetryDelay")?Wt.retryDelay=Mt.fetchRetryDelay:Wt.retryDelay=bt.fetchRetryDelay,function(Cn,Tn){pt.log("fetchRetry");var dn=3,mn=1e3,yn=[];if(Tn&&Tn.retries&&(dn=Tn.retries),Tn&&Tn.retryDelay&&(mn=Tn.retryDelay),Tn&&Tn.retryOn){if(!(Tn.retryOn instanceof Array))throw{name:"ArgumentError",message:"retryOn property expects an array"};yn=Tn.retryOn}return new Promise(function(pn,In){function On(Mn){var Nn,wn;pt.log("wrappedFetch n:",Mn),window.fetch!==void 0?fetch(Cn,Tn).then(function(Pn){yn.indexOf(Pn.status)===-1?pn(Pn):0<Mn?_n(Mn):In(Pn)}).catch(function(Pn){0<Mn?_n(Mn):In(Pn)}):(pt.debug("Cannot use fetch in this browser, using XHR"),Nn=St.get(),wn={},Tn.body&&Tn.body.forEach(function(Pn,Fn){return wn[Fn]=Pn}),Nn.request(Cn,wn,Tn.method,null,Tn.headers).then(function(Pn){pn({gettype:"cloudApiNoFetch",response:Pn})}).catch(function(Pn){pt.error("error :",Pn),In(Pn)}))}function _n(Mn){pt.error("retry n:",Mn);var Nn=dn-Mn+1;pt.error("retry number is :",Nn),setTimeout(function(){On(--Mn)},mn*Nn)}On(dn)})}(nn,Wt).then(function(Cn){if(Cn.gettype==="cloudApiNoFetch")return Bt(Cn.response);Cn.json().then(function(Tn){var dn;if(Cn.status<200||299<Cn.status)return dn="cloudRequest - response status Code: "+Cn.status,pt.warn(dn),dn=new It(dn,13,Cn.status,Tn),Ht(dn);Bt(Tn)}).catch(function(Tn){return pt.error("json err :",Tn),Ht(new It("cloudRequest - json() Error: "+Tn.text,0,Cn.status,{}))})}).catch(function(Cn){return pt.error("Fetch Error :",Cn),Ht(new It("cloudRequest - Fetch Error: "+Cn.text,13,Cn.status,Cn.response))})})},xt.prototype.cloudFetchMedia=function(At){var Nt=this;return new Promise(function(kt,Mt){var bt={};Nt.JWTApzToken!==""&&(bt={Authorization:"Bearer "+Nt.JWTApzToken}),fetch(At,{headers:bt}).then(function(Bt){return Bt.blob()}).then(function(Bt){kt(Bt)}).catch(function(Bt){Mt(Bt)})})},xt.prototype.authentication=function(At,Nt,kt){return pt.debug("authentication to "+mt.cloudUrl),At={username:At,password:Nt},kt!==void 0&&kt!==""&&(At.captcha_token=kt),this.cloudRequest("/api/v3/authenticate",At,"POST")},xt.prototype.getConnectedUserInformation=function(At){return pt.debug("getConnectedUserInformation to "+mt.cloudUrl),this.cloudRequest("/api/v2/users/me",{},"GET",{bearerToken:At})},xt.prototype.getUserProfile=function(At,Nt,kt){return pt.debug("getUserProfile to "+mt.cloudUrl),typeof At!="string"||typeof Nt!="string"?Promise.reject("wrongArguments"):(At={apiKey:At},this.cloudRequest("/api/v3/users/{userId}/profile".replace("{userId}",Nt),At,"GET",{bearerToken:kt}))},xt.prototype.getSiteAgents=function(At,Nt,kt){return kt===void 0&&(kt={}),pt.debug("getSiteAgents to "+mt.cloudUrl),typeof At!="string"||typeof Nt!="string"?Promise.reject("wrongArguments"):(At={apiKey:At},kt.useAcd&&(At.useAcd=1),kt.usePresence&&(At.usePresence=1),kt.convId&&(At.convId=kt.convId),this.cloudRequest("/api/v2/sites/{siteKey}/agents".replace("{siteKey}",Nt),At,"GET"))},xt.prototype.getEnterpriseInformation=function(At,Nt){return At===void 0&&(At={}),pt.debug("getEnterpriseInformation to "+mt.cloudUrl),this.cloudRequest("/api/v3/enterpriseInformation",At,"GET",{bearerToken:Nt})},xt.prototype.getPreferredCCS=function(At){return pt.debug("getPreferredCCS to "+mt.cloudUrl),this.cloudRequest("/api/v2/preferredCCS",{apiKey:At},"GET")},xt.prototype.checkUserToken=function(At){return pt.debug("checkUserToken to "+mt.cloudUrl),this.cloudRequest("/api/v2/checkToken",{},"GET",{bearerToken:At})},xt.prototype.invalidateUserToken=function(At){return pt.debug("invalidateUserToken to "+mt.cloudUrl),this.cloudRequest("/api/v2/invalidateToken",{},"POST",{bearerToken:At})},xt.prototype.uploadFile=function(At,Nt,kt){pt.debug("uploadMedia to "+mt.cloudUrl);var Mt={file:At};if(kt!=null)for(var bt=0,Bt=Object.keys(kt);bt<Bt.length;bt++){var Ht=Bt[bt];Mt[Ht]=kt[Ht]}return this.cloudRequest(st,Mt,"POST",{bearerToken:Nt})},xt.prototype.uploadSnapshot=function(At,Nt,kt){kt===void 0&&(kt={}),pt.debug("uploadSnapshot to "+mt.cloudUrl);for(var Mt={dataUri:1,file:At},bt=0,Bt=Object.keys(kt);bt<Bt.length;bt++){var Ht=Bt[bt];Mt[Ht]=kt[Ht]}return this.cloudRequest(st,Mt,"POST",{bearerToken:Nt})},xt.prototype.getEnterpriseUserList=function(At,Nt){return pt.debug("getEnterpriseUserList to "+mt.cloudUrl),this.cloudRequest("/api/v2/enterprises/{enterpriseId}/users".replace("{enterpriseId}",At),{json:!0},"GET",{bearerToken:Nt})},xt.prototype.getEnterpriseTagList=function(At,Nt,kt){return kt===void 0&&(kt={}),pt.debug("getEnterpriseTagList to "+mt.cloudUrl),kt.hasOwnProperty("webconfId")&&kt.webconfId,this.cloudRequest("/api/v2/enterprises/{enterpriseId}/tags".replace("{enterpriseId}",At),{},"GET",{bearerToken:Nt})},xt.prototype.updateWebconfTags=function(At,Nt,kt,Mt){return pt.debug("updateWebconfTags to "+mt.cloudUrl),kt={_method:"PUT",tags:kt.join(",")},function(bt,Bt){if(bt!==null&&typeof bt=="object"||(bt={}),ht.hasOwnProperty(Bt))for(var Ht=ht[Bt],Wt=0,nn=["fetchRetryCount","fetchRetryDelay"];Wt<nn.length;Wt++){var gn=nn[Wt];Ht.hasOwnProperty(gn)&&(bt[gn]=Ht[gn])}}(Mt={bearerToken:Mt},"updateWebconfTags"),this.cloudRequest("/api/enterprises/{enterpriseId}/conferences/{conferenceId}".replace("{enterpriseId}",At).replace("{conferenceId}",Nt),kt,"POST",Mt)},xt.prototype.getConferenceList=function(At){return pt.debug("getConferenceList to "+mt.cloudUrl),this.cloudRequest(at,{},"GET",{bearerToken:At})},xt.prototype.getOrCreateConversation=function(At,Nt,kt){return kt===void 0&&(kt={}),pt.debug("getOrCreateConversation to "+mt.cloudUrl),At===null||typeof At!="object"||typeof Nt!="string"?Promise.reject("wrongArguments"):(At={name:At._getTechnicalName(),type:At.getType(),apiKey:Nt},Nt={},kt.hasOwnProperty("token")&&kt.token&&(Nt.bearerToken=kt.token),kt.hasOwnProperty("active")&&typeof kt.active=="boolean"&&(At.active=1),this.cloudRequest("/api/v2/conversation",At,"POST",Nt))},xt.prototype.createConference=function(At,Nt,kt){return kt===void 0&&(kt={}),pt.debug("createConference to "+mt.cloudUrl),Nt={name:Nt},kt.hasOwnProperty("password")&&(Nt.password=kt.password),this.cloudRequest(at,Nt,"POST",{bearerToken:At})},xt.prototype.checkConferenceAccess=function(At,Nt,kt){var Mt;return kt===void 0&&(kt={}),pt.debug("checkConferenceAccess for "+At+" to "+mt.cloudUrl),typeof Nt!="string"?Promise.reject("wrongArguments"):(Nt={apiKey:Nt},kt.convId&&(Nt.conv_id=kt.convId),kt.hasOwnProperty("password")&&(Nt.password=kt.password),Mt={},kt.hasOwnProperty("session")&&typeof kt.session.getToken=="function"&&kt.session.getToken()!==null&&(Mt.bearerToken=kt.session.getToken()),this.cloudRequest("/api/v2/conferences/{roomname}/checkAccess".replace("{roomname}",At),Nt,"POST",Mt))},xt.prototype.getWebconf=function(At,Nt){Nt===void 0&&(Nt={}),pt.debug("getWebconf for "+At+" to "+mt.cloudUrl);var kt={};return Nt.hasOwnProperty("token")&&Nt.token&&(kt.bearerToken=Nt.token),this.cloudRequest("/api/v2/conferences/{roomname}".replace("{roomname}",At),{},"GET",kt)},xt.prototype.getWebconfConversation=function(At,Nt,kt){var Mt;return kt===void 0&&(kt={}),pt.debug("getWebconfConversation for "+At+" to "+mt.cloudUrl),typeof Nt!="string"?Promise.reject("wrongArguments"):(Nt={apiKey:Nt},Mt={},kt.hasOwnProperty("token")&&kt.token&&(Mt.bearerToken=kt.token),this.cloudRequest("/api/v2/conferences/{roomname}/conversation".replace("{roomname}",At),Nt,"GET",Mt))},xt.prototype.updateConferencePresence=function(At,Nt,kt){pt.trace("updateConferencePresence for "+At.getName()+" to "+mt.cloudUrl),kt={ccid:Nt.getId(),name:Nt.getUserAgent().getUsername(),instanceId:At.getInstanceId(),apiKey:kt};var Mt={};return Nt.getToken()!==null&&(Mt.bearerToken=Nt.getToken()),this.cloudRequest("/api/v2/conferences/{roomname}/updatePresence".replace("{roomname}",At._getTechnicalName()),kt,"POST",Mt)},xt.prototype.closeConferenceInstance=function(At,Nt){pt.debug("closeConferenceInstance for "+At.getName()+" to "+mt.cloudUrl);var kt={instanceId:At.getInstanceId()};return this.cloudRequest("/api/v2/conferences/{roomname}/closeInstance".replace("{roomname}",At._getTechnicalName()),kt,"POST",{bearerToken:Nt.getToken()})},xt.prototype.getConversationMediaList=function(At,Nt,kt){var Mt;return kt===void 0&&(kt={}),pt.debug("getConversationMediaList for "+At+" to "+mt.cloudUrl),At&&typeof Nt=="string"?(Nt={apiKey:Nt},Mt={},kt.hasOwnProperty("token")&&kt.token&&(Mt.bearerToken=kt.token),kt.hasOwnProperty("offset")&&(Nt.offset=kt.offset),kt.hasOwnProperty("limit")&&(Nt.limit=kt.limit),this.cloudRequest(ft.replace("{convId}",At.toString()),Nt,"GET",Mt)):Promise.reject("wrongArguments")},xt.prototype.pushConversationMedia=function(At,Nt,kt,Mt){return Mt===void 0&&(Mt={}),pt.debug("pushConversationMedia for "+At+" to "+mt.cloudUrl),At&&Nt&&typeof kt=="string"?(Nt={media:Nt,apiKey:kt},kt={},Mt.hasOwnProperty("token")&&Mt.token&&(kt.bearerToken=Mt.token),Mt.hasOwnProperty("metadata")&&Mt.metadata&&(Nt.metadata=Mt.metadata),Mt.hasOwnProperty("asFile")&&Mt.asFile&&(Nt.asFile=Mt.asFile),Mt.hasOwnProperty("filename")&&Mt.filename&&(Nt.filename=Mt.filename),Mt.overwrite===!0&&(Nt.overwrite=1),typeof Mt.ttl=="number"&&0<Mt.ttl&&(Nt.ttl=Mt.ttl),this.cloudRequest(ft.replace("{convId}",At.toString()),Nt,"POST",kt)):Promise.reject("wrongArguments")},xt.prototype.setConversationData=function(At,Nt,kt,Mt){return Mt===void 0&&(Mt={}),pt.debug("setConversationData for "+At+" to "+mt.cloudUrl),At&&typeof Nt=="string"&&typeof kt=="string"?(Nt={data:Nt,apiKey:kt},kt={},Mt.hasOwnProperty("token")&&Mt.token&&(kt.bearerToken=Mt.token),this.cloudRequest("/api/v2/conversation/{convId}/data".replace("{convId}",At.toString()),Nt,"POST",kt)):Promise.reject("wrongArguments")},xt.prototype.getSessionHistory=function(At,Nt,kt){kt===void 0&&(kt={}),pt.debug("getSessionHistory to "+mt.cloudUrl);var Mt={sessionId:At};if(kt!=null)for(var bt=0,Bt=Object.keys(kt);bt<Bt.length;bt++){var Ht=Bt[bt];Mt[Ht]=kt[Ht]}return this.cloudRequest("/api/v2/messages",Mt,"GET",{bearerToken:Nt})},xt.prototype.getWebSession=function(At,Nt,kt){return pt.debug("getSessionHistory to "+mt.cloudUrl),typeof kt!="string"?Promise.reject("wrongArguments"):(Nt={destId:Nt.getId(),apiKey:kt},kt={},At.getToken()!==null?kt.bearerToken=At.getToken():Nt.userId=At.getId(),this.cloudRequest("/api/v2/webSession",Nt,"GET",kt))},xt.prototype.saveNewMessage=function(At,Nt,kt,Mt,bt,Bt){return pt.debug("saveNewMessage to "+mt.cloudUrl),bt={uuid:bt,destId:kt,message:Mt,sessionId:At,userId:Nt.getId(),apiKey:Bt},kt={},Nt.getToken()!==null&&(kt.bearerToken=Nt.getToken()),this.cloudRequest("/api/v2/messages",bt,"POST",kt)},xt.prototype.saveGroupChatMessage=function(At,Nt,kt,Mt,bt,Bt){return Bt===void 0&&(Bt={}),pt.debug("saveGroupChatMessage to "+mt.cloudUrl),kt={apiKey:kt,message:Mt,ccid:Nt.getId(),name:Nt.getUserAgent().getUsername(),parent_conv_id:At.getCloudConversationId(),uuid:bt,htmlEnable:Bt.metadata&&Bt.metadata.htmlEnable||!1},Mt={},Bt.token!==void 0&&Bt.token!==null?Mt.bearerToken=Bt.token:Nt.getToken()!==null?Mt.bearerToken=Nt.getToken():kt.userId=Nt.getId(),this.cloudRequest("/api/v2/groupChatMessages",kt,"POST",Mt)},xt.prototype.loadGroupChatMessages=function(At,Nt,kt){kt===void 0&&(kt=""),pt.debug("loadGroupChatMessages to "+mt.cloudUrl),At={parent_conv_id:At.getCloudConversationId()};var Mt={};return Mt.bearerToken=kt!==""?kt:Nt.getToken(),this.cloudRequest("/api/v2/groupChatMessages",At,"GET",Mt)},xt}(),It=(ut.default=St,function(xt){function At(Nt,kt,Mt,bt){return(Nt=xt.call(this,Nt)||this).name=Nt.constructor.name,Nt.code=kt,Nt.httpCode=Mt,Nt.cloudResponse=bt,Nt}return ot(At,xt),At}(Error))},128:(it,ut,s)=>{s.d(ut,{_:()=>ct}),s(2564);var tt=s(1549).Y.get("ApiCCDataClient"),ot=apiCC.myWebRTC_Event,ct=function(yt){this.sendData=function(pt,gt,st){tt.info("Call sending data function .... to :"+pt+" message :",gt);var ft,at,ht=yt.channel.getNewCSeq(),mt=null;return ft={type:"dataMessage",senderId:yt.apiCCId,dstRoomId:pt,data:gt,cSeq:ht},at=JSON.stringify(ft),tt.log("C->S: "+at),st!==void 0?(tt.log("Ack management activated"),mt=setTimeout(function(){st({reason:"timeoutReached",cSeq:ht}),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[ht]},yt.messageTimeOutTimer),tt.log("timeOutId: "+mt),yt.messageTimeOutTable[ht]=mt,yt.channel.socket.emit("dataMessage",at,function(St){tt.log("callback on dataMessage"),tt.log("callback reason :"+St.reason),tt.log("cSeq :"+St.cSeq),st(St),apiCC.session.messageTimeOutTable[ht]!==void 0?(tt.log("clearing timeOutId: "+apiCC.session.messageTimeOutTable[ht]),clearTimeout(apiCC.session.messageTimeOutTable[ht]),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[ht]):tt.warn("messageTimeOutTable was already deleted : timeout may have been reached before Ack")})):(tt.log("Ack management not activated"),yt.channel.socket.emit("dataMessage",at)),ht},this.sendDataToGroup=function(pt,gt){tt.info("[ApiCCDataClient] sendDataToGroup - "+pt);var st,ft=yt.getConnectedUsersList(pt);for(st=0;st<ft.length;st++)yt.apiCCId!=ft[st].userId&&this.sendData(ft[st].userId,gt)},this.receiveData=function(pt){tt.info("receiveData :"+pt.data),ot.createReceiveDataEvent(pt.senderId,pt.dstRoomId,pt.data)}}},6844:(it,ut,s)=>{s.d(ut,{U:()=>gt}),s(9554),s(1539),s(4747),s(2564),s(2526),s(1817),s(2165),s(6992),s(8783),s(3948);var tt=s(1549),ot=s(4708),ct=s(940);function yt(st){return yt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ft){return typeof ft}:function(ft){return ft&&typeof Symbol=="function"&&ft.constructor===Symbol&&ft!==Symbol.prototype?"symbol":typeof ft},yt(st)}var pt=tt.Y.get("ApiCCIMClient"),gt=function(st,ft){this.convTable=[],this.myWebRTC_Event=apiCC.myWebRTC_Event,this.nickname=st.nickname,this.photoURL=null,this.userDataSetted=!1,this.myWebRTC_Stack=new ct.S(st.channel.socket),this.findIMIdWithDestID=function(at){var ht,mt=this.convTable.length;for(pt.log("findIMIdWithDestID = "+at),ht=0;ht<mt;ht+=1)if(pt.log("this.convTable[i].dest_roomId = "+this.convTable[ht].dest_roomId),this.convTable[ht].dest_roomId==at)return this.convTable[ht].IMId;return pt.log("Conversation IMId not found"),0},this.addInConvTable=function(at){pt.debug("addInConvTable");var ht,mt=this.convTable.length;for(ht=0;ht<mt;ht+=1)if(pt.log("this.convTable[i].dest_roomId = "+this.convTable[ht].dest_roomId),this.convTable[ht].dest_roomId==at.dest_roomId)return void(this.convTable[ht].IMId=at.IMId);pt.log("Conversation not found in the table, adding .."),this.convTable.push(at)},this.sendMessage=function(at,ht,mt,St){pt.info("Call sending message function .... from :"+this.nickname+" message :"+ht);var It,xt=this.findIMIdWithDestID(at),At=null,Nt=null,kt=null,Mt=st.channel.getNewCSeq();return xt===0?pt.log("Creation of a new IM conversation"):pt.log("Message is for existing conversation with ID : "+xt),pt.log("IMConvId :"+xt),At={type:"IMMessage",IMId:xt,senderId:st.apiCCId,nickname:this.nickname,photoURL:this.photoURL,dstRoomId:at,data:ht,cSeq:Mt,convData:St},st.getConnectedUserIdsList().forEach(function(bt){bt.userId==at&&bt.hasOwnProperty("userData")&&bt.userData!==null&&yt(bt.userData.hasOwnProperty("isChatbot"))&&bt.userData.isChatbot&&(At.pubSub="BotConnector")}),It=JSON.stringify(At),Nt=document.createElement("message"),pt.log("C->S: "+It),mt!==void 0?(pt.log("Ack management activated"),kt=setTimeout(function(){mt({reason:"timeoutReached",cSeq:Mt}),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[Mt]},st.messageTimeOutTimer),pt.log("timeOutId: "+kt),st.messageTimeOutTable[Mt]=kt,st.channel.socket.emit("IMMessage",It,function(bt){pt.log("callback on IMMessage"),pt.log("data :",bt),pt.log("callback reason :"+bt.reason),pt.log("callback convId :"+bt.convId),pt.log("cSeq :"+bt.cSeq),mt(bt),apiCC.session.messageTimeOutTable[Mt]!==void 0?(pt.log("clearing timeOutId: "+apiCC.session.messageTimeOutTable[Mt]),clearTimeout(apiCC.session.messageTimeOutTable[Mt]),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[Mt]):pt.warn("messageTimeOutTable was already deleted : timeout may have been reached before Ack")})):(pt.log("Ack management not activated"),st.channel.socket.emit("IMMessage",It)),this.conversation!==null&&(Nt.innerHTML="<b>me :</b> "+St+"<br>",this.conversation.appendChild(Nt),this.conversation.scrollTop=this.conversation.scrollHeight),Mt},this.newConversationCreated=function(at){pt.debug("newConversationCreated :"+at),pt.log("msg.dstRoomId :"+at.dstRoomId),pt.log("msg.IMId :"+at.IMId);var ht={dest_roomId:at.dstRoomId,IMId:at.IMId};this.addInConvTable(ht)},this.receiveMessage=function(at){pt.info("Call receiveMessage message :"+at);var ht,mt=null;ht={dest_roomId:at.senderId,IMId:at.IMId},this.addInConvTable(ht),this.conversation!==null&&((mt=document.createElement("message")).innerHTML="<b>"+at.nickname+":</b> "+at.data+"<br>",this.conversation.appendChild(mt),this.conversation.scrollTop=this.conversation.scrollHeight),this.myWebRTC_Event.createReceiveIMMessageEvent(at.senderId,at.nickname,at.photoURL,at.data,at.UUCSeq,at.IMId)},this.createGroupChat=function(at,ht){var mt,St;pt.info("createGroupChat with contacts : "+at+","+ht),mt={type:"createGroupChat",nickname:this.nickname,photoURL:this.photoURL,contactId1:at,contactId2:ht},St=JSON.stringify(mt),pt.log("C->S: "+St),st.channel.socket.emit("createGroupChat",St)},this.groupChatCreation=function(at){pt.debug("groupChatCreation"),this.myWebRTC_Event.createGroupChatCreationEvent(at.status,at.groupChatId,at.contactId1,at.invitationSendedToInitialDestId,at.contactId2,at.invitationSendedToNewContactId)},this.joinGroupChat=function(at){var ht=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};pt.debug("joinGroupChat : "+at);var mt=null,St=null;mt={type:"joinGroupChat",groupChatId:at},ht.convId&&(mt.data={},mt.data.cloudConvId=ht.convId),St=JSON.stringify(mt),pt.log("C->S: "+St),st.channel.socket.emit("joinGroupChat",St)},this.groupChatInvitation=function(at){pt.debug("groupChatInvitation"),this.myWebRTC_Event.createGroupChatInvitationEvent(at.groupChatId,at.senderId,at.senderNickname,at.senderPhotoURL,at.contactList)},this.answerToGroupChatInvitation=function(at,ht){var mt,St;pt.debug("answerToGroupChatInvitation: "+at+" : "+ht),ht===!0||ht===!1?(mt={type:"groupChatInvitationAnswer",groupChatId:at,senderId:st.apiCCId,nickname:this.nickname,photoURL:this.photoURL,accept:ht},St=JSON.stringify(mt),pt.log("C->S: "+St),st.channel.socket.emit("groupChatInvitationAnswer",St)):pt.log("accept value is not correct")},this.groupChatMemberUpdate=function(at){pt.info("groupChatMemberUpdate"),this.myWebRTC_Event.createGroupChatMemberUpdateEvent(at.groupChatId,at.contactList,at.status)},this.addUserInGroupChat=function(at,ht){var mt,St;pt.debug("addUser : "+ht+"in Group Chat with Id :"+at),mt={type:"addUserInGroupChat",groupChatId:at,nickname:this.nickname,photoURL:this.photoURL,contactId:ht},St=JSON.stringify(mt),pt.log("C->S: "+St),st.channel.socket.emit("addUserInGroupChat",St)},this.addUserInGroupChatAnswer=function(at){pt.info("addUserInGroupChatAnswer"),this.myWebRTC_Event.createAddUserInGroupChatEvent(at.invitationSended,at.groupChatId,at.contactId)},this.leaveGroupChat=function(at){var ht,mt;pt.info("Leave Group Chat with Id :"+at),ht={type:"leaveGroupChat",groupChatId:at,nickname:this.nickname,photoURL:this.photoURL},mt=JSON.stringify(ht),pt.log("C->S: "+mt),st.channel.socket.emit("leaveGroupChat",mt)},this.sendMessageToGroupChat=function(at,ht,mt){var St=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};pt.info("Call sending message to Group Chat .... from :"+this.nickname+" message :"+ht);var It=null,xt=null,At=apiCC.session.channel.getNewCSeq();It={type:"groupChatMessage",groupChatId:at,senderId:st.apiCCId,nickname:this.nickname,cSeq:At,data:ht},(0,ot.Ym)(St,"metadata","object")&&(It.metadata=St.metadata),xt=JSON.stringify(It),mt!==null&&typeof mt=="function"?(apiCC.session.messageTimeOutTable[At]=setTimeout(function(){mt({reason:"timeoutReached",cSeq:At}),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[At]},apiCC.session.messageTimeOutTimer),pt.log("C->S: "+xt),st.channel.socket.emit("groupChatMessage",xt,function(Nt){clearTimeout(apiCC.session.messageTimeOutTable[Nt.cSeq]),apiCC.session!==null&&apiCC.session!==void 0&&delete apiCC.session.messageTimeOutTable[Nt.cSeq],mt(Nt)})):(pt.log("C->S: "+xt),st.channel.socket.emit("groupChatMessage",xt))},this.receiveGroupChatMessage=function(at){pt.info("receiveGroupChatMessage"),this.myWebRTC_Event.createReceiveGroupChatMessageEvent(at.groupChatId,at.senderId,at.nickname,at.data,at.metadata)},this.getConversationHistory=function(at){var ht,mt;pt.debug("getConversationHistory"),ht={type:"getConversationHistory",convId:at},mt=JSON.stringify(ht),pt.log("C->S: "+mt),st.channel.socket.emit("getConversationHistory",mt)},this.receiveConversationHistory=function(at){pt.debug("receiveConversationHistory"),pt.log("msg.convId :"+at.convId);var ht,mt=0,St=[],It=null;if(at.convHistory!==null)for(pt.log("msg.convHistory.length :"+at.convHistory.length),mt=at.convHistory.length,St=[],ht=0;ht<mt;ht+=1)It=JSON.parse(at.convHistory[ht]),St.push(It);this.myWebRTC_Event.createReceiveConversationHistoryEvent(at.convId,St,at.status)},this.setUserData=function(at){var ht,mt;pt.info("setUserData"),this.photoURL=at.photoURL,st.photoURL=at.photoURL,pt.log("photoURL :"+this.photoURL),ht={type:"setUserData",nickname:this.nickname,photoURL:this.photoURL},mt=JSON.stringify(ht),pt.log("C->S: "+mt),st.channel.socket.emit("setUserData",mt),this.userDataSetted=!0},this.getUserData=function(at){var ht,mt;pt.info("getUserData"),ht={type:"getUserData",contactId:at},mt=JSON.stringify(ht),pt.log("C->S: "+mt),st.channel.socket.emit("getUserData",mt)},this.receiveUserDataAnswer=function(at){pt.info("receiveUserDataAnswer"),this.myWebRTC_Event.createUserDataAnswerEvent(at.userFound,at.contactId,at.nickname,at.photoURL)},this.receiveFetchUserDataAnswer=function(at){pt.info("receiveFetchUserDataAnswer"),this.myWebRTC_Event.createFetchUserDataAnswerEvent(at)},this.initialize=function(at){var ht,mt;this.conversation=document.getElementById(at),this.conversation===null&&(pt.log("conversationElementId Div Name is not correct : INCORRECT_DIV_NAME_CONVERSATION"),pt.log("conversationElementId is null")),ht={type:"registerIM",username:this.nickname},mt=JSON.stringify(ht),pt.log("C->S: "+mt),st.channel.socket.emit("registerIM",mt)},this.initialize(ft)}},9213:(it,ut,s)=>{s.d(ut,{X:()=>yt}),s(2564),s(2526),s(1817),s(1539);var tt=s(1549),ot=s(4708),ct=tt.Y.get("ApiCCPointerSharingClient"),yt=function pt(gt){this.roomTable={},this.getRoomIds=function(){var st=[],ft=null;for(ft in this.roomTable)st.push(ft);return st},this.roomExists=function(st){return this.roomTable.hasOwnProperty(st)},this.roomActive=function(st){return this.roomTable.hasOwnProperty(st)&&this.roomTable[st].state===pt.STATE_ACTIVE},this.joinRoom=function(st,ft){var at=this;ct.info("ApiCCPointerSharingClient::joinRoom()"),(0,ot.Ym)(ft,"object")||(ft={}),(0,ot.ki)(ft,"success","function")||(ft.success=function(){}),(0,ot.ki)(ft,"failure","function")||(ft.failure=function(){}),this.roomTable.hasOwnProperty(st)?ft.failure("room already joined",st):(this.roomTable[st]={roomId:st,state:pt.STATE_JOINING,joinRoomCallbacks:ft},this.roomTable[st].joinRoomTimeoutId=setTimeout(function(){delete at.roomTable[st],ft.failure("timeout",st)},15e3),apiCC.session.roomMgr.joinRoom(st,"pointerSharing"))},this.leaveRoom=function(st){this.roomTable.hasOwnProperty(st)&&delete this.roomTable[st],apiCC.session.roomMgr.leaveRoom(st,"pointerSharing")},this.inviteInRoom=function(st,ft,at){ct.info("ApiCCPointerSharingClient::inviteInRoom()"),apiCC.session.roomMgr.inviteInRoom(st,ft,"pointerSharing",at)},this.sendPointerLocation=function(st,ft,at,ht,mt){var St;return!(!this.roomTable.hasOwnProperty(st)||this.roomTable[st].state!==pt.STATE_ACTIVE||(St={type:"pointerLocation",source:ft,x:at,y:ht},(0,ot.Ym)(mt,"object")&&(St.data=mt),apiCC.session.roomMgr.sendMessageToRoom(st,"pointerSharing",St),0))},this.processMessageRoomJoin=function(st){this.roomTable.hasOwnProperty(st.roomId)&&this.roomTable[st.roomId].state===pt.STATE_JOINING&&(clearTimeout(this.roomTable[st.roomId].joinRoomTimeoutId),delete this.roomTable[st.roomId].joinRoomTimeoutId,this.roomTable[st.roomId].state=pt.STATE_ACTIVE,this.roomTable[st.roomId].joinRoomCallbacks.success(st.roomId),delete this.roomTable[st.roomId].joinRoomCallbacks)},this.stop=function(){for(var st=this.getRoomIds(),ft=st.length;--ft>=0;)this.leaveRoom(st[ft])}};yt.STATE_IDLE=Symbol("idle"),yt.STATE_JOINING=Symbol("joining"),yt.STATE_ACTIVE=Symbol("active"),yt.STATE_ERROR=Symbol("error")},3720:(it,ut,s)=>{s.d(ut,{K:()=>xt}),s(1058),s(8309),s(3710),s(1539),s(9714),s(2564),s(9554),s(4747),s(2772),s(561),s(6699),s(2479),s(2707),s(9601),s(2526),s(1817),s(2165),s(6992),s(8783),s(3948);var tt=s(1549),ot=tt.Y.get("RoomManager"),ct=function(At,Nt){ot.debug("RoomManager"),this.myWebRTC_Event=apiCC.myWebRTC_Event,this.createRoom=function(kt){var Mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ot.info("RoomManager:createRoom with roomType : "+kt);var bt={type:"createRoom",roomType:kt,nickname:At.nickname,photoURL:At.photoURL};Mt.convId&&(bt.data||(bt.data={}),bt.data.cloudConvId=Mt.convId),Mt.webconf===!0&&(bt.data||(bt.data={}),bt.data.webconf=!0);var Bt=JSON.stringify(bt);ot.log("C->S: "+Bt),At.channel.socket.emit("createRoom",Bt)},this.roomCreation=function(kt){ot.info("RoomManager:roomCreation"),this.myWebRTC_Event.createRoomCreationEvent(kt.status,kt.roomId,kt.roomType),Nt(kt)},this.roomJoin=function(kt){ot.info("RoomManager:roomJoin"),this.myWebRTC_Event.createRoomJoinedEvent(kt.status,kt.roomId,kt.roomType),Nt(kt)},this.inviteInRoom=function(kt,Mt,bt,Bt){var Ht=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};ot.info("RoomManager:inviteInRoom with roomType:",bt);var Wt={type:"inviteInRoom",roomId:kt,contactId:Mt,roomType:bt,nickname:At.nickname,photoURL:At.photoURL,context:Bt};Ht.convId&&(Wt.data||(Wt.data={}),Wt.data.cloudConvId=Ht.convId),Ht.webconf===!0&&(Wt.data||(Wt.data={}),Wt.data.webconf=!0);var nn=JSON.stringify(Wt);ot.log("C->S: "+nn),At.channel.socket.emit("inviteInRoom",nn)},this.inviteInRoomStatus=function(kt){ot.info("inviteInRoomStatus"),Nt(kt)},this.roomInvitation=function(kt){ot.info("roomInvitation",kt);var Mt={};kt.data&&(kt.data.cloudConvId&&(Mt.cloudConvId=kt.data.cloudConvId),kt.data.webconf===!0&&(Mt.webconf=!0)),this.myWebRTC_Event.createRoomInvitationEvent(kt.roomId,kt.senderId,kt.senderNickname,kt.senderPhotoURL,kt.contactList,kt.roomType,Mt),Nt(kt)},this.requestContactListInRoom=function(kt){ot.info("requestContactListInRoom :"+kt);var Mt={type:"requestContactListInRoom",roomId:kt},bt=JSON.stringify(Mt);At.channel.socket.emit("requestContactListInRoom",bt)},this.onContactListInRoom=function(kt){ot.info("onContactListInRoom :"+kt),this.myWebRTC_Event.createContactListInRoomEvent(kt.roomId,kt.contactList,kt.roomType),Nt(kt)},this.answerToRoomInvitation=function(kt,Mt,bt){if(ot.info("answerToRoomInvitation:",kt,Mt),Mt===!0||Mt===!1){var Bt={type:"roomInvitationAnswer",roomId:kt,senderId:At.apiCCId,nickname:At.nickname,photoURL:At.photoURL,accept:Mt,roomType:bt},Ht=JSON.stringify(Bt);ot.log("C->S: "+Ht),At.channel.socket.emit("roomInvitationAnswer",Ht)}else ot.log("accept value is not correct")},this.roomMemberUpdate=function(kt){ot.info("roomMemberUpdate"),this.myWebRTC_Event.createRoomMemberUpdateEvent(kt.roomId,kt.contactList,kt.status,kt.roomType),Nt(kt)},this.sendMessageToRoom=function(kt,Mt,bt){ot.info("Call sending message to Room .... from :"+At.apiCCId+" message :"+bt);var Bt={type:"roomMessage",roomId:kt,senderId:At.apiCCId,nickname:At.nickname,roomType:Mt,data:bt},Ht=JSON.stringify(Bt);ot.log("C->S: "+Ht),At.channel.socket.emit("roomMessage",Ht)},this.receiveRoomMessage=function(kt){ot.info("receiveRoomMessage"),this.myWebRTC_Event.createReceiveRoomMessageEvent(kt.roomId,kt.senderId,kt.nickname,kt.data,kt.roomType),Nt(kt)},this.joinRoom=function(kt,Mt){var bt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ot.info("Join Room with Id:",kt);var Bt={type:"joinRoom",roomId:kt,nickname:At.nickname,photoURL:At.photoURL,roomType:Mt};bt.convId&&(Bt.data||(Bt.data={}),Bt.data.cloudConvId=bt.convId),bt.webconf===!0&&(Bt.data||(Bt.data={}),Bt.data.webconf=!0);var Ht=JSON.stringify(Bt);ot.log("C->S: "+Ht),At.channel.socket.emit("joinRoom",Ht)},this.leaveRoom=function(kt,Mt){ot.info("Leave Room with Id:",kt);var bt={type:"leaveRoom",roomId:kt,nickname:At.nickname,photoURL:At.photoURL,roomType:Mt},Bt=JSON.stringify(bt);ot.log("C->S: "+Bt),At.channel.socket.emit("leaveRoom",Bt)}},yt=(s(2023),s(7042),s(1038),s(4916),s(9753),s(8765)),pt=s(5945);function gt(At,Nt){(Nt==null||Nt>At.length)&&(Nt=At.length);for(var kt=0,Mt=new Array(Nt);kt<Nt;kt++)Mt[kt]=At[kt];return Mt}var st=tt.Y.get("ApiCC_Channel"),ft=function(At){st.debug("ApiCC_Channel"),this.channelReady=!1,this.socket=null,this.channelId=At.apiCCId,this.myWebRTC_Event=new yt.K,this.channelHasBeenDisconnected=!1,this.cSeq=0,this.updatePresenceGroupIsNeeded=!1,this.oldPresenceGroup=null,this.newPresenceGroup=null,this.updateSubscribeToPresenceGroupIsNeeded=!1,this.oldSubscribeToPresenceGroup=null,this.newSubscribeToPresenceGroup=null,this.initialize=function(){st.info("ApiCC_Channel::initialize()"),this.openChannel()},this.getNewCSeq=function(){return this.cSeq=this.cSeq+1,this.cSeq},this.openChannel=function(){var Nt,kt,Mt,bt="",Bt=null,Ht=null,Wt=null,nn=null;st.debug("openChannel channelId :"+this.channelId),st.debug("session.apiKey :"+At.apiKey),st.log("session.sessionId :"+At.sessionId),At.xhrPolling=!0,st.log("CCSserver used : "+At.ccsServer),kt=At.appId!==void 0?"&appId="+At.appId:"",Mt=At.siteId!==void 0?"&siteId="+At.siteId:"",At.userData!==void 0&&(st.log("Defined userData : ",At.userData),Bt=JSON.stringify(At.userData),st.log("stringUserData.length :"+Bt.length),Bt.length<=1e3?bt="&userData="+encodeURIComponent(Bt):st.warn("userData length is too long :"+Bt.length+" .Need to be <= 500")),At.presenceGroup!==void 0&&(st.log("Defined presenceGroup : "+At.presenceGroup),Ht=JSON.stringify(At.presenceGroup),st.log("stringPresenceGroup.length :"+Ht.length),Ht.length<=750?bt+="&presenceGroup="+encodeURIComponent(Ht):st.warn("presenceGroup length is too long :"+Ht.length+" .Need to be <= 750")),At.subscribeToPresenceGroup!==void 0&&(st.log("Defined subscribeToPresenceGroup : "+At.subscribeToPresenceGroup),Wt=JSON.stringify(At.subscribeToPresenceGroup),st.log("stringsubscribeToPresenceGroup.length :"+Wt.length),Wt.length<=750?bt+="&subscribeToPresenceGroup="+encodeURIComponent(Wt):st.warn("subscribeToPresenceGroup length is too long :"+Wt.length+" .Need to be <= 750")),At.token!==void 0&&(st.log("Defined token : "+At.token),bt+="&token="+At.token),At.conversationSpace!==void 0&&At.conversationSpace!==null&&(st.log("Defined conversationSpace : "+At.conversationSpace),bt+="&conversationSpace="+At.conversationSpace),typeof apiRTC_React>"u"&&(st.log("ApplicationUUID : "+window.location.hostname),bt+="&applicationUUID="+window.location.hostname),bt+="&apiLibType=apiRTC_JS",st.log("requestOptions on connect :"+bt),st.log("session.ccsServer :"+At.ccsServer),Nt="?channelId="+this.channelId+"&apiKey="+At.apiKey+"&apiVersion="+apiCC.version+"&apiCCSessionId="+At.apiCCSessionId+"&sessionId="+At.sessionId+kt+Mt+bt,nn=typeof apiRTC_React<"u"?"https":window.location.protocol==="http:"?"http":"https",pt.ag.name!=="iOS"&&pt.ag.name!=="Android"||(st.log(pt.ag.name+" detected forcing protocol to https"),nn="https"),st.info("CCS Connect, socket url is : "+nn+"://"+At.ccsServer+"/"+Nt),this.ccsConnectionRetryNb=At.ccsConnectionRetryNb,this.ccsConnectionRetryDelay=At.ccsConnectionRetryDelay,this.socket=window.rtcio.connect(nn+"://"+At.ccsServer+"/"+Nt,{forceNew:!0,multiplex:!1,withCredentials:!0,reconnectionAttempts:this.ccsConnectionRetryNb,reconnectionDelay:this.ccsConnectionRetryDelay}),this.socket.on("connect",this.callback(this,"onChannelOpened")).on("connect_error",this.callback(this,"onChannelConnectError")).on("message",this.callbackWithParams(this,"onChannelMessage")).on("disconnect",this.callback(this,"onChannelDisconnect")),this.socket.io.on("error",this.callback(this,"onChannelError")).on("reconnect",this.callback(this,"onChannelReconnect")).on("reconnect_attempt",this.callback(this,"onChannelReconnectAttempt")).on("reconnect_error",this.callback(this,"onChannelReconnectError")).on("reconnect_failed",this.callback(this,"onChannelReconnect_failed"))},this.onWhiteBoardDisconnection=function(){st.info("onWhiteBoardDisconnection"),apiCC.session.closeWhiteBoardClient("NETWORK_DISCONNECTION")},this.onChannelDisconnect=function(Nt){st.info("onChannelDisconnect");var kt=Date();st.debug("date :"+kt),apiCC.session.connectedUsersList.splice(0,apiCC.session.connectedUsersList.length),this.myWebRTC_Event.createChannelEvent("onChannelDisconnect",Nt),this.channelHasBeenDisconnected=!0,apiCC.myApiCCWhiteBoardClient!==null&&(st.log("apiCC.myApiCCWhiteBoardClient.roomId :"+apiCC.myApiCCWhiteBoardClient.roomId),apiCC.myApiCCWhiteBoardClient.roomId!==null?(st.log("Disconnection with an ongoing whiteboard"),st.error("Whiteboard disconnectionTimer is set to:",apiCC.myApiCCWhiteBoardClient.disconnectionTimer),apiCC.myApiCCWhiteBoardClient.whiteBoardDisconnectionTimeoutId=setTimeout(this.callback(this,"onWhiteBoardDisconnection"),apiCC.myApiCCWhiteBoardClient.disconnectionTimer)):st.log("Disconnection without an ongoing whiteboard")),apiCC.session.JWTApzTokentimeOutId!==-1&&clearTimeout(apiCC.session.JWTApzTokentimeOutId)},this.onChannelReconnect_failed=function(){st.info("onChannelReconnect_failed"),this.myWebRTC_Event.createChannelEvent("onChannelReconnect_failed")},this.onChannelReconnect=function(Nt){st.error("onChannelReconnect",Nt);var kt,Mt=null,bt=0,Bt=[],Ht=null,Wt=null,nn=null,gn=!1,tn=0,Gt=null,fn=null;if(At.conversationSpace!==null&&At.conversationSpace!==void 0?(st.debug("conversationSpace is set :",At.conversationSpace),At.joinConversationSpace(At.conversationSpace)):st.debug("no conversationSpace defined"),At.userData!==void 0&&At.userData!==null&&(st.debug("sending userData :",At.userData),At.setUserData(At.userData,!0)),At.presenceGroup!==null?(st.debug("presenceGroup is set :",At.presenceGroup),At.sendPresenceGroupManagementCommand("join",At.presenceGroup)):st.debug("no presenceGroup defined"),At.subscribeToPresenceGroup!==null?(st.debug("subscribeToPresenceGroup is set :",At.subscribeToPresenceGroup),At.sendPresenceGroupManagementCommand("subscribe",At.subscribeToPresenceGroup)):st.debug("no subscribeToPresenceGroup defined"),apiCC.session.apiCCIMClient!==null?apiCC.session.apiCCIMClient.userDataSetted===!0?(Mt={photoURL:apiCC.session.apiCCIMClient.photoURL},apiCC.session.apiCCIMClient.setUserData(Mt)):st.log("apiCC.session.apiCCIMClient.userDataSetted !== true"):st.log("apiCC.session.apiCCIMClient === null"),apiCC.session.apiCCWebRTCClient!==null){if(apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable.length>0)for(gn=!0,kt=0;kt<apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable.length;kt+=1)Ht={destId:(fn=apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable[kt]).remoteId,convId:fn.userMediaId,callType:fn.callType,roomId:fn.roomId,data:fn.data,meshPublish:!0},Bt.push(Ht);if((bt=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.length)!==0){for(st.log("Reconnecting with calls ongoing"),kt=0;kt<bt;kt+=1)apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[kt]!==null&&apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[kt]!==void 0?(fn=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[kt],st.debug("call.iceState =",fn.iceState),fn.data!==null?fn.data.type!=="publish"&&fn.data.type!=="subscribe"?(st.log("Call is P2P, updating media"),fn.updateMediaWithRetryManagement(!0),Ht={destId:fn.remoteId,convId:fn.callId,callType:fn.callType,roomId:fn.dest_roomId,data:fn.data},Bt.push(Ht)):(st.log("Call is in an MCU session"),Ht={destId:fn.remoteId,convId:fn.callId,callType:fn.callType,roomId:fn.dest_roomId,data:fn.data},Bt.push(Ht)):(st.log("Call is P2P, updating media - no data"),fn.updateMediaWithRetryManagement(!0),Ht={destId:fn.remoteId,convId:fn.callId,callType:fn.callType,roomId:fn.dest_roomId,data:fn.data},Bt.push(Ht))):st.log("call no more exist");gn=!0}else st.log("Reconnecting without calls ongoing");for(var Cn=apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs,Tn=0;Tn<Cn.length;Tn+=1){st.log("Reconnecting with an ongoing sessionMCU");var dn=[];dn.push(Cn[Tn].roomName),apiCC.session.sendPresenceGroupManagementCommand("join",dn),apiCC.session.sendPresenceGroupManagementCommand("subscribe",dn)}}if(apiCC.myApiCCWhiteBoardClient!==null&&(apiCC.myApiCCWhiteBoardClient.whiteBoardDisconnectionTimeoutId!==0&&(st.debug("clearing whiteBoardDisconnectionTimeoutId"),clearTimeout(apiCC.myApiCCWhiteBoardClient.whiteBoardDisconnectionTimeoutId),apiCC.myApiCCWhiteBoardClient.whiteBoardDisconnectionTimeoutId=0),st.log("apiCC.myApiCCWhiteBoardClient.roomId :"+apiCC.myApiCCWhiteBoardClient.roomId),apiCC.myApiCCWhiteBoardClient.roomId!==null?(st.log("Reconnection with an ongoing whiteboard"),tn=apiCC.myApiCCWhiteBoardClient.roomId,gn=!0,st.debug("Reconnection , sending request to get most recent whiteboard data"),apiCC.myApiCCWhiteBoardClient.paperSheetId=0,apiCC.myApiCCWhiteBoardClient.drawingId=0,apiCC.myApiCCWhiteBoardClient.sendDataToRoom({tool:"void",needCatchUp:"*||-1"})):st.log("Reconnecting without an ongoing whiteboard")),apiCC.session.apiCCPointerSharingClient!==null&&(Gt=apiCC.session.apiCCPointerSharingClient.getRoomIds()).length>0&&(gn=!0),gn===!0){st.log("Sending reconnectContext to CCS"),Wt={type:"reconnectContext",callList:Bt,whiteBoardRoomId:tn},Gt!==null&&Gt.length>0&&(Wt.pointerSharingRoomIds=Gt);var mn=apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs;if(mn.length>0){Wt.updateSession=apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.createJoinSessionMessage(null),Wt.updateSession.type="updateSession",Wt.updateSessions=[];var yn,pn=function(_n,Mn){var Nn=typeof Symbol<"u"&&_n[Symbol.iterator]||_n["@@iterator"];if(!Nn){if(Array.isArray(_n)||(Nn=function(Xn,tr){if(Xn){if(typeof Xn=="string")return gt(Xn,tr);var cn=Object.prototype.toString.call(Xn).slice(8,-1);return cn==="Object"&&Xn.constructor&&(cn=Xn.constructor.name),cn==="Map"||cn==="Set"?Array.from(Xn):cn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(cn)?gt(Xn,tr):void 0}}(_n))||Mn&&_n&&typeof _n.length=="number"){Nn&&(_n=Nn);var wn=0,Pn=function(){};return{s:Pn,n:function(){return wn>=_n.length?{done:!0}:{done:!1,value:_n[wn++]}},e:function(Xn){throw Xn},f:Pn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Fn,ar=!0,Yn=!1;return{s:function(){Nn=Nn.call(_n)},n:function(){var Xn=Nn.next();return ar=Xn.done,Xn},e:function(Xn){Yn=!0,Fn=Xn},f:function(){try{ar||Nn.return==null||Nn.return()}finally{if(Yn)throw Fn}}}}(mn);try{for(pn.s();!(yn=pn.n()).done;){var In=yn.value,On=apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.createJoinSessionMessage(null,{sessionMCU:In});On.type="updateSession",Wt.updateSessions.push(On)}}catch(_n){pn.e(_n)}finally{pn.f()}}nn=JSON.stringify(Wt),st.log("C->S: "+nn),apiCC.session.channel.socket.emit("reconnectContext",nn)}Bt.splice(0,Bt.length),this.myWebRTC_Event.createChannelEvent("onChannelReconnect",Nt)},this.onChannelReconnecting=function(Nt){st.info("onChannelReconnecting",Nt);var kt=Date();st.debug("date :"+kt),this.myWebRTC_Event.createChannelEvent("onChannelReconnecting",Nt)},this.onChannelOpened=function(){st.info("Channel opened"),st.log("this.channelId :"+this.channelId),this.channelReady=!0,this.channelHasBeenDisconnected===!1?At.onChannelOpened():(st.log("onChannelOpened after a disconnection, no change on session"),this.channelHasBeenDisconnected=!1,At.ApiDBActivated!==!1&&At.ApiDBActivated!==void 0&&At.ApiDBActivated!==null&&(st.log("apiDB initialisation"),apiDB.init(At.channel.socket))),this.updatePresenceGroupIsNeeded===!0&&(st.log("Updating presence group"),At.leavePresenceGroup(this.oldPresenceGroup),At.joinPresenceGroup(this.newPresenceGroup)),this.updateSubscribeToPresenceGroupIsNeeded===!0&&(st.log("Updating subscribe to presence group"),At.unsubscribePresenceGroup(this.oldSubscribeToPresenceGroup),At.subscribePresenceGroup(this.newSubscribeToPresenceGroup)),this.myWebRTC_Event.createChannelEvent("onChannelOpened")},this.onChannelMessage=function(Nt,kt){var Mt,bt=null,Bt=null;try{bt=JSON.parse(Nt)}catch{return}(Mt=bt.type==="checkCallStatus"||bt.type==="apiRTCDataMessage"&&bt.data&&["activeSpeaker","stopSpeaking"].indexOf(bt.data.type)>=0)||st.info("onChannelMessage S->C: "+Nt),bt.type==="IMMessage"&&(st.log("IMMessage convId :"+bt.IMId),Bt=bt.IMId),kt!==void 0&&(st.trace("ack on message reception"),st.trace("convId :"+Bt),kt({reason:"ack",convId:Bt})),At.processSignalingMessage(bt,{quiet:Mt})},this.onChannelConnectError=function(Nt){st.error("onChannelConnectError :",Nt.message),this.myWebRTC_Event.createChannelEvent("onChannelConnectError",Nt),this.checkIfConnectionAttemptNeedToBeStopped(Nt)},this.onChannelReconnectError=function(Nt){st.log("onChannelReconnectError :",Nt.message),this.myWebRTC_Event.createChannelEvent("onChannelReconnectError",Nt),this.checkIfConnectionAttemptNeedToBeStopped(Nt)},this.onChannelReconnectAttempt=function(Nt){st.log("onChannelReconnectAttempt :",Nt),this.myWebRTC_Event.createChannelEvent("onChannelReconnectAttempt",Nt),this.onChannelReconnecting(Nt)},this.onChannelError=function(Nt){st.error("Channel error :",Nt.message),this.checkIfConnectionAttemptNeedToBeStopped(Nt),this.myWebRTC_Event.createChannelEvent("onChannelError",Nt)},this.checkIfConnectionAttemptNeedToBeStopped=function(Nt){st.debug("checkIfConnectionAttemptNeedToBeStopped"),(Nt.message==="not authorized"||Nt.message.includes("access token failure:")||Nt.message.includes("DISABLED_ENTERPRISE")||Nt.message.includes("An account is needed")||Nt.message.includes("ApiRTC update is needed")||Nt.message.includes("applicationUUID is not authorized"))&&(st.error("Stopping connection attempts"),this.socket.disconnect())},this.callback=function(Nt,kt){return this.closureHandler=function(Mt){return Nt[kt](Mt)},this.closureHandler},this.callbackWithParams=function(Nt,kt){return this.closureHandler=function(Mt,bt,Bt){return Nt[kt](Mt,bt,Bt)},this.closureHandler}},at=s(4708),ht=s(940);function mt(At){return mt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Nt){return typeof Nt}:function(Nt){return Nt&&typeof Symbol=="function"&&Nt.constructor===Symbol&&Nt!==Symbol.prototype?"symbol":typeof Nt},mt(At)}var St=tt.Y.get("ApiCCSession"),It=apiCC.myWebRTC_Event,xt=function(At){var Nt=this;if(this.apiCCId=null,this.apiCCSessionId=apiCC.randomString(22),this.apiKey=null,this.nickname=null,this.photoURL=null,this.apiCCWebRTCClient=null,this.apiCCIMClient=null,this.apiCCDataClient=null,this.apiCCIDSessionStorage=null,this.apiKeySessionStorage=null,this.apiCCIdPersistenceTimeout=5e3,this.channel=null,this.recordActivated=At.recordActivated,this.sessionId=null,this.apiCCPointerSharingClient=null,this.apiCCWhiteBoardClient=null,this.ccsServer=At.ccsServer,this.userData=At.userData,this.apiDBActivated=!0,At.ApiDBActivated=!0,this.webRTCPluginActivated=At.webRTCPluginActivated,this.token=At.token,this.JWTApzToken=null,this.JWTApzTokenRefreshTimer=396e5,this.JWTApzTokentimeOutId=-1,this.conversationSpace=At.conversationSpace,this.tryAudioCallAfterUserMediaError=At.tryAudioCallAfterUserMediaError,this.deactivateReloadOnCancel=At.deactivateReloadOnCancel,this.connectedUsersList=[],this.messageTimeOutTable=[],this.ccsConnectionRetryNb=At.ccsConnectionRetryNb,this.ccsConnectionRetryDelay=At.ccsConnectionRetryDelay,this.sequentialMessagesStorage={},this.cloudIsSecured=At.cloudIsSecured,At.messageTimeOutTimer!==void 0?this.messageTimeOutTimer=At.messageTimeOutTimer:this.messageTimeOutTimer=1e4,St.log("messageTimeOutTimer set to : "+this.messageTimeOutTimer),At.presenceGroup!==void 0?this.presenceGroup=At.presenceGroup:this.presenceGroup=["default"],At.subscribeToPresenceGroup!==void 0?this.subscribeToPresenceGroup=At.subscribeToPresenceGroup:this.subscribeToPresenceGroup=["default"],this.presenceGroupAddedByApiRTC=[],this.subscribeToPresenceGroupAddedByApiRTC=[],this.remoteAccessInvitation=null,this.isDeviceWebRTCCompliant=function(){return apiCC.isWebRTCCompliant()},this.isDeviceDTLSCompliant=function(){var bt=pt.E2.getBrowser(),Bt=parseInt(bt.version,10);return!(bt.name==="Chrome"&&Bt<44&&(St.log("isDeviceDTLSCompliant FALSE : Chrome V < 44"),1))},this.userData===void 0||this.userData===null?(this.userData={},this.userData.webRtcCompliant=apiCC.webRTCCompliant,this.userData.dtlsCompliant=this.isDeviceDTLSCompliant()):this.userData.webRtcCompliant===void 0||this.userData.webRtcCompliant===null?(this.userData.webRtcCompliant=apiCC.webRTCCompliant,this.userData.dtlsCompliant=this.isDeviceDTLSCompliant()):St.log("userData webRtcCompliant set to :",this.userData.webRtcCompliant),this.userData.osName=pt.BF,this.userData.osVersion=pt.MM,this.userData.browser=pt.Xh,this.userData.deviceType=pt.vO,this.userData.deviceVendor=pt.Cm,this.userData.deviceModel=pt.Ak,this.userData.browser_version=pt.dc,this.userData.browser_major_version=pt.PR,this.userData.apiRTCVersion=apiCC.version,this.userData.cpuArchitecture=pt.Ne,this.userData.engineName=pt.AA,this.userData.engineVersion=pt.TI,apiRTC.userAgentInstance!==void 0&&(this.userData.remoteAccessUserSupport=apiRTC.userAgentInstance.getCapabilities().remoteAccessUser),pt.BF==="Android"&&typeof cordova<"u"&&(this.userData.platform="Android"),typeof apiRTC_React<"u"&&(this.userData.react=!0),this.roomManagerEventHandler=function(bt){if(St.debug("roomManagerEventHandler, roomId :"+bt.roomId+", type :"+bt.type+", roomType :"+bt.roomType),bt.roomType==="whiteBoard"){if(apiCC.myApiCCWhiteBoardClient===null||apiCC.myApiCCWhiteBoardClient===void 0)return void St.log("No whiteBoard created, leaving msg processing");bt.type==="roomCreation"&&(St.log("whiteBoard : roomCreation"),apiCC.myApiCCWhiteBoardClient.roomId=bt.roomId,apiCC.myApiCCWhiteBoardClient.paperSheetId++,apiCC.myApiCCWhiteBoardClient.drawingId=0,apiCC.myApiCCWhiteBoardClient.sendDataToRoom({tool:"void",needCatchUp:"*||-1"})),bt.type==="roomInvitation"&&(St.log("whiteBoard : roomInvitation"),apiCC.myApiCCWhiteBoardClient.roomId=bt.roomId),bt.type==="roomMessage"&&apiCC.myApiCCWhiteBoardClient.messageProcessing(bt.data),bt.type==="roomJoin"&&(St.log("whiteBoard : roomJoin"),apiCC.myApiCCWhiteBoardClient.roomJoined=!0,apiCC.myApiCCWhiteBoardClient.roomId=bt.roomId)}else bt.roomType==="pointerSharing"?apiCC.session.apiCCPointerSharingClient&&bt.type==="roomJoin"&&apiCC.session.apiCCPointerSharingClient.processMessageRoomJoin(bt):bt.roomType==="coBrowsing"?bt.type==="roomMessage"&&St.log("coBrowsing : roomMessage :"+bt):St.log("roomManagerEventHandler for msg.roomType :"+bt.roomType)},this.callback=function(bt,Bt){return this.closureHandler=function(Ht){return bt[Bt](Ht)},this.closureHandler},this.roomMgr=new ct(this,this.callback(this,"roomManagerEventHandler")),At.xhrPolling===!0?this.xhrPolling=!0:this.xhrPolling=!1,this.getSessionStorage=function(bt){var Bt=sessionStorage.getItem(bt);if(Bt===null)return null;try{var Ht=JSON.parse(Bt),Wt=new Date(Ht.expiresAt);return new Date>=Wt?(sessionStorage.removeItem(bt),null):Ht.value}catch{St.error("Something went wrong when parsing JSON from session storage values")}},this.generateApiCCID=function(){St.debug("apiCCId is not defined by user, checking if apiCCId exist in sessionStorage"),typeof apiRTC_React>"u"&&(this.apiCCIDSessionStorage=this.getSessionStorage("apiCCId"),this.apiKeySessionStorage=this.getSessionStorage("apiKey")),this.apiCCIDSessionStorage!==null?(St.log("apiCCId exist in sessionStorage : "+this.apiCCIDSessionStorage),this.apiKeySessionStorage!==null?(St.log("apiKey exist in sessionStorage : "+this.apiKeySessionStorage),this.apiKeySessionStorage===this.apiKey?(St.log("apiKey is the same, keeping apiCCId"),this.apiCCId=this.apiCCIDSessionStorage):(St.log("apiKey is not the same, generating an  apiCCId"),this.apiCCId=Math.floor(1000001*Math.random()).toString(),St.log("Creation of new ApiRTC session with Id : "+this.apiCCId))):this.apiCCId=this.apiCCIDSessionStorage):(St.log(" No apiCCId found on sessionStorage : generating an apiCCId"),this.apiCCId=String(1e5+Math.floor(9e5*Math.random())),St.log("Creation of new ApiRTC session with Id : "+this.apiCCId))},this.getNumericIdFromAlpha=function(bt){St.log("getNumericIdFromAlpha new : "+bt);var Bt,Ht=0;if(bt.length===0)return Ht;for(Bt=0;Bt<bt.length;Bt++)Ht=(Ht<<5)-Ht+bt.charCodeAt(Bt),Ht&=Ht;return St.log("getNumericIdFromAlpha returned value: "+(Ht>>>0)),Ht>>>0},At.appId!==void 0&&(this.appId=At.appId),At.siteId!==void 0&&(this.siteId=At.siteId),At.apiKey===void 0)return St.error('Error : Initialisation parameters: "apikey" for session creation is not defined'),null;if(St.log("Session creation with apiKey : "+At.apiKey),St.log("Session creation with apiCCId : "+At.apiCCId),this.apiKey=At.apiKey,At.onReady===void 0&&typeof apiRTC_React>"u")return St.error('Error : Initialisation parameters: "onReady" for session creation is not defined'),null;if(apiCC.addEventListener("sessionReady",At.onReady),typeof apiRTC_React>"u"&&(this.sessionId=this.getSessionStorage("sessionId")),At.apiCCId===void 0||At.apiCCId===""||At.apiCCId===null)this.generateApiCCID();else if(St.log("Session creation with apiCCId defined by user : "+At.apiCCId),St.debug("params.idConversionActivated : "+At.idConversionActivated),At.idConversionActivated===void 0||At.idConversionActivated===!0)if((0,at._C)(At.apiCCId))this.apiCCId=At.apiCCId.toString();else{St.log("Converting this Id in a numeric one");var kt=this.getNumericIdFromAlpha(At.apiCCId);kt+="",St.log("Numeric Id is : "+kt),(0,at._C)(kt)?(St.warn("Id has been converted to a numeric one"),this.apiCCId=kt.toString()):(St.warn("Error : Defined apiCCId :"+At.apiCCId+" is not numeric. ApiCCID is generated"),this.generateApiCCID())}else St.log("String id convertion is deactivated"),this.apiCCId=At.apiCCId.toString();function Mt(bt){return bt instanceof Array?(St.log("data instanceof Array"),!0):(St.log("data not instanceof Array"),!1)}At.apiCCIdPersistenceTimeout!==null&&typeof At.apiCCIdPersistenceTimeout=="number"&&At.apiCCIdPersistenceTimeout>=0&&(this.apiCCIdPersistenceTimeout=At.apiCCIdPersistenceTimeout),this.channel!==null&&(St.log("this.channel is defined"),delete this.channel),this.channel=new ft(this),this.channel.initialize(),At.nickname!==null&&At.nickname!==void 0?(St.log("Nickname is defined :"+At.nickname),this.nickname=At.nickname):(St.log("Nickname is not defined, setting to apiCCId value :"+this.apiCCId),this.nickname=this.apiCCId),At.photoURL!==null&&At.photoURL!==void 0?(St.log("photoURL is defined :"+At.photoURL),this.photoURL=At.photoURL):(St.log("photoURL is not defined"),this.photoURL=null),this.reOpenChannel=function(bt,Bt){St.info("reOpenChannel"),this.apiCCId=bt.toString(),this.apiKey=Bt,this.channel.socket!==void 0&&this.channel.socket!==null&&this.channel.socket.disconnect(),this.channel.channelReady=!1,this.channel.socket=null,this.channel.channelId=this.apiCCId,this.channel.initialize(),this.apiCCWebRTCClient!==null&&this.apiCCWebRTCClient.webRTCClient!==null&&(this.apiCCWebRTCClient.webRTCClient.socket=this.channel.socket)},this.onChannelOpened=function(){St.debug("ApiCCSession onChannelOpened"),At.ApiDBActivated!==!1&&At.ApiDBActivated!==void 0&&At.ApiDBActivated!==null&&(St.log("apiDB initialisation"),apiDB.init(this.channel.socket)),It.createSessionReadyEvent(apiCC.session.apiCCId)},this.createWebRTCClient=function(bt){St.debug("createWebRTCClient");var Bt={};this.apiCCWebRTCClient=new apiCC.ApiCCWebRTCClient(this),apiCC.session.apiCCWebRTCClient.webRTCClient.setGumConfigWithDevicePresent(),Bt.audioDevicePresent=apiCC.mediaDeviceMgr.audioDevicePresent,Bt.videoDevicePresent=apiCC.mediaDeviceMgr.videoDevicePresent,apiCC.session.setUserData(Bt),setTimeout(function(){It.createWebRTCClientCreatedEvent()});var Ht=apiCC.getUserMediaStreamIds(),Wt=Ht.length;for(St.debug("listing accessToLocalMedia "+Wt);--Wt>=0;)if(apiCC.getUserMediaStream(Ht[Wt]).accessToLocalMedia()){St.debug("setting accessToLocalMedia to true"),this.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0;break}return this.apiCCWebRTCClient},this.createPointerSharingClient=function(){return this.apiCCPointerSharingClient===null&&(this.apiCCPointerSharingClient=new apiCC.ApiCCPointerSharingClient(this)),this.apiCCPointerSharingClient},this.closePointerSharingClient=function(){this.apiCCPointerSharingClient!==null&&this.apiCCPointerSharingClient instanceof apiCC.ApiCCPointerSharingClient&&(this.apiCCPointerSharingClient.stop(),this.apiCCPointerSharingClient=null)},this.createWhiteBoard=function(bt,Bt,Ht,Wt){return St.info("createWhiteBoard"),this.apiCCWhiteBoardClient=apiCC.createWhiteBoard(bt,Bt,Ht,Wt),this.apiCCWhiteBoardClient},this.closeWhiteBoardClient=function(bt){St.info("closeWhiteBoardClient"),apiCC.closeWhiteBoardClient(bt)},this.createIMClient=function(bt){return St.debug("createIMClient"),this.apiCCIMClient=new apiCC.ApiCCIMClient(this,bt),this.apiCCIMClient},this.createDataClient=function(){return St.info("createDataClient"),this.apiCCDataClient=new apiCC.ApiCCDataClient(this),this.apiCCDataClient},this.updatingQuery=function(bt){St.debug("updatingQuery");var Bt=null,Ht=null,Wt=null;return Bt=(0,at.dD)(bt),this.userData!==void 0?(Ht=JSON.stringify(this.userData),Wt=encodeURIComponent(Ht),Bt.userData=Wt,(0,at.Wc)(Bt)):bt},this.setUserData=function(bt,Bt){St.debug("setUserData in session :",bt);var Ht,Wt,nn,gn=[],tn=this.userData;if(this.userData!==void 0){if(this.userData=(0,at.S6)(this.userData,bt),St.debug("this.userData :",this.userData),St.debug("actualUserData :",tn),St.debug("forceSendData :",Bt),Bt!==!0&&JSON.stringify(this.userData)===JSON.stringify(tn))return void St.debug("userData is not changed, leaving userData processing")}else this.userData=bt;for(Ht={type:"setUserData",userData:bt},Wt=JSON.stringify(Ht),St.log("C->S: "+Wt),this.channel.socket.emit("setUserData",Wt),St.log("socket.io 1.X : socket.io.opts.query :"+this.channel.socket.io.opts.query),this.channel.socket.io.opts.query=this.updatingQuery(this.channel.socket.io.opts.query),St.log("socket.io 1.X : after update : socket.io.opts.query :"+this.channel.socket.io.opts.query),nn=0;nn<this.connectedUsersList.length;nn+=1)this.apiCCId===this.connectedUsersList[nn].userId&&(this.connectedUsersList[nn].userData=this.userData,gn[0]=this.apiCCId,It.createConnectedUsersListUpdateEvent(this.connectedUsersList[nn].group,gn,"userDataUpdate","userDataUpdate"))},this.sendPresenceGroupManagementCommand=function(bt,Bt){if(St.debug("sendPresenceGroupManagementCommand :"+bt+" for group : "+Bt),Mt(Bt)===!0){var Ht,Wt,nn,gn=Bt.length;if(bt==="unsubscribe")for(nn=0;nn<gn;nn+=1)this.removeGroupDataFromConnectedUsersList(Bt[nn]);gn!==1||Bt[0]!=="deactivated"?(Ht={type:"presenceGroupManagement",command:bt,group:Bt},Wt=JSON.stringify(Ht),St.log("C->S: "+Wt),this.channel.socket.emit("presenceGroupManagement",Wt)):St.debug("leaving sendPresenceGroupManagementCommand for group deactivated")}else St.error("group parameter value is not correct, need to be a JSON array")},this.sendConversationSpaceCommand=function(bt,Bt){var Ht,Wt;St.debug("sendConversationSpaceCommand :"+bt+" for conversationSpace : "+Bt),Ht={type:"conversationSpaceManagement",command:bt,conversationSpace:Bt},Wt=JSON.stringify(Ht),St.log("C->S: "+Wt),this.channel.socket.emit("conversationSpaceManagement",Wt)},this.joinPresenceGroup=function(bt,Bt){var Ht=this;Bt||((Bt={}).doneByApiRTC=!1),St.debug("joinPresenceGroup :"+bt),Mt(bt)===!0?(this.sendPresenceGroupManagementCommand("join",bt),bt.forEach(function(Wt){var nn=Ht.presenceGroupAddedByApiRTC.indexOf(Wt);Ht.presenceGroup.indexOf(Wt)===-1&&(Ht.presenceGroup.push(Wt),Bt.doneByApiRTC&&nn===-1&&Ht.presenceGroupAddedByApiRTC.push(Wt)),Bt.doneByApiRTC===!1&&nn!==-1&&Ht.presenceGroupAddedByApiRTC.splice(nn,1)})):St.log("group parameter value is not correct, need to be a JSON array"),St.debug("this.presenceGroup :"+this.presenceGroup)},this.leavePresenceGroup=function(bt,Bt){var Ht=this;Bt||((Bt={}).doneByApiRTC=!1),St.debug("leavePresenceGroup :"+bt),Mt(bt)===!0?bt.forEach(function(Wt){var nn=Ht.presenceGroupAddedByApiRTC.indexOf(Wt);if(Bt.doneByApiRTC===!1||Bt.doneByApiRTC===!0&&nn!==-1){var gn=Ht.presenceGroup.indexOf(Wt);gn!==-1&&Ht.presenceGroup.splice(gn,1),Ht.sendPresenceGroupManagementCommand("leave",[Wt])}nn!==-1&&Ht.presenceGroupAddedByApiRTC.splice(nn,1)}):St.log("group parameter value is not correct, need to be a JSON array"),St.debug("this.presenceGroup :"+this.presenceGroup)},this.subscribePresenceGroup=function(bt,Bt){var Ht=this;Bt||((Bt={}).doneByApiRTC=!1),St.debug("subscribePresenceGroup :"+bt),Mt(bt)===!0?(this.sendPresenceGroupManagementCommand("subscribe",bt),bt.forEach(function(Wt){var nn=Ht.subscribeToPresenceGroupAddedByApiRTC.indexOf(Wt);Ht.subscribeToPresenceGroup.indexOf(Wt)===-1&&(Ht.subscribeToPresenceGroup.push(Wt),Bt.doneByApiRTC&&Ht.subscribeToPresenceGroupAddedByApiRTC.indexOf(Wt)===-1&&Ht.subscribeToPresenceGroupAddedByApiRTC.push(Wt)),Bt.doneByApiRTC===!1&&nn!==-1&&Ht.subscribeToPresenceGroupAddedByApiRTC.splice(nn,1)})):St.log("group parameter value is not correct, need to be a JSON array"),St.debug("this.subscribeToPresenceGroup :"+this.subscribeToPresenceGroup)},this.unsubscribePresenceGroup=function(bt,Bt){var Ht=this;Bt||((Bt={}).doneByApiRTC=!1),St.debug("unsubscribePresenceGroup :"+bt),Mt(bt)===!0?bt.forEach(function(Wt){var nn=Ht.subscribeToPresenceGroupAddedByApiRTC.indexOf(Wt);if(Bt.doneByApiRTC===!1||Bt.doneByApiRTC===!0&&nn!==-1){var gn=Ht.subscribeToPresenceGroup.indexOf(Wt);gn!==-1&&Ht.subscribeToPresenceGroup.splice(gn,1),Ht.sendPresenceGroupManagementCommand("unsubscribe",[Wt])}nn!==-1&&Ht.subscribeToPresenceGroupAddedByApiRTC.splice(nn,1)}):St.log("group parameter value is not correct, need to be a JSON array"),St.debug("this.subscribeToPresenceGroup :"+this.subscribeToPresenceGroup)},this.joinConversationSpace=function(bt){St.info("joinConversationSpace :"+bt),this.sendConversationSpaceCommand("join",bt),this.conversationSpace=bt},this.leaveConversationSpace=function(bt){St.info("leaveConversationSpace :"+bt),bt!=null&&this.conversationSpace===bt?(this.sendConversationSpaceCommand("leave",bt),this.conversationSpace=null):St.debug("socket is not in the conversationSpace, we request to leave")},this.subscribeToCloudEvent=function(bt,Bt){this.sendCloudEventsCommand("subscribe",bt,Bt)},this.unsubscribeToCloudEvent=function(bt,Bt){this.sendCloudEventsCommand("unsubscribe",bt,Bt)},this.sendCloudEventsCommand=function(bt,Bt,Ht){if(["subscribe","unsubscribe"].includes(bt))if(Bt&&typeof Bt=="string"){if(Ht){if(mt(Ht)!=="object")return void St.error("wrong headers format");for(var Wt=0,nn=Object.values(Ht);Wt<nn.length;Wt++){var gn=nn[Wt];if(!gn||typeof gn!="string")return void St.error("wrong headers format")}}var tn={type:"cloudEvents",command:bt,topic:Bt};Ht&&(tn.headers=Ht);var Gt=JSON.stringify(tn);St.log("C->S:",Gt),this.channel.socket.emit("cloudEvents",Gt)}else St.error("wrong topic format");else St.error("wrong command")},this.getConversationList=function(bt){St.info("getConversationList request");var Bt,Ht;Ht=bt!==void 0?{type:"getConversationList",lastConversationNb:bt}:{type:"getConversationList",lastConversationNb:50},Bt=JSON.stringify(Ht),St.log("C->S: "+Bt),this.channel.socket.emit("getConversationList",Bt)},this.receiveConversationListAnswer=function(bt){St.info("receiveConversationListAnswer"),St.log("msg.convList.length :"+bt.convList.length);var Bt,Ht=bt.convList.length,Wt=[],nn=null;for(Bt=0;Bt<Ht;Bt+=1)St.log("i ="+Bt),nn=JSON.parse(bt.convList[Bt]),Wt.push(nn);It.createReceiveConversationListAnswerEvent(Wt)},this.getContactOccurrencesFromConversationList=function(bt){St.info("getContactOccurrencesFromConversationList request");var Bt,Ht;Ht=bt!==void 0?{type:"getContactOccurrencesFromConversationList",lastConversationNb:bt}:{type:"getContactOccurrencesFromConversationList",lastConversationNb:50},Bt=JSON.stringify(Ht),St.log("C->S: "+Bt),this.channel.socket.emit("getContactOccurrencesFromConversationList",Bt)},this.receiveContactOccurrencesFromConversationListAnswer=function(bt){St.info("receiveContactOccurrencesFromConversationListAnswer"),St.log("msg.contactOccurrencesTable.length :"+bt.contactOccurrencesTable.length),It.createReceiveContactOccurrencesFromConversationListAnswerEvent(bt.contactOccurrencesTable)},this.getConversationDetailReport=function(bt){var Bt,Ht;St.info("getConversationDetailReport for convId :"+bt),Bt={type:"getConversationDetailReport",convId:bt},Ht=JSON.stringify(Bt),St.log("C->S: "+Ht),this.channel.socket.emit("getConversationDetailReport",Ht)},this.receiveConversationDetailReportAnswer=function(bt){St.info("receiveConversationDetailReportAnswer"),St.log("msg.CDR :"+bt.CDR),It.createReceiveConversationDetailReportAnswerEvent(bt.CDR)},this.manageConnectedUsersList=function(bt,Bt,Ht,Wt){St.debug("manageConnectedUsersList");var nn,gn,tn,Gt=!1,fn=0,Cn=!1,Tn="unset";for(St.trace("manageConnectedUsersList.length :"+bt.length),St.trace("this.connectedUsersList.length :"+this.connectedUsersList.length),St.log("state :"+Bt),St.log("group :"+Ht),tn=0;tn<bt.length;tn+=1)bt[tn].group=Ht;if(Bt==="online")for(St.log("state : online"),nn=0;nn<bt.length;nn+=1){if(St.log("msgConnectedUsersListWithStatus  :"+nn),Gt=!1,this.connectedUsersList.length===0){St.log("this.connectedUsersList is empty"),this.connectedUsersList=bt,St.log("this.connectedUsersList[0].group :"+this.connectedUsersList[0].group),It.createConnectedUsersListUpdateEvent(Ht,Wt,Bt,"newConnectionState");break}for(gn=0;gn<this.connectedUsersList.length;gn+=1)if(Cn=!1,bt[nn].userId===this.connectedUsersList[gn].userId&&bt[nn].group===this.connectedUsersList[gn].group){Gt=!0,JSON.stringify(this.connectedUsersList[gn].userData)!==JSON.stringify(bt[nn].userData)&&(St.log("userData is updated"),this.connectedUsersList[gn].userData=bt[nn].userData,Cn=!0,Tn="userDataUpdate"),this.connectedUsersList[gn].callState!==bt[nn].callState&&(St.log("callState is updated"),this.connectedUsersList[gn].callState=bt[nn].callState,Cn=!0,Tn="callState"),Cn===!0&&It.createConnectedUsersListUpdateEvent(Ht,Wt,Bt,Tn);break}if(Gt===!1){St.log("Adding user in connectedUsersList :"+bt[nn].userId),this.connectedUsersList.push(bt[nn]);var dn=[];dn[0]=bt[nn].userId,It.createConnectedUsersListUpdateEvent(Ht,dn,Bt,"newConnectionState")}}else for(St.log("state : offline"),nn=0;nn<bt.length;nn+=1)for(St.log("msgConnectedUsersListWithStatus  :"+nn),fn=this.connectedUsersList.length,gn=0;gn<fn;gn+=1)if(bt[nn].userId===this.connectedUsersList[gn].userId&&bt[nn].group===this.connectedUsersList[gn].group){St.log("Removing user in connectedUsersList :"+bt[nn].userId),St.log("... in group :"+bt[nn].group),this.connectedUsersList.splice(gn,1),It.createConnectedUsersListUpdateEvent(Ht,Wt,Bt,"newConnectionState");break}},this.removeGroupDataFromConnectedUsersList=function(bt){St.debug("removeGroupDataFromConnectedUsersList for group :",bt);var Bt,Ht=this.connectedUsersList.length,Wt=[],nn=0;for(St.debug("this.connectedUsersList.length :",this.connectedUsersList.length),Bt=0;Bt<Ht;Bt+=1)St.debug("this.connectedUsersList[j].group :",this.connectedUsersList[Bt-nn].group),St.debug("group :",bt),this.connectedUsersList[Bt-nn].group===bt&&(St.log("Removing user in connectedUsersList :"+this.connectedUsersList[Bt-nn].userId),Wt[0]=this.connectedUsersList[Bt-nn].userId,this.connectedUsersList.splice(Bt-nn,1),nn+=1,It.createConnectedUsersListUpdateEvent(bt,Wt,"offline","newConnectionState"))},this.getConnectedUsersList=function(bt){bt!==void 0?St.log("getConnectedUsersList for group : "+bt):St.log("getConnectedUsersList : complete users list");var Bt,Ht=[];if(bt==null)return this.connectedUsersList;for(St.log("filtering list for group : "+bt),Bt=0;Bt<this.connectedUsersList.length;Bt+=1)this.connectedUsersList[Bt].group===bt&&Ht.push(this.connectedUsersList[Bt]);return Ht},this.isClientWebRtcCompliant=function(bt){var Bt,Ht,Wt=null,nn=null;if(bt!==void 0)for(Bt=this.getConnectedUsersList(),Ht=0;Ht<Bt.length;Ht++)Bt[Ht].userId===bt&&(nn=Bt[Ht].userData)!=null&&nn.webRtcCompliant!==void 0&&(Wt=nn.webRtcCompliant);return Wt},this.isClientDTLSCompliant=function(bt){var Bt,Ht,Wt=!0,nn=null;if(bt!==void 0)for(Bt=this.getConnectedUsersList(),Ht=0;Ht<Bt.length;Ht++)Bt[Ht].userId===bt&&(nn=Bt[Ht].userData,St.log("userData :",nn),nn!=null&&nn.dtlsCompliant!==void 0&&(Wt=nn.dtlsCompliant));return Wt},this.getConnectedUserIdsList=function(bt){St.info("getConnectedUserIdsList, group :",bt);var Bt,Ht,Wt=[],nn=!1,gn={},tn=[];if(bt!==void 0?St.log("getConnectedUserIdsList for group : "+bt):St.log("getConnectedUserIdsList : complete users list"),bt==null)tn=JSON.parse(JSON.stringify(this.connectedUsersList));else for(Bt=0;Bt<this.connectedUsersList.length;Bt+=1)this.connectedUsersList[Bt].group===bt&&tn.push(this.connectedUsersList[Bt]);for(Bt=0;Bt<tn.length;Bt+=1){for(nn=!1,Ht=0;Ht<Wt.length;Ht++)if(Wt[Ht].userId===tn[Bt].userId){nn=!0;break}nn===!1&&((gn={}).userId=tn[Bt].userId,gn.callState=tn[Bt].callState,gn.userData=tn[Bt].userData,Wt.push(gn))}return Wt},this.getGroupsFromConnectedUsersList=function(bt){St.info("getGroupsFroConnectedUsersList");var Bt,Ht=[],Wt=!1;for(Bt=0;Bt<this.connectedUsersList.length;Bt+=1)this.connectedUsersList[Bt].userId===bt&&(St.log("Matching Entry found :"+JSON.stringify(this.connectedUsersList[Bt].group)),Wt=!0,Ht.push(this.connectedUsersList[Bt].group));return Wt===!0?JSON.stringify(Ht):"User_Not_Found"},this.getConnectedUserInfo=function(bt,Bt){St.info("getConnectedUserInfo"),St.log("getConnectedUserInfo userId :",bt),St.log("getConnectedUserInfo infoType :",Bt);var Ht,Wt=null,nn=null;switch(Bt){case"all":for(St.log("all"),Ht=0;Ht<this.connectedUsersList.length;Ht+=1)if(this.connectedUsersList[Ht].userId===bt)return St.log("Matching Entry found :"+JSON.stringify(this.connectedUsersList[Ht])),Wt=this.getGroupsFromConnectedUsersList(bt),(nn=JSON.parse(JSON.stringify(this.connectedUsersList[Ht]))).groups=Wt,delete nn.group,JSON.stringify(nn);break;case"callState":for(St.log("callState"),Ht=0;Ht<this.connectedUsersList.length;Ht+=1)if(this.connectedUsersList[Ht].userId===bt)return St.log("Matching Entry found :"+JSON.stringify(this.connectedUsersList[Ht].callState)),this.connectedUsersList[Ht].callState;break;case"userData":for(St.log("userData"),Ht=0;Ht<this.connectedUsersList.length;Ht+=1)if(this.connectedUsersList[Ht].userId===bt)return St.log("Matching Entry found :"+JSON.stringify(this.connectedUsersList[Ht].userData)),JSON.stringify(this.connectedUsersList[Ht].userData);break;case"groups":return St.log("groups"),this.getGroupsFromConnectedUsersList(bt);default:St.log("infoType not defined switch case : "+Bt)}return"User_Not_Found"},this.isConnectedUser=function(bt){St.info("isConnectedUser");var Bt,Ht=!1;for(Bt=0;Bt<this.connectedUsersList.length;Bt+=1)if(St.log(JSON.stringify(this.connectedUsersList[Bt])),this.connectedUsersList[Bt].userId===bt)return Ht=!0,St.log("isConnected :"+Ht),Ht;return St.log("isConnected :"+Ht),Ht},this.displayConnectedUsersList=function(){var bt;for(St.debug("displayConnectedUsersList"),bt=0;bt<this.connectedUsersList.length;bt+=1)St.log("User :"+this.connectedUsersList[bt].userId+" on group :"+this.connectedUsersList[bt].group)},this.updatePresence=function(bt){try{St.debug("updatePresence : ",JSON.stringify(bt))}catch(Bt){St.debug(Bt)}St.log("updatePresence for group :"+bt.group),this.manageConnectedUsersList(bt.connectedUsersListWithStatus,bt.state,bt.group,bt.connectedUsersList),It.createUpdatePresenceEvent(bt.connectedUsersList,bt.state,bt.connectedUsersListWithStatus)},this.processCloudEventOccurred=function(bt){St.debug("processCloudEventOccurred",bt),It.createCloudEventOccurredEvent(bt.event.type,bt.event.target)},this.updateUserStatus=function(bt){St.info("updateUserStatus"+bt),It.createUpdateUserStatusEvent(bt)},this.sendDebugCommand=function(bt,Bt,Ht){St.info("sendDebugCommand :"+bt),new ht.S(this.channel.socket).sendDebugCommand("getClientSocketsInfo",Bt,Ht)},this.processSignalingMessage=function(bt){var Bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ht=null,Wt=null,nn=!1,gn=null,tn=null,Gt=!1,fn=null;if(bt.type==="invite")this.apiCCWebRTCClient?(St.log("this.webRTCPluginActivated =",this.webRTCPluginActivated),(pt.Xh==="IE"||pt.Xh==="Safari"&&pt.PR<11)&&this.webRTCPluginActivated===!0?(St.log("managing call with WebRTC Plugin"),apiCC.manageWebRTCPlugin(function(){St.log("manageWebRTCPlugin cb on Invite"),apiCC.session.apiCCWebRTCClient.webRTCClient.processInvite(bt)},function(){St.log("actionOnInstallationNeeded"),St.log("sending bye to be done"),new ht.S(apiCC.session.channel.socket).sendBye(bt.callId,bt.calleeId,bt.roomId,bt.callerId,"WebRTC_Plugin_Installation_needed",bt.data)})):(St.log("managing call with browser"),this.apiCCWebRTCClient.webRTCClient.processInvite(bt))):St.warn("WebRTCClient is not created");else if(bt.type==="200OK")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.process200OK(bt):St.warn("WebRTCClient is not created");else if(bt.type==="candidate")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.processCandidate(bt):St.warn("WebRTCClient is not created");else if(bt.type==="bye")this.apiCCWebRTCClient?(St.log("bye message from:"+bt.clientId+" for callId : "+bt.callId),this.apiCCWebRTCClient.webRTCClient.onRemoteHangup(bt.callId,bt.clientId,bt.roomId,bt.reason,bt.confId,bt.data)):St.warn("WebRTCClient is not created");else if(bt.type==="update")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.processUpdate(bt):St.warn("WebRTCClient is not created");else if(bt.type==="200update")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.process200Update(bt):St.warn("WebRTCClient is not created");else if(bt.type==="newConversationCreated")this.apiCCIMClient?this.apiCCIMClient.newConversationCreated(bt):St.warn("IMClient is not created");else if(bt.type==="IMMessage")this.apiCCIMClient?this.apiCCIMClient.receiveMessage(bt):St.warn("IMClient is not created");else if(bt.type==="groupChatCreation")this.apiCCIMClient?this.apiCCIMClient.groupChatCreation(bt):St.warn("IMClient is not created");else if(bt.type==="groupChatInvitation")this.apiCCIMClient?this.apiCCIMClient.groupChatInvitation(bt):St.warn("IMClient is not created");else if(bt.type==="groupChatMemberUpdate")this.apiCCIMClient?this.apiCCIMClient.groupChatMemberUpdate(bt):St.warn("IMClient is not created");else if(bt.type==="addUserInGroupChatAnswer")this.apiCCIMClient?this.apiCCIMClient.addUserInGroupChatAnswer(bt):St.warn("IMClient is not created");else if(bt.type==="groupChatMessage")this.apiCCIMClient?this.apiCCIMClient.receiveGroupChatMessage(bt):St.warn("IMClient is not created");else if(bt.type==="conversationHistoryAnswer")this.apiCCIMClient?this.apiCCIMClient.receiveConversationHistory(bt):St.warn("IMClient is not created");else if(bt.type==="getUserDataAnswer")this.apiCCIMClient?this.apiCCIMClient.receiveUserDataAnswer(bt):St.warn("IMClient is not created");else if(bt.type==="fetchUserDataAnswer")this.apiCCIMClient?this.apiCCIMClient.receiveFetchUserDataAnswer(bt):St.warn("IMClient is not created");else if(bt.type==="dataMessage")this.apiCCDataClient?this.apiCCDataClient.receiveData(bt):St.warn("DataClient is not created");else if(bt.type==="dataAck")this.apiCCWebRTCClient.webRTCClient.processDataAck(bt);else if(bt.type==="dataEndAck")this.apiCCWebRTCClient.webRTCClient.processDataEndAck(bt);else if(bt.type==="updateVideoQuality")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processUpdateVideoQuality(bt.callId,bt.profile);else if(bt.type==="apiRTCDataMessage")if(Bt.quiet||St.debug("apiRTCDataMessage:",bt),(0,at.Ym)(bt.data,"object"))if(bt.data.type==="joinSessionAnswer")if(this.apiCCWebRTCClient){var Cn={roomName:bt.data.roomId};(0,at.ki)(bt.data,"convId","string")&&(Cn.convId=bt.data.convId),(0,at.ki)(bt.data,["data","mode"],"string")&&(Cn.data={mode:bt.data.data.mode}),(0,at.ki)(bt.data,["data","transition"],"string")&&bt.data.data.transition==="mesh2janus"?this.apiCCWebRTCClient.webRTCClient.MCUClient.changeSessionMode(Cn,"mesh2janus"):this.apiCCWebRTCClient.webRTCClient.MCUClient.updateSessionAnswer(Cn,{createSession:!0})}else St.warn("WebRTCClient is not created");else if(bt.data.type==="slowLink"){if(this.apiCCWebRTCClient){var Tn={};bt.data.advice&&(Tn.advice=bt.data.advice),this.apiCCWebRTCClient.webRTCClient.processSlowLink(bt.data.callId,Tn)}}else if(bt.data.type==="videoQualityChanged")It.createVideoQualityChangedEvent(bt.data.callId,bt.data.roomId,bt.data.hint,bt.data.profile);else if(bt.data.type==="distantIceError")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processDistantIceError(bt.data);else if(bt.data.type==="streamTrackChanged")this.apiCCWebRTCClient&&bt.data.hasOwnProperty("mline")&&bt.data.hasOwnProperty("muted")&&this.apiCCWebRTCClient.webRTCClient.processStreamTrackMuteChanged(bt.data.callId,bt.data.mline,bt.data.muted);else if(bt.data.type==="streamTrackStatusChanged")this.apiCCWebRTCClient&&bt.data.hasOwnProperty("mline")&&bt.data.hasOwnProperty("change")&&bt.data.hasOwnProperty(bt.data.change)&&this.apiCCWebRTCClient.webRTCClient.processStreamTrackStatusChanged(bt.data.callId,bt.data.mline,bt.data[bt.data.change]);else if(bt.data.type==="configureEncodings")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processConfigureEncodings(bt.data);else if(bt.data.type==="activeSpeaker")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processAudioAmplitude(bt.data,!0);else if(bt.data.type==="stopSpeaking")this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processAudioAmplitude(bt.data,!1);else if(bt.data.type==="updateStream")this.apiCCWebRTCClient&&bt.data.callId&&bt.data.mline&&bt.data.direction&&this.apiCCWebRTCClient.webRTCClient.processUpdateStream(bt.data.callId,bt.data.mline,bt.data.direction);else if(bt.data.type==="startRecording"){if(this.apiCCWebRTCClient)if(bt.data.callId==="COMPOSITE")this.apiCCWebRTCClient.webRTCClient.MCUClient.startCompositeRecording(bt.data.mediaType,bt.data.customIdInFilename,bt.data.convId,bt.data.data);else{for(fn=this.apiCCWebRTCClient.webRTCClient.callsTable.length;--fn>=0;)if(this.apiCCWebRTCClient.webRTCClient.callsTable[fn].callId===bt.data.callId){Gt=!0;break}Gt?this.apiCCWebRTCClient.webRTCClient.MCUClient.startRecording(bt.data.mediaType,bt.data.customIdInFilename,bt.data.convId,bt.data.callId,bt.data.data):St.info("cannot start recording (call not found)")}}else if(bt.data.type==="startStreaming"){if(this.apiCCWebRTCClient){for(fn=this.apiCCWebRTCClient.webRTCClient.callsTable.length;--fn>=0;)if(this.apiCCWebRTCClient.webRTCClient.callsTable[fn].callId===bt.data.callId){Gt=!0;break}Gt?this.apiCCWebRTCClient.webRTCClient.MCUClient.startStreaming(bt.data.service,bt.data.server,bt.data.streamKey,bt.data.callId):St.info("cannot start streaming (call not found)")}}else if(bt.data.type==="startCallStatsMonitoring"){if(this.apiCCWebRTCClient){for(St.debug("startCallStatsMonitoring",bt.data.callId),fn=this.apiCCWebRTCClient.webRTCClient.callsTable.length;--fn>=0;)if(this.apiCCWebRTCClient.webRTCClient.callsTable[fn].callId===bt.data.callId){Wt=this.apiCCWebRTCClient.webRTCClient.callsTable[fn];break}Wt?["chrome","firefox"].indexOf(at.wL.type)>=0?Wt.csmIntervalId?St.debug("call stats monitoring already started"):Wt.csmIntervalId=setInterval(Wt.callback(Wt,"csmHandler"),Wt.csmIntervalMs):St.debug("call stats are only supported on chrome and firefox"):St.debug("no such call")}}else bt.data.type==="callOrder"?(St.log("callOrder received"),this.apiCCWebRTCClient?(this.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector=bt.senderId,Ht=this.apiCCWebRTCClient.webRTCClient.callWithNumber(bt.data.caller,!0,{MCUType:"MCU-Callee",confId:bt.data.confId,convId:bt.data.convId},gn),this.apiCCWebRTCClient.webRTCClient.myWebRTC_Event.createIncomingCallEvent(this.clientId,bt.data.caller,bt.data.caller,Ht,!1,1,!1,"video",!0,"web","media")):St.warn("WebRTCClient is not created")):bt.data.type==="subscribeOrder"?(St.log("subscribeOrder received"),this.apiCCWebRTCClient?(this.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector=bt.senderId,bt.data.data.subscribeOrder=!0,(tn=[]).push(bt.data.stream),this.apiCCWebRTCClient.webRTCClient.MCUClient.subscribeToStreams(tn,"VIDEO",bt.data.data,gn,{noStreamCheck:!0})):St.warn("WebRTCClient is not created")):bt.data.type==="distantCallEstablished"?this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processDistantCallEstablished(bt.data):bt.data.type==="simulcastFeedChanged"?this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processSimulcastFeedChanged(bt.data):St.log("msg.data.type is not managed :"+bt.data.type);else St.log("msg.data === undefined");else if(bt.type==="conversationListAnswer")this.receiveConversationListAnswer(bt);else if(bt.type==="contactOccurrencesFromConversationListAnswer")this.receiveContactOccurrencesFromConversationListAnswer(bt);else if(bt.type==="conversationDetailReport")this.receiveConversationDetailReportAnswer(bt);else if(bt.type==="updatePresence")St.log("updatePresence"),this.updatePresence(bt);else if(bt.type==="updateUserStatus")St.log("updateUserStatus"),this.updateUserStatus(bt);else if(bt.type==="receiveMCUSessionId")St.log("receiveMCUSessionId"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.receiveSessionId(bt):St.warn("WebRTCClient is not created");else if(bt.type==="joinSessionAnswer")St.log("joinSessionAnswer"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.joinSessionAnswer(bt):St.warn("WebRTCClient is not created");else if(bt.type==="updateSessionAnswer")St.log("updateSessionAnswer"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.updateSessionAnswer(bt,{updateCalls:!0}):St.warn("WebRTCClient is not created");else if(bt.type==="availableStreams")this.apiCCWebRTCClient?(St.log("message availableStreams received"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.newAvailableStream(bt.msg,"regular",function(mn,yn,pn){It.createMCUAvailableStreamEvent([yn],mn)}):St.warn("WebRTCClient is not created")):St.warn("WebRTCClient is not created");else if(bt.type==="availableReplay")this.apiCCWebRTCClient?(St.log("message availableReplay received"),this.apiCCWebRTCClient?(nn=this.apiCCWebRTCClient.webRTCClient.MCUClient.newAvailableReplay(bt.msg),It.createMCUAvailableReplayEvent(bt.msg,nn)):St.warn("WebRTCClient is not created")):St.warn("WebRTCClient is not created");else if(bt.type==="availableComposite")this.apiCCWebRTCClient?(St.log("message availableComposite received"),this.apiCCWebRTCClient?(nn=this.apiCCWebRTCClient.webRTCClient.MCUClient.newAvailableStream(bt.msg,"composite"),It.createMCUAvailableCompositeEvent(bt.msg,nn)):St.warn("WebRTCClient is not created")):St.warn("WebRTCClient is not created");else if(bt.type==="onRemoveStream")this.apiCCWebRTCClient?(St.log("message onRemoveStream received:",bt),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.removeMCUStream(bt.callId,bt.msg.id,bt.msg.reason):St.warn("WebRTCClient is not created")):St.warn("WebRTCClient is not created");else if(bt.type==="availableStreamsUpdate")this.apiCCWebRTCClient?(St.log("message availableStreamsUpdate received"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.updateAvailableStream(bt.msg,"regular",function(mn,yn,pn,In){It.createMCUAvailableStreamUpdateEvent([yn],mn)}):St.warn("WebRTCClient is not created")):St.warn("WebRTCClient is not created");else if(bt.type==="checkCallStatus")this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.processCheckCallStatus(bt):St.warn("WebRTCClient is not created");else if(bt.type==="MCUSessionInvitation")St.log("MCUSessionInvitation"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.receiveSessionInvitation(bt):St.warn("WebRTCClient is not created");else if(bt.type==="MCUSessionInvitationToGroupChat")St.log("MCUSessionInvitationToGroupChat"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.receiveSessionInvitation(bt):St.warn("WebRTCClient is not created");else if(bt.type==="participantEjected")St.log("participantEjected"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.participantEjected(bt):St.warn("WebRTCClient is not created");else if(bt.type==="recordingStarted")St.log("recordingStarted"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.recordingStarted(bt):St.warn("WebRTCClient is not created");else if(bt.type==="recordingStopped")St.log("recordingStopped"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.recordingStopped(bt):St.warn("WebRTCClient is not created");else if(bt.type==="recordingStreamAvailable")St.log("recordingStreamAvailable"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.recordingStreamAvailable(bt):St.warn("WebRTCClient is not created");else if(bt.type==="streamingStarted")St.log("streamingStarted"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.streamingStarted(bt):St.warn("WebRTCClient is not created");else if(bt.type==="streamingStopped")St.log("streamingStopped"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.MCUClient.streamingStopped(bt):St.warn("WebRTCClient is not created");else if(bt.type==="sessionId")St.log("sessionId :"+bt.sessionId),this.sessionId=bt.sessionId,bt.JWTApzToken!==void 0&&this.handleJWTApzToken(bt.JWTApzToken);else if(bt.type==="JWTTokenRefreshAnswer")St.log("JWTTokenRefreshAnswer"),bt.JWTApzToken!==void 0&&this.handleJWTApzToken(bt.JWTApzToken);else if(bt.type==="roomCreation")St.log("roomCreation"),this.roomMgr.roomCreation(bt);else if(bt.type==="roomJoin")St.log("roomJoined"),this.roomMgr.roomJoin(bt);else if(bt.type==="inviteInRoomStatus")St.log("inviteInRoomStatus"),this.roomMgr.inviteInRoomStatus(bt);else if(bt.type==="contactListInRoom")St.log("contactListInRoom"),this.roomMgr.onContactListInRoom(bt);else if(bt.type==="roomInvitation")St.log("roomInvitation"),this.roomMgr.roomInvitation(bt);else if(bt.type==="roomMessage")St.log("roomMessage"),this.roomMgr.receiveRoomMessage(bt);else if(bt.type==="roomMemberUpdate")St.log("roomMemberUpdate"),this.roomMgr.roomMemberUpdate(bt);else if(bt.type==="agentReconnect"){var dn=this.apiCCWebRTCClient.webRTCClient.findCallWithCallId(bt.callId);dn!=null&&dn.getUserMediaOnCall()}else bt.type==="sequence"?(St.log("Sequential message"),this.handleSequentialMessage(bt)):bt.type==="Ack"?St.log("Ack received"):bt.type==="receipt"?this.apiCCWebRTCClient&&this.apiCCWebRTCClient.webRTCClient.processReceipt(bt):bt.type==="error"?(St.log("error received"),this.apiCCWebRTCClient?this.apiCCWebRTCClient.webRTCClient.processError(bt):It.createErrorEvent(bt.errorInfo,bt.errorCode,bt.callId,bt.roomId,null,null,bt.convId)):bt.type==="enterpriseConfig"?(St.log("enterpriseConfig received"),this.handleEnterpriseConfigMessage(bt)):bt.type==="AIEMessage"?(St.log("AIEMessage received"),this.handleAIEMessage(bt)):bt.type==="cloudEventOccurred"?this.processCloudEventOccurred(bt):St.log("Error : No type for this message")},this.handleSequentialMessage=function(bt){if(bt.id!==void 0&&bt.packetNum!==void 0&&bt.totalPacketsNum!==void 0&&bt.data!==void 0){St.debug("Handle sequential message packet "+bt.packetNum+"/"+bt.totalPacketsNum,bt);var Bt=[];if(Nt.sequentialMessagesStorage[bt.id]!==void 0&&(Bt=Nt.sequentialMessagesStorage[bt.id]),Bt.push(bt),Nt.sequentialMessagesStorage[bt.id]=Bt,Bt.length===bt.totalPacketsNum){Bt.sort(function(nn,gn){return nn.packetNum-gn.packetNum});var Ht="";Bt.forEach(function(nn){Ht+=nn.data}),delete Nt.sequentialMessagesStorage[bt.id];var Wt=null;try{Wt=JSON.parse(Ht)}catch(nn){return void St.error("Error : can't parse sequential message JSON :",nn)}if(!Wt)return void St.error("Error : can't restore sequential message, it's null");St.debug("Restored sequential message :",Ht),Nt.processSignalingMessage(Wt)}}else St.error("Error : sequential message is inconsistent :",bt)},this.handleEnterpriseConfigMessage=function(bt){if(St.debug("handleEnterpriseConfigMessage :",bt),(0,at.ki)(bt,"sentry","boolean")&&bt.sentry===!0){var Bt;Bt=window!==void 0&&window.location!==void 0&&window.location.protocol!==void 0&&window.location.protocol!=="https:"?"http":"https",apiCC.loadSentry(apiCC.initApiKey,Bt)}if((0,at.ki)(bt,"customJson","string")&&bt.customJson!=="")try{St.debug("customJson :",bt.customJson),bt.customJson=JSON.parse(bt.customJson)}catch(Ht){St.error(Ht)}if((0,at.ki)(bt,"iceServers","string")&&bt.iceServers!=="")try{St.debug("iceServers :",bt.iceServers),bt.iceServers=JSON.parse(bt.iceServers),Nt.apiCCWebRTCClient.setPcConfig(bt.iceServers)}catch(Ht){St.error(Ht)}(0,at.ki)(bt,"logLevel","string")&&bt.logLevel!==""&&!isNaN(parseInt(bt.logLevel))&&apiRTC.setLogLevel(parseInt(bt.logLevel)),(0,at.ki)(bt,"ccs","object")&&(Nt.ccsInfo=Object.assign({},bt.ccs))},this.handleAIEMessage=function(bt){switch(St.debug("handleAIEMessage :",bt),bt.detail){case"modelLoaded":if(apiCC!==void 0&&bt.userMediaStreamId!==void 0){var Bt=apiCC.getUserMediaStream(bt.userMediaStreamId).mediaFilterManager;for(var Ht in Bt.filters)Bt.filters[Ht]!==void 0&&Bt.filters[Ht].streamAIE!==null&&Bt.filters[Ht].streamAIE.modelLoaded(bt)}break;case"unknownModelName":St.error("Unknown model name :",bt.modelName);break;case"loadModelError":St.error("Error while loading model :",bt.info);break;default:St.debug("Unknown detail :",bt.detail)}},this.handleJWTApzToken=function(bt){St.debug("handleJWTApzToken :",bt),Nt.JWTApzToken=bt,Nt.cloudIsSecured===!0?(St.debug("Setting JWTApzToken on cloudAPI"),apiCC.CloudApi.setJWTApzToken(Nt.JWTApzToken)):St.debug("JWTApzToken is not set on cloudAPI"),Nt.JWTApzTokentimeOutId!==-1&&clearTimeout(Nt.JWTApzTokentimeOutId),Nt.JWTApzTokentimeOutId=setTimeout(function(){var Bt=JSON.stringify({type:"JWTTokenRefreshRequest"});St.log("C->S: "+Bt),apiCC.session.channel.socket.emit("JWTTokenRefreshRequest",Bt)},Nt.JWTApzTokenRefreshTimer)},this.fetchUserData=function(bt){var Bt,Ht;St.debug("fetchUserData"),Bt={type:"fetchUserData",id:bt.id,apiKey:bt.apiKey,timeout:bt.timeout},Ht=JSON.stringify(Bt),St.log("C->S: "+Ht),this.channel.socket.emit("fetchUserData",Ht)}}},7323:(it,ut,s)=>{s.d(ut,{q:()=>Dt}),s(4363),s(9653),s(3710),s(1539),s(9714),s(561),s(2564),s(4812),s(8309),s(9753),s(9554),s(4747),s(8674),s(7042),s(1038),s(8783),s(4916),s(2526),s(1817),s(2165),s(6992),s(3948);var tt=s(1549),ot=s(5945),ct=s(4708);function yt(Et,jt){for(var Yt=0;Yt<jt.length;Yt++){var en=jt[Yt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}s(2479),s(9070),s(8304),s(489),s(2419),s(8011);var pt=function(){function Et(){(function(en,Kt){if(!(en instanceof Kt))throw new TypeError("Cannot call a class as a function")})(this,Et)}var jt,Yt;return jt=Et,(Yt=[{key:"applyFilter",value:function(en,Kt){}},{key:"release",value:function(){}}])&&yt(jt.prototype,Yt),Object.defineProperty(jt,"prototype",{writable:!1}),Et}();function gt(Et,jt){return function(Yt){if(Array.isArray(Yt))return Yt}(Et)||function(Yt,en){var Kt=Yt==null?null:typeof Symbol<"u"&&Yt[Symbol.iterator]||Yt["@@iterator"];if(Kt!=null){var rn,hn,an=[],un=!0,Sn=!1;try{for(Kt=Kt.call(Yt);!(un=(rn=Kt.next()).done)&&(an.push(rn.value),!en||an.length!==en);un=!0);}catch(En){Sn=!0,hn=En}finally{try{un||Kt.return==null||Kt.return()}finally{if(Sn)throw hn}}return an}}(Et,jt)||function(Yt,en){if(Yt){if(typeof Yt=="string")return st(Yt,en);var Kt=Object.prototype.toString.call(Yt).slice(8,-1);return Kt==="Object"&&Yt.constructor&&(Kt=Yt.constructor.name),Kt==="Map"||Kt==="Set"?Array.from(Yt):Kt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Kt)?st(Yt,en):void 0}}(Et,jt)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function st(Et,jt){(jt==null||jt>Et.length)&&(jt=Et.length);for(var Yt=0,en=new Array(jt);Yt<jt;Yt++)en[Yt]=Et[Yt];return en}function ft(Et,jt){for(var Yt=0;Yt<jt.length;Yt++){var en=jt[Yt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}function at(Et,jt){var Yt;return Yt=(Et/=255)<.09804?.01894124847001224*Et:Et<.2?.5695370733621028*(Et-.09804)+.001857:Et<.298?1.292329661362709*(Et-.2)+.05993:Et<.4?1.5339348764221266*(Et-.298)+.1866:Et<.498?1.5697674418604652*(Et-.4)+.343:Et<.6?1.570223617104747*(Et-.498)+.4969:Et<.698?1.536107711138311*(Et-.6)+.657:Et<.8?1.2995292271479013*(Et-.698)+.8076:Et<.898?.5868013055895552*(Et-.8)+.9401:.023568065908199296*(Et-.898)+.9976,255*Math.pow(Yt,jt)}function ht(Et,jt){return 255*Math.pow(Et/255,jt)}s(9575),s(9743),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(7327);var mt=function(){function Et(en,Kt,rn){(function(hn,an){if(!(hn instanceof an))throw new TypeError("Cannot call a class as a function")})(this,Et),this.image=en,this.width=Kt,this.height=rn,this.length=this.width*this.height}var jt,Yt;return jt=Et,Yt=[{key:"mean",value:function(){var en=arguments.length>0&&arguments[0]!==void 0&&arguments[0],Kt=0,rn=0,hn=0;if(en)for(var an=0;an<this.length;an++)Kt+=Math.pow(this.image.data[4*an+0],2)/(255*this.length),rn+=Math.pow(this.image.data[4*an+1],2)/(255*this.length),hn+=Math.pow(this.image.data[4*an+2],2)/(255*this.length);else for(var un=0;un<this.length;un++)Kt+=this.image.data[4*un+0]/this.length,rn+=this.image.data[4*un+1]/this.length,hn+=this.image.data[4*un+2]/this.length;return[Kt,rn,hn]}},{key:"mad",value:function(){var en=arguments.length>0&&arguments[0]!==void 0&&arguments[0],Kt=this.mean(en),rn=gt(Kt,3),hn=rn[0],an=rn[1],un=rn[2],Sn=0,En=0,An=0;if(en)for(var Dn=0;Dn<this.length;Dn++)Sn+=Math.abs(Math.pow(this.image.data[4*Dn+0],2)/255-hn)/this.length,En+=Math.abs(Math.pow(this.image.data[4*Dn+1],2)/255-an)/this.length,An+=Math.abs(Math.pow(this.image.data[4*Dn+2],2)/255-un)/this.length;else for(var Bn=0;Bn<this.length;Bn++)Sn+=Math.abs(this.image.data[4*Bn+0]-hn)/this.length,En+=Math.abs(this.image.data[4*Bn+1]-an)/this.length,An+=Math.abs(this.image.data[4*Bn+2]-un)/this.length;return[Sn,En,An]}},{key:"std",value:function(){var en=arguments.length>0&&arguments[0]!==void 0&&arguments[0],Kt=this.mean(en),rn=gt(Kt,3),hn=rn[0],an=rn[1],un=rn[2],Sn=0,En=0,An=0;if(en)for(var Dn=0;Dn<this.length;Dn++)Sn+=Math.pow(Math.pow(this.image.data[4*Dn+0],2)/255-hn,2)/this.length,En+=Math.pow(Math.pow(this.image.data[4*Dn+1],2)/255-an,2)/this.length,An+=Math.pow(Math.pow(this.image.data[4*Dn+2],2)/255-un,2)/this.length;else for(var Bn=0;Bn<this.length;Bn++)Sn+=Math.pow(this.image.data[4*Bn+0]-hn,2)/this.length,En+=Math.pow(this.image.data[4*Bn+1]-an,2)/this.length,An+=Math.pow(this.image.data[4*Bn+2]-un,2)/this.length;return[Sn=Math.sqrt(Sn),En=Math.sqrt(En),An=Math.sqrt(An)]}},{key:"blur",value:function(){var en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:5,Kt=new OffscreenCanvas(this.width,this.height),rn=Kt.getContext("2d");Kt.width=this.width,Kt.height=this.height,rn.putImageData(this.image,0,0),rn.filter="blur("+en+"px)",rn.drawImage(Kt,0,0);var hn=rn.getImageData(0,0,this.width,this.height);return hn}},{key:"threshold",value:function(en,Kt,rn){var hn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,an=arguments.length>4&&arguments[4]!==void 0&&arguments[4],un=new ImageData(this.image.data,this.width,this.height),Sn=0;if(an){var En=Sn;Sn=hn,hn=En}for(var An=0;An<this.length;An++)this.image.data[4*An+0]<en?un.data[4*An+0]=Sn:un.data[4*An+0]=hn,this.image.data[4*An+1]<Kt?un.data[4*An+1]=Sn:un.data[4*An+1]=hn,this.image.data[4*An+2]<rn?un.data[4*An+2]=Sn:un.data[4*An+2]=hn;return un}},{key:"powerFilter",value:function(en){var Kt=new Uint8ClampedArray(4*this.length);if(en===1)return this.image;for(var rn=0;rn<this.length;rn++)Kt[4*rn+0]=ht(this.image.data[4*rn+0],en),Kt[4*rn+1]=ht(this.image.data[4*rn+1],en),Kt[4*rn+2]=ht(this.image.data[4*rn+2],en),Kt[4*rn+3]=255;return new ImageData(Kt,this.width,this.height)}},{key:"sigmoidFilter",value:function(en){for(var Kt=new Uint8ClampedArray(4*this.length),rn=0;rn<this.length;rn++)Kt[4*rn+0]=at(this.image.data[4*rn+0],en),Kt[4*rn+1]=at(this.image.data[4*rn+1],en),Kt[4*rn+2]=at(this.image.data[4*rn+2],en),Kt[4*rn+3]=255;return new ImageData(Kt,this.width,this.height)}},{key:"weightedSum",value:function(en,Kt){for(var rn=new Uint8ClampedArray(4*this.length),hn=0;hn<this.length;hn++)rn[4*hn+0]=Kt*this.image.data[4*hn+0]+(1-Kt)*en.data[4*hn+0],rn[4*hn+1]=Kt*this.image.data[4*hn+1]+(1-Kt)*en.data[4*hn+1],rn[4*hn+2]=Kt*this.image.data[4*hn+2]+(1-Kt)*en.data[4*hn+2],rn[4*hn+3]=255;return new ImageData(rn,this.width,this.height)}},{key:"weightedSumMask",value:function(en,Kt){for(var rn=new Uint8ClampedArray(4*this.length),hn=0;hn<this.length;hn++){var an=Kt.data[4*hn]/255;rn[4*hn+0]=an*this.image.data[4*hn+0]+(1-an)*en.data[4*hn+0],rn[4*hn+1]=an*this.image.data[4*hn+1]+(1-an)*en.data[4*hn+1],rn[4*hn+2]=an*this.image.data[4*hn+2]+(1-an)*en.data[4*hn+2],rn[4*hn+3]=255}return new ImageData(rn,this.width,this.height)}}],Yt&&ft(jt.prototype,Yt),Object.defineProperty(jt,"prototype",{writable:!1}),Et}();function St(Et,jt){if(!(Et instanceof jt))throw new TypeError("Cannot call a class as a function")}function It(Et,jt){for(var Yt=0;Yt<jt.length;Yt++){var en=jt[Yt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}var xt=function(){function Et(){var en=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],Kt=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],rn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,hn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;St(this,Et),this.blurMask=en,this.smoothBorder=Kt,this.blurFactor=rn,this.smoothingFactor=hn,this.maskImage=null,this.net=null}var jt,Yt;return jt=Et,Yt=[{key:"loadModel",value:function(){var en=this;return new Promise(function(Kt,rn){bodyPix.load({architecture:"MobileNetV1",outputStride:16,multiplier:.75,quantBytes:2}).then(function(hn){en.net=hn,Kt()})})}},{key:"computeMask",value:function(en){var Kt=this;return new Promise(function(rn,hn){Kt.net.segmentPerson(en).then(function(an){Kt.width=an.width,Kt.height=an.height,Kt.length=Kt.width*Kt.height;for(var un=new Uint8ClampedArray(4*Kt.length),Sn=0;Sn<Kt.length;Sn++){var En=255*an.data[Sn];un[4*Sn+0]=En,un[4*Sn+1]=En,un[4*Sn+2]=En,un[4*Sn+3]=255}var An=document.createElement("canvas"),Dn=An.getContext("2d");An.width=Kt.width,An.height=Kt.height;var Bn=new ImageData(un,Kt.width,Kt.height);if(Dn.putImageData(Bn,0,0),Kt.blurMask&&(Dn.filter="blur("+Kt.blurFactor+"px)"),Dn.drawImage(An,0,0,Kt.width,Kt.height),Kt.maskImage=Dn.getImageData(0,0,Kt.width,Kt.height),Kt.blurMask)if(Kt.smoothBorder){if(Kt.smoothingFactor!==-1){var sr=new mt(Kt.maskImage,Kt.width,Kt.height);Kt.maskImage=sr.sigmoidFilter(Kt.smoothingFactor)}}else{var fr=new mt(Kt.maskImage,Kt.width,Kt.height);Kt.maskImage=fr.threshold(40,40,40,255,!1)}rn(Kt.maskImage)})})}},{key:"applyTransparency",value:function(en){var Kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Kt===null&&(Kt=this.maskImage);for(var rn=new Uint8ClampedArray(en.width*en.height*4),hn=0;hn<en.width*en.height;hn++)rn[4*hn+0]=en.data[4*hn+0],rn[4*hn+1]=en.data[4*hn+1],rn[4*hn+2]=en.data[4*hn+2],rn[4*hn+3]=Kt.data[4*hn];var an=new ImageData(rn,en.width,en.height);return an}},{key:"superposeImages",value:function(en,Kt,rn){var hn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;hn===null&&(hn=this.maskImage);var an=new mt(Kt,en.width,en.height),un=an.weightedSumMask(rn,hn);return un}},{key:"setBackground",value:function(en,Kt){var rn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.superposeImages(en,en,Kt,rn)}},{key:"blurBackground",value:function(en){var Kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,rn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,hn=new mt(en,en.width,en.height),an=hn.blur(Kt);return this.setBackground(en,an,rn)}}],Yt&&It(jt.prototype,Yt),Object.defineProperty(jt,"prototype",{writable:!1}),Et}();function At(Et,jt){if(!(Et instanceof jt))throw new TypeError("Cannot call a class as a function")}function Nt(Et,jt){for(var Yt=0;Yt<jt.length;Yt++){var en=jt[Yt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}var kt=tt.Y.get("StreamSegmentation"),Mt=apiCC.myWebRTC_Event,bt=function(){function Et(en){var Kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:480,rn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:360,hn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;At(this,Et),this.mediaStream=en,this.backgroundMode="none",this.backgroundBlurFactor=10,this.canvasWidth=Kt,this.canvasHeight=rn,this.length=this.canvasWidth*this.canvasHeight,this.userMediaStreamId=hn;for(var an=new Uint8ClampedArray(4*this.length),un=0;un<4*this.length;un++)an[un]=255;this.backgroundImage=new ImageData(an,this.canvasWidth,this.canvasHeight);var Sn=!0,En=!0,An=5,Dn=-1;this.backSub=new xt(Sn,En,An,Dn),this.modelLoaded=!1,this.maskStreamLaunched=!1,this.backgroundSubtractionActivated=!1}var jt,Yt;return jt=Et,Yt=[{key:"setBackgroundMode",value:function(en){this.backgroundMode=en}},{key:"setBackgroundImage",value:function(en){this.backgroundImage=en}},{key:"setBackgroundBlurFactor",value:function(en){this.backgroundBlurFactor=en}},{key:"loadModel",value:function(){kt.debug("Loading model");var en=this;return new Promise(function(Kt,rn){en.backSub.loadModel().then(function(hn){en.modelLoaded=!0,kt.debug("Model loaded"),Kt()})})}},{key:"getMaskStream",value:function(){var en=document.createElement("video");en.srcObject=this.mediaStream;var Kt=document.createElement("canvas"),rn=Kt.getContext("2d");Kt.width=this.canvasWidth,Kt.height=this.canvasHeight;var hn=document.createElement("canvas"),an=hn.getContext("2d");hn.width=this.canvasWidth,hn.height=this.canvasHeight;var un=this;en.addEventListener("loadeddata",function(){en.play(),requestAnimationFrame(Cr),un.modelLoaded?Bn=!0:un.loadModel().then(function(gr){Bn=!0})});for(var Sn=!0,En=new Uint8ClampedArray(4*this.length),An=0;An<4*this.length;An++)En[An]=255;var Dn=new ImageData(En,this.canvasWidth,this.canvasHeight);an.putImageData(Dn,0,0);var Bn=!1,sr=0,fr=!0;function Cr(){rn.drawImage(en,0,0,Kt.width,Kt.height);var gr=rn.getImageData(0,0,Kt.width,Kt.height);if(un.modelLoaded&&Sn&&Bn&&(fr||un.backgroundMode!=="none")){fr&&(fr=!1);var wr=new Date;Sn=!1,un.backSub.computeMask(gr).then(function(Nr){Sn=!0,1/((new Date-wr)/1e3)<1&&++sr>=10&&(Bn=!1,kt.error("The segmentation process cannot be handled"),Mt.createBackgroundSubstractionStopComputeTimeEvent(un.userMediaStreamId))})}un.modelLoaded&&un.backSub.maskImage!==null&&Bn?an.putImageData(un.backSub.maskImage,0,0):an.putImageData(Dn,0,0),un.continueMaskComputation?requestAnimationFrame(Cr):(kt.debug("Mask computation stoped"),un.continueMaskComputation=!0)}return this.continueMaskComputation=!0,this.maskMediaStream=hn.captureStream(),this.maskStreamLaunched=!0,this.maskMediaStream}},{key:"activateBackgroundSubtraction",value:function(){var en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(en!==null&&this.setBackgroundMode(en),this.backgroundSubtractionActivated)return this.processedMediaStream;this.maskStreamLaunched||this.getMaskStream();var Kt=document.createElement("video");Kt.srcObject=this.mediaStream;var rn=document.createElement("video");rn.srcObject=this.maskMediaStream;var hn=document.createElement("canvas"),an=hn.getContext("2d");hn.width=this.canvasWidth,hn.height=this.canvasHeight;var un=document.createElement("canvas"),Sn=un.getContext("2d");un.width=this.canvasWidth,un.height=this.canvasHeight,this.continueBackgroundSubtraction=!0;var En=this;function An(){an.drawImage(Kt,0,0,hn.width,hn.height);var Dn=an.getImageData(0,0,hn.width,hn.height);if(En.backgroundMode==="none")Sn.putImageData(Dn,0,0);else{an.drawImage(rn,0,0,hn.width,hn.height);var Bn=an.getImageData(0,0,hn.width,hn.height),sr=null;switch(En.backgroundMode){case"image":sr=En.backSub.setBackground(Dn,En.backgroundImage,Bn);break;case"blur":default:sr=En.backSub.blurBackground(Dn,En.backgroundBlurFactor,Bn);break;case"transparent":sr=En.backSub.applyTransparency(Dn,Bn)}Sn.putImageData(sr,0,0)}En.continueBackgroundSubtraction?requestAnimationFrame(An):(kt.debug("Mask application stoped"),En.continueBackgroundSubtraction=!0)}return Kt.addEventListener("loadeddata",function(){Kt.play(),rn.play(),requestAnimationFrame(An)}),this.processedMediaStream=un.captureStream(30),this.backgroundSubtractionActivated=!0,this.processedMediaStream}},{key:"deactivateBackgroundSubtraction",value:function(){this.setBackgroundMode("none"),this.processedMediaStream=this.mediaStream,this.backgroundSubtractionActivated=!1,this.continueBackgroundSubtraction=!1,this.maskMediaStream=null,this.maskStreamLaunched=!1,this.continueMaskComputation=!1}}],Yt&&Nt(jt.prototype,Yt),Object.defineProperty(jt,"prototype",{writable:!1}),Et}();function Bt(Et){return Bt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(jt){return typeof jt}:function(jt){return jt&&typeof Symbol=="function"&&jt.constructor===Symbol&&jt!==Symbol.prototype?"symbol":typeof jt},Bt(Et)}function Ht(Et,jt){for(var Yt=0;Yt<jt.length;Yt++){var en=jt[Yt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}function Wt(Et,jt){return Wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,en){return Yt.__proto__=en,Yt},Wt(Et,jt)}function nn(Et,jt){if(jt&&(Bt(jt)==="object"||typeof jt=="function"))return jt;if(jt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Yt){if(Yt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Yt}(Et)}function gn(Et){return gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(jt){return jt.__proto__||Object.getPrototypeOf(jt)},gn(Et)}var tn=tt.Y.get("OldMediaFilterBackgroundSubtraction"),Gt=function(Et){(function(an,un){if(typeof un!="function"&&un!==null)throw new TypeError("Super expression must either be null or a function");an.prototype=Object.create(un&&un.prototype,{constructor:{value:an,writable:!0,configurable:!0}}),Object.defineProperty(an,"prototype",{writable:!1}),un&&Wt(an,un)})(hn,Et);var jt,Yt,en,Kt,rn=(en=hn,Kt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var an,un=gn(en);if(Kt){var Sn=gn(this).constructor;an=Reflect.construct(un,arguments,Sn)}else an=un.apply(this,arguments);return nn(this,an)});function hn(){var an;return function(un,Sn){if(!(un instanceof Sn))throw new TypeError("Cannot call a class as a function")}(this,hn),(an=rn.call(this)).streamSegmentation=null,an.userMediaStreamId=null,an}return jt=hn,(Yt=[{key:"applyFilter",value:function(an,un){var Sn=this;tn.debug("Apply filter with descriptor:",un);var En=an.getAudioTracks();En.length>0&&En.forEach(function(Bn){an.removeTrack(Bn)});var An=an.getVideoTracks();if(An.length===0)return Promise.reject("MediaStream has no video tracks");var Dn=An[0].getSettings();return un.options!==void 0&&un.options.userMediaStreamId!==void 0&&(this.userMediaStreamId=un.options.userMediaStreamId),this.streamSegmentation=new bt(an,Dn.width,Dn.height,this.userMediaStreamId),this.loadTensorflow().then(function(Bn){return Sn.loadTensorflowModel()}).then(function(Bn){return new Promise(function(sr,fr){tn.debug("Model loading..."),Sn.streamSegmentation.loadModel().then(function(Cr){tn.debug("Model loaded");var gr=null;un.options!==void 0&&un.options.backgroundMode!==void 0&&(un.options.backgroundMode==="image"&&un.options.image instanceof ImageData&&Sn.streamSegmentation.setBackgroundImage(un.options.image),gr=un.options.backgroundMode);var wr=Sn.streamSegmentation.activateBackgroundSubtraction(gr);En.forEach(function(Nr){wr.addTrack(Nr)}),sr(wr)})})}).catch(function(Bn){return Promise.reject(Bn)})}},{key:"release",value:function(){this.streamSegmentation.deactivateBackgroundSubtraction(),this.streamSegmentation=null}},{key:"loadTensorflow",value:function(){return tn.debug("Tensorflow script loading..."),new Promise(function(an,un){var Sn={async:!0,numRetries:20,reqdelay:200,success:function(){tn.debug("Tensorflow script loaded"),an()},error:function(En){un("Resources loading failed, depsNotFound: "+En)},retrycb:function(En,An){tn.warn("Tensorflow loading retry :"+En+" ,delay before retry :"+An)}};apiCC.resourcesLoader.loadjs(["https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.2"],"tensorflow",Sn)})}},{key:"loadTensorflowModel",value:function(){return tn.debug("Tensorflow model script loading..."),new Promise(function(an,un){var Sn={async:!0,numRetries:20,reqdelay:200,success:function(){tn.debug("Tensorflow model script loaded"),an()},error:function(En){un("Resources loading failed, depsNotFound: "+En)},retrycb:function(En,An){tn.warn("Tensorflow model loading retry :"+En+" ,delay before retry :"+An)}};apiCC.resourcesLoader.loadjs(["https://cdn.jsdelivr.net/npm/@tensorflow-models/body-pix@2.0"],"tensorflow-model",Sn)})}}])&&Ht(jt.prototype,Yt),Object.defineProperty(jt,"prototype",{writable:!1}),hn}(pt);function fn(Et,jt){var Yt=typeof Symbol<"u"&&Et[Symbol.iterator]||Et["@@iterator"];if(!Yt){if(Array.isArray(Et)||(Yt=function(un,Sn){if(un){if(typeof un=="string")return Cn(un,Sn);var En=Object.prototype.toString.call(un).slice(8,-1);return En==="Object"&&un.constructor&&(En=un.constructor.name),En==="Map"||En==="Set"?Array.from(un):En==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(En)?Cn(un,Sn):void 0}}(Et))||jt&&Et&&typeof Et.length=="number"){Yt&&(Et=Yt);var en=0,Kt=function(){};return{s:Kt,n:function(){return en>=Et.length?{done:!0}:{done:!1,value:Et[en++]}},e:function(un){throw un},f:Kt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var rn,hn=!0,an=!1;return{s:function(){Yt=Yt.call(Et)},n:function(){var un=Yt.next();return hn=un.done,un},e:function(un){an=!0,rn=un},f:function(){try{hn||Yt.return==null||Yt.return()}finally{if(an)throw rn}}}}function Cn(Et,jt){(jt==null||jt>Et.length)&&(jt=Et.length);for(var Yt=0,en=new Array(jt);Yt<jt;Yt++)en[Yt]=Et[Yt];return en}function Tn(Et){return(Et[2]-Et[0])*(Et[3]-Et[1])}function dn(Et,jt){var Yt=Et[0],en=Et[1],Kt=Et[2],rn=Et[3],hn=jt[0],an=jt[1],un=jt[2],Sn=jt[3],En=Tn([Math.max(Yt,hn),Math.max(en,an),Math.min(Kt,un),Math.min(rn,Sn)]);return En/(Tn(Et)+Tn(jt)-En)}function mn(Et){var jt,Yt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.2,en=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,Kt=Et.yolo,rn={yolo:[]},hn=fn(Kt);try{for(hn.s();!(jt=hn.n()).done;){var an=jt.value,un=an.objectness;if(un>Yt)if(en!==null){var Sn,En=an.bounding_box,An=Tn(En),Dn=0,Bn=null,sr=0,fr=fn(Kt);try{for(fr.s();!(Sn=fr.n()).done;){var Cr=Sn.value,gr=Cr.bounding_box,wr=dn(En,gr);wr!==1&&wr>Dn&&(Dn=wr,Bn=Cr,sr=Tn(Cr.bounding_box))}}catch(Nr){fr.e(Nr)}finally{fr.f()}(Bn===null||Dn<en||sr<An)&&rn.yolo.push(an)}else rn.yolo.push(an)}}catch(Nr){hn.e(Nr)}finally{hn.f()}return rn}function yn(Et,jt){var Yt,en=Et.yolo,Kt={yolo:[]},rn=fn(jt.yolo);try{for(rn.s();!(Yt=rn.n()).done;){var hn,an=Yt.value,un=an.class,Sn=an.bounding_box,En=an.objectness,An=En,Dn=fn(en);try{for(Dn.s();!(hn=Dn.n()).done;){var Bn=hn.value;if(Bn.class===un){var sr=dn(Bn.bounding_box,Sn);sr>0&&(An=En+.75*(1-En)*sr*Bn.objectness)}}}catch(Cr){Dn.e(Cr)}finally{Dn.f()}var fr={class:un,objectness:An,bounding_box:Sn};Kt.yolo.push(fr)}}catch(Cr){rn.e(Cr)}finally{rn.f()}return Kt}function pn(Et,jt){return function(Yt){if(Array.isArray(Yt))return Yt}(Et)||function(Yt,en){var Kt=Yt==null?null:typeof Symbol<"u"&&Yt[Symbol.iterator]||Yt["@@iterator"];if(Kt!=null){var rn,hn,an=[],un=!0,Sn=!1;try{for(Kt=Kt.call(Yt);!(un=(rn=Kt.next()).done)&&(an.push(rn.value),!en||an.length!==en);un=!0);}catch(En){Sn=!0,hn=En}finally{try{un||Kt.return==null||Kt.return()}finally{if(Sn)throw hn}}return an}}(Et,jt)||function(Yt,en){if(Yt){if(typeof Yt=="string")return In(Yt,en);var Kt=Object.prototype.toString.call(Yt).slice(8,-1);return Kt==="Object"&&Yt.constructor&&(Kt=Yt.constructor.name),Kt==="Map"||Kt==="Set"?Array.from(Yt):Kt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Kt)?In(Yt,en):void 0}}(Et,jt)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function In(Et,jt){(jt==null||jt>Et.length)&&(jt=Et.length);for(var Yt=0,en=new Array(jt);Yt<jt;Yt++)en[Yt]=Et[Yt];return en}function On(Et,jt){for(var Yt=0;Yt<jt.length;Yt++){var en=jt[Yt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}s(3123),s(4723),s(2472),s(6699),s(2023),s(9720),s(9600),s(2707),s(1058);var _n=tt.Y.get("StreamAIE"),Mn=apiCC.myWebRTC_Event,Nn=function(){function Et(en,Kt){(function(hn,an){if(!(hn instanceof an))throw new TypeError("Cannot call a class as a function")})(this,Et),this.mediaStream=en,this.descriptorOptions=Kt,this.modelName=Kt.modelName,this.maxBoxes=Kt.maxBoxes||null,this.scoreThresh=Kt.scoreThresh||null,this.forceReload=Kt.forceReload||!1,this.classFilter=this.descriptorOptions.classFilter||"all",this.drawingConfig=this.descriptorOptions.drawingConfig||{},this.userMediaStreamId=Kt.userMediaStreamId,this.clientId=Kt.clientId;var rn=this.mediaStream.getVideoTracks();rn.length===0&&(this.mediaSettings=null),this.mediaSettings=rn[0].getSettings(),this.canvasWidth=this.mediaSettings.width||480,this.canvasHeight=this.mediaSettings.height||480,this.length=this.canvasWidth*this.canvasHeight,this.snapshot=!1,this.log=!1,this.minSnapshotPeriod=0,this.memoryTime=0,this.lastAnnotations={yolo:[]},this.lastRawAnnotations={yolo:[]},this.objectDetectionActivated=!1,this.drawAnnotationsBool=!1,this.aieUrl=null,this.token=null,this.loadedModel=null,this.promises=[],this.isReleased=!1,this.resinzingSize=416,this.callId=null}var jt,Yt;return jt=Et,Yt=[{key:"activateLogs",value:function(){var en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.memoryTime=en,this.log=!0}},{key:"stopLogs",value:function(){this.log=!1,this.memoryTime=0}},{key:"activateSnapshots",value:function(){var en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.snapshot=!0,this.minSnapshotPeriod=en}},{key:"stopSnapshots",value:function(){this.snapshot=!1,this.minSnapshotPeriod=0}},{key:"activateAnnotations",value:function(){this.lastAnnotations={yolo:[]},this.drawAnnotationsBool=!0,this.getAnnotations()}},{key:"stopAnnotations",value:function(){this.drawAnnotationsBool=!1}},{key:"getAnnotations",value:function(){var en=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],Kt=document.createElement("video");Kt.srcObject=this.mediaStream;var rn=document.createElement("canvas"),hn=rn.getContext("2d");rn.width=this.canvasWidth,rn.height=this.canvasHeight;var an=document.createElement("canvas"),un=an.getContext("2d");an.width=this.canvasWidth,an.height=this.canvasHeight;var Sn=this;function En(Sr,Dr){for(var Er=Sr.split(","),Or=Er[0].match(/:(.*?);/)[1],Lr=atob(Er[1]),Hr=Lr.length,na=new Uint8Array(Hr);Hr--;)na[Hr]=Lr.charCodeAt(Hr);return new File([na],Dr,{type:Or})}Kt.addEventListener("loadeddata",function(){Kt.play(),requestAnimationFrame(function(){Qr(Sn.aieUrl,Sn.token,Sn.loadedModel)})});var An=!0,Dn={},Bn=null,sr=new Date;function fr(Sr,Dr,Er){var Or=En(rn.toDataURL("image/jpeg")),Lr={pipelineCallId:Sn.getOrCreatePipeline(),file:Or,transferType:"plugin",pluginName:"httpPost",pluginData:{url:Sr,headers:{Authorization:"Token "+Dr},formData:{file:"$DATA",angled:1,model:Er,size:Sn.resinzingSize}}};apiCC.session.apiCCWebRTCClient.webRTCClient.pushData(null,Lr,null,{success:function(Hr){var na=(new Date-Bn)/1e3,Vn=1/na;return _n.debug("Computation time:",na,"s ,FPS:",Vn),Qr(Sr,Dr,Er),Hr.data.error!==void 0?_n.error("http post error :",Hr.data.error):Hr.data.result===void 0?_n.error("An error occured when trying to annotate a snapshot"):void Cr(Hr.data)},failure:function(Hr,na,Vn){_n.error("## pushData:failure",na,Vn,Hr)}})}function Cr(Sr){var Dr=Sr.result;Sn.isReleased||(Sn.lastRawAnnotations=Dr,Dr.yolo!==void 0&&wr(Dr),Dr.ocr===void 0&&Dr.codes===void 0||gr(Dr))}function gr(Sr){Sn.lastAnnotations={ocr:Sr.ocr,codes:Sr.codes};var Dr="";if(Sr.ocr.length>1){Dr+="Words found : ";for(var Er=0;Er<Sr.ocr.length;Er++)Dr=Dr+Sr.ocr[Er].text+", "}if(Sr.codes.length>1){Dr+="Codes found : ";for(var Or=0;Or<Sr.codes.length;Or++)Dr=Dr+Sr.codes[Or].code+", "}Nr(Dr),qr()}function wr(Sr){Sr.yolo.length>0&&(en&&(Sr=yn(Sn.lastRawAnnotations,Sr)),Sn.scoreThresh!==null&&(Sr=mn(Sr,Sn.scoreThresh)));for(var Dr={yolo:[]},Er={},Or=Sn.classFilter.split(", "),Lr=0;Lr<Sr.yolo.length;Lr++){var Hr=Sr.yolo[Lr];(Sn.classFilter==="all"||Or.includes(Hr.class))&&(Hr.class in Er||(Er[Hr.class]=0),Er[Hr.class]+=1,Dr.yolo.push(Hr))}if(Sr=Dr,Sn.lastAnnotations=Sr,Sn.log||Sn.snapshot){for(var na=new Date,Vn=[],zn=0,Zn=Object.entries(Er);zn<Zn.length;zn++){var Rr=pn(Zn[zn],2),Gn=Rr[0],jr=Rr[1];Vn.push(jr+" "+Gn+"(s) detected."),(!(Gn in Dn)||na-Dn[Gn]>1e3*Sn.memoryTime)&&(Dn[Gn]=na)}var xr=Vn.sort().join(" ");xr!==""&&(Nr(xr),qr())}}function Nr(Sr){Sn.log&&Mn.createAIELogEvent(Sn.userMediaStreamId,Sr)}function qr(){if(Sn.snapshot){var Sr=new Date,Dr=hn.getImageData(0,0,rn.width,rn.height);if(Sr-sr>1e3*Sn.minSnapshotPeriod){un.putImageData(Dr,0,0),Sn.drawAnnotations(Sn.lastAnnotations,un,Sn.drawingConfig);var Er=an.toDataURL("image/png"),Or=new Image;Or.src=Er,Mn.createAIESnapshotEvent(Sn.userMediaStreamId,Or),sr=Sr}}}function Qr(Sr,Dr,Er){hn.drawImage(Kt,0,0,rn.width,rn.height),(An||Sn.drawAnnotationsBool)&&(An&&(An=!1),Bn=new Date,fr(Sr,Dr,Er))}}},{key:"getOrCreatePipeline",value:function(){if(this.callId!==null)return this.callId;var en=this;return this.callId=apiCC.session.apiCCWebRTCClient.webRTCClient.pushData(null,{transferType:"pipeline"},null,{failure:function(Kt){Kt==="dataChannelClosed"?(_n.debug("dataChannelClosed : no activity on dataChannel timeout"),en.callId=null):_n.error("dataChannel failure",Kt)}}),this.callId}},{key:"drawAnnotations",value:function(en,Kt){var rn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},hn=rn.color||"#ED5131",an=rn.textColor||"#FFFFFF",un=rn.colorMap||null,Sn=Object.prototype.hasOwnProperty.call(rn,Sn)?rn.lineWidth:3,En=rn.font||"15px Arial";if(en.yolo!==void 0&&en.yolo.length>0)for(var An=0;An<en.yolo.length;An++){var Dn=en.yolo[An],Bn=Dn.bounding_box,sr=Bn[0],fr=Bn[1],Cr=Bn[2],gr=Bn[3];this.modelName==="mask_augmented_refined"&&(Cr-=sr,gr-=fr);var wr=hn;un!==null&&Dn.class in un&&(wr=un[Dn.class]),Kt.lineWidth=Sn,Kt.strokeStyle=wr,Kt.strokeRect(sr,fr,Cr,gr),Kt.font=En;var Nr=parseInt(En,10),qr=Dn.class,Qr=Kt.measureText(qr).width;Kt.fillStyle=wr,Kt.fillRect(sr-Sn/2,fr-Math.round(4*Nr/3),Qr+Nr+Sn,Math.round(4*Nr/3)),Kt.fillStyle=an,Kt.fillText(qr,sr+Math.round(Nr/2)-Sn/2,fr-Math.round(Nr/2))}if(en.ocr!==void 0&&en.ocr.length>0){En=rn.font||"25px Arial";for(var Sr=0;Sr<en.ocr.length;Sr++){var Dr=en.ocr[Sr],Er=Dr.bounding_box,Or=Er[0],Lr=Er[1],Hr=Er[2],na=Er[3];this.modelName==="mask_augmented_refined"&&(Hr-=Or,na-=Lr),Kt.lineWidth=Sn,Kt.strokeStyle=hn,Kt.strokeRect(Or,Lr,Hr,na),Kt.font=En;var Vn=parseInt(En,10),zn=Dr.text,Zn=Kt.measureText(zn).width;Kt.fillStyle=hn,Kt.fillRect(Or-Sn/2,Lr-Math.round(4*Vn/3),Zn+Vn+Sn,Math.round(4*Vn/3)),Kt.fillStyle=an,Kt.fillText(zn,Or+Math.round(Vn/2)-Sn/2,Lr-Math.round(Vn/2))}}if(en.codes!==void 0&&en.codes.length>0){En=rn.font||"25px Arial";for(var Rr=0;Rr<en.codes.length;Rr++){var Gn=en.codes[Rr],jr=Gn.bounding_box,xr=jr[0],Ir=jr[1],jn=jr[2],pr=jr[3];this.modelName==="mask_augmented_refined"&&(jn-=xr,pr-=Ir),Kt.lineWidth=Sn,Kt.strokeStyle=hn,Kt.strokeRect(xr,Ir,jn,pr),Kt.font=En;var _r=parseInt(En,10),yr=Gn.code,Kr=Kt.measureText(yr).width;Kt.fillStyle=hn,Kt.fillRect(xr-Sn/2,Ir-Math.round(4*_r/3),Kr+_r+Sn,Math.round(4*_r/3)),Kt.fillStyle=an,Kt.fillText(yr,xr+Math.round(_r/2)-Sn/2,Ir-Math.round(_r/2))}}}},{key:"activateObjectDetection",value:function(){if(this.objectDetectionActivated)return this.processedMediaStream;var en=document.createElement("video");en.srcObject=this.mediaStream;var Kt=document.createElement("canvas"),rn=Kt.getContext("2d");Kt.width=this.canvasWidth,Kt.height=this.canvasHeight;var hn=document.createElement("canvas"),an=hn.getContext("2d");hn.width=this.canvasWidth,hn.height=this.canvasHeight;var un=this;function Sn(){rn.drawImage(en,0,0,Kt.width,Kt.height);var En=rn.getImageData(0,0,Kt.width,Kt.height);an.putImageData(En,0,0),un.drawAnnotationsBool&&un.drawAnnotations(un.lastAnnotations,an,un.drawingConfig),requestAnimationFrame(Sn)}return en.addEventListener("loadeddata",function(){en.play(),requestAnimationFrame(Sn)}),this.processedMediaStream=hn.captureStream(),this.objectDetectionActivated=!0,this.processedMediaStream}},{key:"loadModel",value:function(){var en=this;return new Promise(function(Kt,rn){_n.debug("loading model");var hn={modelName:en.modelName,maxBoxes:en.maxBoxes,scoreThresh:en.scoreThresh,forceReload:en.forceReload};en.sendMessage(hn,"AIELoadModel",Kt,rn)})}},{key:"sendMessage",value:function(en,Kt,rn,hn){var an=setTimeout(hn,5e3);this.promises.push({timeout:an,resolve:rn}),en.timeout=an,this.sendMessageToCCS(en,Kt)}},{key:"sendMessageToCCS",value:function(en,Kt){if(en.userMediaStreamId=this.userMediaStreamId,en.clientId=this.clientId,en.data={pubSub:"AieConnector"},en.type=Kt,apiCC!==void 0){var rn=apiCC.session.apiCCWebRTCClient.webRTCClient.socket;try{var hn=JSON.stringify(en);rn.emit(Kt,hn)}catch(an){_n.error("JSON Stringify error : ",an)}}}},{key:"modelLoaded",value:function(en){_n.debug("Loaded model name :",en.modelName),this.aieUrl=en.url,this.loadedModel=en.modelName,this.token=en.token;var Kt=this.activateObjectDetection();this.promises.forEach(function(rn){en.timeout===rn.timeout&&(clearTimeout(rn.timeout),rn.resolve(Kt))})}},{key:"release",value:function(){this.isReleased=!0,this.stopLogs(),this.stopSnapshots(),this.stopAnnotations(),this.sendMessageToCCS({},"AIELogout")}}],Yt&&On(jt.prototype,Yt),Object.defineProperty(jt,"prototype",{writable:!1}),Et}();function wn(Et){return wn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(jt){return typeof jt}:function(jt){return jt&&typeof Symbol=="function"&&jt.constructor===Symbol&&jt!==Symbol.prototype?"symbol":typeof jt},wn(Et)}function Pn(Et,jt){for(var Yt=0;Yt<jt.length;Yt++){var en=jt[Yt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}function Fn(Et,jt){return Fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,en){return Yt.__proto__=en,Yt},Fn(Et,jt)}function ar(Et,jt){if(jt&&(wn(jt)==="object"||typeof jt=="function"))return jt;if(jt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Yt){if(Yt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Yt}(Et)}function Yn(Et){return Yn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(jt){return jt.__proto__||Object.getPrototypeOf(jt)},Yn(Et)}var Xn=tt.Y.get("MediaFilterAIE"),tr=function(Et){(function(an,un){if(typeof un!="function"&&un!==null)throw new TypeError("Super expression must either be null or a function");an.prototype=Object.create(un&&un.prototype,{constructor:{value:an,writable:!0,configurable:!0}}),Object.defineProperty(an,"prototype",{writable:!1}),un&&Fn(an,un)})(hn,Et);var jt,Yt,en,Kt,rn=(en=hn,Kt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var an,un=Yn(en);if(Kt){var Sn=Yn(this).constructor;an=Reflect.construct(un,arguments,Sn)}else an=un.apply(this,arguments);return ar(this,an)});function hn(){var an;return function(un,Sn){if(!(un instanceof Sn))throw new TypeError("Cannot call a class as a function")}(this,hn),(an=rn.call(this)).userMediaStreamId=null,an.streamAIE=null,an}return jt=hn,(Yt=[{key:"applyFilter",value:function(an,un){var Sn=this;return new Promise(function(En,An){if(Xn.debug("Apply filter with descriptor :",un),un.options===void 0&&An("Filter options object required"),un.options.modelName===void 0)An("modelName options required");else{var Dn=an.getAudioTracks();Dn.length>0&&Dn.forEach(function(Bn){an.removeTrack(Bn)}),Sn.streamAIE=new Nn(an,un.options),Sn.streamAIE.loadModel().then(function(Bn){Dn.forEach(function(sr){Bn.addTrack(sr)}),En(Bn)}).catch(function(Bn){An(Bn)})}})}},{key:"release",value:function(){this.streamAIE.release()}}])&&Pn(jt.prototype,Yt),Object.defineProperty(jt,"prototype",{writable:!1}),hn}(pt);function cn(Et){return cn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(jt){return typeof jt}:function(jt){return jt&&typeof Symbol=="function"&&jt.constructor===Symbol&&jt!==Symbol.prototype?"symbol":typeof jt},cn(Et)}function Hn(Et,jt){for(var Yt=0;Yt<jt.length;Yt++){var en=jt[Yt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}function Qn(Et,jt){return Qn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Yt,en){return Yt.__proto__=en,Yt},Qn(Et,jt)}function or(Et,jt){if(jt&&(cn(jt)==="object"||typeof jt=="function"))return jt;if(jt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Yt){if(Yt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Yt}(Et)}function Wn(Et){return Wn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(jt){return jt.__proto__||Object.getPrototypeOf(jt)},Wn(Et)}var ir=tt.Y.get("MediaFilterBackgroundSubstraction"),nr=function(Et){(function(an,un){if(typeof un!="function"&&un!==null)throw new TypeError("Super expression must either be null or a function");an.prototype=Object.create(un&&un.prototype,{constructor:{value:an,writable:!0,configurable:!0}}),Object.defineProperty(an,"prototype",{writable:!1}),un&&Qn(an,un)})(hn,Et);var jt,Yt,en,Kt,rn=(en=hn,Kt=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var an,un=Wn(en);if(Kt){var Sn=Wn(this).constructor;an=Reflect.construct(un,arguments,Sn)}else an=un.apply(this,arguments);return or(this,an)});function hn(){var an;return function(un,Sn){if(!(un instanceof Sn))throw new TypeError("Cannot call a class as a function")}(this,hn),(an=rn.call(this)).mediaStream=null,an.mediaStreamSettings=null,an.processedMediaStream=null,an.net=null,an.lossRatio=null,an.processBackground=!1,an.bgImageData=null,an.videoElement=document.createElement("video"),an.canvas=document.createElement("canvas"),an.canvasContext=an.canvas.getContext("2d"),an}return jt=hn,(Yt=[{key:"applyFilter",value:function(an,un){var Sn=this;return new Promise(function(En,An){var Dn=an.getAudioTracks();Dn.length>0&&Dn.forEach(function(Bn){an.removeTrack(Bn)}),Sn.loadTensorflow().then(function(){Sn.loadTensorflowModel().then(function(){Sn.videoElement.srcObject=an;var Bn=Sn;Sn.videoElement.addEventListener("loadeddata",function(){Bn.videoElement.play(),Bn.mediaStream=an,Bn.descriptors=un,Bn.processedMediaStream=Bn.canvas.captureStream(),Bn.mediaStreamSettings=Bn.mediaStream.getVideoTracks()[0].getSettings(),Bn.videoElement.height=240,Bn.lossRatio=Bn.mediaStreamSettings.height/Bn.videoElement.height,Bn.videoElement.width=Bn.videoElement.height*Bn.mediaStreamSettings.aspectRatio,Bn.videoElement.onplaying=function(){Bn.canvas.height=Bn.videoElement.videoHeight,Bn.canvas.width=Bn.videoElement.videoWidth},Bn.loadBodyPix().then(function(){Dn.forEach(function(sr){Bn.processedMediaStream.addTrack(sr)}),En(Bn.processedMediaStream)}).catch(function(sr){ir.error(sr)})})}).catch(function(Bn){ir.error(Bn)})}).catch(function(Bn){ir.error(Bn)})})}},{key:"loadTensorflow",value:function(){return ir.debug("Tensorflow script loading..."),new Promise(function(an,un){var Sn={async:!0,numRetries:20,reqdelay:200,success:function(){ir.debug("Tensorflow script loaded"),an()},error:function(En){un("Resources loading failed, depsNotFound: "+En)},retrycb:function(En,An){ir.warn("Tensorflow loading retry :"+En+" ,delay before retry :"+An)}};apiCC.resourcesLoader.loadjs(["https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.2"],"tensorflow",Sn)})}},{key:"loadTensorflowModel",value:function(){return ir.debug("Tensorflow model script loading..."),new Promise(function(an,un){var Sn={async:!0,numRetries:20,reqdelay:200,success:function(){ir.debug("Tensorflow model script loaded"),an()},error:function(En){un("Resources loading failed, depsNotFound: "+En)},retrycb:function(En,An){ir.warn("Tensorflow model loading retry :"+En+" ,delay before retry :"+An)}};apiCC.resourcesLoader.loadjs(["https://cdn.jsdelivr.net/npm/@tensorflow-models/body-pix@2.0"],"tensorflow-model",Sn)})}},{key:"loadBodyPix",value:function(){var an=this;return new Promise(function(un,Sn){bodyPix.load({multiplier:.75,stride:32,quantBytes:4}).then(function(En){an.net=En,an.perform(),un()}).catch(function(En){return Sn(En)})})}},{key:"perform",value:function(){if(this.descriptors.options!==void 0&&this.descriptors.options.backgroundMode!==void 0)switch(this.processBackground=!0,this.descriptors.options.backgroundMode){case"blur":ir.warn("This method is deprecated, please use Stream#blur method now."),this.videoElement.height=this.mediaStreamSettings.height,this.videoElement.width=this.mediaStreamSettings.width,this.canvas.height=this.videoElement.height,this.canvas.width=this.videoElement.width,this.blurBackground();break;case"transparent":this.noBackground();break;case"image":this.descriptors.options.image!==void 0?(this.resizeImageData(this.descriptors.options.image),this.imageBackground()):ir.error("image option is required when creating the filter");break;default:ir.debug("The backgroundMode : ",this.descriptors.options.backgroundMode," is not implemented. Refer to documentation for accepted values."),this.blurBackground()}else ir.error("backgroundMode option is required")}},{key:"blurBackground",value:function(){var an=this;this.net.segmentPerson(this.videoElement).then(function(un){an.blurBackground(),bodyPix.drawBokehEffect(an.canvas,an.videoElement,un,9,2,!1)})}},{key:"noBackground",value:function(){var an=this;this.net.segmentPerson(this.videoElement).then(function(un){an.canvasContext.drawImage(an.videoElement,0,0,an.videoElement.width,an.videoElement.height);for(var Sn=an.canvasContext.getImageData(0,0,an.videoElement.width,an.videoElement.height),En=Sn.data,An=0;An<En.length;An+=4)un.data[An/4]===0&&(En[An+3]=0);var Dn=an.scaleImageData(Sn,an.lossRatio);an.canvasContext.imageSmoothingEnabled=!0,an.canvasContext.putImageData(Dn,0,0),an.processBackground&&an.noBackground()})}},{key:"imageBackground",value:function(){var an=this;this.net.segmentPerson(this.videoElement).then(function(un){an.canvasContext.putImageData(an.bgImageData,0,0,0,0,an.videoElement.width,an.videoElement.height);var Sn=an.canvasContext.getImageData(0,0,an.videoElement.width,an.videoElement.height);an.canvasContext.drawImage(an.videoElement,0,0,an.videoElement.width,an.videoElement.height);for(var En=an.canvasContext.getImageData(0,0,an.videoElement.width,an.videoElement.height),An=En.data,Dn=0;Dn<An.length;Dn+=4)un.data[Dn/4]===0&&(An[Dn]=Sn.data[Dn],An[Dn+1]=Sn.data[Dn+1],An[Dn+2]=Sn.data[Dn+2],An[Dn+3]=Sn.data[Dn+3]);var Bn=an.scaleImageData(En,an.lossRatio);an.canvasContext.imageSmoothingEnabled=!0,an.canvasContext.putImageData(Bn,0,0),an.processBackground&&an.imageBackground()})}},{key:"resizeImageData",value:function(an){var un=this.videoElement.width/an.width,Sn=this.videoElement.height/an.height;this.bgImageData=un>=Sn?this.scaleImageData(an,un):this.scaleImageData(an,Sn)}},{key:"noBackgroundWithFullResolution",value:function(){var an=this;this.net.segmentPerson(this.videoElement).then(function(un){an.canvasContext.drawImage(an.videoElement,0,0,an.canvas.width,an.canvas.height);for(var Sn=an.canvasContext.getImageData(0,0,an.canvas.width,an.canvas.height),En=new Uint8ClampedArray(4*un.width*un.height),An=0;An<En.length;An+=4)un.data[An/4]!==0&&(En[An+3]=255);var Dn=new ImageData(En,un.width,un.height);Dn=an.scaleImageData(Dn,an.lossRatio);for(var Bn=0;Bn<Sn.data.length;Bn+=4)Dn.data[Bn+3]===0&&(Sn.data[Bn+3]=0);an.canvasContext.imageSmoothingEnabled=!0,an.canvasContext.putImageData(Sn,0,0),an.processBackground&&an.noBackgroundWithFullResolution()})}},{key:"scaleImageData",value:function(an,un){var Sn=document.createElement("canvas");Sn.width=an.width,Sn.height=an.height,Sn.getContext("2d").putImageData(an,0,0);var En=document.createElement("canvas");En.width=this.canvas.width,En.height=this.canvas.height;var An=En.getContext("2d");return An.scale(un,un),An.drawImage(Sn,0,0),An.getImageData(0,0,En.width,En.height)}},{key:"release",value:function(){this.processedMediaStream=this.mediaStream,this.processBackground=!1}}])&&Hn(jt.prototype,Yt),Object.defineProperty(jt,"prototype",{writable:!1}),hn}(pt);function xn(Et,jt){for(var Yt=0;Yt<jt.length;Yt++){var en=jt[Yt];en.enumerable=en.enumerable||!1,en.configurable=!0,"value"in en&&(en.writable=!0),Object.defineProperty(Et,en.key,en)}}var Un=tt.Y.get("MediaFilterManager"),vn=apiCC.myWebRTC_Event,kn={oldBackgroundSubtraction:Gt,AIEFilter:tr,backgroundSubtraction:nr},qt=function(){function Et(en,Kt,rn){(function(hn,an){if(!(hn instanceof an))throw new TypeError("Cannot call a class as a function")})(this,Et),this.mediaStream=en,this.descriptors=Kt,this.userMediaStreamId=rn,this.filters={}}var jt,Yt;return jt=Et,(Yt=[{key:"getOrCreateFilter",value:function(en){if(this.filters[en.type]!==void 0)return this.filters[en.type];var Kt=kn[en.type];if(Kt===void 0)return Un.error("Unknown filter type: "+en.type),null;var rn=new Kt;return this.filters[rn]=rn,rn}},{key:"applyFilters",value:function(){var en=this;if(Un.info("Apply filters",this.descriptors),!Array.isArray(this.descriptors)||this.descriptors.length===0)return Un.error("No filter can be applied, filter descriptors have wrong format, it should be an array and contain at least one element",this.descriptors),Promise.reject(this.mediaStream);var Kt=Promise.resolve(this.mediaStream);return this.descriptors.forEach(function(rn){var hn=en.getOrCreateFilter(rn);hn!==null?(rn.options!==void 0&&(rn.options.userMediaStreamId=en.userMediaStreamId,rn.options.clientId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId),Kt=Kt.then(function(an){return hn.applyFilter(an,rn)})):Un.error("Filter "+rn.type+" will be skipped. No implemented filter has this type")}),Un.info("Filters attached"),document.addEventListener("visibilitychange",function(){en.createBackgroundSubstractionStopVisibilityChangeEvent(en.userMediaStreamId)}),Kt.catch(function(rn){return Un.error(rn)}),Kt}},{key:"createBackgroundSubstractionStopVisibilityChangeEvent",value:function(en){document.hidden&&vn.createBackgroundSubstractionStopVisibilityChangeEvent(en)}},{key:"release",value:function(){Object.values(this.filters).forEach(function(en){en.release()}),document.removeEventListener("visibilitychange",this.createBackgroundSubstractionStopVisibilityChangeEvent),this.filters=null,this.mediaStream=null}}])&&xn(jt.prototype,Yt),Object.defineProperty(jt,"prototype",{writable:!1}),Et}();function Rt(Et){return Rt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(jt){return typeof jt}:function(jt){return jt&&typeof Symbol=="function"&&jt.constructor===Symbol&&jt!==Symbol.prototype?"symbol":typeof jt},Rt(Et)}function nt(Et,jt){var Yt=typeof Symbol<"u"&&Et[Symbol.iterator]||Et["@@iterator"];if(!Yt){if(Array.isArray(Et)||(Yt=function(un,Sn){if(un){if(typeof un=="string")return vt(un,Sn);var En=Object.prototype.toString.call(un).slice(8,-1);return En==="Object"&&un.constructor&&(En=un.constructor.name),En==="Map"||En==="Set"?Array.from(un):En==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(En)?vt(un,Sn):void 0}}(Et))||jt&&Et&&typeof Et.length=="number"){Yt&&(Et=Yt);var en=0,Kt=function(){};return{s:Kt,n:function(){return en>=Et.length?{done:!0}:{done:!1,value:Et[en++]}},e:function(un){throw un},f:Kt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var rn,hn=!0,an=!1;return{s:function(){Yt=Yt.call(Et)},n:function(){var un=Yt.next();return hn=un.done,un},e:function(un){an=!0,rn=un},f:function(){try{hn||Yt.return==null||Yt.return()}finally{if(an)throw rn}}}}function vt(Et,jt){(jt==null||jt>Et.length)&&(jt=Et.length);for(var Yt=0,en=new Array(jt);Yt<jt;Yt++)en[Yt]=Et[Yt];return en}var Tt=tt.Y.get("ApiCCUserMediaStream"),Pt=apiCC.myWebRTC_Event,wt="getUserMediaAccessAllowed",Dt=function(){Number.MAX_SAFE_INTEGER!==void 0?this.userMediaStreamId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString():this.userMediaStreamId=Math.floor(1000001*Math.random()).toString(),ot.Xh==="Edge"&&ot.PR>=15&&apiRTC.browserDetails.type!=="chrome"?this.gum_config={audio:!0,video:!0}:ot.Xh==="Chrome"&&ot.PR<49||ot.Xh==="Firefox"&&ot.PR<50?this.gum_config={audio:{mandatory:{},optional:[]},video:{mandatory:{},optional:[]}}:this.gum_config={audio:{},video:{}},this.inputs={},this.callbacks={},this.callType=null,this.audio=!1,this.audioDeviceLabel=null,this.audioMuted=!1,this.audioSilent=!1,this.video=!1,this.videoDeviceLabel=null,this.videoMuted=!1,this.videoSilent=!1,this.stream=null,this.streamStolen=!1,this.notifyUserMediaSuccess=!0,this.notifyUserMediaStop=!0,apiCC.session!==null&&apiCC.session!==void 0?this.tryAudioCallAfterUserMediaError=apiCC.session.tryAudioCallAfterUserMediaError:this.tryAudioCallAfterUserMediaError=!1,this.callInfoList=[],this.iOSMediaSelectionWorkAroundApplied=!1,this.getUserMediaTimeoutId=null,ct.wL.type==="chrome"&&ct.wL.version>=72&&ct.wL.version<=73?this.displayMediaStreamConstraints={video:!0,audio:!1}:this.displayMediaStreamConstraints={video:!0,audio:!0},this.forceExtensionOnChrome=!1,this.filters=null,this.mediaFilterManager=null,this.videoSettings=!1,this.getVideoTrack=function(){if(!this.stream||typeof this.stream.getVideoTracks!="function")return null;var Et=this.stream.getVideoTracks();return Et&&Et.length===1?Et[0]:null},this.release=function(){var Et=0,jt=null,Yt=null,en=null;if(Tt.debug("[ApiCCUserMediaStream] release; userMediaStreamId: "+this.userMediaStreamId),this.mediaFilterManager!==null&&(this.mediaFilterManager.release(),this.mediaFilterManager=null),apiCC.audioProcessor.stopAudioNodeCtx(this.nodeCtx),this.stream!==null){if(this.streamStolen!==!0)if(typeof cordova<"u"&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0)cordova!==void 0&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0&&(Tt.debug("[ApiCCUserMediaStream] release on iosrtc cordova"),this.stream.onended=null);else if(ot.Xh==="Chrome"&&ot.PR<45||ot.Xh==="Firefox"&&ot.PR<44||ot.Xh==="Opera"&&ot.PR<34||ot.Xh==="Chromium"&&ot.PR<44||ot.Xh==="Chrome WebView"&&ot.PR<45)this.stream.onended=null,this.stream.stop();else for(this.stream.onended=null,Et=(jt=this.stream.getTracks()).length;--Et>=0;)jt[Et].onended=null,jt[Et].stop();this.stream=null,this.streamStolen=!1,this.notifyUserMediaStop===!0&&((en=this.getOwnerCallInfo())!==null&&(Yt=en.callId),Pt.createUserMediaStopEvent(Yt,this.callType,this.userMediaStreamId)),this.callbacks.release(this)}},this.getUserMedia=function(){var Et=this;if(Tt.debug("[ApiCCUserMediaStream] getUserMedia; userMediaStreamId: "+this.userMediaStreamId),this.stream===null)try{if(this.callType==="media")this.gum_config=apiCC.setAudioSourceIdInConstraint(this.inputs.audioSourceId,this.gum_config),this.gum_config=apiCC.setVideoSourceIdInConstraint(this.inputs.videoSourceId,this.gum_config),this.gum_config=apiCC.setVideoFacingModeInConstraint(this.inputs.facingMode,this.gum_config);else if(this.callType==="audio")this.gum_config=apiCC.setAudioSourceIdInConstraint(this.inputs.audioSourceId,this.gum_config),this.gum_config.video=!1;else{if(this.callType!=="videoOnly")return function(jt){for(var Yt=apiCC.userMediaStreamTable.length;--Yt>=0;)if(apiCC.userMediaStreamTable[Yt].userMediaStreamId===jt){apiCC.userMediaStreamTable.splice(Yt,1);break}}(this.userMediaStreamId),void setTimeout(this.callbacks.failure.bind(this,this,"wrong type"));this.gum_config.audio=!1,this.gum_config=apiCC.setVideoSourceIdInConstraint(this.inputs.videoSourceId,this.gum_config),this.gum_config=apiCC.setVideoFacingModeInConstraint(this.inputs.facingMode,this.gum_config)}apiCC.checkConstraintDependingOnDevice(this.gum_config),ot.Xh==="IE"&&ot.dc>8?apiCC.getUserMediaWithCB(this.gum_config,this.callback(this,"onUserMediaSuccess"),this.callback(this,"onUserMediaError")):(ot.Xh==="Chrome"&&this.isUserMediaAccessAllowed()===!0&&(this.getUserMediaTimeoutId=setTimeout(function(){Et.onUserMediaError("timeout")},1e4)),apiCC.getUserMedia(this.gum_config).then(this.callback(this,"onUserMediaSuccess")).catch(this.callback(this,"onUserMediaError")))}catch(jt){Tt.error("getUserMedia() failed. Is this a WebRTC capable browser?"),Tt.log("getUserMedia failed with exception: "+jt.message)}},this.listenForMuteEvents=function(){var Et,jt=this,Yt=function(hn){var an=null,un=null;hn.onmute=function(Sn){Tt.debug("mute event :",hn),hn.kind==="audio"&&an===null?an=setTimeout(function(){jt.audioSilent=!0,an=null,jt.notifyMLineMuted(hn.kind,!0,"muted")},2520):hn.kind==="video"&&un===null&&(un=setTimeout(function(){jt.videoSilent=!0,un=null,jt.notifyMLineMuted(hn.kind,!0,"muted")},2520))},hn.onunmute=function(Sn){Tt.debug(hn.kind+" unmute event"),hn.kind==="audio"&&an!==null?(clearTimeout(an),an=null):hn.kind==="video"&&un!==null?(clearTimeout(un),un=null):(hn.kind==="audio"?jt.audioSilent=!1:hn.kind==="video"&&(jt.videoSilent=!1),jt.notifyMLineMuted(hn.kind,!1,"muted"))},hn.onended=function(Sn){Tt.debug(hn.kind+" ended event"),hn.kind==="audio"&&an!==null?(clearTimeout(an),an=null):hn.kind==="video"&&(un!==null&&(clearTimeout(un),un=null),jt.callType!=="screenSharing"&&jt.callType!=="screenSharingWithAudio"||jt.stopScreenSharing())}},en=nt(this.stream.getVideoTracks());try{for(en.s();!(Et=en.n()).done;)Yt(Et.value)}catch(hn){en.e(hn)}finally{en.f()}var Kt,rn=nt(this.stream.getAudioTracks());try{for(rn.s();!(Kt=rn.n()).done;)Yt(Kt.value)}catch(hn){rn.e(hn)}finally{rn.f()}this.callType!=="screenSharing"&&this.callType!=="screenSharingWithAudio"||(this.stream.onended=this.callback(this,"stopScreenSharing"))},this.onUserMediaSuccess=function(Et){var jt=this;this.applyFiltersIfNeeded(Et).then(function(Yt){var en=null,Kt=null,rn=!1,hn=jt.getOwnerCallInfo(),an=jt.getCall(hn);Tt.info("[ApiCCUserMediaStream] onUserMediaSuccess; userMediaStreamId: "+jt.userMediaStreamId),jt.getUserMediaTimeoutId!==null&&(clearTimeout(jt.getUserMediaTimeoutId),jt.getUserMediaTimeoutId=null),an&&(Tt.debug("call exist"),Kt=an.callee?an.callerId:an.calleeId,rn=an.restarted),jt.updateMediaProperties(Yt),jt.stream=Yt,ot.Xh==="Chrome"&&jt.setUserMediaAccessAllowed(!0),jt.notifyUserMediaSuccess===!0&&(hn&&(en=hn.callId),Pt.createUserMediaSuccessEvent(en!==null,jt.audio,jt.audioDeviceLabel,jt.video,jt.videoDeviceLabel,jt.callType,en,Yt,Kt,rn,jt.userMediaStreamId)),jt.listenForMuteEvents(),Tt.debug("Starting a new getMediaDevices after userMediaSuccess"),apiCC.mediaDeviceMgr.getMediaDevices("updatedAfterGetUserMediaSuccess"),jt.callbacks.success(jt)})},this.updateMediaProperties=function(Et){var jt=!1,Yt="Unknown",en="Unknown",Kt=!1,rn="Unknown";Et.getAudioTracks().length>0&&(jt=!0,Et.getAudioTracks()[0].label&&(Yt=Et.getAudioTracks()[0].label,en=Et.getAudioTracks()[0].id,apiCC.audioProcessor.listenToAudio(Et,this)),Et.getAudioTracks()[0].enabled===!1&&(this.audioMuted=!0),Et.getAudioTracks()[0].muted===!1&&(this.audioSilent=!0)),Et.getVideoTracks().length>0&&(Kt=!0,Et.getVideoTracks()[0].label&&(rn=Et.getVideoTracks()[0].label),Et.getVideoTracks()[0].enabled===!1&&(this.videoMuted=!0),Et.getVideoTracks()[0].muted===!1&&(this.videoSilent=!0)),this.audio=jt,this.audioDeviceLabel=Yt,this.audioDeviceId=en,this.video=Kt,this.videoDeviceLabel=rn},this.manageFailure=function(Et){var jt={};Rt(Et)==="object"?(jt.message=Et.message,jt.code=Et.code,jt.name=Et.name):jt=Et,this.callbacks.failure(this,jt)},this.onUserMediaError=function(Et){var jt=function(rn){for(var hn=apiCC.userMediaStreamTable.length;--hn>=0;)if(apiCC.userMediaStreamTable[hn].userMediaStreamId===rn){apiCC.userMediaStreamTable.splice(hn,1);break}},Yt=null,en=this.getOwnerCallInfo();if(Tt.info("[ApiCCUserMediaStream] onUserMediaError; userMediaStreamId: "+this.userMediaStreamId+", error: "+Et),this.getUserMediaTimeoutId!==null&&(Et!=="timeout"&&clearTimeout(this.getUserMediaTimeoutId),this.getUserMediaTimeoutId=null),ot.$6!=="electron"&&ot.Xh==="Chrome"&&ot.PR>47&&window.location.protocol!=="https:"&&Tt.error("HTTPS is now mandatory to use getUserMedia()"),en!==null&&(Yt=en.callId),this.callType==="media"&&ot.ag.name==="iOS"&&ot.Xh==="Mobile Safari"&&this.iOSMediaSelectionWorkAroundApplied===!1||Pt.createUserMediaErrorEvent(Yt!==null,this.callType,Et,this.userMediaStreamId,Yt,this.tryAudioCallAfterUserMediaError,this.gum_config),Et!=="timeout"&&this.callType==="media")if(ot.ag.name==="iOS"&&ot.Xh==="Mobile Safari"&&this.iOSMediaSelectionWorkAroundApplied===!1){Tt.warn("try mediaDevice selection workaround on iOS / Mobile Safari - after MediaError"),this.iOSMediaSelectionWorkAroundApplied=!0,this.gum_config.video={};var Kt=apiCC.getMediaDeviceLabelFromDeviceid(this.inputs.videoSourceId);Tt.log("getMediaDeviceLabelFromDeviceid :",Kt),Kt==="Camra arrire"||Kt==="Back Camera"?(Tt.log("Setting FacingMode to environment :",Kt),this.gum_config=apiCC.setVideoFacingModeInConstraint("environment",this.gum_config)):(Tt.log("Setting FacingMode to user :",Kt),this.gum_config=apiCC.setVideoFacingModeInConstraint("user",this.gum_config)),this.inputs.videoSourceId=null,this.getUserMedia()}else this.tryAudioCallAfterUserMediaError===!0?(Tt.warn("try AudioCall after UserMediaError is activated"),this.tryAudioCallAfterUserMediaError=!1,this.gum_config.video!==!1?(Tt.debug("[ApiCCUserMediaStream] Trying to getUserMedia with audioOnly"),this.inputs.videoSourceId=null,this.gum_config.video=!1,this.getUserMedia()):(jt(this.userMediaStreamId),this.manageFailure(Et))):(jt(this.userMediaStreamId),this.manageFailure(Et));else jt(this.userMediaStreamId),this.manageFailure(Et)},this.getDisplayMediaProcess=function(){var Et=this;Tt.debug("using getDisplayMedia with browser :",ot.Xh),Tt.debug("displayMediaStreamConstraints :",this.displayMediaStreamConstraints),Rt(this.displayMediaStreamConstraints)==="object"&&Array.isArray(this.displayMediaStreamConstraints)!==!0||(Tt.warn("Defined displayMediaStreamConstraints format is not correct, reinitialization ..."),ct.wL.type==="chrome"&&ct.wL.version>=72&&ct.wL.version<=73?this.displayMediaStreamConstraints={video:!0,audio:!1}:this.displayMediaStreamConstraints={video:!0,audio:!0},Tt.debug("displayMediaStreamConstraints :",this.displayMediaStreamConstraints)),navigator.getDisplayMedia?(Tt.debug("navigator.getDisplayMedia defined"),navigator.getDisplayMedia(this.displayMediaStreamConstraints).then(function(jt){Tt.debug("getDisplayMedia stream available"),Et.onUserMediaSuccess(jt)}).catch(function(jt){Tt.debug("getDisplayMedia error :",jt),Et.onUserMediaError(jt)})):navigator.mediaDevices.getDisplayMedia?(Tt.debug("navigator.mediaDevices.getDisplayMedia defined"),navigator.mediaDevices.getDisplayMedia(this.displayMediaStreamConstraints).then(function(jt){Tt.debug("getDisplayMedia stream available"),Et.onUserMediaSuccess(jt)}).catch(function(jt){Tt.debug("getDisplayMedia error :",jt),Et.onUserMediaError(jt)})):(Tt.debug("getDisplayMedia not available"),Pt.createDesktopCaptureEvent("Browser_Not_Compatible"))},this.getScreenMedia=function(){if(Tt.debug("[ApiCCUserMediaStream] getScreenMedia; userMediaStreamId: "+this.userMediaStreamId),this.stream===null)if(ot.Xh==="Chrome"||ot.Xh==="Firefox"&&ot.PR>=52)if(ot.Xh==="Chrome")if(Tt.log("shareScreen on Chrome"),ot.PR>=72&&this.forceExtensionOnChrome===!1)this.getDisplayMediaProcess();else{if(Tt.debug("this.captureSourceType :",this.captureSourceType),apiCC.apiRTCExtensionInstalled===!1)return apiCC.waitingShareScreenUserMediaStreamId=this.userMediaStreamId,function(Et){Tt.debug("[ApiCCUserMediaStream] moveUserMediaEntryInWaitingScreen: "+Et);for(var jt=apiCC.userMediaStreamTable.length;--jt>=0;)if(apiCC.userMediaStreamTable[jt].userMediaStreamId===Et){apiCC.waitingShareScreenUserMediaStream=apiCC.userMediaStreamTable.splice(jt,1);break}}(this.userMediaStreamId),void apiCC.manageNotInstalledExtension("getScreenMedia","getScreenMedia",this.captureSourceType);this.captureSourceType!==void 0&&this.captureSourceType!==null||(this.captureSourceType=["screen","window","tab"]),Array.isArray(this.captureSourceType)===!1&&(Tt.warn("Defined captureSourceType format is not correct, reinitialization ..."),this.captureSourceType=["screen","window","tab"],Tt.debug("this.captureSourceType :",this.captureSourceType)),window.postMessage({command:"getDesktopId",callNumber:this.userMediaStreamId,remoteId:"getScreenMedia",captureSourceType:this.captureSourceType,browser_major_version:ot.PR},"*")}else Tt.log("shareScreen on Firefox"),ot.PR>=67?this.getDisplayMediaProcess():(this.captureSourceType!==void 0&&this.captureSourceType!==null||(this.captureSourceType="screen"),typeof this.captureSourceType=="string"&&(Tt.warn("Defined captureSourceType format is not correct, reinitialization ..."),this.captureSourceType="screen",Tt.debug("this.captureSourceType :",this.captureSourceType)),this.registerScreenMedia(this.captureSourceType));else this.getDisplayMediaProcess()},this.registerScreenMedia=function(Et,jt){var Yt=null,en=this.getOwnerCallInfo(),Kt=this.getCall(en),rn=null;if(Tt.debug("[ApiCCUserMediaStream] registerScreenMedia; userMediaStreamId: "+this.userMediaStreamId),jt==="mediaError")Kt!==null?(rn=Kt.callee===!0?Kt.callerId:Kt.calleeId,Kt.callType==="screenSharing"||Kt.callType==="screenSharingWithAudio"?apiCC.session.apiCCWebRTCClient.webRTCClient.removeCallFromTableWithCallIdandRemoteId(Kt.callId,rn,"Media_Error"):Tt.log("switch video / screen : call is not removed"),window.location.protocol!=="https:"&&Tt.log("Please connect to your web page using 'HTTPS'. This is mandatory for desktop capture"),Pt.createDesktopCaptureEvent("UserMediaError",Kt.callId,rn)):(Tt.log("Call not found on message EventListener"),Pt.createDesktopCaptureEvent("UserMediaError")),function(hn){for(var an=apiCC.userMediaStreamTable.length;--an>=0;)if(apiCC.userMediaStreamTable[an].userMediaStreamId===hn){apiCC.userMediaStreamTable.splice(an,1);break}}(this.userMediaStreamId),this.callbacks.failure(this,"UserMediaError");else try{if(ot.Xh==="Chrome")Tt.log("desktopId: "+jt),Yt={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:jt}}};else{if(Tt.log("captureSourceType: "+Et),Et!=="screen"&&Et!=="window"&&Et!=="application")return void Tt.error("captureSourceType value is not correct");Yt={video:{mediaSource:Et}}}ot.Xh==="IE"&&ot.dc>8?apiCC.getUserMediaWithCB(Yt,this.callback(this,"onUserMediaSuccess"),this.callback(this,"onUserMediaError")):apiCC.getUserMedia(Yt).then(this.callback(this,"onUserMediaSuccess")).catch(this.callback(this,"onUserMediaError"))}catch(hn){Tt.error("getUserMedia() failed. Is this a WebRTC capable browser?"),Tt.log("getUserMedia failed with exception: "+hn.message)}},this.stopScreenSharing=function(){Tt.debug("[ApiCCUserMediaStream] stopScreenSharing; userMediaStreamId: "+this.userMediaStreamId);var Et=!0;if(apiRTC.session.remoteAccessInvitation!==null&&this.userMediaStreamId===apiRTC.session.remoteAccessInvitation.screenSharingStreamId&&(Tt.debug("this is a remote access screenSharing, need to stop remote access"),apiRTC.session.remoteAccessInvitation.stop(!0,{code:"SCREEN_SHARING_STOP"})),apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient)for(var jt=this.callInfoList.length;--jt>=0;)this.callInfoList[jt].owner===!0&&(Et=!1),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(this.callInfoList[jt].callId);Et===!0&&this.release()},this.getCall=function(Et){var jt=null;return Et&&apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient&&(Et.flavor==="call"?jt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(Et.callId):Et.flavor==="userMedia"&&(jt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(Et.callId))),jt},this.getOwnerCallInfo=function(){for(var Et=this.callInfoList.length;--Et>=0;)if(this.callInfoList[Et].owner===!0)return this.callInfoList[Et];return null},this.getCallInfo=function(Et){for(var jt=this.callInfoList.length;--jt>=0;)if(this.callInfoList[jt].callId===Et)return this.callInfoList[jt];return null},this.containsCallInfo=function(Et){for(var jt=!1,Yt=this.callInfoList.length;--Yt>=0;)if(this.callInfoList[Yt].callId===Et){jt=!0;break}return jt},this.addCallInfo=function(Et,jt,Yt){return Et!==null&&typeof Et=="string"&&(jt!=="call"&&jt!=="userMedia"&&(jt="call"),Yt!==null&&typeof Yt=="boolean"||(Yt=!1),!this.containsCallInfo(Et))&&(this.callInfoList.push({callId:Et,flavor:jt,owner:Yt}),!0)},this.removeCallInfo=function(Et){for(var jt=!1,Yt=this.callInfoList.length;--Yt>=0;)if(this.callInfoList[Yt].callId===Et){this.callInfoList.splice(Yt,1),jt=!0;break}return jt},this.accessToLocalMedia=function(){return this.callType!=="screenSharing"&&this.callType!=="screenSharingWithAudio"&&this.callType!=="data"&&this.stream!==null},this.muteAudioOnStreams=function(){var Et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"enabled";return Tt.debug("[ApiCCUserMediaStream] muteAudioOnStreams; userMediaStreamId: "+this.userMediaStreamId),this.stream.getAudioTracks().forEach(function(jt){jt.enabled=!1}),Et==="enabled"?this.audioMuted=!0:Et==="muted"&&(this.audioSilent=!0),this.notifyMLineMuted("audio",!0,Et),{type:"audio",muted:!0}},this.unMuteAudioOnStreams=function(){var Et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"enabled";return Tt.debug("[ApiCCUserMediaStream] unMuteAudioOnStreams; userMediaStreamId: "+this.userMediaStreamId),this.stream.getAudioTracks().forEach(function(jt){jt.enabled=!0}),Et==="enabled"?this.audioMuted=!1:Et==="muted"&&(this.audioSilent=!1),this.notifyMLineMuted("audio",!1,Et),{type:"audio",muted:!1}},this.muteVideoOnStreams=function(){var Et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"enabled";return Tt.debug("[ApiCCUserMediaStream] muteVideoOnStreams; userMediaStreamId: "+this.userMediaStreamId),this.stream.getVideoTracks().forEach(function(jt){jt.enabled=!1}),Et==="enabled"?this.videoMuted=!0:Et==="muted"&&(this.videoSilent=!0),this.notifyMLineMuted("video",!0,Et),{type:"video",muted:!0}},this.unMuteVideoOnStreams=function(){var Et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"enabled";return Tt.debug("[ApiCCUserMediaStream] unMuteVideoOnStreams; userMediaStreamId: "+this.userMediaStreamId),this.stream.getVideoTracks().forEach(function(jt){jt.enabled=!0}),Et==="enabled"?this.videoMuted=!1:Et==="muted"&&(this.videoSilent=!1),this.notifyMLineMuted("video",!1,Et),{type:"video",muted:!1}},this.removeVideoTrackOnStreams=function(){var Et;return Tt.debug("[ApiCCUserMediaStream] removeVideoTrackOnStreams; userMediaStreamId: "+this.userMediaStreamId),(Et=this.stream.getVideoTracks()).length>0&&this.stream.removeTrack(Et[0]),this.video=!1,{type:"video",present:!1}},this.notifyMLineMuted=function(Et,jt,Yt){var en,Kt,rn=!0;if(apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient)for(var hn=this.callInfoList.length;--hn>=0;)this.callInfoList[hn].flavor==="call"?(en=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(this.callInfoList[hn].callId),this.notifyMLineMutedCall(Et,jt,Yt,en,null)):this.callInfoList[hn].flavor==="userMedia"&&(Kt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(this.callInfoList[hn].callId),this.notifyMLineMutedCall(Et,jt,Yt,null,Kt)),this.callInfoList[hn].owner===!0&&(rn=!1);rn===!0&&this.notifyMLineMutedCall(Et,jt,Yt,null,null)},this.notifyMLineMutedCall=function(Et,jt,Yt,en,Kt){Tt.debug("notifyMLineMutedCall; mline: "+Et+", muted: "+jt);var rn=[];Yt==="enabled"?rn=[Et+"IsMuted"]:Yt==="muted"&&(rn=[Et+"IsSilent"]);var hn={available:this.audio,deviceLabel:this.audioDeviceLabel,active:!0,muted:this.audioMuted,silent:this.audioSilent},an={available:this.video,deviceLabel:this.videoDeviceLabel,active:!0,muted:this.videoMuted,silent:this.videoSilent},un=null;en?(Et==="audio"?en.isLocalAudioMuted=jt:Et==="video"&&(en.isLocalVideoMuted=jt),en.belongsToRoom()?(un={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:en.callId,roomId:en.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,mline:Et},en.data.mesh&&(un.mesh=en.data.mesh),Yt==="muted"?(un.change="silent",un.silent=jt,en.myWebRTC_Stack.sendInfo("streamTrackStatusChanged",un)):Yt==="enabled"&&(un.muted=jt,en.myWebRTC_Stack.sendInfo("streamTrackChanged",un))):(un={callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,calleeId:en.callee?en.callerId:en.calleeId,callId:en.callId,mline:Et},Yt==="muted"?(un.type="streamTrackStatusChanged",un.change="silent",un.silent=jt):Yt==="enabled"&&(un.type="streamTrackChanged",un.muted=jt),en.myWebRTC_Stack.sendDataMessage(apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,un)),hn.active=en.localCallProfile.audioActive,an.active=en.localCallProfile.videoActive,Pt.createLocalStreamUpdatedEvent(rn,hn,an,!0,en.callType,en.callId,this.stream,this.userMediaStreamId,"userAction")):Kt?(un={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Kt.userMediaId,roomId:Kt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,mline:Et},Yt==="muted"?(un.change="silent",un.silent=jt,Kt.myWebRTC_Stack.sendInfo("streamTrackStatusChanged",un)):Yt==="enabled"&&(un.muted=jt,Kt.myWebRTC_Stack.sendInfo("streamTrackChanged",un)),Kt.audioSdpDirection==="inactive"&&(hn.active=!1),Kt.videoSdpDirection==="inactive"&&(an.active=!1),Pt.createLocalStreamUpdatedEvent(rn,hn,an,!0,Kt.callType,Kt.userMediaId,this.stream,this.userMediaStreamId,"userAction")):Pt.createLocalStreamUpdatedEvent(rn,hn,an,!1,null,null,this.stream,this.userMediaStreamId,"userAction")},this.notifyActiveSpeaker=function(Et){var jt,Yt,en=!0;if(apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient)for(var Kt=this.callInfoList.length;--Kt>=0;)this.callInfoList[Kt].flavor==="call"?(jt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(this.callInfoList[Kt].callId),this.notifyActiveSpeakerCall(Et,jt,null)):this.callInfoList[Kt].flavor==="userMedia"&&(Yt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(this.callInfoList[Kt].callId),this.notifyActiveSpeakerCall(Et,null,Yt)),this.callInfoList[Kt].owner===!0&&(en=!1);en===!0&&this.notifyActiveSpeakerCall(Et,null,null)},this.notifyActiveSpeakerCall=function(Et,jt,Yt){var en=null;jt?(jt.belongsToRoom()?(en={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:jt.callId,roomId:jt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,resolve:!0,descriptor:{audioAmplitude:Et,streamID:this.userMediaStreamId}},jt.data.mesh&&(en.mesh=jt.data.mesh),jt.myWebRTC_Stack.sendInfo("activeSpeaker",en)):(en={type:"activeSpeaker",callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,calleeId:jt.callee?jt.callerId:jt.calleeId,callId:jt.callId,descriptor:{audioAmplitude:Et,streamID:this.userMediaStreamId}},jt.myWebRTC_Stack.sendDataMessage(apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,en)),Pt.createAudioAmplitudeEvent(Et,!0,jt.callId,this.userMediaStreamId)):Yt?(en={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Yt.userMediaId,roomId:Yt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,resolve:!0,descriptor:{audioAmplitude:Et,streamID:this.userMediaStreamId}},Yt.myWebRTC_Stack.sendInfo("activeSpeaker",en),Pt.createAudioAmplitudeEvent(Et,!0,Yt.userMediaId,this.userMediaStreamId)):Pt.createAudioAmplitudeEvent(Et,!0,null,this.userMediaStreamId)},this.notifyNotActiveSpeaker=function(Et){var jt,Yt,en=!0;if(apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient)for(var Kt=this.callInfoList.length;--Kt>=0;)this.callInfoList[Kt].flavor==="call"?(jt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(this.callInfoList[Kt].callId),this.notifyNotActiveSpeakerCall(Et,jt,null)):this.callInfoList[Kt].flavor==="userMedia"&&(Yt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(this.callInfoList[Kt].callId),this.notifyNotActiveSpeakerCall(Et,null,Yt)),this.callInfoList[Kt].owner===!0&&(en=!1);en===!0&&this.notifyNotActiveSpeakerCall(Et,null,null)},this.notifyNotActiveSpeakerCall=function(Et,jt,Yt){var en=null;jt?(jt.belongsToRoom()?(en={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:jt.callId,roomId:jt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,resolve:!0,descriptor:{audioAmplitude:Et,streamID:this.userMediaStreamId}},jt.data.mesh&&(en.mesh=jt.data.mesh),jt.myWebRTC_Stack.sendInfo("stopSpeaking",en)):(en={type:"stopSpeaking",callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,calleeId:jt.callee?jt.callerId:jt.calleeId,callId:jt.callId,descriptor:{audioAmplitude:Et,streamID:this.userMediaStreamId}},jt.myWebRTC_Stack.sendDataMessage(apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,en)),Pt.createAudioAmplitudeEvent(Et,!1,jt.callId,this.userMediaStreamId)):Yt?(en={clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Yt.userMediaId,roomId:Yt.sessionMCU.roomName,pubSub:apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector,resolve:!0,descriptor:{audioAmplitude:Et,streamID:this.userMediaStreamId}},Yt.myWebRTC_Stack.sendInfo("stopSpeaking",en),Pt.createAudioAmplitudeEvent(Et,!1,Yt.userMediaId,this.userMediaStreamId)):Pt.createAudioAmplitudeEvent(Et,!1,null,this.userMediaStreamId)},this.callback=function(Et,jt){return this.closureHandler=function(Yt,en){return Et[jt](Yt,en)},this.closureHandler},this.isUserMediaAccessAllowed=function(){return localStorage!==null&&(typeof localStorage>"u"?"undefined":Rt(localStorage))==="object"&&typeof localStorage.getItem=="function"?localStorage.getItem(wt)==="true":null},this.setUserMediaAccessAllowed=function(Et){return localStorage!==null&&(typeof localStorage>"u"?"undefined":Rt(localStorage))==="object"&&typeof localStorage.setItem=="function"?(localStorage.setItem(wt,Et?"true":"false"),!!Et):null},this.applyFiltersIfNeeded=function(Et){return this.filters===null?Promise.resolve(Et):(this.mediaFilterManager=new qt(Et,this.filters,this.userMediaStreamId),this.mediaFilterManager.applyFilters())},this.getVideoSettings=function(){if(this.videoSettings!==!1)return this.videoSettings;var Et=this.getVideoTrack();if(!Et||typeof Et.getSettings!="function")return this.videoSettings=null,this.videoSettings;var jt=Et.getSettings();return jt?(this.videoSettings={},Object.prototype.hasOwnProperty.call(jt,"width")&&(this.videoSettings.width=jt.width),Object.prototype.hasOwnProperty.call(jt,"height")&&(this.videoSettings.height=jt.height),Object.prototype.hasOwnProperty.call(jt,"frameRate")&&(this.videoSettings.frameRate=jt.frameRate),this.videoSettings):(this.videoSettings=null,this.videoSettings)},this.isSimulcastCompliant=function(){return!!this.getVideoSettings()},this.getSimulcastProfile=function(){var Et=this.getVideoSettings();if(!Et)return null;var jt={substream:{high:{active:!0,selectable:!0},medium:{active:!0,selectable:!0},low:{active:!0,selectable:!0}},temporal:{high:{active:!0,selectable:!0},medium:{active:!0,selectable:!0},low:{active:!0,selectable:!0}}};return ct.wL.type==="chrome"&&((Et.width<1280||Et.height<720)&&(jt.substream.low.selectable=!1),jt.temporal.high.active=!1,jt.temporal.high.selectable=!1),jt}}},1192:(it,ut,s)=>{s.d(ut,{D:()=>kn}),s(3710),s(1539),s(9714),s(2772),s(8674);var tt=s(1549),ot=(s(4916),s(5306),s(2564),s(4812),s(561),s(5735),s(3753),s(4603),s(6755),s(9554),s(4747),s(6992),s(8783),s(3948),s(9601),s(8309),s(8264),s(9575),s(2472),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(7042),s(7941),s(2526),s(1817),s(2165),s(5945)),ct=s(4708),yt=s(940);function pt(qt){return pt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Rt){return typeof Rt}:function(Rt){return Rt&&typeof Symbol=="function"&&Rt.constructor===Symbol&&Rt!==Symbol.prototype?"symbol":typeof Rt},pt(qt)}function gt(){this.sdp={original:null,global:[],mlines:[]},this.mlines=[]}function st(qt){var Rt=new gt,nt=qt.split(`\r
`),vt=0,Tt=null,Pt=null,wt=null,Dt=null;for(Rt.sdp.original=qt;vt<nt.length;)if((Tt=nt[vt]).length!==0)if(wt!==null)if(Tt.match(/^m=/))Pt=null,wt=null;else if(Tt.match(/^a=/)){if(Pt.push(Tt),!(Dt=Tt.match(/^a=([\w-]+):(\d+) (.+)$/))||Dt[1]!=="rtpmap"&&Dt[1]!=="rtcp-fb"&&Dt[1]!=="fmtp"){if(Dt=Tt.match(/^a=mid:(\w+)$/))wt.mid=Dt[1];else if(Tt==="a=sendrecv")wt.direction="sendrecv";else if(Tt==="a=recvonly")wt.direction="recvonly";else if(Tt==="a=sendonly")wt.direction="sendonly";else if(Tt==="a=inactive")wt.direction="inactive";else if(Dt=Tt.match(/^a=ssrc-group:SIM (.+)$/)){var Et=Dt[1].split(" ");wt.ssrc_groups.sim.push(Et.slice())}else if(Dt=Tt.match(/^a=ssrc-group:FID (.+)$/)){var jt=Dt[1].split(" ");wt.ssrc_groups.fid.push(jt.slice())}else if(Dt=Tt.match(/^a=ssrc:(\d+) (.+)$/)){var Yt=wt.ssrcs.find(function(Sn){return Sn.original===Dt[1]});Yt||(Yt={original:Dt[1],ssrc:Dt[1],content:{}},wt.ssrcs.push(Yt));var en=Dt[2].match(/^(\w+):(.+)$/);if(!en)throw new Error("cannot parse ssrc parameters (regex failure): "+Dt[2]);if(en[1]==="cname")Yt.content.cname=en[2];else if(en[1]==="msid")Yt.content.msid=en[2];else if(en[1]==="mslabel")Yt.content.mslabel=en[2];else{if(en[1]!=="label")throw new Error("cannot parse ssrc parameters (wrong attribute): "+en[1]);Yt.content.label=en[2]}}}else if(Dt[1]==="rtpmap")wt.codecs[Dt[2]].codec=Dt[3].split("/")[0].toLowerCase(),wt.codecs[Dt[2]].rtpmap=Dt[3];else if(Dt[1]==="rtcp-fb")wt.codecs[Dt[2]]["rtcp-fb"]||(wt.codecs[Dt[2]]["rtcp-fb"]=[]),wt.codecs[Dt[2]]["rtcp-fb"].push(Dt[3]);else if(Dt[1]==="fmtp"){wt.codecs[Dt[2]].fmtp=[];for(var Kt=Dt[3].split(";"),rn=0;rn<Kt.length;rn+=1){var hn=Kt[rn].split("=");hn.length===2&&wt.codecs[Dt[2]].fmtp.push(hn)}}vt+=1}else if(Tt.match(/^b=/)){if(Pt.push(Tt),Dt=Tt.match(/^b=AS:(\d+)$/)){wt.bandwidth=parseInt(Dt[1],10),vt+=1;continue}vt+=1}else Pt.push(Tt),vt+=1;else{if(Dt=Tt.match(/^m=([a-z]+) (\d+) ([A-Z/]+) ([0-9 ]+)$/)){Pt=[],Rt.sdp.mlines.push(Pt),Pt.push(Tt),wt={type:Dt[1],port:parseInt(Dt[2],10),proto:Dt[3],payload_types:[],direction:"sendrecv",mid:Dt[1],bandwidth:0,codecs:{},ssrc_groups:{sim:[],fid:[]},ssrcs:[]};for(var an=Dt[4].split(" "),un=0;un<an.length;un+=1)wt.payload_types.push(an[un]),wt.codecs[an[un]]={};Rt.mlines.push(wt),vt+=1;continue}Rt.sdp.global.push(Tt),vt+=1}else vt+=1;for(Rt.unifiedPlan=!0,vt=Rt.mlines.length;--vt>=0;)Rt.mlines[vt].type!=="audio"||Rt.audio?Rt.mlines[vt].type!=="video"||Rt.video||(Rt.video=Rt.mlines[vt]):Rt.audio=Rt.mlines[vt],Rt.unifiedPlan===!0&&Rt.mlines[vt].mid!==String(vt)&&(Rt.unifiedPlan=!1);return Rt.isAudioActive=ft.bind(null,Rt,"audio"),Rt.isVideoActive=ft.bind(null,Rt,"video"),Rt}function ft(qt,Rt){return!(Rt!=="audio"&&Rt!=="video"||qt===null||pt(qt)!=="object"||!Object.prototype.hasOwnProperty.call(qt,Rt)||qt[Rt]===null||pt(qt[Rt])!=="object"||qt[Rt].direction!=="sendrecv"&&qt[Rt].direction!=="sendonly"&&qt[Rt].direction!=="recvonly")}s(3123),s(4765),s(4723),s(9600),s(1058),s(9826),gt.prototype.mungeForSimulcasting=function(){if(this.simulcasting!==!0){this.simulcasting=!0;for(var qt=0;qt<this.mlines.length;qt+=1){var Rt=this.mlines[qt];if(Rt.type==="video"){var nt=Rt.ssrcs[0].content.cname,vt=Rt.ssrcs[0].content.msid,Tt=Rt.ssrcs[0].content.mslabel,Pt=Rt.ssrcs[0].content.label,wt=[];wt.push(Rt.ssrcs[0].ssrc);for(var Dt=2;--Dt>=0;){var Et=Math.floor(4294967295*Math.random());Rt.ssrcs.push({original:Et,ssrc:Et,content:{cname:nt,msid:vt,mslabel:Tt,label:Pt}});var jt=Math.floor(4294967295*Math.random());Rt.ssrcs.push({original:jt,ssrc:jt,content:{cname:nt,msid:vt,mslabel:Tt,label:Pt}}),Rt.ssrc_groups.fid.push([Et,jt]),wt.push(Et)}Rt.ssrc_groups.sim.push(wt)}}}},gt.prototype.generate=function(){for(var qt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Rt=[],nt=0;nt<this.sdp.global.length;nt+=1){var vt=this.sdp.global[nt],Tt=vt.match(/^a=group:BUNDLE([\w ]+)$/);if(Tt){Rt.push("a=group:BUNDLE");for(var Pt=0;Pt<this.mlines.length;Pt+=1)this.mlines[Pt].direction==="inactive"&&qt.stripInactiveMLines===!0||(Rt.push(" "),Rt.push(this.mlines[Pt].mid));Rt.push(`\r
`)}else Rt.push(vt),Rt.push(`\r
`)}for(var wt=0;wt<this.sdp.mlines.length;wt+=1){var Dt=this.mlines[wt];if(Dt.direction!=="inactive"||qt.stripInactiveMLines!==!0)for(var Et=!1,jt=this.sdp.mlines[wt],Yt=0;Yt<jt.length;Yt+=1){var en=jt[Yt];if(en.match(/^m=/))Rt.push("m="),Rt.push(Dt.type),Rt.push(" "),Rt.push(Dt.port),Rt.push(" "),Rt.push(Dt.proto),Rt.push(" "),Rt.push(Dt.payload_types.join(" ")),Rt.push(`\r
`);else if(en.match(/^a=/)){var Kt=en.match(/^a=([\w-]+):(\d+) (.+)$/);if(Kt&&(Kt[1]==="rtpmap"||Kt[1]==="rtcp-fb"||Kt[1]==="fmtp")){if(Kt[1]==="rtpmap"){var rn=Kt[2];if(Dt.codecs[rn]){Rt.push("a=rtpmap:"),Rt.push(rn),Rt.push(" "),Rt.push(Dt.codecs[rn].rtpmap),Rt.push(`\r
`);var hn=Dt.codecs[rn]["rtcp-fb"];if(hn)for(var an=0;an<hn.length;an+=1)Rt.push("a=rtcp-fb:"),Rt.push(rn),Rt.push(" "),Rt.push(hn[an]),Rt.push(`\r
`);var un=Dt.codecs[rn].fmtp;if(un){for(var Sn=[],En=0;En<un.length;En+=1)Sn.push(un[En].join("="));Sn.length>0&&(Rt.push("a=fmtp:"),Rt.push(rn),Rt.push(" "),Rt.push(Sn.join(";")),Rt.push(`\r
`))}continue}continue}if(Kt[1]==="rtcp-fb"||Kt[1]==="fmtp")continue;throw new Error("internal error")}if(en.match(/^a=mid:(\w+)$/))Rt.push("a=mid:"),Rt.push(Dt.mid),Rt.push(`\r
`),Dt.bandwidth>0&&(Rt.push("b=AS:"),Rt.push(Dt.bandwidth),Rt.push(`\r
`),Rt.push("b=TIAS:"),Rt.push(Dt.bandwidth),Rt.push("000"),Rt.push(`\r
`));else if(en!=="a=sendrecv"&&en!=="a=recvonly"&&en!=="a=sendonly"&&en!=="a=inactive"){if(!en.match(/^a=ssrc-group:SIM (.+)$/)){if(!en.match(/^a=ssrc-group:FID (.+)$/)){if(en.match(/^a=ssrc:(\d+) (.+)$/)){if(Et)continue;Et=!0;for(var An=0;An<Dt.ssrc_groups.sim.length;An+=1)Rt.push("a=ssrc-group:SIM "),Rt.push(Dt.ssrc_groups.sim[An].join(" ")),Rt.push(`\r
`);for(var Dn=0;Dn<Dt.ssrc_groups.fid.length;Dn+=1)Rt.push("a=ssrc-group:FID "),Rt.push(Dt.ssrc_groups.fid[Dn].join(" ")),Rt.push(`\r
`);for(var Bn=function(fr){var Cr=Dt.ssrcs[fr];["cname","msid","mslabel","label"].forEach(function(gr){Object.prototype.hasOwnProperty.call(Cr.content,gr)&&(Rt.push("a=ssrc:"),Rt.push(Cr.ssrc),Rt.push(" "),Rt.push(gr),Rt.push(":"),Rt.push(Cr.content[gr]),Rt.push(`\r
`))})},sr=0;sr<Dt.ssrcs.length;sr+=1)Bn(sr);continue}Rt.push(en),Rt.push(`\r
`);continue}}}else Rt.push("a="),Rt.push(Dt.direction),Rt.push(`\r
`)}else{if(en.match(/^b=/))continue;Rt.push(en),Rt.push(`\r
`)}}}return Rt.join("")};var at=tt.Y.get("SDPManager"),ht=function(){at.debug("SDPManager"),this.getSDPLines=function(qt){at.debug("SDPManager::getSDPLines");var Rt,nt=qt.split(`\r
`);for(Rt=0;Rt<nt.length;Rt+=1)at.log("sdpLines[i] : "+nt[Rt]);return nt},this.getAudioMediaDescriptionPart=function(qt){at.debug("SDPManager::getAudioMediaDescriptionPart");var Rt=qt.split("m=audio"),nt=null;return Rt[1]!==void 0&&Rt[1]!==null?(nt=Rt[1].split("m=video"),at.log("SDP audio part : "+nt[0]),nt[0]):null},this.getVideoMediaDescriptionPart=function(qt){at.debug("SDPManager::getVideoMediaDescriptionPart");var Rt,nt=qt.split("m=video");for(Rt=0;Rt<nt.length;Rt+=1)at.log("sdpMediaPart[i] : "+nt[Rt]);return nt[1]},this.searchMediaDescriptionForRecvOnly=function(qt){return at.debug("searchMediaDescriptionForRecvOnly"),qt.search("a=recvonly")!==-1?(at.log("recvonly found in media description"),!0):(at.log("recvonly not found in media description"),!1)},this.searchSDPForRecvOnly=function(qt){return qt!==void 0?(at.log("sdpPart !== undefined"),this.searchMediaDescriptionForRecvOnly(qt)):(at.log("recvonly not found in SDP"),!1)},this.searchMediaDescriptionForSendOnly=function(qt){return at.debug("searchMediaDescriptionForSendOnly"),qt.search("a=sendonly")!==-1?(at.log("sendonly found in media description"),!0):(at.log("sendonly not found in media description"),!1)},this.searchSDPForSendOnly=function(qt){return qt!==void 0?(at.log("sdpPart !== undefined"),this.searchMediaDescriptionForSendOnly(qt)):(at.log("sendonly not found in SDP"),!1)},this.searchMediaDescriptionForInactive=function(qt){return at.debug("searchMediaDescriptionForInactive"),qt.search("a=inactive")!==-1?(at.log("inactive found in media description"),!0):(at.log("inactive not found in media description"),!1)},this.searchSDPForInactive=function(qt){return qt!==void 0?(at.log("sdpPart !== undefined"),this.searchMediaDescriptionForInactive(qt)):(at.log("inactive not found in SDP"),!1)},this.stripAudioMediaDescriptionFromSDP=function(qt){at.debug("SDPManager::stripAudioMediaDescriptionFromSDP");var Rt=this.createGuideline(qt);return Rt.audio?(Rt.audio.direction="inactive",Rt.generate({stripInactiveMLines:!0})):qt},this.stripVideoMediaDescriptionFromSDP=function(qt){at.debug("SDPManager::stripVideoMediaDescriptionFromSDP");var Rt=this.createGuideline(qt);return Rt.video?(Rt.video.direction="inactive",Rt.generate({stripInactiveMLines:!0})):qt},this.setAudioBandwidth=function(qt,Rt){return at.info("SDPManager::setAudioBandwidth",Rt),Rt?qt=qt.replace(/a=mid:audio\r\n/g,`a=mid:audio\r
b=AS:`+Rt+`\r
`):(at.warn("No maxAudioBW !"),qt)},this.setVideoBandwidth=function(qt,Rt){if(at.info("SDPManager::setVideoBandwidth",Rt),!Rt)return at.warn("No maxVideoBW !"),qt;for(var nt=[],vt=qt.split(`\r
`),Tt=0,Pt=null,wt=null;Tt<vt.length;)if((Pt=vt[Tt]).length!==0)if(wt!==null)Pt.match(/^m=/)?wt=null:Pt.match(/^a=mid:(\w+)$/)?(nt.push(Pt),nt.push(`\r
`),nt.push("b=AS:"),nt.push(Rt),nt.push(`\r
`),nt.push("b=TIAS:"),nt.push(Rt),nt.push("000"),nt.push(`\r
`),Tt+=1):(Pt.match(/^b=([A-Z]+):(\w+)$/)||(nt.push(Pt),nt.push(`\r
`)),Tt+=1);else{var Dt=Pt.match(/^m=([a-z]+)(.+)$/);if(Dt&&Dt[1]==="video"){wt="video",nt.push(Pt),nt.push(`\r
`),Tt+=1;continue}nt.push(Pt),nt.push(`\r
`),Tt+=1}else Tt+=1;return nt.join("")},this.setDataBandwidth=function(qt,Rt){return at.info("SDPManager::setDataBandwidth",Rt),Rt?qt=qt.replace(/a=mid:data\r\n/g,`a=mid:data\r
b=AS:`+Rt+`\r
`):(at.warn("No maxDataBW !"),qt)},this.setSendOnlyForAudio=function(qt){at.debug("SDPManager::setSendOnlyForAudio");var Rt=this.createGuideline(qt);return(0,ct.ki)(Rt,"audio","object")&&(Rt.audio.direction="sendonly"),Rt.generate()},this.setSendOnlyForVideo=function(qt){at.debug("SDPManager::setSendOnlyForVideo");var Rt=this.createGuideline(qt);return(0,ct.ki)(Rt,"video","object")&&(Rt.video.direction="sendonly"),Rt.generate()},this.setSendOnly=function(qt){at.debug("SDPManager::setSendOnly : global");var Rt=this.createGuideline(qt);return(0,ct.ki)(Rt,"audio","object")&&(Rt.audio.direction="sendonly"),(0,ct.ki)(Rt,"video","object")&&(Rt.video.direction="sendonly"),Rt.generate()},this.setRecvOnlyForAudio=function(qt){at.debug("SDPManager::setRecvOnlyForAudio");var Rt=this.createGuideline(qt);return Rt.audio&&Rt.audio.direction!=="inactive"&&(Rt.audio.direction="recvonly"),Rt.generate()},this.setRecvOnlyForVideo=function(qt){at.debug("SDPManager::setRecvOnlyForVideo");var Rt=this.createGuideline(qt);return Rt.video&&Rt.video.direction!=="inactive"&&(Rt.video.direction="recvonly"),Rt.generate()},this.setRecvOnly=function(qt){at.debug("SDPManager::setRecvOnly : global");var Rt=this.createGuideline(qt);return Rt.audio&&Rt.audio.direction!=="inactive"&&(Rt.audio.direction="recvonly"),Rt.video&&Rt.video.direction!=="inactive"&&(Rt.video.direction="recvonly"),Rt.generate()},this.updateSDPcodecs=function(qt,Rt,nt,vt){var Tt,Pt,wt,Dt,Et,jt,Yt,en,Kt=!1,rn=new RegExp(`\r
$`),hn=!1,an=null,un="",Sn="",En="",An="",Dn="",Bn="",sr="",fr="";if(at.log(`updateSDPcodecs():
	sdpType = `+Rt+`
	mediaType = `+nt+`
	availableCodecSet = `+vt+`
`),vt=="")return qt;for(wt=(wt=RTCSessionDescription&&qt instanceof RTCSessionDescription?qt.sdp:window.SessionDescription&&qt instanceof SessionDescription?qt.toSdp():qt).split(`\r
m=`),rn.test(wt[wt.length-2])===!1&&(wt[wt.length-2]=wt[wt.length-2]+`\r
`,hn=!0),Tt=0;Tt<wt.length;Tt++)if(wt[Tt].indexOf(nt)===0){for(an=wt[Tt].split(`\r
`)[0].split(" "),Pt=3;Pt<an.length;Pt++)if(Dt=!0,isNaN(an[Pt])===!1){switch(Sn="a=rtpmap:"+an[Pt]+" ",(Et=wt[Tt].indexOf(Sn))!==-1&&(jt=wt[Tt].indexOf(`\r
`,Et)),an[Pt]){case 0:un="PCMU/8000";break;case 8:un="PCMA/8000";break;case 9:un="G722/8000";break;case 13:un="CN/8000";break;case 18:un="G729/8000";break;default:Et!==-1&&(un=wt[Tt].substring(Et+Sn.length,jt))}un!=""&&vt.indexOf(un)!==-1?at.log("PT("+an[Pt]+"): "+un+` FOUND in availableCodecSet.
`):(Dt=!1,at.log("PT("+an[Pt]+"): "+un+` NOT FOUND in availableCodecSet.
`)),Dt||(En=Sn+`.*\r
`,An="a=fmtp:"+an[Pt]+` .*\r
`,sr="a=rtcp-fb:"+an[Pt]+` .*\r
`,Dn=" "+an[Pt]+" ",Bn=" "+an[Pt]+"\r",wt[Tt]=wt[Tt].replace(new RegExp(En,"g"),""),wt[Tt]=wt[Tt].replace(new RegExp(An,"g"),""),wt[Tt]=wt[Tt].replace(new RegExp(sr,"g"),""),(en=(Yt=wt[Tt].split(`
`))[0].split("RTP"))[1]=en[1].replace(Dn," "),en[1]=en[1].replace(Bn,"\r"),Yt[0]=en.join("RTP"),wt[Tt]=Yt.join(`
`),nt==="video"&&(sr="a=rtcp-fb:"+an[Pt]+` .*\r
`,wt[Tt]=wt[Tt].replace(new RegExp(sr,"g"),""),un!=""&&un.substr(0,4)==="rtx/"&&(fr=`a=ssrc-group:FID .*\r
`,wt[Tt]=wt[Tt].replace(new RegExp(fr,"g"),""),(Yt=wt[Tt].split(`\r
a=`)).splice(Yt.length-8,4),wt[Tt]=Yt.join(`\r
a=`))),Kt=!0)}break}return hn&&(wt[wt.length-2]=wt[wt.length-2].substr(0,wt[wt.length-2].length-2)),wt=wt.join(`\r
m=`),Kt===!0?(at.log("updateSDPcodecs(), SDP has been updated."),RTCSessionDescription&&qt instanceof RTCSessionDescription?new RTCSessionDescription({type:Rt,sdp:wt}):window.SessionDescription&&qt instanceof SessionDescription?new SessionDescription(wt):wt):(at.log("updateSDPcodecs(), SDP has not been updated."),qt)},this.preferOpus=function(qt){var Rt,nt=qt.split(`\r
`),vt=0,Tt=null;for(Rt=0;Rt<nt.length;Rt+=1)if(nt[Rt].search("m=audio")!==-1){vt=Rt;break}if(vt===0)return qt;for(Rt=0;Rt<nt.length;Rt+=1)if(nt[Rt].search("opus/48000")!==-1){(Tt=this.extractSdp(nt[Rt],/:(\d+) opus\/48000/i))&&(nt[vt]=this.setDefaultCodec(nt[vt],Tt));break}return(nt=this.removeCN(nt,vt)).join(`\r
`)},this.removeCN=function(qt,Rt){var nt=0,vt=qt[Rt].split(" "),Tt=null,Pt=0;for(nt=qt.length-1;nt>=0;nt--)(Tt=this.extractSdp(qt[nt],/a=rtpmap:(\d+) CN\/\d+/i))&&((Pt=vt.indexOf(Tt))!==-1&&vt.splice(Pt,1),qt.splice(nt,1));return qt[Rt]=vt.join(" "),qt},this.extractSdp=function(qt,Rt){var nt=qt.match(Rt);return nt&&nt.length==2?nt[1]:null},this.setDefaultCodec=function(qt,Rt){var nt=0,vt=qt.split(" "),Tt=vt.slice(0,3);for(Tt.push(Rt),nt=3;nt<vt.length;nt++)vt[nt]!==Rt&&Tt.push(vt[nt]);return Tt.join(" ")},this.findLineInRange=function(qt,Rt,nt,vt,Tt){var Pt,wt=nt!==-1?nt:qt.length;for(Pt=Rt;Pt<wt;++Pt)if(qt[Pt].indexOf(vt)===0&&(!Tt||qt[Pt].toLowerCase().indexOf(Tt.toLowerCase())!==-1))return Pt;return null},this.findLine=function(qt,Rt,nt){return this.findLineInRange(qt,0,-1,Rt,nt)},this.getCodecPayloadType=function(qt,Rt){var nt=this.findLine(qt,"a=rtpmap",Rt);return nt?this.getCodecPayloadTypeFromLine(qt[nt]):null},this.getCodecPayloadTypeFromLine=function(qt){var Rt=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),nt=qt.match(Rt);return nt&&nt.length===2?nt[1]:null},this.findFmtpLine=function(qt,Rt){var nt=this.getCodecPayloadType(qt,Rt);return nt?this.findLine(qt,"a=fmtp:"+nt.toString()):null},this.writeFmtpLine=function(qt){if(!qt.hasOwnProperty("pt")||!qt.hasOwnProperty("params"))return null;var Rt=qt.pt,nt=qt.params,vt=[],Tt=0,Pt=null;for(Pt in nt)vt[Tt]=Pt+"="+nt[Pt],++Tt;return Tt===0?null:"a=fmtp:"+Rt.toString()+" "+vt.join("; ")},this.setCodecParam=function(qt,Rt,nt,vt){var Tt=qt.split(`\r
`),Pt=this.findFmtpLine(Tt,Rt),wt={},Dt=null,Et=null;if(Pt===null){if((Et=this.findLine(Tt,"a=rtpmap",Rt))===null)return qt;Dt=this.getCodecPayloadTypeFromLine(Tt[Et]),wt.pt=Dt.toString(),wt.params={},wt.params[nt]=vt,Tt.splice(Et+1,0,this.writeFmtpLine(wt))}else(wt=function(jt){var Yt,en={},Kt=jt.indexOf(" "),rn=jt.substring(Kt+1).split("; "),hn=new RegExp("a=fmtp:(\\d+)"),an=jt.match(hn),un={},Sn=null;if(!an||an.length!==2)return null;for(en.pt=an[1],Yt=0;Yt<rn.length;++Yt)(Sn=rn[Yt].split("=")).length===2&&(un[Sn[0]]=Sn[1]);return en.params=un,en}(Tt[Pt])).params[nt]=vt,Tt[Pt]=this.writeFmtpLine(wt);return Tt.join(`\r
`)},this.maybePreferCodec=function(qt,Rt,nt){var vt,Tt,Pt=Rt+" codec",wt=null;return nt?(at.log("Prefer "+Pt+": "+nt),wt=qt.split(`\r
`),(vt=this.findLine(wt,"m=",Rt))===null?(at.log("mLineIndex === null"),qt):((Tt=this.getCodecPayloadType(wt,nt))&&(wt[vt]=this.setDefaultCodec(wt[vt],Tt)),qt=wt.join(`\r
`))):(at.log("No preference on "+Pt+"."),qt)},this.createGuideline=st};function mt(qt,Rt){(Rt==null||Rt>qt.length)&&(Rt=qt.length);for(var nt=0,vt=new Array(Rt);nt<Rt;nt++)vt[nt]=qt[nt];return vt}function St(qt,Rt){for(var nt=0;nt<Rt.length;nt++){var vt=Rt[nt];vt.enumerable=vt.enumerable||!1,vt.configurable=!0,"value"in vt&&(vt.writable=!0),Object.defineProperty(qt,vt.key,vt)}}function It(){return!0}function xt(qt){return qt===null}function At(qt){return qt!==null}s(9753),s(1038),s(4553),s(9070);var Nt=function(){function qt(){(function(vt,Tt){if(!(vt instanceof Tt))throw new TypeError("Cannot call a class as a function")})(this,qt),this._callbacks=[],this._timeout=null,this._err=null,this._data=null,this._interrupted=null,this._fulfilled=!1}var Rt,nt;return Rt=qt,nt=[{key:"err",get:function(){if(!this._fulfilled)throw new Error("not fulfilled yet");return this._err}},{key:"data",get:function(){if(!this._fulfilled)throw new Error("not fulfilled yet");return this._data}},{key:"interrupted",get:function(){if(!this._fulfilled)throw new Error("not fulfilled yet");return this._interrupted}},{key:"fulfilled",get:function(){return this._fulfilled}},{key:"_fulfill",value:function(vt,Tt,Pt){this._err=vt,this._data=Tt,this._interrupted=Pt,this._fulfilled=!0;var wt=this._callbacks.slice();this.clear();var Dt,Et=function(Kt,rn){var hn=typeof Symbol<"u"&&Kt[Symbol.iterator]||Kt["@@iterator"];if(!hn){if(Array.isArray(Kt)||(hn=function(Dn,Bn){if(Dn){if(typeof Dn=="string")return mt(Dn,Bn);var sr=Object.prototype.toString.call(Dn).slice(8,-1);return sr==="Object"&&Dn.constructor&&(sr=Dn.constructor.name),sr==="Map"||sr==="Set"?Array.from(Dn):sr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(sr)?mt(Dn,Bn):void 0}}(Kt))||rn&&Kt&&typeof Kt.length=="number"){hn&&(Kt=hn);var an=0,un=function(){};return{s:un,n:function(){return an>=Kt.length?{done:!0}:{done:!1,value:Kt[an++]}},e:function(Dn){throw Dn},f:un}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Sn,En=!0,An=!1;return{s:function(){hn=hn.call(Kt)},n:function(){var Dn=hn.next();return En=Dn.done,Dn},e:function(Dn){An=!0,Sn=Dn},f:function(){try{En||hn.return==null||hn.return()}finally{if(An)throw Sn}}}}(wt);try{for(Et.s();!(Dt=Et.n()).done;){var jt=Dt.value,Yt=jt.match,en=jt.callback;Yt(this._err)&&en(this._err,this._data,this._interrupted)}}catch(Kt){Et.e(Kt)}finally{Et.f()}}},{key:"clear",value:function(){this.clearTimeout(),this.removeCallback()}},{key:"setTimeout",value:function(vt){function Tt(Pt,wt,Dt){return vt.apply(this,arguments)}return Tt.toString=function(){return vt.toString()},Tt}(function(vt,Tt,Pt){var wt=this;this.clearTimeout(),this._timeout=setTimeout(Tt===null?function(){wt._fulfill(null,Pt,!0)}:function(){wt._fulfill(typeof Tt=="string"?new Error(Tt):Tt,void 0,!0)},vt)})},{key:"clearTimeout",value:function(vt){function Tt(){return vt.apply(this,arguments)}return Tt.toString=function(){return vt.toString()},Tt}(function(){this._timeout!==null&&(clearTimeout(this._timeout),this._timeout=null)})},{key:"onFulfillment",value:function(vt){this._callbacks.push({match:It,callback:vt})}},{key:"onSuccess",value:function(vt){this._callbacks.push({match:xt,callback:vt})}},{key:"onFailure",value:function(vt){this._callbacks.push({match:At,callback:vt})}},{key:"removeCallback",value:function(vt){if(typeof vt=="function"){var Tt=this._callbacks.findIndex(function(Pt){return Pt.callback===vt});Tt>=0&&this._callbacks.splice(Tt,1)}else this._callbacks.splice(0,this._callbacks.length)}},{key:"fulfill",value:function(vt,Tt){vt===null?this._fulfill(null,Tt,!1):this._fulfill(typeof vt=="string"?new Error(vt):vt,void 0,!1)}}],nt&&St(Rt.prototype,nt),Object.defineProperty(Rt,"prototype",{writable:!1}),qt}(),kt=(s(1249),s(7327),s(3843),function(qt,Rt,nt,vt,Tt,Pt,wt,Dt){this.rawStats={},this.rawStats.connectedPair=[],this.rawStats.audio_send=[],this.rawStats.audio_recv=[],this.rawStats.video_send=[],this.rawStats.video_recv=[],this.instantRTT=0,this.moyRttCP=[0,0,0,0,0,0,0,0,0,0],this.moyRttAS=[0,0,0,0,0,0,0,0,0,0],this.moyRttVS=[0,0,0,0,0,0,0,0,0,0],this.tauxPacketLossAS=[0],this.oldLostAS=this.oldSentAS=0,this.oldLostVS=this.oldLostVS=0,this.cptTaux=0,this.tauxPacketLossVS=[0],this.oldBandwidthAS=0,this.oldBandwidthVS=0,this.oldBandwidthAR=0,this.oldBandwidthVR=0,this.bandwidthAS=[0,0,0,0,0,0,0,0,0,0],this.bandwidthAR=[0,0,0,0,0,0,0,0,0,0],this.bandwidthVS=[0,0,0,0,0,0,0,0,0,0],this.bandwidthVR=[0,0,0,0,0,0,0,0,0,0],this.qosIn=0,this.qosInAverage=0,this.qosInAverageCount=0,this.qosAudioIn=0,this.qosAudioInAverage=0,this.qosAudioInAverageCount=0,this.qosVideoIn=0,this.qosVideoInAverage=0,this.qosVideoInAverageCount=0,this.qosOut=0,this.qosOutAverage=0,this.qosOutAverageCount=0,this.qosAudioOut=0,this.qosAudioOutAverage=0,this.qosAudioOutAverageCount=0,this.qosVideoOut=0,this.qosVideoOutAverage=0,this.qosVideoOutAverageCount=0,this.onQosChange=Rt,this.onQosAudioChange=nt,this.onQosVideoChange=vt,this.cpt=0,this.cptRes=5,this.cptDb=60,this.saveStatsFlag=!0,this.tabQosIn=[],this.tabQosAudioIn=[],this.tabQosVideoIn=[],this.tabQosOut=[],this.tabQosAudioOut=[],this.tabQosVideoOut=[],this.tabTimestamp=[],this.tabDelay=[],this.tabJitterBufferAudio=[],this.tabJitterBufferVideo=[],this.tabAudioRtt=[],this.tabVideoRtt=[],this.tabAudioBW=[],this.tabVideoBW=[],this.clientId=wt,this.callId=Tt,this.apiKey=Pt,this.socket=Dt,this.interval=qt,this.insertStats=function(Et,jt,Yt,en){var Kt,rn,hn,an=null;for(this.cpt=this.cpt+this.interval,Kt=0;Kt<Et.length;++Kt){var un=Et[Kt];switch(un.type){case"googCandidatePair":for(an=un.names(),hn=0;hn<an.length;++hn)if(an[hn]=="googActiveConnection"&&un.stat(an[hn])=="true")for(rn=0;rn<an.length;++rn)an[rn]=="bytesSent"&&un.stat(an[rn])!==void 0&&(this.rawStats.connectedPair.bytesSent=un.stat(an[rn])),an[rn]=="bytesReceived"&&un.stat(an[rn])!==void 0&&(this.rawStats.connectedPair.bytesReceived=un.stat(an[rn])),an[rn]=="googRtt"&&un.stat(an[rn])!==void 0&&(this.rawStats.connectedPair.googRtt=un.stat(an[rn]));break;case"ssrc":for(an=un.names(),hn=0;hn<an.length;++hn){if(an[hn]=="audioOutputLevel")for(rn=0;rn<an.length;++rn)an[rn]=="packetsLost"&&un.stat(an[rn])!==void 0&&(this.rawStats.audio_recv.packetsLost=un.stat(an[rn])),an[rn]=="googDecodingPLC"&&un.stat(an[rn])!==void 0&&(this.rawStats.audio_recv.googDecodingPLC=un.stat(an[rn])),an[rn]=="googJitterReceived"&&un.stat(an[rn])!==void 0&&(this.rawStats.audio_recv.googJitterReceived=un.stat(an[rn])),an[rn]=="googJitterBufferMs"&&un.stat(an[rn])!==void 0&&(this.rawStats.audio_recv.googJitterBufferMs=un.stat(an[rn])),an[rn]=="googCurrentDelayMs"&&un.stat(an[rn])!==void 0&&(this.rawStats.audio_recv.googCurrentDelayMs=un.stat(an[rn])),an[rn]=="bytesReceived"&&un.stat(an[rn])!==void 0&&(this.rawStats.audio_recv.bytesReceived=un.stat(an[rn]));if(an[hn]=="audioInputLevel")for(rn=0;rn<an.length;++rn)an[rn]=="googRtt"&&un.stat(an[rn])!==void 0&&un.stat(an[rn])!=-1&&(this.rawStats.audio_send.googRtt=un.stat(an[rn])),an[rn]=="packetsLost"&&un.stat(an[rn])!==void 0&&(this.rawStats.audio_send.packetsLost=un.stat(an[rn])),an[rn]=="packetsSent"&&un.stat(an[rn])!==void 0&&(this.rawStats.audio_send.packetsSent=un.stat(an[rn])),an[rn]=="bytesSent"&&un.stat(an[rn])!==void 0&&(this.rawStats.audio_send.bytesSent=un.stat(an[rn])),an[rn]=="googJitterReceived"&&un.stat(an[rn])!==void 0&&(this.rawStats.audio_send.googJitterReceived=un.stat(an[rn]));if(an[hn]=="googFrameHeightReceived")for(rn=0;rn<an.length;++rn)an[rn]=="googFrameHeightReceived"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_recv.FrameHeight=un.stat(an[rn])),an[rn]=="googFrameWidthReceived"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_recv.FrameWidth=un.stat(an[rn])),an[rn]=="googCurrentDelayMs"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_recv.delay=un.stat(an[rn])),an[rn]=="packetsLost"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_recv.packetsLost=un.stat(an[rn])),an[rn]=="googNacksSent"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_recv.googNacksSent=un.stat(an[rn])),an[rn]=="googJitterBufferMs"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_recv.googJitterBufferMs=un.stat(an[rn])),an[rn]=="bytesReceived"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_recv.bytesReceived=un.stat(an[rn])),an[rn]=="googFrameRateReceived"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_recv.googFrameRateReceived=un.stat(an[rn]));if(an[hn]=="googFrameHeightSent")for(rn=0;rn<an.length;++rn)an[rn]=="googFrameHeightSent"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_send.FrameHeight=un.stat(an[rn])),an[rn]=="googFrameWidthSent"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_send.FrameWidth=un.stat(an[rn])),an[rn]=="packetsLost"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_send.packetsLost=un.stat(an[rn])),an[rn]=="googNacksReceived"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_send.googNacksReceived=un.stat(an[rn])),an[rn]=="googRtt"&&un.stat(an[rn])!==void 0&&un.stat(an[rn])!=-1&&(this.rawStats.video_send.googRtt=un.stat(an[rn])),an[rn]=="packetsSent"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_send.packetsSent=un.stat(an[rn])),an[rn]=="bytesSent"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_send.bytesSent=un.stat(an[rn])),an[rn]=="googEncodeUsagePercent"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_send.googEncodeUsagePercent=un.stat(an[rn])),an[rn]=="googCpuLimitedResolution"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_send.googCpuLimitedResolution=un.stat(an[rn])),an[rn]=="googBandwidthLimitedResolution"&&un.stat(an[rn])!==void 0&&(this.rawStats.video_send.googBandwidthLimitedResolution=un.stat(an[rn]))}}}this.computeStats(jt,Yt,en),this.cpt%this.cptRes==0&&this.saveStatsLocal(),this.cpt%this.cptDb==0&&this.saveStatsToDb(!1)},this.saveStatsLocal=function(){if(this.saveStatsFlag){var Et=Date.now();this.tabTimestamp.push(Et),this.tabQosIn.push(this.qosIn),this.tabQosAudioIn.push(this.qosAudioIn),this.qosVideoIn!==0&&this.tabQosVideoIn.push(this.qosVideoIn),this.tabQosOut.push(this.qosOut),this.tabQosAudioOut.push(this.qosAudioOut),this.qosVideoOut!==0&&this.tabQosVideoOut.push(this.qosVideoOut),this.tabJitterBufferAudio.push(this.rawStats.audio_recv.googJitterBufferMs),this.rawStats.video_recv.googJitterBufferMs!==void 0&&this.tabJitterBufferVideo.push(this.rawStats.video_recv.googJitterBufferMs),this.rawStats.video_send.googRtt!==void 0&&this.tabVideoRtt.push(this.rawStats.video_send.googRtt),this.tabAudioRtt.push(this.rawStats.audio_send.googRtt),this.bandwidthAS!==void 0&&this.tabVideoBW.push(8*this.Average(this.bandwidthAS)/1024),this.bandwidthVS!==void 0&&this.tabVideoBW.push(8*this.Average(this.bandwidthVS)/1024),this.bandwidthAR!==void 0&&this.tabVideoBW.push(8*this.Average(this.bandwidthAR)/1024),this.bandwidthVR!==void 0&&this.tabVideoBW.push(8*this.Average(this.bandwidthVR)/1024)}},this.saveStatsToDb=function(Et){},this.saveStatsToDb=function(Et){this.saveStatsFlag=Et},this.computeStats=function(Et,jt,Yt){var en=0;this.rawStats.connectedPair.googRtt!==-1&&this.rawStats.connectedPair.googRtt!==0&&this.rawStats.connectedPair.googRtt!==void 0&&this.add(this.rawStats.connectedPair.googRtt,this.moyRttCP),this.rawStats.video_send.googRtt!==-1&&this.rawStats.video_send.googRtt!==0&&this.rawStats.video_send.googRtt!==void 0&&(this.add(this.rawStats.video_send.googRtt,this.moyRttVS),this.instantRTT=this.rawStats.video_send.googRtt),this.rawStats.audio_send.googRtt!==-1&&this.rawStats.audio_send.googRtt!==0&&this.rawStats.audio_send.googRtt!==void 0&&this.add(this.rawStats.audio_send.googRtt,this.moyRttAS),this.rawStats.audio_send.packetsLost!==-1&&this.rawStats.audio_send.packetsLost!==void 0&&this.rawStats.audio_send.packetsSent!==-1&&this.rawStats.audio_send.packetsSent!==0&&this.rawStats.audio_send.packetsSent!==void 0&&(en=100*(this.rawStats.audio_send.packetsLost-this.oldLostAS)/(this.rawStats.audio_send.packetsSent-this.oldSentAS),this.oldLostAS=this.rawStats.audio_send.packetsLost,this.oldSentAS=this.rawStats.audio_send.packetsSent,this.add(en,this.tauxPacketLossAS)),this.rawStats.video_send.packetsLost!==-1&&this.rawStats.video_send.packetsLost!==void 0&&this.rawStats.video_send.packetsSent!==-1&&this.rawStats.video_send.packetsSent!==0&&this.rawStats.video_send.packetsSent!==void 0&&(en=100*(this.rawStats.video_send.packetsLost-this.oldLostVS)/(this.rawStats.video_send.packetsSent-this.oldSentVS),this.oldLostVS=this.rawStats.video_send.packetsLost,this.oldSentVS=this.rawStats.video_send.packetsSent,this.add(en,this.tauxPacketLossVS)),this.rawStats.audio_recv.bytesReceived!==-1&&this.rawStats.audio_recv.bytesReceived!==void 0&&(this.oldBandwidthAR===void 0&&(this.oldBandwidthAR=0),this.add((this.rawStats.audio_recv.bytesReceived-this.oldBandwidthAR)/this.interval,this.bandwidthAR),this.oldBandwidthAR=this.rawStats.audio_recv.bytesReceived),this.rawStats.video_recv.bytesReceived!==-1&&this.rawStats.video_recv.bytesReceived!==void 0&&(this.oldBandwidthVR===void 0&&(this.oldBandwidthVR=0),this.add((this.rawStats.video_recv.bytesReceived-this.oldBandwidthVR)/this.interval,this.bandwidthVR),this.oldBandwidthVR=this.rawStats.video_recv.bytesReceived),this.rawStats.audio_send.bytesSent!==-1&&this.rawStats.audio_send.bytesSent!==void 0&&(this.oldBandwidthAS===void 0&&(this.oldBandwidthAS=0),this.add((this.rawStats.audio_send.bytesSent-this.oldBandwidthAS)/this.interval,this.bandwidthAS),this.oldBandwidthAS=this.rawStats.audio_send.bytesSent),this.rawStats.video_send.bytesSent!==-1&&this.rawStats.video_send.bytesSent!==void 0&&(this.oldBandwidthVS===void 0&&(this.oldBandwidthVS=0),this.add((this.rawStats.video_send.bytesSent-this.oldBandwidthVS)/this.interval,this.bandwidthVS),this.oldBandwidthVS=this.rawStats.video_send.bytesSent);var Kt=0,rn=0,hn=0,an=0,un=0,Sn=0,En=0,An=0,Dn=0,Bn=0,sr=this.getCodecs(jt),fr=8*this.Average(this.bandwidthAS)/1024;if(fr<5?Kt=1:fr>=5&&fr<10?Kt=2:fr>=10&&(Kt=3),sr!==null&&sr[1]){var Cr=8*this.Average(this.bandwidthVS)/1024;Cr<240?an=1:Cr>=240&&Cr<330?an=2:Cr>=330&&(an=3)}this.rawStats.audio_recv.googJitterBufferMs<60?rn=3:this.rawStats.audio_recv.googJitterBufferMs>=60&&this.rawStats.audio_recv.googJitterBufferMs<100?rn=2:this.rawStats.audio_recv.googJitterBufferMs>=100&&(rn=1),this.rawStats.audio_recv.googCurrentDelayMs<100?hn=3:this.rawStats.audio_recv.googCurrentDelayMs>=100&&this.rawStats.audio_recv.googCurrentDelayMs<200?hn=2:this.rawStats.audio_recv.googCurrentDelayMs>=200&&(hn=1),sr!==null&&sr[1]&&(this.rawStats.video_recv.googJitterBufferMs<100?un=3:this.rawStats.video_recv.googJitterBufferMs>=100&&this.rawStats.video_recv.googJitterBufferMs<200?un=2:this.rawStats.video_recv.googJitterBufferMs>=200&&(un=1));var gr=!1,wr=!1,Nr=!1;sr!==null&&sr[1]?(Math.ceil((Kt+2*an+un+rn+hn)/6)!=this.qosIn&&(gr=!0),this.qosIn=Math.ceil((Kt+2*an+un+rn+hn)/6),this.qosInAverage=(this.qosInAverage*this.qosInAverageCount+this.qosIn)/(this.qosInAverageCount+1),this.qosInAverageCount++,Math.ceil((Kt+rn+hn)/3)!=this.qosAudioIn&&(wr=!0),this.qosAudioIn=Math.ceil((Kt+rn+hn)/3),this.qosAudioInAverage=(this.qosAudioInAverage*this.qosAudioInAverageCount+this.qosAudioIn)/(this.qosAudioInAverageCount+1),this.qosAudioInAverageCount++,Math.ceil((2*an+un)/3)!=this.qosVideoIn&&(Nr=!0),this.qosVideoIn=Math.ceil((2*an+un)/3),this.qosVideoInAverage=(this.qosVideoInAverage*this.qosVideoInAverageCount+this.qosVideoIn)/(this.qosVideoInAverageCount+1),this.qosVideoInAverageCount++):(Math.ceil((Kt+rn+hn)/3)!=this.qosOut&&(gr=!0),this.qosIn=Math.ceil((Kt+rn+hn)/3),this.qosInAverage=(this.qosInAverage*this.qosInAverageCount+this.qosIn)/(this.qosInAverageCount+1),this.qosInAverageCount++,Math.ceil((Kt+rn+hn)/3)!=this.qosAudioIn&&(wr=!0),this.qosAudioIn=Math.ceil((Kt+rn+hn)/3),this.qosAudioInAverage=(this.qosAudioInAverage*this.qosAudioInAverageCount+this.qosAudioIn)/(this.qosAudioInAverageCount+1),this.qosAudioInAverageCount++),this.RttAverage(this.moyRttAS)<80?En=3:this.RttAverage(this.moyRttAS)>=80&&this.RttAverage(this.moyRttAS)<150?En=2:this.RttAverage(this.moyRttAS)>=150&&(En=1),this.tauxPacketLossAS<=5?Sn=3:this.tauxPacketLossAS>5&&this.tauxPacketLossAS<10?Sn=2:this.tauxPacketLossAS>=10&&(Sn=1),this.rawStats.audio_recv.googJitterReceived<80?An=3:this.rawStats.audio_recv.googJitterReceived>=80&&this.rawStats.audio_recv.googJitterReceived<150?An=2:this.rawStats.audio_recv.googJitterReceived>=150&&(An=1),sr!==null&&sr[1]&&(this.tauxPacketLossVS<=5?Dn=3:this.tauxPacketLossVS>5&&this.tauxPacketLossVS<10?Dn=2:this.tauxPacketLossVS>=10&&(Dn=1),this.RttAverage(this.moyRttVS)<80?Bn=3:this.RttAverage(this.moyRttVS)>=80&&this.RttAverage(this.moyRttVS)<150?Bn=2:this.RttAverage(this.moyRttVS)>=150&&(Bn=1)),sr!==null&&sr[1]?(Math.ceil((En+2*Sn+An+2*Dn+Bn)/7)!=this.qosOut&&(gr=!0),this.qosOut=Math.ceil((En+2*Sn+An+2*Dn+Bn)/7),this.qosOutAverage=(this.qosOutAverage*this.qosOutAverageCount+this.qosOut)/(this.qosOutAverageCount+1),this.qosOutAverageCount++,Math.ceil((En+2*Sn+An)/4)!=this.qosAudioOut&&(wr=!0),this.qosAudioOut=Math.ceil((En+2*Sn+An)/4),this.qosAudioOutAverage=(this.qosAudioOutAverage*this.qosAudioOutAverageCount+this.qosAudioOut)/(this.qosAudioOutAverageCount+1),this.qosAudioOutAverageCount++,Math.ceil((2*Dn+Bn)/3)!=this.qosVideoOut&&(Nr=!0),this.qosVideoOut=Math.ceil((2*Dn+Bn)/3),this.qosVideoOutAverage=(this.qosVideoOutAverage*this.qosVideoOutAverageCount+this.qosVideoOut)/(this.qosVideoOutAverageCount+1),this.qosVideoOutAverageCount++):(Math.ceil((En+2*Sn+An)/4)!=this.qosOut&&(gr=!0),this.qosOut=Math.ceil((En+2*Sn+An)/4),this.qosOutAverage=(this.qosOutAverage*this.qosOutAverageCount+this.qosOut)/(this.qosOutAverageCount+1),this.qosOutAverageCount++,Math.ceil((En+2*Sn+An)/4)!=this.qosAudioOut&&(wr=!0),this.qosAudioOut=Math.ceil((En+2*Sn+An)/4),this.qosAudioOutAverage=(this.qosAudioOutAverage*this.qosAudioOutAverageCount+this.qosAudioOut)/(this.qosAudioOutAverageCount+1),this.qosAudioOutAverageCount++),gr&&this.onQosChange(this.qosIn,this.qosOut),wr&&this.onQosAudioChange(this.qosAudioIn,this.qosAudioOut),Nr&&this.onQosVideoChange(this.qosVideoIn,this.qosVideoOut)},this.getCodecs=function(Et){var jt=!1,Yt=!1,en=null,Kt=null;if(Et!=null&&Et.sdp!==void 0){for(var rn=Et.sdp.split(`
`),hn=0;hn<rn.length;hn++)rn[hn].indexOf("a=mid:audio")!=-1&&(jt=!0),rn[hn].indexOf("a=mid:video")!=-1&&(Yt=!0),jt&&rn[hn].indexOf("a=rtpmap:")!=-1&&(en=rn[hn],jt=!1),Yt&&rn[hn].indexOf("a=rtpmap:")!=-1&&(Kt=rn[hn],Yt=!1);return[en,Kt]}return null},this.getQosScore=function(){return[this.qosIn,this.qosOut,this.qosAudioIn,this.qosAudioOut,this.qosVideoIn,this.qosVideoOut]},this.getStat=function(Et){switch(Et){case"AudioOutBandwidth":return 8*this.Average(this.bandwidthAS)/1024;case"VideoOutBandwidth":return 8*this.Average(this.bandwidthVS)/1024;case"AudioInBandwidth":return 8*this.Average(this.bandwidthAR)/1024;case"VideoInBandwidth":return 8*this.Average(this.bandwidthVR)/1024;case"AudioInJitterReceived":return this.rawStats.audio_recv.googJitterReceived;case"AudioInJitterBufferMs":return this.rawStats.audio_recv.googJitterBufferMs;case"AudioInDelay":return this.rawStats.audio_recv.googCurrentDelayMs;case"AudioOutLossRate":return this.tauxPacketLossAS;case"AudioOutRtt":return this.RttAverage(this.moyRttAS);case"AudioOutJitterReceived":return this.rawStats.audio_send.googJitterReceived;case"VideoInJitterBufferMs":return this.rawStats.video_recv.googJitterBufferMs;case"VideoOutLossRate":return this.tauxPacketLossVS;case"VideoOutRtt":return this.RttAverage(this.moyRttVS)}},this.getAllStats=function(){for(var Et={AudioRecv:{},AudioSend:{},VideoRecv:{},VideoSend:{}},jt={AudioRecv:"audio_recv",VideoRecv:"video_recv",AudioSend:"audio_send",VideoSend:"video_send"},Yt=Object.keys(jt),en=0;en<Yt.length;en++)for(var Kt=Object.keys(this.rawStats[jt[Yt[en]]]),rn=0;rn<Kt.length;rn++)Et[Yt[en]][Kt[rn]]=this.rawStats[jt[Yt[en]]][Kt[rn]];return Et.AudioRecv.bandwidth=8*this.Average(this.bandwidthAR)/1024,Et.VideoRecv.bandwidth=8*this.Average(this.bandwidthVR)/1024,Et.AudioSend.bandwidth=8*this.Average(this.bandwidthAS)/1024,Et.VideoSend.bandwidth=8*this.Average(this.bandwidthVS)/1024,Et.AudioRecv.jitterReceived=this.rawStats.audio_recv.googJitterReceived,Et.AudioRecv.jitterBufferMs=this.rawStats.audio_recv.googJitterBufferMs,Et.VideoRecv.jitterBufferMs=this.rawStats.video_recv.googJitterBufferMs,Et.AudioRecv.delay=this.rawStats.audio_recv.googCurrentDelayMs,Et.AudioSend.rtt=this.RttAverage(this.moyRttAS),Et.VideoSend.moyRtt=this.RttAverage(this.moyRttVS),Et.VideoSend.rtt=this.instantRTT,Et.VideoSend.FrameHeight=this.rawStats.video_send.FrameHeight,Et.VideoSend.FrameWidth=this.rawStats.video_send.FrameWidth,Et.AudioSend.packetLostRatio=this.tauxPacketLossAS[this.tauxPacketLossAS.length-1],Et.VideoSend.packetLostRatio=this.tauxPacketLossVS[this.tauxPacketLossVS.length-1],Et.VideoSend.googEncodeUsagePercent=this.rawStats.video_send.googEncodeUsagePercent,Et.VideoSend.googCpuLimitedResolution=this.rawStats.video_send.googCpuLimitedResolution,Et.VideoSend.googBandwidthLimitedResolution=this.rawStats.video_send.googBandwidthLimitedResolution,delete Et.AudioRecv.googCurrentDelayMs,delete Et.AudioRecv.googJitterReceived,delete Et.AudioRecv.googJitterBufferMs,delete Et.VideoRecv.googJitterBufferMs,delete Et.AudioSend.googRtt,delete Et.VideoSend.googRtt,Et},this.displayComputedStats=function(){console.log("Audio IN JitterReceived:"+this.rawStats.audio_recv.googJitterReceived+" jitterbufferMs:"+this.rawStats.audio_recv.googJitterBufferMs+" delay:"+this.rawStats.audio_recv.googCurrentDelayMs+" bandwidth :"+8*this.Average(this.bandwidthAS)/1024+" kBits/s"),console.log("Audio OUT  lossRate:"+this.tauxPacketLossAS+" rtt:"+this.RttAverage(this.moyRttAS)+" googJitterReceived:"+this.rawStats.audio_recv.googJitterReceived),console.log("Video IN jitter buffer ms:"+this.rawStats.video_recv.googJitterBufferMs+" bandwidth:"+8*this.Average(this.bandwidthVS)/1024+" kBits/s"),console.log("Video OUT loss rate:"+this.tauxPacketLossVS+" rtt:"+this.RttAverage(this.moyRttVS))},this.RttAverage=function(Et){for(var jt=0,Yt=0,en=0;en<Et.length;++en)Et[en]!==0&&Et[en]!==-1&&Et[en]!==void 0&&(jt+=parseInt(Et[en],10),Yt++);return parseInt(jt/Yt,10)},this.Average=function(Et){for(var jt=0,Yt=0,en=0;en<Et.length;++en)Et[en]!=-1&&Et[en]!==void 0&&(jt+=parseInt(Et[en],10),Yt++);return parseInt(jt/Yt,10)},this.add=function(Et,jt){jt.pop(),jt.unshift(Et)},this.displayTab=function(Et){for(var jt in Et)console.log(jt+" = "+Et[jt])}}),Mt=tt.Y.get("DataChannelFileSender"),bt=apiCC.myWebRTC_Event,Bt=1<<17,Ht=function(qt){this.call=qt,this.sendChunkNb=0,this.send=function(Rt,nt,vt){var Tt=12e3,Pt={},wt=null,Dt={},Et=!1,jt={};if(Mt.info("DataChannelFileSender send"),Mt.log("data.name :"+Rt.name),Rt.file instanceof Blob?(Mt.log("Blob"),this.blob=Rt.file,this.contentType=Rt.file.type,this.size=Rt.file.size,this.originalDataType="Blob"):Rt.file instanceof ArrayBuffer?(Mt.log("ArrayBuffer"),this.blob=Rt.file,this.contentType="application/octet-stream",this.size=Rt.file.byteLength,this.originalDataType="ArrayBuffer"):Rt.file instanceof String||typeof Rt.file=="string"?(Mt.log("string"),this.blob=Rt.file,this.size=Rt.file.length,this.contentType="application/octet-stream",this.originalDataType="String"):(Mt.log("unknown type"),this.blob=Rt.file,this.contentType="application/octet-stream",this.size=Rt.file.length||Rt.file.byteLength||Rt.file.size,this.originalDataType="Unknown"),this.contentType||(this.contentType="application/octet-stream"),this.size===0)return Mt.log("sending done"),vt!==void 0&&(Mt.log("onProgress"),this.transferDuration=new Date-this.startingDate,vt({sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:qt.callId,uuid:Rt.uuid,remoteId:qt.remoteId,lastPacket:Et,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!0})),bt.createEvent({eventType:"onFileProgress",sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:qt.callId,uuid:Rt.uuid,remoteId:qt.remoteId,lastPacket:Et,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!0}),void bt.createEvent({eventType:"onFileSended",callId:qt.callId,remoteId:qt.remoteId,name:Rt.name,uuid:Rt.uuid});if(nt)if(nt.readyState==="open"){if(this.sendChunkNb===0&&Mt.log("first packet"),this.sendChunkNb===0){Rt.uuid=(Math.random()*new Date().getTime()).toString(36).replace(/\./g,"-"),Dt={name:Rt.name,type:Rt.type,size:this.size,contentType:this.contentType,uuid:Rt.uuid},Mt.log("first packet",Dt),this.fileSize=this.size,vt!==void 0&&(Mt.log("onProgress"),this.startingDate=new Date,this.transferDuration=0,vt({sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:qt.callId,uuid:Rt.uuid,remoteId:qt.remoteId,lastPacket:Et,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!1}),bt.createEvent({eventType:"onFileProgress",sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:qt.callId,uuid:Rt.uuid,remoteId:qt.remoteId,lastPacket:Et,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!1}));try{nt.send(JSON.stringify(Dt))}catch(Yt){Mt.warn("error detected when sending on datachannel :",nt),Mt.warn("error is :",Yt)}bt.createEvent({eventType:"onFileSending",callId:qt.callId,remoteId:qt.remoteId,name:Rt.name,uuid:Rt.uuid})}else{Tt<this.size?(Mt.log("sending chunk"),Pt=this.blob.slice(0,Tt)):(Mt.log("sending last chunk"),Pt=this.blob.slice(0),Et=!0),Mt.log("dataToSend.byteLength ="+Pt.byteLength),this.originalDataType==="ArrayBuffer"?jt.message=ct.cw.encode(Pt):jt.message=Pt,jt.messageSize=Pt.byteLength,jt.uuid=Rt.uuid,jt.originalDataType=this.originalDataType,vt!==void 0&&(Mt.log("onProgress"),this.transferDuration=new Date-this.startingDate,vt({sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:qt.callId,uuid:Rt.uuid,remoteId:qt.remoteId,startingDate:this.startingDate,lastPacket:Et,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!1}),bt.createEvent({eventType:"onFileProgress",sendChunkNb:this.sendChunkNb,fileSize:this.fileSize,remainingSize:this.size,callId:qt.callId,uuid:Rt.uuid,remoteId:qt.remoteId,startingDate:this.startingDate,lastPacket:Et,transferDuration:this.transferDuration,percentage:parseInt(100*(this.fileSize-this.size)/this.fileSize,10),transferEnded:!1}));try{nt.send(JSON.stringify(jt))}catch(Yt){Mt.warn("error detected when sending on datachannel :",nt),Mt.warn("error is :",Yt)}}wt=this.sendChunkNb===0?this.blob:this.blob.slice(Tt),Et===!1?this.sendChunkNb++:this.sendChunkNb=0,Rt.file=wt,setTimeout((function(){this.send(Rt,nt,vt)}).bind(this))}else Mt.log("Trying to send on a closed channel");else Mt.log("No data channel to send data")},this.terminateTransfer=function(){var Rt=this;Mt.debug("terminateTransfer; terminated: "+this.terminated),this.channel!==null?this.useBufferedAmount===!0&&this.channel.bufferedAmount>0&&this.canceled!==!0?setTimeout(this.terminateTransfer.bind(this)):this.terminated!==!0&&(this.terminated=!0,this.recvDataEndAckTimeoutId&&(clearTimeout(this.recvDataEndAckTimeoutId),delete this.recvDataEndAckTimeoutId),delete this.call.dcfs,Mt.debug("terminateTransfer; terminating"),this.call.pipelineCallId?(this.call.pipelineCall&&(delete this.call.pipelineCall.clientCall,delete this.call.pipelineCall,this.call.sendDataChannel=null),this.channel=null):setTimeout(function(){Rt.channel.close(),Rt.channel=null}),setTimeout(function(){if(Rt.canceled===!0)bt.createEvent({eventType:"onFileSended",callId:Rt.call.callId,remoteId:Rt.call.remoteId,name:Rt.call.data.filename,error:"canceled"}),Rt.call.callbacks.failure("canceled");else if(Rt.call.failure)bt.createEvent({eventType:"onFileSended",callId:Rt.call.callId,remoteId:Rt.call.remoteId,name:Rt.call.data.filename,error:Rt.call.failure}),Rt.call.callbacks.failure(Rt.call.failure);else{var nt={eventType:"onFileSended",callId:Rt.call.callId,remoteId:Rt.call.remoteId,name:Rt.call.data.filename};Rt.call.success.data&&(nt.data=Rt.call.success.data),bt.createEvent(nt),Rt.call.callbacks.success(Rt.call.success)}apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Rt.call.callId)})):Mt.warn("No data channel to send data, leaving terminateTransfer")},this.recvDataEndAckTimeout=function(){Mt.error("recvDataEndAckTimeout"),this.call.failure="ackNotReceived",setTimeout(this.terminateTransfer.bind(this))},this.subsequentTransfer=function(){var Rt,nt=!1;if(Mt.debug("subsequentTransfer; remByteCount: "+this.remByteCount),this.canceled!==!0)if(this.channel!==null)if(this.useBufferedAmount===!0&&this.channel.bufferedAmount>Bt)setTimeout(this.subsequentTransfer.bind(this));else try{for(;;){if(!(this.remByteCount>=this.chunkLength)){Rt=this.data.slice(this.offset,this.offset+this.remByteCount),this.channel.send(Rt),this.packetsSent+=1,Mt.debug("packetSent "+this.packetsSent+" "+this.remByteCount),this.offset+=this.remByteCount,this.remByteCount-=this.remByteCount,nt=!0;break}if(Rt=this.data.slice(this.offset,this.offset+this.chunkLength),this.channel.send(Rt),this.packetsSent+=1,Mt.debug("packetSent "+this.packetsSent+" "+this.chunkLength),this.offset+=this.chunkLength,this.remByteCount-=this.chunkLength,this.remByteCount<=0){nt=!0;break}if(this.useBufferedAmount!==!0||this.channel.bufferedAmount>Bt)break}nt===!0?(bt.createEvent({eventType:"onFileProgress",name:this.call.data.filename,sendChunkNb:this.packetsSent,fileSize:this.call.data.size,remainingSize:this.remByteCount,callId:this.call.callId,remoteId:this.call.remoteId,percentage:100}),this.call.callbacks.progress({state:"complete",filename:this.call.data.filename,size:this.call.data.size,remBytes:0,progress:100}),this.call.success={state:"complete",filename:this.call.data.filename,size:this.call.data.size,mediaURL:this.call.mediaURL,mediaId:this.call.mediaId},this.recvDataEndAckTimeoutId=setTimeout(this.recvDataEndAckTimeout.bind(this),3e4)):(bt.createEvent({eventType:"onFileProgress",name:this.call.data.filename,sendChunkNb:this.packetsSent,fileSize:this.call.data.size,remainingSize:this.remByteCount,callId:this.call.callId,remoteId:this.call.remoteId,percentage:Math.floor(100*this.offset/this.call.data.size)}),this.call.callbacks.progress({state:"incomplete",filename:this.call.data.filename,size:this.call.data.size,remBytes:this.remByteCount,progress:Math.floor(100*this.offset/this.call.data.size)}),setTimeout(this.subsequentTransfer.bind(this)))}catch(vt){return Mt.error("transfer: "+vt),this.call.failure="dataChannelFailed",void setTimeout(this.terminateTransfer.bind(this))}else Mt.warn("No data channel to send data, leaving subsequentTransfer");else setTimeout(this.terminateTransfer.bind(this))},this.transfer=function(Rt,nt,vt){var Tt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},Pt=Tt.hasOwnProperty("delay")?Tt.delay:100;if(Mt.info("transfer",nt,Pt),this.call.beginTimeoutId&&(clearTimeout(this.call.beginTimeoutId),delete this.call.beginTimeoutId),this.data=Rt,this.channel=vt,this.channel!==null){typeof this.channel.bufferedAmount=="number"&&this.channel.bufferedAmount>=0&&(Mt.debug("browserDetails",ct.wL),ct.wL.type==="chrome"?ct.wL.version>=37&&(this.useBufferedAmount=!0,Mt.debug("useBufferedAmount enabled")):(this.useBufferedAmount=!0,Mt.debug("useBufferedAmount enabled"))),this.chunkLength=8192,nt>0?(this.offset=Math.floor(nt/this.chunkLength)*this.chunkLength,this.remByteCount=this.data.byteLength-this.offset):(this.offset=0,this.remByteCount=this.data.byteLength),this.packetsSent=0;try{var wt={chunkLength:this.chunkLength,offset:this.offset,remBytes:this.remByteCount};this.call.pipelineCallId&&(wt.pluginName=qt.data.pluginName,wt.pluginData=qt.data.pluginData,qt.data.context&&(wt.context=qt.data.context)),this.channel.send(JSON.stringify(wt))}catch(Dt){return Mt.error("transfer:",Dt),this.call.failure="dataChannelFailed",void setTimeout(this.terminateTransfer.bind(this))}bt.createEvent({eventType:"onFileSending",callId:this.call.callId,remoteId:this.call.remoteId,name:this.call.data.filename}),setTimeout(this.subsequentTransfer.bind(this),Pt)}else Mt.warn("No data channel to send data, leaving transfer")}},Wt=(tt.Y.get("CallStatsMonitor"),function(qt,Rt,nt,vt){this.interval=qt,this.browserType=Rt,this.browserVersion=nt,this.flavor=vt,this.prevData={},this.prevDataThreshold=10/qt,this.prevDataThreshold<2&&(this.prevDataThreshold=2),this.STANDARD_STAT_KEYS={audioReceived:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},videoReceived:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},remoteAudioSent:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},remoteVideoSent:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},audioSent:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},videoSent:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},remoteAudioReceived:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1},remoteVideoReceived:{codecId:!1,id:!1,ssrc:!1,trackId:!1,transportId:!1}},this.refineStats_chrome_proprietary=function(Tt,Pt){var wt,Dt;for(wt=0;wt<Pt.length;wt+=1){var Et=Pt[wt],jt=null,Yt=null;if(Et.type==="ssrc"){if(Et.id.indexOf("recv")>=0){if(Et.stat("mediaType")==="audio")for(Tt.audioReceived={timestamp:Math.floor(Date.parse(Et.timestamp))/1e3,type:"inbound-rtp",isRemote:!1,mediaType:"audio",packetsReceived:0,bytesReceived:0},jt=Et.names(),Dt=0;Dt<jt.length;Dt+=1)(Yt=jt[Dt])==="packetsReceived"?Tt.audioReceived.packetsReceived=parseInt(Et.stat("packetsReceived"),10):Yt==="bytesReceived"&&(Tt.audioReceived.bytesReceived=parseInt(Et.stat("bytesReceived"),10));else if(Et.stat("mediaType")==="video")for(Tt.videoReceived={timestamp:Math.floor(Date.parse(Et.timestamp))/1e3,type:"outbound-rtp",isRemote:!1,mediaType:"video",framesDecoded:0,packetsReceived:0,bytesReceived:0},jt=Et.names(),Dt=0;Dt<jt.length;Dt+=1)(Yt=jt[Dt])==="framesDecoded"?Tt.videoReceived.framesDecoded=parseInt(Et.stat("framesDecoded"),10):Yt==="packetsReceived"?Tt.videoReceived.packetsReceived=parseInt(Et.stat("packetsReceived"),10):Yt==="bytesReceived"&&(Tt.videoReceived.bytesReceived=parseInt(Et.stat("bytesReceived"),10))}else if(Et.id.indexOf("send")>=0){if(Et.stat("mediaType")==="audio")for(Tt.audioSent={timestamp:Math.floor(Date.parse(Et.timestamp))/1e3,type:"outbound-rtp",isRemote:!1,mediaType:"audio",packetsSent:0,bytesSent:0},jt=Et.names(),Dt=0;Dt<jt.length;Dt+=1)(Yt=jt[Dt])==="packetsSent"?Tt.audioSent.packetsSent=parseInt(Et.stat("packetsSent"),10):Yt==="bytesSent"&&(Tt.audioSent.bytesSent=parseInt(Et.stat("bytesSent"),10));else if(Et.stat("mediaType")==="video")for(Tt.videoSent={timestamp:Math.floor(Date.parse(Et.timestamp))/1e3,type:"outbound-rtp",isRemote:!1,mediaType:"video",framesEncoded:0,packetsSent:0,bytesSent:0},jt=Et.names(),Dt=0;Dt<jt.length;Dt+=1)(Yt=jt[Dt])==="framesEncoded"?Tt.videoSent.framesEncoded=parseInt(Et.stat("framesEncoded"),10):Yt==="packetsSent"?Tt.videoSent.packetsSent=parseInt(Et.stat("packetsSent"),10):Yt==="bytesSent"&&(Tt.videoSent.bytesSent=parseInt(Et.stat("bytesSent"),10))}}}return!1},this.refineStats_chrome_legacy=function(Tt,Pt){var wt=!1;return Pt.forEach(function(Dt){var Et=null,jt=null;if(Dt.type==="ssrc"&&Dt.id.indexOf("recv")>=0){if(Dt.mediaType==="audio"){for(jt in Tt.audioReceived={},Et=Math.floor(Date.parse(Dt.timestamp)/1e3),Dt)jt==="timestamp"?Tt.audioReceived.timestamp=Et:Tt.audioReceived[jt]=Dt[jt];wt=!0}else if(Dt.mediaType==="video"){for(jt in Tt.videoReceived={},Et=Math.floor(Date.parse(Dt.timestamp)/1e3),Dt)jt==="timestamp"?Tt.videoReceived.timestamp=Et:Tt.videoReceived[jt]=Dt[jt];wt=!0}}else if(Dt.type==="ssrc"&&Dt.id.indexOf("send")>=0){if(Dt.mediaType==="audio"){for(jt in Tt.audioSent={},Et=Math.floor(Date.parse(Dt.timestamp)/1e3),Dt)jt==="timestamp"?Tt.audioSent.timestamp=Et:Tt.audioSent[jt]=Dt[jt];wt=!0}else if(Dt.mediaType==="video"){for(jt in Tt.videoSent={},Et=Math.floor(Date.parse(Dt.timestamp)/1e3),Dt)jt==="timestamp"?Tt.videoSent.timestamp=Et:Tt.videoSent[jt]=Dt[jt];wt=!0}}}),wt},this.refineStats_chrome_58=function(Tt,Pt){var wt=this,Dt=!1;return Pt.forEach(function(Et){if(Et.type!=="inbound-rtp"||Et.isRemote){if(Et.type==="outbound-rtp"&&!Et.isRemote){if(Et.mediaType==="audio"){Tt.audioSent={};var jt=Math.floor(Et.timestamp/1e3);for(var Yt in Et)wt.STANDARD_STAT_KEYS.audioSent[Yt]!==!1&&(Yt==="timestamp"?Tt.audioSent.timestamp=jt:Tt.audioSent[Yt]=Et[Yt]);Dt=!0}else if(Et.mediaType==="video"){Tt.videoSent={};var en=Math.floor(Et.timestamp/1e3);for(var Kt in Et)wt.STANDARD_STAT_KEYS.videoSent[Kt]!==!1&&(Kt==="timestamp"?Tt.videoSent.timestamp=en:Tt.videoSent[Kt]=Et[Kt]);Dt=!0}}}else if(Et.mediaType==="audio"||Et.id.indexOf("Audio")>=0){Tt.audioReceived={};var rn=Math.floor(Et.timestamp/1e3);for(var hn in Et)wt.STANDARD_STAT_KEYS.audioReceived[hn]!==!1&&(hn==="timestamp"?Tt.audioReceived.timestamp=rn:Tt.audioReceived[hn]=Et[hn]);Dt=!0}else if(Et.mediaType==="video"||Et.id.indexOf("Video")>=0){Tt.videoReceived={};var an=Math.floor(Et.timestamp/1e3);for(var un in Et)wt.STANDARD_STAT_KEYS.videoReceived[un]!==!1&&(un==="timestamp"?Tt.videoReceived.timestamp=an:Tt.videoReceived[un]=Et[un]);Dt=!0}}),Dt},this.refineStats_firefox_legacy=function(Tt,Pt){var wt=!1,Dt=this;return Pt.forEach(function(Et){var jt=null,Yt=null;if(Et.type==="inbound-rtp"&&Et.isRemote===!1){if(Et.mediaType==="audio"){for(jt in Tt.audioReceived={packetsReceived:0,bytesReceived:0},Yt=Math.floor(Et.timestamp/1e3),Et)Dt.STANDARD_STAT_KEYS.audioReceived[jt]!==!1&&(jt==="timestamp"?Tt.audioReceived.timestamp=Yt:Tt.audioReceived[jt]=Et[jt]);wt=!0}else if(Et.mediaType==="video"){for(jt in Tt.videoReceived={packetsReceived:0,bytesReceived:0,framesDecoded:0},Yt=Math.floor(Et.timestamp/1e3),Et)Dt.STANDARD_STAT_KEYS.videoReceived[jt]!==!1&&(jt==="timestamp"?Tt.videoReceived.timestamp=Yt:Tt.videoReceived[jt]=Et[jt]);wt=!0}}else if(Et.type==="outbound-rtp"&&Et.isRemote===!1){if(Et.mediaType==="audio"){for(jt in Tt.audioSent={packetsSent:0,bytesSent:0},Yt=Math.floor(Et.timestamp/1e3),Et)Dt.STANDARD_STAT_KEYS.audioSent[jt]!==!1&&(jt==="timestamp"?Tt.audioSent.timestamp=Yt:Tt.audioSent[jt]=Et[jt]);wt=!0}else if(Et.mediaType==="video"){for(jt in Tt.videoSent={packetsSent:0,bytesSent:0,framesEncoded:0},Yt=Math.floor(Et.timestamp/1e3),Et)Dt.STANDARD_STAT_KEYS.videoSent[jt]!==!1&&(jt==="timestamp"?Tt.videoSent.timestamp=Yt:Tt.videoSent[jt]=Et[jt]);wt=!0}}}),wt},this.refineStats_firefox_63=function(Tt,Pt){var wt=!1,Dt=this;return Pt.forEach(function(Et){if(Et.type!=="inbound-rtp"||Et.isRemote){if(Et.type==="outbound-rtp"&&!Et.isRemote){if(Et.kind==="audio"){Tt.audioSent={packetsSent:0,bytesSent:0};var jt=Math.floor(Et.timestamp/1e3);for(var Yt in Et)Dt.STANDARD_STAT_KEYS.audioSent[Yt]!==!1&&(Yt==="timestamp"?Tt.audioSent.timestamp=jt:Tt.audioSent[Yt]=Et[Yt]);wt=!0}else if(Et.kind==="video"){Tt.videoSent={packetsSent:0,bytesSent:0,framesEncoded:0};var en=Math.floor(Et.timestamp/1e3);for(var Kt in Et)Dt.STANDARD_STAT_KEYS.videoSent[Kt]!==!1&&(Kt==="timestamp"?Tt.videoSent.timestamp=en:Tt.videoSent[Kt]=Et[Kt]);wt=!0}}}else if(Et.kind==="audio"){Tt.audioReceived={packetsReceived:0,bytesReceived:0};var rn=Math.floor(Et.timestamp/1e3);for(var hn in Et)Dt.STANDARD_STAT_KEYS.audioReceived[hn]!==!1&&(hn==="timestamp"?Tt.audioReceived.timestamp=rn:Tt.audioReceived[hn]=Et[hn]);wt=!0}else if(Et.kind==="video"){Tt.videoReceived={packetsReceived:0,bytesReceived:0,framesDecoded:0};var an=Math.floor(Et.timestamp/1e3);for(var un in Et)Dt.STANDARD_STAT_KEYS.videoReceived[un]!==!1&&(un==="timestamp"?Tt.videoReceived.timestamp=an:Tt.videoReceived[un]=Et[un]);wt=!0}}),wt},this.addCallStats=function(Tt){var Pt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},wt={};if(this.refineStats!==void 0){if(this.refineStats(wt,Tt),wt.audioReceived!==void 0){if(this.prevData.audioReceived!==void 0){var Dt=wt.audioReceived.timestamp-this.prevData.audioReceived[0].timestamp;Dt>0?(wt.audioReceived.packetsReceivedPerSecond===void 0&&(wt.audioReceived.packetsReceivedPerSecond=Math.floor((wt.audioReceived.packetsReceived-this.prevData.audioReceived[0].packetsReceived)/Dt)),wt.audioReceived.bitsReceivedPerSecond===void 0&&(wt.audioReceived.bitsReceivedPerSecond=Math.floor(8*(wt.audioReceived.bytesReceived-this.prevData.audioReceived[0].bytesReceived)/Dt)),wt.audioReceived.packetsLostPerSecond===void 0&&(wt.audioReceived.packetsLostPerSecond=Math.floor((wt.audioReceived.packetsLost-this.prevData.audioReceived[0].packetsLost)/Dt)),wt.audioReceived.packetLossRatio===void 0&&(wt.audioReceived.packetLossRatio=100*(wt.audioReceived.packetsLost-this.prevData.audioReceived[0].packetsLost)/(wt.audioReceived.packetsReceived-this.prevData.audioReceived[0].packetsReceived)),wt.audioReceived.samplingInterval=Dt):(wt.audioReceived.packetsReceivedPerSecond===void 0&&(wt.audioReceived.packetsReceivedPerSecond=0),wt.audioReceived.bitsReceivedPerSecond===void 0&&(wt.audioReceived.bitsReceivedPerSecond=0),wt.audioReceived.packetsLostPerSecond===void 0&&(wt.audioReceived.packetsLostPerSecond=0),wt.audioReceived.packetLossRatio===void 0&&(wt.audioReceived.packetLossRatio=0),wt.audioReceived.samplingInterval=0)}else wt.audioReceived.packetsReceivedPerSecond===void 0&&(wt.audioReceived.packetsReceivedPerSecond=0),wt.audioReceived.bitsReceivedPerSecond===void 0&&(wt.audioReceived.bitsReceivedPerSecond=0),wt.audioReceived.packetsLostPerSecond===void 0&&(wt.audioReceived.packetsLostPerSecond=0),wt.audioReceived.packetLossRatio===void 0&&(wt.audioReceived.packetLossRatio=0),wt.audioReceived.samplingInterval=0,this.prevData.audioReceived=[];for(this.prevData.audioReceived.push(wt.audioReceived);this.prevData.audioReceived.length>this.prevDataThreshold;)this.prevData.audioReceived.shift()}if(wt.videoReceived!==void 0){if(this.prevData.videoReceived!==void 0){var Et=wt.videoReceived.timestamp-this.prevData.videoReceived[0].timestamp;Et>0?(wt.videoReceived.packetsReceivedPerSecond===void 0&&(wt.videoReceived.packetsReceivedPerSecond=Math.floor((wt.videoReceived.packetsReceived-this.prevData.videoReceived[0].packetsReceived)/Et)),wt.videoReceived.bitsReceivedPerSecond===void 0&&(wt.videoReceived.bitsReceivedPerSecond=Math.floor(8*(wt.videoReceived.bytesReceived-this.prevData.videoReceived[0].bytesReceived)/Et)),wt.videoReceived.packetsLostPerSecond===void 0&&(wt.videoReceived.packetsLostPerSecond=Math.floor((wt.videoReceived.packetsLost-this.prevData.videoReceived[0].packetsLost)/Et)),wt.videoReceived.framesDecodedPerSecond===void 0&&(wt.videoReceived.framesDecodedPerSecond=Math.floor((wt.videoReceived.framesDecoded-this.prevData.videoReceived[0].framesDecoded)/Et)),wt.videoReceived.packetLossRatio===void 0&&(wt.videoReceived.packetLossRatio=100*(wt.videoReceived.packetsLost-this.prevData.videoReceived[0].packetsLost)/(wt.videoReceived.packetsReceived-this.prevData.videoReceived[0].packetsReceived)),wt.videoReceived.samplingInterval=Et):(wt.videoReceived.packetsReceivedPerSecond===void 0&&(wt.videoReceived.packetsReceivedPerSecond=0),wt.videoReceived.bitsReceivedPerSecond===void 0&&(wt.videoReceived.bitsReceivedPerSecond=0),wt.videoReceived.packetsLostPerSecond===void 0&&(wt.videoReceived.packetsLostPerSecond=0),wt.videoReceived.framesDecodedPerSecond===void 0&&(wt.videoReceived.framesDecodedPerSecond=0),wt.videoReceived.packetLossRatio===void 0&&(wt.videoReceived.packetLossRatio=0),wt.videoReceived.samplingInterval=0)}else wt.videoReceived.packetsReceivedPerSecond===void 0&&(wt.videoReceived.packetsReceivedPerSecond=0),wt.videoReceived.bitsReceivedPerSecond===void 0&&(wt.videoReceived.bitsReceivedPerSecond=0),wt.videoReceived.packetsLostPerSecond===void 0&&(wt.videoReceived.packetsLostPerSecond=0),wt.videoReceived.framesDecodedPerSecond===void 0&&(wt.videoReceived.framesDecodedPerSecond=0),wt.videoReceived.packetLossRatio===void 0&&(wt.videoReceived.packetLossRatio=0),wt.videoReceived.samplingInterval=0,this.prevData.videoReceived=[];for(this.prevData.videoReceived.push(wt.videoReceived);this.prevData.videoReceived.length>this.prevDataThreshold;)this.prevData.videoReceived.shift()}if(wt.audioSent!==void 0){if(this.prevData.audioSent!==void 0){var jt=wt.audioSent.timestamp-this.prevData.audioSent[0].timestamp;jt>0?(wt.audioSent.packetsSentPerSecond===void 0&&(wt.audioSent.packetsSentPerSecond=Math.floor((wt.audioSent.packetsSent-this.prevData.audioSent[0].packetsSent)/jt)),wt.audioSent.bitsSentPerSecond===void 0&&(wt.audioSent.bitsSentPerSecond=Math.floor(8*(wt.audioSent.bytesSent-this.prevData.audioSent[0].bytesSent)/jt)),wt.audioSent.samplingInterval=jt):(wt.audioSent.packetsSentPerSecond===void 0&&(wt.audioSent.packetsSentPerSecond=0),wt.audioSent.bitsSentPerSecond===void 0&&(wt.audioSent.bitsSentPerSecond=0),wt.audioSent.samplingInterval=0)}else wt.audioSent.packetsSentPerSecond===void 0&&(wt.audioSent.packetsSentPerSecond=0),wt.audioSent.bitsSentPerSecond===void 0&&(wt.audioSent.bitsSentPerSecond=0),wt.audioSent.samplingInterval=0,this.prevData.audioSent=[];for(this.prevData.audioSent.push(wt.audioSent);this.prevData.audioSent.length>this.prevDataThreshold;)this.prevData.audioSent.shift()}if(wt.videoSent!==void 0){if(this.prevData.videoSent!==void 0){var Yt=wt.videoSent.timestamp-this.prevData.videoSent[0].timestamp;Yt>0?(wt.videoSent.packetsSentPerSecond===void 0&&(wt.videoSent.packetsSentPerSecond=Math.floor((wt.videoSent.packetsSent-this.prevData.videoSent[0].packetsSent)/Yt)),wt.videoSent.bitsSentPerSecond===void 0&&(wt.videoSent.bitsSentPerSecond=Math.floor(8*(wt.videoSent.bytesSent-this.prevData.videoSent[0].bytesSent)/Yt)),wt.videoSent.framesEncodedPerSecond===void 0&&(wt.videoSent.framesEncodedPerSecond=Math.floor((wt.videoSent.framesEncoded-this.prevData.videoSent[0].framesEncoded)/Yt)),wt.videoSent.samplingInterval=Yt):(wt.videoSent.packetsSentPerSecond===void 0&&(wt.videoSent.packetsSentPerSecond=0),wt.videoSent.bitsSentPerSecond===void 0&&(wt.videoSent.bitsSentPerSecond=0),wt.videoSent.framesEncodedPerSecond===void 0&&(wt.videoSent.framesEncodedPerSecond=0),wt.videoSent.samplingInterval=0)}else wt.videoSent.packetsSentPerSecond===void 0&&(wt.videoSent.packetsSentPerSecond=0),wt.videoSent.bitsSentPerSecond===void 0&&(wt.videoSent.bitsSentPerSecond=0),wt.videoSent.framesEncodedPerSecond===void 0&&(wt.videoSent.framesEncodedPerSecond=0),wt.videoSent.samplingInterval=0,this.prevData.videoSent=[];for(this.prevData.videoSent.push(wt.videoSent);this.prevData.videoSent.length>this.prevDataThreshold;)this.prevData.videoSent.shift()}}return Object.keys(wt).length>0&&typeof Pt.post=="function"&&Pt.post(wt),wt},this.browserType==="chrome"?vt==="proprietary"?this.refineStats=this.refineStats_chrome_proprietary:this.browserVersion>=58?this.refineStats=this.refineStats_chrome_58:this.refineStats=this.refineStats_chrome_legacy:this.browserType==="firefox"?this.browserVersion>=63?this.refineStats=this.refineStats_firefox_63:this.refineStats=this.refineStats_firefox_legacy:this.browserType==="safari"&&(this.refineStats=this.refineStats_chrome_58)}),nn=(s(658),function(){this.NarrowBandSpeechQuality=function(qt,Rt){var nt,vt,Tt=1,Pt=1+qt/10,wt=1+qt/150,Dt=(94.769-(nt=80+2.5*(65-40*Math.log10(Pt/wt)+6*Math.exp(qt*qt*-.3)-14)))*(94.769-nt)/4+100;return(vt=93.193-((94.769-nt)/2+Math.sqrt(Dt)-1)*(1-Math.exp(-qt))-(0+Rt/(Rt+4.3)*95))<0&&(Tt=1),vt<100&vt>0&&(Tt=1+.035*vt+vt*(vt-60)*(100-vt)*7*1e-6),vt>100&&(Tt=4.5),Tt},this.WideBandspeechQuality=function(qt,Rt){var nt,vt,Tt,Pt=0,wt=1;qt<100&&(Pt=.08-qt+10),qt>=100&&(Pt=18);var Dt=1+qt/10,Et=1+qt/150,jt=(129-(nt=80+3*(65+Pt-40*Math.log10(Dt/Et)+6*Math.exp(qt*qt*-.3)-14)))*(129-nt)/4+100;return(Tt=(vt=129-((129-nt)/2+Math.sqrt(jt)-1)*(1-Math.exp(-qt))-(0+Rt/(Rt+4.3)*95))/1.29)<=0&&(wt=1),Tt<100&Tt>0&&(wt=1+.035*vt+vt*(vt-60)*(100-vt)*7*1e-6),Tt>=100&&(wt=4.5),wt},this.videoQuality=function(qt,Rt,nt,vt,Tt){var Pt,wt,Dt,Et,jt,Yt,en,Kt,rn;return rn=Rt>720?[0,2.77,.009,3.95,460,1.28,2.12,32e-5,1.28,262,1.98,22.84,7.999]:Rt>576?[0,6.31,.008,3.68,262,1.28,1.97,33e-5,1.24,343,2.76,6.25,6.013]:Rt>480?[0,6.96,.007,3.58,214,1.2,1.75,63e-5,1.13,171,4.25,7.98,12.001]:Rt>288?[0,5.61,.01,3.38,182,1.31,2.23,75e-5,1.51,136,4.05,20.16,22.332]:[0,3.988,.013,3.625,89.25,1.125,.713,0,1.542,245.5,3.011,39.31,16.67],Yt=1+Math.pow(vt/rn[4],rn[5]),Pt=rn[3]-rn[3]/Yt,wt=rn[1]+rn[2]*vt,Dt=rn[6]+rn[7]*vt,en=Math.pow(Math.log(Tt)-Math.log(wt),2),Kt=2*Math.pow(Dt,2),Et=Pt*Math.exp(-en/Kt),jt=rn[10]+rn[11]*Math.exp(-Tt/rn[8])+rn[12]*Math.exp(-vt/rn[9]),1+Et*Math.exp(-nt/jt)},this.audiovisualQuality=function(qt,Rt,nt,vt){var Tt,Pt,wt,Dt,Et;return qt>0&&Rt>0?(Tt=(Et=[0,-.6966,-.8127,.4562,3.003,-.1638,.3626,.1291,.5457,-1251e-7,3.763,-.001065,.01465,-.001002,0])[9]*(nt+vt)+Et[10],nt>=vt&&(Pt=Math.min(Et[11]*(nt-vt)+Et[12],0)),nt<vt&&(Pt=Math.min(Et[13]*(vt-nt)+Et[14],0)),wt=Math.max(Tt+Pt,1),Et[1]*(Dt=Et[5]*qt+Et[6]*Rt+Et[7]*qt*Rt+Et[8])+Et[2]*wt+Et[3]*Dt*wt+Et[4]):"NoAudiovisualStream"}});function gn(qt,Rt){var nt=typeof Symbol<"u"&&qt[Symbol.iterator]||qt["@@iterator"];if(!nt){if(Array.isArray(qt)||(nt=function(Et,jt){if(Et){if(typeof Et=="string")return tn(Et,jt);var Yt=Object.prototype.toString.call(Et).slice(8,-1);return Yt==="Object"&&Et.constructor&&(Yt=Et.constructor.name),Yt==="Map"||Yt==="Set"?Array.from(Et):Yt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Yt)?tn(Et,jt):void 0}}(qt))||Rt&&qt&&typeof qt.length=="number"){nt&&(qt=nt);var vt=0,Tt=function(){};return{s:Tt,n:function(){return vt>=qt.length?{done:!0}:{done:!1,value:qt[vt++]}},e:function(Et){throw Et},f:Tt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Pt,wt=!0,Dt=!1;return{s:function(){nt=nt.call(qt)},n:function(){var Et=nt.next();return wt=Et.done,Et},e:function(Et){Dt=!0,Pt=Et},f:function(){try{wt||nt.return==null||nt.return()}finally{if(Dt)throw Pt}}}}function tn(qt,Rt){(Rt==null||Rt>qt.length)&&(Rt=qt.length);for(var nt=0,vt=new Array(Rt);nt<Rt;nt++)vt[nt]=qt[nt];return vt}var Gt=tt.Y.get("WebRTC_Call"),fn=apiCC.myWebRTC_Event,Cn=function(qt){this.dest_roomId="",this.pc=null,this.callId=0,this.callee=!1,this.callerId=0,this.calleeId=0,this.started=!1,this.localDescriptionSetted=!1,this.remoteDescriptionSetted=!1,this.sendedSdpOfferMessage=null,this.receivedSdpOfferMessage=null,this.myWebRTC_Stack=new yt.S(qt.socket),this.remoteMediaStreams=[],this.rtpSenders={audio:[],video:[]},this.addingUserMedia=!1,this.myWebRTC_Event=apiCC.myWebRTC_Event,this.dtmfSender=null,this.incomingcandidatesQueue=[],ot.Xh==="Firefox"?ot.PR>43?(this.mediaConstraintsAudioOnly={offerToReceiveAudio:!0,offerToReceiveVideo:!1},this.mediaConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1}):(this.mediaConstraintsAudioOnly={mandatory:{offerToReceiveAudio:!0,offerToReceiveVideo:!1}},this.mediaConstraints={mandatory:{offerToReceiveAudio:!0,offerToReceiveVideo:!0}}):ot.Xh==="Chrome"?ot.PR<55?(this.mediaConstraintsAudioOnly={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},this.mediaConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}}):(this.mediaConstraintsAudioOnly={offerToReceiveAudio:1,offerToReceiveVideo:1},this.mediaConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1}):ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome"?(this.mediaConstraintsAudioOnly={offerToReceiveAudio:!0,offerToReceiveVideo:!1},this.mediaConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1}):(this.mediaConstraintsAudioOnly={offerToReceiveAudio:1,offerToReceiveVideo:1},this.mediaConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1}),ot.ag.name==="iOS"&&(Gt.log("Defining mediaConstraints for iOS "),this.mediaConstraints={offerToReceiveAudio:!0,offerToReceiveVideo:!0}),this.trickleIce=qt.trickleIce,this.callLocalStream=null,this.generatedLocalStream=!1,this.audioOnly=!1,this.inviteSended=!1,this.sendInviteTrickleIceFalseTimeOutId=0,this.sendInviteTrickleIceFalseTimer=5e3,this.message200OKSended=!1,this.send200OKTrickleIceFalseTimeOutId=0,this.send200OKTrickleIceFalseTimer=5e3,this.message200OKReceived=!1,this.callCancelled=!1,this.screenSharing=!1,this.desktopId=0,this.pc_config=qt.pc_config,this.pc_constraints=qt.pc_constraints,this.audioFileMediaElement=null,this.videoReceivedWidth=640,this.videoReceivedHeight=480,this.videoSendWidth=640,this.videoSendHeight=480,this.videoReceivedDelay=0,this.audioReceivedDelay=0,this.audioSendDelay=0,this.videoSendDelay=0,this.videoSendPacketLossRatio=0,this.audioSendPacketLossRatio=0,this.getStatsInterval=qt.qosInterval,this.qm=null,this.statisticId=null,this.csmIntervalMs=qt.csmIntervalMs,this.csmIntervalId=null,this.remoteId=0,this.callType="media",this.localCallProfile={audio:!1,audioActive:!1,video:!1,videoActive:!1},this.remoteCallProfile={audio:!1,audioActive:!1,video:!1,videoActive:!1},this.disconnectionTimeoutId=0,this.disconnectionTimer=4e4,this.disconnectionWarningDelay=9e3,this.disconnectionWarningInterval=0,this.disconnectionWarningTimeout=0,this.disconnectionWarningCount=0,this.checkCandidateTypesTimer=1e4,this.checkCandidateTypesTimeoutId=0,this.checkCandidateTypesTimeoutTable=[],this.data={},this.screenStream=null,this.screenIsDisplayed=!1,this.addingDataChannelOnCallOngoing=!1,this.sendDataChannel=null,this.receiveDataChannel=null,this.receiveChunkNb={},this.firstDataPacket={},this.receivedSize={},this.receiveArrayToStoreChunks={},this.destCallType="media",this.mcuRemoteStream=null,this.userMediaAccessRequired=!0,this.settingUpMode="normal",this.remoteType="web",this.mediaTypeForIncomingCall=qt.mediaTypeForIncomingCall,this.mediaTypeForOutgoingCall=qt.mediaTypeForOutgoingCall,this.mediaRoutingMode=qt.mediaRoutingMode,this.stripAudioSDPActivated=!1,this.stripVideoSDPActivated=!1,this.iceState="notdefined",this.restarted=!1,this.audioSdpDirection=null,this.videoSdpDirection=null,this.isLocalAudioMuted=!1,this.isLocalVideoMuted=!1,this.isRemoteAudioMuted=!1,this.isRemoteVideoMuted=!1,this.isRemoteAudioSilent=!1,this.isRemoteVideoSilent=!1,this.isAccepted=!1,this.accessToMedia=!1,this.callConfiguration=null,this.captureSourceType=null,this.preferH264Codec=!1,this.preferVP8Codec=!1,this.preferVP9Codec=!1,this.candidateNb=0,this.sessionMCU=null,this.instanceId=0,this.retryUpdateMedia=!1,this.updateMediaOngoing=!1,this.setCallTurnServer=function(Rt){Gt.info("setCallTurnServer :",Rt);var nt=JSON.stringify(this.pc_config);nt=nt.replace(/mp1.apizee.com/g,Rt),this.pc_config=JSON.parse(nt)},this.setCallMediaRoutingMode=function(Rt){Gt.info("setCallMediaRoutingMode :",Rt),Rt==="hostOnly"?this.mediaRoutingMode=qt.mediaRoutingModeEnum.hostOnly:Rt==="stun"?this.mediaRoutingMode=qt.mediaRoutingModeEnum.stun:Rt==="stunOnly"?this.mediaRoutingMode=qt.mediaRoutingModeEnum.stunOnly:Rt==="turn"?this.mediaRoutingMode=qt.mediaRoutingModeEnum.turn:Rt==="turnOnly"?this.mediaRoutingMode=qt.mediaRoutingModeEnum.turnOnly:(Gt.log("parameter error when calling function : setCallMediaRoutingMode()"),this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setCallMediaRoutingMode()","PARAMETER_ERROR_SETCALLMEDIAROUTINGMODE"))},this.checkDTLSCompliancy=function(){if(Gt.debug("checkDTLSCompliancy"),apiCC.session.isDeviceDTLSCompliant()===!1)Gt.log("Device not DTLS compliant, setting DtlsSrtpKeyAgreement: false"),this.pc_constraints={optional:[{DtlsSrtpKeyAgreement:!1}]};else{var Rt=apiCC.session.isClientDTLSCompliant(this.remoteId);Rt!==!1&&Rt!=="false"||(Gt.log("Remote Device not DTLS compliant, setting DtlsSrtpKeyAgreement: false"),this.pc_constraints={optional:[{DtlsSrtpKeyAgreement:!1}]})}},this.sendData=function(Rt,nt){Gt.info("datachannel - sendData");var vt=null,Tt=null;if(Rt.file instanceof File)return Gt.log("File"),this.contentType=Rt.file.type,this.originalDataType="File",vt=new FileReader,Tt=this,vt.onload=function(Pt){var wt=Pt.target.result||vt.result;Tt.sendData({file:wt,name:Rt.name,type:Rt.type},nt)},void vt.readAsArrayBuffer(Rt.file);new Ht(this).send(Rt,this.sendDataChannel,nt)},Gt.log("New Call for client with Id :"+qt.clientId),this.generateCallId=function(){this.callId=apiCC.generateCallId(),Gt.info("new call with callId :"+this.callId)},this.sendInviteTrickleIceFalse=function(){Gt.log("sendInviteTrickleIceFalse"),Gt.log("sendInvite on candidate timer reached"),this.myWebRTC_Stack.sendInvite(this.callId,this.callerId,qt.nickname,this.dest_roomId,this.dest_roomId,this.callType,{offer:this.pc.localDescription,data:this.data,stream:this.mcuRemoteStream,volatile:!!this.restarted}),this.inviteSended=!0},this.send200OkTrickleIceFalse=function(){Gt.log("send200OkTrickleIceFalse"),this.myWebRTC_Stack.send200OK(this.callId,this.callerId,this.calleeId,qt.nickname,this.dest_roomId,this.pc.localDescription,this.data),this.message200OKSended=!0},this.onSetLocalDescriptionSuccess=function(){Gt.info("onSetLocalDescriptionSuccess"),this.localDescriptionSetted=!0,this.asyncCallbacks&&this.asyncCallbacks.type==="subscribe"&&delete this.asyncCallbacks,this.trickleIce===!1&&(this.callee===!0?(Gt.info("starting send200OKTrickleIceFalseTimeOutId"),this.send200OKTrickleIceFalseTimeOutId=setTimeout(this.callback(this,"send200OkTrickleIceFalse"),this.send200OKTrickleIceFalseTimer)):(Gt.info("starting sendInviteTrickleIceFalseTimeOutId"),this.sendInviteTrickleIceFalseTimeOutId=setTimeout(this.callback(this,"sendInviteTrickleIceFalse"),this.sendInviteTrickleIceFalseTimer))),qt.rtpSenderSetParamatersCapable&&qt.evaluateVideoCap(this)},this.onSetLocalDescriptionFailure=function(Rt){Gt.warn("onSetLocalDescriptionFailure",Rt);var nt=null,vt=null;this.callControl&&(nt=this.callControl.roomName,vt=this.callControl.type),fn.createErrorEvent("Set local Description Failure","SET_LOCAL_DESCRIPTION_FAILURE",this.callId,nt,vt),qt.onHangup(this.callId,"Local_Description_Failure")},this.onSetRemoteDescriptionSuccess=function(){Gt.info("onSetRemoteDescriptionSuccess");var Rt=null;for(this.remoteDescriptionSetted=!0,this.restarting===!0&&delete this.restarting,this.data&&(this.data.mesh||this.data.subscribeOrder)||fn.createCallEstablishedEvent(this.calleeId,this.callType,this.callId,this.destCallType);this.incomingcandidatesQueue.length;)Rt=this.incomingcandidatesQueue.shift(),this.processCandidateMsg(Rt);if(qt.clientIncomingCandidatesQueue[this.callId+"-"+this.instanceId]!==void 0){for(Gt.debug("Restoring candidate from client, this.callId :"+this.callId+" , instanceId :"+this.instanceId);qt.clientIncomingCandidatesQueue[this.callId+"-"+this.instanceId].length;)Rt=qt.clientIncomingCandidatesQueue[this.callId+"-"+this.instanceId].shift(),this.processCandidateMsg(Rt);delete qt.clientIncomingCandidatesQueue[this.callId+"-"+this.instanceId]}if(this.asyncCallbacks&&(this.asyncCallbacks.type==="addingUserMedia"?(this.asyncCallbacks.resolve(this.callConfiguration.userMediaStreamId),this.asyncCallbacks.timeoutId&&(clearTimeout(this.asyncCallbacks.timeoutId),delete this.asyncCallbacks.timeoutId),delete this.asyncCallbacks):this.asyncCallbacks.type==="updateCallConfiguration"&&(this.asyncCallbacks.resolve(),this.asyncCallbacks.timeoutId&&(clearTimeout(this.asyncCallbacks.timeoutId),delete this.asyncCallbacks.timeoutId),delete this.asyncCallbacks)),this.updateMediaOngoing=!1,this.retryUpdateMedia===!0){Gt.debug("an updateMedia was waiting for sig stable state or an other updateMedia end, updating Media now ..."),this.retryUpdateMedia=!1;var nt=this.updateMedia(!1);Gt.debug("Retried updateMediaResult :",nt)}},this.processCandidateMsg=function(Rt){Gt.info("processCandidateMsg :",Rt);var nt=null;this.pc!==null?(Rt.completeCandidate!==void 0?(Gt.trace("new behavior of 2.13.8"),nt=new apiCC.myWebRTC_Adapter.RTCIceCandidate(Rt.completeCandidate)):(Gt.log("old behavior < 2.13.8"),nt=new apiCC.myWebRTC_Adapter.RTCIceCandidate({sdpMLineIndex:Rt.label,candidate:Rt.candidate})),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("addIceCandidate"),this.pc.addIceCandidate(nt,function(){Gt.trace("addIceCandidate success")},function(vt){Gt.warn("addIceCandidate failure: "+vt),vt=null})):(Gt.log("addIceCandidate - Promise version"),this.pc.addIceCandidate(nt).then(function(){Gt.trace("addIceCandidate success")}).catch(function(vt){Gt.warn("addIceCandidate failure: "+vt),vt=null}))):Gt.error("Error, call is not null but pc is null")},this.onSetRemoteDescriptionFailure=function(Rt){Gt.warn("onSetRemoteDescriptionFailure :",Rt);var nt=null,vt=null;this.callControl&&(nt=this.callControl.roomName,vt=this.callControl.type),fn.createErrorEvent("Set remote Description Failure","SET_REMOTE_DESCRIPTION_FAILURE",this.callId,nt,vt),qt.onHangup(this.callId,"Remote_Description_Failure")},this.getUserMediaOnCall=function(){var Rt=this,nt=!1;if(Gt.info("getUserMediaOnCall, audio Only :"+this.audioOnly),Gt.info("getUserMediaOnCall, screenSharing activated :"+this.screenSharing),Gt.log("webRTCClient.gum_config :",qt.gum_config),this.callerId===qt.clientId){if(Gt.log("outgoing call"),this.mediaTypeForOutgoingCall==="VIDEO"||this.mediaTypeForOutgoingCall==="VIDEOONLY")if(Gt.log("mediaTypeForOutgoingCall :"+this.mediaTypeForOutgoingCall),this.mediaTypeForOutgoingCall==="VIDEOONLY"&&(nt=!0),this.screenSharing!==!0){if(apiCC.mediaDeviceMgr.videoDevicePresent===!1){if(apiCC.mediaDeviceMgr.audioDevicePresent===!1)return Gt.log("getUserMediaOnCall without any device, calling without device"),void this.onUserMediaSuccessOnCall();Gt.log("video is not present :"+this.callType),this.callType==="media"&&(Gt.log("callType is media, but no webcam present, forcing callType to audio"),this.callType="audio",this.audioOnly=!0)}}else Gt.log("screenSharing, no device checking");else if(this.mediaTypeForOutgoingCall==="AUDIO")Gt.log("mediaTypeForOutgoingCall is AUDIO, setting call to audioOnly"),this.callType="audio",this.audioOnly=!0;else if(this.mediaTypeForOutgoingCall==="NONE"||this.mediaTypeForOutgoingCall==="DATA")return Gt.log("mediaTypeForOutgoingCall is NONE, call will be recvOnly"),void this.onUserMediaSuccessOnCall()}else if(Gt.log("incoming call"),this.mediaTypeForIncomingCall==="VIDEO"||this.mediaTypeForIncomingCall==="VIDEOONLY"){if(Gt.log("mediaTypeForIncomingCall :"+this.mediaTypeForIncomingCall),this.mediaTypeForIncomingCall==="VIDEOONLY"&&(nt=!0),apiCC.mediaDeviceMgr.videoDevicePresent===!1){if(apiCC.mediaDeviceMgr.audioDevicePresent===!1)return Gt.log("getUserMediaOnCall without any device, calling without device"),void this.onUserMediaSuccessOnCall();Gt.log("video is not present :"+this.callType),this.callType==="media"&&(Gt.log("callType is media, but no webcam present, forcing callType to audio"),this.callType="audio",this.audioOnly=!0)}}else if(this.mediaTypeForIncomingCall==="AUDIO")Gt.log("mediaTypeForIncomingCall is AUDIO, setting call to audioOnly"),this.callType="audio",this.audioOnly=!0;else if(this.mediaTypeForIncomingCall==="NONE"||this.mediaTypeForIncomingCall==="DATA")return Gt.log("mediaTypeForIncomingCall is NONE, call will be recvOnly"),void this.onUserMediaSuccessOnCall();qt.getUserMediaOnGoing=!0;var vt=null,Tt=null;if(Gt.log("this.screenSharing :"+this.screenSharing),Gt.log("this.audioOnly :"+this.audioOnly),this.screenSharing===!0)if(Gt.log("getScreenMedia"),ot.Xh==="Chrome")Gt.log("this.desktopId :"+this.desktopId),vt={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:this.desktopId}}};else{if(Gt.log("this.captureSourceType :"+this.captureSourceType),this.captureSourceType!=="screen"&&this.captureSourceType!=="window"&&this.captureSourceType!=="application")return void Gt.error("captureSourceType value is not correct");vt={video:{mediaSource:this.captureSourceType}}}else this.audioOnly===!0?(Gt.log("this.audioOnly = true"),qt.gum_config=apiCC.setAudioSourceIdInConstraint(qt.audioSourceId,qt.gum_config),Tt=JSON.parse(JSON.stringify(qt.gum_config)),qt.allowAsymetricMediaCalls===!1?Tt.video=!1:Gt.log("allow AsymetricMediaCalls is activated"),vt=Tt):(Gt.log("audio and video call"),vt=(0,ct.ws)({},qt.gum_config),nt?vt.audio=!1:vt=apiCC.setAudioSourceIdInConstraint(qt.audioSourceId,vt),vt=apiCC.setVideoSourceIdInConstraint(qt.videoSourceId,vt),vt=apiCC.setVideoFacingModeInConstraint(qt.facingMode,vt),typeof apiRTC_React<"u"&&(vt={audio:!0,video:{mandatory:{minWidth:500,minHeight:300,minFrameRate:30},facingMode:"user"}}));apiCC.createUserMediaStream({callId:this.callId,type:this.callType,gum_config:vt,success:function(Pt){Gt.debug("[getUserMediaOnCall] success; userMediaStreamId: "+Pt.userMediaStreamId),Rt.callConfiguration!==void 0&&Rt.callConfiguration!==null||(Rt.callConfiguration={}),Rt.callConfiguration.userMediaStreamId=Pt.userMediaStreamId,Rt.onUserMediaSuccessOnCall(Pt.stream)},failure:function(Pt,wt){Gt.debug("[getUserMediaOnCall] failure; userMediaStreamId: "+Pt.userMediaStreamId),Rt.onUserMediaErrorOnCall(wt)}})},this.handleToneChangeEvent=function(Rt){Gt.debug("handleToneChangeEvent :",Rt.tone),Rt.tone!==""?Gt.debug("Tone played: "+Rt.tone):Gt.debug("All tones have played.")},this.sendTones=function(Rt,nt,vt){Gt.debug("sendTones :"),this.dtmfSender&&(Gt.debug("sendTones : Tones, duration, gap: ",Rt,nt,vt),this.dtmfSender.insertDTMF(Rt,nt,vt))},this.addStream=function(Rt){var nt,vt=null,Tt=null,Pt=0,wt=!1,Dt=null,Et=[];if(typeof apiRTC_React<"u"||ot.Xh==="Firefox"&&ot.PR<51||ot.Xh==="Chrome"&&ot.PR<65||ot.Xh==="Safari"&&ot.dc<12.1||ot.Xh==="Mobile Safari"&&ot.dc<12.1||apiRTC.osName==="iOS"&&typeof cordova<"u"&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0)Gt.info("using addStream method"),this.pc.addStream(Rt),Gt.debug("end addStream method");else{if(!(ot.Xh==="Firefox"&&ot.PR<59||ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome")){for(Gt.info("using addTrack/replaceTrack method"),vt=Rt.getTracks(),nt=0;nt<vt.length;nt+=1){for(wt=!1,Tt=this.rtpSenders[vt[nt].kind],Pt=0;Pt<Tt.length;Pt+=1)if(Tt[Pt].track===null){wt=!0;break}if(wt===!0)Et.push(Tt[Pt].replaceTrack(vt[nt])),Gt.debug("addStream -> replaceTrack",Tt[Pt]);else{if(this.simulcast==="RID"&&vt[nt].kind==="video"&&ct.wL.type==="chrome"){var jt=[{rid:"h",active:!0,maxBitrate:9e5},{rid:"m",active:!0,maxBitrate:3e5,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:1e5,scaleResolutionDownBy:4}];this.callControl.callConfiguration.simulcast&&this.callControl.callConfiguration.simulcast.sendEncodings&&(jt=this.callControl.callConfiguration.simulcast.sendEncodings.slice()),Dt=this.pc.addTransceiver(vt[nt],{direction:"sendonly",streams:[Rt],sendEncodings:jt}).sender}else if(Dt=this.pc.addTrack(vt[nt],Rt),this.simulcast==="RID"&&vt[nt].kind==="video"&&ct.wL.type==="firefox"){var Yt=Dt.getParameters();Yt||(Yt={}),this.callControl.callConfiguration.simulcast&&this.callControl.callConfiguration.simulcast.sendEncodings?Yt.encodings=this.callControl.callConfiguration.simulcast.sendEncodings.slice():Yt.encodings=[{rid:"h",active:!0,maxBitrate:9e5},{rid:"m",active:!0,maxBitrate:3e5,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:1e5,scaleResolutionDownBy:4}],Et.push(Dt.setParameters(Yt))}Gt.debug("addStream -> addTrack",Dt),this.rtpSenders[vt[nt].kind].push(Dt)}}return Gt.debug("end addTrack/replaceTrack method"),this.rtpSenders.audio.length>0&&(this.dtmfSender=this.rtpSenders.audio[0].dtmf,this.dtmfSender&&(this.dtmfSender.ontonechange=this.handleToneChangeEvent)),new Promise(function(en,Kt){Promise.all(Et).then(function(rn){en()}).catch(Kt)})}for(Gt.info("using addTrack method"),vt=Rt.getTracks(),nt=0;nt<vt.length;nt+=1)this.pc.addTrack(vt[nt],Rt);Gt.debug("end addTrack method")}return Promise.resolve()},this.removeStream=function(Rt){var nt,vt=null,Tt=[];if(Gt.info("removeStream in call",Rt.id),ot.Xh==="Firefox"&&ot.PR<51||ot.Xh==="Chrome"&&ot.PR<65||ot.Xh==="Safari"&&ot.dc<12.1||ot.Xh==="Mobile Safari"&&ot.dc<12.1||apiRTC.osName==="iOS"&&typeof cordova<"u"&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0)Gt.info("using removeStream method"),this.pc.removeStream(Rt),Gt.debug("end removeStream method");else{if(!(ot.Xh==="Firefox"&&ot.PR<59||ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome")){for(Gt.info("using replaceTrack method"),nt=0;nt<this.rtpSenders.audio.length;nt+=1)Tt.push(this.rtpSenders.audio[nt].replaceTrack(null));for(nt=0;nt<this.rtpSenders.video.length;nt+=1)Tt.push(this.rtpSenders.video[nt].replaceTrack(null));return Gt.debug("end replaceTrack method"),new Promise(function(Pt,wt){Promise.all(Tt).then(function(Dt){Pt()}).catch(wt)})}for(Gt.info("using removeTrack method"),vt=this.pc.getSenders(),Gt.debug("senders :",vt),nt=0;nt<vt.length;nt+=1)this.pc.removeTrack(vt[nt]);Gt.debug("end removeTrack method")}return Promise.resolve()},this.stopStream=function(Rt){Gt.info("stopStream in call");var nt,vt=null;if(ot.Xh==="Chrome"&&ot.PR<45||ot.Xh==="Firefox"&&ot.PR<44||ot.Xh==="Opera"&&ot.PR<34||ot.Xh==="Chromium"&&ot.PR<44||ot.Xh==="Chrome WebView"&&ot.PR<45)Gt.log("... using MediaStream.stop"),Rt.stop();else{for(Gt.log("... using MediaStreamTrack.stop"),vt=Rt.getTracks(),nt=0;nt<vt.length;nt+=1)vt[nt].stop();Gt.log("... tracks stopped")}Rt=null},this.addVideoMedia=function(){var Rt=this;Gt.info("addVideoMedia");var nt=qt.gum_config;apiCC.createUserMediaStream({callId:this.callId,type:"media",gum_config:nt,success:function(vt){Gt.debug("[addVideoMedia] success; userMediaStreamId: "+vt.userMediaStreamId);var Tt=apiCC.getUserMediaStream(Rt.callConfiguration.userMediaStreamId),Pt=Promise.resolve();Tt&&(Pt=Rt.removeStream(Tt.stream).then(function(){qt.myWebRTC_Event.createLocalStreamRemovedEvent(Rt.callType,Rt.callId,Tt.stream,Rt.remoteId,Rt.destCallType),apiCC.releaseUserMediaStream(Tt.userMediaStreamId,Rt.callId)})),Pt.then(function(){Rt.callConfiguration.userMediaStreamId=vt.userMediaStreamId,Rt.callLocalStream=vt.stream,Rt.addStream(vt.stream),Rt.updateMediaWithRetryManagement(!1)}).catch(function(wt){Gt.error("Failed to addVideoMedia",wt);var Dt=null,Et=null;Rt.callControl&&(Dt=Rt.callControl.roomName,Et=Rt.callControl.type),qt.myWebRTC_Event.createErrorEvent("Failed to addVideoMedia","MEDIA_UPDATE_ERROR",Rt.callId,Dt,Et)})},failure:function(vt,Tt){Gt.debug("[addVideoMedia] failure; userMediaStreamId: "+vt.userMediaStreamId),Rt.onUserMediaErrorOnCall(Tt)}})},this.stopScreenSharing=function(){Gt.debug("stopScreenSharing detected"),qt.removeCallFromTableWithCallIdAndSendBye(this.callId,"stop_ScreenSharing")},this.checkingMutingState=function(){var Rt=this,nt=null;Gt.debug("checkingMutingState");var vt=function(){(0,ct.ki)(Rt,"mcuRemoteStream","object")||(Rt.mcuRemoteStream={}),Rt.mcuRemoteStream.videoMuted=!0},Tt=function(){(0,ct.ki)(Rt,"mcuRemoteStream","object")||(Rt.mcuRemoteStream={}),Rt.mcuRemoteStream.audioMuted=!0};(0,ct.ki)(this.callConfiguration,"userMediaStreamId","string")&&(nt=apiCC.getUserMediaStream(this.callConfiguration.userMediaStreamId))&&(nt.videoMuted?(vt(),this.isLocalVideoMuted=!0):this.isLocalVideoMuted=!1,nt.audioMuted?(Tt(),this.isLocalAudioMuted=!0):this.isLocalAudioMuted=!1);var Pt=function(){Rt.isLocalVideoMuted||(nt?nt.video&&!nt.videoMuted&&nt.muteVideoOnStreams("enabled"):Rt.callLocalStream&&(qt.muteTracks(Rt.callLocalStream.getVideoTracks()),Rt.isLocalVideoMuted=!0),vt())},wt=function(){Rt.isLocalAudioMuted||(nt?nt.audio&&!nt.audioMuted&&nt.muteAudioOnStreams("enabled"):Rt.callLocalStream&&(qt.muteTracks(Rt.callLocalStream.getAudioTracks()),Rt.isLocalAudioMuted=!0),Tt())};qt.isVideoMuted===!0&&(Gt.log("Client is video muted, applying to call"),Pt()),qt.isAudioMuted===!0&&(Gt.log("Client is audio muted, applying to call"),wt()),(0,ct.ki)(this.callConfiguration,"muted","string")&&(Gt.log("callConfiguration muted is set :",this.callConfiguration.muted),this.callConfiguration.muted==="VIDEO"&&(Pt(),wt()),this.callConfiguration.muted==="AUDIOONLY"&&wt(),this.callConfiguration.muted==="VIDEOONLY"&&Pt(),delete this.callConfiguration.muted)},this.onUserMediaSuccessOnCall=function(Rt){Gt.info("onUserMediaSuccessOnCall");var nt=(0,ct.Pj)(),vt={};qt.userMediaErrorDetected===!0&&(qt.userMediaErrorDetected=!1,vt.userMediaErrorDetected=qt.userMediaErrorDetected,apiCC.session.setUserData(vt)),Gt.log("isHTTPS()"+nt),qt.getUserMediaOnGoing=!1,Gt.log("User has granted access to local media."),qt.accessToLocalMedia=!0,this.accessToMedia=!0,this.screenSharing===!0?(this.callType="screenSharing",Rt!=null&&(Rt.onended=this.callback(this,"stopScreenSharing"),Rt.getVideoTracks().length>0&&(Rt.getVideoTracks()[0].onended=this.callback(this,"stopScreenSharing")))):this.audioOnly===!0&&(this.callType="audio"),Rt!==void 0&&(this.callLocalStream=Rt),(0,ct.yJ)()?(Gt.log("isHTTP true"),this.establishCall()):(Gt.log("webRTCClient.userAcceptOnIncomingCall :"+qt.userAcceptOnIncomingCall),Gt.log("this.callee :"+this.callee),this.data!==void 0&&Gt.log("this.data.MCUType :"+this.data.MCUType),qt.userAcceptOnIncomingCall!==!0||this.callee!==!0&&this.data.MCUType!=="MCU-Callee"||this.isAccepted!==!1?this.calleeId!=="LOCAL"?this.establishCall():Gt.log("call is not established as this is a LOCAL stream request"):Gt.log("Stand-by :: wait for establishCall"))},this.establishCall=function(){var Rt=this;Gt.debug("establishCall()"),this.started!==!0||this.addingUserMedia!==!0||!this.belongsToRoom()||this.settingUpType!=="publish"||this.data&&this.data.hasOwnProperty("MCUType")||!this.sessionMCU||this.sessionMCU.hasOwnProperty("roomMode")||(this.restarting=!0,this.pc.close(),this.pc=null,this.started=!1,this.localDescriptionSetted=!1,this.remoteDescriptionSetted=!1,this.sendedSdpOfferMessage=null,this.receivedSdpOfferMessage=null,this.rtpSenders={audio:[],video:[]},this.addingUserMedia=!1,this.updateUserMedia=!1,this.updateCause=null,this.incomingcandidatesQueue=[],this.message200OKReceived=!1,this.statisticId&&(clearInterval(this.statisticId),this.statisticId=null),this.csmIntervalId&&(clearInterval(this.csmIntervalId),this.csmIntervalId=null),this.instanceId=apiCC.generateInstanceId(),this.data.instanceId=this.instanceId),this.dataCall!==!0&&this.checkingMutingState(),this.maybeStart();var nt=null;this.callee&&this.addingUserMedia!==!0&&this.updateUserMedia!==!0?(nt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(this.receivedSdpOfferMessage),Gt.log("Avant setRemote pour le callee :",nt),this.pc!==null?(qt.preferSendingH264Codec&&(Gt.log("Modification of SDP to set H264 as prefered sending codec"),nt.sdp=qt.mySDPManager.maybePreferCodec(nt.sdp,"video","H264")),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("establishCall : before setRemoteDescription for callee"),this.pc.setRemoteDescription(nt,this.callback(this,"onSetRemoteDescriptionSuccess"),this.callback(this,"onSetRemoteDescriptionFailure"))):(Gt.log("establishCall : before setRemoteDescription for callee - Promise version"),this.pc.setRemoteDescription(nt).then(this.callback(this,"onSetRemoteDescriptionSuccess")).catch(this.callback(this,"onSetRemoteDescriptionFailure")))):Gt.log("Error : PC is null"),this.doAnswer()):this.addingUserMedia===!0?(Gt.log("Adding local stream 1."),this.pc!==null?(this.callLocalStream===null&&qt.localStream!==null&&(this.callLocalStream=qt.localStream),this.callLocalStream!==null?(Gt.log("Add Stream of callLocalStream"),this.addStream(this.callLocalStream).then(function(){Rt.updateMediaWithRetryManagement(!1)}).catch(function(vt){Gt.error("failed to add stream",vt)})):(Gt.log("No Stream to addStream"),this.updateMediaWithRetryManagement(!1))):Gt.error("Error : PC is null")):this.updateUserMedia===!0&&this.updateMediaWithRetryManagement(!1),Gt.log("End of establishCall()")},this.onUserMediaSuccessTestUni=function(){qt.getUserMediaOnGoing=!1,Gt.info("onUserMediaSuccessTestUni : User has not granted access to local media.");var Rt=null,nt={};qt.userMediaErrorDetected===!0&&(qt.userMediaErrorDetected=!1,nt.userMediaErrorDetected=qt.userMediaErrorDetected,apiCC.session.setUserData(nt)),qt.accessToLocalMedia=!0,this.maybeStart(),this.callee&&(Rt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(this.receivedSdpOfferMessage),qt.preferSendingH264Codec&&(Gt.log("Modification of SDP to set H264 as prefered sending codec"),Rt.sdp=qt.mySDPManager.maybePreferCodec(Rt.sdp,"video","H264")),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("onUserMediaSuccessTestUni : before setRemoteDescription for callee"),this.pc.setRemoteDescription(Rt,this.callback(this,"onSetRemoteDescriptionSuccess"),this.callback(this,"onSetRemoteDescriptionFailure"))):(Gt.log("onUserMediaSuccessTestUni : before setRemoteDescription for callee - Promise version"),this.pc.setRemoteDescription(Rt).then(this.callback(this,"onSetRemoteDescriptionSuccess")).catch(this.callback(this,"onSetRemoteDescriptionFailure"))),this.doAnswer())},this.onUserMediaErrorOnCall=function(Rt){var nt=this;Gt.log("onUserMediaErrorOnCall");var vt={};qt.getUserMediaOnGoing=!1,setTimeout(function(){fn.createErrorEvent(Rt,"USER_MEDIA_ERROR",nt.callId)}),Gt.error("Failed to get access to local media. Error code was "+Rt.code),Gt.error(Rt),Rt=null,ot.$6!=="electron"&&ot.Xh==="Chrome"&&ot.PR>47&&(Gt.log("browser_version > 47"),window.location.protocol!=="https:"&&Gt.error("HTTPS is now mandatory to use getUserMedia()")),this.screenSharing===!0&&(this.callType="screenSharing",window.location.protocol!=="https:"?(Gt.log("You need to be connected using HTTPS for screenSharing"),fn.createDesktopCaptureEvent("UserMediaError_HTTPS_needed",this.callId,this.remoteId)):(Gt.log("screenSharing UserMediaError"),fn.createDesktopCaptureEvent("UserMediaError",this.callId,this.remoteId))),this.callee===!0?(this.myWebRTC_Stack.sendBye(this.callId,this.calleeId,this.dest_roomId,this.callerId,"User_Media_Error",this.data),qt.removeCallFromTableWithCallIdandRemoteId(this.callId,this.callerId,"User_Media_Error")):(this.data!==void 0&&this.data!==null&&this.data.MCUType==="MCU-Callee"&&this.myWebRTC_Stack.sendBye(this.callId,this.callerId,this.dest_roomId,this.calleeId,"User_Media_Error",this.data),qt.removeCallFromTableWithCallIdandRemoteId(this.callId,this.calleeId,"User_Media_Error")),this.screenSharing===!1&&(qt.userMediaErrorDetected=!0,vt.userMediaErrorDetected=qt.userMediaErrorDetected,apiCC.session.setUserData(vt))},this.maybeStart=function(){Gt.debug("maybeStart"),!this.started&&qt.channelReady&&(qt.accessToLocalMedia||this.dataCall)&&(Gt.log("Creating PeerConnection."),this.createPeerConnection(),qt.unidirectionelCallOnly||this.screenSharing===!0?this.callee===!1&&(Gt.log("Adding local stream 2."),this.callLocalStream!==null?(Gt.log("Add Stream of callLocalStream"),this.addStream(this.callLocalStream)):qt.localStream!==null?(Gt.log("Add Stream of client.localStream"),this.addStream(qt.localStream),this.callLocalStream=qt.localStream):Gt.log("No Stream to add")):this.dataCall||(Gt.log("Adding local stream 3."),this.callLocalStream!==null?(Gt.log("Add Stream of callLocalStream"),this.addStream(this.callLocalStream)):qt.localStream!==null?(Gt.log("Add Stream of client.localStream"),this.addStream(qt.localStream),this.callLocalStream=qt.localStream):(Gt.log("No Stream to add"),this.belongsToRoom()||ct.wL.type!=="safari"||typeof this.pc.addTransceiver!="function"||(Gt.debug("add transceivers"),this.pc.addTransceiver("audio",{direction:"recvonly"}),this.pc.addTransceiver("video",{direction:"recvonly"})))),this.started=!0,this.callee===!1&&(Gt.log("Before doCall()"),this.doCall())),Gt.log("End of maybeStart")},this.createDataChannel=function(){if(Gt.info("createDataChannel"),ot.Xh==="Edge"&&ot.PR<79&&apiRTC.browserDetails.type!=="chrome")Gt.warn("Cannot create DataChannel as it is not supported on Edge");else if(this.sendDataChannel===null)try{this.sendDataChannel=this.pc.createDataChannel("apiRTCDataChannel",{}),this.sendDataChannel.binaryType="arraybuffer",Gt.log("Created data channel"),Gt.log("Subscribing to dc events"),this.sendDataChannel.onopen=this.callback(this,"onSendDataChannelOpen"),this.sendDataChannel.onclose=this.callback(this,"onSendDataChannelClose"),this.sendDataChannel.onmessage=this.callback(this,"onSendDataChannelMessage"),this.sendDataChannel.onerror=this.callback(this,"onSendDataChannelError")}catch(Rt){Gt.log("createDataChannel() failed with exception: "+Rt.message)}else Gt.log("Datachannel already exist")},this.createPeerConnection=function(){Gt.info("createPeerConnection");try{Gt.log("createPeerConnection with pc_config:",JSON.stringify(this.pc_config)),Gt.log("and pc_constraints:",JSON.stringify(this.pc_constraints)),ct.wL.type==="chrome"&&ct.wL.version>=72&&ct.wL.version<78?(Gt.debug("Chrome 72=+ and 78-, force sdpSemantics plan-b"),this.pc_config.sdpSemantics="plan-b"):apiRTC.osName==="iOS"&&typeof cordova<"u"&&cordova.plugins!==void 0&&cordova.plugins.iosrtc!==void 0?(Gt.debug("Cordova, force sdpSemantics plan-b"),this.pc_config.sdpSemantics="plan-b"):Gt.debug("sdpSemantics unified-plan is being used"),this.pc=new apiCC.myWebRTC_Adapter.RTCPeerConnection(this.pc_config,this.pc_constraints),this.dataCall&&this.createDataChannel(),this.pc.onicecandidate=this.callback(this,"onIceCandidate")}catch(Rt){return Gt.log("Failed to create PeerConnection, exception: "+Rt.message),void Gt.error("Cannot create RTCPeerConnection object; WebRTC is not supported by this browser.")}ot.Xh==="Firefox"&&ot.PR>=53||ot.Xh==="Edge"||ct.wL.type==="chrome"&&ct.wL.version>=64?(this.pc.ontrack=this.callback(this,"onRemoteTrackAdded"),this.pc.onaddstream=this.callback(this,"onRemoteStreamAdded")):ot.Xh==="Safari"&&ot.PR>=12||ot.Xh==="Mobile Safari"&&ot.PR>=12?this.pc.ontrack=this.callback(this,"onRemoteTrackAdded"):this.pc.onaddstream=this.callback(this,"onRemoteStreamAdded"),this.pc.onremovestream=this.callback(this,"onRemoteStreamRemoved"),this.pc.onnegotiationneeded=this.callback(this,"onNegotiationNeeded"),this.pc.onsignalingstatechange=this.callback(this,"onSignalingStateChange"),this.pc.oniceconnectionstatechange=this.callback(this,"onIceConnectionStateChange"),this.pc.ondatachannel=this.callback(this,"onDataChannel"),this.pc.onicegatheringstatechange=this.callback(this,"onIceGatheringStateChange"),this.pc.onconnectionstatechange=this.callback(this,"onConnectionStateChange"),qt.qosEnable&&(this.statisticId=setInterval(this.callback(this,"getStatistics"),this.getStatsInterval)),qt.csmEnable&&(this.csmLastResults={},this.csmIntervalId=setInterval(this.callback(this,"csmHandler"),this.csmIntervalMs))},this.onIceGatheringStateChange=function(Rt){Gt.log("onIceGatheringStateChange"),this.pc!==null&&(Gt.info("onIceGatheringStateChange, Ice Gathering State is now : "+this.pc.iceGatheringState),this.pc.iceGatheringState==="complete"&&this.candidateNb===0&&Gt.warn("Warning, no candidate where retrieved for this call on client"))},this.onConnectionStateChange=function(Rt){Gt.log("onConnectionStateChange event :",Rt)},this.onDataChannel=function(Rt){Gt.info("onDataChannel event"),this.receiveDataChannel=Rt.channel,this.receiveDataChannel.binaryType="arraybuffer",this.sendDataChannel===null&&(Gt.log("Setting this.sendDataChannel with receivedDataChannel"),this.sendDataChannel=Rt.channel,this.sendDataChannel.onopen=this.callback(this,"onSendDataChannelOpen"),this.sendDataChannel.onclose=this.callback(this,"onSendDataChannelClose"),this.sendDataChannel.onmessage=this.callback(this,"onSendDataChannelMessage"),this.sendDataChannel.onerror=this.callback(this,"onSendDataChannelError")),Gt.log("got dataChannel",Rt.channel.label),Gt.log("Subscribing to dc events"),this.receiveDataChannel.onopen=this.callback(this,"onReceiveDataChannelOpen"),this.receiveDataChannel.onclose=this.callback(this,"onReceiveDataChannelClose"),this.receiveDataChannel.onmessage=this.callback(this,"onReceiveDataChannelMessage"),this.receiveDataChannel.onerror=this.callback(this,"onReceiveDataChannelError")},this.onSendDataChannelOpen=function(Rt){Gt.info("onSendDataChannelOpen"),this.callType==="data"&&this.calleeId==="dataChannelConnector"&&(this.pushDataStatus&&this.pushDataStatus.type==="pipeline"?(this.pushDataStatus.state="ready",setTimeout(function(){qt.startNextPushData()})):this.transferStarted!==!0&&this.startTransfer()),fn.createEvent({eventType:"sendDataChannelOpen",callId:this.callId,remoteId:this.remoteId,details:Rt})},this.onSendDataChannelClose=function(Rt){Gt.info("onSendDataChannelClose"),this.sendDataChannel=null,fn!==null&&fn.createEvent({eventType:"sendDataChannelClose",callId:this.callId,remoteId:this.remoteId,details:Rt})},this.processOnDataChannelMessage=function(Rt){var nt,vt,Tt=null,Pt=null,wt="",Dt=0;if(Gt.info("processOnDataChannelMessage"),Tt=JSON.parse(Rt.data),Gt.log("data.uuid :"+Tt.uuid),Gt.log("data.messageSize :"+Tt.messageSize),Gt.log("data.originalDataType :"+Tt.originalDataType),nt=Tt.uuid,Tt.originalDataType==="ArrayBuffer"&&(Gt.log("ArrayBuffer conversion"),Tt.message=ct.cw.decode(Tt.message)),Gt.log("data :"+Tt),Gt.log("data.uuid :"+nt),Gt.log("receiveChunkNb[uuid] :"+this.receiveChunkNb[nt]),this.receiveChunkNb[nt]===void 0)Gt.log("receiving first packet for uuid :"+nt),Gt.log("evt.data.message :"+Rt.data),this.firstDataPacket[nt]=Tt,this.receiveChunkNb[nt]=1,this.receivedSize[nt]=0,this.startingDate=new Date,this.transferDuration=0,fn.createEvent({eventType:"onFileReceiving",remoteId:this.remoteId,callId:this.callId,name:Tt.name,uuid:nt}),fn.createEvent({eventType:"onFileProgress",sendChunkNb:this.receiveChunkNb[nt],fileSize:this.firstDataPacket[nt].size,remainingSize:this.firstDataPacket[nt].size,callId:this.callId,uuid:nt,remoteId:this.remoteId,lastPacket:!1,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:0,transferEnded:!1});else if(Gt.log("new packet for uuid :"+nt),this.receiveChunkNb[nt]+=1,Gt.log("data.messageSize :"+Tt.messageSize),Gt.log("data.message.length :"+Tt.message.length),Dt=Tt.messageSize||Tt.message.length,Gt.log("receivedSize :"+Dt),this.receiveArrayToStoreChunks[nt]||(this.receiveArrayToStoreChunks[nt]=[]),this.receiveArrayToStoreChunks[nt].push(Tt.message),this.receivedSize[nt]+=Dt,this.transferDuration=new Date-this.startingDate,this.receivedSize[nt]===this.firstDataPacket[nt].size){if(Gt.log("End of data transfert"),Gt.log("this.firstDataPacket.type :"+this.firstDataPacket[nt].type),this.firstDataPacket[nt].type==="image/png-dataUrl"){for(Gt.log("Photo received from a takeSnapshot"),vt=0;vt<this.receiveArrayToStoreChunks[nt].length;vt+=1)wt+=this.receiveArrayToStoreChunks[nt][vt];Pt=wt}else Pt=new window.Blob(this.receiveArrayToStoreChunks[nt]);fn.createEvent({eventType:"onFileProgress",sendChunkNb:this.receiveChunkNb[nt],fileSize:this.firstDataPacket[nt].size,remainingSize:0,callId:this.callId,uuid:nt,remoteId:this.remoteId,lastPacket:!1,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:100,transferEnded:!0}),fn.createEvent({eventType:"onFileReceived",callId:this.callId,uuid:nt,remoteId:this.remoteId,callerId:this.callerId,calleeId:this.calleeId,data:{file:Pt,name:this.firstDataPacket[nt].name,type:this.firstDataPacket[nt].type,uuid:nt},details:Rt}),delete this.receiveArrayToStoreChunks[nt],delete this.receivedSize[nt],delete this.receiveChunkNb[nt],delete this.firstDataPacket[nt]}else fn.createEvent({eventType:"onFileProgress",sendChunkNb:this.receiveChunkNb[nt],fileSize:this.firstDataPacket[nt].size,remainingSize:this.firstDataPacket[nt].size-this.receivedSize[nt],callId:this.callId,uuid:nt,remoteId:this.remoteId,lastPacket:!1,startingDate:this.startingDate,transferDuration:this.transferDuration,percentage:parseInt(100*this.receivedSize[nt]/this.firstDataPacket[nt].size,10),transferEnded:!1})},this.onSendDataChannelMessage=function(Rt){Gt.info("onSendDataChannelMessage :",Rt),this.processOnDataChannelMessage(Rt)},this.onSendDataChannelError=function(Rt){Gt.info("onSendDataChannelError"),this.sendDataChannel=null,fn.createEvent({eventType:"sendDataChannelError",callId:this.callId,remoteId:this.remoteId,details:Rt})},this.onReceiveDataChannelOpen=function(Rt){Gt.info("onReceiveChannelOpen"),fn.createEvent({eventType:"receiveDataChannelOpen",callId:this.callId,remoteId:this.remoteId,details:Rt})},this.onReceiveDataChannelClose=function(Rt){Gt.info("onReceiveDataChannelClose"),this.receiveDataChannel=null,fn!==null&&fn.createEvent({eventType:"receiveDataChannelClose",callId:this.callId,remoteId:this.remoteId,details:Rt})},this.onReceiveDataChannelMessage=function(Rt){Gt.info("onReceiveChannelMessage"),this.processOnDataChannelMessage(Rt)},this.onReceiveDataChannelError=function(Rt){Gt.info("onReceiveChannelError"),fn.createEvent({eventType:"receiveDataChannelError",callId:this.callId,remoteId:this.remoteId,details:Rt})},this.startTransfer=function(){var Rt=this,nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},vt=nt.hasOwnProperty("delay")?nt.delay:100;this.transferStarted!==!0&&(Gt.info("startTransfer",vt),this.transferStarted=!0,setTimeout(function(){Rt.dcfs||(Rt.dcfs=new Ht(Rt),Rt.data.offset>0?Rt.dcfs.transfer(Rt.fileContent.buffer,Rt.data.offset,Rt.sendDataChannel,{delay:vt}):Rt.dcfs.transfer(Rt.fileContent.buffer,0,Rt.sendDataChannel,{delay:vt}))},vt))},this.statisticsAnswer=function(Rt){var nt=Rt.result(),vt=null;this.qm||(this.qm=new kt(this.getStatsInterval/1e3,this.callback(this,"onQosChange"),this.callback(this,"onQosAudioChange"),this.callback(this,"onQosVideoChange"),this.callId,qt.apiKey,qt.clientId,qt.socket)),nt&&(this.qm.insertStats(nt,this.sendedSdpOfferMessage,this.receivedSdpOfferMessage,qt.remoteVideo),vt=this.qm.getAllStats(),qt.qosEnable&&fn.createEvent({eventType:"onQosStatsUpdate",callId:this.callId,remoteId:this.remoteId,stats:vt}),this.videoReceivedWidth=vt.VideoRecv.FrameWidth,this.videoReceivedHeight=vt.VideoRecv.FrameHeight,this.videoSendWidth=vt.VideoSend.FrameWidth,this.videoSendHeight=vt.VideoSend.FrameHeight,this.videoReceivedDelay=vt.VideoRecv.delay,this.audioReceivedDelay=vt.AudioRecv.delay,this.audioSendDelay=vt.AudioSend.rtt,this.videoSendDelay=vt.VideoSend.rtt,this.videoSendMoyDelay=vt.VideoSend.moyRtt,this.videoSendPacketLossRatio=vt.VideoSend.packetLostRatio,this.audioSendPacketLossRatio=vt.AudioSend.packetLostRatio,this.videoSendEncodeUsagePercent=vt.VideoSend.googEncodeUsagePercent,this.videoSendCpuLimitedResolution=vt.VideoSend.googCpuLimitedResolution,this.videoSendBandwidthLimitedResolution=vt.VideoSend.googBandwidthLimitedResolution,this.videoSendCpuLimitedResolution!==void 0&&JSON.parse(this.videoSendCpuLimitedResolution)===!0&&fn.createEvent({eventType:"cpuLimited",callId:this.callId,encodeUsagePercent:this.videoSendEncodeUsagePercent}),this.videoSendBandwidthLimitedResolution!==void 0&&JSON.parse(this.videoSendBandwidthLimitedResolution)===!0&&fn.createEvent({eventType:"bandwidthLimited",callId:this.callId}))},this.csmGetStatsHandler=function(Rt){var nt,vt=this,Tt=null,Pt=null,wt={};if(this.csm||(this.csm=new Wt(this.csmIntervalMs/1e3,ct.wL.type,ct.wL.version,"standard"),this.csm.browserInfo={browserAbout:ot.Xh+" "+ot.dc,browserType:ct.wL.type,browserVersion:ct.wL.version},(0,ct.Ym)(this.mcuRemoteStream,"attributes","object")&&(this.mcuRemoteStream.replay===!0?(0,ct.Ym)(this.mcuRemoteStream.attributes.callerId,"string")&&(0,ct.Ym)(this.mcuRemoteStream.attributes.callId,"string")&&(0,ct.Ym)(this.mcuRemoteStream.attributes.recId,"string")&&(this.csm.callFeed={clientId:this.mcuRemoteStream.attributes.callerId,callId:this.mcuRemoteStream.attributes.callId,modifier:"replay",recId:this.mcuRemoteStream.attributes.recId}):(0,ct.Ym)(this.mcuRemoteStream.attributes.callerId,"string")&&(0,ct.Ym)(this.mcuRemoteStream.attributes.callId,"string")&&(this.csm.callFeed={clientId:this.mcuRemoteStream.attributes.callerId,callId:this.mcuRemoteStream.attributes.callId}))),wt.post=function(Et){vt.mos||(vt.mos=new nn),Et.quality={},Et.audioReceived?vt.isRemoteAudioMuted?Et.quality.mosS="Muted":Et.audioReceived.bitsReceivedPerSecond!==0?(Et.audioReceived.delay=parseInt(vt.audioReceivedDelay,10),Et.quality.mosS=vt.mos.NarrowBandSpeechQuality(Et.audioReceived.delay,Et.audioReceived.packetLossRatio)):Et.quality.mosS="NoStream":Et.quality.mosS="NoStream",Et.videoReceived?vt.isRemoteVideoMuted?Et.quality.mosV="Muted":Et.videoReceived.bitsReceivedPerSecond!==0?(Et.videoReceived.width=vt.videoReceivedWidth,Et.videoReceived.height=vt.videoReceivedHeight,Et.videoReceived.delay=parseInt(vt.videoReceivedDelay,10),Et.quality.mosV=vt.mos.videoQuality(Et.videoReceived.width,Et.videoReceived.height,Et.videoReceived.packetLossRatio,Math.floor(Et.videoReceived.bitsReceivedPerSecond/1e3),Et.videoReceived.framesDecodedPerSecond)):Et.quality.mosV="NoStream":Et.quality.mosV="NoStream",Et.audioReceived&&Et.videoReceived&&(Et.quality.mosAV=vt.mos.audiovisualQuality(Et.quality.mosS,Et.quality.mosV,Et.audioReceived.delay,Et.videoReceived.delay)),Et.audioSent?vt.isLocalAudioMuted?Et.quality.mosSS="Muted":Et.audioSent.bitsSentPerSecond!==0?(Et.audioSent.delay=parseInt(vt.audioSendDelay,10),Et.audioSent.packetLossRatio=vt.audioSendPacketLossRatio,Et.quality.mosSS=vt.mos.NarrowBandSpeechQuality(Et.audioSent.delay,Et.audioSent.packetLossRatio)):Et.quality.mosSS="NoStream":Et.quality.mosSS="NoStream",Et.videoSent?vt.isLocalVideoMuted?Et.quality.mosSV="Muted":Et.videoSent.bitsSentPerSecond!==0?(Et.videoSent.width=vt.videoSendWidth,Et.videoSent.height=vt.videoSendHeight,Et.videoSent.delay=parseInt(vt.videoSendDelay,10),Et.videoSent.moyDelay=parseInt(vt.videoSendMoyDelay,10),Et.videoSent.packetLossRatio=vt.videoSendPacketLossRatio,Et.videoSent.encodeUsagePercent=vt.videoSendEncodeUsagePercent,Et.videoSent.cpuLimitedResolution=vt.videoSendCpuLimitedResolution,Et.videoSent.bandwidthLimitedResolution=vt.videoSendBandwidthLimitedResolution,Et.quality.mosSV=vt.mos.videoQuality(Et.videoSent.width,Et.videoSent.height,Et.videoSent.packetLossRatio,Math.floor(Et.videoSent.bitsSentPerSecond/1e3),Et.videoSent.framesEncodedPerSecond)):Et.quality.mosSV="NoStream":Et.quality.mosSV="NoStream",Et.audioSent&&Et.videoSent&&(Et.quality.mosSAV=vt.mos.audiovisualQuality(Et.quality.mosSS,Et.quality.mosSV,Et.audioSent.delay,Et.videoSent.delay))},nt=this.csm.addCallStats(Rt,wt),Object.keys(nt).length!==0){!nt.quality||nt.quality.mosS==="Muted"&&nt.quality.mosV==="Muted"&&nt.quality.mosSS==="Muted"&&nt.quality.mosSV==="Muted"||qt.qualityScoreEnable&&fn.createEvent({eventType:"onCallScoreUpdate",callId:this.callId,score:nt.quality}),this.csmLastResults=nt,this.callLocalStream&&typeof this.callLocalStream.getVideoTracks=="function"&&(Tt=this.callLocalStream.getVideoTracks())&&Tt[0]&&typeof Tt[0].getSettings=="function"&&(Pt=Tt[0].getSettings());var Dt={save:!0,clientId:qt.clientId,callId:this.callId,instanceId:this.instanceId,browserInfo:this.csm.browserInfo,stats:nt};this.sessionMCU&&(Dt.roomId=this.sessionMCU.roomName,Dt.pubSub=qt.MCUClient.pubConnector),this.csm.callFeed&&(Dt.callFeed=this.csm.callFeed),Pt&&(Dt.videoSettings=Pt),this.data.mesh&&(Dt.mesh=this.data.mesh),this.myWebRTC_Stack.sendInfo("callStats",Dt),qt.csmEnable&&(this.data&&this.data.mesh&&(this.data.mesh.calleeCompositeUserId?this.data.mesh.calleeCompositeUserId===qt.compositeClientId:this.data.mesh.calleeId===qt.clientId)?fn.createEvent({eventType:"onCallStatsUpdate",callId:this.data.mesh.calleeCallId,userId:this.data.mesh.callerId,stats:nt}):fn.createEvent({eventType:"onCallStatsUpdate",callId:this.callId,stats:nt}))}},this.onQosChange=function(Rt,nt){fn.createEvent({eventType:"onQosChange",callId:this.callId,remoteId:this.remoteId,qosIn:Rt,qosOut:nt})},this.onQosAudioChange=function(Rt,nt){fn.createEvent({eventType:"onQosAudioChange",callId:this.callId,remoteId:this.remoteId,qosAudioIn:Rt,qosAudioOut:nt})},this.onQosVideoChange=function(Rt,nt){fn.createEvent({eventType:"onQosVideoChange",callId:this.callId,remoteId:this.remoteId,qosVideoIn:Rt,qosVideoOut:nt})},this.getStatistics=function(){this.pc&&(ot.Xh==="Chrome"&&ot.PR>112?Gt.debug("getStats with callback in now deprecated on Chrome, getStatistics() / QoSMonitor can no more be used"):this.pc.getStats&&ot.Xh==="Chrome"&&this.pc.getStats(this.callback(this,"statisticsAnswer")))},this.csmHandler=function(){this.statisticId||this.getStatistics(),this.pc&&typeof this.pc.getStats=="function"&&this.pc.getStats(null).then(this.callback(this,"csmGetStatsHandler")).catch(function(Rt){Gt.warn("failed to get stats",Rt)})},this.doCall=function(){var Rt=null;Gt.log("Sending offer to peer"),this.audioOnly?(Gt.log("audioOnly call :",this.mediaConstraintsAudioOnly),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("createOffer"),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOffer"),this.callback(this,"onCreateOfferFailure"),this.mediaConstraintsAudioOnly)):(Gt.log("createOffer - Promise version"),this.pc.createOffer(this.mediaConstraintsAudioOnly).then(this.callback(this,"setLocalAndSendMessageonOffer")).catch(this.callback(this,"onCreateOfferFailure")))):this.screenSharing===!0?(Gt.log("screenSharing call : one way media :",Rt),Rt={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("createOffer"),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOffer"),this.callback(this,"onCreateOfferFailure"),Rt)):(Gt.log("createOffer - Promise version"),this.pc.createOffer(Rt).then(this.callback(this,"setLocalAndSendMessageonOffer")).catch(this.callback(this,"onCreateOfferFailure")))):this.dataCall===!0?(Gt.log("call is data only :",Rt),Rt=ot.Xh==="Firefox"&&ot.PR>43?{offerToReceiveAudio:!1,offerToReceiveVideo:!1}:{mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("createOffer"),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOffer"),this.callback(this,"onCreateOfferFailure"),Rt)):(Gt.log("createOffer - Promise version"),this.pc.createOffer(Rt).then(this.callback(this,"setLocalAndSendMessageonOffer")).catch(this.callback(this,"onCreateOfferFailure")))):(Gt.log("call is audio & video :",this.mediaConstraints),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("createOffer"),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOffer"),this.callback(this,"onCreateOfferFailure"),this.mediaConstraints)):(Gt.log("createOffer - Promise version"),this.pc.createOffer(this.mediaConstraints).then(this.callback(this,"setLocalAndSendMessageonOffer")).catch(this.callback(this,"onCreateOfferFailure"))))},this.doAnswer=function(){Gt.info("doAnswer");var Rt=null;this.audioOnly?(Gt.log("audioOnly call"),Rt=this.mediaConstraintsAudioOnly):Rt=this.mediaConstraints,ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("createAnswer"),this.pc.createAnswer(this.callback(this,"setLocalAndSendMessage"),this.callback(this,"onCreateAnswerFailure"),Rt)):(Gt.log("createAnswer - Promise version"),this.pc.createAnswer(Rt).then(this.callback(this,"setLocalAndSendMessage")).catch(this.callback(this,"onCreateAnswerFailure")))},this.doUpdateAnswer=function(){Gt.info("doUpdateAnswer");var Rt=null;this.audioOnly?(Gt.log("audioOnly call"),Rt=this.mediaConstraintsAudioOnly):Rt=this.mediaConstraints,ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("createAnswer"),this.pc.createAnswer(this.callback(this,"setLocalAndSendMessageUpdate"),this.callback(this,"onCreateAnswerFailure"),Rt)):(Gt.log("createAnswer - Promise version"),this.pc.createAnswer(Rt).then(this.callback(this,"setLocalAndSendMessageUpdate")).catch(this.callback(this,"onCreateAnswerFailure")))},this.updateMediaWithRetryManagement=function(Rt){Gt.debug("updateMediaWithRetryManagement");var nt=this.updateMedia(Rt);Gt.debug("updateMediaResult :",nt),nt.reason!=="Sig_state_not_stable"&&nt.reason!=="Update_already_ongoing"||(Gt.debug("updateMedia will be retried later for reason :",nt.reason),this.retryUpdateMedia=!0)},this.updateMedia=function(Rt){return Gt.debug("updateMedia, callId :",this.callId),Gt.log("iceRestartActivated :",Rt),this.pc===null?(Gt.log("updateMedia, pc no more exist"),{status:"Not_Done",reason:"PC_Not_Exit"}):this.updateMediaOngoing===!0?(Gt.log("updateMedia, already ongoing"),{status:"Not_Done",reason:"Update_already_ongoing"}):(this.updateMediaOngoing=!0,this.pc.signalingState!=="stable"?{status:"Not_Done",reason:"Sig_state_not_stable"}:(Gt.log("Sending Update offer to peer."),this.audioOnly?(Gt.log("audioOnly call :",this.mediaConstraintsAudioOnly),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("createOffer"),this.mediaConstraintsAudioOnly.mandatory!==void 0?this.mediaConstraintsAudioOnly.mandatory.IceRestart=!0:this.mediaConstraintsAudioOnly.iceRestart=!0,Gt.log("this.mediaConstraints :",this.mediaConstraintsAudioOnly),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOfferUpdate"),this.callback(this,"onCreateOfferFailure"),this.mediaConstraintsAudioOnly)):(Gt.log("createOffer - Promise version"),Rt===!0&&(this.mediaConstraintsAudioOnly.iceRestart=!0),Gt.log("this.mediaConstraints :",this.mediaConstraintsAudioOnly),this.pc.createOffer(this.mediaConstraintsAudioOnly).then(this.callback(this,"setLocalAndSendMessageonOfferUpdate")).catch(this.callback(this,"onCreateOfferFailure")))):ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("createOffer"),Rt===!0&&(this.mediaConstraints.mandatory!==void 0?this.mediaConstraints.mandatory.IceRestart=!0:this.mediaConstraints.iceRestart=!0),Gt.log("this.mediaConstraints :",this.mediaConstraints),this.pc.createOffer(this.callback(this,"setLocalAndSendMessageonOfferUpdate"),this.callback(this,"onCreateOfferFailure"),this.mediaConstraints)):(Gt.log("createOffer - Promise version"),Rt===!0&&(this.mediaConstraints.iceRestart=!0),Gt.log("this.mediaConstraints :",this.mediaConstraints),this.pc.createOffer(this.mediaConstraints).then(this.callback(this,"setLocalAndSendMessageonOfferUpdate")).catch(this.callback(this,"onCreateOfferFailure"))),{status:"OnGoing",reason:"OK"}))},this.manipulateSDP=function(Rt,nt){var vt=null,Tt=!1;return Gt.log("manipulateSDP with type :",nt),qt.receiveMediaDeactivated===!0&&(Gt.log("setting receiveMediaDeactivated in SDP :"+qt.receiveMediaDeactivated),Rt.sdp=qt.mySDPManager.setSendOnly(Rt.sdp)),qt.RTPMedia===!0&&(Rt.sdp=Rt.sdp.replace(/RTP\/SAVPF/g,"RTP/SF")),qt.audioBandwidth!==null&&(Gt.log("setting audioBandwidth in SDP :"+qt.audioBandwidth),Rt.sdp=qt.mySDPManager.setAudioBandwidth(Rt.sdp,qt.audioBandwidth)),qt.videoBandwidth!==null&&(Gt.log("setting videoBandwidth in SDP :"+qt.videoBandwidth),Rt.sdp=qt.mySDPManager.setVideoBandwidth(Rt.sdp,qt.videoBandwidth)),qt.dataBandwidth!==null&&(Gt.log("setting dataBandwidth in SDP :"+qt.dataBandwidth),Rt.sdp=qt.mySDPManager.setDataBandwidth(Rt.sdp,qt.dataBandwidth)),qt.preferOpusCodec===!0&&(Gt.log("setting preferOpusCodec"),Rt.sdp=qt.mySDPManager.preferOpus(Rt.sdp)),qt.preferVP9Codec!==!0&&this.preferVP9Codec!==!0||(Gt.log("Call prefer VP9 Codec"),Rt.sdp=qt.mySDPManager.maybePreferCodec(Rt.sdp,"video","VP9")),qt.preferH264Codec!==!0&&this.preferH264Codec!==!0||(Gt.log("Call prefer H264 Codec"),Rt.sdp=qt.mySDPManager.maybePreferCodec(Rt.sdp,"video","H264")),this.preferVP8Codec===!0&&(Gt.log("Call prefer VP8 Codec"),Rt.sdp=qt.mySDPManager.maybePreferCodec(Rt.sdp,"video","VP8")),qt.setStereo===!0&&(Gt.log("Set Stereo"),Rt.sdp=qt.mySDPManager.setCodecParam(Rt.sdp,"opus/48000","stereo","1")),Rt=qt.mySDPManager.updateSDPcodecs(Rt,Rt.type,"audio",qt.allowedAudioCodecs),Rt=qt.mySDPManager.updateSDPcodecs(Rt,Rt.type,"video",qt.allowedVideoCodecs),nt==="OFFER"?this.settingUpType==="publish"&&this.mediaTypeForIncomingCall==="NONE"?(vt=qt.mySDPManager.createGuideline(Rt.sdp),this.mediaTypeForOutgoingCall==="VIDEO"?((0,ct.ki)(vt,"audio","object")&&vt.audio.direction!=="sendonly"&&(vt.audio.direction="sendonly",Tt=!0),(0,ct.ki)(vt,"video","object")&&vt.video.direction!=="sendonly"&&(vt.video.direction="sendonly",Tt=!0)):this.mediaTypeForOutgoingCall==="AUDIO"?((0,ct.ki)(vt,"audio","object")&&vt.audio.direction!=="sendonly"&&(vt.audio.direction="sendonly",Tt=!0),(0,ct.ki)(vt,"video","object")&&vt.video.direction!=="inactive"&&(vt.video.direction="inactive",Tt=!0)):this.mediaTypeForOutgoingCall==="VIDEOONLY"&&((0,ct.ki)(vt,"audio","object")&&vt.audio.direction!=="inactive"&&(vt.audio.direction="inactive",Tt=!0),(0,ct.ki)(vt,"video","object")&&vt.video.direction!=="sendonly"&&(vt.video.direction="sendonly",Tt=!0)),Tt===!0&&(Rt.sdp=vt.generate())):this.mediaTypeForOutgoingCall==="VIDEO"?Gt.log("mediaTypeForOutgoingCall is VIDEO"):this.mediaTypeForOutgoingCall==="AUDIO"||this.audioOnly===!0?(Gt.log("mediaTypeForOutgoingCall is AUDIO"),Rt.sdp=qt.mySDPManager.setRecvOnlyForVideo(Rt.sdp)):this.mediaTypeForOutgoingCall==="VIDEOONLY"?(Gt.log("mediaTypeForOutgoingCall is VIDEOONLY"),Rt.sdp=qt.mySDPManager.setRecvOnlyForAudio(Rt.sdp)):this.mediaTypeForOutgoingCall==="NONE"&&(Gt.log("mediaTypeForOutgoingCall is NONE"),Rt.sdp=qt.mySDPManager.setRecvOnly(Rt.sdp)):nt==="ANSWER"&&(this.mediaTypeForIncomingCall==="VIDEO"?Gt.log("mediaTypeForIncomingCall is VIDEO"):this.mediaTypeForIncomingCall==="AUDIO"||this.audioOnly===!0?(Gt.log("mediaTypeForIncomingCall is AUDIO"),Rt.sdp=qt.mySDPManager.setRecvOnlyForVideo(Rt.sdp)):this.mediaTypeForIncomingCall==="VIDEOONLY"?(Gt.log("mediaTypeForIncomingCall is VIDEOONLY"),Rt.sdp=qt.mySDPManager.setRecvOnlyForAudio(Rt.sdp)):this.mediaTypeForIncomingCall==="NONE"&&(Gt.log("mediaTypeForIncomingCall is NONE"),Rt.sdp=qt.mySDPManager.setRecvOnly(Rt.sdp))),this.simulcast==="SDP"&&nt==="OFFER"&&this.settingUpType==="publish"&&((vt=qt.mySDPManager.createGuideline(Rt.sdp)).mungeForSimulcasting(),Rt.sdp=vt.generate()),Rt},this.setLocalAndSendMessageonOffer=function(Rt){Gt.info("setLocalAndSendMessageonOffer"),Gt.log("sessionDescription = ",Rt),Gt.log("sessionDescription.sdp = ",Rt.sdp);var nt=null;Rt.sdp=this.manipulateSDP(Rt,"OFFER").sdp,Gt.log("manipulated sessionDescription.sdp = ",Rt.sdp),this.stripAudioSDPActivated===!0&&(Rt.sdp=qt.mySDPManager.stripAudioMediaDescriptionFromSDP(Rt.sdp)),this.stripVideoSDPActivated===!0&&(Rt.sdp=qt.mySDPManager.stripVideoMediaDescriptionFromSDP(Rt.sdp)),this.setLocalCallProfile(qt.evalCallProfileWithSdp(Rt.sdp,"local","send")),this.sendedSdpOfferMessage=Rt,this.dataCall===!0&&(Gt.log("setLocalAndSendMessageonOffer : data Call"),this.callType="data"),this.callCancelled===!1?qt.NtoNConf===!1?(Gt.log("Conf N to 1"),this.screenSharing===!0&&(nt=qt.mySDPManager.getAudioMediaDescriptionPart(this.sendedSdpOfferMessage.sdp),this.callType=nt!=null?"screenSharingWithAudio":"screenSharing"),this.trickleIce===!0&&(this.myWebRTC_Stack.sendInvite(this.callId,this.callerId,qt.nickname,this.dest_roomId,this.dest_roomId,this.callType,{offer:Rt,data:this.data,stream:this.mcuRemoteStream,volatile:!!this.restarted}),this.inviteSended=!0),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("setLocalAndSendMessageonOffer : before setLocalDescription"),this.pc.setLocalDescription(this.sendedSdpOfferMessage,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(Gt.log("setLocalAndSendMessageonOffer : before setLocalDescription - Promise version"),this.pc.setLocalDescription(this.sendedSdpOfferMessage).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure")))):(Gt.log("Conf N to N"),this.myWebRTC_Stack.sendInviteBroadcast(this.callId,this.callerId,qt.nickname,this.dest_roomId,this.dest_roomId,Rt),this.inviteSended=!0):(Gt.warn("Invite is not sent has call has been canceled"),qt.removeCallFromTableWithCallIdandRemoteId(this.callId,this.calleeId,"Call_Cancelled"),qt.callsTable.length===0&&Gt.log("No more established calls for client"))},this.setLocalAndSendMessageonOfferUpdate=function(Rt){var nt,vt=null;Gt.info("setLocalAndSendMessageonOfferUpdate, sessionDescription :"+Rt),this.sendedSdpOfferMessage=Rt,Gt.log("sessionDescription.sdp = ",Rt.sdp),((0,ct.Ym)(this.audioSdpDirection,"string")||(0,ct.Ym)(this.videoSdpDirection,"string"))&&(vt=qt.mySDPManager.createGuideline(Rt.sdp),(0,ct.ki)(vt,"audio","object")&&(0,ct.Ym)(this.audioSdpDirection,"string")&&(vt.audio.direction=this.audioSdpDirection),(0,ct.ki)(vt,"video","object")&&(0,ct.Ym)(this.videoSdpDirection,"string")&&(vt.video.direction=this.videoSdpDirection),Rt.sdp=vt.generate()),this.setLocalCallProfile(qt.evalCallProfileWithSdp(Rt.sdp,"local","send"),!0),nt=this.callee?this.callerId:this.calleeId,this.trickleIce===!0?(this.myWebRTC_Stack.sendUpdate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Rt,this.callType,this.data),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("setLocalAndSendMessageonOfferUpdate : before setLocalDescription"),this.pc.setLocalDescription(Rt,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(Gt.log("setLocalAndSendMessageonOfferUpdate : before setLocalDescription - Promise version"),this.pc.setLocalDescription(Rt).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure")))):(Gt.log("Updating PC offer and answer after switch Stream"),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("setLocalAndSendMessageonOfferUpdate : before setLocalDescription"),this.pc.setLocalDescription(Rt,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(Gt.log("setLocalAndSendMessageonOfferUpdate : before setLocalDescription - Promise version"),this.pc.setLocalDescription(Rt).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure"))),qt.preferSendingH264Codec&&(Gt.log("Modification of SDP to set H264 as prefered sending codec"),this.pc.remoteDescription.sdp=qt.mySDPManager.maybePreferCodec(this.pc.remoteDescription.sdp,"video","H264")),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("setLocalAndSendMessageonOfferUpdate : before setRemoteDescription"),this.pc.setRemoteDescription(this.pc.remoteDescription,this.callback(this,"onSetRemoteDescriptionSuccess"),this.callback(this,"onSetRemoteDescriptionFailure"))):(Gt.log("setLocalAndSendMessageonOfferUpdate : before setRemoteDescription - Promise version"),this.pc.setRemoteDescription(this.pc.remoteDescription).then(this.callback(this,"onSetRemoteDescriptionSuccess")).catch(this.callback(this,"onSetRemoteDescriptionFailure"))))},this.onCreateOfferFailure=function(Rt){Gt.info("onCreateOfferFailure"+Rt),Rt=null},this.onCreateAnswerFailure=function(Rt){Gt.info("onCreateAnswerFailure"+Rt),Rt=null},this.setLocalAndSendMessage=function(Rt){var nt;Gt.info("setLocalAndSendMessage"),Gt.log("sessionDescription.sdp = ",Rt.sdp),this.pc!==null?(Rt=this.manipulateSDP(Rt,"ANSWER"),nt=qt.mySDPManager.createGuideline(Rt.sdp),this.setLocalCallProfile(qt.evalCallProfileWithSdpGuideline(nt,Rt.sdp,"local","send")),this.setRemoteCallProfile(qt.evalCallProfileWithSdpGuideline(nt,Rt.sdp,"local","receive")),Gt.log("manipulated sessionDescription.sdp = ",Rt.sdp),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("setLocalAndSendMessage : before setLocalDescription"),this.pc.setLocalDescription(Rt,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(Gt.log("setLocalAndSendMessage : before setLocalDescription - Promise version"),this.pc.setLocalDescription(Rt).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure"))),this.sendedSdpOfferMessage=Rt,this.trickleIce===!0&&this.myWebRTC_Stack.send200OK(this.callId,this.callerId,this.calleeId,qt.nickname,this.dest_roomId,Rt,this.data)):Gt.log("setLocalAndSendMessage, pc no more exist")},this.setLocalAndSendMessageUpdate=function(Rt){var nt;if(this.pc!==null){ct.wL.type==="safari"&&(Rt.sdp=this.manipulateSDP(Rt,"OFFER").sdp),nt=qt.mySDPManager.createGuideline(Rt.sdp),this.mediaType==="AUDIOONLY"?nt.hasOwnProperty("video")&&nt.video.direction!=="inactive"&&(Gt.debug("Only audio was requested at call setup: deactivating video"),nt.video.direction="inactive",Rt.sdp=nt.generate()):this.mediaType==="VIDEOONLY"&&nt.hasOwnProperty("audio")&&nt.audio.direction!=="inactive"&&(Gt.debug("Only video was requested at call setup: deactivating audio"),nt.audio.direction="inactive",Rt.sdp=nt.generate()),this.setLocalCallProfile(qt.evalCallProfileWithSdpGuideline(nt,Rt.sdp,"local","send"),!0),this.setRemoteCallProfile(qt.evalCallProfileWithSdpGuideline(nt,Rt.sdp,"local","receive"),!0),this.updateOngoingTimeoutId&&(clearTimeout(this.updateOngoingTimeoutId),delete this.updateOngoingTimeoutId),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"?(Gt.log("setLocalAndSendMessageUpdate : before setLocalDescription"),this.pc.setLocalDescription(Rt,this.callback(this,"onSetLocalDescriptionSuccess"),this.callback(this,"onSetLocalDescriptionFailure"))):(Gt.log("setLocalAndSendMessageUpdate : before setLocalDescription - Promise version"),this.pc.setLocalDescription(Rt).then(this.callback(this,"onSetLocalDescriptionSuccess")).catch(this.callback(this,"onSetLocalDescriptionFailure")));var vt;vt=this.callee?this.callerId:this.calleeId,this.myWebRTC_Stack.send200Update(this.callId,this.callerId,this.calleeId,this.dest_roomId,vt,Rt,this.data),this.asyncCallbacks&&this.asyncCallbacks.type==="updateMediaType"&&(Gt.debug("asyncCallbacks resolve"),this.asyncCallbacks.resolve(),this.asyncCallbacks.timeoutId&&(clearTimeout(this.asyncCallbacks.timeoutId),delete this.asyncCallbacks.timeoutId),delete this.asyncCallbacks)}else Gt.log("setLocalAndSendMessageUpdate, pc no more exist")},this.onIceCandidate=function(Rt){try{Gt.debug("onIceCandidate :",JSON.stringify(Rt.candidate))}catch(Pt){Gt.error(Pt)}var nt,vt=0,Tt=0;nt=this.callee?this.callerId:this.calleeId,this.pc!==null&&(Gt.debug("Ice Connection State is now : "+this.pc.iceConnectionState),Gt.debug("Ice Gathering State is now : "+this.pc.iceGatheringState)),Rt.candidate?(this.candidateNb+=1,this.trickleIce===!0?this.mediaRoutingMode===qt.mediaRoutingModeEnum.hostOnly?(vt=Rt.candidate.candidate.search("host"))!==-1?this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Rt.candidate.sdpMLineIndex,Rt.candidate.sdpMid,Rt.candidate.candidate,this.data,Rt.candidate,{volatile:!!this.restarted}):Gt.log("Media routing mode is hostOnly and not a HOST Candidate : ignoring message"):this.mediaRoutingMode===qt.mediaRoutingModeEnum.stun?(vt=Rt.candidate.candidate.search("host"),Tt=Rt.candidate.candidate.search("srflx"),vt!==-1||Tt!==-1?this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Rt.candidate.sdpMLineIndex,Rt.candidate.sdpMid,Rt.candidate.candidate,this.data,Rt.candidate,{volatile:!!this.restarted}):Gt.log("Media routing mode is stun and not a HOST or SRFLX Candidate : ignoring message")):this.mediaRoutingMode===qt.mediaRoutingModeEnum.stunOnly?(vt=Rt.candidate.candidate.search("srflx"))!==-1?this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Rt.candidate.sdpMLineIndex,Rt.candidate.sdpMid,Rt.candidate.candidate,this.data,Rt.candidate,{volatile:!!this.restarted}):Gt.log("Media routing mode is stunOnly and not a SRFLX Candidate : ignoring message"):this.mediaRoutingMode===qt.mediaRoutingModeEnum.turn?(Gt.log("Media routing mode is turn : all candidates are considered"),this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Rt.candidate.sdpMLineIndex,Rt.candidate.sdpMid,Rt.candidate.candidate,this.data,Rt.candidate,{volatile:!!this.restarted})):this.mediaRoutingMode===qt.mediaRoutingModeEnum.turnOnly&&((vt=Rt.candidate.candidate.search("relay"))!==-1?this.myWebRTC_Stack.sendCandidate(this.callId,this.callerId,this.calleeId,this.dest_roomId,nt,Rt.candidate.sdpMLineIndex,Rt.candidate.sdpMid,Rt.candidate.candidate,this.data,Rt.candidate,{volatile:!!this.restarted}):Gt.log("Media routing mode is TurnOnly and not a RELAY Candidate : ignoring message")):Gt.log("trickleIce is deactivated : candidates are not sended")):(Gt.info("End of candidates."),this.trickleIce===!1&&(Gt.log("trickleIce === false"),this.callee===!0?(this.send200OKTrickleIceFalseTimeOutId!==0&&(clearTimeout(this.send200OKTrickleIceFalseTimeOutId),this.send200OKTrickleIceFalseTimeOutId=0),this.message200OKSended===!1?this.myWebRTC_Stack.send200OK(this.callId,this.callerId,this.calleeId,qt.nickname,this.dest_roomId,this.pc.localDescription,this.data):Gt.log("200OK already sended")):this.pc!==null&&(this.sendInviteTrickleIceFalseTimeOutId!==0&&(clearTimeout(this.sendInviteTrickleIceFalseTimeOutId),this.sendInviteTrickleIceFalseTimeOutId=0),this.inviteSended===!1?(Gt.log("sendInvite on end of candidate"),this.myWebRTC_Stack.sendInvite(this.callId,this.callerId,qt.nickname,this.dest_roomId,this.dest_roomId,this.callType,{offer:this.pc.localDescription,data:this.data,stream:this.mcuRemoteStream,volatile:!!this.restarted}),this.inviteSended=!0):Gt.log("Invite already sended"))))},this.combineRemoteStreams=function(Rt,nt,vt,Tt){var Pt=Rt.getTracks(),wt=vt.getTracks();if(Pt.length===1&&wt.length===1&&(Pt[0].kind==="audio"&&wt[0].kind==="video"||Pt[0].kind==="video"&&wt[0].kind==="audio")){Gt.debug("combineRemoteStreams");var Dt=new MediaStream;return Dt.addTrack(Pt[0]),Dt.addTrack(wt[0]),Tt==="internal"&&(vt.removeTrack(wt[0]),this.onRemoteStreamRemoved({stream:vt})),nt==="internal"&&(Rt.removeTrack(Pt[0]),this.onRemoteStreamRemoved({stream:Rt})),this.onRemoteStreamAdded({stream:Dt}),!0}return!1},this.checkRemoteStreamExists=function(Rt,nt){var vt=!1,Tt=null,Pt=null,wt=null,Dt=null,Et=null;for(nt&&Array.isArray(nt)&&(Dt=nt.slice(0)),Tt=this.remoteMediaStreams.length;--Tt>=0;){if(this.remoteMediaStreams[Tt].id===Rt){vt=!0;break}if(Dt)for(wt=(Pt=this.remoteMediaStreams[Tt].getTracks()).length;--wt>=0;)(Et=nt.indexOf(Pt[wt].id))>=0&&(Dt[Et]=!0)}if(!vt&&Dt){for(Et=0,wt=Dt.length;--wt>=0;)Dt[wt]===!0&&(Et+=1);Et===Dt.length&&(vt=!0)}return vt},this.onRemoteStreamAdded=function(Rt){var nt,vt,Tt=this;if(Gt.info("onRemoteStreamAdded",Rt),this.checkRemoteStreamExists(Rt.stream.id,Rt.stream.getTracks().map(function(Kt){return Kt.id})))Gt.debug("onRemoteStreamAdded: ignoring event; stream/track already known");else if(this.remoteMediaStreams.length!==1||!this.combineRemoteStreams(this.remoteMediaStreams[0],"internal",Rt.stream,"event")){Gt.debug("onRemoteStreamAdded adding",Rt.stream.id),this.remoteMediaStreams.push(Rt.stream),Gt.log("CallId is :"+this.callId),Gt.log("ClientId is :"+qt.clientId),this.sessionMCU&&this.sessionMCU.modeChangeKind==="new"&&qt.processRemoteStreamAdded(this,Rt.stream),this.screenSharing===!0?this.callType="screenSharing":this.audioOnly===!0&&(this.callType="audio");var Pt,wt=function(Kt){var rn=null,hn=null;Kt.onmute=function(an){Gt.debug(Kt.kind+" mute event");var un="";Kt.kind==="audio"&&rn===null?rn=setTimeout(function(){Tt.isRemoteAudioSilent=!0,un="audioIsSilentLocally";var Sn={},En={},An=[];An.push(un),Sn.available=Tt.remoteCallProfile.audio,Sn.active=Tt.remoteCallProfile.audioActive,Sn.muted=Tt.isRemoteAudioMuted,Sn.silent=Tt.isRemoteAudioSilent,En.available=Tt.remoteCallProfile.video,En.active=Tt.remoteCallProfile.videoActive,En.muted=Tt.isRemoteVideoMuted,En.silent=Tt.isRemoteVideoSilent,Tt.myWebRTC_Event.createRemoteStreamUpdatedEvent(An,Sn,En,Tt.destCallType,Tt.callId,"browserAction"),rn=null},2520):Kt.kind==="video"&&hn===null&&(hn=setTimeout(function(){Tt.isRemoteVideoSilent=!0,un="videoIsSilentLocally";var Sn={},En={},An=[];An.push(un),Sn.available=Tt.remoteCallProfile.audio,Sn.active=Tt.remoteCallProfile.audioActive,Sn.muted=Tt.isRemoteAudioMuted,Sn.silent=Tt.isRemoteAudioSilent,En.available=Tt.remoteCallProfile.video,En.active=Tt.remoteCallProfile.videoActive,En.muted=Tt.isRemoteVideoMuted,En.silent=Tt.isRemoteVideoSilent,Tt.myWebRTC_Event.createRemoteStreamUpdatedEvent(An,Sn,En,Tt.destCallType,Tt.callId,"browserAction"),hn=null},2520))},Kt.onunmute=function(an){if(Gt.debug(Kt.kind+" unmute event"),Kt.kind==="audio"&&rn!==null)clearTimeout(rn),rn=null;else if(Kt.kind==="video"&&hn!==null)clearTimeout(hn),hn=null;else{var un="";Kt.kind==="audio"?(Tt.isRemoteAudioSilent=!1,un="audioIsSilentLocally"):Kt.kind==="video"&&(Tt.isRemoteVideoSilent=!1,un="videoIsSilentLocally");var Sn={},En={},An=[];An.push(un),Sn.available=Tt.remoteCallProfile.audio,Sn.active=Tt.remoteCallProfile.audioActive,Sn.muted=Tt.isRemoteAudioMuted,Sn.silent=Tt.isRemoteAudioSilent,En.available=Tt.remoteCallProfile.video,En.active=Tt.remoteCallProfile.videoActive,En.muted=Tt.isRemoteVideoMuted,En.silent=Tt.isRemoteVideoSilent,Tt.myWebRTC_Event.createRemoteStreamUpdatedEvent(An,Sn,En,Tt.destCallType,Tt.callId,"browserAction")}},Kt.onended=function(an){Gt.debug(Kt.kind+" ended event"),Kt.kind==="audio"&&rn!==null?(clearTimeout(rn),rn=null):Kt.kind==="video"&&hn!==null&&(clearTimeout(hn),hn=null)}},Dt=gn(Rt.stream.getVideoTracks());try{for(Dt.s();!(Pt=Dt.n()).done;){var Et=Pt.value;wt(Et),this.isRemoteVideoSilent=Et.muted}}catch(Kt){Dt.e(Kt)}finally{Dt.f()}var jt,Yt=gn(Rt.stream.getAudioTracks());try{for(Yt.s();!(jt=Yt.n()).done;){var en=jt.value;wt(en),this.isRemoteAudioSilent=en.muted}}catch(Kt){Yt.e(Kt)}finally{Yt.f()}nt={available:this.remoteCallProfile.audio,active:this.remoteCallProfile.audioActive,muted:this.isRemoteAudioMuted,silent:this.isRemoteAudioSilent},vt={available:this.remoteCallProfile.video,active:this.remoteCallProfile.videoActive,muted:this.isRemoteVideoMuted,silent:this.isRemoteVideoSilent},this.data!==null?this.data.mesh!==void 0?qt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.stream,this.remoteId,this.destCallType,nt,vt):this.data.type==="publish"&&this.data.mode!=="passive"?Gt.warn("Filtering Remote stream added event (behavior on Chrome 44), no remote stream on publish calls"):this.data.subscribeOrder===!0&&this.data.pubCallId!==void 0?(Gt.debug("substitute callId: "+this.callId+" -> "+this.data.pubCallId),qt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.data.pubCallId,Rt.stream,this.remoteId,this.destCallType,nt,vt)):qt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.stream,this.remoteId,this.destCallType,nt,vt):qt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.stream,this.remoteId,this.destCallType,nt,vt)}},this.onRemoteTrackAdded=function(Rt){var nt,vt;if(Gt.info("onRemoteTrackAdded",Rt),Rt.streams[0]!==void 0&&Rt.track!==void 0){if(this.checkRemoteStreamExists(Rt.streams[0].id,[Rt.track.id]))Gt.debug("onRemoteTrackAdded: ignoring event; stream/track already known");else if(this.remoteMediaStreams.length!==1||!this.combineRemoteStreams(this.remoteMediaStreams[0],"internal",Rt.streams[0],"event")){if(this.belongsToRoom()){if(this.callType==="audio"&&Rt.track.kind!=="audio"||this.callType==="videoOnly"&&Rt.track.kind!=="video"||this.callType==="media"&&Rt.track.kind!=="video"||this.callType==="screenSharing"&&Rt.track.kind!=="video"||this.callType==="screenSharingWithAudio"&&Rt.track.kind!=="video")return void Gt.debug("onRemoteTrackAdded: ignoring event; callType: "+this.callType+", event.track.kind: "+Rt.track.kind)}else if(this.destCallType==="audio"&&Rt.track.kind!=="audio"||this.destCallType==="videoOnly"&&Rt.track.kind!=="video"||this.destCallType==="media"&&Rt.track.kind!=="video"||this.destCallType==="screenSharing"&&Rt.track.kind!=="video"||this.destCallType==="screenSharingWithAudio"&&Rt.track.kind!=="video")return Gt.debug("onRemoteTrackAdded: ignoring event; destCallType: "+this.destCallType+", event.track.kind: "+Rt.track.kind),void(this.remoteMediaStreams.length===2&&this.combineRemoveStreams(this.remoteMediaStreams[0],"internal",this.remoteMediaStreams[1],"internal"));Gt.debug("onRemoteTrackAdded adding; stream.id: "+Rt.streams[0].id),this.remoteMediaStreams.push(Rt.streams[0]),Gt.log("CallId is :"+this.callId),Gt.log("ClientId is :"+qt.clientId),Gt.log("this.callType :"+this.callType),this.screenSharing===!0?this.callType="screenSharing":this.audioOnly===!0&&(this.callType="audio"),this.sessionMCU&&this.sessionMCU.modeChangeKind==="new"&&qt.processRemoteStreamAdded(this,Rt.streams[0]),Rt.streams[0].onaddtrack=function(Tt){Gt.debug("onRemoteTrackAdded ontrack.onaddtrack",Tt)},Rt.streams[0].onremovetrack=(function(Tt){var Pt=null;if(Gt.debug("onRemoteTrackAdded ontrack.onremovetrack",Tt),this.updateOngoingTimeoutId)return Gt.debug("onRemoteTrackAdded onremovetrack: update ongoing"),void Gt.debug("onRemoteTrackAdded onremovetrack: ignoring event",Tt.track.kind);if(this.callType==="audio"&&Tt.track.kind!=="audio"||this.callType==="videoOnly"&&Tt.track.kind!=="video"||this.callType==="media"&&Tt.track.kind!=="video"||this.callType==="screenSharing"&&Tt.track.kind!=="video"||this.callType==="screenSharingWithAudio"&&Tt.track.kind!=="video")Gt.debug("onRemoteTrackAdded onremovetrack: ignoring event",Tt.track.kind);else if(Tt.target instanceof MediaStream){for(Pt=this.remoteMediaStreams.length;--Pt>=0;)if(this.remoteMediaStreams[Pt].id===Tt.target.id){Gt.debug("onRemoteTrackAdded onremovetrack removing",Tt.target.id),this.remoteMediaStreams.splice(Pt,1);break}qt.myWebRTC_Event.createRemoteStreamRemovedEvent(this.callType,this.callId,Tt.target,this.remoteId,this.destCallType)}else Gt.debug("onRemoteTrackAdded onremovetrack: ignoring event target not MediaStream")}).bind(this),nt={available:this.remoteCallProfile.audio,active:this.remoteCallProfile.audioActive,muted:this.isRemoteAudioMuted,silent:this.isRemoteAudioSilent},vt={available:this.remoteCallProfile.video,active:this.remoteCallProfile.videoActive,muted:this.isRemoteVideoMuted,silent:this.isRemoteVideoSilent},this.data!==null?this.data.mesh!==void 0?(this.callType==="audio"&&Rt.track.kind==="audio"||this.callType==="videoOnly"&&Rt.track.kind==="video"||this.callType==="media"&&Rt.track.kind==="video"||this.callType==="screenSharing"&&Rt.track.kind==="video"||this.callType==="screenSharingWithAudio"&&Rt.track.kind==="video")&&qt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.streams[0],this.remoteId,this.destCallType,nt,vt):this.data.type==="publish"&&this.data.mode!=="passive"?Gt.warn("Filtering Remote stream added event (behavior on Chrome 44), no remote stream on publish calls"):this.belongsToRoom()?(this.callType==="audio"&&Rt.track.kind==="audio"||this.callType==="videoOnly"&&Rt.track.kind==="video"||this.callType==="media"&&Rt.track.kind==="video"||this.callType==="screenSharing"&&Rt.track.kind==="video"||this.callType==="screenSharingWithAudio"&&Rt.track.kind==="video")&&(this.data.subscribeOrder===!0&&this.data.pubCallId!==void 0?(Gt.debug("substitute callId: "+this.callId+" -> "+this.data.pubCallId),qt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.data.pubCallId,Rt.streams[0],this.remoteId,this.destCallType,nt,vt)):qt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.streams[0],this.remoteId,this.destCallType,nt,vt)):(this.destCallType==="audio"&&Rt.track.kind==="audio"||this.destCallType==="videoOnly"&&Rt.track.kind==="video"||this.destCallType==="media"&&Rt.track.kind==="video"||this.destCallType==="screenSharing"&&Rt.track.kind==="video"||this.destCallType==="screenSharingWithAudio"&&Rt.track.kind==="video")&&qt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.streams[0],this.remoteId,this.destCallType,nt,vt):this.belongsToRoom()?(this.callType==="audio"&&Rt.track.kind==="audio"||this.callType==="videoOnly"&&Rt.track.kind==="video"||this.callType==="media"&&Rt.track.kind==="video"||this.callType==="screenSharing"&&Rt.track.kind==="video"||this.callType==="screenSharingWithAudio"&&Rt.track.kind==="video")&&qt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.streams[0],this.remoteId,this.destCallType,nt,vt):(this.destCallType==="audio"&&Rt.track.kind==="audio"||this.destCallType==="videoOnly"&&Rt.track.kind==="video"||this.destCallType==="media"&&Rt.track.kind==="video"||this.destCallType==="screenSharing"&&Rt.track.kind==="video"||this.destCallType==="screenSharingWithAudio"&&Rt.track.kind==="video")&&qt.myWebRTC_Event.createRemoteStreamAddedEvent(this.callType,this.callId,Rt.streams[0],this.remoteId,this.destCallType,nt,vt)}}else Gt.debug("onRemoteTrackAdded: ignoring event; event data are not correct")},this.onRemoteStreamRemoved=function(Rt){var nt=null;for(Gt.info("onRemoteStreamRemoved",Rt),nt=this.remoteMediaStreams.length;--nt>=0;)if(this.remoteMediaStreams[nt].id===Rt.stream.id){Gt.debug("onRemoteStreamRemoved removing",Rt.stream.id),this.remoteMediaStreams.splice(nt,1);break}qt.myWebRTC_Event.createRemoteStreamRemovedEvent(this.callType,this.callId,Rt.stream,this.remoteId,this.destCallType),Rt=null},this.onNegotiationNeeded=function(Rt){Gt.debug("onNegotiationNeeded",Rt),Rt=null,this.addingDataChannelOnCallOngoing&&(this.updateMediaWithRetryManagement(!1),this.addingDataChannelOnCallOngoing=!1)},this.onSignalingStateChange=function(Rt){Gt.debug("onSignalingStateChange",Rt),Rt=null},this.onCallDisconnection=function(){Gt.info("onCallDisconnection; callId: "+this.callId);var Rt=new Date;Gt.debug("date:",Rt),this.disconnectionWarningInterval!==0&&(Gt.debug("date:",Rt),Gt.debug("clearing disconnectionWarningInterval"),clearInterval(this.disconnectionWarningInterval),this.disconnectionWarningInterval=0),this.disconnectionWarningTimeout!==0&&(Gt.debug("date:",Rt),Gt.debug("clearing disconnectionWarningTimeout"),clearTimeout(this.disconnectionWarningTimeout),this.disconnectionWarningTimeout=0),this.belongsToRoom()?qt.onHangup(this.callId,"disconnected"):qt.onHangup(this.callId,"Ice_disconnected")},this.sendDisconnectionWarning=function(){Gt.log("sendDisconnectionWarning()");var Rt=null,nt=null;if(this.callControl&&(Rt=this.callControl.roomName,nt=this.callControl.type),this.disconnectionWarningCount++,fn.createEvent({eventType:"disconnectionWarning",callId:this.callId,remoteId:this.remoteId,tries:this.disconnectionWarningCount,roomName:Rt,settingUpType:nt}),(this.disconnectionWarningCount-1)*this.disconnectionWarningDelay>=this.disconnectionTimer&&this.disconnectionWarningInterval!==0){var vt=Date();Gt.debug("date :"+vt),Gt.debug("clearing disconnectionWarningInterval : no more warnings"),clearInterval(this.disconnectionWarningInterval),this.disconnectionWarningInterval=0}},this.createIceErrorDescriptor=function(Rt,nt){var vt={};return Rt==="disconnected"?vt.iceState="disconnected":Rt==="failed"?(vt.iceState="failed",nt===!0&&(vt.previousIceState="disconnected")):vt.iceState="unknown",vt.callType=this.callType,this.belongsToRoom()?(vt.context="conf",this.data.mesh?(vt.mode="mesh",(this.data.mesh.callerCompositeUserId?this.data.mesh.callerCompositeUserId===qt.compositeClientId:this.data.mesh.callerId===qt.clientId)?(vt.type="subscribe",vt.clientId=this.data.mesh.callerId,vt.remoteId=this.data.mesh.calleeId):(this.data.mesh.calleeCompositeUserId?this.data.mesh.calleeCompositeUserId===qt.compositeClientId:this.data.mesh.calleeId===qt.clientId)?(vt.type="publish",vt.clientId=this.data.mesh.calleeId,vt.remoteId=this.data.mesh.callerId):vt.type="unknown",vt.mesh=this.data.mesh):(vt.mode="sfu",this.settingUpType==="publish"||this.settingUpType==="shareScreen"?vt.type="publish":this.settingUpType==="subscribe"?vt.type="subscribe":vt.type="unknown",this.callee?(vt.clientId=this.calleeId,vt.remoteId=this.callerId):(vt.clientId=this.callerId,vt.remoteId=this.calleeId)),this.mcuRemoteStream&&(vt.stream=this.mcuRemoteStream)):(vt.context="call",vt.mode="p2p",this.callerId===qt.clientId?(vt.clientId=this.callerId,vt.remoteId=this.calleeId):this.calleeId===qt.clientId&&(vt.clientId=this.calleeId,vt.remoteId=this.callerId)),vt},this.onIceConnectionStateChange=function(Rt){Gt.debug("onIceConnectionStateChange: ",Rt),Rt=null;var nt=0,vt=null,Tt=null,Pt=null;this.pc!==null?(Gt.info("Ice Connection State is now : "+this.pc.iceConnectionState),this.iceState=this.pc.iceConnectionState,this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed"||this.pc.iceConnectionState==="checking"?(Gt.debug("iceConnectionState === connected or completed or checking"),Gt.debug("this.disconnectionTimeoutId :"+this.disconnectionTimeoutId),this.disconnectionTimeoutId!==0&&(nt=Date(),Gt.debug("date:",nt),Gt.debug("clearing disconnectionTimeout"),clearTimeout(this.disconnectionTimeoutId),this.disconnectionTimeoutId=0),this.disconnectionWarningInterval!==0&&(nt=Date(),Gt.debug("date:",nt),Gt.debug("clearing disconnectionWarningInterval"),clearInterval(this.disconnectionWarningInterval),this.disconnectionWarningInterval=0),this.pc.iceConnectionState!=="checking"&&(this.checkCandidateTypesTimeoutId=setTimeout(this.callback(this,"checkCandidateTypes"),this.checkCandidateTypesTimer),this.checkCandidateTypesTimeoutTable.push(this.checkCandidateTypesTimeoutId))):this.pc.iceConnectionState==="disconnected"?(this.callControl&&(vt=this.callControl.roomName,Tt=this.callControl.type),(Pt=this.createIceErrorDescriptor("disconnected")).context==="conf"&&this.myWebRTC_Stack.sendInfo("iceError",{clientId:qt.clientId,callId:this.callId,roomId:this.sessionMCU.roomName,pubSub:qt.MCUClient.pubConnector,descriptor:Pt}),Gt.warn("disconnection detected"),fn.createErrorEvent("iceDisconnection detected","ICE_CONNECTION_STATE_DISCONNECTED",this.callId,vt,Tt,Pt),nt=new Date,Gt.debug("date:",nt),this.disconnectionTimeoutId=setTimeout(this.callback(this,"onCallDisconnection"),this.disconnectionTimer),this.disconnectionWarningCount=0,this.disconnectionWarningTimeout=setTimeout(this.callback(this,"sendDisconnectionWarning"),2e3),this.disconnectionWarningInterval=setInterval(this.callback(this,"sendDisconnectionWarning"),this.disconnectionWarningDelay)):this.pc.iceConnectionState==="failed"&&(this.callControl&&(vt=this.callControl.roomName,Tt=this.callControl.type),(Pt=this.createIceErrorDescriptor("failed",this.disconnectionTimeoutId!==0)).context==="conf"&&this.myWebRTC_Stack.sendInfo("iceError",{clientId:qt.clientId,callId:this.callId,roomId:this.sessionMCU.roomName,pubSub:qt.MCUClient.pubConnector,descriptor:Pt}),Gt.warn("iceConnection failed detected"),fn.createErrorEvent("iceConnection failed detected","ICE_CONNECTION_STATE_FAILED",this.callId,vt,Tt,Pt),this.disconnectionTimeoutId!==0?this.belongsToRoom()&&(clearTimeout(this.disconnectionTimeoutId),this.disconnectionTimeoutId=0,qt.onHangup(this.callId,"disconnected")):this.belongsToRoom()&&(0,ct.ki)(this.callControl,["autoRestart","counter"],"number")&&this.callControl.autoRestart.counter>0?qt.onHangup(this.callId,"disconnected"):(Gt.warn("Removing call with callId: "+this.callId),qt.removeCallFromTableWithCallIdAndSendBye(this.callId,"Ice_failed")))):Gt.log("Ice Connection State change with pc is null")},this.callback=function(Rt,nt){return this.closureHandler=function(vt,Tt){return Rt[nt](vt,Tt)},this.closureHandler},this.onSelectedCandidate=function(Rt){if(this.selectedCandidate===void 0||this.selectedCandidate===null||this.selectedCandidate.LocalCandidateType!==Rt.LocalCandidateType||this.selectedCandidate.RemoteCandidateType!==Rt.RemoteCandidateType||this.selectedCandidate.LocalAddress!==Rt.LocalAddress||this.selectedCandidate.RemoteAddress!==Rt.RemoteAddress||this.selectedCandidate.TransportType!==Rt.TransportType||this.selectedCandidate.LocalTransportType!==Rt.LocalTransportType){Gt.debug("WebRTC_Call::onSelectedCandidate() :",Rt),this.selectedCandidate=Rt,this.callControl&&this.callControl.autoRestart&&(Gt.debug("selectedCandidate, this.callControl.autoRestart.counter:",this.callControl.autoRestart.counter),Gt.debug("selectedCandidate, this.callControl.autoRestart.callIdWhenStartingTimer:",this.callControl.autoRestart.callIdWhenStartingTimer),this.callControl.autoRestart.counter&&(Gt.debug("Reinit of autoRestart.counter"),this.callControl.autoRestart.counter=0,this.callControl.autoRestart.callIdWhenStartingTimer!==void 0&&qt.stopMaxCallRetriesTimer(this.callControl.autoRestart.callIdWhenStartingTimer))),this.myWebRTC_Event.createSelectedICECandidateEvent(this.callId,Rt.LocalCandidateType,Rt.RemoteCandidateType,Rt.LocalAddress,Rt.RemoteAddress,Rt.TransportType,Rt.LocalTransportType);var nt=Rt;nt.callId=this.callId,nt.clientId=qt.clientId,nt.roomId=this.dest_roomId,this.data.pubSub!==void 0&&(nt.pubSub=this.data.pubSub),this.data.confId!==void 0&&(nt.confId=this.data.confId),this.data.mesh!==void 0&&(nt.mesh=this.data.mesh),this.data.instanceId!==void 0&&(nt.instanceId=this.data.instanceId),this.myWebRTC_Stack.sendInfo("callSelectedCandidate",nt)}else Gt.debug("filtering duplicate candidate")},this.checkCandidateTypes=function(){Gt.debug("WebRTC_Call::checkCandidatesTypes()");var Rt=this,nt={LocalCandidateType:"unknow",RemoteCandidateType:"unknow",LocalAddress:"unknow",RemoteAddress:"unknow",TransportType:"unknow",LocalTransportType:"unknow",relayTransportType:"unknow"},vt=["googLocalAddress","googLocalCandidateType","googRemoteAddress","googRemoteCandidateType","googTransportType"];this.pc===null?(Gt.warn("Peer connection is null : no candidates"),Rt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Rt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Rt.onSelectedCandidate(nt)):typeof apiRTC_React<"u"?(Gt.warn("apiRTC_React : no info on candidates"),Rt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Rt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Rt.onSelectedCandidate(nt)):ct.wL.type==="chrome"&&ot.PR<=112?(Gt.debug("WebRTC_Call::checkCandidatesTypes() chrome <= 112"),this.pc.getStats(function(Tt){var Pt=Tt.result().filter(function(wt){return wt.id.indexOf("Conn-")===0&&wt.stat("googActiveConnection")==="true"})[0];Pt?(vt.forEach(function(wt){nt[wt.replace("goog","")]=Pt.stat(wt)}),Rt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Rt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Rt.onSelectedCandidate(nt)):(Rt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Rt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Rt.onSelectedCandidate(nt))})):ct.wL.type==="chrome"||ct.wL.type==="firefox"||ct.wL.type==="safari"?(Gt.debug("WebRTC_Call::checkCandidatesTypes()"),this.pc.getStats(null).then(function(Tt){var Pt=null;if(Tt.forEach(function(Et){Et.selected===!0&&ct.wL.type==="firefox"?(Pt!==null&&Gt.warn("multiple selected candidate-pairs"),Pt=Et):Et.nominated===!0&&(Pt=Et)}),Pt!==null){var wt=Tt.get(Pt.localCandidateId),Dt=Tt.get(Pt.remoteCandidateId);nt.LocalCandidateType=wt.candidateType,nt.RemoteCandidateType=Dt.candidateType,wt.address&&wt.port?nt.LocalAddress=wt.address+":"+wt.port:wt.ipAddress&&wt.portNumber&&(nt.LocalAddress=wt.ipAddress+":"+wt.portNumber),Dt.address&&Dt.port?nt.RemoteAddress=Dt.address+":"+Dt.port:Dt.ipAddress&&Dt.portNumber&&(nt.RemoteAddress=Dt.ipAddress+":"+Dt.portNumber),nt.TransportType=wt.protocol,wt.candidateType==="relay"&&wt.relayProtocol!==void 0&&(nt.relayTransportType=wt.relayProtocol),Rt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Rt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Rt.onSelectedCandidate(nt)}}).catch(function(Tt){Gt.warn("failed to get stats",Tt)})):(Gt.debug("checkCandidateTypes not Chrome or Firefox"),Rt.myWebRTC_Event.createICECandidateTypeUpdateEvent(Rt.callId,nt.LocalCandidateType,nt.RemoteCandidateType),Rt.onSelectedCandidate(nt))},this.belongsToRoom=function(){return!!(0,ct.ki)(this.sessionMCU,"roomName","string")&&((0,ct.ki)(this.data,"MCUType","string")&&(this.data.MCUType==="MCU-Caller"||this.data.MCUType==="MCU-Callee")&&(0,ct.ki)(this.data,"confId","string")?this.data.confId===this.sessionMCU.roomName:this.dest_roomId===this.sessionMCU.roomName)},this.setLocalCallProfile=function(Rt){var nt=arguments.length>1&&arguments[1]!==void 0&&arguments[1],vt=[],Tt={},Pt={},wt=null,Dt=null,Et="adaptation";this.dataCall!==!0&&this.settingUpType!=="subscribe"&&(this.localCallProfile.audioActive!==Rt.audioActive&&vt.push("audioIsActive"),this.localCallProfile.videoActive!==Rt.videoActive&&vt.push("videoIsActive"),this.localCallProfile=Rt,this.screenSharing===!0?this.localCallProfile.audioActive===!0&&this.localCallProfile.videoActive===!0?this.callType!=="screenSharingWithAudio"&&(this.callType="screenSharingWithAudio",vt.push("callType")):this.localCallProfile.audioActive===!0?this.callType!=="audio"&&(this.callType="audio",vt.push("callType")):this.localCallProfile.videoActive===!0?this.callType!=="screenSharing"&&(this.callType="screenSharing",vt.push("callType")):this.callType!=="inactive"&&(this.callType="inactive",vt.push("callType")):this.localCallProfile.audioActive===!0&&this.localCallProfile.videoActive===!0?this.callType!=="media"&&(this.callType="media",vt.push("callType")):this.localCallProfile.audioActive===!0?this.callType!=="audio"&&(this.callType="audio",vt.push("callType")):this.localCallProfile.videoActive===!0?this.callType!=="videoOnly"&&(this.callType="videoOnly",vt.push("callType")):this.callType!=="inactive"&&(this.callType="inactive",vt.push("callType")),nt===!0&&vt.length>0&&(Tt.available=this.localCallProfile.audio,Tt.active=this.localCallProfile.audioActive,Tt.muted=this.isLocalAudioMuted,Tt.silent=this.isRemoteAudioSilent,Pt.available=this.localCallProfile.video,Pt.active=this.localCallProfile.videoActive,Pt.muted=this.isLocalVideoMuted,Pt.silent=this.isRemoteVideoSilent,this.callConfiguration&&this.callConfiguration.userMediaStreamId&&(wt=this.callConfiguration.userMediaStreamId,(Dt=apiCC.getUserMediaStream(wt))&&(Tt.deviceLabel=Dt.audioDeviceLabel,Pt.deviceLabel=Dt.videoDeviceLabel)),this.updateCause&&(Et=this.updateCause),this.myWebRTC_Event.createLocalStreamUpdatedEvent(vt,Tt,Pt,!0,this.callType,this.callId,this.callLocalStream,wt,Et)))},this.setRemoteCallProfile=function(Rt){var nt=arguments.length>1&&arguments[1]!==void 0&&arguments[1],vt=[],Tt={},Pt={},wt="adaptation";this.dataCall!==!0&&(this.remoteCallProfile.audioActive!==Rt.audioActive&&vt.push("audioIsActive"),this.remoteCallProfile.videoActive!==Rt.videoActive&&vt.push("videoIsActive"),this.remoteCallProfile=Rt,this.settingUpType==="subscribe"?(this.screenSharing===!0?this.remoteCallProfile.audioActive===!0&&this.remoteCallProfile.videoActive===!0?this.callType!=="screenSharingWithAudio"&&(this.callType="screenSharingWithAudio",vt.push("callType")):this.remoteCallProfile.audioActive===!0?this.callType!=="audio"&&(this.callType="audio",vt.push("callType")):this.remoteCallProfile.videoActive===!0?this.callType!=="screenSharing"&&(this.callType="screenSharing",vt.push("callType")):this.callType!=="inactive"&&(this.callType="inactive",vt.push("callType")):this.remoteCallProfile.audioActive===!0&&this.remoteCallProfile.videoActive===!0?this.callType!=="media"&&(this.callType="media",vt.push("callType")):this.remoteCallProfile.audioActive===!0?this.callType!=="audio"&&(this.callType="audio",vt.push("callType")):this.remoteCallProfile.videoActive===!0?this.callType!=="videoOnly"&&(this.callType="videoOnly",vt.push("callType")):this.callType!=="inactive"&&(this.callType="inactive",vt.push("callType")),nt===!0&&vt.length>0&&(Tt.available=this.remoteCallProfile.audio,Tt.active=this.remoteCallProfile.audioActive,Tt.muted=this.isRemoteAudioMuted,Tt.silent=this.isRemoteAudioSilent,Pt.available=this.remoteCallProfile.video,Pt.active=this.remoteCallProfile.videoActive,Pt.muted=this.isRemoteVideoMuted,Pt.silent=this.isRemoteVideoSilent,this.updateCause&&(wt=this.updateCause),this.myWebRTC_Event.createRemoteStreamUpdatedEvent(vt,Tt,Pt,this.callType,this.callId,wt))):(this.screenSharing===!0?this.remoteCallProfile.audioActive===!0&&this.remoteCallProfile.videoActive===!0?this.destCallType!=="screenSharingWithAudio"&&(this.destCallType="screenSharingWithAudio",vt.push("callType")):this.remoteCallProfile.audioActive===!0?this.destCallType!=="audio"&&(this.destCallType="audio",vt.push("callType")):this.remoteCallProfile.videoActive===!0?this.destCallType!=="screenSharing"&&(this.destCallType="screenSharing",vt.push("callType")):this.destCallType!=="inactive"&&(this.destCallType="inactive",vt.push("callType")):this.settingUpType!=="publish"&&this.settingUpType!=="shareScreen"||(this.remoteCallProfile.audioActive===!0&&this.remoteCallProfile.videoActive===!0?this.destCallType!=="media"&&(this.destCallType="media",vt.push("callType")):this.remoteCallProfile.audioActive===!0?this.destCallType!=="audio"&&(this.destCallType="audio",vt.push("callType")):this.remoteCallProfile.videoActive===!0?this.destCallType!=="videoOnly"&&(this.destCallType="videoOnly",vt.push("callType")):this.destCallType!=="inactive"&&(this.destCallType="inactive",vt.push("callType"))),nt===!0&&vt.length>0&&(Tt.available=this.remoteCallProfile.audio,Tt.active=this.remoteCallProfile.audioActive,Tt.muted=this.isRemoteAudioMuted,Tt.silent=this.isRemoteAudioSilent,Pt.available=this.remoteCallProfile.video,Pt.active=this.remoteCallProfile.videoActive,Pt.muted=this.isRemoteVideoMuted,Pt.silent=this.isRemoteVideoSilent,this.updateCause&&(wt=this.updateCause),this.myWebRTC_Event.createRemoteStreamUpdatedEvent(vt,Tt,Pt,this.destCallType,this.callId,wt))))},this.setMediaConstraintsToSendOnlyOffer=function(){ct.wL.type==="firefox"?ot.PR>43?this.mediaConstraints={offerToReceiveAudio:!1,offerToReceiveVideo:!1}:this.mediaConstraints={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}}:ct.wL.type==="edge"?this.mediaConstraints={offerToReceiveAudio:0,offerToReceiveVideo:0}:ct.wL.type==="chrome"&&ct.wL.version<55?this.mediaConstraints={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}}:this.mediaConstraints={offerToReceiveAudio:!1,offerToReceiveVideo:!1,mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},this.mediaConstraintsAudioOnly=this.mediaConstraints},this.applyOutgoingBitrate=function(Rt){var nt=this;Gt.debug("applyOutgoingBitrate",this.callId,Rt);for(var vt=null,Tt=0;Tt<this.rtpSenders.video.length;Tt+=1)if(this.rtpSenders.video[Tt].track){vt=this.rtpSenders.video[Tt];break}if(vt)if(typeof vt.getParameters=="function"&&typeof vt.setParameters=="function"){var Pt=vt.getParameters();if(Object.prototype.hasOwnProperty.call(Pt,"encodings")){if(Pt.encodings.length!==1)return void Gt.debug("encodings cannot be changed",this.callId,Pt.encodings.length)}else Pt.encodings=[{}];if(Rt!==null&&typeof Rt=="number"){Rt<50&&(Rt=50);var wt=1e3*Rt;if(Pt.encodings[0].maxBitrate===wt)return;Pt.encodings[0].maxBitrate=wt}else{if(!Object.prototype.hasOwnProperty.call(Pt.encodings[0],"maxBitrate"))return;delete Pt.encodings[0].maxBitrate}vt.setParameters(Pt).catch(function(Dt){Gt.error("applyOutgoingBitrate - setParameters",nt.callId,Dt)})}else Gt.warn("no such functions: getParameters/setParameters",this.callId);else Gt.warn("no such video rtpSender",this.callId)},this.configureSimulcastEncodings=function(Rt){var nt=this,vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Gt.debug("configureSimulcastEncodings",this.callId,Rt,vt.maxBitrate),this.simulcast==="RID"){for(var Tt=null,Pt=0;Pt<this.rtpSenders.video.length;Pt+=1)if(this.rtpSenders.video[Pt].track){Tt=this.rtpSenders.video[Pt];break}if(Tt)if(typeof Tt.getParameters=="function"&&typeof Tt.setParameters=="function"){var wt=Tt.getParameters();if(Object.prototype.hasOwnProperty.call(wt,"encodings"))if(wt.encodings.length===3){for(var Dt=null,Et=null,jt=null,Yt=wt.encodings.length;--Yt>=0;){var en=wt.encodings[Yt];Dt||en.rid!=="h"?Et||en.rid!=="m"?jt||en.rid!=="l"||(jt=en):Et=en:Dt=en}if(Dt&&Object.prototype.hasOwnProperty.call(Dt,"maxBitrate")&&Et&&Object.prototype.hasOwnProperty.call(Et,"maxBitrate")&&jt&&Object.prototype.hasOwnProperty.call(jt,"maxBitrate")){var Kt=!1,rn=Math.floor(jt.maxBitrate/1e3),hn=!1,an=!1;if(Dt.active&&Dt.maxBitrate>1&&(rn+=Math.floor(Dt.maxBitrate/1e3),hn=!0),Et.active&&Et.maxBitrate>1&&(rn+=Math.floor(Et.maxBitrate/1e3),an=!0),Gt.debug("currentStatus",rn,hn,an),Rt==="changeMaxBitrate"){if(!(0,ct.ki)(vt,"maxBitrate","number"))return;var un=vt.maxBitrate;rn<=un?(an||rn+this.callConfiguration.simulcast.encodings.medium.maxBitrate<=un&&(ct.wL.type==="chrome"?Et.active=!0:ct.wL.type==="firefox"&&(Et.maxBitrate=1e3*this.callConfiguration.simulcast.encodings.medium.maxBitrate),this.callConfiguration.simulcast.encodings.medium.active=!0,an=!0,rn+=this.callConfiguration.simulcast.encodings.medium.maxBitrate,Kt=!0),hn||rn+this.callConfiguration.simulcast.encodings.high.maxBitrate<=un&&(ct.wL.type==="chrome"?Dt.active=!0:ct.wL.type==="firefox"&&(Dt.maxBitrate=1e3*this.callConfiguration.simulcast.encodings.high.maxBitrate),this.callConfiguration.simulcast.encodings.high.active=!0,hn=!0,rn+=this.callConfiguration.simulcast.encodings.high.maxBitrate,Kt=!0)):(hn&&(hn=!1,this.callConfiguration.simulcast.encodings.high.active=!1,rn-=Math.floor(Dt.maxBitrate/1e3),ct.wL.type==="chrome"?Dt.active=!1:ct.wL.type==="firefox"&&(Dt.maxBitrate=1),Kt=!0),rn>un&&an&&(an=!1,this.callConfiguration.simulcast.encodings.medium.active=!1,rn-=Math.floor(Et.maxBitrate/1e3),ct.wL.type==="chrome"?Et.active=!1:ct.wL.type==="firefox"&&(Et.maxBitrate=1),Kt=!0))}else Rt==="disableEncoding"&&(hn?(hn=!1,this.callConfiguration.simulcast.encodings.high.active=!1,rn-=Math.floor(Dt.maxBitrate/1e3),ct.wL.type==="chrome"?Dt.active=!1:ct.wL.type==="firefox"&&(Dt.maxBitrate=1),Kt=!0):an&&(an=!1,this.callConfiguration.simulcast.encodings.medium.active=!1,rn-=Math.floor(Et.maxBitrate/1e3),ct.wL.type==="chrome"?Et.active=!1:ct.wL.type==="firefox"&&(Et.maxBitrate=1),Kt=!0));Gt.debug("applyChanges",rn,hn,an,Kt),Kt&&(Tt.setParameters(wt).catch(function(Sn){Gt.error("configureEncodings - setParameters",nt.callId,Sn)}),this.myWebRTC_Stack.sendInfo("configureEncodings",{pubSub:qt.MCUClient.pubConnector,clientId:qt.clientId,roomId:this.sessionMCU.roomName,callId:this.callId,instanceId:this.instanceId,hint:"simulcast",encodings:this.callConfiguration.simulcast.encodings}))}else Gt.warn("cannot find h/m/l encodings",this.callId)}else Gt.warn("wrong encodings",this.callId,wt.encodings.length);else Gt.warn("no encodings configured",this.callId)}else Gt.warn("no such functions: getParameters/setParameters",this.callId);else Gt.warn("no such video rtpSender",this.callId)}}},Tn=(s(4363),s(9653),function(qt){this.disconnectionTimer=15e3,Number.MAX_SAFE_INTEGER!==void 0?this.userMediaId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString():this.userMediaId=Math.floor(1000001*Math.random()).toString(),this.callType="media",this.audio=!1,this.video=!1,this.audioSdpDirection=null,this.videoSdpDirection=null,this.callConfiguration={},this.sessionMCU=null,this.myWebRTC_Stack=new yt.S(qt.socket),this.getUserMediaStream=function(){return this.callConfiguration&&this.callConfiguration.userMediaStreamId?apiCC.getUserMediaStream(this.callConfiguration.userMediaStreamId):null},this.releaseUserMediaStream=function(){if(this.callConfiguration&&this.callConfiguration.userMediaStreamId){var Rt=this.callConfiguration.userMediaStreamId;return delete this.callConfiguration.userMediaStreamId,apiCC.releaseUserMediaStream(Rt,this.userMediaId)}return!1},this.close=function(){(this.addAck||this.addTimeoutId)&&(delete this.addAck,clearTimeout(this.addTimeoutId),delete this.addTimeoutId)}});function dn(qt){return dn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Rt){return typeof Rt}:function(Rt){return Rt&&typeof Symbol=="function"&&Rt.constructor===Symbol&&Rt!==Symbol.prototype?"symbol":typeof Rt},dn(qt)}function mn(qt,Rt){var nt=typeof Symbol<"u"&&qt[Symbol.iterator]||qt["@@iterator"];if(!nt){if(Array.isArray(qt)||(nt=function(Et,jt){if(Et){if(typeof Et=="string")return yn(Et,jt);var Yt=Object.prototype.toString.call(Et).slice(8,-1);return Yt==="Object"&&Et.constructor&&(Yt=Et.constructor.name),Yt==="Map"||Yt==="Set"?Array.from(Et):Yt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Yt)?yn(Et,jt):void 0}}(qt))||Rt&&qt&&typeof qt.length=="number"){nt&&(qt=nt);var vt=0,Tt=function(){};return{s:Tt,n:function(){return vt>=qt.length?{done:!0}:{done:!1,value:qt[vt++]}},e:function(Et){throw Et},f:Tt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Pt,wt=!0,Dt=!1;return{s:function(){nt=nt.call(qt)},n:function(){var Et=nt.next();return wt=Et.done,Et},e:function(Et){Dt=!0,Pt=Et},f:function(){try{wt||nt.return==null||nt.return()}finally{if(Dt)throw Pt}}}}function yn(qt,Rt){(Rt==null||Rt>qt.length)&&(Rt=qt.length);for(var nt=0,vt=new Array(Rt);nt<Rt;nt++)vt[nt]=qt[nt];return vt}var pn=tt.Y.get("ApiCCMCUClient"),In=apiCC.myWebRTC_Event,On=3e4,_n=function(qt,Rt){pn.debug("ApiCCMCUClient creation"),this.pubConnector="janusConnector",this.meshModeEnabled=!1,this.sessionMCUs=[],this.distantCalls=[],this.streamList=[],this.disputableStreamList=[],this.publishCallId=null,this.joinSessionReqs=[],this.transitionCount=0,this.browserCapabilities={updateStream:!0,mesh2janusTransition:!0,checkCallStatus:!0},this.receiveSessionId=function(nt){pn.debug("receiveSessionId()"),In.createMCUSessionCreationEvent(nt.sessionId,nt.token),this.publish(nt.sessionId,nt.token)},this.sendSessionInvitation=function(nt,vt,Tt){var Pt,wt;pn.debug("sendSessionInvitation()"),vt!=null?(Tt===void 0&&(Tt=0),Pt={type:"MCUSessionInvitation",srcId:Rt,destId:nt,sessionId:vt,groupChatId:Tt},wt=JSON.stringify(Pt),pn.log("C->S: "+wt),apiCC.session.channel.socket.emit("MCUSessionInvitation",wt)):pn.log("Session is null or undefined, MCU Session invitation is not sended")},this.sendSessionInvitationToGroupChat=function(nt,vt){if(pn.debug("sendSessionInvitationToGroupChat()"),nt!=null)if(vt!=null){var Tt,Pt;Tt={type:"MCUSessionInvitationToGroupChat",srcId:Rt,groupChatId:nt,sessionId:vt},Pt=JSON.stringify(Tt),pn.log("C->S: "+Pt),apiCC.session.channel.socket.emit("MCUSessionInvitationToGroupChat",Pt)}else pn.log("Session is null or undefined, MCU Session invitation is not sended");else pn.log("groupChatId is null or undefined, MCU Session invitation is not sended")},this.receiveSessionInvitation=function(nt){pn.debug("receiveSessionInvitation()"),pn.log("msg.sessionId :"+nt.sessionId),pn.log("msg.token :"+nt.token),pn.log("msg.groupChatId :"+nt.groupChatId),In.createReceiveMCUSessionInvitationEvent(nt.sessionId,nt.token,nt.groupChatId,nt.srcId)},this.acceptSessionInvitation=function(nt,vt){pn.debug("acceptSessionInvitation()"),pn.log("sessionId :"+nt),pn.log("token :"+vt),this.publish(nt,vt)},this.leaveSession=function(nt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};pn.info("leaveSession()");var Tt=null,Pt=null,wt=null;if(!(wt=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0})))return new Error("leaveSession: session not set");vt.noHangup!==!0&&(apiCC.session.apiCCWebRTCClient.webRTCClient.removeAllCallsFromRoom(wt.roomName,"leaveSession"),this.meshOnHangup(null,null,{roomId:wt.roomName}));var Dt=[],Et={};Dt.push(wt.roomName),Et.doneByApiRTC=!0,apiCC.session.leavePresenceGroup(Dt,Et),apiCC.session.unsubscribePresenceGroup(Dt,Et),Tt={type:"leaveSession",roomId:wt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector}},Pt=JSON.stringify(Tt),pn.log("C->S: "+Pt),apiCC.session.channel.socket.emit("leaveSession",Pt),pn.debug("leaveSession: distant call clean up");for(var jt=this.distantCalls.length;--jt>=0;)this.distantCalls[jt].roomId===wt.roomName&&(pn.debug("leaveSession: remove distant call descriptor",this.distantCalls[jt]),this.distantCalls.splice(jt,1));apiCC.session.apiCCWebRTCClient.webRTCClient.destroyCallControl({multi:!0,roomName:wt.roomName});for(var Yt=this.streamList.length;--Yt>=0;)this.streamList[Yt].roomId===wt.roomName&&this.streamList.splice(Yt,1);return this.removeSessionMCU(wt),"OK"},this.createJoinSessionMessage=function(nt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Tt=null;nt||(Tt=vt.hasOwnProperty("sessionMCU")?vt.sessionMCU:this.getSessionMCU(null,{first:!0}))&&(nt=Tt.roomName);var Pt=Tt&&Tt.roomMode==="mesh"||this.meshModeEnabled===!0||vt.meshModeEnabled===!0,wt=Tt&&Tt.meshOnly===!0||vt.meshOnlyEnabled===!0,Dt={type:"joinSession",roomId:nt,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector,meshModeEnabled:Pt,meshOnlyEnabled:wt,videoBandwidthSettings:apiCC.session.apiCCWebRTCClient.webRTCClient.videoBandwidthSettings,browserInfo:{browserAbout:ot.Xh+" "+ot.dc,browserType:ct.wL.type,browserVersion:ct.wL.version,osName:ot.BF,osVersion:ot.MM,deviceType:ot.vO}}};if(vt.hasOwnProperty("transactionId")&&(Dt.transactionId=vt.transactionId),vt.hasOwnProperty("convId")?Dt.data.convId=vt.convId:Tt&&Tt.hasOwnProperty("convId")&&(Dt.data.convId=Tt.convId),vt.moderationEnabled&&(Dt.data.moderationEnabled=!0),vt.moderator&&(Dt.data.moderator=!0),vt.qualityAdaptationEnabled&&(Dt.data.qualityAdaptationEnabled=!0),Array.isArray(vt.supportedVideoCodecs)){Dt.data.supportedVideoCodecs=[];var Et,jt=mn(vt.supportedVideoCodecs);try{for(jt.s();!(Et=jt.n()).done;){var Yt=Et.value;Yt==="h264"?Dt.data.supportedVideoCodecs.push({codec:"h264",profilelevelid:"42e01f"}):typeof Yt=="string"?Dt.data.supportedVideoCodecs.push({codec:Yt}):Dt.data.supportedVideoCodecs.push(Yt)}}catch(en){jt.e(en)}finally{jt.f()}}else ct.wL.type==="safari"&&(ot.Xh==="Safari"&&ot.dc<12.1||ot.Xh==="Mobile Safari"&&ot.dc<12.1)&&(Dt.data.supportedVideoCodecs=[{codec:"h264",profilelevelid:"42e01f"}]);return Dt.data.capabilities=this.browserCapabilities,Dt},this.createSessionDescriptor=function(nt){var vt={roomId:nt.roomName};return nt.convId&&(vt.convId=nt.convId),nt.roomMode&&(vt.roomMode=nt.roomMode),nt.modeChangeKind&&(vt.modeChangeKind=nt.modeChangeKind),vt},this.joinSession=function(nt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.getSessionMCU(nt))return pn.warn("joinSession: session already set"),new Error("joinSession: session already set");if(this.getJoinSessionReq(nt))return pn.warn("joinSession: session already requested"),new Error("joinSession: session already requested");var Tt={};Tt.roomId=nt,Tt.transactionId=apiCC.randomString(12),this.joinSessionReqs.push(Tt);var Pt=Object.assign({},vt);Pt.transactionId=Tt.transactionId,pn.info("joinSession() on ApiRTC MCU with roomId:",nt);var wt=this.createJoinSessionMessage(nt,Pt),Dt=JSON.stringify(wt);return pn.log("C->S: "+Dt),apiCC.session.channel.socket.emit("joinSession",Dt),"OK"},this.joinSessionAnswer=function(nt){if(pn.debug("joinSessionAnswer()"),this.getSessionMCU(nt.roomName))pn.warn("joinSessionAnswer: session already set");else{var vt=null;if(nt.hasOwnProperty("transactionId")&&(vt=this.getJoinSessionReq(null,{transactionId:nt.transactionId})),vt||(vt=this.getJoinSessionReq(nt.roomName)),vt){this.removeJoinSessionReq(vt);var Tt={};if(Tt.roomID=nt.sessionId,Tt.roomName=nt.roomName,nt.hasOwnProperty("convId")&&(Tt.convId=nt.convId),Tt.joinSessionAnswer={},(0,ct.ki)(nt,"data","object")?(nt.data.failed===!0?(Tt.joinSessionAnswer.failed=!0,Tt.joinSessionAnswer.reason=nt.data.reason):Tt.joinSessionAnswer.failed=!1,nt.data.mode&&typeof nt.data.mode=="string"&&(Tt.roomMode=nt.data.mode,pn.debug("session joined with mode; roomMode: "+Tt.roomMode)),Tt.roomMode==="mesh"&&nt.data.meshOnly===!0&&(Tt.meshOnly=!0,pn.debug("meshOnly"))):Tt.joinSessionAnswer.failed=!1,this.sessionMCUs.push(Tt),!Tt.joinSessionAnswer.failed){var Pt=[],wt={};Pt.push(nt.roomName),wt.doneByApiRTC=!0,apiCC.session.joinPresenceGroup(Pt,wt),apiCC.session.subscribePresenceGroup(Pt,wt)}In.createJoinMCUSessionAnswerEvent(nt.sessionId,nt.token,nt.groupChatId,nt.initiator,Tt)}else pn.debug("joinSessionAnswer: no joinSession requested")}},this.changeSessionMode=function(nt,vt){var Tt=this.getSessionMCU(nt.roomName);if(Tt)if(Tt.roomMode==="mesh"){for(var Pt=0,wt=qt.userMediaTable.length;--wt>=0;)if(qt.userMediaTable[wt].sessionMCU===Tt){pn.debug("changeSessionMode: userMedia",qt.userMediaTable[wt]),qt.userMediaTable[wt].distantCalls=[],Pt+=1;for(var Dt=this.distantCalls.length;--Dt>=0;)pn.debug("changeSessionMode: distantCall",this.distantCalls[Dt]),this.distantCalls[Dt].callMode==="mesh"&&this.distantCalls[Dt].callFeed.callId===qt.userMediaTable[wt].userMediaId&&(pn.debug("changeSessionMode: match"),qt.userMediaTable[wt].distantCalls.push(this.distantCalls[Dt]))}for(var Et=0,jt=qt.callControlTable.length;--jt>=0;)qt.callControlTable[jt].type==="subscribe"&&qt.callControlTable[jt].roomName===Tt.roomName&&(Et+=1,qt.callControlTable[jt].autoRestart.force=!0);if(In.createMCURoomModeChangedEvent(Tt.roomName,"mesh","sfu","ongoing"),Pt===0&&Et===0)delete Tt.roomMode,In.createMCURoomModeChangedEvent(Tt.roomName,"mesh","sfu","complete");else{Tt.modeChangeKind="old";var Yt={};Yt.roomID=nt.roomName,Yt.roomName=nt.roomName,nt.hasOwnProperty("convId")&&(Yt.convId=nt.convId),Yt.joinSessionAnswer={failed:!1},Yt.modeChangeKind="new",Yt.transitionTimeoutId=setTimeout((function(en,Kt){delete Kt.transitionTimeoutId,qt.finalizeMeshToJanusTransition(en,Kt,{force:!0})}).bind(this,Tt,Yt),3e4),this.sessionMCUs.push(Yt),this.transitionCount+=1}}else pn.warn("changeSessionMode: session not using mesh mode");else pn.warn("changeSessionMode: no session")},this.updateSessionAnswer=function(nt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};pn.debug("updateSessionAnswer");var Tt=this.getSessionMCU(nt.roomName);if(!Tt){if(!vt.createSession)return void pn.warn("updateSessionAnswer: no such session",nt.roomName);pn.debug("force session creation; roomName: "+nt.roomName),(Tt={}).roomID=nt.roomName,Tt.roomName=nt.roomName,nt.hasOwnProperty("convId")&&(Tt.convId=nt.convId),Tt.joinSessionAnswer={failed:!1},this.sessionMCUs.push(Tt);for(var Pt=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.length;--Pt>=0;){var wt=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[Pt];!wt.data||wt.data.MCUType!=="MCU-Caller"&&wt.data.MCUType!=="MCU-Callee"||wt.data.confId!==Tt.roomName||(wt.sessionMCU=Tt)}}var Dt=!1;if(nt.data&&nt.data.mode==="mesh"?(Tt.roomMode="mesh",nt.data.meshOnly===!0&&(Tt.meshOnly=!0)):(Tt.roomMode==="mesh"&&(Dt=!0),delete Tt.roomMode),Tt.modeChangeKind==="new"){pn.debug("transition already ongoing");var Et=this.getSessionMCU(null,{callback:function(un){return un.roomName===Tt.roomName&&un.modeChangeKind==="old"}});Et&&qt.finalizeMeshToJanusTransition(Et,Tt,{force:!0})}else if(Dt){pn.debug("transition NOT ongoing but should be"),In.createMCURoomModeChangedEvent(Tt.roomName,"mesh","sfu","ongoing"),Tt.modeChangeKind="old";var jt={};jt.roomID=Tt.roomID,jt.roomName=Tt.roomName,Tt.hasOwnProperty("convId")&&(jt.convId=Tt.convId),jt.joinSessionAnswer={failed:!1},jt.modeChangeKind="new",this.sessionMCUs.push(jt),this.transitionCount+=1,qt.finalizeMeshToJanusTransition(Tt,jt,{force:!0})}if(vt.updateCalls)if(pn.debug("update stream list (prune)"),this.updateStreamList(nt,{prune:!0}),Tt.roomMode==="mesh"){pn.debug("restart publish/shareScreen calls");for(var Yt=qt.userMediaTable.slice(),en=Yt.length;--en>=0;){var Kt=Yt[en];Kt.sessionMCU===Tt&&qt.onHangup(Kt.userMediaId,"disconnected")}}else{pn.debug("roomMode is SFU, checking calls");for(var rn=qt.callsTable.slice(),hn=rn.length;--hn>=0;){var an=rn[hn];an.sessionMCU===Tt&&(an.settingUpType!=="publish"&&an.settingUpType!=="shareScreen"||an.data&&an.data.mesh||an.pc?an.message200OKReceived===!1&&(pn.debug("restart call without 200OK received"),qt.onHangup(an.callId,"disconnected")):(pn.debug("restart publish/shareScreen calls with no PeerConnection"),qt.onHangup(an.callId,"disconnected")))}}},this.processCheckCallStatus=function(nt){this.updateStreamList(nt)},this.updateStreamList=function(nt){for(var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Tt=(0,ct.ki)(nt,"availableStreams","array")?nt.availableStreams.slice():null,Pt=(0,ct.ki)(nt,"availableComposite","array")?nt.availableComposite.slice():null,wt=(0,ct.ki)(nt,"availableReplay","array")?nt.availableReplay.slice():null,Dt=this.streamList.length;--Dt>=0;){var Et=this.streamList[Dt];if(Et.type==="regular"){if(!Tt)continue;for(var jt=Tt.length;--jt>=0&&Tt[jt].id!==Et.streamInfo.id;);if(jt>=0){(0,ct.ki)(Et,"clearDisputableEntry","function")&&Et.clearDisputableEntry(),Tt.splice(jt,1);continue}vt.prune===!0?((0,ct.ki)(Et,"clearDisputableEntry","function")&&Et.clearDisputableEntry(),apiCC.session.apiCCWebRTCClient.webRTCClient.destroyCallControl({type:"subscribe",stream:Et.streamInfo}),In.createMCURemovedStreamEvent(Et.streamInfo.id),this.streamList.splice(Dt,1)):Et.disputableTimeoutId||(Et.disputableTimeoutId=setTimeout(Mn.bind(this,Et.streamInfo.id),On),Et.clearDisputableEntry=Nn.bind(this,Et.streamInfo.id),this.disputableStreamList.push(Et))}else if(Et.type==="composite"){if(!Pt)continue;for(var Yt=Pt.length;--Yt>=0&&Pt[Yt].id!==Et.streamInfo.id;);if(Yt>=0){Pt.splice(Yt,1);continue}apiCC.session.apiCCWebRTCClient.webRTCClient.destroyCallControl({type:"subscribe",stream:Et.streamInfo}),In.createMCURemovedStreamEvent(Et.streamInfo.id),this.streamList.splice(Dt,1)}else if(Et.type==="replay"){if(!wt)continue;for(var en=wt.length;--en>=0&&wt[en].id!==Et.streamInfo.id;);en>=0&&wt.splice(en,1)}}if(Tt)for(var Kt=0;Kt<Tt.length;Kt+=1){var rn=[];rn.push(Tt[Kt]);var hn=this.newAvailableStream(rn,"regular");In.createMCUAvailableStreamEvent(rn,hn)}if(Pt)for(var an=0;an<Pt.length;an+=1){var un=[];un.push(Pt[an]);var Sn=this.newAvailableStream(un,"composite");In.createMCUAvailableCompositeEvent(un,Sn)}if(wt)for(var En=0;En<wt.length;En+=1){var An=[];An.push(wt[En]);var Dn=this.newAvailableReplay(An);In.createMCUAvailableReplayEvent(An,Dn)}},this.getStreamList=function(){return pn.debug("getStreamList :",this.streamList),this.streamList},this.getStreamFromList=function(nt){var vt;for(pn.debug("getStreamFromList() with Id :",nt),pn.log("this.streamList :",this.streamList),vt=0;vt<this.streamList.length;vt+=1){if(this.streamList[vt].streamInfo.id===nt)return pn.log("stream found",this.streamList[vt].streamInfo),this.streamList[vt].streamInfo;pn.log("not the same stream",nt)}return null},this.getStreamIdOfUser=function(nt){var vt;for(pn.debug("getStreamIdOfUser() with Id :",nt),pn.log("this.streamList :",this.streamList),vt=0;vt<this.streamList.length;vt+=1)if(this.streamList[vt].type!=="replay"){if(this.streamList[vt].userId===nt)return pn.log("stream found",this.streamList[vt].streamInfo),this.streamList[vt].streamInfo.id;pn.log("not the same userId",nt)}return null},this.getStreamOfUserCall=function(nt,vt){var Tt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Pt=this.streamList.length,wt=!1;for((0,ct.ki)(Tt,"replay","boolean")&&Tt.replay===!0&&(wt=!0);--Pt>=0;){if(wt===!0){if(this.streamList[Pt].type!=="replay")continue}else if(this.streamList[Pt].type==="replay")continue;if(this.streamList[Pt].userId===nt&&this.streamList[Pt].streamInfo.attributes.callId===vt)return this.streamList[Pt].streamInfo}return null},this.newAvailableStream=function(nt,vt,Tt){pn.debug("newAvailableStream():",nt);var Pt=!1,wt=!1,Dt=this.getSessionMCU(nt[0].room);if(Dt){nt[0].attributes.callerId!==Rt&&(Pt=!0);for(var Et=qt.getCallControls(["publish","shareScreen"],{addUserMedia:!0}),jt=0;jt<nt.length;jt+=1){for(var Yt=this.streamList.length;--Yt>=0&&(this.streamList[Yt].type!=="regular"||nt[jt].id!==this.streamList[Yt].streamInfo.id););Yt>=0?(wt=!0,(0,ct.ki)(this.streamList[Yt],"clearDisputableEntry","function")?this.streamList[Yt].clearDisputableEntry():pn.debug("clearDisputableEntry is not set")):pn.debug("streamList is empty"),Pt=!Object.prototype.hasOwnProperty.call(Et,nt[jt].attributes.callId);var en={type:vt,userId:nt[jt].attributes.callerId,roomId:Dt.roomName,isRemoteStream:Pt,streamInfo:nt[jt]};if(wt===!0?this.streamList[Yt]=en:this.streamList.push(en),pn.log("this.streamList :",this.streamList),Pt!==!0&&Dt.roomMode==="mesh"){var Kt=qt.findUserMediaById(nt[jt].attributes.callId);Kt&&Kt.addAck===!0&&(delete Kt.addAck,clearTimeout(Kt.addTimeoutId),delete Kt.addTimeoutId,In.createCallEstablishedEvent(Dt.roomName,Kt.callType,Kt.userMediaId,"none"))}var rn=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallControl({type:"subscribe",stream:nt[jt]});if(rn&&!rn.autoRestart.pending){pn.info("[newAvailableStream] auto subscribing to stream");var hn=!!rn.autoRestart.force;delete rn.autoRestart.force;var an=rn.callId,un=qt.findCallWithCallId(an);un!==null&&un.sessionMCU!==null&&un.sessionMCU.modeChangeKind==="old"&&(pn.debug("Re-init of autoRestart.counter"),delete rn.autoRestart.counter);var Sn=this.subscribeToStreams([nt[jt]],rn.mediaType,rn.data,rn.callConfiguration,{noStreamCheck:!0,force:hn});an&&Sn[0]&&In.createCallRestartingEvent(rn.callType,rn.audioOnly,an,Sn[0],"subscribe",apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,rn.roomName,rn.roomName,nt[jt].id)}if(wt!==!0&&(0,ct.Ym)(Tt,"function")&&Tt(Pt,nt[jt],vt),nt[jt].context!==void 0&&nt[jt].context.remoteAccessCtx!==void 0){var En=nt[jt].context.remoteAccessCtx.invitationId;pn.debug("remoteAccess stream for invitationId : ",En),apiRTC.session.remoteAccessInvitation!==null&&En===apiRTC.session.remoteAccessInvitation.id&&Pt===!0?(pn.debug("Setting screenSharingStreamId for remote"),apiRTC.session.remoteAccessInvitation.screenSharingStreamId=nt[jt].id,pn.debug("apiRTC.session.remoteAccessInvitation.screenSharingStreamId :",apiRTC.session.remoteAccessInvitation.screenSharingStreamId),apiRTC.session.remoteAccessInvitation.screenWidth=nt[jt].context.remoteAccessCtx.screenWidth,apiRTC.session.remoteAccessInvitation.screenHeight=nt[jt].context.remoteAccessCtx.screenHeight):pn.debug("Stream not linked to remoteAccessInvitation or this is localStream")}}return Pt}pn.debug("newAvailableStream() but client is not in session")},this.updateAvailableStream=function(nt,vt,Tt){pn.info("updateAvailableStream():",nt);var Pt=!1;if(this.getSessionMCU(nt[0].room)){nt[0].attributes.callerId!==Rt&&(Pt=!0);for(var wt=0;wt<nt.length;wt+=1)for(var Dt=this.streamList.length;--Dt>=0;)if(this.streamList[Dt].streamInfo.id===nt[wt].id){for(var Et=[],jt=0,Yt=["audio","audioMuted","video","videoMuted"];jt<Yt.length;jt++){var en=Yt[jt];this.streamList[Dt].streamInfo[en]!==nt[wt][en]&&(this.streamList[Dt].streamInfo[en]=nt[wt][en],Et.push(en))}this.streamList[Dt].streamInfo.attributes.callType!==nt[wt].attributes.callType&&(this.streamList[Dt].streamInfo.attributes.callType=nt[wt].attributes.callType,Et.push("callType")),this.streamList[Dt].streamInfo.attributes.descriptor&&nt[wt].attributes.descriptor&&this.streamList[Dt].streamInfo.attributes.descriptor.priority!==nt[wt].attributes.descriptor.priority&&(this.streamList[Dt].streamInfo.attributes.descriptor.priority=nt[wt].attributes.descriptor.priority,Et.push("priority")),Et.length>0&&(0,ct.Ym)(Tt,"function")&&Tt(Pt,nt[wt],vt,Et);break}return Pt}pn.log("updateAvailableStream() but client is not in session")},this.newAvailableReplay=function(nt){pn.info("newAvailableReplay() :",nt);var vt=!1,Tt=this.getSessionMCU(nt[0].room);if(Tt){nt[0].attributes.callerId!==Rt&&(vt=!0);for(var Pt=0;Pt<nt.length;Pt+=1){var wt={type:"replay",userId:nt[Pt].attributes.callerId,roomId:Tt.roomName,isRemoteStream:vt,streamInfo:nt[Pt]};this.streamList.push(wt)}return vt}pn.log("newAvailableReplay() but client is not in session")},this.subscribeToStreams=function(nt,vt,Tt,Pt){var wt=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};pn.info("subscribeToStreams():",nt);var Dt,Et,jt=[],Yt=null,en=null,Kt=null,rn=function(an){return setTimeout(function(){pn.warn("invite + SDP offer not received -> restart call"),qt.onHangup(an,"disconnected")},15e3)};for(Kt in nt){if(Dt=nt[Kt],apiCC.session===null||apiCC.session===void 0)return pn.debug("no session, leaving subscribeToStreams()"),jt;if((Yt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithStreamId(Dt.id,{ignoreModeChangeKindOld:!0}))!==null){if(pn.debug("call already exists"),wt.force!==!0){jt[Kt]=Yt.callId;continue}pn.debug("Force is true")}else pn.debug("call does not exist");for(Et=this.streamList.length;--Et>=0&&this.streamList[Et].streamInfo.id!==Dt.id;);if(Et>=0){if(pn.debug("stream exists"),this.streamList[Et].disputableTimeoutId){pn.debug("stream temporarily not available"),jt[Kt]=null,wt.autoSub===!0&&((en=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallControl({type:"subscribe",stream:Dt}))||apiCC.session.apiCCWebRTCClient.webRTCClient.createCallControl({type:"subscribe",roomName:Dt.room,mediaType:vt,callConfiguration:Pt,data:Tt,stream:Dt}));continue}}else if(pn.debug("stream does not exist"),wt.noStreamCheck!==!0){jt[Kt]=null,In.createErrorEvent("stream not available","STREAM_NOT_AVAILABLE",null,Dt.room,null,{stream:Dt});continue}pn.info("stream:",Dt);var hn=this.getSessionMCU(Dt.room);hn&&((en=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallControl({type:"subscribe",stream:Dt}))||(en=apiCC.session.apiCCWebRTCClient.webRTCClient.createCallControl({type:"subscribe",roomName:hn.roomName,mediaType:vt,callConfiguration:Pt,data:Tt,stream:Dt})),Dt.attributes.callType!=="COMPOSITE"&&this.pubConnector==="janusConnector"?(Tt===void 0&&(Tt={}),Tt.mesh&&delete Tt.mesh,(0,ct.Ym)(Pt,"qos","object")?(Tt.qos={},Pt.qos.videoForbidInactive===!1?Tt.qos.videoForbidInactive=!1:Tt.qos.videoForbidInactive=!0):(Tt.qos={},Tt.qos.videoForbidInactive=!0),(0,ct.Ym)(Pt,"simulcast","object")&&(Tt.simulcast={},Pt.simulcast.streamQuality&&(Pt.simulcast.streamQuality==="high"?Tt.simulcast.substream=2:Pt.simulcast.streamQuality==="medium"?Tt.simulcast.substream=1:Pt.simulcast.streamQuality==="low"&&(Tt.simulcast.substream=0)),Pt.simulcast.streamFrameRate&&(Pt.simulcast.streamFrameRate==="high"?Tt.simulcast.temporal=2:Pt.simulcast.streamFrameRate==="medium"?Tt.simulcast.temporal=1:Pt.simulcast.streamFrameRate==="low"&&(Tt.simulcast.temporal=0))),(Yt=new Cn(apiCC.session.apiCCWebRTCClient.webRTCClient)).instanceId=apiCC.generateInstanceId(),Yt.callControl=en,(0,ct.ki)(Yt.callControl.autoRestart,"counter","number")?(Yt.callControl.autoRestart.counter+=1,Yt.restarted=!0):Yt.callControl.autoRestart.counter=0,Yt.settingUpType="subscribe",Pt!=null&&Pt.turnServerAddress!==void 0&&Pt.turnServerAddress!==null&&Yt.setCallTurnServer(Pt.turnServerAddress),Yt.generateCallId(),en.callId=Yt.callId,Yt.setupTimeoutId=rn(Yt.callId),Yt.callerId=hn.roomName,Yt.calleeId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,Yt.callee=!0,Yt.mcuRemoteStream=Dt,Yt.dest_roomId=hn.roomName,Yt.callType=Dt.attributes.callType,Yt.callControl.callType=Dt.attributes.callType,Dt.attributes.callType!=="audio"&&vt!=="AUDIOONLY"||(Yt.audioOnly=!0,Yt.callControl.audioOnly=!0),Yt.remoteId=Dt.attributes.callerId,Yt.remoteMailAddress=Dt.attributes.mailAddress,Yt.streamId=Dt.id,Yt.mediaType=vt,Yt.sessionMCU=hn,pn.log("call.streamId: "+Yt.streamId),(0,ct.Ym)(Tt,"object")?Yt.data=(0,ct.ws)({},Tt):Yt.data={},Yt.data.pubSub="janusConnector",Yt.data.type="subscribe",Yt.data.mode="passive",Yt.data.mediaType=vt,Yt.data.capabilities=this.browserCapabilities,Yt.data.cloudConvId=hn.convId,Yt.data.instanceId=Yt.instanceId,apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.push(Yt),jt[Kt]=Yt.callId,Yt.myWebRTC_Stack.sendInvite(Yt.callId,apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,hn.roomName,hn.roomName,Dt.attributes.callType,{mode:"passive",data:Yt.data,stream:Dt,volatile:!!Yt.restarted})):((Yt=new Cn(apiCC.session.apiCCWebRTCClient.webRTCClient)).instanceId=apiCC.generateInstanceId(),Yt.callControl=en,(0,ct.ki)(Yt.callControl.autoRestart,"counter","number")?(Yt.callControl.autoRestart.counter+=1,Yt.restarted=!0):Yt.callControl.autoRestart.counter=0,Yt.settingUpType="subscribe",Pt!=null&&Pt.turnServerAddress!==void 0&&Pt.turnServerAddress!==null&&Yt.setCallTurnServer(Pt.turnServerAddress),Tt===void 0&&(Tt={}),Yt.data=Tt,Yt.data.pubSub=this.pubConnector,Yt.data.type="subscribe",Yt.data.capabilities=this.browserCapabilities,Yt.data.cloudConvId=hn.convId,Yt.data.instanceId=Yt.instanceId,pn.log("mediaType: ",vt),pn.log("stream.attributes.callType: ",Dt.attributes.callType),Yt.callType=Dt.attributes.callType,Yt.callControl.callType=Dt.attributes.callType,Dt.attributes.callType==="COMPOSITE"&&this.pubConnector==="janusConnector"||Dt.attributes.callType==="audio"||vt==="AUDIOONLY"?(pn.log("Setting call as audioOnly"),Yt.audioOnly=!0,Yt.callControl.audioOnly=!0,Yt.stripVideoSDPActivated=!0):vt==="VIDEOONLY"&&(Yt.stripAudioSDPActivated=!0,Yt.callType="videoOnly",Yt.callControl.callType="videoOnly"),Yt.mcuRemoteStream=Dt,Yt.dest_roomId=hn.roomName,Yt.calleeId=hn.roomName,Yt.generateCallId(),en.callId=Yt.callId,Yt.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,Yt.sessionMCU=hn,apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.push(Yt),Yt.createPeerConnection(),Yt.doCall(),Yt.started=!0,Yt.callType=Dt.attributes.callType,Yt.remoteId=Dt.attributes.callerId,Yt.remoteMailAddress=Dt.attributes.mailAddress,Dt.audio===!0?Dt.video===!0?Yt.destCallType="media":Yt.destCallType="audio":Dt.video===!0&&(Yt.destCallType="videoOnly"),Dt.id===void 0&&pn.log("stream.id is undefined :",Dt),Yt.streamId=Dt.id,Yt.mediaType=vt,pn.log("stream.attributes.callType: ",Dt.attributes.callType),jt[Kt]=Yt.callId),Yt.asyncCallbacks={},Yt.asyncCallbacks.type="subscribe")}return jt},this.unsubscribe=function(nt){pn.info("unsubscribe() :",nt);var vt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithStreamId(nt);vt===null?pn.log("error call not found on unsubscribe"):vt.callId!==void 0&&apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(vt.callId)},this.publish=function(nt,vt,Tt,Pt,wt,Dt){pn.info("publish roomName :",nt),pn.log("publish sessionId :",vt),pn.log("publish token :",Tt),pn.log("publish callConfiguration :",Pt);var Et=null,jt=!1,Yt=!1,en=null,Kt=null,rn=this.getSessionMCU(nt);if(!rn)return pn.error("roomName does not match any sessionMCU"),null;if(wt!==null&&dn(wt)==="object"||(wt={}),this.pubConnector==="janusConnector"&&!wt.mesh&&Dt&&Dt.callControl&&Dt.callControl.callId&&apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(Dt.callControl.callId))return pn.debug("call already exists",Dt.callControl.callId),Dt.callControl.callId;if(Pt===!0||Pt==="true"?(pn.log("DEPRECATED ... please use callConfiguration JSON parameter : callConfiguration.audioOnly instead of audioOnly"),jt=!0,Pt={}):Pt===!1||Pt==="false"?(pn.log("DEPRECATED ... please use callConfiguration JSON parameter : callConfiguration.audioOnly instead of audioOnly"),Pt={}):Pt!==null&&dn(Pt)==="object"||(Pt={}),Pt.audioOnly===!0&&Pt.videoOnly===!0)return In.createErrorEvent("Cannot publish without audio nor video","PUBLISH_FAILURE",null,nt),null;if(Pt.audioOnly===!0&&(jt=!0),Pt.videoOnly===!0&&(Yt=!0),["audioOnly","videoOnly","record","private"].forEach(function(an){Pt.hasOwnProperty(an)&&((0,ct.ki)(wt,"callConfiguration","object")||(wt.callConfiguration={}),wt.callConfiguration[an]=Pt[an])}),rn.convId&&(wt.cloudConvId=rn.convId),(0,ct.Ym)(Pt,"qos","object")?(wt.qos={},Pt.qos.videoMinBitrate?wt.qos.videoMinBitrate=Pt.qos.videoMinBitrate:Pt.qos.videoMinQuality&&["excellent","good","medium","bad"].indexOf(Pt.qos.videoMinQuality)>=0?wt.qos.videoMinQuality=Pt.qos.videoMinQuality:wt.qos.videoMinQuality="bad",Pt.qos.videoStartBitrate?wt.qos.videoStartBitrate=Pt.qos.videoStartBitrate:Pt.qos.videoStartQuality&&["upper","excellent","good","medium","bad"].indexOf(Pt.qos.videoStartQuality)>=0&&(wt.qos.videoStartQuality=Pt.qos.videoStartQuality),Pt.qos.videoForbidInactive===!1?wt.qos.videoForbidInactive=!1:wt.qos.videoForbidInactive=!0):wt.qos={videoMinQuality:"bad",videoForbidInactive:!0},Pt.simulcast&&(Pt.userMediaStreamId&&(Kt=apiCC.getUserMediaStream(Pt.userMediaStreamId))&&Kt.isSimulcastCompliant()||delete Pt.simulcast),function(an){if(!(0,ct.ki)(an,"simulcast","object")||ct.wL.type==="safari"&&an.simulcast.mode!=="SDP")return delete an.simulcast,!1;delete an.simulcast.sendEncodings,(0,ct.ki)(an.simulcast,"maxBitrate","number")?ct.wL.type==="chrome"&&ct.wL.version>=78&&an.simulcast.mode!=="SDP"?(pn.debug("configure simulcast RID chrome maxBitrate"),!Fn(an.simulcast,an.simulcast.maxBitrate)&&(pn.warn("cannot configure simulcast"),delete an.simulcast)):ct.wL.type==="firefox"?(pn.debug("configure simulcast RID firefox maxBitrate"),!Fn(an.simulcast,an.simulcast.maxBitrate)&&(pn.warn("cannot configure simulcast"),delete an.simulcast)):delete an.simulcast.encodings:(0,ct.ki)(an.simulcast,"encodings","object")?ct.wL.type==="chrome"&&ct.wL.version>=78&&an.simulcast.mode!=="SDP"?(pn.debug("configure simulcast RID chrome encodings"),!Pn(an.simulcast)&&(pn.warn("cannot configure simulcast"),delete an.simulcast)):ct.wL.type==="firefox"?(pn.debug("configure simulcast RID firefox encodings"),!Pn(an.simulcast)&&(pn.warn("cannot configure simulcast"),delete an.simulcast)):delete an.simulcast.encodings:ct.wL.type==="chrome"&&ct.wL.version>=78&&an.simulcast.mode!=="SDP"?(pn.debug("configure simulcast RID chrome default"),an.simulcast.encodings={high:{maxBitrate:900},medium:{maxBitrate:300,scaleResolutionDownBy:2},low:{maxBitrate:100,scaleResolutionDownBy:4}},!Pn(an.simulcast)&&delete an.simulcast):ct.wL.type==="firefox"&&(pn.debug("configure simulcast RID firefox default"),an.simulcast.encodings={high:{maxBitrate:900},medium:{maxBitrate:300,scaleResolutionDownBy:2},low:{maxBitrate:100,scaleResolutionDownBy:4}},!Pn(an.simulcast))&&delete an.simulcast}(Pt),Pt.distributedBroadcastEnabled&&!Pt.simulcast&&(wt.distributedBroadcastEnabled=!0),["audioLabels","videoLabels"].forEach(function(an){(0,ct.Ym)(Pt[an],"array")&&(wt[an]=[],Pt[an].forEach(function(un){(0,ct.Ym)(un,"string")&&wt[an].push(un)}))}),(0,ct.Ym)(Pt,"context","object"))try{JSON.stringify(Pt.context),wt.context=Pt.context}catch{}if((0,ct.Ym)(Pt,"profileType","string")&&(wt.profileType=Pt.profileType),(0,ct.Ym)(Pt,"priority","number")&&Pt.priority>=0&&(wt.priority=Pt.priority),(0,ct.Ym)(Pt,"downgradeProfileList","array")&&(wt.downgradeProfileList=Pt.downgradeProfileList),pn.debug("callConfiguration; audioOnly: "+jt+", videoOnly: "+Yt),Dt&&Dt.forceScreenSharingCallType===!0)pn.debug("publish screenSharing");else if(apiCC.mediaDeviceMgr.videoDevicePresent===!1){if(apiCC.mediaDeviceMgr.audioDevicePresent===!1)return pn.debug("publish without any device, leaving publish ..."),wt.publishWithoutMediaDeviceDetected=!0,apiCC.session.setUserData(wt),In.createErrorEvent("Cannot publish without audio nor video","PUBLISH_FAILURE",null,nt),null;jt!==!0&&(pn.debug("publish video, but no webcam present, forcing callType to audio"),jt=!0)}else apiCC.mediaDeviceMgr.audioDevicePresent===!1&&Yt!==!0&&(pn.debug("publish video, but no microphone present, forcing callType to videoOnly"),Yt=!0);if(Et=new Cn(apiCC.session.apiCCWebRTCClient.webRTCClient),wt.mesh!==void 0&&wt.instanceId!==void 0?(pn.debug("keeping instanceId "),Et.instanceId=wt.instanceId):Et.instanceId=apiCC.generateInstanceId(),this.pubConnector!=="janusConnector"||wt.mesh?(Et.settingUpType="publish",Et.generateCallId()):(Et.settingUpType="publish",Dt&&Dt.callControl?(Et.callControl=Dt.callControl,Et.callControl.autoRestart.counter+=1,Et.callId=Et.callControl.callId,Et.restarted=!0):(Et.callControl=apiCC.session.apiCCWebRTCClient.webRTCClient.createCallControl({type:"publish",roomName:nt,callConfiguration:Pt,data:wt}),Et.callControl.sessionId=vt,Et.callControl.token=Tt,Et.callControl.autoRestart.counter=0,Et.generateCallId(),Et.callControl.callId=Et.callId)),Pt!=null&&Pt.turnServerAddress!==void 0&&Pt.turnServerAddress!==null&&Et.setCallTurnServer(Pt.turnServerAddress),Pt.userMediaStreamId&&((Kt=apiCC.getUserMediaStream(Pt.userMediaStreamId))?(Et.callType=Kt.callType,pn.debug("Setting callType to "+Et.callType),Et.callType==="screenSharing"&&(Et.screenSharing=!0)):(pn.debug("callConfiguration.userMediaStreamId is setted but stream is not present"),delete Pt.userMediaStreamId)),Et.data=wt,Et.data.instanceId=Et.instanceId,vt==="restarted"&&(Et.restarted=!0),Et.mediaTypeForIncomingCall="NONE",jt===!0?(pn.log("Setting call as audioOnly"),Et.audioOnly=!0,Et.callType="audio",Et.mediaTypeForOutgoingCall="AUDIO"):Yt===!0?(pn.log("Setting call as videoOnly"),Et.callType="videoOnly",Et.mediaTypeForOutgoingCall="VIDEOONLY"):pn.log("Not Setting call as audioOnly nor videoOnly"),Et.dest_roomId=rn.roomName,Et.calleeId=rn.roomName,Et.data.pubSub=this.pubConnector,Et.data.type="publish",Et.data.capabilities=this.browserCapabilities,Et.data.cloudConvId=rn.convId,Et.callConfiguration=Pt,Et.sessionMCU=rn,Et.setMediaConstraintsToSendOnlyOffer(),Et.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,(0,ct.Ym)(Pt,"simulcast","object")){var hn=null;Kt&&(hn=Kt.getSimulcastProfile()),ct.wL.type==="chrome"&&ct.wL.version>=78&&Pt.simulcast.mode!=="SDP"?(pn.debug("simulcast chrome 78+ -> RID",Pt.simulcast),Et.simulcast="RID",Et.data.simulcast={enabled:!0,mode:"RID"},Et.data.simulcast.encodings=Object.assign({},Pt.simulcast.encodings),hn&&(Et.data.simulcast.profile=hn)):ct.wL.type==="chrome"?(pn.debug("simulcast chrome -> SDP",Pt.simulcast),Et.simulcast="SDP",Et.data.simulcast={enabled:!0,mode:"SDP"}):ct.wL.type==="firefox"?(pn.debug("simulcast firefox -> RID",Pt.simulcast),Et.simulcast="RID",Et.data.simulcast={enabled:!0,mode:"RID"},Et.data.simulcast.encodings=Object.assign({},Pt.simulcast.encodings),hn&&(Et.data.simulcast.profile=hn)):ct.wL.type==="safari"&&(pn.debug("simulcast safari -> SDP",Pt.simulcast),Et.simulcast="SDP",Et.data.simulcast={enabled:!0,mode:"SDP"})}return pn.log("webRTCClient.accessToLocalMedia :",qt.accessToLocalMedia),apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.push(Et),this.publishCallId=Et.callId,Et.callControl&&Et.callControl.autoRestart.stream&&pn.debug("call.callControl.autoRestart.stream.active :",Et.callControl.autoRestart.stream.active),this.pubConnector==="janusConnector"&&Et.callControl&&Et.callControl.autoRestart.stream&&Et.callControl.autoRestart.stream.active?(apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,Et.callLocalStream=Et.callControl.autoRestart.stream,Et.establishCall(),Et.callId):(wt.mesh!==void 0&&(en=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(wt.mesh.calleeCallId))!==null&&en.callConfiguration&&en.callConfiguration.userMediaStreamId&&(Et.callType=en.callType,Pt.userMediaStreamId=en.callConfiguration.userMediaStreamId),Pt.userMediaStreamId?((Kt=apiCC.getUserMediaStream(Pt.userMediaStreamId)).addCallInfo(Et.callId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,this.pubConnector==="janusConnector"&&Et.callControl&&(Et.callControl.autoRestart.stream=Kt.stream),Et.callConfiguration.userMediaStreamId=Kt.userMediaStreamId,Et.callLocalStream=Kt.stream,Et.establishCall(),Et.callId):apiCC.userMediaStreamTable.length>0?((Kt=apiCC.userMediaStreamTable[0]).addCallInfo(Et.callId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,this.pubConnector==="janusConnector"&&Et.callControl&&(Et.callControl.autoRestart.stream=Kt.stream),Et.callConfiguration.userMediaStreamId=Kt.userMediaStreamId,Et.callLocalStream=Kt.stream,Et.establishCall(),Et.callId):(apiCC.createUserMediaStream({callId:Et.callId,type:Et.callType,audioSourceId:qt.audioSourceId,videoSourceId:qt.videoSourceId,success:function(an){pn.debug("[publish] success; userMediaStreamId: "+an.userMediaStreamId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector==="janusConnector"&&Et.callControl&&(Et.callControl.autoRestart.stream=an.stream),Et.callConfiguration.userMediaStreamId=an.userMediaStreamId,Et.callLocalStream=an.stream,Et.establishCall()}}),Et.callId))},this.publishScreen=function(nt,vt,Tt,Pt){pn.info("publishScreen()");var wt=this.getSessionMCU(nt);return wt?(vt==null&&(vt={}),Tt==null&&(Tt={}),Tt.record!==void 0&&(vt.callConfiguration!==void 0||(vt.callConfiguration={}),vt.callConfiguration.record=Tt.record),Tt.private!==void 0&&(vt.callConfiguration!==void 0||(vt.callConfiguration={}),vt.callConfiguration.private=Tt.private),vt.pubSub=this.pubConnector,vt.type="publish",apiCC.session.apiCCWebRTCClient.webRTCClient.shareScreen(wt.roomName,vt,Pt,Tt)):(pn.error("roomId does not match any sessionMCU"),null)},this.unpublish=function(nt){pn.info("unpublish call with callId :",nt),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(nt),this.publishCallId=null},this.removeMCUStream=function(nt,vt,Tt){var Pt,wt=!1;for(Tt!=="Broken_by_MCU"&&Tt!=="disconnected"||(wt=!0),pn.debug("streamId:",vt),pn.debug("reason:",Tt),pn.debug("quiet:",wt),Pt=0;Pt<this.streamList.length;Pt+=1)if(pn.log("this.streamList[i].streamInfo.id :",this.streamList[Pt].streamInfo.id),this.streamList[Pt].streamInfo.id===vt){wt===!0?(pn.debug("add stream into disputableStreamList: ",vt),this.streamList[Pt].disputableTimeoutId=setTimeout(Mn.bind(this,this.streamList[Pt].streamInfo.id),On),this.streamList[Pt].clearDisputableEntry=Nn.bind(this,this.streamList[Pt].streamInfo.id),this.disputableStreamList.push(this.streamList[Pt])):(pn.debug("remove stream from streamList:",vt),apiCC.session.apiCCWebRTCClient.webRTCClient.destroyCallControl({type:"subscribe",stream:this.streamList[Pt].streamInfo}),this.streamList.splice(Pt,1));break}nt!==void 0&&apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(nt),wt!==!0&&In.createMCURemovedStreamEvent(vt)},this.startStreaming=function(nt,vt,Tt,Pt){pn.info("startStreaming");var wt,Dt,Et=nt!=null&&nt.length>0,jt=vt!=null&&vt.length>0,Yt={};if(!Et&&!jt||Tt==null||Tt.length===0)return!1;if(Pt===void 0){if(this.publishCallId===null)return pn.log("Cannot start streaming as no stream is published"),!1;Pt=this.publishCallId}var en=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(Pt);return en||(en=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(Pt))?en.sessionMCU?(Et||(nt="custom"),Yt.pubSub=this.pubConnector,Yt.service=nt,jt&&(Yt.server=vt),Yt.streamKey=Tt,pn.log("startStreaming() on ApiRTC MCU with roomId:",en.sessionMCU.roomName),wt={type:"startStreaming",roomId:en.sessionMCU.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Pt,data:Yt},Dt=JSON.stringify(wt),pn.log("C->S: "+Dt),apiCC.session.channel.socket.emit("startStreaming",Dt),!0):(pn.error("no such sessionMCU"),!1):(pn.error("callIdToStream does not match any call"),!1)},this.stopStreaming=function(nt){var vt,Tt;if(pn.info("stopStreaming"),nt===void 0){if(this.publishCallId===null)return pn.log("Cannot stop streaming as no stream is published"),!1;nt=this.publishCallId}var Pt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(nt);if(!Pt)return pn.error("callIdToStream does not match any call"),!1;var wt=this.getSessionMCU(Pt.dest_roomId);return wt?(pn.log("stopStreaming() on ApiRTC MCU with roomId:",wt.roomName),vt={type:"stopStreaming",roomId:wt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:nt,data:{pubSub:this.pubConnector}},Tt=JSON.stringify(vt),pn.log("C->S: "+Tt),apiCC.session.channel.socket.emit("stopStreaming",Tt),!0):(pn.error("dest_roomId does not match any sessionMCU"),!1)},this.startRecording=function(nt,vt,Tt,Pt,wt){var Dt,Et;if(pn.info("startRecording"),Pt==null){if(this.publishCallId===null)return void pn.log("Call recording can not start as stream is not published");Pt=this.publishCallId}var jt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(Pt);return jt||(jt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(Pt))?jt.sessionMCU?(nt!=="AUDIO-ONLY"&&nt!=="VIDEO-ONLY"&&(nt="AUDIO-VIDEO"),wt==null&&(wt={}),wt.pubSub=this.pubConnector,pn.log("startRecording() on ApiRTC MCU with roomId :",jt.sessionMCU.roomName),Dt={type:"startRecording",roomId:jt.sessionMCU.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Pt,data:wt,customIdInFilename:vt,mediaType:nt,convId:Tt},Et=JSON.stringify(Dt),pn.log("C->S: "+Et),void apiCC.session.channel.socket.emit("startRecording",Et)):(pn.error("no such sessionMCU"),!1):(pn.error("callIdToRecord does not match any call"),!1)},this.stopRecording=function(nt){var vt,Tt;if(pn.info("stopRecording"),nt===void 0){if(this.publishCallId===null)return void pn.log("Call recording can not stop as stream is not published");nt=this.publishCallId}var Pt=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(nt);if(!Pt)return pn.error("callIdToRecord does not match any call"),!1;var wt=this.getSessionMCU(Pt.dest_roomId);if(!wt)return pn.error("dest_roomId does not match any sessionMCU"),!1;pn.log("stopRecording() on ApiRTC MCU with roomId :",wt.roomName),vt={type:"stopRecording",roomId:wt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:nt,data:{pubSub:this.pubConnector}},Tt=JSON.stringify(vt),pn.log("C->S: "+Tt),apiCC.session.channel.socket.emit("stopRecording",Tt)},this.recordingStarted=function(nt){pn.info("recordingStarted:",nt),In.createMCURecordingStartedEvent(nt.roomName,nt.callId,nt.clientId,nt.recordType,nt.time,nt.convId,nt.mediaId,nt.mediaURL,nt.remoteId,nt.recordedFileName,nt.mediaType,nt.descriptor)},this.recordingStopped=function(nt){pn.info("recordingStopped:",nt),In.createMCURecordingStoppedEvent(nt.roomName,nt.callId,nt.clientId,nt.recordType,nt.time,nt.convId,nt.mediaId,nt.mediaURL,nt.remoteId,nt.recordedFileName,nt.mediaType,nt.descriptor)},this.recordingStreamAvailable=function(nt){pn.info("recordingStreamAvailable :",nt),In.createMCURecordedStreamsAvailableEvent(nt.roomName,nt.callId,nt.clientId,nt.recordedFileName,nt.convId,nt.mediaId,nt.mediaURL,nt.recordType,nt.remoteId,nt.mediaType,nt.descriptor),this.pubConnector==="janusConnector"&&nt.hasOwnProperty("confId")&&nt.hasOwnProperty("remoteId")&&In.createRecordedStreamsAvailableEvent(nt.confId,nt.clientId,nt.remoteId,nt.callId,nt.convId,nt.mediaId,nt.mediaURL)},this.streamingStarted=function(nt){pn.info("streamingStarted: ",nt),In.createMCUStreamingStartedEvent(nt.roomName,nt.callId,nt.clientId,nt.time)},this.streamingStopped=function(nt){pn.info("streamingStopped: ",nt),In.createMCUStreamingStoppedEvent(nt.roomName,nt.callId,nt.clientId,nt.time)},this.startComposite=function(nt){var vt,Tt,Pt;(Pt=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0}))?(pn.log("startComposite() on ApiRTC MCU with roomId :",Pt.roomName),vt={type:"startComposite",roomId:Pt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector}},Tt=JSON.stringify(vt),pn.log("C->S: "+Tt),apiCC.session.channel.socket.emit("startComposite",Tt)):pn.log("startComposite() but client is not in session")},this.stopComposite=function(nt){var vt,Tt,Pt;(Pt=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0}))?(pn.log("stopComposite() on ApiRTC MCU with roomId :",Pt.roomName),vt={type:"stopComposite",roomId:Pt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector}},Tt=JSON.stringify(vt),pn.log("C->S: "+Tt),apiCC.session.channel.socket.emit("stopComposite",Tt)):pn.log("stopComposite() but client is not in session")},this.startCompositeRecording=function(nt,vt,Tt,Pt,wt){pn.info("startCompositeRecording with convId :",Tt);var Dt,Et,jt;(jt=wt?this.getSessionMCU(wt):this.getSessionMCU(null,{first:!0}))?(nt!=="AUDIO-ONLY"&&nt!=="VIDEO-ONLY"&&(nt="AUDIO-VIDEO"),(Pt=(0,ct.Ym)(Pt,"object")?(0,ct.ws)({},Pt):{}).pubSub=this.pubConnector,["complete","efficient","audioOnly"].indexOf(Pt.mode)<0&&(Pt.mode="complete"),Pt.labelEnabled=Pt.labelEnabled===!0,(0,ct.Ym)(Pt,"labels","array")||(Pt.labels=["microphone","camera","screenSharing","sip"]),pn.log("startRecording() on ApiRTC MCU with roomId :",jt.roomName),Dt={type:"startRecording",roomId:jt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:"COMPOSITE",data:Pt,customIdInFilename:vt,mediaType:nt,convId:Tt},Et=JSON.stringify(Dt),pn.log("C->S: "+Et),apiCC.session.channel.socket.emit("startRecording",Et)):pn.log("startCompositeRecording() but client is not in session")},this.stopCompositeRecording=function(nt){pn.info("stopCompositeRecording");var vt,Tt,Pt;(Pt=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0}))?(pn.log("stopRecording() on ApiRTC MCU with roomId :",Pt.roomName),vt={type:"stopRecording",roomId:Pt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:"COMPOSITE",data:{pubSub:this.pubConnector}},Tt=JSON.stringify(vt),pn.log("C->S: "+Tt),apiCC.session.channel.socket.emit("stopRecording",Tt)):pn.log("stopCompositeRecording() but client is not in session")},this.inviteVoIP=function(nt,vt,Tt){var Pt=this;return new Promise(function(wt,Dt){if(!nt||typeof nt!="string")return Dt(new Error("wrong roomId"));if(!Pt.getSessionMCU(nt))return Dt(new Error("no such session"));if(!vt||typeof vt!="string")return Dt(new Error("wrong convId"));if(!Tt||typeof Tt!="string")return Dt(new Error("wrong phoneNumber"));var Et="inviteVoIP-"+Tt;try{if(qt.hasReceiptHook(Et))return Dt(new Error("busy"));var jt=new Nt;jt.onSuccess(function(){return wt()}),jt.onFailure(function(Kt){return Dt(Kt)}),jt.setTimeout(1e4,"timeout"),qt.createReceiptHook(Et,jt)}catch(Kt){return pn.debug("inviteVoIP: createReceiptHook",Kt),Dt(new Error("internal error"))}var Yt={type:"inviteVoIP",clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,roomId:nt,convId:vt,phoneNumber:Tt,receiptId:Et,data:{pubSub:"sipConnector"}},en=JSON.stringify(Yt);pn.debug("C->S:",en),apiCC.session.channel.socket.emit("inviteVoIP",en)})},this.enforceMCU=function(nt){var vt;if(vt=nt?this.getSessionMCU(nt):this.getSessionMCU(null,{first:!0})){var Tt={type:"info",infoType:"enforceMCU",data:{clientId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,roomId:vt.roomName,pubSub:this.pubConnector}},Pt=JSON.stringify(Tt);pn.log("C->S: "+Pt),apiCC.session.channel.socket.emit("info",Pt)}else pn.log("enforceMCU() but client is not in session")},this.meshPublish=function(nt,vt,Tt,Pt,wt,Dt){var Et=!1,jt=null,Yt=null,en=this.getSessionMCU(nt);if(!en)return pn.error("meshPublish() - missing sessionMCU"),null;if(Pt===!0||Pt===!1||Pt==="true"||Pt==="false"?(pn.log("DEPRECATED ... please use callConfiguration JSON parameter : callConfiguration.audioOnly instead of audioOnly"),Et=Pt,Pt={}):Pt!==null&&dn(Pt)==="object"||(Pt={}),wt!==null&&dn(wt)==="object"||(wt={}),(0,ct.Ym)(Pt,"profileType","string")&&(wt.profileType=Pt.profileType),(0,ct.Ym)(Pt,"priority","number")&&Pt.priority>=0&&(wt.priority=Pt.priority),(0,ct.Ym)(Pt,"downgradeProfileList","array")&&(wt.downgradeProfileList=Pt.downgradeProfileList),Pt.audioOnly!==void 0&&(Et=Pt.audioOnly,wt.callConfiguration!==void 0||(wt.callConfiguration={}),wt.callConfiguration.audioOnly=Pt.audioOnly),(0,ct.Ym)(Pt,"context","object"))try{JSON.stringify(Pt.context),wt.context=Pt.context}catch{}return jt=new Tn(apiCC.session.apiCCWebRTCClient.webRTCClient),Et!==!0&&Et!=="true"||(pn.log("Setting call as audioOnly"),jt.callType="audio"),jt.roomId=nt,jt.sessionId=vt,jt.token=Tt,jt.callConfiguration=Pt,jt.data=wt,jt.options=Dt,jt.sessionMCU=en,apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable.push(jt),Pt.userMediaStreamId?((Yt=apiCC.getUserMediaStream(Pt.userMediaStreamId)).addCallInfo(jt.userMediaId,"userMedia"),jt.callConfiguration.userMediaStreamId=Yt.userMediaStreamId,jt.callType=Yt.callType,jt.audio=Yt.audio,jt.video=Yt.video,jt.audioMuted=Yt.audioMuted,jt.videoMuted=Yt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(jt),apiCC.checkMutingStateForUserMedia(Pt,Yt)):apiCC.createUserMediaStream({callId:jt.userMediaId,callFlavor:"userMedia",type:jt.callType,audioSourceId:apiCC.session.apiCCWebRTCClient.webRTCClient.audioSourceId,videoSourceId:apiCC.session.apiCCWebRTCClient.webRTCClient.videoSourceId,success:function(Kt){pn.debug("[meshPublish] success; userMediaStreamId: "+Kt.userMediaStreamId),jt.callConfiguration.userMediaStreamId=Kt.userMediaStreamId,jt.callType=Kt.callType,jt.audio=Kt.audio,jt.video=Kt.video,jt.audioMuted=Kt.audioMuted,jt.videoMuted=Kt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(jt),apiCC.checkMutingStateForUserMedia(Pt,Kt)}}),jt.userMediaId},this.meshOnUserMediaSuccess=function(nt){var vt=arguments.length>1&&arguments[1]!==void 0&&arguments[1],Tt=null,Pt=null;vt===!0?((Tt={}).type="streamStatusChanged",Tt.callerId=qt.clientId,Tt.roomId=nt.roomId,Tt.streams={},Tt.streams[nt.userMediaId]={eventType:"modify",callId:nt.userMediaId,callType:nt.callType,audio:nt.audio,video:nt.video,audioMuted:nt.audioMuted,videoMuted:nt.videoMuted},Tt.data={},Tt.data.meshPublish=!0,Tt.data.pubSub=this.pubConnector,Pt=JSON.stringify(Tt),pn.log("C->S: "+Pt),apiCC.session.channel.socket.emit("streamStatusChanged",Pt)):(this.publishCallId=nt.userMediaId,nt.addAck=!0,nt.addTimeoutId=setTimeout(function(){qt.onRemoteHangup(nt.userMediaId,qt.clientId,nt.roomId,"Unable_to_establish",null,null)},nt.disconnectionTimer),(Tt={}).type="streamStatusChanged",Tt.callerId=qt.clientId,Tt.roomId=nt.roomId,Tt.streams={},Tt.streams[nt.userMediaId]={eventType:"add",callId:nt.userMediaId,callType:nt.callType,audio:nt.audio,video:nt.video,audioMuted:nt.audioMuted,videoMuted:nt.videoMuted},Tt.data=nt.data,Tt.data.meshPublish=!0,Tt.data.pubSub=this.pubConnector,Pt=JSON.stringify(Tt),pn.log("C->S: "+Pt),apiCC.session.channel.socket.emit("streamStatusChanged",Pt))},this.meshPublishScreen=function(nt,vt,Tt,Pt,wt){var Dt=null,Et=null,jt=this.getSessionMCU(nt);return jt?(Tt!==null&&dn(Tt)==="object"||(Tt={}),(Dt=new Tn(apiCC.session.apiCCWebRTCClient.webRTCClient)).roomId=nt,Dt.data=vt,Dt.callConfiguration=Tt,Dt.captureSourceType=Pt,Dt.sessionMCU=jt,apiCC.session.apiCCWebRTCClient.webRTCClient.userMediaTable.push(Dt),Tt.userMediaStreamId?((Et=apiCC.getUserMediaStream(Tt.userMediaStreamId)).addCallInfo(Dt.userMediaId,"userMedia"),Dt.callConfiguration.userMediaStreamId=Et.userMediaStreamId,Dt.callType=Et.callType,Dt.audio=Et.audio,Dt.video=Et.video,Dt.audioMuted=Et.audioMuted,Dt.videoMuted=Et.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Dt)):apiCC.createUserMediaStream({callId:Dt.userMediaId,callFlavor:"userMedia",type:"screenSharing",captureSourceType:Pt,success:function(Yt){pn.debug("[meshPublishScreen] success; userMediaStreamId: "+Yt.userMediaStreamId),Dt.callConfiguration.userMediaStreamId=Yt.userMediaStreamId,Dt.callType=Yt.callType,Dt.audio=Yt.audio,Dt.video=Yt.video,Dt.audioMuted=Yt.audioMuted,Dt.videoMuted=Yt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnScreenMediaSuccess(Dt)}}),Dt.userMediaId):(pn.error("meshPublishScreen() - missing sessionMCU"),null)},this.meshOnScreenMediaSuccess=function(nt){var vt,Tt=null;nt.addAck=!0,nt.addTimeoutId=setTimeout(function(){qt.onRemoteHangup(nt.userMediaId,qt.clientId,nt.roomId,"Unable_to_establish",null,null)},nt.disconnectionTimer),(Tt={}).type="streamStatusChanged",Tt.callerId=qt.clientId,Tt.roomId=nt.roomId,Tt.streams={},Tt.streams[nt.userMediaId]={eventType:"add",callId:nt.userMediaId,callType:nt.callType,audio:nt.audio,video:nt.video,audioMuted:nt.audioMuted,videoMuted:nt.videoMuted},Tt.data={},Tt.data.pubSub=this.pubConnector,vt=JSON.stringify(Tt),pn.log("C->S: "+vt),apiCC.session.channel.socket.emit("streamStatusChanged",vt)},this.meshOnHangup=function(nt,vt){var Tt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Pt=0,wt=null,Dt=null,Et=null;if(vt!==null&&dn(vt)==="object"||(vt={}),nt){if((wt=qt.findUserMediaById(nt))!==null){for(wt.close(),wt.streamStolen!==!0&&(qt.myWebRTC_Event.createHangupEvent("local",qt.clientId,0,!0,null,wt.userMediaId,wt.callType),wt.releaseUserMediaStream()),(Dt={}).type="streamStatusChanged",Dt.callerId=qt.clientId,Dt.roomId=wt.roomId,Dt.streams={},Dt.streams[wt.userMediaId]={eventType:"remove",callId:wt.userMediaId,callType:wt.callType},Tt.restart&&(Dt.streams[wt.userMediaId].restart=!0),Dt.data={},Dt.data.pubSub=this.pubConnector,Et=JSON.stringify(Dt),pn.log("C->S: "+Et),apiCC.session.channel.socket.emit("streamStatusChanged",Et),Pt=qt.userMediaTable.length;--Pt>=0;)if(qt.userMediaTable[Pt]===wt){qt.userMediaTable.splice(Pt,1);break}}}else for(Pt=qt.userMediaTable.length;--Pt>=0;)wt=qt.userMediaTable[Pt],Tt.hasOwnProperty("roomId")&&wt.sessionMCU.roomName!==Tt.roomId||(qt.myWebRTC_Event.createHangupEvent("local",qt.clientId,0,!0,null,wt.userMediaId,wt.callType),wt.close(),wt.releaseUserMediaStream(),(Dt={}).type="streamStatusChanged",Dt.callerId=qt.clientId,Dt.roomId=wt.roomId,Dt.streams={},Dt.streams[wt.userMediaId]={eventType:"remove",callId:wt.userMediaId,callType:wt.callType},Dt.data={},Dt.data.pubSub=this.pubConnector,Et=JSON.stringify(Dt),pn.log("C->S: "+Et),apiCC.session.channel.socket.emit("streamStatusChanged",Et),qt.userMediaTable.splice(Pt,1))},this.participantEjected=function(nt){(0,ct.Ym)(nt.data,"clientId","string")&&qt.myWebRTC_Event.createMCUParticipantEjectedEvent(nt.roomId,nt.data.clientId,nt.data.info)},this.ejectParticipant=function(nt,vt,Tt){var Pt;if(Pt=Tt?this.getSessionMCU(Tt):this.getSessionMCU(null,{first:!0})){var wt={type:"ejectParticipant",roomId:Pt.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,data:{pubSub:this.pubConnector,clientId:nt}};vt&&(wt.data.info=vt);var Dt=JSON.stringify(wt);pn.log("C->S: "+Dt),apiCC.session.channel.socket.emit("ejectParticipant",Dt)}else pn.debug("ejectParticipant() - missing sessionMCU")},this.getJoinSessionReq=function(nt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Tt=null;if(!nt){if(vt.hasOwnProperty("transactionId")){for(var Pt=this.joinSessionReqs.length;--Pt>=0;)if(this.joinSessionReqs[Pt].transactionId===vt.transactionId){Tt=this.joinSessionReqs[Pt];break}return Tt}return null}for(var wt=this.joinSessionReqs.length;--wt>=0;)if(this.joinSessionReqs[wt].roomId===nt){Tt=this.joinSessionReqs[wt];break}return Tt},this.removeJoinSessionReq=function(nt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!nt){if(vt.all===!0)return this.joinSessionReqs.splice(0,this.joinSessionReqs.length),!0;vt.hasOwnProperty("roomId")&&(nt=this.getJoinSessionReq(vt.roomId))}if(!nt)return!1;for(var Tt=this.joinSessionReqs.length;--Tt>=0&&this.joinSessionReqs[Tt]!==nt;);return Tt>=0&&(this.joinSessionReqs.splice(Tt,1),!0)},this.getSessionMCU=function(nt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Tt=null;if(!nt){if(vt.first===!0)return this.sessionMCUs[0];if((0,ct.Ym)(vt.callback,"function")){pn.debug("getSessionMCU callback");for(var Pt=this.sessionMCUs.length;--Pt>=0;)if(vt.callback(this.sessionMCUs[Pt])){Tt=this.sessionMCUs[Pt];break}}return Tt}for(var wt=this.sessionMCUs.length;--wt>=0;)if(this.sessionMCUs[wt].roomName===nt){Tt=this.sessionMCUs[wt];break}return Tt},this.removeSessionMCU=function(nt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!nt&&vt.all===!0)return this.sessionMCUs.splice(0,this.sessionMCUs.length),!0;if(!nt)return!1;for(var Tt=this.sessionMCUs.length;--Tt>=0&&this.sessionMCUs[Tt]!==nt;);return Tt>=0&&(this.sessionMCUs.splice(Tt,1),!0)},this.callback=function(nt,vt){return this.closureHandler=function(Tt){return nt[vt](Tt)},this.closureHandler}};function Mn(qt){pn.debug("disputableEntryTimeout",qt);for(var Rt=apiCC.session.apiCCWebRTCClient.webRTCClient,nt=this.disputableStreamList.length;--nt>=0;)if(this.disputableStreamList[nt].streamInfo.id===qt){this.disputableStreamList.splice(nt,1);break}for(var vt=null,Tt=this.streamList.length;--Tt>=0;)if(this.streamList[Tt].streamInfo.id===qt){vt=Rt.destroyCallControl({type:"subscribe",stream:this.streamList[Tt].streamInfo}),this.streamList.splice(Tt,1);break}vt&&vt.callId&&In.createHangupEvent("remote",Rt.clientId,vt.roomName,!1,"Hangup_From_Callee",vt.callId,vt.callType),In.createMCURemovedStreamEvent(qt)}function Nn(qt){pn.debug("clearDisputableEntry",qt);for(var Rt=this.disputableStreamList.length;--Rt>=0;)if(this.disputableStreamList[Rt].streamInfo.id===qt){this.disputableStreamList.splice(Rt,1);break}for(var nt=this.streamList.length;--nt>=0;)if(this.streamList[nt].streamInfo.id===qt){this.streamList[nt].disputableTimeoutId&&(clearTimeout(this.streamList[nt].disputableTimeoutId),delete this.streamList[nt].disputableTimeoutId),delete this.streamList[nt].clearDisputableEntry;break}}function wn(qt){var Rt={};return(0,ct.ki)(qt,"maxBitrate","number")&&(Rt.maxBitrate=qt.maxBitrate),(0,ct.ki)(qt,"scaleResolutionDownBy","number")&&(Rt.scaleResolutionDownBy=qt.scaleResolutionDownBy),Rt}function Pn(qt){return(0,ct.Ym)(qt.encodings,"object")?(0,ct.ki)(qt.encodings.high,"maxBitrate","number")&&(0,ct.ki)(qt.encodings.medium,"maxBitrate","number")&&(0,ct.ki)(qt.encodings.low,"maxBitrate","number")?(qt.encodings.high=Object.assign({active:!0},wn(qt.encodings.high)),qt.encodings.medium=Object.assign({active:!0},wn(qt.encodings.medium)),qt.encodings.low=Object.assign({active:!0},wn(qt.encodings.low)),qt.sendEncodings=[{rid:"h",active:!0},{rid:"m",active:!0},{rid:"l",active:!0}],qt.sendEncodings[0].maxBitrate=1e3*qt.encodings.high.maxBitrate,qt.sendEncodings[1].maxBitrate=1e3*qt.encodings.medium.maxBitrate,qt.sendEncodings[2].maxBitrate=1e3*qt.encodings.low.maxBitrate,(0,ct.ki)(qt.encodings.medium,"scaleResolutionDownBy","number")&&(qt.sendEncodings[1].scaleResolutionDownBy=qt.encodings.medium.scaleResolutionDownBy),(0,ct.ki)(qt.encodings.low,"scaleResolutionDownBy","number")&&(qt.sendEncodings[2].scaleResolutionDownBy=qt.encodings.low.scaleResolutionDownBy),!0):(pn.warn("no such maxBitrate"),!1):(pn.warn("no such encodings"),!1)}function Fn(qt,Rt){if(Rt<650)return!1;var nt=Math.floor(9*Rt/13),vt=Math.floor(3*Rt/13),Tt=Rt-nt-vt;return qt.encodings={high:{maxBitrate:nt},medium:{maxBitrate:vt,scaleResolutionDownBy:2},low:{maxBitrate:Tt,scaleResolutionDownBy:4}},Pn(qt)}tt.Y.get("CallControl");var ar=function(qt){this.type=qt.type,qt.callId&&(this.callId=qt.callId),qt.callType?this.callType=qt.callType:this.callType="media",Object.prototype.hasOwnProperty.call(qt,"audioOnly")&&(this.audioOnly=!!qt.audioOnly),qt.roomName&&(this.roomName=qt.roomName),qt.mediaType&&(this.mediaType=qt.mediaType),qt.callConfiguration&&(this.callConfiguration=qt.callConfiguration),qt.data&&(this.data=qt.data),qt.stream&&(this.stream=qt.stream),this.autoRestart={}},Yn=function(){var qt=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];this.a=1,this.b=0,this.c=7,this.d=0,this.update=function(Rt,nt,vt){var Tt=0;for(nt==null&&(nt=0),vt==null&&(vt=Rt.length);Tt<vt;Tt+=1)this.a=(this.a+Rt[nt+Tt])%65521,this.b=(this.b+this.a)%65521,this.c=(this.c+3)*(Rt[nt+Tt]+5)%65521,this.d=(this.d+this.c)%65521},this.digest=function(Rt){return qt[this.d>>12&15]+qt[this.d>>8&15]+qt[this.d>>4&15]+qt[15&this.d]+qt[this.c>>12&15]+qt[this.c>>8&15]+qt[this.c>>4&15]+qt[15&this.c]+qt[this.b>>12&15]+qt[this.b>>8&15]+qt[this.b>>4&15]+qt[15&this.b]+qt[this.a>>12&15]+qt[this.a>>8&15]+qt[this.a>>4&15]+qt[15&this.a]}};function Xn(qt,Rt){return qt==="checksum64"?new Yn:null}function tr(qt){return tr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Rt){return typeof Rt}:function(Rt){return Rt&&typeof Symbol=="function"&&Rt.constructor===Symbol&&Rt!==Symbol.prototype?"symbol":typeof Rt},tr(qt)}var cn=tt.Y.get("WebRTC_Client"),Hn=apiCC.myWebRTC_Event,Qn=4e4,or=function(qt){function Rt(nt,vt,Tt){var Pt,wt=nt.width,Dt=wt<<2,Et=nt.height,jt=null,Yt=0,en=0,Kt=0,rn=0,hn=0,an=0,un=0,Sn=0,En=0,An=0,Dn=0,Bn=0,sr=0,fr=0,Cr=0,gr=0;if(vt){for(jt=vt.data,Tt<0&&(Tt=0),Sn=1-((hn=(2.44413*(Yt=Tt>=2.5?.98711*Tt-.9633:Tt>=.5?3.97156-4.14554*Math.sqrt(1-.26891*Tt):2*Tt*(3.97156-4.14554*Math.sqrt(.865545)))+2.85619*(en=Yt*Yt)+1.26661*(Kt=en*Yt))/(rn=1.57825+2.44413*Yt+1.4281*en+.422205*Kt))+(an=-(1.4281*en+1.26661*Kt)/rn)+(un=.422205*Kt/rn)),Pt=0;Pt<3;Pt++)for(En=0;En<Et;En++){for(Dn=En*Dt+(wt-1<<2)+Pt,Cr=fr=sr=Bn=jt[An=En*Dt+Pt],An=En*Dt+Pt;An<=Dn;An+=4)Bn=Sn*jt[An]+hn*sr+an*fr+un*Cr,jt[An]=Bn,Cr=fr,fr=sr,sr=Bn;for(Dn=En*Dt+Pt,Cr=fr=sr=Bn=jt[An=En*Dt+(wt-1<<2)+Pt],An=En*Dt+(wt-1<<2)+Pt;An>=Dn;An-=4)Bn=Sn*jt[An]+hn*sr+an*fr+un*Cr,jt[An]=Bn,Cr=fr,fr=sr,sr=Bn}for(Pt=0;Pt<3;Pt++)for(gr=0;gr<wt;gr++){for(Dn=(Et-1)*Dt+(gr<<2)+Pt,Cr=fr=sr=Bn=jt[An=(gr<<2)+Pt],An=(gr<<2)+Pt;An<=Dn;An+=Dt)Bn=Sn*jt[An]+hn*sr+an*fr+un*Cr,jt[An]=Bn,Cr=fr,fr=sr,sr=Bn;for(Dn=(gr<<2)+Pt,Cr=fr=sr=Bn=jt[An=(Et-1)*Dt+(gr<<2)+Pt],An=(Et-1)*Dt+(gr<<2)+Pt;An>=Dn;An-=Dt)Bn=Sn*jt[An]+hn*sr+an*fr+un*Cr,jt[An]=Bn,Cr=fr,fr=sr,sr=Bn}return vt}}this.localStream=null,this.remoteStream=null,this.channelReady=!1,this.socket=qt.channel.socket,this.clientId=qt.apiCCId,this.compositeClientId=qt.apiCCId+"@"+qt.apiCCSessionId,this.apiKey=qt.apiKey,this.isVideoMuted=!1,this.isAudioMuted=!1,this.receiptHooks={},this.callControlTable=[],this.userMediaTable=[],this.callsTable=[],this.callsRetriesTable={},this.restartCallDelay=1e3,this.maxCallsRetriesDuration=15e4,this.accessToLocalMedia=!1,this.unidirectionelCallOnly=!1,this.NtoNConf=!1,this.autoAnswer=!1,this.RTPMedia=!1,this.logoAdded=!1,this.preferOpusCodec=!1,this.preferVP9Codec=!1,typeof apiRTC_React<"u"&&ot.BF==="iOS"?(cn.log("React and iOS : Setting H264 as preferred codec"),this.preferH264Codec=!0):this.preferH264Codec=!1,this.preferSendingH264Codec=!1,this.setStereo=!1,this.allowedAudioCodecs="",this.allowedVideoCodecs="",this.mediaRoutingModeEnum={hostOnly:1,stun:2,stunOnly:3,turn:4,turnOnly:5},this.mediaRoutingMode=this.mediaRoutingModeEnum.turn,this.myWebRTC_Event=apiCC.myWebRTC_Event,this.getUserMediaOnGoing=!1,this.userAcceptOnIncomingCall=!1,this.userAcceptOnIncomingCallBeforeGetUserMedia=!1,this.userAcceptOnIncomingDataCall=!1,this.userAcceptOnIncomingScreenSharingCall=!1,this.maxWidthRemoteVideo=0,this.maxHeightRemoteVideo=0,this.nickname=qt.nickname,this.allowMultipleCalls=!1,this.mySDPManager=new ht,this.MCUClient=new _n(this,this.clientId),this.audioSourceId=null,this.audioOutputId=null,this.videoSourceId=null,this.facingMode=null,this.apiRTCExtensionInstalled=!1,this.trickleIce=!0,this.waitingShareScreenCallId=0,this.waitingShareScreenDestNumber=0,this.waitingCaptureSourceType=null,this.qosEnable=!1,this.qosInterval=5e3,this.csmEnable=!1,this.qualityScoreEnable=!1,this.qualityScoreIntervalMs=5e3,this.csmIntervalMs=5e3,this.recordedCall=!1,this.audioBandwidth=null,this.videoBandwidth=null,this.videoRemoteBandwidth=null,this.videoBandwidthSettings={},this.dataBandwidth=null,this.pc_config="",this.clientIncomingCandidatesQueue=[],this.cleanStoredCallCandidateTimer=6e4,this.initializeGumConfig=function(){ot.Xh==="Edge"&&ot.PR>=15&&apiRTC.browserDetails.type!=="chrome"?this.gum_config={audio:!0,video:!0}:ot.Xh==="Chrome"&&ot.PR<49||ot.Xh==="Firefox"&&ot.PR<50?this.gum_config={audio:{mandatory:{},optional:[]},video:{mandatory:{},optional:[]}}:this.gum_config={audio:{},video:{}}},this.initializeGumConfig(),this.setGumConfigWithDevicePresent=function(){apiCC.mediaDeviceMgr.audioDevicePresent===!1&&(this.gum_config.audio=!1),apiCC.mediaDeviceMgr.videoDevicePresent===!1&&(this.gum_config.video=!1),apiCC.mediaDeviceMgr.audioDevicePresent===!1&&apiCC.mediaDeviceMgr.videoDevicePresent===!1&&(this.unidirectionelCallOnly=!0),cn.log("this.gum_config:",this.gum_config)},this.userMediaErrorDetected=!1,this.lastUsedUserMediaConstraint=null,this.mediaTypeForIncomingCall="VIDEO",this.mediaTypeForOutgoingCall="VIDEO",this.allowAsymetricMediaCalls=!1,this.receiveMediaDeactivated=!1,this.configTurnServer=null,apiCC.myWebRTC_Adapter.adaptForIoSCordova(),this.pc_config={iceServers:[{urls:["turns:mp1.apizee.com:443?transport=udp","turns:mp1.apizee.com:443?transport=tcp","turn:mp1.apizee.com:443?transport=udp","turn:mp1.apizee.com:443?transport=tcp","turns:mp2.apizee.com:443?transport=udp","turns:mp2.apizee.com:443?transport=tcp","turn:mp2.apizee.com:443?transport=udp","turn:mp2.apizee.com:443?transport=tcp"],credential:"password",username:"anonymous"}]},ot.Xh==="Firefox"&&ot.PR<53?(cn.log("createPeerConnection FIREFOX"),cn.log("webrtcDetectedVersion : "+apiCC.myWebRTC_Adapter.webrtcDetectedVersion),ot.PR<38?this.pc_config={iceServers:[{url:"stun:mp1.apizee.com:443",credential:"password",username:"anonymous"},{url:"turn:mp1.apizee.com:443",credential:"password",username:"anonymous"}]}:ot.PR>=42?this.pc_config={iceServers:[{urls:["turn:mp1.apizee.com:443?transport=udp","turn:mp1.apizee.com:443?transport=tcp"],credential:"password",username:"anonymous"}]}:this.pc_config={iceServers:[{urls:"turn:mp1.apizee.com:443?transport=tcp",credential:"password",username:"anonymous"},{url:"turn:mp1.apizee.com:443?transport=tcp",credential:"password",username:"anonymous"}]}):ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11?(cn.log("Browser is :"+ot.Xh+" - using Plugin"),this.pc_config={iceServers:[{url:"stun:mp1.apizee.com:443",credential:"password",username:"anonymous"},{url:"turn:mp1.apizee.com:443",credential:"password",username:"anonymous"}]}):ot.Xh==="Edge"&&ot.PR<45&&apiRTC.browserDetails.type!=="chrome"?(cn.log("Browser is Edge < 45 - removing Turns config"),this.pc_config={iceServers:[{urls:["turn:mp1.apizee.com:443?transport=udp","turn:mp1.apizee.com:443?transport=tcp","turn:mp2.apizee.com:443?transport=udp","turn:mp2.apizee.com:443?transport=tcp"],credential:"password",username:"anonymous"}]}):cn.log("default this.pc_config configuration"),this.pc_constraints={optional:[]},ct.wL.type==="edge"?cn.debug("not data channel capable"):ct.wL.type==="safari"?ct.wL.version>=11?this.dataChannelCapable=!0:cn.debug("not data channel capable"):this.dataChannelCapable=!0,ct.wL.type==="chrome"&&ct.wL.version>=68||ct.wL.type==="firefox"&&ct.wL.version>=64||ct.wL.type==="safari"&&ct.wL.version>=12?(cn.debug("RTCRtpSender#setParameters is available"),this.rtpSenderSetParamatersCapable=!0):(cn.debug("RTCRtpSender#setParameters is NOT available"),this.rtpSenderSetParamatersCapable=!1),this.setClientTurnServer=function(nt){cn.info("setClientTurnServer :",nt);var vt=JSON.stringify(this.pc_config);vt=vt.replace(/mp1.apizee.com/g,nt),this.pc_config=JSON.parse(vt)},this.activateScreenSharing=function(nt){apiCC.activateScreenSharing(nt)},this.setGetUserMediaConfig=function(nt){if(cn.log("setGetUserMediaConfig :",nt),navigator.mediaDevices!==null&&navigator.mediaDevices!==void 0&&navigator.mediaDevices.getSupportedConstraints!==null&&navigator.mediaDevices.getSupportedConstraints!==void 0){var vt=navigator.mediaDevices.getSupportedConstraints();cn.log("Supported Constraints :",vt)}nt.video!==void 0&&(nt.video.height===void 0&&nt.video.width===void 0||nt.optional!==void 0&&(cn.warn("contraints with both optional/mandatory and specific or advanced constraints usage : this may failed depending of browsers"),cn.log("setGetUserMediaConfig : contraints modification to avoid both optional/mandatory and specific or advanced constraints usage"),nt.optional.sourceId!==void 0&&(cn.log("sourceId contraints modification to deviceId"),nt.video.deviceId===void 0&&(nt.video.deviceId={}),nt.video.deviceId.ideal=nt.optional.sourceId),delete nt.optional)),cn.log("this.gum_config :",this.gum_config),this.gum_config=nt},this.getUserMedia=function(){try{this.gum_config=apiCC.setAudioSourceIdInConstraint(this.audioSourceId,this.gum_config),this.gum_config=apiCC.setVideoSourceIdInConstraint(this.videoSourceId,this.gum_config),this.lastUsedUserMediaConstraint=this.gum_config,ot.Xh==="IE"&&ot.dc>8?apiCC.getUserMediaWithCB(this.gum_config,this.callback(this,"onUserMediaSuccess"),this.callback(this,"onUserMediaError")):apiCC.getUserMedia(this.gum_config).then(this.callback(this,"onUserMediaSuccess")).catch(this.callback(this,"onUserMediaError"))}catch(nt){cn.error("getUserMedia() failed. Is this a WebRTC capable browser?"),cn.log("getUserMedia failed with exception: "+nt.message)}},this.onUserMediaSuccess=function(nt){cn.info("onUserMediaSuccess : User has granted access to local media."),this.accessToLocalMedia=!0;var vt=!1,Tt="Unknown",Pt=!1,wt="Unknown";this.localStream=nt,nt.getAudioTracks().length>0&&(vt=!0,nt.getAudioTracks()[0].label&&(Tt=nt.getAudioTracks()[0].label),cn.log("Using audio device: "+Tt)),nt.getVideoTracks().length>0&&(Pt=!0,nt.getVideoTracks()[0].label&&(wt=nt.getVideoTracks()[0].label),cn.log("Using video device: "+wt)),this.myWebRTC_Event.createUserMediaSuccessEvent(!1,vt,Tt,Pt,wt,"media",null,nt,null,!1)},this.onUserMediaError=function(nt){cn.info("onUserMediaError : Failed to get access to local media. Error : ",nt),cn.error(nt),this.accessToLocalMedia=!1,ot.$6!=="electron"&&ot.Xh==="Chrome"&&ot.PR>47&&(cn.log("browser_version > 47"),window.location.protocol!=="https:"&&cn.error("HTTPS is now mandatory to use getUserMedia()")),this.myWebRTC_Event.createUserMediaErrorEvent(!1,"media",nt,null,null,null,this.gum_config),nt=null,apiCC.session.tryAudioCallAfterUserMediaError===!0?(cn.log("this.lastUsedUserMediaConstraint :",this.lastUsedUserMediaConstraint),cn.log("this.lastUsedUserMediaConstraint.video :",this.lastUsedUserMediaConstraint.video),this.lastUsedUserMediaConstraint.video!==!1?(cn.log("this.lastUsedUserMediaConstraint.audio :",this.lastUsedUserMediaConstraint.audio),cn.log("UserMediaError, Trying to getUserMedia with audioOnly"),this.videoSourceId=null,this.gum_config.video=!1,this.getUserMedia()):cn.log("onUserMediaError without video")):cn.log("try AudioCall after UserMediaError is not activated")},this.evalCallProfileWithSdp=function(nt,vt,Tt){return this.evalCallProfileWithSdpGuideline(this.mySDPManager.createGuideline(nt),nt,vt,Tt)},this.evalCallProfileWithSdpGuideline=function(nt,vt,Tt,Pt){var wt={};return nt.hasOwnProperty("audio")?(wt.audio=!0,wt.audioActive=Tt==="local"&&Pt==="send"?nt.audio.direction==="sendrecv"||nt.audio.direction==="sendonly":Tt==="local"&&Pt==="receive"||Tt==="remote"&&Pt==="send"?nt.audio.direction==="sendrecv"||nt.audio.direction==="recvonly":Tt==="remote"&&Pt==="receive"&&(nt.audio.direction==="sendrecv"||nt.audio.direction==="sendonly")):(wt.audio=!1,wt.audioActive=!1),nt.hasOwnProperty("video")?(wt.video=!0,wt.videoActive=Tt==="local"&&Pt==="send"?nt.video.direction==="sendrecv"||nt.video.direction==="sendonly":Tt==="local"&&Pt==="receive"||Tt==="remote"&&Pt==="send"?nt.video.direction==="sendrecv"||nt.video.direction==="recvonly":Tt==="remote"&&Pt==="receive"&&(nt.video.direction==="sendrecv"||nt.video.direction==="sendonly")):(wt.video=!1,wt.videoActive=!1),wt},this.checkDestCallTypeWithSDP=function(nt,vt){cn.debug("checkDestCallTypeWithSDP");var Tt=this.mySDPManager.createGuideline(nt),Pt=!1,wt=!1;!Tt.audio||Tt.audio.direction!=="sendrecv"&&Tt.audio.direction!=="sendonly"||(Pt=!0),!Tt.video||Tt.video.direction!=="sendrecv"&&Tt.video.direction!=="sendonly"||(wt=!0),vt.destCallType=Pt===!0?wt===!0?"media":"audio":wt===!0?"videoOnly":"inactive",cn.debug("call.destCallType: "+vt.destCallType),vt.callee!==!0||Tt.audio&&Tt.audio.direction!=="sendonly"||Tt.video&&Tt.video.direction!=="sendonly"||(vt.userMediaAccessRequired=!1,vt.mediaTypeForOutgoingCall="NONE",cn.debug("access to user media not required"))},this.evaluateVideoCap=function(nt){delete nt.videoCap,nt.belongsToRoom()?nt.settingUpType!=="publish"&&nt.settingUpType!=="shareScreen"||nt.localCallProfile&&nt.localCallProfile.video&&nt.localCallProfile.videoActive&&this.evalOutgoingVideoBandwithCap(nt):(this.rtpSenderSetParamatersCapable||!nt.callee)&&nt.localCallProfile&&nt.localCallProfile.video&&nt.localCallProfile.videoActive&&this.evalOutgoingVideoBandwithCap(nt)},this.processInvite=function(nt){cn.info("processInvite() - invite received from :"+nt.callerId);var vt,Tt=0,Pt=null,wt=null,Dt=null,Et=null,jt=!1,Yt=null,en=null,Kt=null,rn={};if(nt.data!==void 0&&nt.data.type==="publish"&&nt.data.mesh!==void 0){if(cn.info("received invite publish mesh; mesh: "+JSON.stringify(nt.data.mesh)),(Pt=this.findCallWithCallIdAndInstanceId(nt.data.mesh.callerCallId,nt.data.instanceId))==null)return void cn.error("cannot find call; callId: "+nt.data.mesh.callerCallId);Pt.userMediaAccessRequired=!1,Pt.data.mesh=nt.data.mesh,Pt.setupTimeoutId&&(clearTimeout(Pt.setupTimeoutId),delete Pt.setupTimeoutId),jt=!0}else{if(nt.data!==void 0&&nt.data.type==="subscribe"&&nt.data.mesh!==void 0){if(cn.debug("received invite subscribe mesh; mesh: ",nt.data.mesh),(wt=this.findUserMediaById(nt.data.mesh.calleeCallId))!==null)if(this.MCUClient.distantCalls.push({early:!0,roomId:nt.roomId,clientId:nt.data.mesh.callerId,callId:nt.data.mesh.callerCallId,callMode:"mesh",callDirection:"recvonly",callFeed:{clientId:nt.data.mesh.calleeId,callId:nt.data.mesh.calleeCallId}}),setTimeout((function(un,Sn,En){cn.debug("early distant call descriptor timeout");for(var An=this.MCUClient.distantCalls.length;--An>=0;)if(this.MCUClient.distantCalls[An].early&&this.MCUClient.distantCalls[An].roomId===un&&this.MCUClient.distantCalls[An].clientId===Sn&&this.MCUClient.distantCalls[An].callId===En){cn.debug("remove early distant call descriptor: timeout"),this.MCUClient.distantCalls.splice(An,1);break}}).bind(this,nt.roomId,nt.data.callerId,nt.data.callerCallId),3e4),wt.callType==="screenSharing"||wt.callType==="screenSharingWithAudio")rn.type="publish",rn.mesh=nt.data.mesh,rn.instanceId=nt.data.instanceId,this.MCUClient.publishScreen(nt.roomId,rn,null,wt.captureSourceType);else{var hn=(0,ct.ws)({},wt.callConfiguration);nt.data.mediaType==="AUDIOONLY"?hn.audioOnly=!0:nt.data.mediaType==="VIDEOONLY"&&(hn.videoOnly=!0),(Dt=apiCC.getUserMediaStream(hn.userMediaStreamId))&&(Dt.audioMuted&&Dt.videoMuted?hn.muted="VIDEO":Dt.audioMuted?hn.muted="AUDIOONLY":Dt.videoMuted?hn.muted="VIDEOONLY":delete hn.muted),delete hn.distributedBroadcastEnabled,delete hn.simulcast,rn.type="publish",rn.mesh=nt.data.mesh,rn.instanceId=nt.data.instanceId,this.MCUClient.publish(nt.roomId,null,null,hn,rn,null)}else cn.debug("media not found: sending bye : Call_not_found"),new yt.S(apiCC.session.channel.socket).sendBye(nt.callId,nt.calleeId,nt.roomId,nt.callerId,"Call_not_found",nt.data);return}if(nt.data!==void 0&&nt.data.type==="publish"&&nt.data.mode==="passive"){if((Pt=this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.callerId,nt.data.instanceId))==null)return void cn.debug("cannot find call; callId: "+nt.callId+", callerId: "+nt.callerId+", instanceId: "+nt.data.instanceId);Pt.userMediaAccessRequired=!1,Pt.setupTimeoutId&&(clearTimeout(Pt.setupTimeoutId),delete Pt.setupTimeoutId),jt=!0}else(Pt=new Cn(this)).callId=nt.callId,Pt.instanceId=nt.data.instanceId,Pt.callerId=nt.callerId,Pt.calleeId=this.clientId,Pt.callee=!0,Pt.remoteId=nt.callerId}if(Pt.dest_roomId=nt.roomId,Pt.data!==void 0&&jt===!0)for(Kt in nt.data)nt.data.hasOwnProperty(Kt)&&(Pt.data[Kt]=nt.data[Kt]);else Pt.data=nt.data;if(Pt.data.instanceId=Pt.instanceId,nt.data!==void 0&&nt.data.pubSub==="sipConnector"&&(Pt.trickleIce=!1,Pt.remoteType="sip"),Pt.checkDTLSCompliancy(),ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome"&&(Yt=apiCC.session.getConnectedUserInfo(nt.callerId,"userData"),cn.log("destUserInfo :",Yt),Yt!=="User_Not_Found"&&Yt!==void 0&&(en=JSON.parse(Yt)).browser==="Chrome"&&en.osName==="Android"&&(cn.log("Browser is Edge and caller is Chrome on Android, setting VP8 as prefered codec for the call"),Pt.preferVP8Codec=!0)),nt.data!==void 0&&nt.data.type==="publish"&&nt.data.mode==="passive"&&nt.stream!==void 0&&nt.stream.id!==void 0&&(Pt.streamId=nt.stream.id,cn.log("call.streamId: "+Pt.streamId)),Tt=this.callsTable.length,cn.log("processInvite() - Actual call Number is :"+Tt),nt.callType==="screenSharing"||nt.callType==="screenSharingWithAudio")Pt.screenSharing=!0,Pt.callType=nt.callType;else if(nt.callType!=="data"){if(this.allowMultipleCalls===!1){for(cn.log("processInvite() - Refusing double call checking ..."),vt=0;vt<Tt;vt+=1)if(this.callsTable[vt].callType!=="screenSharing"&&this.callsTable[vt].callType!=="screenSharingWithAudio"&&this.callsTable[vt].callType!=="data")return cn.log("processInvite() - Refusing double call"),jt===!1?this.callsTable.push(Pt):cn.log("callAlreadyExist in table"),this.myWebRTC_Event.createCallAttemptEvent(this.clientId,nt.callerId,nt.callerNickname,Pt.callId),void this.refuseCall(Pt.callId,"User_Busy");cn.log("NOT Refusing double call")}}jt===!1?(Tt=this.callsTable.push(Pt),cn.log("processInvite() - New call Number is :"+Tt)):(cn.log("callAlreadyExist in table"),cn.log("processInvite() - call Number is :"+Tt)),this.checkDestCallTypeWithSDP(nt.sdpoffer.sdp,Pt);var an=this.mySDPManager.createGuideline(nt.sdpoffer.sdp);if(Pt.setLocalCallProfile(this.evalCallProfileWithSdpGuideline(an,nt.sdpoffer.sdp,"remote","send")),Pt.setRemoteCallProfile(this.evalCallProfileWithSdpGuideline(an,nt.sdpoffer.sdp,"remote","receive")),this.rtpSenderSetParamatersCapable||(this.evaluateVideoCap(Pt),Pt.videoCap&&(an.video.bandwidth=Pt.videoCap,nt.sdpoffer.sdp=an.generate())),Pt.receivedSdpOfferMessage=nt.sdpoffer,(0,ct.ki)(nt,"stream","object")&&(nt.stream.audioMuted===!0&&(Pt.isRemoteAudioMuted=!0),nt.stream.videoMuted===!0&&(Pt.isRemoteVideoMuted=!0)),nt.callType==="data"){if(cn.log("Receiving DATA call"),Pt.callType="data",Pt.dataCall=!0,ot.Xh==="Edge"&&ot.PR<79&&apiRTC.browserDetails.type!=="chrome")return cn.warn("Cannot create DataChannel as it is not supported on Edge"),void this.refuseCall(Pt.callId,"DataChannel_Not_Supported");this.userAcceptOnIncomingDataCall||Pt.onUserMediaSuccessTestUni(),this.myWebRTC_Event.createIncomingCallEvent(this.clientId,nt.callerId,nt.callerNickname,Pt.callId,!1,Tt,!1,nt.callType,!1,Pt.remoteType,Pt.destCallType)}else Pt.userMediaAccessRequired===!1||this.unidirectionelCallOnly||Pt.screenSharing===!0?(cn.log("call.userMediaAccessRequired :",Pt.userMediaAccessRequired),cn.log("this.unidirectionelCallOnly :",this.unidirectionelCallOnly),cn.log("call.screenSharing :",Pt.screenSharing),Pt.screenSharing===!0?this.userAcceptOnIncomingScreenSharingCall===!1?Pt.onUserMediaSuccessTestUni():cn.debug("userAcceptOnIncomingScreenSharingCall is activated : need user accept"):jt===!0?(cn.log("processInvite() - callAlreadyExist"),Pt.onUserMediaSuccessTestUni()):this.userAcceptOnIncomingCall===!0||this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?cn.log("processInvite() - Waiting for call accept or refuse from user - 1"):(cn.log("processInvite() - userAcceptOnIncomingCall is not activated"),Pt.onUserMediaSuccessTestUni()),nt.data!==void 0&&nt.data.subscribeOrder===!0||jt!==!1||this.myWebRTC_Event.createIncomingCallEvent(this.clientId,nt.callerId,nt.callerNickname,Pt.callId,!1,Tt,!1,nt.callType,!1,Pt.remoteType,Pt.destCallType)):(apiCC.userMediaStreamTable.length>0&&(Et=apiCC.userMediaStreamTable[0].userMediaStreamId),this.accessToLocalMedia!==!0&&!Et||this.autoAnswer!==!0?(Pt.audioOnly===!0&&apiCC.mediaDeviceMgr.audioDevicePresent===!1?(cn.log("processInvite() - audio and video media are not transmitted"),Pt.onUserMediaSuccessTestUni()):this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?cn.log("Stand-by :: wait for getUserMediaOnCall && establishCall"):(cn.debug("processInvite() - call.getUserMediaOnCall()"),cn.log("processInvite() - this.autoAnswer :"+this.autoAnswer),Pt.getUserMediaOnCall()),jt===!1&&this.myWebRTC_Event.createIncomingCallEvent(this.clientId,nt.callerId,nt.callerNickname,Pt.callId,!1,Tt,Pt.audioOnly,nt.callType,!1,Pt.remoteType,Pt.destCallType)):(cn.log("processInvite() :: User has already granted access to local media and AutoAnswer activated : establishing call"),this.userAcceptOnIncomingCall===!0||this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?cn.log("processInvite() - Waiting for call accept or refuse from user - 2"):Et?(cn.log("using First available stream on apiRTC"),(Dt=apiCC.getUserMediaStream(Et)).addCallInfo(Pt.callId),Pt.callConfiguration!==void 0&&Pt.callConfiguration!==null||(Pt.callConfiguration={}),Pt.callConfiguration.userMediaStreamId=Dt.userMediaStreamId,Pt.onUserMediaSuccessOnCall(Dt.stream)):Pt.establishCall(),jt===!1&&this.myWebRTC_Event.createIncomingCallEvent(this.clientId,nt.callerId,nt.callerNickname,Pt.callId,!0,Tt,Pt.audioOnly,nt.callType,!1,Pt.remoteType,Pt.destCallType)))},this.setRemoteDescriptionProcess=function(nt,vt){this.preferSendingH264Codec&&(cn.log("Modification of SDP to set H264 as prefered sending codec"),vt.sdp=this.mySDPManager.maybePreferCodec(vt.sdp,"video","H264")),ot.Xh==="Chrome"&&ot.PR<55||ot.Xh==="Firefox"&&ot.PR<50||ot.Xh==="IE"||typeof apiRTC_React<"u"?nt.pc!==null?nt.pc.setRemoteDescription(vt,nt.callback(nt,"onSetRemoteDescriptionSuccess"),nt.callback(nt,"onSetRemoteDescriptionFailure")):cn.debug("setRemoteDescriptionProcess - pc is null"):(cn.log("before setRemoteDescription - Promise version"),nt.pc!==null?nt.pc.setRemoteDescription(vt).then(nt.callback(nt,"onSetRemoteDescriptionSuccess")).catch(nt.callback(nt,"onSetRemoteDescriptionFailure")):cn.debug("setRemoteDescriptionProcess - pc is null"))},this.process200OK=function(nt){var vt,Tt=null,Pt=null;if(nt.data!==void 0&&nt.data.instanceId!==void 0?(cn.info("200OK received from callId :"+nt.calleeId+", intanceId is :"+nt.data.instanceId),Tt=this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.calleeId,nt.data.instanceId)):(cn.info("200OK received from callId :"+nt.calleeId),Tt=this.findCallWithCallIdAndRemoteId(nt.callId,nt.calleeId)),Tt===null)return cn.warn("200OK received but callId and instanceId are not matching, no process"),void this.myWebRTC_Event.createErrorEvent("200OK received but callId is not matching, no process","NOT_MATCHING_CALLID_ON_200OK");Tt.calleeId=nt.calleeId,nt.sdpanswer&&nt.sdpanswer.type!=="no-answer"?Tt.message200OKReceived===!1?(cn.debug("first 200OK for the call"),Tt.message200OKReceived=!0,Tt.data.type!=="subscribe"&&this.checkDestCallTypeWithSDP(nt.sdpanswer.sdp,Tt),vt=this.mySDPManager.createGuideline(nt.sdpanswer.sdp),Tt.setLocalCallProfile(this.evalCallProfileWithSdpGuideline(vt,nt.sdpanswer.sdp,"remote","send")),Tt.setRemoteCallProfile(this.evalCallProfileWithSdpGuideline(vt,nt.sdpanswer.sdp,"remote","receive")),this.evaluateVideoCap(Tt),!this.rtpSenderSetParamatersCapable&&Tt.videoCap&&(vt.video.bandwidth=Tt.videoCap,nt.sdpanswer.sdp=vt.generate()),Tt.receivedSdpOfferMessage=nt.sdpanswer,cn.log("process200OK : before setRemoteDescription"),Pt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(nt.sdpanswer),this.videoRemoteBandwidth&&(cn.log("Modification of SDP to set remote video bandwidth"),Pt.sdp=this.mySDPManager.setVideoBandwidth(Pt.sdp,this.videoRemoteBandwidth)),this.setRemoteDescriptionProcess(Tt,Pt),nt.data!==null&&nt.data!==void 0&&(Tt.data!==null&&Tt.data!==void 0?Tt.data=(0,ct.S6)(Tt.data,nt.data):Tt.data=nt.data)):cn.debug("200OK has already been received for this call, leaving process200OK"):Hn.createCallEstablishedEvent(Tt.calleeId,Tt.callType,Tt.callId,Tt.destCallType)},this.cleanStoredCallCandidate=function(nt,vt){cn.debug("cleanStoredCallCandidate from callId :"+nt+", instanceId is :"+vt),this.clientIncomingCandidatesQueue[nt+"-"+vt]!==void 0&&this.clientIncomingCandidatesQueue[nt+"-"+vt].length!==0&&(this.clientIncomingCandidatesQueue[nt+"-"+vt].splice(0,this.clientIncomingCandidatesQueue[nt+"-"+vt].length),delete this.clientIncomingCandidatesQueue[nt+"-"+vt])},this.processCandidate=function(nt){var vt=null,Tt=nt.data&&nt.data.instanceId?nt.data.instanceId:null;cn.debug("Candidate received from callId :"+nt.callId+", instanceId is :"+Tt),vt=nt.callerId===this.clientId?Tt?this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.calleeId,Tt):this.findCallWithCallIdAndRemoteId(nt.callId,nt.calleeId):Tt?this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.callerId,Tt):this.findCallWithCallIdAndRemoteId(nt.callId,nt.callerId),cn.trace("msg.label :"+nt.label),cn.log("msg.candidate :"+nt.candidate),vt!==null?vt.started&&vt.remoteDescriptionSetted?vt.processCandidateMsg(nt):(cn.log("Call not started or remoteDescription is not yet setted"),vt.incomingcandidatesQueue.push(nt)):Tt&&(cn.debug("Call not found, Candidate message is not handled, storing candidate message in client"),this.clientIncomingCandidatesQueue[nt.callId+"-"+Tt]!==null&&this.clientIncomingCandidatesQueue[nt.callId+"-"+Tt]!==void 0||(this.clientIncomingCandidatesQueue[nt.callId+"-"+Tt]=[],cn.debug("First candidate for this call, starting a timeout before candidate storage cleaning"),setTimeout(this.cleanStoredCallCandidate.bind(this),this.cleanStoredCallCandidateTimer,nt.callId,Tt)),this.clientIncomingCandidatesQueue[nt.callId+"-"+Tt].push(nt))},this.processUpdate=function(nt){cn.info("Update message on:"+nt.roomId);var vt,Tt=null;if((Tt=nt.callerId===this.clientId?this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.calleeId,nt.data.instanceId):this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.callerId,nt.data.instanceId))!==null)if(nt.hasOwnProperty("sdpoffer")&&nt.sdpoffer.hasOwnProperty("sdp"))Tt.setRemoteCallProfile(this.evalCallProfileWithSdp(nt.sdpoffer.sdp,"remote","receive"),!0),Tt.updateOngoingTimeoutId=setTimeout(function(){delete Tt.updateOngoingTimeoutId},Qn),this.checkDestCallTypeWithSDP(nt.sdpoffer.sdp,Tt),cn.log("processUpdate : before setRemoteDescription"),vt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(nt.sdpoffer),this.setRemoteDescriptionProcess(Tt,vt),Tt.doUpdateAnswer();else if((0,ct.ki)(nt.data,"mesh","object")&&(nt.data.mesh.calleeCompositeUserId?nt.data.mesh.calleeCompositeUserId===this.compositeClientId:nt.data.mesh.calleeId===this.clientId)){cn.debug("mesh update from subscriber");var Pt={};nt.data.mediaType==="AUDIOONLY"?Pt.audioOnly=!0:nt.data.mediaType==="VIDEOONLY"&&(Pt.videoOnly=!0),this.updateCallConfigurationOnCall(nt.callId,Pt).then(function(){cn.debug("updateCallConfigurationOnCall OK")}).catch(function(wt){cn.error("updateCallConfigurationOnCall failed",wt)})}else cn.error("update without SDP offer");else this.myWebRTC_Event.createErrorEvent("Cannot find call to process Update","CALL_NOT_FOUND_ON_UPDATE")},this.process200Update=function(nt){cn.info("200 Update received from :"+nt.calleeId);var vt,Tt=null,Pt=null;if((Tt=nt.callerId===this.clientId?this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.calleeId,nt.data.instanceId):this.findCallWithCallIdAndRemoteIdAndInstanceId(nt.callId,nt.callerId,nt.data.instanceId))===null)return cn.info("Call not found on 200 Update"),void this.myWebRTC_Event.createErrorEvent("Cannot find call to process 200 Update","CALL_NOT_FOUND_ON_200UPDATE");Tt.calleeId=nt.calleeId,vt=this.mySDPManager.createGuideline(nt.sdpanswer.sdp),Tt.setLocalCallProfile(this.evalCallProfileWithSdpGuideline(vt,nt.sdpanswer.sdp,"remote","send"),!0),Tt.setRemoteCallProfile(this.evalCallProfileWithSdpGuideline(vt,nt.sdpanswer.sdp,"remote","receive"),!0),this.evaluateVideoCap(Tt),!this.rtpSenderSetParamatersCapable&&Tt.videoCap&&(vt.video.bandwidth=Tt.videoCap,nt.sdpanswer.sdp=vt.generate()),cn.log("process200Update : before setRemoteDescription"),Pt=new apiCC.myWebRTC_Adapter.RTCSessionDescription(nt.sdpanswer),this.videoBandwidth&&(cn.log("Modification of SDP to set remote video bandwidth"),Pt.sdp=this.mySDPManager.setVideoBandwidth(Pt.sdp,this.videoBandwidth)),this.setRemoteDescriptionProcess(Tt,Pt),cn.log("msg.sdpanswer.sdp :",nt.sdpanswer.sdp),Tt.addingUserMedia===!0&&(Tt.addingUserMedia=!1),Tt.updateUserMedia===!0&&(Tt.updateUserMedia=!1),Tt.updateCause&&(Tt.updateCause=null)},this.processSlowLink=function(nt,vt){for(var Tt=this.callsTable.length,Pt=null;--Tt>=0;)if(this.callsTable[Tt].callId===nt){Pt=this.callsTable[Tt];break}if(Pt!==null){var wt=null;vt&&vt.advice&&(wt=vt.advice),this.myWebRTC_Event.createSlowLinkEvent(Pt.callId,wt)}},this.processAudioAmplitude=function(nt,vt){Hn.createAudioAmplitudeEvent(nt.descriptor.audioAmplitude,vt,nt.callId,nt.descriptor.streamID)},this.processDistantIceError=function(nt){nt.descriptor.iceState==="disconnected"?this.myWebRTC_Event.createErrorEvent("distant iceDisconnection detected","DISTANT_ICE_CONNECTION_STATE_DISCONNECTED",null,nt.roomId,null,nt.descriptor):nt.descriptor.iceState==="failed"&&Hn.createErrorEvent("distant iceConnection failed detected","DISTANT_ICE_CONNECTION_STATE_FAILED",null,nt.roomId,null,nt.descriptor)},this.processStreamTrackMuteChanged=function(nt,vt,Tt){for(var Pt=this.callsTable.length,wt=null,Dt=[],Et={},jt={};--Pt>=0;)if(this.callsTable[Pt].callId===nt){wt=this.callsTable[Pt];break}wt!==null&&(vt==="audio"?(wt.isRemoteAudioMuted=Tt,Dt.push("audioIsMuted"),Et.available=wt.remoteCallProfile.audio,Et.active=wt.remoteCallProfile.audioActive,Et.muted=wt.isRemoteAudioMuted,Et.silent=wt.isRemoteAudioSilent,jt.available=wt.remoteCallProfile.video,jt.active=wt.remoteCallProfile.videoActive,jt.muted=wt.isRemoteVideoMuted,jt.silent=wt.isRemoteVideoSilent):vt==="video"&&(wt.isRemoteVideoMuted=Tt,Dt.push("videoIsMuted"),Et.available=wt.remoteCallProfile.audio,Et.active=wt.remoteCallProfile.audioActive,Et.muted=wt.isRemoteAudioMuted,Et.silent=wt.isRemoteAudioSilent,jt.available=wt.remoteCallProfile.video,jt.active=wt.remoteCallProfile.videoActive,jt.muted=wt.isRemoteVideoMuted,jt.silent=wt.isRemoteVideoSilent),Dt.length>0&&this.myWebRTC_Event.createRemoteStreamUpdatedEvent(Dt,Et,jt,wt.destCallType,wt.callId,"userAction"))},this.processStreamTrackStatusChanged=function(nt,vt,Tt){for(var Pt=this.callsTable.length,wt=null,Dt=[],Et={},jt={};--Pt>=0;)if(this.callsTable[Pt].callId===nt){wt=this.callsTable[Pt];break}wt!==null&&(vt==="audio"?(wt.isRemoteAudioSilent=Tt,Dt.push("audioIsSilent"),Et.available=wt.remoteCallProfile.audio,Et.active=wt.remoteCallProfile.audioActive,Et.muted=wt.isRemoteAudioMuted,Et.silent=wt.isRemoteAudioSilent,jt.available=wt.remoteCallProfile.video,jt.active=wt.remoteCallProfile.videoActive,jt.muted=wt.isRemoteVideoMuted,jt.silent=wt.isRemoteVideoSilent):vt==="video"&&(wt.isRemoteVideoSilent=Tt,Dt.push("videoIsSilent"),Et.available=wt.remoteCallProfile.audio,Et.active=wt.remoteCallProfile.audioActive,Et.muted=wt.isRemoteAudioMuted,Et.silent=wt.isRemoteAudioSilent,jt.available=wt.remoteCallProfile.video,jt.active=wt.remoteCallProfile.videoActive,jt.muted=wt.isRemoteVideoMuted,jt.silent=wt.isRemoteVideoSilent),Dt.length>0&&this.myWebRTC_Event.createRemoteStreamUpdatedEvent(Dt,Et,jt,wt.destCallType,wt.callId,"userAction"))},this.processUpdateStream=function(nt,vt,Tt){for(var Pt=this.callsTable.length,wt=null;--Pt>=0;)if((0,ct.ki)(this.callsTable[Pt].data,"mesh","object")&&this.callsTable[Pt].data.mesh.calleeCallId===nt||this.callsTable[Pt].callId===nt){wt=this.callsTable[Pt];break}if(!wt)return!1;var Dt=!1;return vt==="audio"?Tt==="inactive"?wt.callType==="media"&&(wt.callType="videoOnly",wt.updateUserMedia=!0,wt.updateCause="adaptation",wt.audioSdpDirection="inactive",wt.establishCall(),Dt=!0):wt.callType==="videoOnly"&&(wt.callType="media",wt.updateUserMedia=!0,wt.updateCause="adaptation",wt.audioSdpDirection=null,wt.establishCall(),Dt=!0):vt==="video"&&(Tt==="inactive"?wt.callType==="media"&&(this.evalOutgoingVideoBandwithCap(wt),wt.callType="audio",wt.updateUserMedia=!0,wt.updateCause="adaptation",wt.videoSdpDirection="inactive",wt.establishCall(),Dt=!0):wt.callType==="audio"&&(this.evalOutgoingVideoBandwithCap(wt),wt.callType="media",wt.updateUserMedia=!0,wt.updateCause="adaptation",wt.videoSdpDirection=null,wt.establishCall(),Dt=!0)),Dt},this.processUpdateVideoQuality=function(nt,vt){cn.debug("processUpdateVideoQuality",nt,vt);var Tt=this.findCallWithCallId(nt);if(Tt)if(Tt.sessionMCU&&Tt.sessionMCU.roomMode!=="mesh"){var Pt=apiCC.getUserMediaStream(Tt.callConfiguration.userMediaStreamId);if(Pt){var wt=Pt.getVideoTrack();if(wt){var Dt={};vt.width&&vt.height&&(Dt.width=vt.width,Dt.height=vt.height),vt.frameRate&&(Dt.frameRate=vt.frameRate),wt.applyConstraints(Dt).then(function(Et){cn.debug("processUpdateVideoQuality - applyConstraints; OK")}).catch(function(Et){cn.error("processUpdateVideoQuality - applyConstraints",Et)})}else cn.warn("processUpdateVideoQuality - no such video track; callId:",nt)}else cn.warn("processUpdateVideoQuality - no such userMediaStream; callId:",nt)}else cn.warn("processUpdateVideoQuality - wrong roomMode; callId:",nt);else cn.warn("processUpdateVideoQuality - no such call; callId:",nt)},this.removeAllCallsFromRoom=function(nt,vt){cn.info("removeAllCallsFromRoom :"+nt+" with reason :"+vt);var Tt,Pt,wt=this.callsTable.length,Dt=[],Et={};for(Tt=0;Tt<wt;Tt+=1)this.callsTable[Tt].dest_roomId==nt&&(cn.log("Call is attached to the room, removing ..."),Et={callId:this.callsTable[Tt].callId},Dt.push(Et));for(Pt=0;Pt<Dt.length;Pt+=1)this.removeCallFromTableWithCallIdAndSendBye(Dt[Pt].callId,vt);Dt.splice(0,Dt.length)},this.onHangup=function(nt,vt){var Tt=null,Pt=null,wt=null,Dt=null,Et=[],jt=!1,Yt=!1,en=null,Kt=null;if(nt?typeof nt!="string"&&(nt=String(nt)):nt=null,vt?typeof vt!="string"&&(vt=null):vt=null,cn.info("Hanging up."),nt===null)cn.log("Leaving all calls that are established"),this.MCUClient&&this.MCUClient.meshOnHangup(),this.removeAllCalls(),this.callControlTable.splice(0,this.callControlTable.length);else if((Pt=this.findUserMediaById(nt))!==null){for(this.MCUClient.pubConnector!=="janusConnector"||vt!=="RTC_Setup_Timeout"&&vt!=="disconnected"||(wt=Pt.getUserMediaStream())&&wt.stream&&(jt=!0,en=wt.stream,Pt.streamStolen=!0,Pt.sessionMCU.roomMode==="mesh"?Yt=!0:(Kt=wt.getCallInfo(Pt.userMediaId))&&(Kt.flavor="call")),Dt=this.callsTable.length;--Dt>=0;)(0,ct.Ym)(this.callsTable[Dt].data,"object")&&(0,ct.Ym)(this.callsTable[Dt].data.mesh,"object")&&this.callsTable[Dt].data.mesh.calleeCallId===nt&&Et.push(this.callsTable[Dt].callId);for(Dt=Et.length;--Dt>=0;)this.removeCallFromTableWithCallIdAndSendBye(Et[Dt],vt);this.MCUClient.meshOnHangup(nt,null,{restart:jt})}else(Tt=this.findCallWithCallId(nt))!==null&&(this.MCUClient.pubConnector!=="janusConnector"||vt!=="RTC_Setup_Timeout"&&vt!=="disconnected"||(Tt.settingUpType==="publish"||Tt.settingUpType==="shareScreen"?Tt.data&&Tt.data.mesh||(jt=!0,Tt.streamStolen=!0):Tt.settingUpType==="subscribe"&&(jt=!0)),cn.log("Leaving call with callId :"+nt),this.removeCallFromTableWithCallIdAndSendBye(nt,vt));jt===!0?Tt!==null?this.restartCall(Tt):Pt&&(Yt===!0?this.restartCall(Pt,{userMedia:!0,mesh:!0}):this.restartCall(Pt,{userMedia:!0,stream:en})):(Tt&&Tt.callControl&&this.destroyCallControl(Tt.callControl),this.stopMaxCallRetriesTimer(nt),this.stopRestartCallTimer(nt),delete this.callsRetriesTable[nt])},this.stopStream=function(nt){cn.info("stopStream in client");var vt,Tt=null;if(ot.Xh==="Chrome"&&ot.PR<45||ot.Xh==="Firefox"&&ot.PR<44||ot.Xh==="Opera"&&ot.PR<34||ot.Xh==="Chromium"&&ot.PR<44||ot.Xh==="Chrome WebView"&&ot.PR<45)nt.onended=null,nt.stop();else{for(nt.onended=null,cn.log("MediaStream.stop is now deprecated, using MediaStreamTrack.stop"),Tt=nt.getTracks(),vt=0;vt<Tt.length;vt+=1)Tt[vt].onended=null,Tt[vt].stop();cn.log("... tracks stopped")}nt=null},this.clearCallTimeouts=function(nt){var vt;for(cn.debug("clearCallTimeouts"),nt.send200OKTrickleIceFalseTimeOutId!==0&&(cn.debug("clearing send200OKTrickleIceFalseTimeOutId"),clearTimeout(nt.send200OKTrickleIceFalseTimeOutId),nt.send200OKTrickleIceFalseTimeOutId=0),nt.sendInviteTrickleIceFalseTimeOutId!==0&&(cn.debug("clearing sendInviteTrickleIceFalseTimeOutId"),clearTimeout(nt.sendInviteTrickleIceFalseTimeOutId),nt.sendInviteTrickleIceFalseTimeOutId=0),nt.disconnectionTimeoutId!==0&&(cn.debug("clearing disconnectionTimeout"),clearTimeout(nt.disconnectionTimeoutId),nt.disconnectionTimeoutId=0),nt.disconnectionWarningInterval!==0&&(cn.debug("clearing disconnectionWarningInterval"),clearInterval(nt.disconnectionWarningInterval),nt.disconnectionWarningInterval=0),vt=0;vt<nt.checkCandidateTypesTimeoutTable.length;vt+=1)cn.debug("clearing checkCandidateTypesTimeout :",nt.checkCandidateTypesTimeoutTable[vt]),clearTimeout(nt.checkCandidateTypesTimeoutTable[vt]);nt.checkCandidateTypesTimeoutTable.splice(0,nt.checkCandidateTypesTimeoutTable.length)},this.removeAllCalls=function(){cn.info("removeAllCalls");var nt,vt=this.callsTable.length,Tt=0,Pt=null,wt=0,Dt=null;for(cn.log("callsNumber = "+vt),nt=0;nt<vt;nt+=1){if(Tt=this.callsTable[nt-wt].callee?this.callsTable[nt-wt].callerId:this.callsTable[nt-wt].calleeId,this.callsTable[nt-wt].callee===!0)Pt="Hangup_From_Callee",this.callsTable[nt-wt].myWebRTC_Stack.sendBye(this.callsTable[nt-wt].callId,this.clientId,this.callsTable[nt-wt].dest_roomId,Tt,Pt,this.callsTable[nt-wt].data);else{if(Pt="Hangup_From_Caller",this.callsTable[nt-wt].inviteSended!==!0){this.callsTable[nt-wt].callCancelled=!0,cn.warn("Leaving call iteration on removeAllCalls");continue}this.callsTable[nt-wt].myWebRTC_Stack.sendBye(this.callsTable[nt-wt].callId,this.clientId,this.callsTable[nt-wt].dest_roomId,Tt,Pt,this.callsTable[nt-wt].data)}(0,ct.ki)(this.callsTable[nt-wt].sessionMCU,"roomName","string")&&(0,ct.ki)(this.callsTable[nt-wt].data,"MCUType","string")&&(this.callsTable[nt-wt].data.MCUType==="MCU-Caller"||this.callsTable[nt-wt].data.MCUType==="MCU-Callee")&&this.MCUClient.leaveSession(this.callsTable[nt-wt].sessionMCU.roomName,{noHangup:!0}),this.callsTable[nt-wt].callConfiguration&&this.callsTable[nt-wt].callConfiguration.userMediaStreamId&&(Dt=apiCC.getUserMediaStream(this.callsTable[nt-wt].callConfiguration.userMediaStreamId))&&apiCC.releaseUserMediaStream(Dt.userMediaStreamId,this.callsTable[nt-wt].callId),this.callsTable[nt-wt].screenStream!==null&&(cn.log("stopping screenStream"),this.stopStream(this.callsTable[nt-wt].screenStream),Hn.createUserMediaStopEvent(this.callsTable[nt-wt].callId,"screen")),this.callsTable[nt-wt].pc!==null&&(cn.log("Closing PC"),this.qosEnable&&this.callsTable[nt-wt].qm!==void 0&&this.callsTable[nt-wt].qm!==null&&typeof this.callsTable[nt-wt].qm.saveStatsToDb=="function"&&(this.callsTable[nt-wt].qm.saveStatsToDb(!0),clearInterval(this.callsTable[nt-wt].statisticId)),this.callsTable[nt-wt].csmIntervalId&&clearInterval(this.callsTable[nt-wt].csmIntervalId),this.callsTable[nt-wt].pc.close(),this.callsTable[nt-wt].pc=null),this.myWebRTC_Event.createHangupEvent("local",this.clientId,this.callsTable[nt-wt].remoteId,!0,Pt,this.callsTable[nt-wt].callId,this.callsTable[nt-wt].callType),this.callsTable[nt-wt].data!==void 0&&this.callsTable[nt-wt].data!==null&&(this.callsTable[nt-wt].data.pubSub==="janusConnector"||this.callsTable[nt-wt].data.MCUType!=="MCU-Caller"&&this.callsTable[nt-wt].data.MCUType!=="MCU-Callee"||this.myWebRTC_Event.createRecordedStreamsAvailableEvent(this.callsTable[nt-wt].data.confId,this.callsTable[nt-wt].callerId,this.callsTable[nt-wt].calleeId,this.callsTable[nt-wt].callId)),this.clearCallTimeouts(this.callsTable[nt-wt]),this.callsTable[nt-wt].incomingcandidatesQueue.length!==0&&this.callsTable[nt-wt].incomingcandidatesQueue.splice(0,this.callsTable[nt-wt].incomingcandidatesQueue.length),this.clientIncomingCandidatesQueue[this.callsTable[nt-wt].callId+"-"+this.callsTable[nt-wt].instanceId]!==void 0&&this.clientIncomingCandidatesQueue[this.callsTable[nt-wt].callId+"-"+this.callsTable[nt-wt].instanceId].length!==0&&this.clientIncomingCandidatesQueue[this.callsTable[nt-wt].callId+"-"+this.callsTable[nt-wt].instanceId].splice(0,this.clientIncomingCandidatesQueue[this.callsTable[nt-wt].callId+"-"+this.callsTable[nt-wt].instanceId].length),cn.log("Removing call from table"),this.callsTable.splice(nt-wt,1),wt+=1}},this.onRemoteHangup=function(nt,vt,Tt,Pt,wt,Dt){var Et=this;cn.debug("onRemoteHangup");var jt=null,Yt=null,en=null,Kt=null,rn=!1,hn=!1,an=!1,un=null,Sn=null;if(cn.log("callId :"+nt),cn.log("confId :"+wt),this.MCUClient.pubConnector==="janusConnector")if(Pt==="RTC_Setup_Timeout"||Pt==="Broken_by_MCU"||Pt==="disconnected")if((Yt=Dt==null?this.findCallWithCallId(nt):this.findCallWithCallIdAndInstanceId(nt,Dt.instanceId))!=null){if(Yt.setupTimeoutId&&(clearTimeout(Yt.setupTimeoutId),delete Yt.setupTimeoutId),Yt.restarting===!0)return void cn.debug("call restarting");if(Yt.settingUpType==="publish"||Yt.settingUpType==="shareScreen"?Yt.data&&Yt.data.mesh||(rn=!0,Yt.streamStolen=!0):Yt.settingUpType==="subscribe"&&(rn=!0),Yt.sessionMCU!==null&&Yt.sessionMCU.modeChangeKind==="old")return void cn.debug("onRemoteHangup ignore")}else(en=this.findUserMediaById(nt))!==null?(en.close(),(Kt=en.getUserMediaStream())&&Kt.stream&&(en.sessionMCU!==null&&en.sessionMCU.modeChangeKind==="old"?(rn=!0,un=Kt.stream,en.streamStolen=!0,en.distantCalls.length>0&&(an=!0),(Sn=Kt.getCallInfo(en.userMediaId))&&(Sn.flavor="call")):en.sessionMCU!==null&&en.sessionMCU.roomMode==="mesh"?(rn=!0,hn=!0,un=Kt.stream,en.streamStolen=!0):(rn=!0,un=Kt.stream,en.streamStolen=!0,(Sn=Kt.getCallInfo(en.userMediaId))&&(Sn.flavor="call")))):cn.debug("No call and no userMedia found");else(Yt=Dt==null?this.findCallWithCallId(nt):this.findCallWithCallIdAndInstanceId(nt,Dt.instanceId))?(Yt.setupTimeoutId&&(clearTimeout(Yt.setupTimeoutId),delete Yt.setupTimeoutId),Yt.settingUpType==="subscribe"&&Pt!=="Ejected"&&(rn=!0)):(en=this.findUserMediaById(nt))&&en.close();if(!an)if(en!==null){var En=null,An=[];for(En=this.callsTable.length;--En>=0;)(0,ct.ki)(this.callsTable[En].data,"mesh","object")&&this.callsTable[En].data.mesh.calleeCallId===nt&&this.callsTable[En].settingUpType!=="subscribe"&&An.push(this.callsTable[En].callId);for(En=An.length;--En>=0;)this.removeCallFromTableWithCallIdAndSendBye(An[En],Pt);if(this.MCUClient.meshOnHangup(nt),en.sessionMCU.modeChangeKind==="old"){var Dn=this.MCUClient.getSessionMCU(null,{callback:function(Bn){return Bn.roomName===en.sessionMCU.roomName&&Bn.modeChangeKind==="new"}});Dn&&this.finalizeMeshToJanusTransition(en.sessionMCU,Dn)}}else nt!==void 0?jt=Dt==null?this.removeCallFromTableWithCallIdandRemoteId(nt,vt,Pt):this.removeCallFromTableWithCallIdandInstanceId(nt,Dt.instanceId,Pt):wt!==void 0&&(jt=this.removeCallFromTableWithConfIdandRemoteId(wt,vt,Pt));cn.log("Reason : "+Pt),Yt&&rn!==!0?this.callsTable.length===0&&this.userMediaTable.length===0?(cn.log("No more established calls for client"),this.myWebRTC_Event.createRemoteHangupEvent(this.clientId,vt,!0,Pt),this.myWebRTC_Event.createHangupEvent("remote",this.clientId,vt,!0,Pt,nt,jt),this.getUserMediaOnGoing===!0&&qt.deactivateReloadOnCancel!==!0&&(cn.log("Cancel from Remote"),typeof apiRTC_React>"u"&&location.reload(),this.getUserMediaOnGoing=!1)):(cn.log("Other calls are still established"),this.myWebRTC_Event.createRemoteHangupEvent(this.clientId,vt,!1,Pt),this.myWebRTC_Event.createHangupEvent("remote",this.clientId,vt,!1,Pt,nt,jt)):Yt&&Yt.settingUpType==="subscribe"&&(this.myWebRTC_Event.createRemoteHangupEvent(this.clientId,vt,!1,"restarted"),this.myWebRTC_Event.createHangupEvent("remote",this.clientId,vt,!1,"restarted",nt,jt)),Dt!=null&&(this.MCUClient.pubConnector==="janusConnector"||Dt.MCUType!=="MCU-Caller"&&Dt.MCUType!=="MCU-Callee"||this.myWebRTC_Event.createRecordedStreamsAvailableEvent(wt,this.clientId,vt,nt)),rn===!0?Yt!==null?this.restartCall(Yt):en&&(hn===!0?this.restartCall(en,{userMedia:!0,mesh:!0}):this.randomDelayOnRestart?(cn.debug("onRemoteHangup - randomDelayOnRestart"),setTimeout(function(){Et.restartCall(en,{userMedia:!0,stream:un})},5e3*Math.random())):this.restartCall(en,{userMedia:!0,stream:un})):(Yt&&Yt.callControl&&this.destroyCallControl(Yt.callControl),(Yt||en)&&(this.stopMaxCallRetriesTimer(nt),this.stopRestartCallTimer(nt),delete this.callsRetriesTable[nt]))},this.startMaxCallRetriesTimer=function(nt){var vt=this;cn.debug("startMaxCallRetriesTimer for callIdWhenStartingTimer :",nt);var Tt=setTimeout(function(){cn.debug("[restartCall] MaxCallRetriesTimer reached for callIdWhenStartingTimer :",nt),vt.callsRetriesTable[nt].allowedStatus=!1,delete vt.callsRetriesTable[nt].maxCallsRetriesDurationTimeOutId},this.maxCallsRetriesDuration);this.callsRetriesTable[nt]={},this.callsRetriesTable[nt].maxCallsRetriesDurationTimeOutId=Tt},this.stopMaxCallRetriesTimer=function(nt){cn.debug("stopMaxCallRetriesTimer for callId :",nt),this.callsRetriesTable[nt]!==void 0&&this.callsRetriesTable[nt].maxCallsRetriesDurationTimeOutId!==void 0&&(clearTimeout(this.callsRetriesTable[nt].maxCallsRetriesDurationTimeOutId),cn.debug("[restartCall] MaxCallRetriesTimer cleared for callId :",nt),delete this.callsRetriesTable[nt])},this.stopRestartCallTimer=function(nt){cn.debug("stopRestartCallTimer for callId :",nt),this.callsRetriesTable[nt]!==void 0&&this.callsRetriesTable[nt].restartCallTimeOutId!==void 0&&(clearTimeout(this.callsRetriesTable[nt].restartCallTimeOutId),cn.error("[restartCall] RestartCallTimer cleared for callId :",nt),delete this.callsRetriesTable[nt].restartCallTimeOutId)},this.restartCall=function(nt){var vt=this,Tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cn.debug("[restartCall] restartCall for callId :",nt.callId);var Pt=-1;if(Tt.userMedia!==!0)if(nt.callControl&&nt.callControl.autoRestart)if((Pt=nt.callControl.autoRestart.counter)===0&&(nt.callControl.autoRestart.callIdWhenStartingTimer=nt.callId,this.startMaxCallRetriesTimer(nt.callId)),this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer]!==void 0&&this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer].allowedStatus===void 0){cn.debug("[restartCall] ... for callIdWhenStartingTimer :",nt.callControl.autoRestart.callIdWhenStartingTimer),cn.debug("AutoRestartCounter :",Pt),cn.debug("Calling restartCallProcess in :",this.restartCallDelay*Math.pow(2,Pt));var wt=setTimeout(function(){cn.debug("Timer reached for restartCall"),delete nt.callControl.autoRestart.pending,vt.restartCallProcess(nt,Tt),vt.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer]!==void 0&&vt.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer].restartCallTimeOutId!==void 0&&delete vt.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer].restartCallTimeOutId},this.restartCallDelay*Math.pow(2,Pt));nt.callControl.autoRestart.pending=!0,this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer].restartCallTimeOutId=wt}else cn.warn("CALL_ABORTED, retries not allowed (maxCallsRetriesDuration reached) for callIdWhenStartingTimer :",nt.callControl.autoRestart.callIdWhenStartingTimer),this.destroyCallControl(nt.callControl),Hn.createErrorEvent("call aborted after calls retries (maxCallsRetriesDuration reached)","CALL_ABORTED",nt.callId,nt.callControl.roomName),this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer]!==void 0&&delete this.callsRetriesTable[nt.callControl.autoRestart.callIdWhenStartingTimer];else cn.debug("[restartCall] autoRestart options not defined");else this.restartCallProcess(nt,Tt)},this.restartCallProcess=function(nt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cn.debug("restartCallProcess ");var Tt=!1,Pt=!1,wt=null;if(nt.restarting!==!0){if(nt.restarting=!0,vt.userMedia===!0&&(Tt=!0),vt.mesh===!0&&(Pt=!0),Tt===!0)if(Pt===!0)nt.callType==="screenSharing"||nt.callType==="screenSharingWithAudio"?(nt.restarting=!1,this.userMediaTable.push(nt),this.MCUClient.meshOnScreenMediaSuccess(nt)):(nt.restarting=!1,this.userMediaTable.push(nt),this.MCUClient.meshOnUserMediaSuccess(nt));else if(nt.callType==="screenSharing"||nt.callType==="screenSharingWithAudio"){delete nt.data.meshPublish,nt.data.type="publish";var Dt=this.createCallControl({type:"shareScreen",callId:nt.userMediaId,roomName:nt.roomId,callConfiguration:nt.callConfiguration,data:nt.data});Dt.captureSourceType=nt.captureSourceType,Dt.autoRestart.counter=0,Dt.autoRestart.stream=vt.stream,this.shareScreen(nt.roomId,nt.data,nt.captureSourceType,nt.callConfiguration,{callControl:Dt}),this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.audioOnly,nt.userMediaId,nt.userMediaId,"publish",this.clientId,nt.roomId,nt.roomId,null)}else{delete nt.data.meshPublish;var Et=this.createCallControl({type:"publish",callId:nt.userMediaId,callType:nt.callType,roomName:nt.roomId,callConfiguration:nt.callConfiguration,data:nt.data});Et.audioOnly=nt.callType==="audio",Et.sessionId=nt.sessionId,Et.token=nt.token,Et.autoRestart.counter=0,Et.autoRestart.stream=vt.stream,this.MCUClient.publish(nt.roomId,nt.sessionId,nt.token,nt.callConfiguration,nt.data,{callControl:Et}),this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.callType==="audio",nt.userMediaId,nt.userMediaId,"publish",this.clientId,nt.roomId,nt.roomId,null)}else if(nt.settingUpType==="publish")(0,ct.Ym)(nt.callControl,"object")?(cn.debug("[restartCall] restarting call publish"),this.MCUClient.publish(nt.callControl.roomName,nt.callControl.sessionId,nt.callControl.token,nt.callControl.callConfiguration,nt.callControl.data,{callControl:nt.callControl}),this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.audioOnly,nt.callId,nt.callId,"publish",this.clientId,nt.callControl.roomName,nt.callControl.roomName,null)):cn.warn("[restartCall] cannot auto restart; missing info");else if(nt.settingUpType==="shareScreen")(0,ct.Ym)(nt.callControl,"object")?(cn.debug("[restartCall] restarting call shareScreen"),this.shareScreen(nt.callControl.roomName,nt.callControl.data,nt.callControl.captureSourceType,nt.callControl.callConfiguration,{callControl:nt.callControl}),this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.audioOnly,nt.callId,nt.callId,"publish",this.clientId,nt.callControl.roomName,nt.callControl.roomName,null)):cn.warn("[restartCall] cannot auto restart; missing info");else if(nt.settingUpType==="subscribe"&&(cn.debug("[restartCall] restarting call subscribe"),wt=nt.mcuRemoteStream.replay===!0?this.MCUClient.getStreamOfUserCall(nt.mcuRemoteStream.attributes.callerId,nt.mcuRemoteStream.attributes.callId,{replay:!0}):this.MCUClient.getStreamOfUserCall(nt.mcuRemoteStream.attributes.callerId,nt.mcuRemoteStream.attributes.callId),(0,ct.Ym)(nt.callControl,"object")&&wt)){cn.debug("[restartCall] stream exists, subscribing to it");var jt=!!nt.callControl.autoRestart.force;delete nt.callControl.autoRestart.force;var Yt=nt.callControl.callId,en=this.MCUClient.subscribeToStreams([wt],nt.callControl.mediaType,nt.callControl.data,nt.callControl.callConfiguration,{noStreamCheck:!0,autoSub:!0,force:jt});Yt&&en[0]&&this.myWebRTC_Event.createCallRestartingEvent(nt.callType,nt.audioOnly,Yt,en[0],"subscribe",this.clientId,nt.callControl.roomName,nt.callControl.roomName,wt.id)}}else cn.debug("[restartCall] call already restarting")},this.closingCallProcess=function(nt,vt){cn.log("Session terminated.");var Tt=null;(0,ct.ki)(this.callsTable[nt].sessionMCU,"roomName","string")&&(0,ct.ki)(this.callsTable[nt].data,"MCUType","string")&&(this.callsTable[nt].data.MCUType==="MCU-Caller"||this.callsTable[nt].data.MCUType==="MCU-Callee")&&this.MCUClient.leaveSession(this.callsTable[nt].sessionMCU.roomName),this.callsTable[nt].callConfiguration&&this.callsTable[nt].callConfiguration.userMediaStreamId&&this.callsTable[nt].streamStolen!==!0&&(Tt=apiCC.getUserMediaStream(this.callsTable[nt].callConfiguration.userMediaStreamId))&&apiCC.releaseUserMediaStream(Tt.userMediaStreamId,this.callsTable[nt].callId),this.callsTable[nt].screenStream!==null&&(cn.log("stopping screenStream"),this.stopStream(this.callsTable[nt].screenStream),Hn.createUserMediaStopEvent(this.callsTable[nt].callId,"screen")),this.callsTable[nt].pc!==null&&(cn.log("Closing PC"),this.qosEnable&&this.callsTable[nt].qm!==void 0&&this.callsTable[nt].qm!==null&&typeof this.callsTable[nt].qm.saveStatsToDb=="function"&&(this.callsTable[nt].qm.saveStatsToDb(!0),clearInterval(this.callsTable[nt].statisticId)),this.callsTable[nt].csmIntervalId&&clearInterval(this.callsTable[nt].csmIntervalId),this.callsTable[nt].beginTimeoutId&&(clearTimeout(this.callsTable[nt].beginTimeoutId),delete this.callsTable[nt].beginTimeoutId),this.callsTable[nt].dcfs?vt==="Ice_failed"?this.callsTable[nt].dcfs.failure="iceFailed":this.callsTable[nt].dcfs.canceled=!0:this.callsTable[nt].callType==="data"&&this.callsTable[nt].calleeId==="dataChannelConnector"&&(this.callsTable[nt].failure||this.callsTable[nt].success||setTimeout(function(Pt,wt){Hn.createEvent({eventType:"onFileSended",callId:Pt.callId,remoteId:Pt.remoteId,name:Pt.data.filename,error:wt}),Pt.callbacks&&Pt.callbacks.failure&&Pt.callbacks.failure(wt)},0,this.callsTable[nt],vt==="Ice_failed"?"iceFailed":"canceled")),this.callsTable[nt].pc.close(),this.callsTable[nt].pc=null)},this.removeCallProcess=function(nt){var vt=this,Tt=this.callsTable[nt];this.clearCallTimeouts(Tt),Tt.incomingcandidatesQueue.length!==0&&Tt.incomingcandidatesQueue.splice(0,Tt.incomingcandidatesQueue.length),this.clientIncomingCandidatesQueue[Tt.callId+"-"+Tt.instanceId]!==void 0&&this.clientIncomingCandidatesQueue[Tt.callId+"-"+Tt.instanceId].length!==0&&this.clientIncomingCandidatesQueue[Tt.callId+"-"+Tt.instanceId].splice(0,this.clientIncomingCandidatesQueue[Tt.callId+"-"+Tt.instanceId].length),cn.log("Removing call from table"),this.callsTable.splice(nt,1),cn.log("this.callsTable.length :",this.callsTable.length),cn.log("Call is terminated"),setTimeout(function(){vt.startNextPushData()}),this.evalOutgoingVideoBandwithCap()},this.removeCallFromTableWithCallIdAndSendBye=function(nt,vt){cn.debug("removeCallFromTableWithCallIdAndSendBye()",nt);var Tt,Pt=null;if((Tt=this.findCallIndexWithCallId(nt))!==-1){if(this.closingCallProcess(Tt,vt),this.callsTable[Tt].callId,this.callsTable[Tt].calleeId,this.callsTable[Tt].callee?(Pt=this.callsTable[Tt].callerId,vt===null&&(vt="Hangup_From_Callee")):(Pt=this.callsTable[Tt].calleeId,vt===null&&(vt="Hangup_From_Caller")),cn.log("reason is :"+vt),this.callsTable[Tt].calleeId!=="LOCAL"&&apiCC.session!==null){var wt=apiCC.session.getConnectedUserInfo(this.callsTable[Tt].calleeId,"userData"),Dt=null;if(wt!=="User_Not_Found")try{Dt=JSON.parse(wt)}catch{cn.error("userInfo parse fail",wt)}Dt!=null&&Dt.isSimulated==="true"?apiCC.session.channel.socket.emit("simulatedAgentCancelCallRequest",{number:this.callsTable[Tt].calleeId,callId:nt}):this.callsTable[Tt].myWebRTC_Stack.sendBye(this.callsTable[Tt].callId,this.clientId,this.callsTable[Tt].dest_roomId,Pt,vt,this.callsTable[Tt].data)}vt!=="Broken_by_MCU"&&this.myWebRTC_Event.createHangupEvent("local",this.clientId,this.callsTable[Tt].remoteId,!0,vt,this.callsTable[Tt].callId,this.callsTable[Tt].callType),this.callsTable[Tt].data!==void 0&&this.callsTable[Tt].data!==null&&(this.callsTable[Tt].data.pubSub==="janusConnector"||this.callsTable[Tt].data.MCUType!=="MCU-Caller"&&this.callsTable[Tt].data.MCUType!=="MCU-Callee"||this.myWebRTC_Event.createRecordedStreamsAvailableEvent(this.callsTable[Tt].data.confId,this.callsTable[Tt].callerId,this.callsTable[Tt].calleeId,this.callsTable[Tt].callId)),this.removeCallProcess(Tt)}else cn.log("No call removed");this.MCUClient.publishCallId===nt&&(this.publishCallId=null)},this.removeCall=function(nt){cn.info("removeCall");var vt=null;return nt!==-1?(this.closingCallProcess(nt,null),this.callsTable[nt].disconnectionWarningTimeout!==0&&(cn.debug("clearing disconnectionWarningTimeout"),clearTimeout(this.callsTable[nt].disconnectionWarningTimeout),this.callsTable[nt].disconnectionWarningTimeout=0),vt=this.callsTable[nt].callType,this.removeCallProcess(nt)):cn.debug("No call removed"),vt},this.removeCallFromTableWithConfIdandRemoteId=function(nt,vt,Tt){var Pt;return cn.debug("removeCallFromTableWithConfIdandRemoteId() with reason :"+Tt),Tt=null,Pt=this.findCallIndexWithConfIdAndRemoteId(nt,vt),this.removeCall(Pt)},this.removeCallFromTableWithCallIdandRemoteId=function(nt,vt,Tt){var Pt;return cn.debug("removeCallFromTableWithCallIdandRemoteId() with reason :"+Tt),cn.log("callId :"+nt),cn.log("remoteId :"+vt),Tt=null,Pt=this.findCallIndexWithCallIdAndRemoteId(nt,vt),this.removeCall(Pt)},this.removeCallFromTableWithCallIdandInstanceId=function(nt,vt,Tt){var Pt;return cn.debug("removeCallFromTableWithCallIdandInstanceId() with reason :"+Tt),cn.log("callId :"+nt),cn.log("instanceId :"+vt),Tt=null,Pt=this.findCallIndexWithCallIdAndInstanceId(nt,vt),this.removeCall(Pt)},this.toggleVideoMute=function(nt){cn.debug("toggleVideoMute");var vt,Tt,Pt=this.callsTable.length,wt=null,Dt=null;if(nt==null){for(cn.debug("no callId defined, toggleVideoMute all local video"),this.isVideoMuted?this.localStream!==null&&(cn.debug("localStream unMuteTracks"),this.unMuteTracks(this.localStream.getVideoTracks())):this.localStream!==null&&(cn.debug("localStream muteTracks"),this.muteTracks(this.localStream.getVideoTracks())),this.isVideoMuted=!this.isVideoMuted,vt=0;vt<Pt;vt+=1)this.callsTable[vt].data&&this.callsTable[vt].data.mesh||(Dt=null,this.callsTable[vt].callConfiguration&&(Dt=apiCC.getUserMediaStream(this.callsTable[vt].callConfiguration.userMediaStreamId)),Dt?Dt.videoMuted?Dt.unMuteVideoOnStreams("enabled"):Dt.muteVideoOnStreams("enabled"):this.callsTable[vt].callLocalStream!==null&&(this.callsTable[vt].isLocalVideoMuted?(cn.debug("unmuting call :",this.callsTable[vt].callId),this.unMuteTracks(this.callsTable[vt].callLocalStream.getVideoTracks())):(cn.debug("muting call :",this.callsTable[vt].callId),this.muteTracks(this.callsTable[vt].callLocalStream.getVideoTracks())),this.callsTable[vt].isLocalVideoMuted=!this.callsTable[vt].isLocalVideoMuted));for(Pt=this.userMediaTable.length,vt=0;vt<Pt;vt+=1)Dt=null,this.userMediaTable[vt].callConfiguration&&(Dt=apiCC.getUserMediaStream(this.userMediaTable[vt].callConfiguration.userMediaStreamId)),Dt&&(Dt.videoMuted?Dt.unMuteVideoOnStreams("enabled"):Dt.muteVideoOnStreams("enabled"));return{muteState:this.isVideoMuted,callId:"ALL"}}return cn.debug("callId is defined :",nt),(Tt=this.findCallIndexWithCallId(nt))>=0?(this.callsTable[Tt].callConfiguration&&(Dt=apiCC.getUserMediaStream(this.callsTable[Tt].callConfiguration.userMediaStreamId)),Dt?(Dt.videoMuted?Dt.unMuteVideoOnStreams("enabled"):Dt.muteVideoOnStreams("enabled"),{muteState:Dt.videoMuted,callId:nt}):this.callsTable[Tt].callLocalStream!==null?(this.callsTable[Tt].isLocalVideoMuted?(cn.debug("unmuting call :",this.callsTable[Tt].callId),this.unMuteTracks(this.callsTable[Tt].callLocalStream.getVideoTracks())):(cn.debug("muting call :",this.callsTable[Tt].callId),this.muteTracks(this.callsTable[Tt].callLocalStream.getVideoTracks())),this.callsTable[Tt].isLocalVideoMuted=!this.callsTable[Tt].isLocalVideoMuted,{muteState:this.callsTable[Tt].isLocalVideoMuted,callId:nt}):{muteState:"STREAM_NOT_FOUND",callId:nt}):(wt=this.findUserMediaById(nt))&&(wt.callConfiguration&&(Dt=apiCC.getUserMediaStream(wt.callConfiguration.userMediaStreamId)),Dt)?(Dt.videoMuted?Dt.unMuteVideoOnStreams("enabled"):Dt.muteVideoOnStreams("enabled"),{muteState:Dt.videoMuted,callId:nt}):{muteState:"CALL_NOT_FOUND",callId:nt}},this.unMuteTracks=function(nt){var vt;if(nt.length!==0){for(vt=0;vt<nt.length;vt+=1)nt[vt].enabled=!0;cn.log("tracks unMuted.")}else cn.log("No tracks available.")},this.muteTracks=function(nt){var vt;if(nt.length!==0){for(vt=0;vt<nt.length;vt+=1)nt[vt].enabled=!1;cn.log("tracks muted.")}else cn.log("No tracks available.")},this.toggleAudioMute=function(nt){cn.debug("toggleAudioMute");var vt,Tt,Pt=this.callsTable.length,wt=null,Dt=null;if(nt==null){for(cn.debug("no callId defined, toggleAudioMute all local audio"),this.isAudioMuted?this.localStream!==null&&(cn.debug("localStream unMuteTracks"),this.unMuteTracks(this.localStream.getAudioTracks())):this.localStream!==null&&(cn.debug("localStream muteTracks"),this.muteTracks(this.localStream.getAudioTracks())),this.isAudioMuted=!this.isAudioMuted,vt=0;vt<Pt;vt+=1)this.callsTable[vt].data&&this.callsTable[vt].data.mesh||(Dt=null,this.callsTable[vt].callConfiguration&&(Dt=apiCC.getUserMediaStream(this.callsTable[vt].callConfiguration.userMediaStreamId)),Dt?Dt.audioMuted?Dt.unMuteAudioOnStreams("enabled"):Dt.muteAudioOnStreams("enabled"):this.callsTable[vt].callLocalStream!==null&&(this.callsTable[vt].isLocalAudioMuted?(cn.debug("unmuting call :",this.callsTable[vt].callId),this.unMuteTracks(this.callsTable[vt].callLocalStream.getAudioTracks())):(cn.debug("muting call :",this.callsTable[vt].callId),this.muteTracks(this.callsTable[vt].callLocalStream.getAudioTracks())),this.callsTable[vt].isLocalAudioMuted=!this.callsTable[vt].isLocalAudioMuted));for(Pt=this.userMediaTable.length,vt=0;vt<Pt;vt+=1)Dt=null,this.userMediaTable[vt].callConfiguration&&(Dt=apiCC.getUserMediaStream(this.userMediaTable[vt].callConfiguration.userMediaStreamId)),Dt&&(Dt.audioMuted?Dt.unMuteAudioOnStreams("enabled"):Dt.muteAudioOnStreams("enabled"));return{muteState:this.isAudioMuted,callId:"ALL"}}return cn.debug("callId is defined :",nt),(Tt=this.findCallIndexWithCallId(nt))>=0?(this.callsTable[Tt].callConfiguration&&(Dt=apiCC.getUserMediaStream(this.callsTable[Tt].callConfiguration.userMediaStreamId)),Dt?(Dt.audioMuted?Dt.unMuteAudioOnStreams("enabled"):Dt.muteAudioOnStreams("enabled"),{muteState:Dt.audioMuted,callId:nt}):this.callsTable[Tt].callLocalStream!==null?(this.callsTable[Tt].isLocalAudioMuted?(cn.debug("unmuting call :",this.callsTable[Tt].callId),this.unMuteTracks(this.callsTable[Tt].callLocalStream.getAudioTracks())):(cn.debug("muting call :",this.callsTable[Tt].callId),this.muteTracks(this.callsTable[Tt].callLocalStream.getAudioTracks())),this.callsTable[Tt].isLocalAudioMuted=!this.callsTable[Tt].isLocalAudioMuted,{muteState:this.callsTable[Tt].isLocalAudioMuted,callId:nt}):{muteState:"STREAM_NOT_FOUND",callId:nt}):(wt=this.findUserMediaById(nt))&&(wt.callConfiguration&&(Dt=apiCC.getUserMediaStream(wt.callConfiguration.userMediaStreamId)),Dt)?(Dt.audioMuted?Dt.unMuteAudioOnStreams("enabled"):Dt.muteAudioOnStreams("enabled"),{muteState:Dt.audioMuted,callId:nt}):{muteState:"CALL_NOT_FOUND",callId:nt}},this.sendDTMF=function(nt,vt,Tt,Pt){cn.debug("sendDTMF");var wt=0;nt!=null?(cn.debug("callId is defined :",nt),wt=this.findCallIndexWithCallId(nt),cn.debug("index :",wt),wt>=0&&(cn.debug("index :",wt),this.callsTable[wt].sendTones(vt,Tt,Pt))):cn.debug("no callId defined, leaving sendDTMF")},this.xhr=function(nt,vt,Tt,Pt){var wt=new XMLHttpRequest;wt.onreadystatechange=function(){wt.readyState===4&&wt.status===200&&Tt(wt.responseText)},Pt!==void 0&&(wt.upload.onprogress=Pt),wt.open("POST",nt),wt.send(vt)},this.takeSnapshot=function(nt,vt,Tt,Pt,wt,Dt,Et){var jt=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{};cn.info("takeSnapshot");var Yt,en=null,Kt=null,rn=document.createElement("canvas"),hn=null,an=null,un=new Date,Sn=un.toJSON(),En=Sn.replace(new RegExp(":","g"),"-"),An=null;switch(Pt){case"Desactivated":Yt=0;break;case"Low":Yt=2;break;case"Medium":Yt=4;break;case"High":Yt=6;break;default:cn.log("blurLevel not defined switch case : "+Pt),Yt=0}return Et===void 0?(cn.warn("ApiRTC DEPRECATED : Please add videoId for TakeSnapshot"),cn.log("Leaving takeSnapshot"),void this.myWebRTC_Event.createErrorEvent("Deprecated - localVideo Div Name is not correct for takeSnapshot","INCORRECT_VIDEOID_FOR_SNAPSHOT")):(cn.log("takeSnapshot of defined video Id :"+Et),(An=document.getElementById(Et))===null?(cn.log("Cannot find video with Id :"+Et),cn.log("Leaving takeSnapshot"),void this.myWebRTC_Event.createErrorEvent("localVideo Div Name is not correct for takeSnapshot","INCORRECT_VIDEOID_FOR_SNAPSHOT")):(rn.width=An.videoWidth,rn.height=An.videoHeight,jt.hasOwnProperty("width")&&(cn.debug("options.width is set :"+jt.width),rn.width=jt.width),jt.hasOwnProperty("height")&&(cn.debug("options.height is set :"+jt.height),rn.height=jt.height),cn.log("snapshot.width : "+rn.width),cn.log("snapshot.height :"+rn.height),(en=rn.getContext("2d")).drawImage(An,0,0,rn.width,rn.height),(Kt=document.createElement("img")).src=rn.toDataURL("image/png"),Kt.style.padding=5,Kt.width=rn.width,Kt.height=rn.height,Yt!==0?(cn.log("Adding Blur on Photo"),hn=en.getImageData(0,0,rn.width,rn.height),cn.log("av pixels data : "+hn.data),hn=Rt(Kt,hn,Yt),cn.log("ap pixels data : "+hn.data),en.putImageData(hn,0,0),Kt.src=rn.toDataURL("image/png")):cn.log("blur on photo is desactivated"),tr(vt)==="object"?vt!==null?vt.src=Kt.src:cn.log("localPhotoIdOrDiv is null"):document.getElementById(vt)!==null?document.getElementById(vt).src=Kt.src:cn.log("localPhotoId is not defined"),an=new FormData,wt!==void 0?(cn.log("sessionId !== undefined :"+wt),an.append("destFileName",this.clientId+"-"+En+".png"),an.append("data",rn.toDataURL("image/png")),an.append("sessionId",wt)):(cn.log("Upload on data1"),an.append("photo",rn.toDataURL("image/png")),an.append("clientId",this.clientId),an.append("apiKey",apiCC.session.apiKey)),void this.xhr(nt,an,function(Dn){if(cn.log("fileName :",Dn),Dn!==null)try{var Bn=JSON.parse(Dn);Bn.resultCode==="OK"&&(cn.log("files loaded, filename :"+Bn.fileUrl),Hn.createSnapShotPhotoUploaded(Bn.fileUrl))}catch(sr){cn.log("Parsing error:",sr)}Dn!=="Photo received"&&Dn!=="An error occurred."&&Dn.substring(0,6)!=="Photo-"||Hn.createSnapShotPhotoUploaded(Dn)},Dt)))},this.takeSnapshotAndSendOnDataChannel=function(nt,vt,Tt,Pt){cn.info("takeSnapshotAndSendOnDataChannel");var wt,Dt=null,Et=document.createElement("canvas"),jt=null;if(vt!==void 0){if(cn.log("takeSnapshot of defined video Id :"+vt),(jt=document.getElementById(vt))===null)return cn.log("Cannot find video with Id :"+vt),cn.log("Leaving takeSnapshot"),void this.myWebRTC_Event.createErrorEvent("localVideo Div Name is not correct for takeSnapshot","INCORRECT_VIDEOID_FOR_SNAPSHOT")}else cn.warn("ApiRTC DEPRECATED : Please add videoId for TakeSnapshot");jt!=null&&(Et.width=jt.clientWidth,Et.height=jt.clientHeight),cn.log("snapshot.width : "+Et.width),cn.log("snapshot.height :"+Et.height),Et.getContext("2d").drawImage(jt,0,0,Et.width,Et.height),(Dt=document.createElement("img")).src=Et.toDataURL("image/png"),Dt.style.padding=5,Dt.width=Et.width,Dt.height=Et.height,tr(nt)==="object"?nt!==null?nt.src=Dt.src:cn.log("localPhotoIdOrDiv is null"):document.getElementById(nt)!==null?document.getElementById(nt).src=Dt.src:cn.log("localPhotoId is not defined"),wt=Et.toDataURL("image/png"),this.sendDataWithCallId(Tt,{file:wt,name:"nomFichier",type:"image/png-dataUrl"},Pt)},this.callWithNumber=function(nt,vt,Tt,Pt){cn.info("Click on Call Button, video activated : "+vt),cn.log("callConfiguration : ",Pt);var wt=null,Dt=0,Et=null,jt=null,Yt=null,en=null,Kt=null;if(typeof nt=="number"&&(cn.log("called number type is number, converting to string"),nt=nt.toString()),nt!==""&&nt!==this.clientId){if((wt=new Cn(this)).instanceId=apiCC.generateInstanceId(),cn.log("Calling destination number :"+nt),Pt==null||Pt.apzcallId===void 0||Pt.apzcallId===null?wt.generateCallId():wt.callId=Pt.apzcallId,apiCC.isSIPNumber(nt)===!0?(cn.log("Prefix 0 , + , or 'sip:' detected, calling a SIP device"),nt.toString().startsWith("sip:")===!0&&(nt=nt.toString().replace("sip:",""),cn.log("called SIP number is :",nt)),Tt!=null?Tt.pubSub="sipConnector":(Tt={}).pubSub="sipConnector",wt.trickleIce=!1):cn.log("Establishing Web call"),wt.callerId=this.clientId,wt.calleeId=nt,wt.dest_roomId=nt,wt.audioOnly=!vt,wt.remoteId=nt,wt.callConfiguration=Pt,Pt!=null?(Pt.mediaTypeForOutgoingCall==="VIDEO"||Pt.mediaTypeForOutgoingCall==="AUDIO"||Pt.mediaTypeForOutgoingCall==="VIDEOONLY"||Pt.mediaTypeForOutgoingCall==="NONE"?(cn.log("Setting mediaTypeForOutgoingCall :"+Pt.mediaTypeForOutgoingCall),wt.mediaTypeForOutgoingCall=Pt.mediaTypeForOutgoingCall):(cn.log("mediaTypeForOutgoingCall is not set"),vt===!1&&(cn.log("videoActivated is false, setting mediaTypeForOutgoingCall to AUDIO"),wt.mediaTypeForOutgoingCall="AUDIO")),Pt.mediaRoutingMode!==void 0&&Pt.mediaRoutingMode!==null&&wt.setCallMediaRoutingMode(Pt.mediaRoutingMode),Pt.turnServerAddress!==void 0&&Pt.turnServerAddress!==null&&wt.setCallTurnServer(Pt.turnServerAddress),Pt.preferVP9Codec!==!0&&Pt.preferVP9Codec!==!1||(wt.preferVP9Codec=Pt.preferVP9Codec),Pt.hasOwnProperty("forceCallType")&&(wt.callType=Pt.forceCallType,wt.callType!=="screenSharing"&&wt.callType!=="screenSharingWithAudio"||(wt.screenSharing=!0))):cn.log("callConfiguration is not set"),Tt!==void 0&&Tt.MCUType!==void 0&&(Tt.MCUType!=="MCU-Caller"&&Tt.MCUType!=="MCU-Callee"||(this.MCUClient.pubConnector==="janusConnector"&&ot.Xh==="Firefox"&&(ot.PR>43?wt.mediaConstraints={offerToReceiveAudio:!1,offerToReceiveVideo:!1}:wt.mediaConstraints={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}}),Tt.pubSub=this.MCUClient.pubConnector,Tt.videoBandwidthSettings=this.videoBandwidthSettings,Tt.pubSub==="groupKurentoConnector"&&(Tt.pubSub="kurentoConnector"))),wt.checkDTLSCompliancy(),Et=wt.callId,jt=apiCC.session.getConnectedUserInfo(nt,"userData"),cn.log("userInfo :",jt),jt!=="User_Not_Found"&&jt!==void 0&&(Yt=JSON.parse(jt))!==void 0&&Yt.react==="true"&&(cn.log("userInfoJson.react :",JSON.stringify(Yt.react)),cn.log("userInfoJson.osName :",JSON.stringify(Yt.osName)),Yt.osName==="iOS"&&(cn.log("Callee : React and iOS detected, setting H264 as preferred codec for the call"),wt.preferH264Codec=!0)),wt.audioOnly===!0&&(wt.callType="audio"),Tt!==void 0?wt.data=Tt:Tt={},Tt.convId&&(Tt.cloudConvId||(Tt.cloudConvId=Tt.convId),delete Tt.convId),Tt.dataCall===!0&&(wt.dataCall=!0),wt.data.instanceId=wt.instanceId,Dt=this.callsTable.push(wt),cn.log("Call Number is :"+Dt),wt.data&&wt.data.MCUType==="MCU-Caller"&&wt.mediaTypeForOutgoingCall==="NONE")return wt.inviteSended=!0,wt.myWebRTC_Stack.sendInvite(wt.callId,wt.callerId,this.nickname,wt.dest_roomId,wt.dest_roomId,"none",{offer:{type:"no-offer"},data:wt.data}),wt.callId;wt.data&&wt.data.MCUType==="MCU-Caller"&&(wt.settingUpType="publish",wt.callControl=this.createCallControl({type:"publish",callId:wt.callId,roomName:wt.data.confId,callConfiguration:wt.callConfiguration,data:wt.data}),wt.callControl.sessionId=wt.data.confId,wt.callControl.token=wt.data.confId,wt.callControl.autoRestart.counter=0,wt.setMediaConstraintsToSendOnlyOffer()),(0,ct.ki)(Pt,"userMediaStreamId","string")&&(Kt=Pt.userMediaStreamId),Yt!=null&&Yt.isSimulated==="true"?apiCC.session.channel.socket.emit("simulatedAgentCallRequest",{number:nt,call:wt,videoActivated:vt,data:Tt,callConfiguration:{apzcallId:wt.callId}}):this.accessToLocalMedia===!0&&this.autoAnswer===!0||wt.dataCall||Kt?wt.dataCall?(cn.log("Datachannel call"),wt.establishCall()):(cn.log("callWithNumber :: User has already granted access to local media and AutoAnswer activated : establishing call"),Kt?((en=apiCC.getUserMediaStream(Kt)).addCallInfo(wt.callId),wt.callConfiguration!==void 0&&wt.callConfiguration!==null||(wt.callConfiguration={}),wt.callConfiguration.userMediaStreamId=en.userMediaStreamId,wt.onUserMediaSuccessOnCall(en.stream)):wt.establishCall()):Tt.MCUType==="MCU-Callee"&&this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?cn.log("Stand-by :: wait for AcceptCall on recorded 1to1 call"):wt.getUserMediaOnCall()}else cn.log("Call Number is incorrect");return Et},this.startTestCall=function(nt,vt){cn.info("startTestCall : video activated : "+nt);var Tt,Pt,wt=null,Dt=null,Et={};return(wt=new Cn(this)).generateCallId(),wt.instanceId=apiCC.generateInstanceId(),wt.callerId=this.clientId,wt.calleeId=12345,wt.dest_roomId=12345,wt.audioOnly=!nt,wt.remoteId=12345,wt.callConfiguration=vt,vt!=null?(vt.mediaTypeForOutgoingCall==="VIDEO"||vt.mediaTypeForOutgoingCall==="AUDIO"||vt.mediaTypeForOutgoingCall==="VIDEOONLY"||vt.mediaTypeForOutgoingCall==="NONE"?(cn.log("Setting mediaTypeForOutgoingCall :"+vt.mediaTypeForOutgoingCall),wt.mediaTypeForOutgoingCall=vt.mediaTypeForOutgoingCall):cn.log("mediaTypeForOutgoingCall is not set"),vt.mediaRoutingMode!==void 0&&vt.mediaRoutingMode!==null&&wt.setCallMediaRoutingMode(vt.mediaRoutingMode),vt.turnServerAddress!==void 0&&vt.turnServerAddress!==null&&wt.setCallTurnServer(vt.turnServerAddress),vt.preferVP9Codec!==!0&&vt.preferVP9Codec!==!1||(wt.preferVP9Codec=vt.preferVP9Codec)):(cn.log("callConfiguration is not set"),vt={}),wt.checkDTLSCompliancy(),Pt=wt.callId,Et.pubSub="testCallKurentoConnector",wt.data=Et,wt.data.instanceId=wt.instanceId,wt.audioOnly===!0&&(wt.callType="audio"),Tt=this.callsTable.push(wt),cn.log("Call Number is :"+Tt),this.accessToLocalMedia===!0&&this.autoAnswer===!0||wt.dataCall||vt.userMediaStreamId||apiCC.userMediaStreamTable.length>0?wt.dataCall?(cn.log("Datachannel call"),wt.establishCall()):(cn.log("startTestCall :: User has already granted access to local media and AutoAnswer activated : establishing call"),vt.userMediaStreamId?((Dt=apiCC.getUserMediaStream(vt.userMediaStreamId)).addCallInfo(wt.callId),wt.callConfiguration!==void 0&&wt.callConfiguration!==null||(wt.callConfiguration={}),wt.callConfiguration.userMediaStreamId=Dt.userMediaStreamId,wt.callLocalStream=Dt.stream,wt.establishCall()):(apiCC.userMediaStreamTable.length>0&&((Dt=apiCC.userMediaStreamTable[0]).addCallInfo(wt.callId),wt.callConfiguration!==void 0&&wt.callConfiguration!==null||(wt.callConfiguration={}),wt.callConfiguration.userMediaStreamId=Dt.userMediaStreamId,wt.callLocalStream=Dt.stream),wt.establishCall())):wt.getUserMediaOnCall(),Pt},this.extensionInstallationSuccessCallback=function(){cn.debug("extensionInstallationSuccessCallback"),apiCC.session.apiCCWebRTCClient.webRTCClient.apiRTCExtensionInstalled=!0},this.extensionInstallationFailureCallback=function(nt,vt){cn.debug("extensionInstallationFailureCallback : Error :"+nt+", "+vt),nt=null,vt=null,Hn.createDesktopCaptureEvent("Extension_installation_Error",this.waitingShareScreenCallId,this.waitingShareScreenDestNumber,this.waitingCaptureSourceType)},this.manageNotInstalledExtension=function(nt,vt,Tt){cn.debug("manageNotInstalledExtension"),cn.warn("apiRTC extension not installed"),Hn.createDesktopCaptureEvent("Extension_not_installed",nt,vt),cn.warn("Starting apiRTC extension installation"),this.waitingShareScreenDestNumber=vt,this.waitingShareScreenCallId=nt,this.waitingCaptureSourceType=Tt,chrome.webstore.install("https://chrome.google.com/webstore/detail/mjjnofoemoepfididplbfimokpnpcoeg",this.callback(this,"extensionInstallationSuccessCallback"),this.callback(this,"extensionInstallationFailureCallback"))},this.shareScreen=function(nt,vt,Tt,Pt,wt){cn.info("shareScreen");var Dt=null,Et=null,jt=null,Yt=null;if(apiCC.isScreenSharingCompliant()===!0)if(nt!==""&&nt!==this.clientId){if(vt!==null&&tr(vt)==="object"||(vt={}),this.MCUClient.pubConnector==="janusConnector"&&!vt.mesh&&wt&&wt.callControl&&wt.callControl.callId&&this.findCallWithCallId(wt.callControl.callId))return cn.debug("call already exists",wt.callControl.callId),wt.callControl.callId;if(Pt!==null&&tr(Pt)==="object"||(Pt={}),Pt.qos!==null&&tr(Pt.qos)==="object"?(vt.qos={},Pt.qos.videoMinQuality==="excellent"?vt.qos.videoMinQuality="excellent":Pt.qos.videoMinQuality==="good"?vt.qos.videoMinQuality="good":Pt.qos.videoMinQuality==="medium"?vt.qos.videoMinQuality="medium":(Pt.qos.videoMinQuality,vt.qos.videoMinQuality="bad"),Pt.qos.videoForbidInactive===!0&&(vt.qos.videoForbidInactive=!0)):vt.qos={videoMinQuality:"bad"},["audioLabels","videoLabels"].forEach(function(Kt){(0,ct.Ym)(Pt[Kt],"array")&&(vt[Kt]=[],Pt[Kt].forEach(function(rn){(0,ct.Ym)(rn,"string")&&vt[Kt].push(rn)}))}),(0,ct.Ym)(Pt,"context","object"))try{JSON.stringify(Pt.context),vt.context=Pt.context}catch{}cn.log("shareScreen; callConfiguration: "+JSON.stringify(Pt)),Et=new Cn(apiCC.session.apiCCWebRTCClient.webRTCClient),vt.mesh!==void 0&&vt.instanceId!==void 0?(cn.debug("keeping instanceId "),Et.instanceId=vt.instanceId):Et.instanceId=apiCC.generateInstanceId(),cn.log("Calling destination number :"+nt);var en=this.MCUClient.getSessionMCU(nt);if(en&&(Et.sessionMCU=en),Et.sessionMCU&&this.MCUClient.pubConnector==="janusConnector"&&!vt.mesh?(Et.settingUpType="shareScreen",wt&&wt.callControl?(Et.callControl=wt.callControl,Et.callControl.autoRestart.counter+=1,Et.callId=Et.callControl.callId,Et.restarted=!0):(Et.callControl=this.createCallControl({type:"shareScreen",roomName:nt,callConfiguration:Pt,data:vt}),Et.callControl.captureSourceType=Tt,Et.callControl.autoRestart.counter=0,Et.generateCallId(),Et.callControl.callId=Et.callId)):(Et.settingUpType="shareScreen",Et.generateCallId()),Dt=Et.callId,Et.callerId=this.clientId,Et.calleeId=nt,Et.dest_roomId=nt,Et.audioOnly=!1,Et.screenSharing=!0,Et.remoteId=nt,Et.callType="screenSharing",Et.captureSourceType=Tt,Et.callConfiguration=Pt,Et.data=vt,Et.data.instanceId=Et.instanceId,en&&en.convId&&(Et.data.cloudConvId=en.convId),Pt!=null&&Pt.turnServerAddress!==void 0&&Pt.turnServerAddress!==null&&Et.setCallTurnServer(Pt.turnServerAddress),Et.checkDTLSCompliancy(),apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.push(Et),Et.sessionMCU&&this.MCUClient.pubConnector==="janusConnector"&&Et.callControl&&Et.callControl.autoRestart.stream)return cn.debug("shareScreen; autoRestart"),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,Et.callLocalStream=Et.callControl.autoRestart.stream,Et.establishCall(),Et.callId;if(vt!==void 0&&vt.mesh!==void 0&&(jt=apiCC.session.apiCCWebRTCClient.webRTCClient.findUserMediaById(vt.mesh.calleeCallId))!==null&&jt.callConfiguration&&jt.callConfiguration.userMediaStreamId)return(Yt=apiCC.getUserMediaStream(jt.callConfiguration.userMediaStreamId)).addCallInfo(Et.callId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,Et.sessionMCU&&apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector==="janusConnector"&&Et.callControl&&(Et.callControl.autoRestart.stream=Yt.stream),Et.callConfiguration.userMediaStreamId=Yt.userMediaStreamId,Et.callLocalStream=Yt.stream,Et.establishCall(),Et.callId;apiCC.createUserMediaStream({callId:Et.callId,type:Et.callType,captureSourceType:Tt,success:function(Kt){cn.debug("[shareScreen] success; userMediaStreamId: "+Kt.userMediaStreamId),apiCC.session.apiCCWebRTCClient.webRTCClient.accessToLocalMedia=!0,Et.sessionMCU&&apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.pubConnector==="janusConnector"&&Et.callControl&&(Et.callControl.autoRestart.stream=Kt.stream),Et.callConfiguration.userMediaStreamId=Kt.userMediaStreamId,Et.callLocalStream=Kt.stream,Et.establishCall()}})}else cn.log("Call Number is incorrect");else cn.log("shareScreen is not supported on this browser"),Hn.createDesktopCaptureEvent("Browser_Not_Compatible",Dt,nt);return cn.info("shareScreen, callId :",Dt),Dt},this.startScreenSharingOnCall=function(nt,vt){cn.info("getScreenMedia for callId :"+nt);var Tt=null;if(ot.Xh==="Chrome")if((Tt=this.findCallWithCallId(nt))!==null){if(this.apiRTCExtensionInstalled===!1)return void this.manageNotInstalledExtension(Tt.callId,Tt.remoteId,vt);vt==null&&(vt=["screen","window","tab"]),window.postMessage({command:"getDesktopId",callNumber:Tt.callId,remoteId:Tt.remoteId,captureSourceType:vt,browser_major_version:ot.PR},"*")}else cn.log("call not found");else cn.log("shareScreen is only available for chrome Browser"),Hn.createDesktopCaptureEvent("Browser_Not_Compatible",nt,null)},this.toggleVideoScreen=function(nt){cn.info("toggleVideoScreen for callId :"+nt);var vt=this.findCallWithCallId(nt);vt!==null?vt.toggleVideoScreen():cn.log("call not found")},this.addVideoMedia=function(nt){cn.info("webRTCClient::addVideoMedia for callId :"+nt);var vt=this.findCallWithCallId(nt);vt!==null?vt.addVideoMedia():cn.log("call not found")},this.callbymail=function(nt){var vt;cn.info("Click on Call per mail Button"),vt=nt,new RegExp("^[0-9a-z._-]+@{1}[0-9a-z.-]{2,}[.]{1}[a-z]{2,5}$","i").test(vt)?(cn.log("Calling Destination mail :"+nt),this.socket.emit("webrtc_invite_permail",nt),qt.channel.socket.emit("webrtc_invite_permail",nt)):cn.log("Mail address is not correct :"+nt)},this.callperURL=function(nt){cn.info("Call per URL");var vt,Tt=null;(Tt=new Cn(this)).instanceId=apiCC.generateInstanceId(),cn.log("Calling Destination number :"+nt),Tt.generateCallId(),Tt.callerId=this.clientId,Tt.calleeId=nt,Tt.dest_roomId=nt,Tt.audioOnly=!1,Tt.getUserMediaOnCall(),Tt.remoteId=nt,Tt.checkDTLSCompliancy(),vt=this.callsTable.push(Tt),cn.log("Call Number is :"+vt)},this.acceptCall=function(nt,vt){cn.info("acceptCall for callId :"+nt),cn.log("acceptCall() - callConfiguration : ",vt);var Tt=null,Pt=null;if((Tt=this.findCallWithCallId(nt))!==null){if(cn.log("acceptCall() - Call found"),Tt.isAccepted=!0,vt!=null?(vt.mediaTypeForIncomingCall==="VIDEO"||vt.mediaTypeForIncomingCall==="AUDIO"||vt.mediaTypeForIncomingCall==="VIDEOONLY"||vt.mediaTypeForIncomingCall==="NONE"||vt.mediaTypeForIncomingCall==="DATA"?(cn.log("acceptCall() - Setting mediaTypeForIncomingCall :"+vt.mediaTypeForIncomingCall),Tt.mediaTypeForIncomingCall=vt.mediaTypeForIncomingCall):cn.log("acceptCall() - mediaTypeForIncomingCall is not set"),vt.mediaRoutingMode!==void 0&&vt.mediaRoutingMode!==null&&Tt.setCallMediaRoutingMode(vt.mediaRoutingMode),vt.turnServerAddress!==void 0&&vt.turnServerAddress!==null&&Tt.setCallTurnServer(vt.turnServerAddress),vt.preferVP9Codec!==!0&&vt.preferVP9Codec!==!1||(Tt.preferVP9Codec=vt.preferVP9Codec)):(cn.log("acceptCall() - callConfiguration is not set"),vt={}),Tt.screenSharing===!0&&(cn.log("acceptCall() for screenSharing : forcing mediaTypeForIncomingCall to NONE"),vt.mediaTypeForIncomingCall="NONE",Tt.mediaTypeForIncomingCall="NONE"),Tt.callConfiguration=(0,ct.S6)(Tt.callConfiguration,vt),Tt.mediaTypeForIncomingCall==="VIDEO"?Tt.setLocalCallProfile({audio:!0,audioActive:!0,video:!0,videoActive:!0}):Tt.mediaTypeForIncomingCall==="AUDIO"?Tt.setLocalCallProfile({audio:!0,audioActive:!0,video:!1,videoActive:!1}):Tt.mediaTypeForIncomingCall==="VIDEOONLY"?Tt.setLocalCallProfile({audio:!1,audioActive:!1,video:!0,videoActive:!0}):Tt.mediaTypeForIncomingCall==="NONE"&&Tt.setLocalCallProfile({audio:!1,audioActive:!1,video:!1,videoActive:!1}),Tt.data&&Tt.data.MCUType==="MCU-Callee"&&Tt.mediaTypeForIncomingCall==="NONE")return void Tt.myWebRTC_Stack.sendInvite(Tt.callId,Tt.callerId,this.nickname,Tt.dest_roomId,Tt.dest_roomId,"none",{offer:{type:"no-offer"},data:Tt.data});Tt.data&&Tt.data.MCUType==="MCU-Callee"&&(Tt.mediaTypeForOutgoingCall=Tt.mediaTypeForIncomingCall,Tt.settingUpType="publish",Tt.callControl=this.createCallControl({type:"publish",callId:Tt.callId,roomName:Tt.data.confId,callConfiguration:Tt.callConfiguration,data:Tt.data}),Tt.callControl.sessionId=Tt.data.confId,Tt.callControl.token=Tt.data.confId,Tt.callControl.autoRestart.counter=0,Tt.setMediaConstraintsToSendOnlyOffer()),this.unidirectionelCallOnly?(cn.log("acceptCall() - unidirectional call"),Tt.onUserMediaSuccessTestUni()):this.userAcceptOnIncomingCallBeforeGetUserMedia===!0?(cn.log("acceptCall with userAcceptOnIncomingCallBeforeGetUserMedia"),vt.userMediaStreamId?((Pt=apiCC.getUserMediaStream(vt.userMediaStreamId)).addCallInfo(Tt.callId),Tt.callConfiguration!==void 0&&Tt.callConfiguration!==null||(Tt.callConfiguration={}),Tt.callConfiguration.userMediaStreamId=Pt.userMediaStreamId,Tt.onUserMediaSuccessOnCall(Pt.stream)):Tt.getUserMediaOnCall()):Tt.accessToMedia===!0||vt.userMediaStreamId||Tt.dataCall?(cn.log("acceptCall() :: User has already granted access to local media and AutoAnswer activated : establishing call"),Tt.dataCall||vt.userMediaStreamId&&((Pt=apiCC.getUserMediaStream(vt.userMediaStreamId)).addCallInfo(Tt.callId),Tt.callConfiguration!==void 0&&Tt.callConfiguration!==null||(Tt.callConfiguration={}),Tt.callConfiguration.userMediaStreamId=Pt.userMediaStreamId,Tt.callLocalStream=Pt.stream),Tt.establishCall()):cn.log("acceptCall() - call will be established when user accept his media")}else cn.log("Call not found")},this.refuseCall=function(nt,vt){cn.info("refuseCall for callId :"+nt);var Tt,Pt=null;Tt=vt!==void 0?vt:"User_Refused_Call",(Pt=this.findCallWithCallId(nt))!==null?(cn.log("Call found"),Pt.data.MCUType==="MCU-Callee"?(Pt.myWebRTC_Stack.sendBye(Pt.callId,Pt.callerId,Pt.dest_roomId,Pt.calleeId,"User_Media_Error",Pt.data),this.removeCallFromTableWithCallIdandRemoteId(Pt.callId,Pt.calleeId,Tt)):(Pt.myWebRTC_Stack.sendBye(Pt.callId,Pt.calleeId,Pt.dest_roomId,Pt.callerId,Tt,Pt.data),this.removeCallFromTableWithCallIdandRemoteId(Pt.callId,Pt.callerId,Tt)),this.callsTable.length===0&&cn.log("No more established calls for client")):cn.log("Call not found")},this.stopMedia=function(nt){var vt=this;return new Promise(function(Tt,Pt){var wt=null,Dt=null;return(wt=vt.findCallWithCallId(nt))?wt.callLocalStream?void wt.removeStream(wt.callLocalStream).then(function(){return wt.callLocalStream=null,(0,ct.ki)(wt.callConfiguration,"userMediaStreamId","string")&&(apiCC.releaseUserMediaStream(wt.callConfiguration.userMediaStreamId,wt.callId),delete wt.callConfiguration.userMediaStreamId),Tt()}).catch(Pt):Tt():((Dt=vt.findUserMediaById(nt))&&Dt.releaseUserMediaStream(),Tt())})},this.addMedia=function(nt,vt,Tt,Pt){var wt=this;cn.info("addMedia for callId :"+nt);var Dt=null,Et=null,jt=null,Yt=function(){return Promise.resolve()},en=function(){return Promise.resolve()};vt===!0&&(Yt=function(){return wt.stopMedia(nt)}),(0,ct.Ym)(Tt,"string")&&(jt=apiCC.getUserMediaStream(Tt),Tt=null);var Kt=function(){cn.error("[addMedia] success; userMediaStreamId: "+jt.userMediaStreamId),Et.callConfiguration!==void 0&&Et.callConfiguration!==null||(Et.callConfiguration={}),Et.callConfiguration.userMediaStreamId=jt.userMediaStreamId,Et.callType=jt.callType,Et.audio=jt.audio,Et.video=jt.video,Et.audioMuted=jt.audioMuted,Et.videoMuted=jt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Et,!0)},rn=function(un){un.callConfiguration!==void 0&&un.callConfiguration!==null||(un.callConfiguration={}),un.isLocalAudioMuted&&un.isLocalVideoMuted?un.callConfiguration.muted="VIDEO":un.isLocalAudioMuted?un.callConfiguration.muted="AUDIOONLY":un.isLocalVideoMuted&&(un.callConfiguration.muted="VIDEOONLY")},hn=function(un,Sn,En){Sn==="audio"?En?un.audioSdpDirection=null:(0,ct.ki)(un.remoteCallProfile,"audio","boolean")&&un.remoteCallProfile.audio===!0&&un.remoteCallProfile.audioActive===!0?un.audioSdpDirection="recvonly":un.audioSdpDirection="inactive":Sn==="video"&&(En?un.videoSdpDirection=null:(0,ct.ki)(un.remoteCallProfile,"video","boolean")&&un.remoteCallProfile.video===!0&&un.remoteCallProfile.videoActive===!0?un.videoSdpDirection="recvonly":un.videoSdpDirection="inactive")},an=function(un,Sn,En,An){un.callConfiguration!==void 0&&un.callConfiguration!==null||(un.callConfiguration={}),un.callConfiguration.userMediaStreamId=Sn.userMediaStreamId,hn(un,"audio",Sn.audio),hn(un,"video",Sn.video),rn(un),function(Dn,Bn,sr){Bn&&sr?(Dn.audioOnly=!1,Dn.mediaTypeForIncomingCall="VIDEO",Dn.mediaTypeForOutgoingCall="VIDEO"):Bn?(Dn.audioOnly=!1,Dn.mediaTypeForIncomingCall="AUDIO",Dn.mediaTypeForOutgoingCall="AUDIO"):sr?(Dn.audioOnly=!1,Dn.mediaTypeForIncomingCall="VIDEOONLY",Dn.mediaTypeForOutgoingCall="VIDEOONLY"):(Dn.audioOnly=!1,Dn.mediaTypeForIncomingCall="NONE",Dn.mediaTypeForOutgoingCall="NONE")}(un,Sn.audio,Sn.video),un.callLocalStream=Sn.stream,un.started?un.addingUserMedia=!0:wt.accessToLocalMedia=!0,un.asyncCallbacks={},un.asyncCallbacks.type="addingUserMedia",un.asyncCallbacks.resolve=En,un.asyncCallbacks.reject=An,un.asyncCallbacks.timeoutId=setTimeout(function(){un.asyncCallbacks&&typeof un.asyncCallbacks.reject=="function"&&(un.asyncCallbacks.reject("addMedia timeout"),delete un.asyncCallbacks)},Qn),un.establishCall()};if((Dt=this.findCallWithCallId(nt))!==null){if(Dt.asyncCallbacks)return Promise.reject("job already ongoing");en=function(){return new Promise(function(un,Sn){jt?(jt.addCallInfo(Dt.callId),an(Dt,jt,un,Sn)):Tt?apiCC.createUserMediaStream({type:"media",callId:Dt.callId,stream:Tt,sync:!0,success:function(En){cn.debug("[addMedia] success; userMediaStreamId: "+En.userMediaStreamId),an(Dt,En,un,Sn)},failure:function(En,An){return Sn(An)}}):(0,ct.ki)(Pt,"getUserMediaStreamId","function")?Pt.getUserMediaStreamId().then(function(En){if(!(jt=apiCC.getUserMediaStream(En)))return Sn("wrong userMediaStreamId");jt.addCallInfo(Dt.callId),an(Dt,jt,un,Sn)}).catch(Sn):apiCC.userMediaStreamTable.length>0?((jt=apiCC.userMediaStreamTable[0]).addCallInfo(Dt.callId),an(Dt,jt,un,Sn)):(rn(Dt),Dt.addingUserMedia=!0,Dt.asyncCallbacks={},Dt.asyncCallbacks.type="addingUserMedia",Dt.asyncCallbacks.resolve=un,Dt.asyncCallbacks.reject=Sn,Dt.asyncCallbacks.timeoutId=setTimeout(function(){Dt.asyncCallbacks&&typeof Dt.asyncCallbacks.reject=="function"&&(Dt.asyncCallbacks.reject("addMedia timeout"),delete Dt.asyncCallbacks)},Qn),Dt.getUserMediaOnCall())})}}else if(Et=this.findUserMediaById(nt)){if(Et.addingUserMedia===!0)return Promise.reject("addMedia already ongoing");en=function(){return new Promise(function(un,Sn){Et.addingUserMedia=!0,new Promise(function(En,An){if(jt)return jt.addCallInfo(Et.userMediaId,"userMedia"),Et.callConfiguration!==void 0&&Et.callConfiguration!==null||(Et.callConfiguration={}),Et.callConfiguration.userMediaStreamId=jt.userMediaStreamId,Et.callType=jt.callType,Et.audio=jt.audio,Et.video=jt.video,Et.audioMuted=jt.audioMuted,Et.videoMuted=jt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Et,!0),En(jt.userMediaStreamId);if(Tt)apiCC.createUserMediaStream({callId:Et.userMediaId,callFlavor:"userMedia",type:Et.callType,stream:Tt,sync:!0,success:function(){return Kt(),En(jt.userMediaStreamId)},failure:function(Dn,Bn){return An(Bn)}});else if((0,ct.ki)(Pt,"getUserMediaStreamId","function"))Pt.getUserMediaStreamId().then(function(Dn){return(jt=apiCC.getUserMediaStream(Dn))?(jt.addCallInfo(Et.userMediaId,"userMedia"),Et.callConfiguration!==void 0&&Et.callConfiguration!==null||(Et.callConfiguration={}),Et.callConfiguration.userMediaStreamId=jt.userMediaStreamId,Et.callType=jt.callType,Et.audio=jt.audio,Et.video=jt.video,Et.audioMuted=jt.audioMuted,Et.videoMuted=jt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Et,!0),En(jt.userMediaStreamId)):An("wrong userMediaStreamId")}).catch(An);else{if(apiCC.userMediaStreamTable.length>0)return(jt=apiCC.userMediaStreamTable[0]).addCallInfo(Et.userMediaId,"userMedia"),Et.callConfiguration!==void 0&&Et.callConfiguration!==null||(Et.callConfiguration={}),Et.callConfiguration.userMediaStreamId=jt.userMediaStreamId,Et.callType=jt.callType,Et.audio=jt.audio,Et.video=jt.video,Et.audioMuted=jt.audioMuted,Et.videoMuted=jt.videoMuted,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshOnUserMediaSuccess(Et,!0),En(jt.userMediaStreamId);apiCC.createUserMediaStream({callId:Et.userMediaId,callFlavor:"userMedia",type:Et.callType,audioSourceId:apiCC.session.apiCCWebRTCClient.webRTCClient.audioSourceId,videoSourceId:apiCC.session.apiCCWebRTCClient.webRTCClient.videoSourceId,success:function(){return Kt(),En(jt.userMediaStreamId)},failure:function(Dn,Bn){return An(Bn)}})}}).then(function(En){return function(An){return new Promise(function(Dn,Bn){for(var sr=[],fr=0;fr<apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.length;fr+=1){var Cr=apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable[fr];Cr.data!==void 0&&Cr.data.mesh!==void 0&&Cr.data.mesh.calleeCallId===nt&&sr.push(apiCC.session.apiCCWebRTCClient.webRTCClient.addMedia(Cr.callId,!0,An))}Promise.all(sr).then(function(){return Dn(An)}).catch(Bn)})}(En)}).then(function(En){return delete Et.addingUserMedia,un(En)}).catch(function(En){return delete Et.addingUserMedia,Sn(En)})})}}else en=function(){return Promise.reject("no suitable replacement")};return new Promise(function(un,Sn){Yt().then(function(){return en()}).then(function(En){return cn.info("addMedia success; userMediaStreamId: "+En),un(En)}).catch(function(En){cn.error("addMedia failure: "+En);var An=null,Dn=null;return Dt?(Dt.callControl&&(An=Dt.callControl.roomName,Dn=Dt.callControl.type),Hn.createErrorEvent("Failed to addMedia","MEDIA_UPDATE_ERROR",Dt.callId,An,Dn)):Et&&Hn.createErrorEvent("Failed to addMedia","MEDIA_UPDATE_ERROR",Et.userMediaId,null,"publish"),Sn(En)})})},this.updateMediaDeviceOnCall=function(nt,vt){return cn.info("updateMediaDeviceOnCall for callId :"+nt),this.addMedia(nt,!0,vt),nt},this.updateMediaTypeOnCall=function(nt,vt){var Tt=function(Dt,Et,jt){return new Promise(function(Yt,en){var Kt,rn={};Dt.callControl.mediaType=jt,Dt.mediaType=jt,Dt.data.mediaType=jt,Dt.updateCause="userAction",rn.type="update",rn.mode="passive",rn.callId=Dt.callId,rn.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,rn.callerNickname=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,rn.calleeId=Dt.sessionMCU.roomName,rn.roomId=Dt.sessionMCU.roomName,rn.callType=Et.attributes.callType,rn.data=(0,ct.S6)(Dt.data),rn.data.type="subscribe",rn.stream=Et,Kt=JSON.stringify(rn),cn.log("C->S: "+Kt),apiCC.session.apiCCWebRTCClient.webRTCClient.socket.emit("update",Kt),Dt.asyncCallbacks={},Dt.asyncCallbacks.type="updateMediaType",Dt.asyncCallbacks.resolve=Yt,Dt.asyncCallbacks.reject=en,Dt.asyncCallbacks.timeoutId=setTimeout(function(){Dt.asyncCallbacks&&typeof Dt.asyncCallbacks.reject=="function"&&(Dt.asyncCallbacks.reject("timeout"),delete Dt.asyncCallbacks)},2e4)})},Pt=this.findCallWithCallId(nt);if(!Pt)return Promise.reject("call not found");if(Pt.settingUpType!=="subscribe")return Promise.reject("wrong call type");if(Pt.asyncCallbacks)return Promise.reject("job already ongoing");var wt=this.MCUClient.getStreamFromList(Pt.streamId);if(!wt)return Promise.reject("wrong streamId");if(Pt.callControl.mediaType==="VIDEO"){if(vt==="AUDIOONLY"&&wt.audio||vt==="VIDEOONLY"&&wt.video)return Tt(Pt,wt,vt)}else if(Pt.callControl.mediaType==="AUDIOONLY"){if(vt==="VIDEO"&&wt.video||vt==="VIDEOONLY"&&wt.video)return Tt(Pt,wt,vt)}else if(Pt.callControl.mediaType==="VIDEOONLY"&&(vt==="VIDEO"&&wt.video||vt==="AUDIOONLY"&&wt.audio))return Tt(Pt,wt,vt);return Promise.reject("wrong mediaType")},this.updateSimulcastFeedOnCall=function(nt,vt){var Tt=this.findCallWithCallId(nt);if(!Tt)return Promise.reject("call not found");if(Tt.settingUpType!=="subscribe")return Promise.reject("wrong call type");if(Tt.asyncCallbacks)return Promise.reject("job already ongoing");var Pt=this.MCUClient.getStreamFromList(Tt.streamId);if(!Pt)return Promise.reject("wrong streamId");if(!vt)return Promise.reject("wrong simulcast");Tt.callControl.callConfiguration.simulcast||(Tt.callControl.callConfiguration.simulcast={}),Tt.data.simulcast||(Tt.data.simulcast={}),vt.streamQuality&&(vt.streamQuality==="high"?(Tt.callControl.callConfiguration.simulcast.substream=2,Tt.data.simulcast.substream=2):vt.streamQuality==="medium"?(Tt.callControl.callConfiguration.simulcast.substream=1,Tt.data.simulcast.substream=1):vt.streamQuality==="low"?(Tt.callControl.callConfiguration.simulcast.substream=0,Tt.data.simulcast.substream=0):(Tt.callControl.callConfiguration.simulcast.substream=-1,Tt.data.simulcast.substream=-1)),vt.streamFrameRate&&(vt.streamFrameRate==="high"?(Tt.callControl.callConfiguration.simulcast.temporal=2,Tt.data.simulcast.temporal=2):vt.streamFrameRate==="medium"?(Tt.callControl.callConfiguration.simulcast.temporal=1,Tt.data.simulcast.temporal=1):vt.streamFrameRate==="low"?(Tt.callControl.callConfiguration.simulcast.temporal=0,Tt.data.simulcast.temporal=0):(Tt.callControl.callConfiguration.simulcast.temporal=-1,Tt.data.simulcast.temporal=-1));var wt={type:"updateSimulcastFeed"};wt.callId=Tt.callId,wt.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,wt.callerNickname=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,wt.calleeId=Tt.sessionMCU.roomName,wt.roomId=Tt.sessionMCU.roomName,wt.callType=Pt.attributes.callType,wt.data=(0,ct.S6)(Tt.data),wt.stream=Pt;var Dt=JSON.stringify(wt);return cn.log("C->S: "+Dt),apiCC.session.apiCCWebRTCClient.webRTCClient.socket.emit("updateSimulcastFeed",Dt),Promise.resolve()},this.updateCallConfigurationOnCall=function(nt,vt){var Tt=function(wt,Dt,Et){Dt==="audio"?wt.audioSdpDirection=Et?null:"inactive":Dt==="video"&&(wt.videoSdpDirection=Et?null:"inactive")},Pt=this.findCallWithCallId(nt);return Pt?Pt.settingUpType!=="publish"?Promise.reject("wrong call type"):Pt.asyncCallbacks?Promise.reject("job already ongoing"):((0,ct.Ym)(vt,"object")||(vt={}),(0,ct.ki)(vt,"audioOnly","boolean")||(vt.audioOnly=!1),(0,ct.ki)(vt,"videoOnly","boolean")||(vt.videoOnly=!1),function(wt,Dt){return new Promise(function(Et,jt){wt.mediaTypeForIncomingCall="NONE",Dt.audioOnly===!0?(cn.log("Setting call as audioOnly"),wt.audioOnly=!0,wt.callType="audio",wt.mediaTypeForOutgoingCall="AUDIO",Tt(wt,"audio",!0),Tt(wt,"video",!1)):Dt.videoOnly===!0?(cn.log("Setting call as videoOnly"),wt.audioOnly=!1,wt.callType="videoOnly",wt.mediaTypeForOutgoingCall="VIDEOONLY",Tt(wt,"audio",!1),Tt(wt,"video",!0)):(cn.log("Setting call as media"),wt.audioOnly=!1,wt.callType="media",wt.mediaTypeForOutgoingCall="VIDEO",Tt(wt,"audio",!0),Tt(wt,"video",!0)),wt.updateUserMedia=!0,wt.updateCause="userAction",wt.establishCall(),wt.asyncCallbacks={},wt.asyncCallbacks.type="updateCallConfiguration",wt.asyncCallbacks.resolve=Et,wt.asyncCallbacks.reject=jt,wt.asyncCallbacks.timeoutId=setTimeout(function(){wt.asyncCallbacks&&typeof wt.asyncCallbacks.reject=="function"&&(wt.asyncCallbacks.reject("timeout"),delete wt.asyncCallbacks)},2e4)})}(Pt,vt)):Promise.reject("call not found")},this.findUserMediaById=function(nt){for(var vt=this.userMediaTable.length;--vt>=0;)if(this.userMediaTable[vt].userMediaId===nt)return this.userMediaTable[vt];return null},this.findCallIndexWithCallIdAndRemoteId=function(nt,vt){cn.debug("findCallIndexWithCallIdAndRemoteId");var Tt,Pt=this.callsTable.length;for(cn.trace("callsNumber : "+Pt),Tt=0;Tt<Pt;Tt+=1)if(this.callsTable[Tt].callId===nt&&(cn.log("callId found"),cn.log("this.callsTable[i].callee :"+this.callsTable[Tt].callee),cn.log("this.callsTable[i].calleeId :"+this.callsTable[Tt].calleeId),this.callsTable[Tt].callee===!0&&this.callsTable[Tt].callerId===vt||this.callsTable[Tt].callee===!1&&this.callsTable[Tt].calleeId===vt))return Tt;return cn.log("Call not found"),-1},this.findCallIndexWithConfIdAndRemoteId=function(nt,vt){cn.debug("findCallIndexWithConfIdAndRemoteId"),cn.log("confId :"+nt),cn.log("remoteId :"+vt);var Tt,Pt=this.callsTable.length;for(Tt=0;Tt<Pt;Tt+=1)if(cn.log("this.callsTable[i].data.confId :"+this.callsTable[Tt].data.confId),this.callsTable[Tt].data.confId===nt){if(this.callsTable[Tt].callee===!0&&this.callsTable[Tt].callerId===vt||this.callsTable[Tt].callee===!1&&this.callsTable[Tt].calleeId===vt)return Tt}else cn.debug("ConfId is different");return cn.debug("Call not found - findCallIndexWithConfIdAndRemoteId"),-1},this.findCallIndexWithCallId=function(nt){cn.debug("findCallIndexWithCallId");var vt,Tt=this.callsTable.length;for(vt=0;vt<Tt;vt+=1)if(this.callsTable[vt].callId===nt)return cn.log("Call found with callId"),vt;return cn.debug("Call not found - findCallIndexWithCallId"),-1},this.findCallWithCallIdAndInstanceId=function(nt,vt){cn.debug("findCallWithCallIdAndInstanceId :"+nt+" ,instanceId : "+vt),vt===void 0&&cn.debug("instanceId is undefined : must be a mesh publish call, id must be a streamId");var Tt,Pt=this.callsTable.length;for(cn.trace("callsNumber :"+Pt),Tt=0;Tt<Pt;Tt+=1)if(this.callsTable[Tt].callId===nt&&this.callsTable[Tt].instanceId===vt)return this.callsTable[Tt];return cn.debug("Call not found, findCallWithCallIdAndInstanceId"),null},this.findCallIndexWithCallIdAndInstanceId=function(nt,vt){cn.debug("findCallIndexWithCallIdAndInstanceId :"+nt+" ,instanceId : "+vt),vt===void 0&&cn.debug("instanceId is undefined : must be a mesh publish call, id must be a streamId");var Tt,Pt=this.callsTable.length;for(cn.trace("callsNumber :"+Pt),Tt=0;Tt<Pt;Tt+=1)if(this.callsTable[Tt].callId===nt&&this.callsTable[Tt].instanceId===vt)return Tt;return cn.debug("Call not found, findCallIndexWithCallIdAndInstanceId"),-1},this.findCallWithCallId=function(nt){cn.trace("findCallWithCallId :"+nt);var vt,Tt=this.callsTable.length;for(cn.trace("callsNumber :"+Tt),vt=0;vt<Tt;vt+=1)if(cn.trace("this.callsTable[i].callId :"+this.callsTable[vt].callId),this.callsTable[vt].callId===nt)return this.callsTable[vt];return cn.debug("Call not found"),null},this.findCallWithStreamId=function(nt,vt){cn.debug("findCallWithStreamId :"+nt);var Tt,Pt=!(!vt||!vt.ignoreModeChangeKindOld),wt=this.callsTable.length;for(cn.trace("callsNumber :"+wt),Tt=0;Tt<wt;Tt+=1)if(cn.log("this.callsTable[i].streamId :"+this.callsTable[Tt].streamId),!(this.callsTable[Tt].streamId!=nt||Pt&&this.callsTable[Tt].sessionMCU&&this.callsTable[Tt].sessionMCU.modeChangeKind==="old"))return cn.log("Call found"),this.callsTable[Tt];return cn.log("Call not found"),null},this.findCallWithCallIdAndRemoteIdAndInstanceId=function(nt,vt,Tt){cn.debug("findCallWithCallIdAndRemoteIdAndInstanceId callId : "+nt+" ,instanceId : "+Tt);var Pt,wt=this.callsTable.length;for(cn.trace("callsNumber :"+wt),Pt=0;Pt<wt;Pt+=1)if(this.callsTable[Pt].callId===nt&&this.callsTable[Pt].instanceId===Tt&&(this.callsTable[Pt].callee===!0&&this.callsTable[Pt].callerId===vt||this.callsTable[Pt].callee===!1&&this.callsTable[Pt].calleeId===vt))return this.callsTable[Pt];return cn.debug("Call not found"),null},this.findCallWithCallIdAndRemoteId=function(nt,vt){cn.log("findCallWithCallIdAndRemoteId");var Tt,Pt=this.callsTable.length;for(cn.trace("callsNumber :"+Pt),Tt=0;Tt<Pt;Tt+=1)if(this.callsTable[Tt].callId===nt&&(this.callsTable[Tt].callee===!0&&this.callsTable[Tt].callerId===vt||this.callsTable[Tt].callee===!1&&this.callsTable[Tt].calleeId===vt))return this.callsTable[Tt];return cn.log("Call not found"),null},this.releaseUserMedia=function(){cn.info("releaseUserMedia"),this.localStream!==null&&(cn.log("stopping localStream"),this.stopStream(this.localStream),Hn.createUserMediaStopEvent(null,"media"),this.accessToLocalMedia=!1,this.autoAnswer=!1,cn.log("this.autoAnswer :"+this.autoAnswer)),this.screenStream!==null&&this.screenStream!==void 0&&(cn.log("stopping screenStream"),this.stopStream(this.screenStream),Hn.createUserMediaStopEvent(null,"screen"))},this.startDataChannelOnCall=function(nt){cn.info("startDataChannelOnCall with callId :"+nt);var vt=this.findCallWithCallId(nt);vt?(cn.log("Call found",vt),vt.addingDataChannelOnCallOngoing=!0,vt.createDataChannel()):cn.log("Call not found")},this.sendDataWithCallId=function(nt,vt,Tt){cn.info("sendDataWithCallId :"+nt);var Pt=this.findCallWithCallId(nt);Pt?(cn.log("Call found",Pt),Pt.sendData(vt,Tt)):cn.log("Call not found")},this.processDataAck=function(nt){cn.debug("processDataAck",nt);var vt=this.findCallWithCallId(nt.callId);if(vt)if(nt.result==="ok")if((0,ct.ki)(nt,"capabilities","object")&&(0,ct.ki)(nt.capabilities,"dataEndAckEnabled","boolean")&&(vt.dataEndAckEnabled=nt.capabilities.dataEndAckEnabled,cn.debug("dataEndAckEnabled",vt.dataEndAckEnabled)),nt.state==="complete")vt.beginTimeoutId&&(clearTimeout(vt.beginTimeoutId),delete vt.beginTimeoutId),vt.callbacks.success({state:"complete",filename:vt.data.filename,size:vt.data.size,mediaURL:nt.mediaURL,mediaId:nt.mediaId}),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(vt.callId);else if(nt.state==="incomplete"){var Tt,Pt,wt=131072,Dt=[],Et=Math.floor(vt.data.size/wt),jt=vt.data.size%wt;for(Tt=0;Tt<Et;Tt+=1)(Pt=Xn("checksum64")).update(vt.fileContent,Tt*wt,wt),Dt.push(Pt.digest("hex"));if(jt>0&&((Pt=Xn("checksum64")).update(vt.fileContent,Et*wt,jt),Dt.push(Pt.digest("hex"))),cn.debug(JSON.stringify(Dt)),nt.checksums.length===Dt.length){for(Tt=0;Tt<Dt.length&&nt.checksums[Tt]===Dt[Tt];Tt+=1);vt.data.offset=wt*Tt}vt.mediaURL=nt.mediaURL,vt.mediaId=nt.mediaId,vt.establishCall()}else nt.state==="missing"?(vt.mediaURL=nt.mediaURL,vt.mediaId=nt.mediaId,vt.establishCall()):nt.state==="ready"?vt.establishCall():(cn.debug("wrong state "+nt.state),vt.beginTimeoutId&&(clearTimeout(vt.beginTimeoutId),delete vt.beginTimeoutId),vt.callbacks.failure("serverError"),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(vt.callId));else cn.debug("wrong result "+nt.result),vt.beginTimeoutId&&(clearTimeout(vt.beginTimeoutId),delete vt.beginTimeoutId),vt.callbacks.failure("serverError"),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(vt.callId);else cn.debug("no such call",nt.callId)},this.processDataEndAck=function(nt){cn.debug("processDataEndAck",nt);var vt=this.findCallWithCallId(nt.callId);if(vt){var Tt=null;if(!vt.dcfs){if(!vt.data||vt.data.transferType!=="pipeline")return void cn.debug("not pipeline");cn.debug("pipeline"),Tt=vt,vt.clientCall?(cn.debug("resolve client call"),vt=vt.clientCall):(cn.debug("no client call"),vt=null)}vt&&(vt.success&&nt.data&&(vt.success.data=nt.data),nt.result==="ok"?(nt.complete===!0||(delete vt.success,vt.failure="transferIncomplete"),vt.dcfs.terminateTransfer()):nt.result==="error"&&(delete vt.success,vt.failure=nt.errorInfo,vt.dcfs.terminateTransfer())),Tt&&nt.result==="error"&&(cn.debug("error on pipeline"),Tt.failure=nt.errorInfo,Hn.createEvent({eventType:"onFileSended",callId:Tt.callId,remoteId:Tt.remoteId,name:Tt.filename,error:Tt.failure}),Tt.callbacks.failure(Tt.failure),this.onHangup(Tt.callId))}else cn.debug("no such call",nt.callId)},this.pushData=function(nt,vt,Tt,Pt){var wt=this;if(!(0,ct.Ym)(vt,"object")||((vt=Object.assign({},vt)).transferType||(vt.transferType="file"),vt.transferType==="file"&&!nt)||vt.transferType!=="file"&&vt.transferType!=="pipeline"&&vt.transferType!=="plugin"||!(vt.transferType!=="plugin"||vt.pluginName&&vt.pluginData))return null;(0,ct.Ym)(Pt,"object")||(Pt={}),typeof Pt.pending!="function"&&(Pt.pending=function(){}),typeof Pt.progress!="function"&&(Pt.progress=function(){}),typeof Pt.success!="function"&&(Pt.success=function(){}),typeof Pt.failure!="function"&&(Pt.failure=function(){});var Dt=new Cn(apiCC.session.apiCCWebRTCClient.webRTCClient);if(Dt.generateCallId(),Dt.instanceId=apiCC.generateInstanceId(),Dt.callerId=apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,Dt.calleeId="dataChannelConnector",Dt.dest_roomId="dataChannelConnector",Dt.callType="data",Dt.dataCall=!0,Dt.remoteId="dataChannelConnector",vt.pipelineCallId&&(Dt.pipelineCallId=vt.pipelineCallId),Dt.data={},Dt.data.pubSub="dataChannelConnector",Dt.data.transferType=vt.transferType,vt.transferType==="pipeline"?(vt.checksumEnabled=!1,Dt.transferCount=0):vt.transferType==="plugin"&&(vt.checksumEnabled=!1,Dt.data.pluginName=vt.pluginName,Dt.data.pluginData=Object.assign({},vt.pluginData),Dt.data.pluginData.headers&&(Dt.data.pluginData.headers=Object.assign({},Dt.data.pluginData.headers)),Dt.data.pluginData.data&&(Dt.data.pluginData.data=Object.assign({},Dt.data.pluginData.data)),Dt.data.pluginData.formData&&(Dt.data.pluginData.formData=Object.assign({},Dt.data.pluginData.formData))),(0,ct.ki)(vt,"context","object"))try{JSON.stringify(vt.context),Dt.data.context=Object.assign({},vt.context)}catch{}if(vt.overwrite===!0&&(Dt.data.overwrite=!0),(0,ct.Ym)(vt,"ttl","number")&&vt.ttl>0&&(Dt.data.ttl=vt.ttl),Dt.data.instanceId=Dt.instanceId,nt&&(Dt.data.cloudConvId=nt),Dt.callbacks=Pt,Tt!=null&&Tt.turnServerAddress!==void 0&&Tt.turnServerAddress!==null&&Dt.setCallTurnServer(Tt.turnServerAddress),Dt.data.transferType==="pipeline")Dt.data.size=0,Dt.pushDataStatus={type:"pipeline",state:"pending",data:vt},this.callsTable.push(Dt),setTimeout(function(){wt.startNextPushData()});else if((0,ct.Ym)(vt,"file","object")&&(vt.file instanceof File||vt.file.constructor===File||vt.asFile===!0))(0,ct.Ym)(vt,"filename","string")?Dt.data.filename=vt.filename:Dt.data.filename=vt.file.name,(0,ct.Ym)(vt,"filetype","string")?Dt.data.contentType=vt.filetype:Dt.data.contentType=vt.file.type,(0,ct.Ym)(vt,"sourceType","string")&&vt.sourceType.length>0&&(Dt.data.sourceType=vt.sourceType),Dt.data.size=vt.file.size,Dt.data.metadata=vt.metadata,Dt.pushDataStatus={type:"file",state:"pending",convId:String(nt),data:vt},this.callsTable.push(Dt),setTimeout(function(){wt.startNextPushData()});else{if(!(0,ct.Ym)(vt,"buffer","object")||!(vt.buffer instanceof ArrayBuffer||vt.buffer.constructor===ArrayBuffer||vt.asBuffer===!0)||!(0,ct.Ym)(vt,"filename","string")||!(0,ct.Ym)(vt,"filetype","string"))return null;Dt.data.filename=vt.filename,Dt.data.contentType=vt.filetype,(0,ct.Ym)(vt,"sourceType","string")&&vt.sourceType.length>0&&(Dt.data.sourceType=vt.sourceType),Dt.data.size=vt.buffer.byteLength,Dt.data.metadata=vt.metadata,Dt.pushDataStatus={type:"buffer",state:"pending",convId:String(nt),data:vt},this.callsTable.push(Dt),setTimeout(function(){wt.startNextPushData()})}return Dt.callId},this.startNextPushData=function(){for(var nt=this,vt=[],Tt=0;Tt<this.callsTable.length;Tt+=1){var Pt=this.callsTable[Tt];if(Pt.callType==="data"&&Pt.dataCall&&Pt.remoteId==="dataChannelConnector"&&Pt.pushDataStatus){if(Pt.pushDataStatus.state==="ready")continue;vt.push(Pt)}}if(vt.length===0)return!1;var wt=null;vt[0].pushDataStatus.state==="active"?vt.splice(0,1):vt[0].pushDataStatus.state==="pending"&&(wt=vt[0],vt.splice(0,1));for(var Dt=0;Dt<vt.length;Dt+=1){var Et=vt[Dt];Et.pushDataStatus.rank!==Dt&&(Et.pushDataStatus.rank=Dt,Hn.createEvent({eventType:"onFilePending",callId:Et.callId,remoteId:Et.remoteId,name:Et.data.filename,rank:Dt}),Et.callbacks.pending({state:"pending",callId:Et.callId,rank:Dt}))}if(!wt)return!1;cn.debug("startNextPushData",wt.callId);var jt=wt.pushDataStatus.data;if(delete wt.pushDataStatus.data,wt.pushDataStatus.type==="pipeline"){wt.pushDataStatus.state="active";var Yt={type:"pushData",callerId:apiCC.session.apiCCId,callId:wt.callId,data:wt.data},en=JSON.stringify(Yt);return cn.debug("C->S: "+en),apiCC.session.channel.socket.emit("pushData",en),!0}if(wt.pushDataStatus.type==="file"){wt.pushDataStatus.state="active";var Kt=new FileReader;Kt.onload=function(rn){apiCC.session.apiCCWebRTCClient.webRTCClient.startPushData(wt,jt,rn.target.result)},Kt.readAsArrayBuffer(jt.file)}else{if(wt.pushDataStatus.type!=="buffer")return cn.error("startNextPushData - wrong type"),wt.callbacks.failure("start",wt.callId),this.onHangup(wt.callId),!1;wt.pushDataStatus.state="active",this.startPushData(wt,jt,jt.buffer)}return wt.beginTimeoutId=setTimeout(function(){delete wt.beginTimeoutId,wt.callbacks.failure("timeout",wt.callId),nt.onHangup(wt.callId)},2e4),!0},this.startPushData=function(nt,vt,Tt){if(nt.fileContent=new Uint8Array(Tt),nt.pipelineCallId){var Pt=this.findCallWithCallId(nt.pipelineCallId);if(!Pt)return cn.error("no such pipeline call"),void this.onHangup(nt.callId);nt.pipelineCall=Pt,Pt.clientCall=nt,nt.sendDataChannel=Pt.sendDataChannel;var wt=Pt.transferCount===0?100:0;nt.startTransfer({delay:wt}),Pt.transferCount+=1}else{if(!Object.prototype.hasOwnProperty.call(vt,"checksumEnabled")||vt.checksumEnabled){var Dt=Xn("checksum64");Dt.update(nt.fileContent),nt.data.checksum=Dt.digest("hex")}else nt.data.checksumEnabled=!1;var Et={type:"pushData",callerId:apiCC.session.apiCCId,convId:nt.pushDataStatus.convId,callId:nt.callId,data:nt.data},jt=JSON.stringify(Et);cn.debug("C->S: "+jt),apiCC.session.channel.socket.emit("pushData",jt)}},this.cancelPushData=function(nt){for(var vt=null,Tt=this.callsTable.length;--Tt>=0;){var Pt=this.callsTable[Tt];if(Pt.callId===nt&&Pt.callType==="data"&&Pt.dataCall&&Pt.remoteId==="dataChannelConnector"&&Pt.pushDataStatus){vt=Pt;break}}if(!vt)return cn.error("cancelPushData - no such call",nt),"no such call";if(vt.pushDataStatus.state==="pending")Hn.createEvent({eventType:"onFileSended",callId:vt.callId,remoteId:vt.remoteId,name:vt.data.filename,error:"canceled"}),vt.callbacks.failure("canceled"),this.onHangup(vt.callId);else if(vt.pushDataStatus.state==="active")this.onHangup(vt.callId);else{if(vt.pushDataStatus.state!=="ready")return cn.error("cancelPushData - wrong state"),"wrong state";vt.clientCall&&this.cancelPushData(vt.clientCall.callId),vt.success={state:"complete"},Hn.createEvent({eventType:"onFileSended",callId:vt.callId,remoteId:vt.remoteId}),vt.callbacks.success(vt.success),this.onHangup(vt.callId)}return null},this.setVideoBandwidth=function(nt,vt,Tt){if(typeof nt=="number"){var Pt=!1,wt=!1;if(vt==="overall"?Tt==="incoming"?nt>0?(this.videoBandwidthSettings.overallIncoming=nt,Pt=!0):(delete this.videoBandwidthSettings.overallIncoming,Pt=!0):Tt==="outgoing"&&(nt>0?(this.videoBandwidthSettings.overallOutgoing=nt,Pt=!0,wt=!0):(delete this.videoBandwidthSettings.overallOutgoing,Pt=!0,wt=!0)):vt==="perCall"?Tt==="incoming"?nt>0?(this.videoBandwidthSettings.perCallIncoming=nt,Pt=!0):(delete this.videoBandwidthSettings.perCallIncoming,Pt=!0):Tt==="outgoing"&&(nt>0?(this.videoBandwidthSettings.perCallOutgoing=nt,Pt=!0,wt=!0):(delete this.videoBandwidthSettings.perCallOutgoing,Pt=!0,wt=!0)):vt==="remote"&&(this.videoRemoteBandwidth=nt),Pt)for(var Dt=this.MCUClient.sessionMCUs.length;--Dt>=0;){var Et={type:"info",infoType:"setVideoBandwidthSettings",data:{clientId:this.clientId,roomId:this.MCUClient.sessionMCUs[Dt].roomName,pubSub:this.MCUClient.pubConnector,videoBandwidthSettings:this.videoBandwidthSettings}},jt=JSON.stringify(Et);cn.log("C->S: "+jt),apiCC.session.channel.socket.emit("info",jt)}wt&&this.evalOutgoingVideoBandwithCap()}else cn.error("Unvalid target bandwidth usage value needs to be a number :",nt)},this.setAudioBandwidth=function(nt){this.audioBandwidth=nt},this.setDataBandwidth=function(nt){this.dataBandwidth=nt},this.processCheckCallStatus=function(nt){this.MCUClient.processCheckCallStatus(nt);var vt={type:"updateCallStatus",clientId:this.clientId,data:{}};nt.data.pubSub&&(vt.data.pubSub=nt.data.pubSub),vt.sessions=[];for(var Tt=0;Tt<this.MCUClient.sessionMCUs.length;Tt+=1)vt.sessions.push(this.MCUClient.createSessionDescriptor(this.MCUClient.sessionMCUs[Tt]));vt.calls=[];for(var Pt=0;Pt<this.userMediaTable.length;Pt+=1){var wt=this.userMediaTable[Pt];vt.calls.push({callId:wt.userMediaId,callType:wt.callType,remoteId:wt.remoteId,roomId:wt.roomId,data:wt.data,meshPublish:!0})}for(var Dt=0;Dt<this.callsTable.length;Dt+=1){var Et=this.callsTable[Dt];vt.calls.push({callId:Et.callId,callType:Et.callType,remoteId:Et.remoteId,roomId:Et.roomId,data:Et.data,remoteStream:Et.mcuRemoteStream})}var jt=JSON.stringify(vt);apiCC.session.channel.socket.emit("updateCallStatus",jt)},this.processRemoteStreamAdded=function(nt,vt){if(nt.sessionMCU&&nt.sessionMCU.modeChangeKind==="new"){cn.debug("processRemoteStreamAdded",nt);var Tt=this.MCUClient.getSessionMCU(null,{callback:function(wt){return wt.roomName===nt.sessionMCU.roomName&&wt.modeChangeKind==="old"}});if(!Tt)return void cn.error("wrong roomId: no such old session");cn.debug("oldSessionMCU",Tt);for(var Pt=this.callsTable.length;--Pt>=0;)if(this.callsTable[Pt].sessionMCU===Tt&&(0,ct.ki)(this.callsTable[Pt],["mcuRemoteStream","attributes","callId"],"string")&&this.callsTable[Pt].mcuRemoteStream.attributes.callId===nt.mcuRemoteStream.attributes.callId){cn.debug("processRemoteStreamAdded: bye",this.callsTable[Pt]),this.removeCallFromTableWithCallIdAndSendBye(this.callsTable[Pt].callId);break}}},this.processDistantCallEstablished=function(nt){if(cn.debug("processDistantCallEstablished",nt),(0,ct.ki)(nt,["descriptor","callFeed","callId"],"string"))if(nt.descriptor.callFeed.clientId===this.clientId){var vt=null;if(nt.descriptor.callMode==="mesh"?vt=this.MCUClient.getSessionMCU(null,{callback:function(An){return An.roomName===nt.descriptor.roomId&&An.roomMode==="mesh"}}):nt.descriptor.callMode==="sfu"&&(vt=this.MCUClient.getSessionMCU(null,{callback:function(An){return An.roomName===nt.descriptor.roomId&&!An.hasOwnProperty("roomMode")}})),vt){cn.debug("sessionMCU",vt);var Tt=null,Pt=null;if(nt.descriptor.callMode==="mesh"?(Tt=this.findUserMediaById(nt.descriptor.callFeed.callId),cn.debug("userMedia",Tt)):(Pt=this.findCallWithCallId(nt.descriptor.callFeed.callId),cn.debug("call",Pt)),nt.active){if(!Tt&&!Pt)return void cn.debug("wrong callId: no such call");for(var wt=this.MCUClient.distantCalls.length;--wt>=0&&(this.MCUClient.distantCalls[wt].roomId!==nt.descriptor.roomId||this.MCUClient.distantCalls[wt].clientId!==nt.descriptor.clientId||this.MCUClient.distantCalls[wt].callId!==nt.descriptor.callId););if(wt>=0){if(!this.MCUClient.distantCalls[wt].early)return void cn.debug("processDistantCallEstablished: descriptor already exists");cn.debug("processDistantCallEstablished: replace early descriptor",this.MCUClient.distantCalls[wt],nt.descriptor),this.MCUClient.distantCalls[wt]=nt.descriptor}else cn.debug("processDistantCallEstablished: add descriptor",nt.descriptor),this.MCUClient.distantCalls.push(nt.descriptor)}else if(vt.modeChangeKind==="old"){for(var Dt=this.MCUClient.distantCalls.length;--Dt>=0;)if(this.MCUClient.distantCalls[Dt].roomId===nt.descriptor.roomId&&this.MCUClient.distantCalls[Dt].clientId===nt.descriptor.clientId&&this.MCUClient.distantCalls[Dt].callId===nt.descriptor.callId){cn.debug("processDistantCallEstablished: set descriptor to removed",this.MCUClient.distantCalls[Dt]),this.MCUClient.distantCalls[Dt].removed=!0;break}}else for(var Et=this.MCUClient.distantCalls.length;--Et>=0;)if(this.MCUClient.distantCalls[Et].roomId===nt.descriptor.roomId&&this.MCUClient.distantCalls[Et].clientId===nt.descriptor.clientId&&this.MCUClient.distantCalls[Et].callId===nt.descriptor.callId){cn.debug("processDistantCallEstablished: remove descriptor",this.MCUClient.distantCalls[Et]),this.MCUClient.distantCalls.splice(Et,1);break}if(vt.modeChangeKind==="new"){var jt=this.MCUClient.getSessionMCU(null,{callback:function(An){return An.roomName===nt.descriptor.roomId&&An.modeChangeKind==="old"}});if(!jt)return void cn.error("wrong roomId: no such old session");cn.debug("oldSessionMCU",jt),cn.debug("processDistantCallEstablished: replacement");for(var Yt=!1,en=this.userMediaTable.length;--en>=0;){var Kt=this.userMediaTable[en];if(Kt.sessionMCU===jt){var rn=!1,hn=0;cn.debug("processDistantCallEstablished: userMedia",Kt);for(var an=Kt.distantCalls.length;--an>=0;)Kt.distantCalls[an].replaced?hn+=1:Kt.distantCalls[an].callFeed.callId===nt.descriptor.callFeed.callId&&(cn.debug("processDistantCallEstablished: distantCall",Kt.distantCalls[an]),rn=!0,Kt.distantCalls[an].replaced=!0,hn+=1);if(rn){if(hn===Kt.distantCalls.length){cn.debug("processDistantCallEstablished: remove replaced distant call descriptors");for(var un=this.MCUClient.distantCalls.length;--un>=0;)this.MCUClient.distantCalls[un].callMode==="mesh"&&this.MCUClient.distantCalls[un].callFeed.callId===Kt.userMediaId&&this.MCUClient.distantCalls[un].replaced&&(cn.debug("processDistantCallEstablished: remove distantCall",this.MCUClient.distantCalls[un]),this.MCUClient.distantCalls.splice(un,1));cn.debug("processDistantCallEstablished: close old calls");for(var Sn=this.callsTable.slice(),En=Sn.length;--En>=0;)(0,ct.ki)(Sn[En].data,"mesh","object")&&Sn[En].data.mesh.calleeCallId===Kt.userMediaId&&Sn[En].settingUpType!=="subscribe"&&this.removeCallFromTableWithCallIdAndSendBye(Sn[En].callId);this.MCUClient.meshOnHangup(Kt.userMediaId),Yt=!0}break}}}Yt&&this.finalizeMeshToJanusTransition(jt,vt)}}else cn.debug("wrong roomId: no such session")}else cn.debug("wrong clientId: message not intended for self");else cn.debug("wrong format: missing callFeed")},this.finalizeMeshToJanusTransition=function(nt,vt){var Tt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};cn.debug("finalizeMeshToJanusTransition");var Pt=0,wt=0;if(Tt.force===!0){for(var Dt=this.callsTable.slice(),Et=Dt.length;--Et>=0;){var jt=Dt[Et];jt.sessionMCU===nt&&((jt.settingUpType==="publish"||jt.settingUpType==="shareScreen")&&jt.data&&jt.data.mesh?this.onHangup(jt.callId):this.onHangup(jt.callId,"disconnected"))}for(var Yt=this.userMediaTable.slice(),en=Yt.length;--en>=0;){var Kt=Yt[en];Kt.sessionMCU===nt&&this.onHangup(Kt.userMediaId,"disconnected")}}else for(var rn=this.userMediaTable.length;--rn>=0;){var hn=this.userMediaTable[rn];if(hn.sessionMCU===nt){Pt+=1;for(var an=0,un=hn.distantCalls.length;--un>=0;)cn.debug("finalizeMeshToJanusTransition: distantCall",hn.distantCalls[un]),hn.distantCalls[un].replaced&&(an+=1);an===hn.distantCalls.length&&(wt+=1)}}Pt===wt&&(cn.debug("finalizeMeshToJanusTransition: finalize transition"),vt.transitionTimeoutId&&(clearTimeout(vt.transitionTimeoutId),delete vt.transitionTimeoutId),this.MCUClient.removeSessionMCU(nt),delete vt.modeChangeKind,this.MCUClient.transitionCount-=1,this.MCUClient.transitionCount<=0&&this.evalOutgoingVideoBandwithCap(),Hn.createMCURoomModeChangedEvent(vt.roomName,"mesh","sfu","complete"))},this.processConfigureEncodings=function(nt){var vt=this.findCallWithCallId(nt.callId);if(vt&&Object.prototype.hasOwnProperty.call(nt,"command")&&vt.simulcast==="RID"){var Tt={};Object.prototype.hasOwnProperty.call(nt,"maxBitrate")&&(Tt.maxBitrate=nt.maxBitrate),vt.configureSimulcastEncodings(nt.command,Tt)}},this.processSimulcastFeedChanged=function(nt){var vt=this.findCallWithCallId(nt.callId);if(vt){var Tt={};nt.substream===2?Tt.streamQuality="high":nt.substream===1?Tt.streamQuality="medium":nt.substream===0&&(Tt.streamQuality="low"),nt.temporal===2?Tt.streamFrameRate="high":nt.temporal===1?Tt.streamFrameRate="medium":nt.temporal===0&&(Tt.streamFrameRate="low"),Object.keys(Tt).length>0&&Hn.createSimulcastFeedChanged(vt.callId,Tt)}},this.hasReceiptHook=function(nt){if(!nt||typeof nt!="string")throw new Error("wrong receiptId");return Object.prototype.hasOwnProperty.call(this.receiptHooks,nt)},this.createReceiptHook=function(nt,vt){var Tt=this;if(this.hasReceiptHook(nt))throw new Error("receiptHook already exists");if(!vt||vt.fulfilled!==!1)throw new Error("wrong future");vt.onFulfillment(function(){delete Tt.receiptHooks[nt]}),this.receiptHooks[nt]=vt},this.finalizeReceiptHookFailure=function(nt,vt){if(cn.debug("finalizeReceiptHookFailure",nt,vt),!nt||typeof nt!="string")throw new Error("wrong receiptId");if(!Object.prototype.hasOwnProperty.call(this.receiptHooks,nt))throw new Error("receiptHook does not exist");this.receiptHooks[nt].fulfill(vt)},this.finalizeReceiptHookSuccess=function(nt,vt){if(cn.debug("finalizeReceiptHookSuccess",nt,vt),!nt||typeof nt!="string")throw new Error("wrong receiptId");if(!Object.prototype.hasOwnProperty.call(this.receiptHooks,nt))throw new Error("receiptHook does not exist");this.receiptHooks[nt].fulfill(null,vt)},this.processReceipt=function(nt){if(nt&&tr(nt)==="object"){var vt=nt.receiptId,Tt=nt.result;if(vt&&typeof vt=="string")try{this.finalizeReceiptHookSuccess(vt,Tt)}catch(Pt){cn.debug("processReceipt: finalizeReceiptHookSuccess",Pt)}else cn.warn("processReceipt: wrong receiptId")}else cn.warn("processReceipt: wrong msg")},this.processError=function(nt){var vt=nt.receiptId,Tt=nt.errorInfo,Pt=nt.errorCode,wt=nt.callId,Dt=nt.roomId,Et=nt.convId;if(vt&&typeof vt=="string")try{this.finalizeReceiptHookFailure(vt,new Error(Tt))}catch(jt){cn.debug("processError: finalizeReceiptHookFailure",jt)}Hn.createErrorEvent(Tt,Pt,wt,Dt,null,null,Et)},this.createCallControl=function(nt){var vt=new ar(nt);return this.callControlTable.push(vt),vt},this.destroyCallControl=function(nt){if(nt.multi){if(!nt.roomName)return cn.warn("findCallControl: cannot destroy without roomName"),null;for(var vt=[],Tt=this.callControlTable.length;--Tt>=0;)this.callControlTable[Tt].roomName===nt.roomName&&(vt.push(this.callControlTable[Tt]),this.callControlTable.splice(Tt,1));return vt}var Pt=this.findCallControl(nt,{accept:"index"});if(Pt!==null&&Pt>=0){var wt=this.callControlTable[Pt];return this.callControlTable.splice(Pt,1),wt}return null},this.findCallControl=function(nt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Tt=vt.accept==="index";if(nt.type==="publish"||nt.type==="shareScreen"){if(!nt.callId)return cn.warn("findCallControl: cannot search without callId"),null;for(var Pt=null,wt=null,Dt=this.callControlTable.length;--Dt>=0;)if((this.callControlTable[Dt].type==="publish"||this.callControlTable[Dt].type==="shareScreen")&&this.callControlTable[Dt].callId===nt.callId){Pt=this.callControlTable[Dt],wt=Dt;break}return Pt?Tt?wt:Pt:null}if(nt.type==="subscribe"){if(!(0,ct.ki)(nt,"stream","object")||!Object.prototype.hasOwnProperty.call(nt.stream,"id")||!(0,ct.ki)(nt.stream,"attributes","object"))return cn.warn("findCallControl: cannot search without stream"),null;for(var Et=null,jt=null,Yt=this.callControlTable.length;--Yt>=0;)if(this.callControlTable[Yt].type==="subscribe"&&(this.callControlTable[Yt].stream.id===nt.stream.id||this.callControlTable[Yt].stream.attributes.callerId===nt.stream.attributes.callerId&&this.callControlTable[Yt].stream.attributes.callId===nt.stream.attributes.callId)){Et=this.callControlTable[Yt],jt=Yt;break}return Et?Tt?jt:Et:null}return cn.warn("findCallControl: wrong type",nt.type),null},this.getCallControls=function(nt){var vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Tt={};if(vt.addUserMedia)for(var Pt=this.userMediaTable.length;--Pt>=0;){var wt=this.userMediaTable[Pt];Tt[wt.userMediaId]=wt}if(nt){for(var Dt=this.callControlTable.length;--Dt>=0;){var Et=this.callControlTable[Dt];nt.indexOf(Et.type)>=0&&(Tt[Et.callId]=Et)}return Tt}for(var jt=this.callControlTable.length;--jt>=0;){var Yt=this.callControlTable[jt];Tt[Yt.callId]=Yt}return Tt},this.getCallIds=function(nt){for(var vt=[],Tt=this.callControlTable.length;--Tt>=0;){var Pt=this.callControlTable[Tt];nt.indexOf(Pt.type)>=0&&vt.push(Pt.callId)}return vt},this.evalOutgoingVideoBandwithCap=function(nt){if(cn.debug("evalOutgoingVideoBandwithCap"),!(this.MCUClient.transitionCount>0)){var vt=null;this.videoBandwidthSettings.perCallOutgoing&&(vt=this.videoBandwidthSettings.perCallOutgoing);for(var Tt=[],Pt=this.callsTable.length;--Pt>=0;)this.callsTable[Pt].belongsToRoom()&&this.callsTable[Pt].settingUpType!=="publish"&&this.callsTable[Pt].settingUpType!=="shareScreen"||this.callsTable[Pt].localCallProfile&&this.callsTable[Pt].localCallProfile.video&&this.callsTable[Pt].localCallProfile.videoActive&&Tt.push(this.callsTable[Pt]);if(Tt.length===0)return vt;if(this.videoBandwidthSettings.overallOutgoing){var wt=Math.floor(this.videoBandwidthSettings.overallOutgoing/Tt.length);vt=vt?Math.min(vt,wt):wt}for(var Dt=Tt.length;--Dt>=0;)nt&&Tt[Dt]===nt?vt&&Tt[Dt].videoCap!==vt?(Tt[Dt].videoCap=vt,this.rtpSenderSetParamatersCapable&&Tt[Dt].applyOutgoingBitrate(Tt[Dt].videoCap)):!vt&&Tt[Dt].videoCap&&(delete Tt[Dt].videoCap,this.rtpSenderSetParamatersCapable&&Tt[Dt].applyOutgoingBitrate(null)):vt&&Tt[Dt].videoCap!==vt?(Tt[Dt].videoCap=vt,this.rtpSenderSetParamatersCapable?Tt[Dt].applyOutgoingBitrate(Tt[Dt].videoCap):setTimeout(function(Et){Et.belongsToRoom()||!Et.callee?(Et.updateUserMedia=!0,Et.establishCall()):cn.debug("Call is not to be updated")},0,Tt[Dt])):!vt&&Tt[Dt].videoCap&&(delete Tt[Dt].videoCap,this.rtpSenderSetParamatersCapable?Tt[Dt].applyOutgoingBitrate(null):setTimeout(function(Et){Et.belongsToRoom()||!Et.callee?(Et.updateUserMedia=!0,Et.establishCall()):cn.debug("Call is not to be updated")},0,Tt[Dt]));return vt}cn.debug("evalOutgoingVideoBandwithCap - transition ongoing")},this.callback=function(nt,vt){return this.closureHandler=function(Tt){return nt[vt](Tt)},this.closureHandler},this.callbackWithParams=function(nt,vt){return this.closureHandler=function(Tt,Pt,wt){return nt[vt](Tt,Pt,wt)},this.closureHandler},this.simulatedAgentLaunchWaitingCall=function(){this.socket.emit("simulatedAgentLaunchWaitingCall",{type:"simulatedAgentLaunchWaitingCall"})}},Wn=(s(2707),tt.Y.get("PreCallTest")),ir=125e3,nr=2e4,xn=apiCC.myWebRTC_Event,Un=function(qt,Rt,nt,vt,Tt){var Pt=this;this.webRTCClient=qt.webRTCClient,this.notifyTerminated=qt.notifyTerminated,this.audioSourceId=vt,this.videoSourceId=Tt,this.testId="initial",this.stepId="initial",this.report={tests:[],resolutions:[],failurCause:""},this.maxHeight=240,this.maxWidth=320,this.resolutions=[[320,240,"QVGA"],[640,480,"VGA"],[1024,576,"SD"],[1280,720,"HD 720p"],[1920,1080,"HD 1080p"]],this.currentResolution=0,this.userMediastreamId=null,nt==="simpleVideoRecordTest"&&(Wn.warn("Simple video record test is activated"),this.simpleVideoRecordTest=!0),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshModeEnabled===!0&&(Wn.debug("Forcing meshModeEnabled to false for precall test"),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshModeEnabled=!1,this.modifyMeshModeEnabledValueBeforePreCall=!0),this.generateId=function(wt){for(var Dt="",Et="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",jt=0;jt<wt;jt+=1)Dt+=Et.charAt(Math.floor(Math.random()*Et.length));return Dt},this.generateRoomId=function(){return"PC-"+this.generateId(4)+"-"+this.generateId(4)+"-"+this.generateId(4)},this.pushStats=function(wt,Dt){return wt.data.push(Dt),!0},this.evalQuartiles=function(wt,Dt,Et){var jt=[];if(Et===void 0?wt.forEach(function(qr){typeof qr[Dt]=="number"&&jt.push(qr[Dt])}):wt.forEach(function(qr){jt.push(Et(qr[Dt]))}),jt.sort(function(qr,Qr){return qr<Qr?-1:qr===Qr?0:1}),jt.length%2==0){var Yt=jt.length/2,en=Math.floor((jt[Yt-1]+jt[Yt])/2);if(Yt%2==0){var Kt=Yt/2,rn=Math.floor((jt[Kt-1]+jt[Kt])/2),hn=Yt+Kt,an=Math.floor((jt[hn-1]+jt[hn])/2);return{min:jt[0],firstQuartile:rn,median:en,thirdQuartile:an,max:jt[jt.length-1]}}var un=Math.floor(Yt/2),Sn=jt[un],En=jt[Yt+un];return{min:jt[0],firstQuartile:Sn,median:en,thirdQuartile:En,max:jt[jt.length-1]}}var An=Math.floor(jt.length/2),Dn=jt[An];if((An+1)%2==0){var Bn=(An+1)/2,sr=Math.floor((jt[Bn-1]+jt[Bn])/2),fr=An+Bn,Cr=Math.floor((jt[fr-1]+jt[fr])/2);return{min:jt[0],firstQuartile:sr,median:Dn,thirdQuartile:Cr,max:jt[jt.length-1]}}var gr=Math.floor(An/2),wr=jt[gr],Nr=jt[An+gr];return{min:jt[0],firstQuartile:wr,median:Dn,thirdQuartile:Nr,max:jt[jt.length-1]}},this.runBitRateTest=function(){apiCC.webRTCCompliant?(Wn.debug("Run bitrate test"),this.testId==="initial"&&(this.handlers=[{type:"joinMCUSessionAnswer",callback:this.handleJoinMCUSessionAnswer.bind(this)},{type:"MCUAvailableStream",callback:this.handleMCUAvailableStream.bind(this)},{type:"onCallStatsUpdate",callback:this.handleOnCallStatsUpdate.bind(this)},{type:"remoteStreamAdded",callback:this.handleRemoteStreamAdded.bind(this)},{type:"userMediaSuccess",callback:this.handleuserMediaSuccess.bind(this)},{type:"MCURecordedStreamsAvailable",callback:this.handleRecordingStreamAvailable.bind(this)}],this.handlers.forEach(function(wt){apiRTC.addEventListener(wt.type,wt.callback)}),this.webRTCClient.setMCUConnector("mcu4.apizee.com"),this.webRTCClient.setAllowMultipleCalls(!0),this.webRTCClient.enableCallStatsMonitoring(!0,1e3),this.webRTCClient.enableQualityEvaluating(!0,1e3),this.startNextTest())):(this.report.failurCause="Your device is not WebRTC Compliant",this.terminate())},this.startNextTest=function(){if(this.simpleVideoRecordTest===!0)this.testId==="initial"?(Wn.debug("initial simple test"),Rt?this.runResolutionTest():this.startTestAudioNlVideo(2e3)):this.testId==="resolution-test"?(Wn.debug("resolution-test simple"),this.startTestAudioNlVideo(2e3)):this.testId==="audio-and-video-2000"&&(Wn.debug("Before recordThenTerminate simple"),this.recordThenTerminate());else if(this.testId==="initial")Rt?this.runResolutionTest():this.startTestAudioNlVideo(nt);else if(this.testId==="resolution-test")this.startTestAudioNlVideo(nt);else if(this.testId==="audio-and-video-"+nt)if(this.report[this.testId].status==="success"){var wt=this.report[this.testId].subscribeCallIds[0],Dt=this.stats[wt].videoReceived;Dt.bitsReceivedPerSecond.max!==void 0&&Dt.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():Dt.bitsReceivedPerSecond.max>=15e5?this.startTestAudioNlVideo(1500):Dt.bitsReceivedPerSecond.max>=1e6?this.startTestAudioNlVideo(1e3):Dt.bitsReceivedPerSecond.max>=6e5?this.startTestAudioNlVideo(600):Dt.bitsReceivedPerSecond.max>=25e4?this.startTestAudioNlVideo(250):this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else if(this.testId==="audio-and-video-1500")if(this.report[this.testId].status==="success"){var Et=this.report[this.testId].subscribeCallIds[0],jt=this.stats[Et].videoReceived;jt.bitsReceivedPerSecond.max!==void 0&&jt.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():jt.bitsReceivedPerSecond.max>=1e6?this.startTestAudioNlVideo(1e3):jt.bitsReceivedPerSecond.max>=6e5?this.startTestAudioNlVideo(600):jt.bitsReceivedPerSecond.max>=25e4?this.startTestAudioNlVideo(250):this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else if(this.testId==="audio-and-video-1000")if(this.report[this.testId].status==="success"){var Yt=this.report[this.testId].subscribeCallIds[0],en=this.stats[Yt].videoReceived;en.bitsReceivedPerSecond.max!==void 0&&en.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():en.bitsReceivedPerSecond.max>=6e5?this.startTestAudioNlVideo(600):en.bitsReceivedPerSecond.max>=25e4?this.startTestAudioNlVideo(250):this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else if(this.testId==="audio-and-video-600")if(this.report[this.testId].status==="success"){var Kt=this.report[this.testId].subscribeCallIds[0],rn=this.stats[Kt].videoReceived;rn.bitsReceivedPerSecond.max!==void 0&&rn.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():rn.bitsReceivedPerSecond.max>=25e4?this.startTestAudioNlVideo(250):this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else if(this.testId==="audio-and-video-250")if(this.report[this.testId].status==="success"){var hn=this.report[this.testId].subscribeCallIds[0],an=this.stats[hn].videoReceived;an.bitsReceivedPerSecond.max!==void 0&&an.bitsReceivedPerSecond.max+.15*this.videoBandwidth*1e3>=1e3*this.videoBandwidth?this.recordThenTerminate():this.startTestAudioNlOnly()}else this.startTestAudioNlOnly();else this.recordThenTerminate()},this.startTestAudioNlVideo=function(wt){this.prepareEnvForNewTest(),Wn.debug("%ctestAudioNlVideo"+wt),this.testId="audio-and-video-"+wt,this.report.tests.push(this.testId),this.audioEnabled=!0,this.videoEnabled=!0,this.videoBandwidth=wt,this.webRTCClient.setRemoteVideoBandwidth(this.videoBandwidth),this.stats={},this.report[this.testId]={audioEnabled:!0,audioLimited:!1,videoEnabled:!0,videoLimited:!0,videoBandwidth:this.videoBandwidth,stats:this.stats},this.mcuSession={},this.mcuSession.roomId=this.generateRoomId(),this.report[this.testId].roomId=this.mcuSession.roomId,this.webRTCClient.joinMCUSession(this.mcuSession.roomId),this.stepId="joining-mcu-session",this.timeoutId=setTimeout(this.abortJoinMCUSession.bind(this),nr)},this.startTestAudioNlOnly=function(){this.prepareEnvForNewTest(),Wn.debug("%cstartTestAudioNlOnly"),this.testId="audio-only",this.report.tests.push(this.testId),this.audioEnabled=!0,this.videoEnabled=!1,this.webRTCClient.setRemoteVideoBandwidth(null),this.stats={},this.report[this.testId]={audioEnabled:!0,audioLimited:!1,videoEnabled:!1,stats:this.stats},this.mcuSession={},this.mcuSession.roomId=this.generateRoomId(),this.report[this.testId].roomId=this.mcuSession.roomId,this.webRTCClient.joinMCUSession(this.mcuSession.roomId),this.stepId="joining-mcu-session",this.timeoutId=setTimeout(this.abortJoinMCUSession.bind(this),nr)},this.startTestVideoNlOnly=function(){this.prepareEnvForNewTest(),Wn.debug("%cstartTestVideoNlOnly"),this.testId="video-only",this.report.tests.push(this.testId),this.audioEnabled=!1,this.videoEnabled=!0,this.videoBandwidth=600,this.webRTCClient.setRemoteVideoBandwidth(this.videoBandwidth),this.stats={},this.report[this.testId]={audioEnabled:!1,audioLimited:!1,videoEnabled:!0,stats:this.stats},this.mcuSession={},this.mcuSession.roomId=this.generateRoomId(),this.report[this.testId].roomId=this.mcuSession.roomId,this.webRTCClient.joinMCUSession(this.mcuSession.roomId),this.stepId="joining-mcu-session",this.timeoutId=setTimeout(this.abortJoinMCUSession.bind(this),nr)},this.recordThenTerminate=function(){Pt.modifyMeshModeEnabledValueBeforePreCall===!0&&(Wn.debug("Restoring meshModeEnabled to true, as it was modified for precall test"),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.meshModeEnabled=!0);var wt=null;if(Pt.videoEnabled&&Pt.audioEnabled?wt="AUDIO-VIDEO":Pt.audioEnabled?wt="AUDIO-ONLY":Pt.videoEnabled&&(wt="VIDEO-ONLY"),!wt)return Wn.error("Can't define record type"),void Pt.terminate();Wn.debug("Start recording with type:",wt),Pt.webRTCClient.startRecording(wt,"recordPreCall",null,null,{ttl:900}),setTimeout(function(){Wn.debug("Stop recording"),Pt.webRTCClient.stopRecording()},1e4)},this.terminate=function(){Wn.debug("Terminate"),this.testId="terminated",this.handlers&&this.handlers.forEach(function(wt){apiRTC.removeEventListener(wt.type,wt.callback)}),this.notifyTerminated(this.report),this.leaveSession()},this.succeed=function(){xn.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"success",stepId:this.stepId}),this.report[this.testId].status="success",this.startNextTest()},this.fail=function(){Wn.debug("fail"),xn.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"failure",stepId:this.stepId}),this.report[this.testId].status="failure",this.report[this.testId].stepId=this.stepId,this.leaveSession(),this.startNextTest()},this.prepareEnvForNewTest=function(){Pt.mcuSession!==void 0&&Pt.leaveSession()},this.abortJoinMCUSession=function(){Wn.debug("abortJoinMCUSession"),this.fail()},this.abortStreamPublishing=function(){Wn.debug("abortStreamPublishing"),this.fail()},this.abortStreamSubscribing=function(){Wn.debug("abortStreamSubscribing"),this.fail()},this.observeStreamPublished=function(){if(Wn.debug("observeStreamPublished"),apiRTC.browser==="Safari"||apiRTC.browser==="Mobile Safari")return Wn.info("Safari"),Wn.error("observeStreamPublished not supported on Safari"),clearInterval(this.intervalId),void this.fail();if(this.intervalCounter+=1,this.intervalCounter>30)return clearInterval(this.intervalId),void this.fail();if(this.audioEnabled&&this.videoEnabled){var wt=0;if(this.stats[this.publishCallId]!==void 0&&(this.stats[this.publishCallId].audioSent!==void 0&&this.stats[this.publishCallId].audioSent.bitsSentPerSecond!==void 0&&this.stats[this.publishCallId].audioSent.bitsSentPerSecond.thirdQuartile>=2e4&&(wt+=1),this.stats[this.publishCallId].videoSent!==void 0&&this.stats[this.publishCallId].videoSent.bitsSentPerSecond!==void 0&&this.stats[this.publishCallId].videoSent.bitsSentPerSecond.thirdQuartile>=ir&&(wt+=1)),wt===2){clearInterval(this.intervalId);var Dt=this.streams[0];this.subscribeToUserStream(Dt.attributes.callerId,Dt.id,"VIDEO"),this.stepId="stream-subscribing",this.timeoutId=setTimeout(this.abortStreamSubscribing.bind(this),nr)}else Wn.debug("okCnt !== 2")}else if(this.audioEnabled)if(this.stats[this.publishCallId]!==void 0)if(this.stats[this.publishCallId].audioSent!==void 0&&this.stats[this.publishCallId].audioSent.bitsSentPerSecond!==void 0)if(this.stats[this.publishCallId].audioSent.bitsSentPerSecond.thirdQuartile>=2e4){clearInterval(this.intervalId);var Et=this.streams[0];this.subscribeToUserStream(Et.attributes.callerId,Et.id,"AUDIOONLY"),this.stepId="stream-subscribing",this.timeoutId=setTimeout(this.abortStreamSubscribing.bind(this),nr)}else Wn.debug("no stats audio 1 ");else Wn.debug("no stats audio 2");else Wn.debug("no stats audio 3");else if(this.videoEnabled)if(this.stats[this.publishCallId]!==void 0)if(this.stats[this.publishCallId].videoSent!==void 0&&this.stats[this.publishCallId].videoSent.bitsSentPerSecond!==void 0)if(this.stats[this.publishCallId].videoSent.bitsSentPerSecond.thirdQuartile>=ir){clearInterval(this.intervalId);var jt=this.streams[0];this.subscribeToUserStream(jt.attributes.callerId,jt.id,"VIDEOONLY"),this.stepId="stream-subscribing",this.timeoutId=setTimeout(this.abortStreamSubscribing.bind(this),nr)}else Wn.debug("no stats video 1 ");else Wn.debug("no stats video 2");else Wn.debug("no stats video 3");else Wn.debug("no audio or video"),clearInterval(this.intervalId),this.fail()},this.observeStreamSubscribed=function(){if(this.intervalCounter+=1,this.intervalCounter>30)return clearInterval(this.intervalId),void this.succeed();var wt=null,Dt=null,Et=0,jt=0;this.audioEnabled&&(wt=this.stats[this.publishCallId].audioSent),this.videoEnabled&&(Dt=this.stats[this.publishCallId].videoSent);for(var Yt=0;Yt<this.subscribeCallIds.length;Yt+=1){var en=this.subscribeCallIds[Yt];if(this.audioEnabled&&this.videoEnabled){var Kt=0;this.stats[en]!==void 0&&(this.stats[en].audioReceived!==void 0&&this.stats[en].audioReceived.bitsReceivedPerSecond!==void 0&&wt!=null&&wt.bitsSentPerSecond!==void 0&&this.stats[en].audioReceived.bitsReceivedPerSecond.thirdQuartile>=wt.bitsSentPerSecond.firstQuartile-2e3&&(Kt+=1),this.stats[en].videoReceived!==void 0&&this.stats[en].videoReceived.bitsReceivedPerSecond!==void 0&&Dt!=null&&Dt.bitsSentPerSecond!==void 0&&this.stats[en].videoReceived.bitsReceivedPerSecond.thirdQuartile>=Dt.bitsSentPerSecond.firstQuartile&&(Kt+=1)),Kt===2&&(Et+=1)}else this.audioEnabled?this.stats[en]!==void 0&&this.stats[en].audioReceived!==void 0&&this.stats[en].audioReceived.bitsReceivedPerSecond!==void 0&&wt!=null&&wt.bitsSentPerSecond!==void 0&&this.stats[en].audioReceived.bitsReceivedPerSecond.thirdQuartile>=wt.bitsSentPerSecond.firstQuartile&&(Et+=1):jt+=1}jt>0?(clearInterval(this.intervalId),this.fail()):Et===this.subscribeCallIds.length&&(clearInterval(this.intervalId),this.succeed())},this.handleJoinMCUSessionAnswer=function(wt){if(this.stepId==="joining-mcu-session"){if(xn.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"start",stepId:this.stepId}),clearTimeout(this.timeoutId),this.mcuSession.sessionId=wt.detail.sessionId,this.mcuSession.token=wt.detail.token,this.audioEnabled&&this.videoEnabled){var Dt=this,Et={audio:{},video:{}};Et=apiCC.setResolutionInConstraint(this.maxWidth,this.maxHeight,Et),Wn.debug("constraints :",Et),apiRTC.createUserMediaStream({type:"media",audioSourceId:this.audioSourceId,videoSourceId:this.videoSourceId,gum_config:Et,release:function(jt){Wn.debug("createUserMediaStream release",jt.userMediaStreamId)},success:function(jt){Wn.debug("createUserMediaStream success",jt.userMediaStreamId),Wn.debug("audioSourceId",vt),Wn.debug("videoSourceId",Tt)},failure:function(jt,Yt){Wn.error("createUserMediaStream failure",jt.userMediaStreamId),Wn.error("failure; userMediaStreamId: "+jt.userMediaStreamId),Wn.error("failure; error: "+Yt),xn.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"failure",stepId:this.stepId,createUserMediaStreamError:Yt}),Dt.terminate()}})}else if(this.audioEnabled)this.publishCallId=this.webRTCClient.publish(this.mcuSession.roomId,this.mcuSession.sessionId,this.mcuSession.token,{audioOnly:!0});else{if(!this.videoEnabled)return void this.fail();this.publishCallId=this.webRTCClient.publish(this.mcuSession.roomId,this.mcuSession.sessionId,this.mcuSession.token,{videoOnly:!0,qos:{videoStartQuality:"upper"}})}this.subscribeCallIds=[],this.report[this.testId].publishCallId=this.publishCallId,this.report[this.testId].subscribeCallIds=[],this.streams=[],this.stepId="stream-publishing",this.timeoutId=setTimeout(this.abortStreamPublishing.bind(this),nr)}},this.handleuserMediaSuccess=function(wt){var Dt={userMediaStreamId:wt.detail.userMediaStreamId,qos:{videoStartQuality:"upper"}};this.userMediastreamId=wt.detail.userMediaStreamId,this.publishCallId=this.webRTCClient.publish(this.mcuSession.roomId,this.mcuSession.sessionId,this.mcuSession.token,Dt),this.report[this.testId].publishCallId=this.publishCallId},this.handleRecordingStreamAvailable=function(wt){Wn.debug("handleRecordingStreamAvailable"),this.terminate()},this.handleMCUAvailableStream=function(wt){if(this.stepId==="stream-publishing"&&wt.detail.isRemoteStream===!1)for(var Dt=0;Dt<wt.detail.streams.length;Dt+=1){var Et=wt.detail.streams[Dt];if(Et.room===this.mcuSession.roomId&&Et.attributes.callId===this.publishCallId&&this.stepId==="stream-publishing"){if(clearTimeout(this.timeoutId),this.stepId="stream-published",this.streams.push(Et),this.simpleVideoRecordTest===!0){var jt="VIDEO";Et.audio===!1&&(jt="VIDEOONLY"),Et.video===!1&&(jt="AUDIOONLY"),this.subscribeToUserStream(Et.attributes.callerId,Et.id,jt),this.stepId="stream-subscribing"}else this.intervalId=setInterval(this.observeStreamPublished.bind(this),1e3);this.intervalCounter=0}}},this.handleRemoteStreamAdded=function(wt){this.stepId==="stream-subscribing"&&this.subscribeCallIds.find(function(Dt){return Dt===wt.detail.callId})!==void 0&&(clearTimeout(this.timeoutId),this.stepId="stream-subscribed",this.intervalId=setInterval(this.observeStreamSubscribed.bind(this),1e3),this.intervalCounter=0)},this.handleOnCallStatsUpdate=function(wt){var Dt=this;if(this.stepId!=="stream-published"&&this.stepId!=="stream-subscribing"&&this.stepId!=="stream-subscribed"||(this.stats[this.publishCallId]===void 0&&(this.stats[this.publishCallId]={}),wt.detail.stats.audioSent!==void 0&&(this.stats[this.publishCallId].audioSent===void 0&&(this.stats[this.publishCallId].audioSent={startTime:wt.detail.stats.audioSent.timestamp,data:[]}),this.pushStats(this.stats[this.publishCallId].audioSent,wt.detail.stats.audioSent)?this.stats[this.publishCallId].audioSent.data.length>=5&&["bitsSentPerSecond","packetsSentPerSecond"].forEach(function(en){var Kt=Dt.evalQuartiles(Dt.stats[Dt.publishCallId].audioSent.data,en);Kt.sampleCount=Dt.stats[Dt.publishCallId].audioSent.data.length,Kt.time=wt.detail.stats.audioSent.timestamp-Dt.stats[Dt.publishCallId].audioSent.startTime,Dt.stats[Dt.publishCallId].audioSent[en]=Kt}):Wn.debug("audio stats not pushed for :",this.publishCallId)),wt.detail.stats.videoSent!==void 0&&(this.stats[this.publishCallId].videoSent===void 0&&(this.stats[this.publishCallId].videoSent={startTime:wt.detail.stats.videoSent.timestamp,data:[]}),this.pushStats(this.stats[this.publishCallId].videoSent,wt.detail.stats.videoSent)?this.stats[this.publishCallId].videoSent.data.length>=5&&(["bitsSentPerSecond","packetsSentPerSecond","framesEncodedPerSecond"].forEach(function(en){var Kt=Dt.evalQuartiles(Dt.stats[Dt.publishCallId].videoSent.data,en);Kt.sampleCount=Dt.stats[Dt.publishCallId].videoSent.data.length,Kt.time=wt.detail.stats.videoSent.timestamp-Dt.stats[Dt.publishCallId].videoSent.startTime,Dt.stats[Dt.publishCallId].videoSent[en]=Kt}),this.stats[this.publishCallId].videoSent.width=wt.detail.stats.videoSent.width,this.stats[this.publishCallId].videoSent.height=wt.detail.stats.videoSent.height):Wn.debug("video stats not pushed for :",this.publishCallId))),this.stepId==="stream-subscribed")for(var Et=function(en){Yt=0;var Kt=Dt.subscribeCallIds[en];Dt.stats[Kt]===void 0&&(Dt.stats[Kt]={}),wt.detail.stats.audioReceived!==void 0&&(Dt.stats[Kt].audioReceived===void 0&&(Dt.stats[Kt].audioReceived={startTime:wt.detail.stats.audioReceived.timestamp,data:[]}),Dt.pushStats(Dt.stats[Kt].audioReceived,wt.detail.stats.audioReceived)?(Yt=Dt.stats[Kt].audioReceived.data.length,Dt.stats[Kt].audioReceived.data[Yt-1].mosS===void 0&&(Dt.stats[Kt].audioReceived.data[Yt-1].mosS={}),Dt.stats[Kt].audioReceived.data[Yt-1].mosS=wt.detail.stats.quality.mosS,Dt.stats[Kt].audioReceived.data.length>=15&&(["bitsReceivedPerSecond","packetsReceivedPerSecond","delay"].forEach(function(rn){var hn=Dt.evalQuartiles(Dt.stats[Kt].audioReceived.data,rn);hn.sampleCount=Dt.stats[Kt].audioReceived.data.length,hn.time=wt.detail.stats.audioReceived.timestamp-Dt.stats[Kt].audioReceived.startTime,Dt.stats[Kt].audioReceived[rn]=hn}),Dt.stats[Kt].audioReceived.data[0].jitter!==void 0&&["jitter"].forEach(function(rn){var hn=Dt.evalQuartiles(Dt.stats[Kt].audioReceived.data,rn,function(an){return Math.floor(1e3*an)});hn.sampleCount=Dt.stats[Kt].audioReceived.data.length,hn.time=wt.detail.stats.audioReceived.timestamp-Dt.stats[Kt].audioReceived.startTime,Dt.stats[Kt].audioReceived[rn]=hn}),Dt.stats[Kt].audioReceived.packetsLost={max:wt.detail.stats.audioReceived.packetsLost,sampleCount:Dt.stats[Kt].audioReceived.data.length,time:wt.detail.stats.audioReceived.timestamp-Dt.stats[Kt].audioReceived.startTime},["packetsLostRatio"].forEach(function(rn){var hn=Dt.evalQuartiles(Dt.stats[Kt].audioReceived.data,rn);hn.sampleCount=Dt.stats[Kt].audioReceived.data.length,hn.time=wt.detail.stats.audioReceived.timestamp-Dt.stats[Kt].audioReceived.startTime,Dt.stats[Kt].audioReceived[rn]=hn}),Dt.stats[Kt].audioReceived.mosS===void 0&&(Dt.stats[Kt].audioReceived.mosS={}),["mosS"].forEach(function(rn){var hn=Dt.evalQuartiles(Dt.stats[Kt].audioReceived.data,rn);hn.sampleCount=Dt.stats[Kt].audioReceived.data.length,Dt.stats[Kt].audioReceived[rn]=hn}))):Wn.error("audio stats not pushed for callId :",Kt)),wt.detail.stats.videoReceived!==void 0&&(Dt.stats[Kt].videoReceived===void 0&&(Dt.stats[Kt].videoReceived={startTime:wt.detail.stats.videoReceived.timestamp,data:[]}),Dt.pushStats(Dt.stats[Kt].videoReceived,wt.detail.stats.videoReceived)?(Yt=Dt.stats[Kt].videoReceived.data.length,Dt.stats[Kt].videoReceived.data[Yt-1].mosV===void 0&&(Dt.stats[Kt].videoReceived.data[Yt-1].mosV={}),Dt.stats[Kt].videoReceived.data[Yt-1].mosAV===void 0&&(Dt.stats[Kt].videoReceived.data[Yt-1].mosAV={}),Dt.stats[Kt].videoReceived.data[Yt-1].mosV=wt.detail.stats.quality.mosV,Dt.stats[Kt].videoReceived.data[Yt-1].mosAV=wt.detail.stats.quality.mosAV,Dt.stats[Kt].videoReceived.data.length>=15&&(["bitsReceivedPerSecond","packetsReceivedPerSecond","framesDecodedPerSecond"].forEach(function(rn){var hn=Dt.evalQuartiles(Dt.stats[Kt].videoReceived.data,rn);hn.sampleCount=Dt.stats[Kt].videoReceived.data.length,hn.time=wt.detail.stats.videoReceived.timestamp-Dt.stats[Kt].videoReceived.startTime,Dt.stats[Kt].videoReceived[rn]=hn}),Dt.stats[Kt].videoReceived.data[0].jitter!==void 0&&["jitter"].forEach(function(rn){var hn=Dt.evalQuartiles(Dt.stats[Kt].videoReceived.data,rn,function(an){return Math.floor(1e3*an)});hn.sampleCount=Dt.stats[Kt].videoReceived.data.length,hn.time=wt.detail.stats.videoReceived.timestamp-Dt.stats[Kt].videoReceived.startTime,Dt.stats[Kt].videoReceived[rn]=hn}),Dt.stats[Kt].videoReceived.packetsLost={max:wt.detail.stats.videoReceived.packetsLost,sampleCount:Dt.stats[Kt].videoReceived.data.length,time:wt.detail.stats.videoReceived.timestamp-Dt.stats[Kt].videoReceived.startTime},["packetsLostRatio"].forEach(function(rn){var hn=Dt.evalQuartiles(Dt.stats[Kt].videoReceived.data,rn);hn.sampleCount=Dt.stats[Kt].videoReceived.data.length,hn.time=wt.detail.stats.videoReceived.timestamp-Dt.stats[Kt].videoReceived.startTime,Dt.stats[Kt].videoReceived[rn]=hn}),Dt.stats[Kt].videoReceived.mosV===void 0&&(Dt.stats[Kt].videoReceived.mosV={}),["mosV"].forEach(function(rn){var hn=Dt.evalQuartiles(Dt.stats[Kt].videoReceived.data,rn);hn.sampleCount=Dt.stats[Kt].videoReceived.data.length,Dt.stats[Kt].videoReceived[rn]=hn}),Dt.stats[Kt].videoReceived.mosAV===void 0&&(Dt.stats[Kt].videoReceived.mosAV={}),["mosAV"].forEach(function(rn){var hn=Dt.evalQuartiles(Dt.stats[Kt].videoReceived.data,rn);hn.sampleCount=Dt.stats[Kt].videoReceived.data.length,Dt.stats[Kt].videoReceived[rn]=hn}),Dt.stats[Kt].videoReceived.width=wt.detail.stats.videoReceived.width,Dt.stats[Kt].videoReceived.height=wt.detail.stats.videoReceived.height)):Wn.error("video stats not pushed for callId :",Kt))},jt=0;jt<this.subscribeCallIds.length;jt+=1){var Yt;Et(jt)}},this.subscribeToUserStream=function(wt,Dt,Et){var jt=this,Yt=this.webRTCClient.getStreamFromList(Dt);if(Yt!=null){var en=[];en.push(Yt),this.webRTCClient.subscribe(en,Et).forEach(function(Kt){jt.subscribeCallIds.push(Kt),jt.report[jt.testId].subscribeCallIds.push(Kt)})}},this.leaveSession=function(){Wn.debug("leaveSession"),this.streams!==void 0&&typeof this.streams[0]=="number"&&this.webRTCClient!==null&&this.webRTCClient.unsubscribe(this.streams[0]),this.userMediastreamId!==null&&apiRTC.releaseUserMediaStream(this.userMediastreamId),delete this.streams,delete this.subscribeCallIds,typeof this.publishCallId=="string"&&this.webRTCClient.unpublish(this.publishCallId),delete this.publishCallId,this.mcuSession!==void 0&&this.mcuSession.sessionId!==void 0&&(this.webRTCClient.leaveMCUSession(),delete this.mcuSession.sessionId),delete this.mcuSession,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs.splice(0,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs.length),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.joinSessionReqs.splice(0,apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.joinSessionReqs.length),Wn.debug("leaveSession done")},this.runResolutionTest=function(){this.testId="resolution-test",this.stepId="resolution-test",xn.createEvent({eventType:"preCallTestStatus",testId:this.testId,status:"start",stepId:this.stepId}),Wn.debug("Run resolution test"),this.startGetUserMedia(this.resolutions[this.currentResolution])},this.startGetUserMedia=function(wt){Wn.debug("startGetUserMedia :",wt);var Dt={audio:!1,video:{}};Dt=apiCC.setVideoSourceIdInConstraint(this.videoSourceId,Dt),Dt=apiCC.setResolutionInConstraint(wt[0],wt[1],Dt),Wn.debug("startGetUserMedia constraints:",Dt),apiCC.getUserMedia(Dt).then((function(Et){this.resolutions.length>1?(this.report.resolutions.push(wt[2]+":   "+wt[0]+"x"+wt[1]),this.maxWidth=wt[0],this.maxHeight=wt[1],Et.getTracks().forEach(function(jt){jt.stop()}),this.maybeContinueGetUserMedia()):Wn.debug("No video track in returned stream.")}).bind(this)).catch((function(Et){Wn.debug("startGetUserMedia catch error:",Et),this.resolutions.length>1?Wn.debug(wt[0]+"x"+wt[1]+" not supported"):Wn.error("getUserMedia failed with error: "+Et.name),this.maybeContinueGetUserMedia()}).bind(this))},this.maybeContinueGetUserMedia=function(){this.currentResolution!==this.resolutions.length-1?(this.currentResolution++,this.startGetUserMedia(this.resolutions[this.currentResolution])):this.startNextTest()}},vn=tt.Y.get("ApiCCWebRTCClient"),kn=function(qt){vn.debug("apiCC.ApiCCWebRTCClient"),this.myWebRTC_Event=apiCC.myWebRTC_Event,this.webRTCClient=new or(qt),this.webRTCClient.channelReady=!0,this.callTest=null,this.call=function(Rt,nt,vt){return nt==="RECORD"&&vn.warn("DEPRECATED : usage of data parameter on call() as a string with 'RECORD' value will be deprecated in a next version of apiRTC. Please consider using a JSON Data parameter instead : data = {isRecorded : true}"),this.webRTCClient.recordedCall===!0&&(vn.log("recordedCall option is activated"),nt!==void 0&&nt!=="RECORD"||(nt={}),nt.MCUType="MCU-Caller",nt.confId=Math.floor(1000001*Math.random()).toString()),nt!==void 0&&(nt!=="RECORD"&&nt.isRecorded!==!0||(vn.log("recordedCall option is activated"),nt==="RECORD"&&(nt={}),nt.MCUType="MCU-Caller",nt.confId=Math.floor(1000001*Math.random()).toString())),vt!=null&&vt.record===!0&&(vn.log("callConfiguration record option is activated"),nt!==void 0&&nt!=="RECORD"||(nt={}),nt.MCUType="MCU-Caller",nt.confId=Math.floor(1000001*Math.random()).toString()),vn.log("session.webRTCPluginActivated =",qt.webRTCPluginActivated),(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&qt.webRTCPluginActivated===!0?(vn.log("managing call with WebRTC Plugin"),vt==null&&(vt={}),vt.apzcallId=apiCC.generateCallId(),apiCC.manageWebRTCPlugin(function(){vn.log("manageWebRTCPlugin cb in call"),apiCC.session.apiCCWebRTCClient.webRTCClient.callWithNumber(Rt,!0,nt,vt)},function(){vn.log("actionOnInstallationNeeded")}),vt.apzcallId):(vn.log("managing call with browser"),this.webRTCClient.callWithNumber(Rt,!0,nt,vt))},this.getStatsFromCall=function(Rt,nt){var vt=this.webRTCClient.findCallWithCallId(Rt);vt===null?nt(new Error("Call was not found"),null):vt.pc===null?nt(new Error("Call has no peerconnection"),null):this.webRTCClient.csmEnable===!0?nt(null,this.webRTCClient.csmLastResults):nt(new Error("Call stats monitoring not activated"),null)},this.testCall=function(Rt){return vn.log("session.webRTCPluginActivated =",qt.webRTCPluginActivated),(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&qt.webRTCPluginActivated===!0?(vn.log("managing call with WebRTC Plugin"),Rt==null&&(Rt={}),Rt.apzcallId=apiCC.generateCallId(),apiCC.manageWebRTCPlugin(function(){vn.log("manageWebRTCPlugin cb in call"),apiCC.session.apiCCWebRTCClient.webRTCClient.startTestCall(!0,Rt)},function(){vn.log("actionOnInstallationNeeded")}),Rt.apzcallId):(vn.log("managing call with browser"),this.webRTCClient.startTestCall(!0,Rt))},this.setClientTurnServer=function(Rt){this.webRTCClient.setClientTurnServer(Rt)},this.activateScreenSharing=function(Rt){this.webRTCClient.activateScreenSharing(Rt)},this.shareScreen=function(Rt,nt,vt){return vn.info("shareScreen"),this.webRTCClient.shareScreen(Rt,nt,vt)},this.startScreenSharingOnCall=function(Rt,nt){vn.info("startScreenSharingOnCall"),this.webRTCClient.startScreenSharingOnCall(Rt,nt)},this.startDataChannel=function(Rt,nt){if(vn.info("startDataChannel"),!(ot.Xh==="Edge"&&ot.PR<79&&apiRTC.browserDetails.type!=="chrome"))return nt!==void 0?nt.dataCall=!0:(nt={}).dataCall=!0,this.webRTCClient.callWithNumber(Rt,!0,nt,null);vn.warn("Cannot startDataChannel as it is not supported on Edge")},this.startDataChannelOnCall=function(Rt){this.webRTCClient.startDataChannelOnCall(Rt)},this.sendDataWithCallId=function(Rt,nt,vt){this.webRTCClient.sendDataWithCallId(Rt,nt,vt)},this.callAudio=function(Rt,nt,vt){return vn.info("callAudio"),this.webRTCClient.callWithNumber(Rt,!1,nt,vt)},this.callbymail=function(Rt){this.webRTCClient.callbymail(Rt)},this.addMedia=function(Rt){return this.webRTCClient.addMedia(Rt),Rt},this.hangUp=function(Rt){this.webRTCClient.onHangup(Rt)},this.getMyMedia=function(Rt,nt){vn.info("getMyMedia : ",Rt),Rt==="screen"?this.webRTCClient.shareScreen("LOCAL",{},nt):this.webRTCClient.getUserMedia()},this.releaseStream=function(Rt){vn.info("releaseStream : ",Rt),vn.info("releaseStream.callId : ",Rt.callId),Rt.callId!==void 0?this.webRTCClient.removeCallFromTableWithCallIdAndSendBye(Rt.callId,"stop_ScreenSharing"):this.webRTCClient.stopStream(Rt)},this.autoAnswerUserMediaSuccessHandler=function(Rt){vn.info("autoAnswerUserMediaSuccessHandler :"+Rt),Rt=null,this.webRTCClient.autoAnswer=!0},this.autoAnswerUserMediaErrorHandler=function(Rt){vn.info("autoAnswerUserMediaErrorHandler :"+Rt),Rt=null,this.webRTCClient.autoAnswer=!1},this.activateAutoAnswer=function(){apiCC.addEventListener("userMediaSuccess",this.callback(this,"autoAnswerUserMediaSuccessHandler")),apiCC.addEventListener("userMediaError",this.callback(this,"autoAnswerUserMediaErrorHandler")),this.webRTCClient.getUserMedia()},this.getAutoAnswer=function(){return this.webRTCClient.autoAnswer},this.setUnidirectionalCall=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.unidirectionelCallOnly=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUnidirectionalCall()","PARAMETER_ERROR_SETUNIDIRCALL")},this.setReceiveMediaDeactivated=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.receiveMediaDeactivated=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setReceiveMediaDeactivated()","PARAMETER_ERROR_SETRECVMEDIADEACTIVATED")},this.setPreferVP9Codec=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.preferVP9Codec=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setPreferVP9Codec()","PARAMETER_ERROR_SETPREFERVP9CODEC")},this.setPreferH264Codec=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.preferH264Codec=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setPreferH264Codec()","PARAMETER_ERROR_SETPREFERH264CODEC")},this.getUnidirectionalCall=function(){return this.webRTCClient.unidirectionelCallOnly},this.toggleVideoMute=function(Rt){return this.webRTCClient.toggleVideoMute(Rt)},this.isVideoMuted=function(Rt){var nt;return vn.debug("isVideoMuted :",Rt),Rt==null?this.webRTCClient.isVideoMuted:(vn.debug("callId is defined :",Rt),(nt=this.webRTCClient.findCallIndexWithCallId(Rt))!==-1?this.webRTCClient.callsTable[nt].isLocalVideoMuted:void 0)},this.toggleAudioMute=function(Rt){return this.webRTCClient.toggleAudioMute(Rt)},this.sendDTMF=function(Rt,nt,vt,Tt){return this.webRTCClient.sendDTMF(Rt,nt,vt,Tt)},this.isAudioMuted=function(Rt){var nt;return vn.debug("isAudioMuted :",Rt),Rt==null?this.webRTCClient.isAudioMuted:(vn.debug("callId is defined :",Rt),(nt=this.webRTCClient.findCallIndexWithCallId(Rt))!==-1?this.webRTCClient.callsTable[nt].isLocalAudioMuted:void 0)},this.setNtoNConf=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.NtoNConf=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setNtoNConf()","PARAMETER_ERROR_SETNTONCONF")},this.getNtoNConf=function(){return this.webRTCClient.NtoNConf},this.setRTPMedia=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.RTPMedia=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setRTPMedia()","PARAMETER_ERROR_SETRTPMEDIA")},this.getRTPMedia=function(){return this.webRTCClient.RTPMedia},this.setMediaRoutingMode=function(Rt){Rt==="hostOnly"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.hostOnly:Rt==="stun"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.stun:Rt==="stunOnly"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.stunOnly:Rt==="turn"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.turn:Rt==="turnOnly"?this.webRTCClient.mediaRoutingMode=this.webRTCClient.mediaRoutingModeEnum.turnOnly:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setMediaRoutingMode()","PARAMETER_ERROR_SETMEDIAROUTINGMODE")},this.enableQos=function(Rt,nt){apiCC.browser!=="Chrome"&&apiCC.browser!=="Firefox"&&(vn.warn("enableQos() is only supported on Chrome and Firefox, support on other browsers will be added soon"),Rt=!1),vn.info("this.enableQos="+Rt),this.webRTCClient.qosEnable=Rt,this.webRTCClient.qosInterval=nt||this.webRTCClient.qosInterval},this.enableCallStatsMonitoring=function(Rt,nt){["chrome","firefox","safari"].indexOf(ct.wL.type)<0?vn.warn("enableCallStatsMonitoring() is only supported on Chrome, Firefox and Safari, support on other browsers will be added soon"):(this.webRTCClient.csmEnable=Rt,nt&&(this.webRTCClient.csmIntervalMs=nt))},this.enableQualityEvaluating=function(Rt,nt){["chrome","firefox"].indexOf(ct.wL.type)<0?vn.warn("enableQualityEvaluating() is only supported on Chrome and Firefox, support on other browsers will be added soon"):(this.webRTCClient.qualityScoreEnable=Rt,nt&&(this.webRTCClient.qualityScoreIntervalMs=nt))},this.getMediaRoutingMode=function(){var Rt=null;return this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.hostOnly?Rt="hostOnly":this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.stun?Rt="stun":this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.stunOnly?Rt="stunOnly":this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.turn?Rt="turn":this.webRTCClient.mediaRoutingMode===this.webRTCClient.mediaRoutingModeEnum.turnOnly&&(Rt="turnOnly"),Rt},this.setMediaTypeForIncomingCall=function(Rt){vn.debug("setMediaTypeForIncomingCall :",Rt),Rt==="VIDEO"||Rt==="AUDIO"||Rt==="VIDEOONLY"||Rt==="NONE"?this.webRTCClient.mediaTypeForIncomingCall=Rt:vn.log("setMediaTypeForIncomingCall, value is not correct",Rt)},this.setMediaTypeForOutgoingCall=function(Rt){vn.debug("setMediaTypeForOutgoingCall :",Rt),Rt==="VIDEO"||Rt==="AUDIO"||Rt==="VIDEOONLY"||Rt==="NONE"?this.webRTCClient.mediaTypeForOutgoingCall=Rt:vn.log("setMediaTypeForOutgoingCall, value is not correct",Rt)},this.setStereo=function(Rt){vn.info("setStereo :",Rt),Rt===!0?(this.webRTCClient.setStereo=Rt,this.webRTCClient.gum_config={audio:{mandatory:{echoCancellation:!1,googEchoCancellation:!1},optional:[]},video:{mandatory:{},optional:[]}}):Rt===!1?this.webRTCClient.setStereo=Rt:vn.log("setStereo, value is not correct",Rt)},this.setMCUConnector=function(Rt){vn.info("setMCUConnector :",Rt),vn.log("setting value :",Rt),Rt==="mcu4.apizee.com"?this.webRTCClient.MCUClient.pubConnector="janusConnector":Rt==="mcu3.apizee.com"?this.webRTCClient.MCUClient.pubConnector="groupKurentoConnector":vn.log("value is incorrect :",Rt)},this.enableMeshRoomMode=function(Rt){vn.info("enableMeshRoomMode :",Rt),ot.Xh==="IE"?(vn.log("IE detected, MeshRoomMode is not supported"),this.webRTCClient.MCUClient.meshModeEnabled=!1):this.webRTCClient.MCUClient.meshModeEnabled=Rt},this.setAllowAsymetricMediaCalls=function(Rt){vn.info("setAllowAsymetricMediaCalls :",Rt),Rt===!0||Rt===!1?this.webRTCClient.allowAsymetricMediaCalls=Rt:vn.log("setAllowAsymetricMediaCalls, value is not correct",Rt)},this.takeSnapshot=function(Rt,nt,vt,Tt,Pt,wt,Dt){this.webRTCClient.takeSnapshot(Rt,nt,qt.apiKey,vt,Tt,Pt,wt,Dt)},this.takeSnapshotAndSendOnDataChannel=function(Rt,nt,vt,Tt){this.webRTCClient.takeSnapshotAndSendOnDataChannel(Rt,nt,vt,Tt)},this.setUserAcceptOnIncomingCall=function(Rt){vn.info("setUserAcceptOnIncomingCall :",Rt),Rt===!0||Rt===!1?this.webRTCClient.userAcceptOnIncomingCall=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUserAcceptOnIncomingCall()","PARAMETER_ERROR_SETUSERACCEPTONINCOCALL")},this.setUserAcceptOnIncomingCallBeforeGetUserMedia=function(Rt){vn.info("setUserAcceptOnIncomingCallBeforeGetUserMedia :",Rt),Rt===!0||Rt===!1?this.webRTCClient.userAcceptOnIncomingCallBeforeGetUserMedia=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUserAcceptOnIncomingCallBeforeGetUserMedia()","PARAMETER_ERROR_SETUSERACCEPTONINCOCALLBEFOREGUM")},this.setUserAcceptOnIncomingDataCall=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.userAcceptOnIncomingDataCall=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUserAcceptOnIncomingDataCall()","PARAMETER_ERROR_SETUSERACCEPTONINCOCALL")},this.setUserAcceptOnIncomingScreenSharingCall=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.userAcceptOnIncomingScreenSharingCall=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setUserAcceptOnIncomingScreenSharingCall()","PARAMETER_ERROR_SETUSERACCEPTONINCOSCREENSHARINGCALL")},this.setAllowMultipleCalls=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.allowMultipleCalls=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setAllowMultipleCalls()","PARAMETER_ERROR_SETALLOWMULTIPLECALLS")},this.setPcConfig=function(Rt){vn.info("Setting PC_config to :",Rt),this.webRTCClient.pc_config=Rt},this.setPcConstraints=function(Rt){vn.info("Setting PC_constraints to :"+Rt),this.webRTCClient.pc_constraints=Rt},this.setGetUserMediaConfig=function(Rt){this.webRTCClient.setGetUserMediaConfig(Rt)},this.setTrickleIce=function(Rt){vn.info("Setting trickleIce to :"+Rt),Rt===!0||Rt===!1?this.webRTCClient.trickleIce=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setTrickleIce()","PARAMETER_ERROR_SETTRICKLEICE")},this.setRecordedCall=function(Rt){Rt===!0||Rt===!1?this.webRTCClient.recordedCall=Rt:this.myWebRTC_Event.createErrorEvent("parameter error when calling function : setRecordedCall()","PARAMETER_ERROR_SETRECORDEDCALL")},this.getRecordedCall=function(){return this.webRTCClient.recordedCall},this.acceptCall=function(Rt,nt){this.webRTCClient.acceptCall(Rt,nt)},this.refuseCall=function(Rt){vn.info("refuseCall"),this.webRTCClient.refuseCall(Rt)},this.addVideoMedia=function(Rt){vn.info("addVideoMedia"),this.webRTCClient.addVideoMedia(Rt)},this.updateMediaDeviceOnCall=function(Rt,nt){return vn.info("updateMediaDeviceOnCall"),this.webRTCClient.updateMediaDeviceOnCall(Rt,nt)},this.updateMediaTypeOnCall=function(Rt,nt){return!(0,ct.Ym)(Rt,"string")||nt!=="VIDEO"&&nt!=="AUDIOONLY"&&nt!=="VIDEOONLY"?Promise.reject("wrong arguments"):this.webRTCClient.updateMediaTypeOnCall(Rt,nt)},this.releaseUserMedia=function(){this.webRTCClient.releaseUserMedia()},this.setAllowedAudioCodecs=function(Rt){this.webRTCClient.allowedAudioCodecs=Rt},this.setAllowedVideoCodecs=function(Rt){this.webRTCClient.allowedVideoCodecs=Rt},this.setAudioBandwidth=function(Rt){this.webRTCClient.setAudioBandwidth(Rt)},this.setVideoBandwidth=function(Rt){},this.setRemoteVideoBandwidth=function(Rt){typeof Rt=="number"?this.webRTCClient.setVideoBandwidth(Rt,"remote"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Rt)},this.setOverallIncomingVideoBandwidth=function(Rt){typeof Rt=="number"?this.webRTCClient.setVideoBandwidth(Rt,"overall","incoming"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Rt)},this.setOverallOutgoingVideoBandwidth=function(Rt){typeof Rt=="number"?this.webRTCClient.setVideoBandwidth(Rt,"overall","outgoing"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Rt)},this.setPerCallIncomingVideoBandwidth=function(Rt){typeof Rt=="number"?this.webRTCClient.setVideoBandwidth(Rt,"perCall","incoming"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Rt)},this.setPerCallOutgoingVideoBandwidth=function(Rt){typeof Rt=="number"?this.webRTCClient.setVideoBandwidth(Rt,"perCall","outgoing"):vn.error("Unvalid target bandwidth usage value needs to be a number :",Rt)},this.setDataBandwidth=function(Rt){this.webRTCClient.setDataBandwidth(Rt)},this.createMCUSession=function(Rt,nt){vn.info("createMCUSession"),this.webRTCClient.MCUClient.initDivElements(Rt,nt),this.webRTCClient.MCUClient.createSession()},this.joinMCUSession=function(Rt){var nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vn.debug("joinMCUSession"),Rt?this.webRTCClient.MCUClient.joinSession(Rt,nt):new Error("wrong roomId")},this.getMCUStreamList=function(){return vn.debug("getMCUStreamList"),this.webRTCClient.MCUClient.getStreamList()},this.getStreamFromList=function(Rt){return vn.debug("getStreamFromList"),this.webRTCClient.MCUClient.getStreamFromList(Rt)},this.getStreamIdOfUser=function(Rt){return vn.debug("getStreamIdOfUser"),this.webRTCClient.MCUClient.getStreamIdOfUser(Rt)},this.getCallIdFromStreamId=function(Rt){vn.debug("getCallIdFromStreamId");var nt=this.webRTCClient.findCallWithStreamId(Rt);return nt===null?(vn.log("call not found in getCallIdFromStreamId"),null):nt.callId},this.getCallIdFromRemoteMCUUser=function(Rt){var nt,vt;return vn.debug("getCallIdFromRemoteMCUUser"),nt=this.webRTCClient.MCUClient.getStreamIdOfUser(Rt),(vt=this.webRTCClient.findCallWithStreamId(nt))===null?(vn.log("call not found in getCallIdFromRemoteMCUUser"),null):vt.callId},this.ejectParticipantFromMCUSession=function(Rt,nt,vt){this.webRTCClient.MCUClient.ejectParticipant(Rt,nt,vt)},this.publish=function(Rt,nt,vt,Tt,Pt,wt){if(ot.Xh==="IE"&&(vn.log("apiCC.session.webRTCPluginActivated ="+apiCC.session.webRTCPluginActivated),vn.log("apiCC.webRTCPluginInstalled ="+apiCC.webRTCPluginInstalled)),(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&apiCC.session.webRTCPluginActivated===!0&&apiCC.webRTCPluginInstalled===!1)return vn.log("managing call with WebRTC Plugin"),Tt==null&&(Tt={}),Tt.apzcallId=apiCC.generateCallId(),apiCC.manageWebRTCPlugin(function(){apiCC.webRTCPluginInstalled=!0,vn.info("manageWebRTCPlugin cb in call");var Et=this.webRTCClient.MCUClient.getSessionMCU(Rt);return Et&&Et.roomMode==="mesh"?this.webRTCClient.MCUClient.meshPublish(Rt,nt,vt,Tt,Pt,wt):(vn.debug("publish"),this.webRTCClient.MCUClient.publish(Rt,nt,vt,Tt,Pt,wt))},function(){vn.log("actionOnInstallationNeeded")}),Tt.apzcallId;var Dt=this.webRTCClient.MCUClient.getSessionMCU(Rt);return Dt&&Dt.roomMode==="mesh"?this.webRTCClient.MCUClient.meshPublish(Rt,nt,vt,Tt,Pt,wt):(vn.debug("publish"),this.webRTCClient.MCUClient.publish(Rt,nt,vt,Tt,Pt,wt))},this.unpublish=function(Rt){vn.info("unpublish"),this.webRTCClient.MCUClient.unpublish(Rt)},this.publishScreen=function(Rt,nt,vt,Tt){var Pt=this.webRTCClient.MCUClient.getSessionMCU(Rt);return Pt&&Pt.roomMode==="mesh"?(vn.info("publishScreen"),this.webRTCClient.MCUClient.meshPublishScreen(Rt,nt,vt,Tt)):(vn.info("publishScreen"),this.webRTCClient.MCUClient.publishScreen(Rt,nt,vt,Tt))},this.subscribe=function(Rt,nt,vt,Tt,Pt){return vn.info("subscribe :",Rt),ot.Xh==="IE"&&(vn.log("apiCC.session.webRTCPluginActivated ="+apiCC.session.webRTCPluginActivated),vn.log("apiCC.webRTCPluginInstalled ="+apiCC.webRTCPluginInstalled)),(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&apiCC.session.webRTCPluginActivated===!0&&apiCC.webRTCPluginInstalled===!1?(vn.log("managing call with WebRTC Plugin"),apiCC.manageWebRTCPlugin(function(){return apiCC.webRTCPluginInstalled=!0,vn.log("manageWebRTCPlugin cb in subscribe"),typeof nt=="boolean"&&(vn.warn("DEPRECATED : usage of audioOnly parameter on subscribe() is now replaced by mediatype with value VIDEO, AUDIOONLY or VIDEOONLY and will be deprecated in a next version of apiRTC"),nt=nt===!0?"AUDIOONLY":"VIDEO"),apiCC.session.apiCCWebRTCClient.subscribe(Rt,nt,vt,Tt)},function(){vn.log("actionOnInstallationNeeded")}),"WebRTC_Plugin"):(typeof nt=="boolean"&&(vn.warn("DEPRECATED : usage of audioOnly parameter on subscribe() is now replaced by mediatype with value VIDEO, AUDIOONLY or VIDEOONLY and will be deprecated in a next version of apiRTC"),nt=nt===!0?"AUDIOONLY":"VIDEO"),this.webRTCClient.MCUClient.subscribeToStreams(Rt,nt,vt,Tt,Pt))},this.unsubscribe=function(Rt){vn.info("unsubscribe :",Rt),this.webRTCClient!==null&&this.webRTCClient.MCUClient!==null&&this.webRTCClient.MCUClient.unsubscribe(Rt)},this.startStreaming=function(Rt,nt,vt,Tt){return vn.info("startStreaming"),this.webRTCClient.MCUClient.startStreaming(Rt,nt,vt,Tt)},this.stopStreaming=function(Rt){return vn.info("stopStreaming"),this.webRTCClient.MCUClient.stopStreaming(Rt)},this.startRecording=function(Rt,nt,vt,Tt,Pt){vn.info("startRecording"),this.webRTCClient.MCUClient.startRecording(Rt,nt,vt,Tt,Pt)},this.stopRecording=function(Rt){vn.info("stopRecording"),this.webRTCClient.MCUClient.stopRecording(Rt)},this.changeStreamPriority=function(Rt,nt){var vt=this.webRTCClient.findCallWithCallId(Rt);if(!vt&&!(vt=this.webRTCClient.findUserMediaById(Rt)))return vn.error("changeStreamPriority - no such call",Rt),!1;if(!vt.sessionMCU)return vn.error("changeStreamPriority - no such sessionMCU"),!1;if(!(0,ct.Ym)(nt,"number")||nt<0)return vn.error("changeStreamPriority - wrong priority",nt),!1;var Tt=JSON.stringify({type:"changeStreamPriority",roomId:vt.sessionMCU.roomName,callerId:apiCC.session.apiCCWebRTCClient.webRTCClient.clientId,callId:Rt,data:{pubSub:this.webRTCClient.MCUClient.pubConnector,priority:nt}});return vn.log("C->S: "+Tt),apiCC.session.channel.socket.emit("changeStreamPriority",Tt),!0},this.startComposite=function(Rt){vn.info("startComposite"),this.webRTCClient.MCUClient.startComposite(Rt)},this.stopComposite=function(Rt){vn.info("stopComposite"),this.webRTCClient.MCUClient.stopComposite(Rt)},this.startCompositeRecording=function(Rt,nt,vt,Tt,Pt){vn.info("startCompositeRecording"),this.webRTCClient.MCUClient.startCompositeRecording(Rt,nt,vt,Tt,Pt)},this.stopCompositeRecording=function(Rt){vn.info("stopCompositeRecording"),this.webRTCClient.MCUClient.stopCompositeRecording(Rt)},this.checkCallExist=function(Rt){for(var nt=null,vt=this.webRTCClient.callsTable.length;--vt>=0;){var Tt=this.webRTCClient.callsTable[vt];if(Tt.callId===Rt&&Tt.data&&Tt.sessionMCU&&(Tt.data.MCUType==="MCU-Caller"||Tt.data.MCUType==="MCU-Callee")&&Tt.data.confId===Tt.sessionMCU.roomName){nt=Tt;break}}return nt||vn.error("startCallRecording: no such call"),nt},this.startCallRecording=function(Rt){var nt;if(nt=this.checkCallExist(Rt)){var vt=(0,ct.ws)({},nt.data);this.webRTCClient.MCUClient.startCompositeRecording("AUDIO-VIDEO",null,nt.sessionMCU.convId,vt,nt.sessionMCU.roomName)}},this.stopCallRecording=function(Rt){var nt;(nt=this.checkCallExist(Rt))&&this.webRTCClient.MCUClient.stopCompositeRecording(nt.sessionMCU.roomName)},this.enforceMCU=function(Rt){this.webRTCClient.MCUClient.enforceMCU(Rt)},this.takeSnapshotOnMCUSession=function(Rt){return vn.info("takeSnapshotOnMCUSession"),this.webRTCClient.MCUClient.takeSnapshot(Rt)},this.sendMCUSessionInvitation=function(Rt,nt,vt){this.webRTCClient.MCUClient.sendSessionInvitation(Rt,nt,vt)},this.sendMCUSessionInvitationToGroupChat=function(Rt,nt){this.webRTCClient.MCUClient.sendSessionInvitationToGroupChat(Rt,nt)},this.acceptMCUSessionInvitation=function(Rt,nt,vt,Tt){this.webRTCClient.MCUClient.initDivElements(vt,Tt),this.webRTCClient.MCUClient.acceptSessionInvitation(Rt,nt)},this.leaveMCUSession=function(Rt){this.webRTCClient.MCUClient.leaveSession(Rt)},this.recordStream=function(Rt){vn.info("recordStream :",Rt),MediaRecorder!==void 0?apiCC.recordMgr.record(Rt).then(function(){vn.log("Recording started")}).catch(function(nt){vn.error("startRecord failed :",nt)}):vn.debug("MediaRecorder is not supported on this browser, leaving recordStream process")},this.stopRecordStream=function(Rt){vn.info("stopRecordStream"),MediaRecorder!==void 0?apiCC.recordMgr.stop().then(function(nt){vn.log("Recording stopped"),Rt(nt)}).catch(function(nt){vn.error("stopRecord failed :",nt)}):vn.debug("MediaRecorder is not supported on this browser, leaving recordStream process")},this.getMediaDevices=function(Rt){vn.debug("getMediaDevices 2"),apiCC.getMediaDevices().then(function(nt){Rt(nt),apiCC.mediaDeviceMgr.gotSources(nt)}).catch(function(nt){Rt(null),apiCC.mediaDeviceMgr.gotSources(null)})},this.setAudioSourceId=function(Rt){vn.info("setAudioSourceId :"+Rt),this.webRTCClient.audioSourceId=Rt},this.setAudioOutputId=function(Rt){vn.info("setaudioOutputId :"+Rt),this.webRTCClient.audioOutputId=Rt},this.setVideoSourceId=function(Rt){vn.info("setVideoSourceId :"+Rt),this.webRTCClient.videoSourceId=Rt},this.setVideoFacingMode=function(Rt){vn.info("setVideoFacingMode :"+Rt),Rt==="user"||Rt==="environment"||Rt==="left"||Rt==="right"||Rt==="deactivated"?this.webRTCClient.facingMode=Rt==="deactivated"?null:Rt:vn.log("facingMode value is not correct")},this.attachMediaStream=function(Rt,nt){vn.debug("attachMediaStream"),apiCC.attachMediaStream(Rt,nt)},this.addStreamInDiv=function(Rt,nt,vt,Tt,Pt,wt){vn.debug("addStreamInDiv"),apiCC.addStreamInDiv(Rt,nt,vt,Tt,Pt,wt)},this.removeElementFromDiv=function(Rt,nt){vn.debug("removeElementFromDiv"),apiCC.removeElementFromDiv(Rt,nt)},this.setSelectedStream=function(Rt){vn.warn("setSelectedStream() is now deprecated")},this.callback=function(Rt,nt){return this.closureHandler=function(vt){return Rt[nt](vt)},this.closureHandler},this.startPrecallTest=function(Rt,nt,vt,Tt,Pt){var wt={webRTCClient:this,notifyTerminated:Rt};this.callTest=new Un(wt,nt,vt,Tt,Pt),this.callTest.runBitRateTest()}}},6527:(it,ut,s)=>{s.d(ut,{p:()=>ot}),s(3843),s(3710),s(7941),s(4916),s(2772),s(2564),s(561),s(1058),s(9653),s(3290),s(6755),s(3123),s(2222),s(4812);var tt=s(1549).Y.get("ApiCCWhiteBoardClient"),ot=function(ct,yt,pt,gt,st){function ft(at){at.style.display="none"}tt.debug("Loading apiCC.ApiCCWhiteBoardClient"),this.roomId=null,this.whiteBoardDisconnectionTimeoutId=0,this.sessionStarted=!1,this.prev={},this.lastEmit=Date.now(),this.clients={},this.listenedPeers={},this.touchScreenActivated=!1,this.touchControlPoint={},this.drawElements=[],this.ghostElements={},this.redoStack=[],this.undoIndex=0,this.userCursorColor=null,this.cursors={},this.cursorStyle="cross",this.CURSOR_STYLES=["circle","cross"],this.currentScale=1,this.dx=0,this.dy=0,this.instructionsFaded=!1,this.canvas=null,this.ctx=null,this.currentTool="pen",this.currentColor="rgba(0, 0, 0, 1)",this.currentBrushWidth=1,this.readOnly=!1,this.isDrawing=!1,this.focusOnDrawing=!1,this.paperSheetId=0,this.drawingId=0,this.offline=!1,this.roomJoined=!1,this.laserModeActivated=!1,this.AVAILABLE_TOOLS=["pen","ellipse","rectangle","erase","void","arrow"],this.GEOMETRY_TOOLS=["arrow","rectangle","ellipse"],this.disconnectionTimer=st!==void 0?st:3e4,tt.log("Setting Whiteboard disconnectionTimer to : "+this.disconnectionTimer),this.setCanvas=function(at){tt.debug("[Whiteboard] setCanvas() :",at),this.canvas!==null&&(tt.log("Unsetting old canvas events"),this.sessionStarted&&!this.readOnly&&(this.canvas.onmousedown=null,this.canvas.onmouseup=null,this.canvas.onmouseleave=null,this.canvas.onmousemove=null,this.touchScreenActivated&&(this.canvas.removeEventListener("touchstart",this.onTouchStart,!1),this.canvas.removeEventListener("touchend",this.onTouchEnd,!1),this.canvas.removeEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.removeEventListener("touchleave",this.onTouchEnd,!1),this.canvas.removeEventListener("touchmove",this.onTouchMove,!1)))),at!==null&&document.getElementById(at)!==null?(this.canvas=document.getElementById(at),this.ctx=this.canvas.getContext("2d"),this.sessionStarted&&!this.readOnly&&(this.canvas.onmousedown=this.onmousedown,this.canvas.onmouseup=this.onmouseup,this.canvas.onmouseleave=this.onmouseleave,this.canvas.onmousemove=this.onmousemove,this.touchScreenActivated&&(this.canvas.addEventListener("touchstart",this.onTouchStart,!1),this.canvas.addEventListener("touchend",this.onTouchEnd,!1),this.canvas.addEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.addEventListener("touchleave",this.onTouchEnd,!1),this.canvas.addEventListener("touchmove",this.onTouchMove,!1)))):(at!==null&&document.getElementById(at)===null&&tt.warn("No such element whose id is : "+at),this.canvas=null,this.ctx=null)},this.setCanvas(yt),this.sendDataToRoom=function(at){if(tt.info("[Whiteboard] sendDataToRoom()"),this.offline===!1&&this.roomId!==null){if(apiCC.session===null||apiCC.session===void 0)return void tt.info("apiCC.session does not exist, leaving process");tt.debug("this.drawElements :",this.drawElements),tt.debug("data.tool :",at.tool);var ht=[];tt.debug("drawElementsToSend :",ht);var mt,St={x:0,y:0,drawing:!1,tool:this.currentTool,cursorColor:this.userCursorColor,color:this.currentColor,width:this.currentBrushWidth,paperSheetId:this.paperSheetId,drawElements:ht,id:apiCC.session.apiCCId},It=Object.keys(at);for(mt=0;mt<It.length;mt++)St[It[mt]]=at[It[mt]];apiCC.session.roomMgr.sendMessageToRoom(this.roomId,"whiteBoard",St)}},this.setCursorsDiv=function(){tt.warn("[Whiteboard] setCursorsDiv() - method obsolete, please use setUserCursorColor to set a cursor pointer that will be seen by other users")},this.setUserCursorColor=function(at){tt.debug("[Whiteboard] setUserCursorColor() : "+at),at===null||at==="invisible"?this.userCursorColor="invisible":/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(at)?this.userCursorColor=at:(tt.warn("[Whiteboard] setUserCursorColor() color "+at+" is invalid, defaulting to invisible"),this.userCursorColor="invisible")},this.setUserCursorColor(pt),this.setCursorStyle=function(at){tt.debug("[Whiteboard] setCursorStyle() : "+at),this.CURSOR_STYLES.indexOf(at)>-1?(this.userCursorColor="invisible",this.cursorStyle=at):tt.error("[Whiteboard] setCursorStyle() style "+at+" is invalid")},this.setFocusOnDrawing=function(at){tt.debug("[Whiteboard] setFocusOnDrawing()"),this.focusOnDrawing=at},this.createRoom=function(){var at=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};tt.debug("[Whiteboard] createRoom()"),apiCC.session.roomMgr.createRoom("whiteBoard",at)},this.requestContactListInRoom=function(at){tt.log("[Whiteboard] requestContactListInRoom :"+at),apiCC.session.roomMgr.requestContactListInRoom(at)},this.setDrawingTool=function(at){tt.debug("[Whiteboard] setDrawingTool()");var ht=0;apiCC.session!==null&&(ht=apiCC.session.apiCCId),this.AVAILABLE_TOOLS.indexOf(at)>-1&&(this.currentTool=at,this.ghostElements[ht]=null)},this.setReadOnly=function(at){tt.debug("[Whiteboard] setReadOnly()");var ht=0;apiCC.session!==null&&(ht=apiCC.session.apiCCId),this.ghostElements[ht]=null,this.readOnly=at===!0,this.readOnly&&this.canvas!==null?(this.canvas.onmousedown=null,this.canvas.onmouseup=null,this.canvas.onmouseleave=null,this.canvas.onmousemove=null,this.touchScreenActivated&&(this.canvas.removeEventListener("touchstart",this.onTouchStart,!1),this.canvas.removeEventListener("touchend",this.onTouchEnd,!1),this.canvas.removeEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.removeEventListener("touchleave",this.onTouchEnd,!1),this.canvas.removeEventListener("touchmove",this.onTouchMove,!1))):this.canvas!==null&&(this.canvas.onmousedown=this.onmousedown,this.canvas.onmouseup=this.onmouseup,this.canvas.onmouseleave=this.onmouseleave,this.canvas.onmousemove=this.onmousemove,this.touchScreenActivated&&(this.canvas.addEventListener("touchstart",this.onTouchStart,!1),this.canvas.addEventListener("touchend",this.onTouchEnd,!1),this.canvas.addEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.addEventListener("touchleave",this.onTouchEnd,!1),this.canvas.addEventListener("touchmove",this.onTouchMove,!1)))},this.laserModeProcess=function(at){var ht=this;setTimeout(function(){return ht.undo(at)},5e3)},this.undo=function(at){tt.debug("[Whiteboard] undo()");var ht=this.drawElements.length-1,mt=null,St=[],It=[],xt=null,At=0;if(apiCC.session!==null&&(At=apiCC.session.apiCCId),at===void 0)for(;ht>=0;)this.drawElements[ht].userId==At&&(mt===null&&(mt=this.drawElements[ht].undoIndex),mt===this.drawElements[ht].undoIndex&&(xt=this.drawElements.splice(ht,1)[0],St.push(xt),It.push(xt.drawingId))),ht--;else for(ht=0;ht<this.drawElements.length;ht++)this.drawElements[ht].userId==At&&this.drawElements[ht].drawingId===at&&(tt.debug("[Whiteboard] element found with drawingId in undo laser :",at),xt=this.drawElements.splice(ht,1)[0],St.push(xt),It.push(xt.drawingId));St.length>0&&(this.redraw(),this.sendDataToRoom({tool:"void",delete:It,undoneElements:St}),this.redoStack.push(St))},this.redo=function(){tt.debug("[Whiteboard] redo()");var at,ht=[];if(this.redoStack.length>0){for(ht=this.redoStack.pop(),at=0;at<ht.length;at++)this.addNewDrawing(ht[at]);this.sendDataToRoom({tool:"void",drawObjectsArray:ht}),this.redraw()}},this.setBrushSize=function(at){tt.debug("[Whiteboard] setBrushSize()"),!isNaN(at)&&at>0&&(this.currentBrushWidth=at)},this.setBrushColor=function(at){tt.debug("[Whiteboard] setBrushColor()"),this.currentColor=at},this.setScale=function(at){tt.debug("[Whiteboard] setScale()"),at>0?(this.currentScale=at,this.redraw()):tt.warn("Scale factor must be > 0!")},this.getScale=function(){return tt.debug("[Whiteboard] getScale()"),this.currentScale},this.setOffset=function(at,ht){tt.debug("[Whiteboard] setOffset()");var mt=parseInt(at,10),St=parseInt(ht,10);isNaN(mt)||isNaN(St)||(this.dx=Number(mt),this.dy=Number(St),this.redraw())},this.getOffset=function(){return tt.debug("[Whiteboard] getOffset()"),{x:this.dx,y:this.dy}},this.printSharedText=function(at,ht,mt,St,It,xt){tt.debug("[Whiteboard] printSharedText()"),this.setBrushStyle(this.currentColor,this.currentBrushWidth),this.undoIndex++,this.redoStack=[];var At=0;apiCC.session!==null&&(At=apiCC.session.apiCCId);var Nt={type:"text",x:at,y:ht,text:mt,size:St,font:It,border:xt,userId:At,drawingId:this.drawingId,color:this.currentColor,width:this.currentBrushWidth,undoIndex:this.undoIndex,time:Date.now()};this.sendDataToRoom({x:at,y:ht,tool:"void",drawObject:Nt}),this.drawingId++,this.addNewDrawing(Nt)},this.addPeerListener=function(at,ht){tt.debug("[Whiteboard] addPeerListener()"),this.listenedPeers.hasOwnProperty(at)||(this.listenedPeers[at]=[]),this.listenedPeers[at].push(ht)},this.inviteInRoom=function(at,ht,mt){var St=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};tt.debug("[Whiteboard] inviteInRoom()"),at!==null?ht!==null?apiCC.session.roomMgr.inviteInRoom(at,ht,"whiteBoard",mt,St):tt.debug("wrong destId"):tt.debug("wrong roomId")},this.answerToRoomInvitation=function(at,ht){tt.info("[Whiteboard] answerToRoomInvitation()");var mt=ht&&!this.isInRoom();return this.isInRoom()?tt.error("[Whiteboard] cannot answer room invitation : user is already in a room"):apiCC.session.roomMgr.answerToRoomInvitation(at,ht,"whiteBoard"),mt&&(tt.log("[Whiteboard] user joining room"),this.paperSheetId=0,this.drawingId=0,this.roomId=at,this.sendDataToRoom({tool:"void",needCatchUp:"*||-1"})),mt},this.joinRoom=function(at){var ht=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};tt.info("[Whiteboard] joinRoom() roomId :",at),at==null?tt.error("[Whiteboard] cannot join room : room is null or undefined"):this.isInRoom()&&this.roomJoined===!0?tt.error("[Whiteboard] cannot join room : user is already in a room"):apiCC.session.roomMgr.joinRoom(at,"whiteBoard",ht)},this.leaveRoom=function(){tt.info("[Whiteboard] leaveRoom()"),this.isInRoom()&&(apiCC.session.roomMgr.leaveRoom(this.roomId,"whiteBoard"),this.roomId=null,this.paperSheetId=0,this.drawingId=0,this.listenedPeers={},this.roomJoined=!1)},this.isInRoom=function(){return this.roomId!==null},this.clearPaper=function(){tt.debug("[Whiteboard] clearPaper()"),this.deleteHistory()},this.refreshCanvas=function(){if(this.canvas!==null&&this.ctx!==null){var at=this.canvas.width;this.canvas.width=at}},this.deleteHistory=function(){tt.info("[Whiteboard] deleteHistory()");var at=0;apiCC.session!==null&&(at=apiCC.session.apiCCId),this.refreshCanvas(),this.drawElements=[],this.ghostElements[at]=null,this.paperSheetId++,this.drawingId=0,this.sendDataToRoom({tool:"void",deleteHistory:!0})},this.setBrushStyle=function(at,ht){this.ctx!==null&&(this.ctx.strokeStyle=at,this.ctx.fillStyle=at,this.ctx.lineWidth=ht)},this.redraw=function(){var at,ht,mt;for(tt.debug("[Whiteboard] redraw()"),this.refreshCanvas(),at=0;at<this.drawElements.length;at++)this.drawSingleObject(this.drawElements[at]);for(ht=Object.keys(this.ghostElements),at=0;at<ht.length;at++)this.ghostElements[ht[at]]!==null&&this.drawSingleObject(this.ghostElements[ht[at]]);for(ht=Object.keys(this.cursors),at=0;at<ht.length;at++)if(this.cursors[ht[at]]!==null&&this.cursors[ht[at]].color!=="invisible"&&(this.cursors[ht[at]].x!==0||this.cursors[ht[at]].y!==0))switch(mt={fromx:(this.cursors[ht[at]].x-this.dx)*this.currentScale-13,fromy:(this.cursors[ht[at]].y-this.dy)*this.currentScale-13,tox:(this.cursors[ht[at]].x-this.dx)*this.currentScale+13,toy:(this.cursors[ht[at]].y-this.dy)*this.currentScale+13},this.setBrushStyle(this.cursors[ht[at]].color,4),this.cursorStyle){case"circle":this.ctx!==null&&(this.ctx.globalAlpha=.4,this.fillEllipse(mt.fromx,mt.fromy,mt.tox,mt.toy),this.drawEllipse(mt.fromx+2,mt.fromy+2,mt.tox-2,mt.toy-2),this.ctx.globalAlpha=1);break;case"cross":this.ctx!==null&&(this.ctx.globalAlpha=.7,this.ctx.beginPath(),this.ctx.moveTo(mt.fromx+(mt.tox-mt.fromx)/2,mt.fromy),this.ctx.lineTo(mt.fromx+(mt.tox-mt.fromx)/2,mt.toy),this.ctx.lineCap="butt",this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(mt.fromx,mt.fromy+(mt.toy-mt.fromy)/2),this.ctx.lineTo(mt.tox,mt.fromy+(mt.toy-mt.fromy)/2),this.ctx.lineCap="butt",this.ctx.stroke(),this.ctx.globalAlpha=1)}},this.addNewDrawing=function(at){var ht=0;this.drawElements.push(at),this.drawSingleObject(at),apiCC.session!==null&&(ht=apiCC.session.apiCCId),at.userId===ht&&this.laserModeActivated===!0&&this.laserModeProcess(at.drawingId)},this.drawSingleObject=function(at){if(this.ctx!==null&&this.canvas!==null){var ht={};switch(this.setBrushStyle(at.color,at.width),this.ctx.scale(this.currentScale,this.currentScale),ht.fromx=at.fromx-this.dx,ht.tox=at.tox-this.dx,ht.x=at.x-this.dx,ht.fromy=at.fromy-this.dy,ht.toy=at.toy-this.dy,ht.y=at.y-this.dy,at.type){case"arrow":this.drawArrow(ht.fromx,ht.fromy,ht.tox,ht.toy);break;case"ellipse":this.drawEllipse(ht.fromx,ht.fromy,ht.tox,ht.toy);break;case"rectangle":this.drawRectangle(ht.fromx,ht.fromy,ht.tox,ht.toy);break;case"pen":this.drawLine(ht.fromx,ht.fromy,ht.tox,ht.toy);break;case"erase":this.eraseArea(ht.fromx,ht.fromy);break;case"text":this.drawText(ht.x,ht.y,at.text,at.size,at.font,at.border)}this.ctx.scale(1/this.currentScale,1/this.currentScale)}},this.drawLine=function(at,ht,mt,St){this.ctx!==null&&(this.ctx.beginPath(),this.ctx.moveTo(at,ht),this.ctx.lineTo(mt,St),this.ctx.lineCap="round",this.ctx.stroke())},this.drawText=function(at,ht,mt,St,It,xt){if(this.ctx!==null){var At,Nt,kt="Arial";It!=null&&(kt=It),this.ctx.font=St+"px "+kt,this.ctx.fillText(mt,at,ht),xt!=null&&(At=this.ctx.strokeStyle,Nt=this.ctx.lineWidth,this.ctx.strokeStyle=xt,this.ctx.lineWidth=1,this.ctx.strokeText(mt,at,ht),this.ctx.strokeStyle=At,this.ctx.lineWidth=Nt)}},this.eraseArea=function(at,ht){this.ctx!==null&&this.ctx.clearRect(at-this.ctx.lineWidth-1,ht-this.ctx.lineWidth-1,2*this.ctx.lineWidth+2,2*this.ctx.lineWidth+2)},this.drawArrow=function(at,ht,mt,St){if(this.ctx!==null){var It=Math.atan2(St-ht,mt-at);this.ctx.beginPath(),this.ctx.lineCap="butt",this.ctx.moveTo(at,ht),this.ctx.lineTo(mt,St),this.ctx.stroke(),this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(mt,St),this.ctx.rotate(It+Math.PI/2),this.ctx.moveTo(0,-this.ctx.lineWidth),this.ctx.lineTo(5*this.ctx.lineWidth*.5+1,10+.25*this.ctx.lineWidth),this.ctx.lineTo(-5*this.ctx.lineWidth*.5-1,10+.25*this.ctx.lineWidth),this.ctx.closePath(),this.ctx.restore(),this.ctx.fill()}},this.drawEllipse=function(at,ht,mt,St){var It=null,xt=null;this.ctx!==null&&(It={x:Math.abs(at-mt)/2,y:Math.abs(ht-St)/2},xt={x:at-(at-mt)/2,y:ht-(ht-St)/2},this.ctx.beginPath(),apiRTC.browser!=="IE"&&this.ctx.ellipse(xt.x,xt.y,It.x,It.y,0,0,2*Math.PI),this.ctx.stroke())},this.fillEllipse=function(at,ht,mt,St){if(this.ctx!==null){var It={x:Math.abs(at-mt)/2,y:Math.abs(ht-St)/2},xt={x:at-(at-mt)/2,y:ht-(ht-St)/2};this.ctx.beginPath(),apiRTC.browser!=="IE"&&this.ctx.ellipse(xt.x,xt.y,It.x,It.y,0,0,2*Math.PI),this.ctx.fill()}},this.drawRectangle=function(at,ht,mt,St){if(this.ctx!==null){this.ctx.beginPath();var It=at,xt=ht;at>mt&&(It=mt),ht>St&&(xt=St),this.ctx.rect(It,xt,Math.abs(at-mt),Math.abs(ht-St)),this.ctx.stroke()}},this.getContext=function(){return this.ctx},this.loadPhotoInBackground=function(at){tt.debug("[Whiteboard] loadPhotoInBackground :"+at);var ht=document.getElementsByTagName("body")[0];ht.style.backgroundImage="url("+at+")",ht.style.backgroundPosition="50% 50%",ht.style.backgroundRepeat="no-repeat"},this.messageProcessing=function(at){tt.debug("[Whiteboard] messageProcessing");var ht,mt=null,St=null,It=!1,xt=null,At=null,Nt=null,kt=null,Mt=null;if(this.cursors[at.id]||(tt.log("[Whiteboard] messageProcessing - creating cursor for new user : "+at.id),this.cursors[at.id]={id:at.id},this.clients[at.id]={}),this.cursors[at.id].x=at.x,this.cursors[at.id].y=at.y,this.cursors[at.id].lastUpdate=Date.now(),at.cursorColor&&at.cursorColor!==null?this.cursors[at.id].color=at.cursorColor:this.cursors[at.id].color="invisible",apiRTC.userAgentInstance===void 0||apiRTC.userAgentInstance.capabilities.whiteboardCursor==="ON"?this.cursors[at.id].color!=="invisible"&&(It=!0):(tt.debug("[Whiteboard] - cursor is not supported on userAgent"),this.cursors[at.id].color="invisible"),this.ghostElements[at.id]!==null&&(this.ghostElements[at.id]=null,It=!0),this.listenedPeers.hasOwnProperty(at.id))for(xt={id:at.id,x:at.x,y:at.y,tool:at.tool,drawing:at.drawing},ht=0;ht<this.listenedPeers[at.id].length;ht++)typeof this.listenedPeers[at.id][ht]=="function"?this.listenedPeers[at.id][ht](xt):tt.warn("[Whiteboard] Peer listenener is not a function!");if(at.drawing&&this.clients[at.id]&&(tt.debug("data.drawing && this.clients[data.id]"),St={fromx:at.prevX!==void 0?at.prevX:this.clients[at.id].x,fromy:at.prevY!==void 0?at.prevY:this.clients[at.id].y,tox:at.x,toy:at.y,type:at.tool!==null?at.tool:"pen",color:at.color,width:at.width,userId:at.id,drawingId:at.drawingId},this.GEOMETRY_TOOLS.indexOf(St.type)>-1?at.prevX&&at.prevY&&(this.ghostElements[at.id]=St,It=!0):this.addNewDrawing(St),this.focusOnDrawing&&((mt=this.canvas.parentNode).scrollLeft=this.currentScale*(at.x-this.dx)-mt.clientWidth/2,mt.scrollTop=this.currentScale*(at.y-this.dy)-mt.clientHeight/2)),at.drawObject&&((St=at.drawObject).color=at.color,St.width=at.width,this.ghostElements[at.id]=null,this.addNewDrawing(St),this.focusOnDrawing&&((mt=this.canvas.parentNode).scrollLeft=this.currentScale*(at.x-this.dx)-mt.clientWidth/2,mt.scrollTop=this.currentScale*(at.y-this.dy)-mt.clientHeight/2)),at.hasOwnProperty("drawObjectsArray"))for(ht=0;ht<at.drawObjectsArray.length;ht++)this.addNewDrawing(at.drawObjectsArray[ht]);if(at.hasOwnProperty("delete"))for(ht=this.drawElements.length-1,It=!0;ht>=0;)at.delete.indexOf(this.drawElements[ht].drawingId)>-1&&this.drawElements[ht].userId==at.id&&this.drawElements.splice(ht,1),ht--;if(at.hasOwnProperty("paperSheetId")){if(at.paperSheetId<this.paperSheetId)tt.debug("[Whiteboard] - data.paperSheetId < this.paperSheetId");else if(at.paperSheetId>this.paperSheetId){if(tt.debug("[Whiteboard] - messageProcessing : peer has a more recent version : "+this.paperSheetId+" vs "+at.paperSheetId),at.hasOwnProperty("deleteHistory")&&tt.debug("User : "+at.id+" ,has deleted the history"),at.hasOwnProperty("drawElements")){for(tt.debug("[Whiteboard] - messageProcessing : receiving update from peer"),at.drawElements!==null?this.drawElements=at.drawElements:this.drawElements=[],ht=0;ht<this.drawElements.length;ht++)this.drawElements[ht].hasOwnProperty("userId")&&this.drawElements[ht].hasOwnProperty("drawingId")&&(this.clients[this.drawElements[ht].userId]={x:0,y:0,drawing:!1,tool:"pen",cursorColor:null,color:null,width:1,paperSheetId:this.paperSheetId,drawingId:this.drawElements[ht].drawingId,id:this.drawElements[ht].userId});this.paperSheetId=at.paperSheetId,this.drawingId=0,It=!0}}else if(at.hasOwnProperty("drawingId"))if(tt.debug("[Whiteboard] - data.hasOwnProperty(drawingId): "),at.drawingId!==0&&this.clients[at.id]===void 0||this.clients[at.id]!==void 0&&this.clients[at.id].hasOwnProperty("drawingId")&&at.drawingId-this.clients[at.id].drawingId>1)tt.log("[Whiteboard] - messageProcessing : catchup from peer required : "+at.drawingId),kt=at.id+"||-1",this.clients[at.id]!==void 0&&this.clients[at.id].hasOwnProperty("drawingId")&&(kt=at.id+"||"+this.clients[at.id].drawingId),this.sendDataToRoom({tool:"void",needCatchUp:kt});else if(at.hasOwnProperty("needCatchUp")&&(at.needCatchUp.startsWith(apiCC.session.apiCCId+"||")||at.needCatchUp.startsWith("*||"))){for(tt.debug("[Whiteboard] - messageProcessing : letting peer catchup: "+at.id),At=at.needCatchUp.split("||")[1],Nt=[],ht=0;ht<this.drawElements.length;ht++)(Mt=this.drawElements[ht]).hasOwnProperty("userId")&&Mt.hasOwnProperty("drawingId")&&Mt.userId===apiCC.session.apiCCId&&Mt.drawingId>parseInt(At,10)&&Nt.push(Mt);this.sendDataToRoom({tool:"void",catchUpData:Nt,catchupIndex:At})}else tt.debug("[Whiteboard] - else - drawingId");else if(at.hasOwnProperty("needCatchUp")){for(tt.debug("[Whiteboard] - messageProcessing : needCatchUp"+at.id),At=at.needCatchUp.split("||")[1],Nt=[],ht=0;ht<this.drawElements.length;ht++)Mt=this.drawElements[ht],Nt.push(Mt);tt.debug("[Whiteboard] - sending catchUpData : ",Nt),this.sendDataToRoom({tool:"void",catchUpData:Nt,catchupIndex:At})}else tt.debug("[Whiteboard] - else - paperSheetId");if(at.hasOwnProperty("catchUpData")){for(tt.debug("[Whiteboard] - messageProcessing : catching up: "+at.id),at.catchUpStatus==="complete"&&(tt.debug("catchUpData is complete, cleaning drawElements"),this.drawElements.splice(0,this.drawElements.length)),ht=0;ht<at.catchUpData.length;ht++)Mt=at.catchUpData[ht],at.userId===apiCC.session.apiCCId&&Mt.hasOwnProperty("drawingId")&&this.drawingId<Mt.drawingId&&(this.drawingId=Mt.drawingId+1);this.drawElements=at.catchUpData.concat(this.drawElements),this.paperSheetId=at.paperSheetId,It=!0}}It&&this.redraw(),this.clients[at.id]=at},this.isStarted=function(){return this.sessionStarted},this.start=function(){this.isStarted()?tt.warn("[Whiteboard] WhiteBoardClient is already started"):(tt.info("[Whiteboard] starting WhiteBoardClient"),this.isDrawing=!1,this.prev={},this.lastEmit=Date.now(),this.currentScale=1,this.dx=0,this.dy=0,this.drawingId=0,this.clients={},this.listenedPeers={},this.cursors={},this.drawElements=[],this.touchScreenActivated=!1,this.sessionStarted=!0,this.canvas!==null&&(this.canvas.onmousedown=this.onmousedown,this.canvas.onmouseup=this.onmouseup,this.canvas.onmouseleave=this.onmouseleave,this.canvas.onmousemove=this.onmousemove),this.redraw()),apiCC.session!==null&&apiCC.session.roomMgr!==void 0||(tt.log("[Whiteboard] roomMgr is not defined, setting offline mode"),this.offline=!0)},this.stop=function(){this.isStarted()?(tt.info("[Whiteboard] Stopping WhiteBoardClient"),this.isInRoom()&&this.leaveRoom(),this.sessionStarted=!1,this.canvas!==null&&(this.canvas.onmousedown=null,this.canvas.onmouseup=null,this.canvas.onmouseleave=null,this.canvas.onmousemove=null,this.touchScreenActivated&&(this.canvas.removeEventListener("touchstart",this.onTouchStart,!1),this.canvas.removeEventListener("touchend",this.onTouchEnd,!1),this.canvas.removeEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.removeEventListener("touchleave",this.onTouchEnd,!1),this.canvas.removeEventListener("touchmove",this.onTouchMove,!1))),this.drawElements=[],this.ghostElements={},this.redoStack=[]):tt.info("[Whiteboard] cannot stop WhiteboardClient as it is not started")},this.getTouchOffSet=function(at){tt.debug("[Whiteboard] getTouchOffSet():");var ht,mt,St,It,xt=null,At={offsetX:0,offsetY:0};return xt=at.target,ht=window.getComputedStyle(xt,null),mt=parseInt(ht.borderLeftWidth,10),St=parseInt(ht.borderTopWidth,10),It=xt.getBoundingClientRect(),At.offsetX=at.clientX-mt-It.left,At.offsetY=at.clientY-St-It.top,tt.log("offset.offsetX :"+At.offsetX),tt.log("offset.offsetY :"+At.offsetY),At},this.toggleTouchScreen=function(){this.touchScreenActivated===!0?this.deactivateTouchScreen():this.activateTouchScreen()},this.activateTouchScreen=function(){this.canvas!==null?(this.touchScreenActivated=!0,this.canvas.addEventListener("touchstart",this.onTouchStart,!1),this.canvas.addEventListener("touchend",this.onTouchEnd,!1),this.canvas.addEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.addEventListener("touchleave",this.onTouchEnd,!1),this.canvas.addEventListener("touchmove",this.onTouchMove,!1)):tt.warn("Trying to activateTouchScreen() while canvas is null.")},this.deactivateTouchScreen=function(){this.canvas!==null?(this.touchScreenActivated=!1,this.canvas.removeEventListener("touchstart",this.onTouchStart,!1),this.canvas.removeEventListener("touchend",this.onTouchEnd,!1),this.canvas.removeEventListener("touchcancel",this.onTouchCancel,!1),this.canvas.removeEventListener("touchleave",this.onTouchEnd,!1),this.canvas.removeEventListener("touchmove",this.onTouchMove,!1)):tt.warn("Trying to deactivateTouchScreen() while canvas is null.")},this.activateLaserMode=function(){this.laserModeActivated=!0},this.deactivateLaserMode=function(){this.laserModeActivated=!1},this.sendDrawingData=function(at,ht,mt){tt.debug("[Whiteboard] sendDrawingData()");var St={x:at.offsetX,y:at.offsetY,drawing:ht,prevX:this.prev.x,prevY:this.prev.y};if(ht!==!1||this.userCursorColor!=="invisible"){var It=0;apiCC.session!==null&&(It=apiCC.session.apiCCId),mt!==null&&(St.drawObject=mt,St.drawObject.drawingId=this.drawingId,St.drawObject.userId=It,this.drawingId++),St.drawingId=this.drawingId,this.sendDataToRoom(St)}else tt.debug("isDrawing false and userCursorColor invisible - leaving sendDrawingData")},this.onmousedown=(function(at){at.preventDefault();var ht,mt,St=at.target||at.srcElement,It=St.currentStyle||window.getComputedStyle(St,null),xt=parseInt(It.borderLeftWidth,10)||0,At=parseInt(It.borderTopWidth,10)||0,Nt=St.getBoundingClientRect(),kt={offsetX:this.dx+1/this.currentScale*(at.clientX-xt-Nt.left),offsetY:this.dy+1/this.currentScale*(at.clientY-At-Nt.top)};if(this.prev.x=kt.offsetX,this.prev.y=kt.offsetY,this.isDrawing=!0,this.undoIndex++,this.redoStack=[],(ht=document.getElementById(gt))===null||this.instructionsFaded||(ft(ht),this.instructionsFaded=!0),this.currentTool==="erase"){this.sendDrawingData(kt,this.isDrawing,null);var Mt=0;apiCC.session!==null&&(Mt=apiCC.session.apiCCId),this.lastEmit=Date.now(),mt={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,color:this.currentColor,width:this.currentBrushWidth,userId:Mt,drawingId:this.drawingId,undoIndex:this.undoIndex,time:Date.now()},this.drawingId++,this.addNewDrawing(mt),this.redraw()}}).bind(this),this.onmouseup=(function(at){var ht,mt=null,St=null,It=0,xt=0,At=null,Nt={offsetX:0,offsetY:0},kt=0;this.isDrawing&&this.GEOMETRY_TOOLS.indexOf(this.currentTool)>-1&&(St=(mt=at.target||at.srcElement).currentStyle||window.getComputedStyle(mt,null),It=parseInt(St.borderLeftWidth,10)||0,xt=parseInt(St.borderTopWidth,10)||0,At=mt.getBoundingClientRect(),Nt.offsetX=this.dx+1/this.currentScale*(at.clientX-It-At.left),Nt.offsetY=this.dy+1/this.currentScale*(at.clientY-xt-At.top),apiCC.session!==null&&(kt=apiCC.session.apiCCId),ht={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,tox:Nt.offsetX,toy:Nt.offsetY,color:this.currentColor,width:this.currentBrushWidth,userId:kt,undoIndex:this.undoIndex,time:Date.now()},this.sendDrawingData(Nt,this.isDrawing,ht),this.ghostElements[kt]=null,this.redraw(),this.addNewDrawing(ht),this.prev.x=Nt.offsetX,this.prev.y=Nt.offsetY),this.isDrawing=!1,this.ghostElements[kt]=null}).bind(this),this.onmouseleave=(function(){var at=0;apiCC.session!==null&&(at=apiCC.session.apiCCId),this.isDrawing=!1,this.sendDrawingData({offsetX:0,offsetY:0},this.isDrawing,null),this.ghostElements[at]=null}).bind(this),this.onmousemove=(function(at){var ht,mt,St,It,xt,At=null,Nt={};if(ht=(At=at.target||at.srcElement).currentStyle||window.getComputedStyle(At,null),mt=parseInt(ht.borderLeftWidth,10)||0,St=parseInt(ht.borderTopWidth,10)||0,It=At.getBoundingClientRect(),Nt.offsetX=this.dx+1/this.currentScale*(at.clientX-mt-It.left),Nt.offsetY=this.dy+1/this.currentScale*(at.clientY-St-It.top),Date.now()-this.lastEmit>30)if(this.sendDrawingData(Nt,this.isDrawing,null),this.lastEmit=Date.now(),this.isDrawing){var kt=0;apiCC.session!==null&&(kt=apiCC.session.apiCCId),xt={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,color:this.currentColor,width:this.currentBrushWidth,userId:kt,undoIndex:this.undoIndex,time:Date.now()},this.currentTool==="pen"||this.currentTool==="erase"?(this.currentTool==="pen"&&(xt.tox=Nt.offsetX,xt.toy=Nt.offsetY),xt.drawingId=this.drawingId,this.drawingId++,this.addNewDrawing(xt),this.prev.x=Nt.offsetX,this.prev.y=Nt.offsetY):this.GEOMETRY_TOOLS.indexOf(this.currentTool)>-1&&(xt.tox=Nt.offsetX,xt.toy=Nt.offsetY,this.ghostElements[kt]=xt),this.currentTool!=="pen"&&this.redraw()}else this.currentTool==="erase"&&(this.redraw(),xt={type:"rectangle",fromx:Nt.offsetX-this.currentBrushWidth,fromy:Nt.offsetY-this.currentBrushWidth,tox:parseInt(Nt.offsetX,10)+parseInt(this.currentBrushWidth,10),toy:parseInt(Nt.offsetY,10)+parseInt(this.currentBrushWidth,10),color:"#444444",width:1},this.drawSingleObject(xt),xt.color="#DDDDDD",xt.fromx=xt.fromx-1,xt.fromy=xt.fromy-1,xt.tox=xt.tox+1,xt.toy=xt.toy+1,this.drawSingleObject(xt))}).bind(this),this.onTouchStart=(function(at){tt.debug("[Whiteboard] handleStart"),at.preventDefault();var ht,mt=at.changedTouches,St={};this.isDrawing=!0,this.undoIndex++,this.redoStack=[],(St=this.getTouchOffSet(mt[0])).offsetX=this.dx+1/this.currentScale*St.offsetX,St.offsetY=this.dy+1/this.currentScale*St.offsetY,this.prev.x=St.offsetX,this.prev.y=St.offsetY,this.sendDrawingData(St,!1,null),(ht=document.getElementById(gt))!==null&&ft(ht)}).bind(this),this.onTouchEnd=(function(at){tt.debug("[Whiteboard] handleEnd :"+at);var ht,mt={},St=at.changedTouches,It=0;this.isDrawing&&this.GEOMETRY_TOOLS.indexOf(this.currentTool)>-1&&((mt=this.getTouchOffSet(St[0])).offsetX=this.dx+1/this.currentScale*mt.offsetX,mt.offsetY=this.dy+1/this.currentScale*mt.offsetY,apiCC.session!==null&&(It=apiCC.session.apiCCId),ht={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,tox:mt.offsetX,toy:mt.offsetY,color:this.currentColor,width:this.currentBrushWidth,userId:It,undoIndex:this.undoIndex,time:Date.now()},this.sendDrawingData(mt,this.isDrawing,ht),this.addNewDrawing(ht),this.prev.x=mt.offsetX,this.prev.y=mt.offsetY),this.isDrawing=!1,this.ghostElements[It]=null,at=null}).bind(this),this.onTouchCancel=(function(at){tt.debug("[Whiteboard] handleCancel :"+at);var ht=0;apiCC.session!==null&&(ht=apiCC.session.apiCCId),this.isDrawing=!1,this.ghostElements[ht]=null,at=null}).bind(this),this.onTouchMove=(function(at){tt.debug("[Whiteboard] handleMove :"+at);var ht,mt=at.changedTouches,St={};if(Date.now()-this.lastEmit>30&&((St=this.getTouchOffSet(mt[0])).offsetX=this.dx+1/this.currentScale*St.offsetX,St.offsetY=this.dy+1/this.currentScale*St.offsetY,this.sendDrawingData(St,this.isDrawing,null),this.lastEmit=Date.now(),this.isDrawing)){(St=this.getTouchOffSet(mt[0])).offsetX=this.dx+1/this.currentScale*St.offsetX,St.offsetY=this.dy+1/this.currentScale*St.offsetY;var It=0;apiCC.session!==null&&(It=apiCC.session.apiCCId),ht={type:this.currentTool,fromx:this.prev.x,fromy:this.prev.y,color:this.currentColor,width:this.currentBrushWidth,userId:It,undoIndex:this.undoIndex,time:Date.now()},this.currentTool==="pen"||this.currentTool==="erase"?(this.currentTool==="pen"&&(ht.tox=St.offsetX,ht.toy=St.offsetY),ht.drawingId=this.drawingId,this.drawingId++,this.addNewDrawing(ht),this.prev.x=St.offsetX,this.prev.y=St.offsetY):this.GEOMETRY_TOOLS.indexOf(this.currentTool)>-1&&(ht.tox=St.offsetX,ht.toy=St.offsetY,this.ghostElements[It]=ht,this.redraw())}}).bind(this)}},8560:(it,ut,s)=>{s.r(ut),s(2772),s(3710),s(9554),s(1539),s(8674),s(561),s(2564),s(8309),s(4916),s(3123),s(1058),s(6992),s(8783),s(3948),s(285),s(1637),s(4363),s(9653),s(9714),s(3843),s(7941),s(4812),s(9575),s(2472),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(2222),s(9600),s(6755),s(4747),s(2526),s(1817),s(2165);var tt=s(1549),ot=s(5945),ct=s(8765),yt=s(1215),pt=s(3173),gt=tt.Y.get("RecordManager"),st=s(4708);function ft(kt,Mt){for(var bt=0;bt<Mt.length;bt++){var Bt=Mt[bt];Bt.enumerable=Bt.enumerable||!1,Bt.configurable=!0,"value"in Bt&&(Bt.writable=!0),Object.defineProperty(kt,Bt.key,Bt)}}s(2707),s(7042),s(9070);var at=tt.Y.get("AudioProcessor"),ht=window.AudioContext||window.webkitAudioContext||!1,mt=function(){function kt(){(function(Bt,Ht){if(!(Bt instanceof Ht))throw new TypeError("Cannot call a class as a function")})(this,kt),this.audioContext=null}var Mt,bt;return Mt=kt,(bt=[{key:"getOrCreateAudioContext",value:function(){return at.debug("getOrCreateAudioContext"),apiRTC.osName==="iOS"&&typeof cordova<"u"?at.debug("No audioContext for iOS cordova"):ht&&(this.audioContext=new ht),this.audioContext.state==="suspended"&&this.audioContext.resume().then(function(){at.debug("AudioContext is resumed")}),this.audioContext}},{key:"listenToAudio",value:function(Bt,Ht){if(at.debug("listenToAudio()"),Ht!=null&&apiCC.activeSpeakerDetect===!0&&Ht.childStreamType!=="noiseReduction"){at.debug("activeSpeakerDetect()");var Wt=null,nn=!1,gn=this.getOrCreateAudioContext();gn!=null?(Ht.nodeCtx={},Ht.nodeCtx.sourceNode=gn.createMediaStreamSource(Bt),Ht.nodeCtx.analyserNode=gn.createAnalyser(),Ht.nodeCtx.analyserNode.fftSize=2048,Ht.nodeCtx.sourceNode.connect(Ht.nodeCtx.analyserNode),Ht.nodeCtx.listenToAudioIntervalId=setInterval(function(){var tn,Gt,fn=new Uint8Array(Ht.nodeCtx.analyserNode.frequencyBinCount),Cn=0;for(Ht.nodeCtx.analyserNode.getByteFrequencyData(fn),fn.sort(function(Tn,dn){return dn-Tn}),fn=fn.slice(0,50),Gt=0;Gt<fn.length;Gt++)Cn+=fn[Gt];(tn=Cn/fn.length)>255*apiCC.activeSpeakerThreshold&&(nn||(nn=!0,Ht.notifyActiveSpeaker(tn),at.debug("notifyActiveSpeaker this.userMediaStreamId :",Ht.userMediaStreamId)),Wt!==null&&clearTimeout(Wt),Wt=setTimeout(function(){Ht.notifyNotActiveSpeaker(tn),at.debug("notifyNotActiveSpeaker this.userMediaStreamId :",Ht.userMediaStreamId),nn=!1},1e3))},100)):at.error("listenToAudio() - Unable to create audio context")}else at.debug("activeSpeakerDetecting is not activated or stream type is noiseReduction")}},{key:"checkstopAudioNodeCtxConditions",value:function(Bt){return apiCC.userAgentInstance!==void 0&&apiCC.userAgentInstance.getCapabilities().noiseReduction==="OFF"?"Navigator not compatible with this function":Bt===void 0?"nodeCtx undefined":"OK"}},{key:"stopAudioNodeCtx",value:function(Bt){at.debug("stopAudioNodeCtx :",Bt);var Ht=this.checkstopAudioNodeCtxConditions(Bt);if(Ht!=="OK")return Ht;Bt.sourceNode!==void 0&&Bt.sourceNode!==null&&(Bt.sourceNode.disconnect(),Bt.sourceNode=null),Bt.analyserNode!==void 0&&Bt.analyserNode!==null&&(Bt.analyserNode.disconnect(),Bt.analyserNode=null),Bt.audioDestination!==void 0&&Bt.audioDestination!==null&&(Bt.audioDestination.disconnect(),Bt.audioDestination=null),Bt.originalMediaTrack!==void 0&&Bt.originalMediaTrack!==null&&(Bt.originalMediaTrack=null),Bt.outputMediaTrack!==void 0&&Bt.outputMediaTrack!==null&&(Bt.outputMediaTrack=null),Bt.listenToAudioIntervalId!==void 0&&Bt.listenToAudioIntervalId!==null&&(clearInterval(Bt.listenToAudioIntervalId),Bt.listenToAudioIntervalId=null),Bt.noiseSuppressorNode!==void 0&&Bt.noiseSuppressorNode!==null&&(Bt.noiseSuppressorNode.port.onmessage=null,Bt.noiseSuppressorNode.port.close(),Bt.noiseSuppressorNode=null)}},{key:"checkChildTypeConditions",value:function(Bt){return apiCC.userAgentInstance!==void 0&&apiCC.userAgentInstance.getCapabilities().noiseReduction==="OFF"?"Navigator not compatible with this function":Bt.childType!==void 0&&Bt.childType==="noiseReduction"?"This stream has already a noiseReduction effect applied : "+Bt.childType:Bt.childrenTypeExists("noiseReduction")?"This stream has already has a noiseReduction sub instance running":"OK"}},{key:"startNoiseReduction",value:function(Bt){var Ht=this,Wt=null,nn=!1;return new Promise(function(gn,tn){at.debug("startNoiseReduction");var Gt=Ht.checkChildTypeConditions(Bt);if(Gt!=="OK")return tn(Gt);Bt.nodeCtx={},Bt.nodeCtx.originalMediaTrack=Bt.data.getAudioTracks()[0];var fn=apiCC.audioProcessor.getOrCreateAudioContext();Bt.nodeCtx.sourceNode=fn.createMediaStreamSource(Bt.data);var Cn={channelCount:Bt.data.getAudioTracks()[0].getSettings().channelCount,channelCountMode:"explicit"};Bt.nodeCtx.audioDestination=new MediaStreamAudioDestinationNode(fn,Cn),Bt.nodeCtx.outputMediaTrack=Bt.nodeCtx.audioDestination.stream.getAudioTracks()[0],fn.audioWorklet.addModule("https://cdn.apizee.com/apiRTC/lib/noiseReduction/ApiRTC_NR_Worklet_1.0.1.js").then(function(){Bt.nodeCtx.noiseSuppressorNode=new AudioWorkletNode(fn,"NoiseSuppressorWorklet",{parameterData:{activeSpeakerDetect:apiCC.activeSpeakerDetect}}),Bt.nodeCtx.sourceNode.connect(Bt.nodeCtx.noiseSuppressorNode).connect(Bt.nodeCtx.audioDestination);var Tn={audioFilterIsApplied:Bt.audioFilterIsApplied,audioAppliedFilter:Bt.audioAppliedFilter,videoFilterIsApplied:Bt.videoFilterIsApplied,videoAppliedFilter:Bt.videoAppliedFilter,childType:Bt.childType},dn=Bt.nodeCtx.audioDestination.stream;Bt.data.getVideoTracks().forEach(function(mn){dn.addTrack(mn.clone())}),Bt.createChildStreamFromStream(dn,"noiseReduction",Tn).then(function(mn){Bt.addChildren(mn,"noiseReduction"),mn.applyMuteStatusFromParent();var yn=apiCC.getUserMediaStream(Bt.userMediaStreamId);apiCC.audioProcessor.stopAudioNodeCtx(yn.nodeCtx);var pn=apiCC.getUserMediaStream(mn.userMediaStreamId);return Bt.nodeCtx.noiseSuppressorNode.port.onmessage=function(In){In.data.vadScore>apiCC.activeSpeakerThreshold&&(nn||(nn=!0,pn.notifyActiveSpeaker(In.data.vadScore),at.debug("notifyActiveSpeaker this.userMediaStreamId :",pn.userMediaStreamId)),Wt!==null&&clearTimeout(Wt),Wt=setTimeout(function(){pn.notifyNotActiveSpeaker(In.data.vadScore),at.debug("notifyNotActiveSpeaker this.userMediaStreamId :",pn.userMediaStreamId),nn=!1},1e3))},gn(mn)}).catch(tn)}).catch(function(Tn){console.error("Error while adding audio worklet module: ",Tn)})})}}])&&ft(Mt.prototype,bt),Object.defineProperty(Mt,"prototype",{writable:!1}),kt}();function St(kt){return St=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Mt){return typeof Mt}:function(Mt){return Mt&&typeof Symbol=="function"&&Mt.constructor===Symbol&&Mt!==Symbol.prototype?"symbol":typeof Mt},St(kt)}var It=tt.Y.get("ApiCC_Methods"),xt=s(6075).F;apiCC.myWebRTC_Adapter=new xt,apiCC.myWebRTC_Event=new ct.K;var At=apiCC.myWebRTC_Event;apiCC.myEventTable=[],apiCC.ApiCCSession=s(3720).K,apiCC.ApiCCWebRTCClient=s(1192).D,apiCC.ApiCCUserMediaStream=s(7323).q,apiCC.ApiCCPointerSharingClient=s(9213).X,apiCC.ApiCCWhiteBoardClient=s(6527).p,apiCC.ApiCCDataClient=s(128)._,apiCC.ApiCCIMClient=s(6844).U,apiCC.recordMgr=new function(){gt.debug("RecordManager creation"),this.mediaRecorder=null,this.recordedBlobs=[],this.mimeType=null,this.record=function(kt,Mt){var bt=this;return gt.info("record"),gt.log("stream :"+kt),gt.log("stream :",kt),new Promise(function(Bt,Ht){var Wt=null;if(MediaRecorder===void 0)return gt.debug("MediaRecorder is not supported on this browser, leaving recordStream process"),void Ht(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"MediaRecorder is not supported on this browser, leaving recordStream process",gt));if(kt===null)return gt.debug("Stream has no data, cannot record"),void Ht(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"Stream has no data, cannot record",gt));if(bt.mediaRecorder!==null&&(gt.log("this.mediaRecorder.state :"+bt.mediaRecorder.state),bt.mediaRecorder.state==="recording"||bt.mediaRecorder.state==="paused"))return gt.log("mediaRecorder is already ongoing, use stopRecordStream before trying another record"),void Ht(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is already ongoing, use stopRecordStream before trying another record",gt));if(gt.debug("checking MediaRecorderOptions mimeType support"),Mt!=null?(gt.debug("options is defined :",Mt),Mt.mimeType!==null&&Mt.mimeType!==void 0&&(gt.debug("contentType is defined :",Mt.mimeType),MediaRecorder.isTypeSupported(Mt.mimeType)&&(Wt=Mt.mimeType))):Mt={},Wt===null){var nn="video/webm;codecs=vp8,opus";MediaRecorder.isTypeSupported(nn)||(gt.debug(nn+" is not Supported"),nn="video/webm;codecs=vp9,opus",MediaRecorder.isTypeSupported(nn)||(gt.debug(nn+" is not Supported"),nn="video/webm",MediaRecorder.isTypeSupported(nn)||(gt.debug(nn+" is not Supported"),nn=""))),Mt.mimeType=nn}bt.mimeType=Mt.mimeType,gt.debug("Start record with MediaRecorderOptions :",Mt);try{bt.recordedBlobs=[],bt.mediaRecorder=new MediaRecorder(kt,Mt)}catch(gn){return gt.error("Exception while creating MediaRecorder: "+gn+". mimeType: "+Mt.mimeType),void Ht(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"Exception while creating MediaRecorder: "+gn+". mimeType: "+Mt.mimeType,gt))}bt.mediaRecorder.onstart=function(gn){gt.log("onstart :"+gn),this.onerror=null,Bt()},bt.mediaRecorder.ondataavailable=function(gn){gn.data&&gn.data.size>0&&apiCC.recordMgr.recordedBlobs.push(gn.data)},bt.mediaRecorder.onerror=function(gn){gt.log("onerror :"+gn),Ht(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder error :"+gn,gt)),this.onerror=null},bt.mediaRecorder.start(10),gt.log("MediaRecorder started",bt.mediaRecorder)})},this.stop=function(){var kt=this;return gt.info("stop"),new Promise(function(Mt,bt){return kt.mediaRecorder.onstop=function(Bt){gt.log("mediaRecorder onstop :"+Bt),this.onstart=null,this.onstop=null,this.onerror=null,this.onpause=null,this.onresume=null,this.ondataavailable=null;var Ht=new Blob(apiCC.recordMgr.recordedBlobs,{type:this.mimeType});Mt(Ht)},MediaRecorder===void 0?(gt.debug("MediaRecorder is not supported on this browser, leaving recordStream process"),void bt(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"MediaRecorder is not supported on this browser, leaving recordStream process",gt))):kt.mediaRecorder===null?(gt.log("mediaRecorder is not running, use startRecordStream before trying to stop"),void bt(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is not running, use startRecordStream before trying to stop",gt))):(gt.log("this.mediaRecorder.state :"+kt.mediaRecorder.state),kt.mediaRecorder.state==="inactive"?(gt.log("mediaRecorder is already inactive"),void bt(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is already inactive",gt))):void kt.mediaRecorder.stop())})},this.pause=function(){var kt=this;return gt.info("pause"),new Promise(function(Mt,bt){return kt.mediaRecorder===null?(gt.log("mediaRecorder is not running, use startRecordStream before trying to pause"),void bt(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is not running, use startRecordStream before trying to pause",gt))):(gt.log("this.mediaRecorder.state :"+kt.mediaRecorder.state),kt.mediaRecorder.state==="paused"?(gt.log("mediaRecorder is already paused"),void bt(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is already paused",gt))):kt.mediaRecorder.state==="inactive"?(gt.log("mediaRecorder is inactive"),void bt(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is inactive",gt))):(kt.mediaRecorder.onerror=function(Bt){gt.log("onerror :"+Bt),bt(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder error :"+Bt,gt)),this.onerror=null},kt.mediaRecorder.onpause=function(Bt){gt.log("onpause :"+Bt),this.onerror=null,Mt()},void kt.mediaRecorder.pause()))})},this.resume=function(){var kt=this;return gt.info("resume"),new Promise(function(Mt,bt){return kt.mediaRecorder===null?(gt.log("mediaRecorder is not running, use startRecordStream before trying to resume"),void bt(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is not running, use startRecordStream before trying to resume",gt))):(gt.log("this.mediaRecorder.state :"+kt.mediaRecorder.state),kt.mediaRecorder.state==="recording"?(gt.log("mediaRecorder is already recording"),void bt(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is already recording",gt))):kt.mediaRecorder.state==="inactive"?(gt.log("mediaRecorder is inactive"),void bt(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder is inactive",gt))):(kt.mediaRecorder.onerror=function(Bt){gt.log("onerror :"+Bt),bt(yt.g.createError(pt.g.ERROR_STREAM_RECORD,"mediaRecorder error :"+Bt,gt)),this.onerror=null},kt.mediaRecorder.onresume=function(Bt){gt.log("onresume :"+Bt),this.onerror=null,Mt()},void kt.mediaRecorder.resume()))})}},apiCC.audioProcessor=new mt,apiCC.pendingPromises=[],apiCC.pendingPromisesId=0,ot.$6!=="electron"?s(2746):It.debug("Electron detected, not loading onbeforeunload"),apiCC.addEventListener=function(kt,Mt,bt){var Bt={},Ht=null;["sessionReady","incomingCall","callEstablished","remoteHangup","userMediaSuccess","userMediaError","userMediaStop","error","receiveIMMessage","updatePresence","webRTCClientCreated","updateUserStatus","channelEvent","groupChatCreation","groupChatInvitation","groupChatMemberUpdate","addUserInGroupChatAnswer","receiveGroupChatMessage","userDataAnswer","fetchUserDataAnswer","receiveConversationList","receiveConversationHistory","receiveConversationDetailReport","receiveContactOccurrencesFromConversationList","receiveMCUSessionInvitation","MCUSessionCreation","MCUAvailableStream","MCUAvailableStreamUpdate","MCUAvailableReplay","MCURemoveStream","canPlayRemoteVideo","recordedFileAvailable","receiveData","roomCreation","roomJoined","roomInvitation","roomMemberUpdate","receiveRoomMessage","contactListInRoom","snapShotPhotoUploaded","stopRecord","callAttempt","joinMCUSessionAnswer","hangup","desktopCapture","remoteStreamAdded","localStreamRemoved","remoteStreamRemoved","switchStream","sendDataChannelOpen","sendDataChannelClose","sendDataChannelError","receiveDataChannelOpen","receiveDataChannelClose","receiveDataChannelError","connectedUsersListUpdate","onFileSended","onFileSending","onFileReceiving","onFileReceived","onFileProgress","onFilePending","recordedStreamsAvailable","closingWhiteBoard","webRTCPluginInstallation","onQosStatsUpdate","onQosChange","onQosAudioChange","onCallScoreUpdate","activeSpeaker","stopSpeaking","audioAmplitude","preCallTestStatus","onQosVideoChange","onCallStatsUpdate","cpuLimited","bandwidthLimited","MCURecordedStreamsAvailable","MCURecordingStarted","MCURecordingStopped","ICECandidateTypeUpdate","disconnectionWarning","MCUAvailableComposite","callRestarting","selectedICECandidate","MCUParticipantEjected","MCURoomModeChanged","MCUStreamingStarted","MCUStreamingStopped","mediaDeviceChanged","externalJsLoadingStatus","slowLink","localStreamUpdated","remoteStreamUpdated","simulcastFeedChanged","videoQualityChanged","bandwidthResourceManagement","backgroundSubstractionStopVisibilityChange","backgroundSubstractionStopComputeTime","AIESnapshot","AIELog","cloudEventOccurred"].indexOf(kt)>-1?(kt==="remoteHangup"&&It.warn("DEPRECATED : ApiRTC : remoteHangup event is now deprecated, please use hangup event instead"),It.log("Adding listener on type :"+kt),typeof apiRTC_React<"u"?eventManager.addEventListener(kt,Mt):document.addEventListener?document.addEventListener(kt,Mt,!1):typeof $jqApz<"u"?(It.log("using $jqApz"),$jqApz(document).on(kt,Mt)):typeof jQuery<"u"?(It.log("using jQuery"),jQuery(document).on(kt,Mt)):It.warn("Custom Events not supported on this browser : addEventListener()"),Bt={type:kt,listener:Mt,setBy:bt},Ht=apiCC.myEventTable.push(Bt),It.trace("number of myEventTable:"+Ht)):(At.createErrorEvent("ERROR: Trying to add a listener on an unknow event","UNKNOWN_EVENT_ON_ADDLISTENER"),It.log("ERROR: Trying to add a listener on an unknow event :"+kt))},apiCC.removeEventListener=function(kt,Mt){It.debug("Removing listener on type :"+kt),document.removeEventListener?document.removeEventListener(kt,Mt,!1):typeof jQuery<"u"?jQuery(document).off(kt,Mt):It.log("Custom Events not supported on this browser")},apiCC.setSessionStorage=function(kt,Mt,bt){It.debug("setSessionStorage"),bt=bt||36e5;var Bt=new Date,Ht=new Date;Ht.setTime(Bt.getTime()+bt);try{var Wt=JSON.stringify({value:Mt,expiresAt:Ht});sessionStorage.setItem(kt,Wt)}catch{It.error("Sotheming went wrong during json strigify to set session storage values")}},apiCC.isWebRTCCompliant=function(){It.debug("isWebRTCCompliant");var kt=!1,Mt=!1;return["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(bt){kt||bt in window&&(kt=!0)}),kt===!1?(It.debug("isWebRTCCompliant::isWebRTCSupported false"),!1):(["getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia"].forEach(function(bt){Mt||bt in navigator&&(Mt=!0)}),Mt===!1?(It.debug("isWebRTCCompliant::isWebRTCGUMSupported false or you are connected with HTTP"),!1):ot.Xh==="MIUI Browser"?(It.debug("isWebRTCCompliant::MIUI Browser detected false"),!1):ot.Xh==="UCBrowser"?(It.debug("isWebRTCCompliant::UCBrowser detected false"),!1):ot.Xh==="QQ"||ot.Xh==="QQBrowser"||ot.Xh==="QQBrowserLite"?(It.debug("isWebRTCCompliant::QQ or QQBrowser or QQBrowserLite detected false"),!1):ot.Xh==="Baidu"||ot.Xh==="baidu"?(It.debug("isWebRTCCompliant::Baidu or baidu detected false"),!1):(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&this.webRTCPluginActivated!==!0?(It.debug("isWebRTCCompliant FALSE : IE or Safari"),!1):(It.debug("isWebRTCCompliant:: WebRTC is supported"),!0))},apiCC.isQoSStatCompliant=function(){var kt=!1;return["chrome","firefox"].indexOf(apiCC.browserDetails.type)<0?(It.debug("QoS Statistics is only supported on Chrome and Firefox"),kt):kt=!0},apiCC.isScreenSharingCompliant=function(){var kt=!1;return typeof apiRTC_React<"u"?kt=!0:(ot.Xh==="IE"||ot.BF==="Android"||apiRTC.osName==="iOS"&&typeof cordova<"u"||(ot.Xh==="Chrome"||ot.Xh==="Firefox"&&ot.PR>=52||navigator.getDisplayMedia||navigator.mediaDevices.getDisplayMedia?kt=!0:It.debug("ScreenSharing is not supported")),kt)},apiCC.getMediaDevices=function(){return It.debug("getMediaDevices"),new Promise(function(kt,Mt){if(typeof apiRTC_React<"u")It.log("enumerateDevices() is supported - React Native"),mediaDevices.enumerateDevices().then(function(bt){It.log("enumerateDevices(), sources :",bt),apiCC.mediaDeviceMgr.mediaSourceInfos=bt,kt(bt)}).catch(function(bt){It.log("enumerateDevices(), error :",bt),Mt(bt)});else if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)It.log("enumerateDevices() is supported."),navigator.mediaDevices.enumerateDevices().then(function(bt){It.log("enumerateDevices(), sources :",bt),apiCC.mediaDeviceMgr.mediaSourceInfos=bt,kt(bt)}).catch(function(bt){It.log("enumerateDevices(), error :",bt),Mt(bt)});else if(It.log("enumerateDevices() not supported."),typeof MediaStreamTrack>"u")It.warn("This browser does not support MediaStreamTrack"),Mt(new Error("getMediaDevices() - MediaStreamTrack undefined"));else try{MediaStreamTrack.getSources(kt)}catch(bt){It.debug("catch MediaStreamTrack.getSources :"+bt),Mt(new Error("getMediaDevices() - Error on MediaStreamTrack.getSources :"+bt))}})},apiCC.getMediaDevicesWithCB=function(kt){if(It.debug("getMediaDevicesWithCB"),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)It.log("enumerateDevices() is supported."),navigator.mediaDevices.enumerateDevices().then(kt).catch(function(Mt){It.log("navigator.mediaDevices.enumerateDevices error: ",Mt),Mt=null});else if(It.log("enumerateDevices() not supported."),typeof MediaStreamTrack>"u")kt(null),It.warn("This browser does not support MediaStreamTrack");else try{MediaStreamTrack.getSources(kt)}catch(Mt){It.debug("catch MediaStreamTrack.getSources :"+Mt),kt(null)}},apiCC.getUserMedia=function(kt){return It.info("getUserMedia"),It.debug("with constraints :",kt),new Promise(function(Mt,bt){navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0?(It.debug("webRTC getUserMedia with promises"),navigator.mediaDevices.getUserMedia(kt).then(Mt).catch(bt)):typeof apiRTC_React<"u"?(It.debug("webRTC getUserMedia with promises on React Native"),mediaDevices.getUserMedia(kt).then(Mt).catch(bt)):(It.debug("webRTC getUserMedia without promises"),apiCC.myWebRTC_Adapter.getUserMedia(kt,Mt,bt))})},apiCC.getUserMediaWithCB=function(kt,Mt,bt){It.info("getUserMediaWithCB"),It.debug("with constraints :"+JSON.stringify(kt)),navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0?(It.log("getUserMedia with promises"),navigator.mediaDevices.getUserMedia(kt).then(Mt).catch(bt)):(It.log("getUserMedia without promises"),apiCC.myWebRTC_Adapter.getUserMedia(kt,Mt,bt))},apiCC.userMediaStreamTable=[],apiCC.getUserMediaStreamIds=function(){for(var kt=[],Mt=apiCC.userMediaStreamTable.length;--Mt>=0;)kt.push(apiCC.userMediaStreamTable[Mt].userMediaStreamId);return kt},apiCC.getUserMediaStream=function(kt,Mt){var bt=null,Bt=apiCC.userMediaStreamTable.length;if(kt==null){if(Mt&&typeof Mt.accept=="function"){for(;--Bt>=0;)if(Mt.accept(apiCC.userMediaStreamTable[Bt])===!0){bt=apiCC.userMediaStreamTable[Bt];break}}}else for(;--Bt>=0;)if(apiCC.userMediaStreamTable[Bt].userMediaStreamId===kt){bt=apiCC.userMediaStreamTable[Bt];break}return bt},apiCC.getFirstUserMediaStream=function(){return apiCC.userMediaStreamTable.length>0?apiCC.userMediaStreamTable[0]:null},apiCC.createUserMediaStream=function(kt){var Mt=function(Ht){for(var Wt=apiCC.userMediaStreamTable.length;--Wt>=0;)if(apiCC.userMediaStreamTable[Wt].userMediaStreamId===Ht){apiCC.userMediaStreamTable.splice(Wt,1);break}},bt=new apiCC.ApiCCUserMediaStream,Bt="call";return It.debug("[createUserMediaStream] userMediaStreamId: "+bt.userMediaStreamId),kt==null&&(kt={}),kt.type&&(bt.callType=kt.type),kt.stream?(bt.stream=kt.stream,bt.streamStolen=!0,bt.notifyUserMediaStop=!1,bt.listenForMuteEvents()):kt.gum_config&&(bt.gum_config=(0,st.S6)(kt.gum_config)),kt.audioSourceId&&(bt.inputs.audioSourceId=kt.audioSourceId),kt.videoSourceId&&(bt.inputs.videoSourceId=kt.videoSourceId),kt.facingMode&&(bt.inputs.facingMode=kt.facingMode),kt.captureSourceType&&(bt.captureSourceType=kt.captureSourceType),kt.notifyUserMediaSuccess&&(bt.notifyUserMediaSuccess=kt.notifyUserMediaSuccess),kt.notifyUserMediaError&&(bt.notifyUserMediaError=kt.notifyUserMediaError),kt.tryAudioCallAfterUserMediaError&&(bt.tryAudioCallAfterUserMediaError=kt.tryAudioCallAfterUserMediaError),kt.displayMediaStreamConstraints&&(bt.displayMediaStreamConstraints=kt.displayMediaStreamConstraints),kt.forceExtensionOnChrome&&(bt.forceExtensionOnChrome=kt.forceExtensionOnChrome),kt.filters&&(bt.filters=kt.filters),kt.callId&&(kt.callFlavor!=="call"&&kt.callFlavor!=="userMedia"||(Bt=kt.callFlavor),bt.stream===null?bt.addCallInfo(kt.callId,Bt,!0):bt.addCallInfo(kt.callId,Bt,!1)),kt.childStreamType&&(bt.childStreamType=kt.childStreamType),bt.callbacks.release=typeof kt.release=="function"?kt.release:function(){},bt.callbacks.success=typeof kt.success=="function"?kt.success:function(){},bt.callbacks.failure=typeof kt.failure=="function"?kt.failure:function(){},apiCC.userMediaStreamTable.push(bt),bt.stream===null?bt.callType==="screenSharing"||bt.callType==="screenSharingWithAudio"?bt.getScreenMedia():bt.callType!=="data"?bt.getUserMedia():kt.sync===!0?(Mt(bt.userMediaStreamId),bt.callbacks.failure(bt,"wrong type")):setTimeout(function(){Mt(bt.userMediaStreamId),bt.callbacks.failure(bt,"wrong type")},0):(bt.updateMediaProperties(bt.stream),kt.sync===!0?bt.callbacks.success(bt):setTimeout(function(){bt.callbacks.success(bt)},0)),bt},apiCC.releaseUserMediaStream=function(kt,Mt,bt){var Bt=!1,Ht=apiCC.userMediaStreamTable.length,Wt=null;if(Mt!==null&&typeof Mt!="string"&&(Mt=null),kt==null){if(bt&&typeof bt.accept=="function"){for(;--Ht>=0;)if(bt.accept(apiCC.userMediaStreamTable[Ht])===!0){if(Mt){if((Wt=apiCC.userMediaStreamTable[Ht].getOwnerCallInfo())===null||Wt.callId!==Mt){apiCC.userMediaStreamTable[Ht].removeCallInfo(Mt);break}}else if((Wt=apiCC.userMediaStreamTable[Ht].getOwnerCallInfo())!==null)break;It.debug("[releaseUserMediaStream] match; userMediaStreamId: "+apiCC.userMediaStreamTable[Ht].userMediaStreamId),apiCC.userMediaStreamTable[Ht].release(),Mt&&apiCC.userMediaStreamTable[Ht].removeCallInfo(Mt),apiCC.userMediaStreamTable.splice(Ht,1),Bt=!0;break}}}else for(;--Ht>=0;)if(apiCC.userMediaStreamTable[Ht].userMediaStreamId===kt){if(Mt){if((Wt=apiCC.userMediaStreamTable[Ht].getOwnerCallInfo())===null||Wt.callId!==Mt){apiCC.userMediaStreamTable[Ht].removeCallInfo(Mt);break}}else if((Wt=apiCC.userMediaStreamTable[Ht].getOwnerCallInfo())!==null)break;It.debug("[releaseUserMediaStream] id; userMediaStreamId: "+apiCC.userMediaStreamTable[Ht].userMediaStreamId),apiCC.userMediaStreamTable[Ht].release(),Mt&&apiCC.userMediaStreamTable[Ht].removeCallInfo(Mt),apiCC.userMediaStreamTable.splice(Ht,1),Bt=!0;break}return Bt},apiCC.activeSpeakerDetect=!1,apiCC.activeSpeakerThreshold=.4,apiCC.enableActiveSpeakerDetecting=function(kt,Mt){apiCC.activeSpeakerDetect=kt,Mt&&(apiCC.activeSpeakerThreshold=Mt)},apiCC.apiRTCExtensionInstalled=!1,apiCC.extensionInstallationSuccessCallback=function(){It.debug("extensionInstallationSuccessCallback"),apiCC.apiRTCExtensionInstalled=!0},apiCC.extensionInstallationFailureCallback=function(kt,Mt){It.debug("extensionInstallationFailureCallback : Error :"+kt+", "+Mt),kt=null,Mt=null,At.createDesktopCaptureEvent("Extension_installation_Error",apiRTC.waitingShareScreenCallId,apiRTC.waitingShareScreenDestNumber,apiRTC.waitingCaptureSourceType)},apiCC.manageNotInstalledExtension=function(kt,Mt,bt){It.debug("manageNotInstalledExtension"),It.warn("apiRTC extension not installed"),At.createDesktopCaptureEvent("Extension_not_installed",kt,Mt),It.warn("Starting apiRTC extension installation"),apiRTC.waitingShareScreenDestNumber=Mt,apiRTC.waitingShareScreenCallId=kt,apiRTC.waitingCaptureSourceType=bt,ot.PR>=71?(It.debug("Chrome >= 71, opening Chrome web Store"),apiRTC.extensionInstallationFailureCallback("Chrome71 : chrome.webstore.install() no more supported","Chrome71-screenShare"),window.open("https://chrome.google.com/webstore/detail/apizee-desktop-capture/mjjnofoemoepfididplbfimokpnpcoeg")):chrome.webstore.install("https://chrome.google.com/webstore/detail/mjjnofoemoepfididplbfimokpnpcoeg",apiRTC.extensionInstallationSuccessCallback,apiRTC.extensionInstallationFailureCallback)},apiCC.activateScreenSharing=function(kt){It.debug("activateScreenSharing");var Mt=null;kt!==void 0?It.log("extensionId is defined :"+kt):(It.log("using apirtc extension's Id"),kt="mjjnofoemoepfididplbfimokpnpcoeg"),ot.Xh==="Chrome"?document.getElementById(kt)!==null?(It.log("extensionLink is present, screenSharing is already activated"),window.postMessage("apiRTC-extension","*")):(It.log("screenSharing is not yet activated"),(Mt=document.createElement("link")).href="https://chrome.google.com/webstore/detail/"+kt,Mt.rel="chrome-webstore-item",Mt.id=kt,document.getElementsByTagName("head")[0].appendChild(Mt),window.addEventListener("message",function(bt){var Bt=null;if(It.log("message: event: "+JSON.stringify(bt.data)),bt.origin==window.location.origin){if(bt.data!=="apiRTC-DeskstopCapture-loaded")return bt.data==="extensionInstalledAndLoaded"?(apiCC.apiRTCExtensionInstalled=!0,apiCC.waitingShareScreenUserMediaStream!==null&&apiCC.waitingShareScreenUserMediaStream!==void 0&&(apiCC.userMediaStreamTable.push(apiCC.waitingShareScreenUserMediaStream[0]),delete apiCC.waitingShareScreenUserMediaStream),void(apiCC.waitingShareScreenUserMediaStreamId&&(Bt=apiCC.getUserMediaStream(apiCC.waitingShareScreenUserMediaStreamId),delete apiCC.waitingShareScreenUserMediaStreamId,Bt&&Bt.getScreenMedia()))):void(St(bt.data)==="object"&&bt.data.desktopId!==void 0&&(bt.data.remoteId!=="getScreenMedia"||(Bt=apiCC.getUserMediaStream(bt.data.callNumber))===null||Bt.registerScreenMedia(bt.data.captureSourceType,bt.data.desktopId)));apiCC.apiRTCExtensionInstalled=!0}}),window.postMessage("apiRTC-extension","*")):(It.log("activateScreenSharing is only available for chrome Browser"),At.createDesktopCaptureEvent("Browser_Not_Compatible",null,null))},apiCC.checkIfAudioSourceIdExistOnDevice=function(kt){It.log("checkIfAudioSourceIdExistOnDevice :",kt);var Mt,bt=!1,Bt=null;if(apiCC.mediaDeviceMgr.mediaSourceInfos!==null)for(Mt=0;Mt<apiCC.mediaDeviceMgr.mediaSourceInfos.length;++Mt)(Bt=apiCC.mediaDeviceMgr.mediaSourceInfos[Mt]).kind!=="audio"&&Bt.kind!=="audioinput"||(Bt.deviceId===kt?(It.log("Audio device present :",kt),bt=!0):It.log("not this deviceId"));return bt},apiCC.setAudioSourceIdInConstraint=function(kt,Mt){return It.log("setAudioSourceIdInConstraint:",Mt),kt==null?It.log("audioSourceId not defined"):Mt.audio===!1?It.log("constraints.audio === false, no audio device present"):apiCC.checkIfAudioSourceIdExistOnDevice(kt)===!1?(It.log("audioSourceId not found on device"),Mt.audio={}):(Mt.audio!==!0&&Mt.audio!==void 0||(Mt.audio={}),It.log("audioSourceId is defined :",kt),ot.ag.name==="iOS"?ot.Xh==="Mobile Safari"||(Mt.audio.deviceId=kt):ot.Xh==="Firefox"&&ot.PR>=50?Mt.audio.deviceId=kt:ot.Xh==="Chrome"&&ot.PR<48||ot.Xh==="Safari"&&ot.PR<11?Mt.audio.optional=[{sourceId:kt}]:Mt.audio.deviceId=kt?{ideal:kt}:void 0),It.debug("constraints =",Mt),Mt},apiCC.checkIfVideoSourceIdExistOnDevice=function(kt){It.log("checkIfVideoSourceIdExistOnDevice :",kt);var Mt,bt=!1,Bt=null;if(It.debug("apiCC.mediaDeviceMgr.mediaSourceInfos :",apiCC.mediaDeviceMgr.mediaSourceInfos),apiCC.mediaDeviceMgr.mediaSourceInfos!==null)for(Mt=0;Mt<apiCC.mediaDeviceMgr.mediaSourceInfos.length;++Mt)(Bt=apiCC.mediaDeviceMgr.mediaSourceInfos[Mt]).kind!=="video"&&Bt.kind!=="videoinput"||(Bt.deviceId===kt?(It.log("Video device present :",kt),bt=!0):It.log("not this deviceId"));return bt},apiCC.getMediaDeviceLabelFromDeviceid=function(kt){It.log("getMediaDeviceLabelFromDeviceid :",kt);var Mt,bt="Not_Found",Bt=null;if(It.debug("apiCC.mediaDeviceMgr.mediaSourceInfos :",apiCC.mediaDeviceMgr.mediaSourceInfos),apiCC.mediaDeviceMgr.mediaSourceInfos!==null)for(Mt=0;Mt<apiCC.mediaDeviceMgr.mediaSourceInfos.length;++Mt)(Bt=apiCC.mediaDeviceMgr.mediaSourceInfos[Mt]).deviceId===kt?(It.log("Video device present :",kt),bt=Bt.label):It.log("not this deviceId");return bt},apiCC.setVideoSourceIdInConstraint=function(kt,Mt){if(It.log("setVideoSourceIdInConstraint : ",Mt),kt==null)It.log("videoSourceId not defined");else if(Mt.video===!1)It.log("constraints.video === false, no video device present");else if(apiCC.checkIfVideoSourceIdExistOnDevice(kt)===!1)It.log("videoSourceId not found on device"),Mt.video={};else if(It.log("videoSourceId is defined :",kt),Mt.video!==!0&&Mt.video!==void 0||(Mt.video={}),ot.ag.name==="iOS")if(ot.Xh==="Mobile Safari"){if(kt){var bt=!1,Bt=ot.ag.version.split(".");Bt.length>0&&parseInt(Bt[0])<13&&(bt=!0),Mt.video.deviceId=bt?{exact:kt}:{ideal:kt}}}else Mt.video.deviceId=kt;else ot.Xh==="Firefox"&&ot.PR>=50?ot.Xh==="Firefox"&&ot.PR>=77?(It.debug("FX > 77 using exact to set deviceId"),Mt.video.deviceId={exact:kt}):Mt.video.deviceId=kt:ot.Xh==="Chrome"&&ot.PR<48||ot.Xh==="Safari"&&ot.PR<11?Mt.video.optional=[{sourceId:kt}]:Mt.video.deviceId=kt?{ideal:kt}:void 0;return It.log("constraints =",Mt),Mt},apiCC.setVideoFacingModeInConstraint=function(kt,Mt){It.log("setVideoFacingModeInConstraint");var bt={};return Mt.video===!1?(It.log("facingMode value is not setted, constraints.video is false"),Mt):kt==null?(It.log("facingMode value is not setted"),Mt):kt!=="user"&&kt!=="environment"&&kt!=="left"&&kt!=="right"?(It.log("facingMode value is not correct"),Mt):(navigator.mediaDevices!==null&&navigator.mediaDevices!==void 0&&navigator.mediaDevices.getSupportedConstraints!==null&&navigator.mediaDevices.getSupportedConstraints!==void 0&&(bt=navigator.mediaDevices.getSupportedConstraints()),bt.hasOwnProperty("facingMode")?(It.log("Setting FacingMode in constraint"),Mt.video===!0&&(Mt.video={}),Mt.video.facingMode={ideal:kt}):It.log("FacingMode not supported by device"),It.debug("constraints =",Mt),Mt)},apiCC.setResolutionInConstraint=function(kt,Mt,bt){return It.log("setResolutionInConstraint"),kt<=0||Mt<=0?(It.log("Resolution value must be positif non null"),bt):(bt.video===!0||bt.video!==void 0?ot.ag.name==="iOS"?ot.Xh==="Mobile Safari"?(bt.video.width=kt?{exact:kt}:void 0,bt.video.height=Mt?{exact:Mt}:void 0):(bt.video.width=kt,bt.video.height=Mt):ot.Xh==="Firefox"&&ot.PR>=50?(bt.video.width=kt,bt.video.height=Mt):ot.Xh==="Safari"&&ot.PR>=11||ot.Xh==="Mobile Safari"||ot.Xh==="Edge"&&apiRTC.browserDetails.type!=="chrome"||ot.Xh==="Chrome"&&ot.PR>=49||ot.Xh==="Firefox"&&ot.PR>=50?(bt.video.width=kt?{exact:kt}:void 0,bt.video.height=Mt?{exact:Mt}:void 0):bt.video.mandatory=[{width:kt,height:Mt}]:It.error("setResolutionInConstraint : contraint.video must be true or defined"),It.debug("constraints =",bt),bt)},apiCC.checkConstraintDependingOnDevice=function(kt){It.debug("checkConstraintDependingOnDevice :",kt),ot.Xh==="Mobile Safari"&&ot.PR>=13&&kt.video!==void 0&&kt.video.height!==void 0&&kt.video.width!==void 0&&kt.video.height.ideal===1080&&kt.video.width.ideal===1920&&(It.debug("Downgrading selected height and width resolution on iOS, to avoid stream issue"),kt.video.height.ideal=720,kt.video.width.ideal=1280)},apiCC.attachMediaStream=function(kt,Mt){It.debug("attachMediaStream"),kt!==null?(kt.srcObject!==void 0?kt.srcObject=Mt:kt.mozSrcObject!==void 0?kt.mozSrcObject=Mt:kt.src!==void 0?ot.Xh==="Chrome"&&ot.PR<46?(It.log("Attaching media stream for Chrome < 46"),kt.src=webkitURL.createObjectURL(Mt)):kt.src=URL.createObjectURL(Mt):It.error("Error attaching stream to element."),ot.ag.name==="iOS"&&(It.log("iOS detected"),kt.setAttribute("playsinline",!0))):It.log("videoElt is null")},apiCC.addStreamInDiv=function(kt,Mt,bt,Bt,Ht,Wt,nn){It.debug("addStreamInDiv");var gn,tn=null,Gt=null,fn=!1,Cn=null;(0,st.Ym)(nn,"object")&&nn.type!=null&&(Mt=nn.type),(0,st.Ym)(nn,"object")&&nn.forceAudioAndVideoMediaElementSeparation!==void 0&&(It.debug("forceAudioAndVideoMediaElementSeparation is set"),fn=!0),Mt==="audio"?tn=document.createElement("audio"):(ot.BF==="iOS"&&ot.Xh==="Mobile Safari"&&(It.debug("iOS && Mobile Safari"),fn=!0),tn=document.createElement("video")),tn.id=Bt,tn.autoplay=!0,fn===!0&&Wt===!1?(It.debug("before adding separated MediaEltAudio"),(Cn=document.createElement("audio")).id=Bt+"_sepAudio",Cn.muted=Wt,Cn.autoplay=!0,tn.muted=!0):tn.muted=Wt,tn.style.width=Ht.width,tn.style.height=Ht.height,Ht.controls===!0&&(tn.controls=!0),gn=function(Tn){var dn=null,mn=Tn.play();dn=function(){var yn=Tn.play();It.log("funcFixIoS"),yn!==void 0&&yn.then(function(){It.log("Autoplay started"),document.removeEventListener("touchstart",dn)}).catch(function(pn){It.error("Autoplay was prevented")})},mn!==void 0&&mn.then(function(){It.log("Autoplay started")}).catch(function(yn){ot.ag.name==="iOS"?(It.warn("iOS : Autoplay was prevented, activating touch event to start media play"),apiCC.myWebRTC_Event.createErrorEvent("ERROR: iOS : Autoplay was prevented","IOS_AUTOPLAY_PREVENTED"),document.addEventListener("touchstart",dn)):It.warn("Autoplay was prevented")})},ot.Xh==="Chrome"&&ot.PR==="61"&&ot.BF==="Android"&&(tn.style.borderRadius="1px",It.log("Patch for video display on Chrome 61 Android")),apiCC.session&&apiCC.session.apiCCWebRTCClient&&apiCC.session.apiCCWebRTCClient.webRTCClient.audioOutputId!==void 0&&apiCC.session.apiCCWebRTCClient.webRTCClient.audioOutputId!==null?(It.log("audioOutputId set to: "+apiCC.session.apiCCWebRTCClient.webRTCClient.audioOutputId),tn.setSinkId(apiCC.session.apiCCWebRTCClient.webRTCClient.audioOutputId).then(function(){It.log("Success, audio output device attached")})):It.log("No audioOutputId set"),ot.BF!=="iOS"&&(Gt=document.getElementById(bt)).appendChild(tn),kt!==void 0&&(apiCC.attachMediaStream(tn,kt),fn===!0&&Wt===!1&&apiCC.attachMediaStream(Cn,kt)),ot.BF==="iOS"&&(Gt=document.getElementById(bt)).appendChild(tn),fn===!0&&Wt===!1&&Gt!==null&&Gt.appendChild(Cn),gn(tn),fn===!0&&Wt===!1&&gn(Cn)},apiCC.removeElementFromDiv=function(kt,Mt){It.debug("removeElementFromDiv");var bt,Bt,Ht=null;bt=document.getElementById(Mt),Ht=document.getElementById(kt),bt!==null&&(It.log("Removing video element with Id : "+Mt),Ht!==null&&Ht.removeChild(bt)),(Bt=document.getElementById(Mt+"_sepAudio"))!==null&&(It.log("iOS : Removing audio element with Id : "+Mt+"_sepAudio"),Ht!==null&&Ht.removeChild(Bt))},apiCC.randomString=function(kt,Mt){for(var bt=typeof Mt=="string"&&Mt.length>0?Mt:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Bt="";--kt>=0;)Bt+=bt.charAt(Math.floor(Math.random()*bt.length));return Bt},apiCC.generateCallId=function(){var kt;return kt=Number.MAX_SAFE_INTEGER!==void 0?Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString():Math.floor(1000001*Math.random()).toString(),It.debug("new callId :"+kt),kt},apiCC.generateInstanceId=function(){var kt;return kt=Number.MAX_SAFE_INTEGER!==void 0?Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString():Math.floor(1000001*Math.random()).toString(),It.debug("new instanceId :"+kt),kt},apiCC.myApiCCWhiteBoardClient=null,apiCC.createWhiteBoard=function(kt,Mt,bt,Bt){return It.debug("createWhiteBoard"),apiCC.myApiCCWhiteBoardClient=new apiCC.ApiCCWhiteBoardClient(apiCC.session,kt,Mt,bt,Bt),apiCC.myApiCCWhiteBoardClient},apiCC.closeWhiteBoardClient=function(kt){It.info("closeWhiteBoardClient"),At.createClosingWhiteBoardEvent(apiCC.myApiCCWhiteBoardClient.roomId,kt),apiCC.myApiCCWhiteBoardClient.isInRoom()&&apiCC.myApiCCWhiteBoardClient.leaveRoom(),apiCC.myApiCCWhiteBoardClient.stop()},apiCC.registerIOsDevice=function(kt){It.debug("call registerIOsDevice 1");var Mt={type:"registerIOsDevice",senderId:apiCC.session.apiCCId,token:kt},bt=JSON.stringify(Mt);It.debug("call registerIOsDevice "+bt),apiCC.session.channel.socket.emit("registerIOsDevice",bt),It.debug("call registerIOsDevice  done")},apiCC.registerAndroidDevice=function(kt){It.debug("registerAndroidDevice");var Mt={type:"registerAndroidDevice",senderId:apiCC.session.apiCCId,token:kt},bt=JSON.stringify(Mt);apiCC.session.channel.socket.emit("registerAndroidDevice",bt)},apiCC.unRegisterIOsDevice=function(kt){It.debug("unRegisterIOsDevice");var Mt={type:"unRegisterIOsDevice",senderId:apiCC.session.apiCCId,token:kt},bt=JSON.stringify(Mt);apiCC.session.channel.socket.emit("unRegisterIOsDevice",bt)},apiCC.unRegisterAndroidDevice=function(kt){It.debug("unRegisterAndroidDevice");var Mt={type:"unRegisterAndroidDevice",senderId:apiCC.session.apiCCId,token:kt},bt=JSON.stringify(Mt);apiCC.session.channel.socket.emit("unRegisterAndroidDevice",bt)},apiCC.storeSessionInfoInSessionStorage=function(){var kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(It.info("storeSessionInfoInSessionStorage",kt),apiCC.session){var Mt=5e3;(0,st.ki)(apiCC.session,"apiCCIdPersistenceTimeout","number")&&apiCC.session.apiCCIdPersistenceTimeout>=0&&(Mt=apiCC.session.apiCCIdPersistenceTimeout),(0,st.Ym)(kt.apiCCIdPersistenceTimeout,"number")&&kt.apiCCIdPersistenceTimeout>=0&&(Mt=kt.apiCCIdPersistenceTimeout),apiCC.setSessionStorage("apiCCId",apiCC.session.apiCCId,Mt),apiCC.setSessionStorage("apiKey",apiCC.session.apiKey,Mt),apiCC.session.sessionId!==null&&apiCC.setSessionStorage("sessionId",apiCC.session.sessionId,Mt)}},apiCC.disconnect=function(){var kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};It.info("disconnect",kt),apiCC!==null&&apiCC.cleanAllEventListener(kt),apiCC.session!==null&&apiCC.session!==void 0&&(typeof apiRTC_React>"u"&&kt.invalidateApiCCId!==!0&&apiCC.storeSessionInfoInSessionStorage(kt),apiCC.myApiCCWhiteBoardClient!==null&&(It.log("apiCC.myApiCCWhiteBoardClient.roomId :"+apiCC.myApiCCWhiteBoardClient.roomId),apiCC.myApiCCWhiteBoardClient.roomId!==null&&apiCC.closeWhiteBoardClient("USER_DISCONNECTION")),It.log("Disconnecting from Server"),apiCC.session.channel.socket!==void 0&&apiCC.session.channel.socket!==null&&apiCC.session.channel.socket.disconnect(),apiCC.session.channel.channelHasBeenDisconnected=!1,apiCC.session.connectedUsersList.splice(0,apiCC.session.connectedUsersList.length)),apiCC&&(apiCC.session=null,apiCC.jsLoaded=!1)},apiCC.reconnect=function(){It.log("Reconnect"),It.log("apiCC.session.channel.socket:",apiCC.session.channel.socket),apiCC.session.channel.socket.socket.connect()},apiCC.cleanApiRTCContext=function(){apiCC.session!==null&&apiCC.session!==void 0&&(apiCC.session.apiCCWebRTCClient!==null&&apiCC.session.apiCCWebRTCClient!==void 0&&(apiCC.session.apiCCWebRTCClient.webRTCClient.callsTable.length!==0&&It.warn("Call is still established and will be disconnected"),apiCC.session.apiCCWebRTCClient.webRTCClient.MCUClient.sessionMCUs.length>0&&It.log("MCU session is still established and will be disconnected"),apiCC.session.apiCCWebRTCClient.hangUp(),apiCC.session.apiCCWebRTCClient.webRTCClient.localStream!==null&&(apiCC.session.apiCCWebRTCClient.webRTCClient.stopStream(apiCC.session.apiCCWebRTCClient.webRTCClient.localStream),At.createUserMediaStopEvent(null,"media")),apiCC.session.apiCCWebRTCClient=null),apiCC.session.apiCCIMClient!==null&&apiCC.session.apiCCIMClient!==void 0&&(apiCC.session.apiCCIMClient=null),apiCC.session.apiCCDataClient!==null&&apiCC.session.apiCCDataClient!==void 0&&(apiCC.session.apiCCDataClient=null),apiCC.myApiCCWhiteBoardClient!==null&&apiCC.myApiCCWhiteBoardClient!==void 0&&(apiCC.myApiCCWhiteBoardClient=null))},apiCC.cleanAllEventListener=function(){var kt,Mt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},bt=0;if(apiCC!==null&&apiCC.myEventTable!==null&&(bt=apiCC.myEventTable.length),bt!==0){for(It.trace("number of myEventTable:"+bt),kt=0;kt<bt;kt+=1)Mt.unregister===!0&&apiCC.myEventTable[kt].setBy==="UserAgent"?It.debug("Keeping event for UserAgent process"):apiCC.removeEventListener(apiCC.myEventTable[kt].type,apiCC.myEventTable[kt].listener);apiCC.myEventTable.splice(0,bt),bt=apiCC.myEventTable.length,It.trace("number of myEventTable after splice:"+bt)}},apiCC.testUserPing=function(kt){It.debug("testUserPing()");var Mt,bt,Bt,Ht,Wt=apiCC.bandwidthTestServer+"/upload-test",nn=new XMLHttpRequest,gn=new FormData,tn=Math.round(5*Math.random()),Gt=!1;"withCredentials"in nn?nn.open("POST",Wt,!0):typeof XDomainRequest<"u"?(nn=new XDomainRequest).open("POST",Wt):nn=null,Mt=new Blob([tn],{type:"text/xml"}),gn.append("file",Mt),nn?(nn.onload=function(){nn.status===200&&(Ht=Date.now()-bt,Gt||(clearTimeout(Bt),kt(null,Ht)))},nn.onerror=function(fn){It.log("testUserUpload onerror status :",fn.target.status),kt({err:"An error occured during XMLHttpRequest",msg:fn.target.status},null)},Bt=setTimeout(function(){Gt=!0,kt("Ping timeout",-1)},5e3),nn.send(gn),bt=Date.now()):kt({err:"XMLHttpRequest is not defined",msg:"XMLHttpRequest is not defined"},null)},apiCC.testUserDownload=function(kt,Mt){It.debug("testUserDownload()");var bt,Bt,Ht,Wt,nn,gn,tn=apiCC.bandwidthTestServer+"/files/noise_"+kt+"ko.jpg",Gt=0,fn=new Image,Cn=0;tn+="?nnn="+Date.now();var Tn=[[256,257529],[500,525944],[768,787234],[1e3,1055741],[1500,1541044],[2e3,1992034],[2500,2596028],[3e3,2904977],[3500,3648299],[4e3,4151187],[4500,4741712],[5e3,5264577],[5500,5776081],[6e3,6318553],[6500,6779868],[7e3,7334256],[7500,7874040],[8e3,8081460],[8500,8651795],[9e3,9081899],[9500,9503574],[1e4,10082008],[10500,10543425],[11e3,11200424],[11500,11200424],[12e3,12110671],[12500,12715962],[13e3,13222120],[13500,13605073],[14e3,13954769],[14500,14777594],[15e3,15178928],[15500,15602106],[16e3,16054618],[16500,16578623],[17e3,17048069],[17500,17456403],[18e3,17910332],[18500,18725846],[19e3,19284746],[19500,19771902],[2e4,20121527],[21e3,20975042],[22e3,22189200],[23e3,23027928],[24e3,24027870],[25e3,24878845],[26e3,26237503],[27e3,27112004],[28e3,27953446],[29e3,29313013],[3e4,30474095]];for(nn=0;nn<Tn.length;nn++)kt===Tn[nn][0]&&(Gt=Tn[nn][1]);apiCC.testUserPing(function(dn,mn){fn.onload=function(){for((Bt=Date.now()-bt)-mn>10&&(Bt-=mn),Ht=Gt/(Bt/1e3),Wt=Math.round(Ht/1e3),gn={type:"download",kBPerSec:Wt},nn=0;nn<apiCC.bandwidthRatingThresholds.length;nn++)8*gn.kBPerSec>=apiCC.bandwidthRatingThresholds[nn]&&Cn++;gn.rating=Cn+"/"+apiCC.bandwidthRatingThresholds.length,Mt(null,gn)},fn.onerror=function(yn,pn){Mt({label:"Error when downloading",err:yn,msg:pn},null)},bt=new Date().getTime(),fn.src=tn})},apiCC.testUserUpload=function(kt,Mt){It.debug("testUserUpload()");var bt,Bt,Ht,Wt,nn,gn,tn,Gt=apiCC.bandwidthTestServer+"/upload-test",fn=new XMLHttpRequest,Cn=new FormData,Tn="",dn=0;for(("withCredentials"in fn)?fn.open("POST",Gt,!0):typeof XDomainRequest<"u"?(fn=new XDomainRequest).open("POST",Gt):fn=null,Bt=0;Bt<kt;Bt++)Tn+=Math.round(5*Math.random());bt=new Blob([Tn],{type:"text/xml"}),Cn.append("file",bt),fn?(fn.onload=function(){if(fn.status===200){for(nn=Date.now()-Wt,gn=kt/(nn/1e3),tn=Math.round(gn/1e3),Ht={type:"upload",kBPerSec:tn},Bt=0;Bt<apiCC.bandwidthRatingThresholds.length;Bt++)8*Ht.kBPerSec>=apiCC.bandwidthRatingThresholds[Bt]&&dn++;Ht.rating=dn+"/"+apiCC.bandwidthRatingThresholds.length,Mt(null,Ht)}else Mt({err:"An error occured during XMLHttpRequest",msg:fn.status},null)},fn.onerror=function(mn){It.log("testUserUpload onerror status :",mn.target.status),Mt({err:"An error occured during XMLHttpRequest",msg:mn.target.status},null)},fn.send(Cn),Wt=Date.now()):Mt({err:"XMLHttpRequest is not defined",msg:"XMLHttpRequest is not defined"},null)},apiCC.testUserUploadLoop=function(kt,Mt,bt){var Bt={type:"upload",kBPerSec:Mt.kbps/8,kbps:Mt.kbps,rating:Mt.rating},Ht=0;Mt.kbps>1e3?apiCC.testUserUpload(kt,function(Wt,nn){Wt!==null?bt({err:"An error occured during XMLHttpRequest"},null):(Bt.kBPerSec=nn.kBPerSec,Bt.kbps=8*nn.kBPerSec,Bt.rating=nn.rating,Ht=Bt.kbps-Mt.kbps,It.debug("upload "+kt+" "+JSON.stringify(Bt)+"; diff "+Ht),Ht>=2e4&&kt<12e6?apiCC.testUserUploadLoop(kt+8e6,Bt,bt):Ht>=1e4&&kt<14e6?apiCC.testUserUploadLoop(kt+6e6,Bt,bt):Ht>=5e3&&kt<16e6?apiCC.testUserUploadLoop(kt+4e6,Bt,bt):Ht>=1e3&&kt<18e6?apiCC.testUserUploadLoop(kt+2e6,Bt,bt):Ht>=200&&kt<19e6?apiCC.testUserUploadLoop(kt+1e6,Bt,bt):bt(null,Bt))}):bt(null,Bt)},apiCC.testUserDownloadLoop=function(kt,Mt,bt){var Bt={type:"download",kBPerSec:Mt.kbps/8,kbps:Mt.kbps,rating:Mt.rating},Ht=0;Mt.kbps>=3500?apiCC.testUserDownload(kt,function(Wt,nn){Wt!==null?bt({err:"Error when downloading"},null):(Bt.kBPerSec=nn.kBPerSec,Bt.kbps=8*nn.kBPerSec,Bt.rating=nn.rating,Ht=Bt.kbps-Mt.kbps,It.debug("download "+kt+" "+JSON.stringify(Bt)+"; diff "+Ht),Ht>=2e4?apiCC.testUserDownloadLoop(3e4,Bt,bt):Ht>=1e4&&kt<=2e4?apiCC.testUserDownloadLoop(kt+1e4,Bt,bt):Ht>=5e3&&kt<=25e3?apiCC.testUserDownloadLoop(kt+5e3,Bt,bt):Ht>=1e3&&kt<=27e3?apiCC.testUserDownloadLoop(kt+3e3,Bt,bt):Ht>=200&&kt<=29e3?apiCC.testUserDownloadLoop(kt+1e3,Bt,bt):bt(null,Bt))}):bt(null,Bt)},apiCC.listenedAudioSources={};var Nt=window.AudioContext||window.webkitAudioContext||!1;apiCC.audioContext=null,apiCC.getAudioContext=function(){return apiRTC.osName==="iOS"&&typeof cordova<"u"?It.debug("No audioContext for iOS cordova"):Nt&&apiCC.audioContext===null&&(apiCC.audioContext=new Nt),apiCC.audioContext},apiCC.listenToAudioSources=function(kt){It.debug("listenToAudioSources()");var Mt,bt=apiCC.getAudioContext();bt!=null?(Object.keys(apiCC.listenedAudioSources).length>0&&apiCC.stopAudioSourceListening(),apiCC.getMediaDevices().then(function(Bt){for(It.log(Bt),Mt=0;Mt<Bt.length;Mt++)Bt[Mt].kind==="audioinput"&&(apiCC.listenedAudioSources[Bt[Mt].deviceId]={deviceId:Bt[Mt].deviceId,callback:kt,label:Bt[Mt].label},navigator.getUserMedia({audio:{optional:[{sourceId:Bt[Mt].deviceId}]},video:!1},(function(Ht){It.log("new stream processing function for : "+this.device.deviceId),this.device.audioListener=this;var Wt=this,nn=bt.createScriptProcessor(2048,1,1),gn=bt.createMediaStreamSource(Ht);nn.connect(bt.destination),nn.onaudioprocess=function(){var tn,Gt,fn,Cn=new Uint8Array(this.analyser.frequencyBinCount),Tn=0;for(this.analyser.getByteFrequencyData(Cn),Gt=0;Gt<Cn.length;Gt++)Tn+=Cn[Gt];tn=Tn/Cn.length,fn={deviceId:Wt.device.deviceId,label:Wt.device.label,amplitude:tn,active:Ht.active},Wt.device.callback(fn)},nn.analyser=bt.createAnalyser(),nn.analyser.smoothingTimeConstant=.3,nn.analyser.fftSize=1024,gn.connect(nn.analyser),nn.analyser.connect(nn),this.destroy=function(){It.log("destroy()");var tn,Gt=Ht.getTracks();for(tn=0;tn<Gt.length;tn+=1)Gt[tn].stop();gn.disconnect(),nn.analyser.disconnect(),nn.disconnect()}}).bind({device:apiCC.listenedAudioSources[Bt[Mt].deviceId]}),function(Ht){It.error("Error getting microphone",Ht)}))},function(Bt){It.debug("listenToAudioSources() - getMediaDevices error :",Bt)})):It.debug("listenToAudioSources() - Unable to create audio context")},apiCC.stopAudioSourceListening=function(){var kt;for(It.debug("stopAudioSourceListening()"),kt=0;kt<Object.keys(apiCC.listenedAudioSources).length;kt++)apiCC.listenedAudioSources[Object.keys(apiCC.listenedAudioSources)[kt]]!==void 0?apiCC.listenedAudioSources[Object.keys(apiCC.listenedAudioSources)[kt]].audioListener!==void 0?apiCC.listenedAudioSources[Object.keys(apiCC.listenedAudioSources)[kt]].audioListener.destroy():It.warn("error on stopAudioSourceListening, audioListener"):It.warn("error on stopAudioSourceListening, listenedAudioSources element");apiCC.listenedAudioSources={}},apiCC.webRTCPluginInstalled=!1,apiCC.iePluginInstallationPreventUnload=!1,apiCC.setlogStorageActivated=function(kt,Mt){It.debug("setlogStorageActivated :",kt),this.logStorageActivated=(kt===!0||kt===!1)&&kt,Mt!==void 0&&(this.logStorageLevel=Mt)},apiCC.sendLogToCloud=function(kt,Mt,bt,Bt){It.info("sendLogToCloud");var Ht,Wt,nn=[],gn=null,tn=[],Gt=null,fn=null;for(nn.push(JSON.stringify({title:"ApiRTC logs",description:"Logs of apiRTC client"})),nn.push(JSON.stringify({ts:Date.now(),name:"system-info",args:{browserName:apiCC.browser,browserVersion:apiCC.browser_version,platform:apiCC.osName}})),Ht=0;Ht<kt.length;Ht++)gn=kt[Ht][0]==="error"?{name:"test-run",args:{error:kt[Ht][1]}}:{name:"test-run",args:{info:kt[Ht][1]}},nn.push(JSON.stringify(gn));tn=nn.concat(apiCC.logStorage),Gt=new FormData,Wt="["+tn.join(`,
`)+"]",It.debug("fileContent :",Wt),Bt!==!0&&(Gt.append("data",Wt),Gt.append("apiKey",apiCC.initApiKey),Mt!==void 0&&Gt.append("id",Mt),(fn=new XMLHttpRequest).open("POST",bt+"/test/api/",!0),fn.onreadystatechange=function(){fn.readyState===4&&fn.status===200&&console.info("[apiRTC_Logs] POST'd successfully"),console.trace(fn.responseText)},fn.send(Gt))},apiCC.manageWebRTCPlugin=function(kt,Mt){It.debug("manageWebRTCPlugin");var bt;bt=window.location.protocol!=="https:"?"http":"https",_e([bt+"://cdn.temasys.io/adapterjs/0.15.x/adapter.debug.js"],"temAdapter",{async:!0,numRetries:apiCC.extJsLoadingRetryNb||100,reqdelay:apiCC.extJsLoadingRetryDelay||200,success:function(){It.log("End of .js loading for plugin"),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("temAdapter","loaded"),AdapterJS.WebRTCPlugin.isPluginInstalled(AdapterJS.WebRTCPlugin.pluginInfo.prefix,AdapterJS.WebRTCPlugin.pluginInfo.plugName,AdapterJS.WebRTCPlugin.pluginInfo.type,function(){apiCC.myWebRTC_Adapter.RTCSessionDescription=RTCSessionDescription,apiCC.myWebRTC_Adapter.RTCIceCandidate=RTCIceCandidate,apiCC.myWebRTC_Adapter.RTCPeerConnection=RTCPeerConnection,apiCC.myWebRTC_Adapter.getUserMedia=navigator.getUserMedia,apiCC.attachMediaStream=attachMediaStream,AdapterJS.webRTCReady(function(Bt){return It.log("webRTCReady, plugin already installed"),kt()})},function(){return apiCC.iePluginInstallationPreventUnload=!0,Mt(),AdapterJS.webRTCReady(function(Bt){return It.log("webRTCReady after plugin install"),apiCC.iePluginInstallationPreventUnload=!1,apiCC.myWebRTC_Adapter.RTCSessionDescription=RTCSessionDescription,apiCC.myWebRTC_Adapter.RTCIceCandidate=RTCIceCandidate,apiCC.myWebRTC_Adapter.RTCPeerConnection=RTCPeerConnection,apiCC.myWebRTC_Adapter.getUserMedia=navigator.getUserMedia,apiCC.attachMediaStream=attachMediaStream,kt()}),apiCC.session.apiCCWebRTCClient.myWebRTC_Event.createEvent({eventType:"webRTCPluginInstallation"}),null})},error:function(Bt){It.error("temAdapter loading error"),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("temAdapter","error")},retrycb:function(Bt,Ht){It.warn("temAdapter loading retry :"+Bt+" ,delay before retry :"+Ht),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("temAdapter","retry")}})},apiCC.checkMutingStateForUserMedia=function(kt,Mt){It.debug("checkMutingStateForUserMedia"),(0,st.ki)(kt,"muted","string")&&(It.log("callConfiguration muted is set :",kt.muted),kt.muted==="VIDEO"&&(Mt.muteVideoOnStreams("enabled"),Mt.muteAudioOnStreams("enabled")),kt.muted==="AUDIOONLY"&&Mt.muteAudioOnStreams("enabled"),kt.muted==="VIDEOONLY"&&Mt.muteVideoOnStreams("enabled"))},apiCC.isSIPNumber=function(kt){var Mt,bt=null,Bt=!1;return Mt=kt.toString().startsWith("sip:"),kt.toString().length<=20&&(bt=!0),(kt.toString().indexOf("0")!==0&&kt.toString().indexOf("+")!==0||bt!==!0)&&Mt!==!0||(Bt=!0),Bt},apiCC.loadSentry=function(kt,Mt){It.debug("Remote logging activation"),_e([Mt+"://browser.sentry-cdn.com/5.24.2/bundle.tracing.min.js"],"Sentry",{async:!0,numRetries:10,reqdelay:500,success:function(){Sentry.init({dsn:"https://c24c226714f841dbbc3d1518b6cc7fe8@o333237.ingest.sentry.io/5448622",release:apiCC.version,tracesSampleRate:1}),Sentry.configureScope(function(bt){bt.setTag("apiKey",kt)})},error:function(bt){console.error("Remote logging - loading error")},retrycb:function(bt,Bt){console.warn("Remote logging - loading retry :"+bt+" ,delay before retry :"+Bt)}})},apiCC.sendSentryEvent=function(kt){if(It.debug("sendSentryEvent",kt),typeof Sentry<"u"){var Mt="",bt={};kt.eventType==="muteUnmuteEvent"?(Mt="Mute event on callId:"+kt.callId,bt.muteType=kt.muteType,bt.source=kt.source,bt.mLine=kt.mLine,bt.state=kt.state,bt.callId=kt.callId,bt.username=kt.username):It.error("sendSentryEvent error : type ",kt.eventType," is not supported");var Bt=Object.keys(bt);Mt!==""&&Bt.length>0&&Sentry.withScope(function(Ht){Bt.forEach(function(Wt){Ht.setTag(Wt,bt[Wt])}),Sentry.captureMessage(Mt)})}else It.debug("Sentry not activated")},apiCC.addPendingPromise=function(kt,Mt,bt){var Bt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5e3;It.debug("addPendingPromise"),apiCC.pendingPromisesId++;var Ht=function(nn){apiCC.cleanPendingPromiseTable(nn),bt("Timeout problem during ".concat(kt," process on a remote stream"))},Wt=setTimeout(function(){Ht(apiCC.pendingPromisesId)},Bt);return apiCC.pendingPromises.push({timeout:Wt,resolve:Mt,reject:bt,pendingPromisesId:apiCC.pendingPromisesId}),Wt},apiCC.resolvePendingPromise=function(kt,Mt){It.debug("resolvePendingPromise"),apiCC.pendingPromises.forEach(function(bt){kt===bt.timeout&&(clearTimeout(kt),bt.resolve(Mt),apiCC.cleanPendingPromiseTable(bt.pendingPromisesId))})},apiCC.rejectPendingPromise=function(kt,Mt){It.debug("rejectPendingPromise"),apiCC.pendingPromises.forEach(function(bt){kt===bt.timeout&&(clearTimeout(kt),bt.reject(Mt),apiCC.cleanPendingPromiseTable(bt.pendingPromisesId))})},apiCC.cleanPendingPromiseTable=function(kt){apiCC.pendingPromises.forEach(function(Mt,bt){kt===Mt.pendingPromisesId&&apiCC.pendingPromises.splice(bt,1)})}},5945:(it,ut,s)=>{s.d(ut,{$6:()=>St,AA:()=>At,Ak:()=>mt,BF:()=>st,Cm:()=>ht,E2:()=>ot,MM:()=>ft,Ne:()=>xt,PR:()=>pt,TI:()=>Nt,Xh:()=>ct,ag:()=>gt,cf:()=>It,dc:()=>yt,vO:()=>at}),s(8309),s(2772),s(9064);var tt,ot=null,ct=null,yt=null,pt=null,gt=null,st=null,ft=null,at=null,ht=null,mt=null,St=null,It=null,xt=null,At=null,Nt=null;tt=(ot=new UAParser).getBrowser(),gt=ot.getOS(),It=ot.getBrowser(),typeof apiRTC_React<"u"?(yt=DeviceInfo.getSystemVersion(),st=DeviceInfo.getSystemName(),ct=DeviceInfo.getUserAgent(),at=DeviceInfo.getModel()):(yt=tt.version||"Unknown",st=ot.getOS().name||"Unknown",ft=ot.getOS().version||"Unknown",ct=tt.name||"Unknown",xt=ot.getCPU().architecture||"Unknown",at=ot.getDevice().type||"Unknown",ht=ot.getDevice().vendor||"Unknown",mt=ot.getDevice().model||"Unknown",At=ot.getEngine().name||"Unknown",Nt=ot.getEngine().version||"Unknown"),pt=yt!==void 0?tt.major:99,window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.toLowerCase().indexOf(" electron/")>=0&&(St="electron")},4708:(it,ut,s)=>{function tt(Nt){return tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(kt){return typeof kt}:function(kt){return kt&&typeof Symbol=="function"&&kt.constructor===Symbol&&kt!==Symbol.prototype?"symbol":typeof kt},tt(Nt)}s.d(ut,{Pj:()=>yt,S6:()=>ft,Wc:()=>st,Ym:()=>It,_C:()=>ct,cw:()=>St,dD:()=>gt,fS:()=>At,ki:()=>xt,wL:()=>ht,ws:()=>at,yJ:()=>pt}),s(4603),s(4916),s(9714),s(3123),s(9600),s(1249),s(7941),s(4723),s(1058),s(6992),s(9575),s(1539),s(2472),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(9753),s(7042),s(2526),s(1817),s(2165),s(8783),s(3948);var ot=s(1549).Y.get("Utils");function ct(Nt){return new RegExp("^[0-9-.]*$","g").test(Nt)}function yt(){return typeof apiRTC_React<"u"||window.location.protocol==="https:"}function pt(){return typeof apiRTC_React>"u"&&window.location.protocol==="http:"}function gt(Nt){var kt,Mt,bt,Bt,Ht={};for(bt=0,Bt=(kt=Nt.split("&")).length;bt<Bt;bt++)Ht[(Mt=kt[bt].split("="))[0]]=Mt[1];return Ht}function st(Nt){return Object.keys(Nt).map(function(kt){return kt+"="+Nt[kt]}).join("&")}function ft(Nt,kt){ot.debug("mergeJSON");var Mt={},bt=null;if(Nt)for(bt in Nt)Nt.hasOwnProperty(bt)&&(Mt[bt]=Nt[bt]);if(kt)for(bt in kt)kt.hasOwnProperty(bt)&&(Mt[bt]=kt[bt]);return ot.log(Mt),Mt}var at=function(Nt,kt){var Mt,bt,Bt;for(Nt==null&&(Nt={}),Mt=1;Mt<arguments.length;Mt+=1)for(bt in Bt=arguments[Mt])Bt.hasOwnProperty(bt)&&(Nt[bt]=Bt[bt]);return Nt},ht=function(){var Nt=function(Mt,bt,Bt){var Ht=Mt.match(bt);return Ht&&Ht.length>=Bt&&parseInt(Ht[Bt],10)},kt={};if(typeof apiRTC_React<"u")return kt.type="react-native",kt;if(window!==void 0&&window.navigator!==void 0)if(window.navigator.mozGetUserMedia)kt.type="firefox",kt.version=Nt(window.navigator.userAgent,/Firefox\/(\d+)\./,1);else if(window.navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)kt.type="chrome",kt.version=Nt(window.navigator.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!window.navigator.userAgent.match(/Version\/(\d+).(\d+)/))return kt;kt.type="safari",kt.version=Nt(window.navigator.userAgent,/AppleWebKit\/(\d+)\./,1)}else if(window.navigator.mediaDevices&&window.navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))kt.type="edge",kt.version=Nt(window.navigator.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!window.navigator.mediaDevices||!window.navigator.userAgent.match(/AppleWebKit\/(\d+)\./))return kt;kt.type="safari",kt.version=Nt(window.navigator.userAgent,/AppleWebKit\/(\d+)\./,1)}return kt}(),mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-/=",St={decode:function(Nt){var kt,Mt=mt.indexOf(Nt.charAt(Nt.length-1)),bt=mt.indexOf(Nt.charAt(Nt.length-2)),Bt=Nt.length/4*3,Ht=null,Wt=null,nn=null,gn=null,tn=null,Gt=null,fn=0,Cn=null;for(Mt===64&&Bt--,bt===64&&Bt--,Cn=new Uint8Array(Bt),kt=0;kt<Bt;kt+=3)Ht=mt.indexOf(Nt.charAt(fn++))<<2|(gn=mt.indexOf(Nt.charAt(fn++)))>>4,Wt=(15&gn)<<4|(tn=mt.indexOf(Nt.charAt(fn++)))>>2,nn=(3&tn)<<6|(Gt=mt.indexOf(Nt.charAt(fn++))),Cn[kt]=Ht,tn!==64&&(Cn[kt+1]=Wt),Gt!==64&&(Cn[kt+2]=nn);return Cn},encode:function(Nt){var kt,Mt="",bt=new Uint8Array(Nt),Bt=bt.byteLength,Ht=Bt%3,Wt=Bt-Ht,nn=null;for(kt=0;kt<Wt;kt+=3)nn=bt[kt]<<16|bt[kt+1]<<8|bt[kt+2],Mt+=mt[(16515072&nn)>>18]+mt[(258048&nn)>>12]+mt[(4032&nn)>>6]+mt[63&nn];return Ht===1?(nn=bt[Wt],Mt+=mt[(252&nn)>>2]+mt[(3&nn)<<4]+"=="):Ht===2&&(nn=bt[Wt]<<8|bt[Wt+1],Mt+=mt[(64512&nn)>>10]+mt[(1008&nn)>>4]+mt[(15&nn)<<2]+"="),Mt}};function It(Nt,kt){return arguments.length===3?xt(arguments[0],arguments[1],arguments[2]):kt==="null"?Nt===null:kt==="array"?Nt!==null&&tt(Nt)==="object"&&Array.isArray(Nt):Nt!==null&&tt(Nt)===kt}function xt(Nt,kt,Mt){if(kt!==null&&tt(kt)==="object"&&Array.isArray(kt)&&kt.length>=1){var bt=kt[0];if(kt.length>1)return It(Nt,"object")&&It(bt,"string")&&Nt.hasOwnProperty(bt)&&It(Nt[bt],"object")&&xt(Nt[bt],kt.slice(1),Mt);kt=bt}return Mt==="undefined"?It(Nt,"object")&&It(kt,"string")&&!Nt.hasOwnProperty(kt)&&It(Nt[kt],Mt):It(Nt,"object")&&It(kt,"string")&&Nt.hasOwnProperty(kt)&&It(Nt[kt],Mt)}function At(Nt,kt){if(Nt===kt)return!0;if(!(Nt instanceof Object&&kt instanceof Object)||Nt.constructor!==kt.constructor)return!1;for(var Mt in Nt)if(Nt.hasOwnProperty(Mt)){if(!kt.hasOwnProperty(Mt))return!1;if(Nt[Mt]===kt[Mt])continue;if(tt(Nt[Mt])!=="object"||!At(Nt[Mt],kt[Mt]))return!1}for(Mt in kt)if(kt.hasOwnProperty(Mt)&&!Nt.hasOwnProperty(Mt))return!1;return!0}},6075:(it,ut,s)=>{s.d(ut,{F:()=>ot});var tt=s(1549).Y.get("WebRTC_Stack"),ot=function(){this.adaptForIoSCordova=function(){if(apiRTC.osName==="iOS"&&typeof cordova<"u"){if(tt.log("Modification for iOS cordova"),cordova.plugins===void 0)return void tt.log("cordova.plugins not defined");if(cordova.plugins.iosrtc===void 0)return void tt.log("cordova.plugins.iosrtc not defined");this.RTCPeerConnection=cordova.plugins.iosrtc.RTCPeerConnection,this.RTCSessionDescription=cordova.plugins.iosrtc.RTCSessionDescription,this.RTCIceCandidate=cordova.plugins.iosrtc.RTCIceCandidate}},typeof RTCSessionDescription<"u"?this.RTCSessionDescription=RTCSessionDescription:tt.log("RTCSessionDescription is undefined"),typeof RTCIceCandidate<"u"?this.RTCIceCandidate=RTCIceCandidate:tt.log("RTCIceCandidate is undefined"),typeof RTCPeerConnection<"u"?this.RTCPeerConnection=RTCPeerConnection:tt.log("RTCPeerConnection is undefined"),navigator.getUserMedia!==void 0?this.getUserMedia=navigator.getUserMedia:typeof getUserMedia<"u"?this.getUserMedia=getUserMedia:tt.log("getUserMedia is undefined")}},8765:(it,ut,s)=>{s.d(ut,{K:()=>gt}),s(6755),s(2772),s(3710),s(8309),s(9601),s(2526),s(1817),s(1539),s(2165),s(6992),s(8783),s(3948);var tt=s(1549),ot=s(5945),ct=s(4708);function yt(st){return yt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ft){return typeof ft}:function(ft){return ft&&typeof Symbol=="function"&&ft.constructor===Symbol&&ft!==Symbol.prototype?"symbol":typeof ft},yt(st)}var pt=tt.Y.get("WebRTC_Event"),gt=function(){if(pt.debug("WebRTC_Event"),this.customEventIsDefined="notTested",this.customEventIsDefined==="notTested")try{new CustomEvent("test",{detail:"test",bubbles:!0,cancelable:!0}),this.customEventIsDefined=!0}catch(st){this.customEventIsDefined=!1,pt.log("customEvent error :"+st)}(ot.Xh==="IE"&&ot.dc>8||ot.Xh==="Netscape")&&(pt.log("polyfill the CustomEvent()"),function(){function st(ft,at){at=at||{bubbles:!1,cancelable:!1,detail:void 0};var ht=document.createEvent("CustomEvent");return ht.initCustomEvent(ft,at.bubbles,at.cancelable,at.detail),ht}st.prototype=window.CustomEvent.prototype,window.CustomEvent=st}(),this.customEventIsDefined=!0),ot.Xh==="IE"&&ot.dc>8&&(pt.log("polyfill startsWith()"),String.prototype.startsWith||(String.prototype.startsWith=function(st,ft){return ft=ft||0,this.indexOf(st,ft)===ft})),this.eventDispatchMgr=function(st,ft){if(typeof apiRTC_React<"u"){var at={type:st,detail:ft};eventManager.dispatchEvent(at)}else if(this.customEventIsDefined===!1)typeof $jqApz<"u"?(pt.log("CustomEvent not supported by Browser, using $jqApz "),$jqApz.event.trigger({type:st,detail:ft})):typeof jQuery<"u"?(pt.log("CustomEvent not supported by Browser, using jQuery "),jQuery.event.trigger({type:st,detail:ft})):pt.warn("Custom Events not supported on this browser : eventDispatchMgr()");else{var ht=new CustomEvent(st,{detail:ft,bubbles:!0,cancelable:!0});document.dispatchEvent(ht)}},this.createIncomingCallEvent=function(st,ft,at,ht,mt,St,It,xt,At,Nt,kt){var Mt={eventType:"incomingCall",time:new Date,clientId:st,callerId:ft,callId:ht,autoAnswerActivated:mt,callNumber:St,callerNickname:at,audioOnly:It,callType:xt,destCallType:kt,recordedCall:At,remoteType:Nt};this.eventDispatchMgr("incomingCall",Mt)},this.createCallAttemptEvent=function(st,ft,at,ht){var mt={eventType:"callAttempt",time:new Date,clientId:st,callerId:ft,callId:ht,callerNickname:at};this.eventDispatchMgr("callAttempt",mt)},this.createCallEstablishedEvent=function(st,ft,at,ht){pt.debug("createCallEstablishedEvent with callType : "+ft),pt.debug("destCallType : "+ht);var mt={eventType:"callEstablished",time:new Date,calleeId:st,callType:ft,callId:at,destCallType:ht};this.eventDispatchMgr("callEstablished",mt)},this.createHangupEvent=function(st,ft,at,ht,mt,St,It){var xt={eventType:"hangup",time:new Date,hangupType:st,clientId:ft,remoteId:at,lastEstablishedCall:ht,reason:mt,callId:St,callType:It};this.eventDispatchMgr("hangup",xt)},this.createRemoteHangupEvent=function(st,ft,at,ht){var mt={eventType:"remoteHangup",time:new Date,clientId:st,remoteId:ft,lastEstablishedCall:at,reason:ht};this.eventDispatchMgr("remoteHangup",mt)},this.createCallRestartingEvent=function(st,ft,at,ht,mt,St,It,xt,At){var Nt={eventType:"callRestarting",time:new Date,callType:st,audioOnly:ft,oldCallId:at,newCallId:ht,dataType:mt,clientId:St,remoteId:It,destRoom:xt,streamId:At};this.eventDispatchMgr("callRestarting",Nt)},this.createUserMediaSuccessEvent=function(st,ft,at,ht,mt,St,It,xt,At,Nt,kt){var Mt={eventType:"userMediaSuccess",time:new Date,onCallEstablishment:st,audioIsAvailable:ft,audioDeviceLabel:at,videoIsAvailable:ht,videoDeviceLabel:mt,callType:St,callId:It,stream:xt,remoteId:At,restarted:Nt,userMediaStreamId:kt};this.eventDispatchMgr("userMediaSuccess",Mt)},this.createUserMediaErrorEvent=function(st,ft,at,ht,mt,St,It){var xt={eventType:"userMediaError",time:new Date,onCallEstablishment:st,callType:ft,userMediaStreamId:ht,callId:mt,tryAudioCallActivated:St,gumConfig:It};yt(at)==="object"?(xt.error={},xt.error.message=at.message,xt.error.code=at.code,xt.error.name=at.name):xt.error=at,this.eventDispatchMgr("userMediaError",xt)},this.createUserMediaStopEvent=function(st,ft,at){var ht={eventType:"userMediaStop",time:new Date,callId:st,mediaType:ft,userMediaStreamId:at};this.eventDispatchMgr("userMediaStop",ht)},this.createICECandidateTypeUpdateEvent=function(st,ft,at){var ht={eventType:"ICECandidateTypeUpdate",time:new Date,callId:st,localCandidate:ft,remoteCandidate:at};this.eventDispatchMgr("ICECandidateTypeUpdate",ht)},this.createSelectedICECandidateEvent=function(st,ft,at,ht,mt,St,It){var xt={eventType:"selectedICECandidate",time:new Date,callId:st,localCandidateType:ft,remoteCandidateType:at,localAddress:ht,remoteAdress:mt,transportType:St,localTransportType:It};this.eventDispatchMgr("selectedICECandidate",xt)},this.createErrorEvent=function(st,ft,at,ht,mt,St,It){var xt={eventType:"error",time:new Date,errorInfo:st,errorCode:ft,callId:at,roomName:ht,roomCallType:mt};(0,ct.Ym)(St,"object")&&(xt.data=St),(0,ct.Ym)(It,"string")&&(xt.convId=It),this.eventDispatchMgr("error",xt)},this.createReceiveIMMessageEvent=function(st,ft,at,ht,mt,St){var It={eventType:"receiveIMMessage",time:new Date,senderId:st,senderNickname:ft,senderPhotoURL:at,message:ht,UUCSeq:mt,convId:St};this.eventDispatchMgr("receiveIMMessage",It)},this.createChannelEvent=function(st,ft){var at={eventType:"channelEvent",time:new Date,channelEvent:st,event:ft};this.eventDispatchMgr("channelEvent",at)},this.createSessionReadyEvent=function(st){pt.debug("createSessionReadyEvent");var ft={eventType:"sessionReady",time:new Date,apiCCId:st};this.eventDispatchMgr("sessionReady",ft)},this.createWebRTCClientCreatedEvent=function(){var st={eventType:"webRTCClientCreated",time:new Date};this.eventDispatchMgr("webRTCClientCreated",st)},this.createUpdatePresenceEvent=function(st,ft,at){var ht={eventType:"updatePresence",time:new Date,connectedUsersList:st,connectedUsersListWithStatus:at,state:ft};this.eventDispatchMgr("updatePresence",ht)},this.createCloudEventOccurredEvent=function(st,ft){var at={eventType:"cloudEventOccurred",time:new Date,topic:st,target:ft};this.eventDispatchMgr("cloudEventOccurred",at)},this.createUpdateUserStatusEvent=function(st){var ft={eventType:"updateUserStatus",time:new Date,message:st};this.eventDispatchMgr("updateUserStatus",ft)},this.createGroupChatCreationEvent=function(st,ft,at,ht,mt,St){var It={eventType:"groupChatCreation",time:new Date,status:st,groupChatId:ft,initialDestId:at,invitationSendedToInitialDestId:ht,newContactId:mt,invitationSendedToNewContactId:St};this.eventDispatchMgr("groupChatCreation",It)},this.createGroupChatInvitationEvent=function(st,ft,at,ht,mt){var St={eventType:"groupChatInvitation",time:new Date,groupChatId:st,contactList:mt,senderId:ft,senderNickname:at,senderPhotoURL:ht};this.eventDispatchMgr("groupChatInvitation",St)},this.createGroupChatMemberUpdateEvent=function(st,ft,at){var ht={eventType:"groupChatMemberUpdate",time:new Date,groupChatId:st,contactList:ft,status:at};this.eventDispatchMgr("groupChatMemberUpdate",ht)},this.createAddUserInGroupChatEvent=function(st,ft,at){var ht={eventType:"addUserInGroupChatAnswer",time:new Date,invitationSended:st,groupChatId:ft,contactId:at};this.eventDispatchMgr("addUserInGroupChatAnswer",ht)},this.createReceiveGroupChatMessageEvent=function(st,ft,at,ht,mt){var St={eventType:"receiveGroupChatMessage",time:new Date,groupChatId:st,senderId:ft,senderNickname:at,message:ht};(0,ct.Ym)(mt,"object")&&(St.metadata=mt),this.eventDispatchMgr("receiveGroupChatMessage",St)},this.createReceiveConversationListAnswerEvent=function(st){var ft={eventType:"receiveConversationList",time:new Date,convList:st};this.eventDispatchMgr("receiveConversationList",ft)},this.createReceiveContactOccurrencesFromConversationListAnswerEvent=function(st){var ft={eventType:"receiveContactOccurrencesFromConversationList",time:new Date,occurrencesList:st};this.eventDispatchMgr("receiveContactOccurrencesFromConversationList",ft)},this.createReceiveConversationDetailReportAnswerEvent=function(st){var ft={eventType:"receiveConversationDetailReport",time:new Date,CDR:st};this.eventDispatchMgr("receiveConversationDetailReport",ft)},this.createReceiveConversationHistoryEvent=function(st,ft,at){var ht={eventType:"receiveConversationHistory",time:new Date,convId:st,convHistory:ft,status:at};this.eventDispatchMgr("receiveConversationHistory",ht)},this.createUserDataAnswerEvent=function(st,ft,at,ht){var mt={eventType:"userDataAnswer",time:new Date,userFound:st,contactId:ft,nickname:at,photoURL:ht};this.eventDispatchMgr("userDataAnswer",mt)},this.createFetchUserDataAnswerEvent=function(st){var ft="fetchUserDataAnswer",at={eventType:ft,timeout:st.timeout,userData:st.userData,id:st.id};this.eventDispatchMgr(ft,at)},this.createReceiveDataEvent=function(st,ft,at){var ht={eventType:"receiveData",time:new Date,senderId:st,dstRoomId:ft,data:at};this.eventDispatchMgr("receiveData",ht)},this.createMCUSessionCreationEvent=function(st,ft){var at={eventType:"MCUSessionCreation",time:new Date,sessionId:st,token:ft};this.eventDispatchMgr("MCUSessionCreation",at)},this.createJoinMCUSessionAnswerEvent=function(st,ft,at,ht,mt){var St={eventType:"joinMCUSessionAnswer",time:new Date,sessionId:st,token:ft,groupChatId:at,initiator:ht,roomId:mt.roomName};mt.roomMode&&(St.mode=mt.roomMode),mt.meshOnly===!0&&(St.meshOnly=!0),mt.joinSessionAnswer&&(St.result=Object.assign({},mt.joinSessionAnswer)),this.eventDispatchMgr("joinMCUSessionAnswer",St)},this.createMCUAvailableStreamEvent=function(st,ft){var at={eventType:"MCUAvailableStream",time:new Date,streams:st,isRemoteStream:ft};this.eventDispatchMgr("MCUAvailableStream",at)},this.createMCUAvailableReplayEvent=function(st,ft){var at={eventType:"MCUAvailableReplay",time:new Date,streams:st,isRemoteStream:ft};this.eventDispatchMgr("MCUAvailableReplay",at)},this.createMCUAvailableCompositeEvent=function(st,ft){var at={eventType:"MCUAvailableComposite",time:new Date,streams:st,isRemoteStream:ft};this.eventDispatchMgr("MCUAvailableComposite",at)},this.createMCURemovedStreamEvent=function(st){var ft={eventType:"MCURemoveStream",time:new Date,streamId:st};this.eventDispatchMgr("MCURemoveStream",ft)},this.createMCUAvailableStreamUpdateEvent=function(st,ft){var at={eventType:"MCUAvailableStreamUpdate",time:new Date,streams:st,isRemoteStream:ft};this.eventDispatchMgr("MCUAvailableStreamUpdate",at)},this.createMCUParticipantEjectedEvent=function(st,ft,at){var ht={eventType:"MCUParticipantEjected",time:new Date,roomId:st,clientId:ft};at&&(ht.data=at),this.eventDispatchMgr("MCUParticipantEjected",ht)},this.createReceiveMCUSessionInvitationEvent=function(st,ft,at,ht){at===void 0&&(at=0);var mt={eventType:"receiveMCUSessionInvitation",time:new Date,sessionId:st,token:ft,groupChatId:at,initiatorId:ht};this.eventDispatchMgr("receiveMCUSessionInvitation",mt)},this.createRemoteStreamAddedEvent=function(st,ft,at,ht,mt,St,It){var xt={eventType:"remoteStreamAdded",time:new Date,callId:ft,callType:st,stream:at,remoteId:ht,destCallType:mt,audioIsAvailable:St.available,audioIsActive:St.active,audioIsMuted:St.muted,videoIsAvailable:It.available,videoIsActive:It.active,videoIsMuted:It.muted};this.eventDispatchMgr("remoteStreamAdded",xt)},this.createRemoteStreamRemovedEvent=function(st,ft,at,ht,mt){var St={eventType:"remoteStreamRemoved",time:new Date,callId:ft,callType:st,stream:at,remoteId:ht,destCallType:mt};this.eventDispatchMgr("remoteStreamRemoved",St)},this.createSimulcastFeedChanged=function(st,ft){var at={eventType:"simulcastFeedChanged",time:new Date,callId:st,simulcast:ft};this.eventDispatchMgr("simulcastFeedChanged",at)},this.createLocalStreamRemovedEvent=function(st,ft,at,ht,mt){var St={eventType:"localStreamRemoved",time:new Date,callId:ft,callType:st,stream:at,remoteId:ht,destCallType:mt};this.eventDispatchMgr("localStreamRemoved",St)},this.createSlowLinkEvent=function(st,ft){var at={eventType:"slowLink",time:new Date,callId:st};ft&&(at.advice=ft),this.eventDispatchMgr("slowLink",at)},this.createVideoQualityChangedEvent=function(st,ft,at,ht){var mt={eventType:"videoQualityChanged",time:new Date,roomname:ft,callId:st,hint:at,profileType:ht.name};ht.bitrate&&(mt.bitrate=ht.bitrate),ht.width&&ht.height&&(mt.width=ht.width,mt.height=ht.height),ht.frameRate&&(mt.frameRate=ht.frameRate),this.eventDispatchMgr("videoQualityChanged",mt)},this.createAudioAmplitudeEvent=function(st,ft,at,ht){var mt={eventType:"audioAmplitude",time:new Date,callId:at,userMediaStreamId:ht,descriptor:{amplitude:st,isSpeaking:ft}};this.eventDispatchMgr("audioAmplitude",mt)},this.createLocalStreamUpdatedEvent=function(st,ft,at,ht,mt,St,It,xt,At){var Nt={eventType:"localStreamUpdated",time:new Date,changeList:st,audioIsAvailable:ft.available,audioDeviceLabel:ft.deviceLabel,audioIsActive:ft.active,audioIsMuted:ft.muted,audioIsSilent:ft.silent,videoIsAvailable:at.available,videoDeviceLabel:at.deviceLabel,videoIsActive:at.active,videoIsMuted:at.muted,videoIsSilent:at.silent,onCall:ht,callType:mt,callId:St,stream:It,userMediaStreamId:xt,cause:At};this.eventDispatchMgr("localStreamUpdated",Nt)},this.createRemoteStreamUpdatedEvent=function(st,ft,at,ht,mt,St){var It={eventType:"remoteStreamUpdated",time:new Date,changeList:st,audioIsAvailable:ft.available,audioIsActive:ft.active,audioIsMuted:ft.muted,audioIsSilent:ft.silent,videoIsAvailable:at.available,videoIsActive:at.active,videoIsMuted:at.muted,videoIsSilent:at.silent,callType:ht,callId:mt,cause:St};this.eventDispatchMgr("remoteStreamUpdated",It)},this.createCanPlayRemoteVideoEvent=function(st,ft,at){var ht={eventType:"canPlayRemoteVideo",time:new Date,videoDivId:st,callType:ft,remoteId:at};this.eventDispatchMgr("canPlayRemoteVideo",ht)},this.createRecordedFileAvailableEvent=function(st){var ft={eventType:"recordedFileAvailable",time:new Date,fileName:st};this.eventDispatchMgr("recordedFileAvailable",ft)},this.createRecordedStreamsAvailableEvent=function(st,ft,at,ht,mt,St,It){var xt={eventType:"recordedStreamsAvailable",time:new Date,confId:st,userId1:ft,userId2:at,callId:ht,apiKey:apiCC.session.apiKey};mt&&(xt.convId=mt),St&&(xt.mediaId=St),It&&(xt.mediaURL=It),this.eventDispatchMgr("recordedStreamsAvailable",xt)},this.createMCURecordedStreamsAvailableEvent=function(st,ft,at,ht,mt,St,It,xt,At,Nt,kt){var Mt={eventType:"MCURecordedStreamsAvailable",time:new Date,roomName:st,callId:ft,clientId:at,convId:mt,mediaId:St,mediaURL:It,recordType:xt};At&&(Mt.remoteId=At),ht&&(Mt.recordedFileName=ht),Nt&&(Mt.mediaType=Nt),(0,ct.Ym)(kt,"object")?(Mt.descriptor={},(0,ct.Ym)(kt,"mode","string")&&(Mt.descriptor.mode=kt.mode),(0,ct.Ym)(kt,"labelEnabled","boolean")&&(Mt.descriptor.labelEnabled=kt.labelEnabled),Mt.descriptor.labelEnabled===!0&&(0,ct.Ym)(kt,"labels","array")&&(Mt.descriptor.labels=kt.labels)):Mt.descriptor={mode:"complete",labelEnabled:!1},this.eventDispatchMgr("MCURecordedStreamsAvailable",Mt)},this.createMCURecordingStartedEvent=function(st,ft,at,ht,mt,St,It,xt,At,Nt,kt,Mt){var bt={eventType:"MCURecordingStarted",time:new Date,roomName:st,callId:ft,clientId:at,recordType:ht,recordStartTime:mt};St&&(bt.convId=St),It&&(bt.mediaId=It),xt&&(bt.mediaURL=xt),At&&(bt.remoteId=At),Nt&&(bt.recordedFileName=Nt),kt&&(bt.mediaType=kt),(0,ct.Ym)(Mt,"object")&&(bt.descriptor={},(0,ct.Ym)(Mt,"mode","string")&&(bt.descriptor.mode=Mt.mode),(0,ct.Ym)(Mt,"labelEnabled","boolean")&&(bt.descriptor.labelEnabled=Mt.labelEnabled),bt.descriptor.labelEnabled===!0&&(0,ct.Ym)(Mt,"labels","array")&&(bt.descriptor.labels=Mt.labels)),this.eventDispatchMgr("MCURecordingStarted",bt)},this.createMCURecordingStoppedEvent=function(st,ft,at,ht,mt,St,It,xt,At,Nt,kt,Mt){var bt={eventType:"MCURecordingStopped",time:new Date,roomName:st,callId:ft,clientId:at,recordType:ht,recordStartTime:mt};St&&(bt.convId=St),It&&(bt.mediaId=It),xt&&(bt.mediaURL=xt),At&&(bt.remoteId=At),Nt&&(bt.recordedFileName=Nt),kt&&(bt.mediaType=kt),(0,ct.Ym)(Mt,"object")&&(bt.descriptor={},(0,ct.Ym)(Mt,"mode","string")&&(bt.descriptor.mode=Mt.mode),(0,ct.Ym)(Mt,"labelEnabled","boolean")&&(bt.descriptor.labelEnabled=Mt.labelEnabled),bt.descriptor.labelEnabled===!0&&(0,ct.Ym)(Mt,"labels","array")&&(bt.descriptor.labels=Mt.labels)),this.eventDispatchMgr("MCURecordingStopped",bt)},this.createStopRecordEvent=function(){var st={eventType:"stopRecord",time:new Date};this.eventDispatchMgr("stopRecord",st)},this.createMCUStreamingStartedEvent=function(st,ft,at,ht){var mt={eventType:"MCUStreamingStarted",time:new Date,roomName:st,callId:ft,clientId:at,streamingStartTime:ht};this.eventDispatchMgr("MCUStreamingStarted",mt)},this.createMCUStreamingStoppedEvent=function(st,ft,at,ht){var mt={eventType:"MCUStreamingStopped",time:new Date,roomName:st,callId:ft,clientId:at,streamingEndTime:ht};this.eventDispatchMgr("MCUStreamingStopped",mt)},this.createMCURoomModeChangedEvent=function(st,ft,at,ht){var mt={eventType:"MCURoomModeChanged",time:new Date,roomId:st,oldMode:ft,newMode:at,state:ht};this.eventDispatchMgr("MCURoomModeChanged",mt)},this.createSnapShotPhotoUploaded=function(st){var ft={eventType:"snapShotPhotoUploaded",time:new Date,fileName:st};this.eventDispatchMgr("snapShotPhotoUploaded",ft)},this.createRoomCreationEvent=function(st,ft,at){var ht={eventType:"roomCreation",time:new Date,status:st,roomId:ft,roomType:at};this.eventDispatchMgr("roomCreation",ht)},this.createRoomJoinedEvent=function(st,ft,at){var ht={eventType:"roomJoined",time:new Date,status:st,roomId:ft,roomType:at};this.eventDispatchMgr("roomJoined",ht)},this.createRoomInvitationEvent=function(st,ft,at,ht,mt,St){var It=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{},xt="roomInvitation",At={eventType:"roomInvitation",time:new Date,roomId:st,contactList:mt,senderId:ft,senderNickname:at,senderPhotoURL:ht,roomType:St};It.cloudConvId&&(At.cloudConvId=It.cloudConvId),It.webconf===!0&&(At.webconf=!0),this.eventDispatchMgr(xt,At)},this.createRoomMemberUpdateEvent=function(st,ft,at,ht){var mt={eventType:"roomMemberUpdate",time:new Date,roomId:st,contactList:ft,status:at,roomType:ht};this.eventDispatchMgr("roomMemberUpdate",mt)},this.createContactListInRoomEvent=function(st,ft,at){var ht={eventType:"contactListInRoom",time:new Date,roomId:st,contactList:ft,roomType:at};this.eventDispatchMgr("contactListInRoom",ht)},this.createReceiveRoomMessageEvent=function(st,ft,at,ht,mt){var St={eventType:"receiveRoomMessage",time:new Date,roomId:st,senderId:ft,senderNickname:at,message:ht,roomType:mt};this.eventDispatchMgr("receiveRoomMessage",St)},this.createDesktopCaptureEvent=function(st,ft,at){var ht={eventType:"desktopCapture",time:new Date,event:st,callId:ft,remoteId:at};this.eventDispatchMgr("desktopCapture",ht)},this.createMediaDeviceChangedEvent=function(st,ft,at){var ht="NotDefined";ft!=null&&(ht=ft);var mt={eventType:"mediaDeviceChanged",time:new Date,diff:st,updateReason:ht,firstMediaDeviceListInitialization:at};this.eventDispatchMgr("mediaDeviceChanged",mt)},this.createSwitchStreamEvent=function(st,ft){var at={eventType:"switchStream",time:new Date,callId:st,stream:ft};this.eventDispatchMgr("switchStream",at)},this.createConnectedUsersListUpdateEvent=function(st,ft,at,ht){var mt={eventType:"ConnectedUsersListUpdate",time:new Date,group:st,usersList:ft,status:at,updateReason:ht};this.eventDispatchMgr("connectedUsersListUpdate",mt)},this.createClosingWhiteBoardEvent=function(st,ft){var at={eventType:"closingWhiteBoard",time:new Date,roomId:st,reason:ft};this.eventDispatchMgr("closingWhiteBoard",at)},this.createExternalJsLoadingStatusEvent=function(st,ft){var at={eventType:"externalJsLoadingStatus",extjs:st,status:ft,time:new Date};this.eventDispatchMgr("externalJsLoadingStatus",at)},this.createBackgroundSubstractionStopVisibilityChangeEvent=function(st){var ft={userMediaStreamId:st};this.eventDispatchMgr("backgroundSubstractionStopVisibilityChange",ft)},this.createBackgroundSubstractionStopComputeTimeEvent=function(st){var ft={userMediaStreamId:st};this.eventDispatchMgr("backgroundSubstractionStopComputeTime",ft)},this.createAIESnapshotEvent=function(st,ft){var at={userMediaStreamId:st,image:ft};this.eventDispatchMgr("AIESnapshot",at)},this.createAIELogEvent=function(st,ft){var at={userMediaStreamId:st,log:ft};this.eventDispatchMgr("AIELog",at)},this.createEvent=function(st){if(!st.eventType)throw new Error("The event json must have an eventType"+st);st.time=new Date,this.eventDispatchMgr(st.eventType,st)}}},940:(it,ut,s)=>{s.d(ut,{S:()=>yt}),s(2772);var tt=s(1549),ot=s(5945),ct=tt.Y.get("WebRTC_Stack"),yt=function(pt){this.sendInvite=function(gt,st,ft,at,ht,mt){var St=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{};ct.debug("WebRTC_Stack::sendInvite()"),mt||(mt="media");var It={type:"invite",callId:gt,callerId:st,callerNickname:ft,calleeId:at,roomId:ht,callType:mt};St.mode&&(It.mode=St.mode);var xt=St.offer;if(xt){if(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11){var At=xt.type,Nt=xt.sdp;ct.log("JSON.stringify(type):",JSON.stringify(At)),ct.log("JSON.stringify(sdp):",JSON.stringify(Nt)),xt={type:At,sdp:Nt}}It.sdpoffer=xt}St.data&&(It.data=St.data),St.stream&&(It.stream=St.stream);var kt=JSON.stringify(It);ct.info("C->S:",kt),pt.emit("invite",kt)},this.sendInviteBroadcast=function(gt,st,ft,at,ht,mt){var St,It;ct.debug("WebRTC_Stack::sendInviteBroadcast()"),St={type:"invite",callId:gt,callerId:st,callerNickname:ft,calleeId:at,roomId:ht,sdpoffer:mt},It=JSON.stringify(St),ct.debug("C->S: "+It),pt.emit("invite_broadcast",It)},this.send200OK=function(gt,st,ft,at,ht,mt,St){ct.debug("WebRTC_Stack::send200OK()");var It,xt,At=null;(ot.Xh==="IE"||ot.Xh==="Safari"&&ot.PR<11)&&(ct.log("JSON.stringify(offer.sdp) :"+JSON.stringify(mt.sdp)),ct.log("JSON.stringify(offer.type) :"+JSON.stringify(mt.type)),(At={}).sdp=mt.sdp,At.type=mt.type,mt=At),It={type:"200OK",callId:gt,callerId:st,calleeId:ft,calleeNickname:at,roomId:ht,sdpanswer:mt,data:St},xt=JSON.stringify(It),ct.info("C->S: "+xt),pt.emit("200OK",xt)},this.sendCandidate=function(gt,st,ft,at,ht,mt,St,It,xt,At){ct.debug("WebRTC_Stack::sendCandidate()");var Nt=null,kt={};ct.debug("completeCandidate :",At),ot.Xh==="IE"?(ct.log("Browser is IE, adapting completeCandidate"),kt.sdpMLineIndex=At.sdpMLineIndex,kt.candidate=At.candidate,kt.sdpMid=At.sdpMid):kt=At,xt!==null?(ct.log("call data is defined :",xt),Nt={type:"candidate",callId:gt,callerId:st,calleeId:ft,roomId:at,dst:ht,label:mt,id:St,candidate:It,data:xt,completeCandidate:kt}):(ct.log("call data is undefined"),Nt={type:"candidate",callId:gt,callerId:st,calleeId:ft,roomId:at,dst:ht,label:mt,id:St,candidate:It,completeCandidate:kt});var Mt=JSON.stringify(Nt);ct.info("C->S:",Mt),pt.emit("candidate",Mt)},this.sendBye=function(gt,st,ft,at,ht,mt){ct.debug("WebRTC_Stack::sendBye()");var St,It=null;mt!==null?(ct.log("call data is defined :"+mt),It={type:"bye",callId:gt,clientId:st,roomId:ft,dst:at,reason:ht,data:mt}):(ct.log("call data is undefined"),It={type:"bye",callId:gt,clientId:st,roomId:ft,dst:at,reason:ht}),St=JSON.stringify(It),ct.info("C->S: "+St),pt.emit("bye",St)},this.sendUpdate=function(gt,st,ft,at,ht,mt,St,It){ct.debug("WebRTC_Stack::sendUpdate()");var xt,At=null;At={type:"update",callId:gt,callerId:st,calleeId:ft,roomId:at,dst:ht,sdpoffer:mt,callType:St},It!=null&&(ct.log("call data is defined: "+It),At.data=It),xt=JSON.stringify(At),ct.info("C->S: "+xt),pt.emit("update",xt)},this.send200Update=function(gt,st,ft,at,ht,mt,St){ct.debug("WebRTC_Stack::send200Update()");var It,xt=null;St!==null?(ct.log("call data is defined :"+St),xt={type:"200update",callId:gt,callerId:st,calleeId:ft,roomId:at,dst:ht,sdpanswer:mt,data:St}):(ct.log("call data is undefined"),xt={type:"200update",callId:gt,callerId:st,calleeId:ft,roomId:at,dst:ht,sdpanswer:mt}),It=JSON.stringify(xt),ct.info("C->S: "+It),pt.emit("200update",It)},this.sendDebugCommand=function(gt,st,ft){var at,ht;ct.debug("WebRTC_Stack::sendDebugCommand :"+gt),at={type:"debugCommand",command:gt,apiKey:st,clientId:ft},ht=JSON.stringify(at),ct.info("C->S: "+ht),pt.emit("debugCommand",ht)},this.sendAck=function(gt,st,ft){var at,ht;ct.debug("WebRTC_Stack::sendAck()"),at={type:"Ack",AckMessageType:gt,cSeq:st,dst:ft},ht=JSON.stringify(at),ct.info("C->S: "+ht),pt.emit("Ack",ht)},this.sendInfo=function(gt,st){var ft,at,ht=["activeSpeaker","callStats","stopSpeaking"];ht.indexOf(gt)<0&&ct.debug("WebRTC_Stack::sendInfo()"),ft={type:"info",infoType:gt,data:st},at=JSON.stringify(ft),ht.indexOf(gt)<0&&ct.info("C->S: "+at),pt.emit("info",at)},this.sendDataMessage=function(gt,st){ct.debug("WebRTC_Stack::sendDataMessage()");var ft={type:"apiRTCDataMessage",senderId:gt,data:st},at=JSON.stringify(ft);ct.info("C->S: "+at),pt.emit("apiRTCDataMessage",at)}}},4170:(it,ut,s)=>{s.r(ut),s(4916),s(4723),s(3710),s(1539),s(9714),s(561),function(tt){var ot,ct,yt=null,pt=null,gt=[];function st(){return Math.random().toString(36).substr(2)}ot=function(){if(typeof apiRTC_React<"u")return"react-native";var ft,at=navigator.appName,ht=navigator.userAgent,mt=ht.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);return mt&&(ft=ht.match(/version\/([\.\d]+)/i))!==null&&(mt[2]=ft[1]),(mt=mt?[mt[1],mt[2]]:[at,navigator.appVersion,"-?"])[0]}(),ct=function(){if(typeof apiRTC_React<"u")return 1;var ft,at=navigator.appName,ht=navigator.userAgent,mt=ht.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);return mt&&(ft=ht.match(/version\/([\.\d]+)/i))!==null&&(mt[2]=ft[1]),(mt=mt?[mt[1],mt[2]]:[at,navigator.appVersion,"-?"])[1]}(),pt=new function(){(ot==="MSIE"&&ct>8||ot==="Netscape")&&function(){function ft(at,ht){ht=ht||{bubbles:!1,cancelable:!1,detail:void 0};var mt=document.createEvent("CustomEvent");return mt.initCustomEvent(at,ht.bubbles,ht.cancelable,ht.detail),mt}ft.prototype=tt.CustomEvent.prototype,tt.CustomEvent=ft}(),this.eventDispatchMgr=function(ft,at){if(typeof apiRTC_React<"u"){var ht={type:ft,detail:at};eventManager.dispatchEvent(ht)}else if(ot==="MSIE"&&ct<=8)typeof $jqApz<"u"?$jqApz.event.trigger({type:ft,detail:at}):typeof jQuery<"u"&&jQuery.event.trigger({type:ft,detail:at});else{var mt=new CustomEvent(ft,{detail:at,bubbles:!0,cancelable:!0});document.dispatchEvent(mt)}},this.createGetUserFromIdAnswerEvent=function(ft){var at={eventType:"getUserFromIdAnswer",time:new Date,message:ft};this.eventDispatchMgr("getUserFromIdAnswer",at)},this.createGetAllUsersAnswerEvent=function(ft){var at={eventType:"getAllUsersAnswer",time:new Date,message:ft};this.eventDispatchMgr("getAllUsersAnswer",at)},this.createErrorEvent=function(ft){var at={eventType:"error :",time:new Date,errorInfo:ft};this.eventDispatchMgr("error",at)},this.createSearchUserAnswerEvent=function(ft,at,ht){var mt={eventType:"searchUserAnswer :",time:new Date,searchStr:ft,searchAnswerList:at,group:ht};this.eventDispatchMgr("searchUserAnswer",mt)}},(yt={version:"1.0.4",description:"ApiRTC DataBase Library"}).init=function(ft){this.socket=ft,this.socket.on("getUserFromIdAnswer",this.callback(this,"onGetUserFromIdAnswer")).on("getAllUsersAnswer",this.callback(this,"onGetAllUsersAnswer")).on("searchUserAnswer",this.callback(this,"onSearchUserAnswer"))},yt.createUser=function(ft){if(ft!==null&&ft.mail!==null&&ft.id!==null){var at=JSON.stringify(ft);this.socket.emit("createUser",at)}},yt.searchUserInGroup=function(ft,at,ht,mt){var St=null,It=null,xt=st();(at===void 0||at!=="all"&&at!=="connected"&&at!=="disconnected")&&(at="all"),ft!==null&&(St={searchStr:ft,presenceState:at,group:ht},mt!==void 0&&(St.callbackId=xt,gt[xt]=mt),It=JSON.stringify(St),this.socket.emit("searchUser",It))},yt.searchUser=function(ft,at,ht,mt){var St=null;typeof ht=="function"?(St=ht,yt.searchUserInGroup(ft,at,void 0,St)):yt.searchUserInGroup(ft,at,ht,mt)},yt.onSearchUserAnswer=function(ft){var at=JSON.parse(ft);at.callbackId!==void 0&&at.callbackId in gt?(gt[at.callbackId](at.searchStr,at.searchAnswerList),gt.splice(at.callbackId,1)):pt.createSearchUserAnswerEvent(at.searchStr,at.searchAnswerList,at.group)},yt.getUserFromId=function(ft,at){var ht=null,mt=null,St=st();ft!==null&&(ht={id:ft},at!==void 0&&(ht.callbackId=St,gt[St]=at),mt=JSON.stringify(ht),this.socket.emit("getUserFromId",mt))},yt.onGetUserFromIdAnswer=function(ft){ft!==null&&ft.callbackId!==void 0&&ft.callbackId in gt?(gt[ft.callbackId](ft),gt.splice(ft.callbackId,1)):pt.createGetUserFromIdAnswerEvent(ft)},yt.getAllUsers=function(){var ft,at;ft={},at=JSON.stringify(ft),this.socket.emit("getAllUsers",at)},yt.onGetAllUsersAnswer=function(ft){pt.createGetAllUsersAnswerEvent(ft)},yt.setPresenceStatus=function(ft,at,ht){var mt,St;mt={id:ft,presenceStatus:at,commentStatus:ht},St=JSON.stringify(mt),this.socket.emit("setPresenceStatus",St)},yt.setUserStatus=function(ft,at){var ht;at.id=ft,ht=JSON.stringify(at),this.socket.emit("setUserStatus",ht)},yt.setUserInfos=function(ft){var at,ht;at=ft,ht=JSON.stringify(at),this.socket.emit("setUserInfos",ht)},yt.addEventListener=function(ft,at){typeof apiRTC_React<"u"?eventManager.addEventListener(ft,at):ft!=="getUserFromIdAnswer"||ft!=="error"||ft!=="getAllUsersAnswer"||ft!=="searchUserAnswer"?document.addEventListener(ft,at,!1):pt.createErrorEvent("ERROR: Trying to add a listener on an unknow event")},yt.callback=function(ft,at){return this.closureHandler=function(ht){return ft[at](ht)},this.closureHandler},tt.apiDB=yt}(window)},2746:(it,ut,s)=>{s.r(ut);var tt=s(1549).Y.get("onbeforeunload");apiCC.beforeUnloadFct=function(ot){tt.debug("User has refreshed or left the page, eventType :",ot);try{if(typeof mailClicked<"u"&&mailClicked!==null&&(tt.log("mailClicked variable is defined"),mailClicked===!0))return tt.log("mailClicked is true : leaving onbeforeunload"),void(mailClicked=!1)}catch(yt){tt.log("Catch error on PATCH/WORKAROUND to avoid reload of page in chrome when mailto :"+yt)}try{if(apiCC.iePluginInstallationPreventUnload!==void 0&&apiCC.iePluginInstallationPreventUnload!==null&&apiCC.iePluginInstallationPreventUnload===!0)return void tt.log("iePluginInstallationPreventUnload is true : leaving onbeforeunload")}catch(yt){tt.log("Catch error on PATCH/WORKAROUND to avoid reload of page in IE when installing webRTC plugin :"+yt)}if(apiCC!=null){if(apiRTC.session!==null&&apiRTC.session.remoteAccessInvitation!==null){var ct;ct=apiRTC.session.remoteAccessInvitation.invitationType==="sent"?{code:"AGENT_LEFT"}:{code:"USER_LEFT"},tt.debug("Stopping remote access on refresh"),apiRTC.session.remoteAccessInvitation.stop(!0,ct)}apiCC.storeSessionInfoInSessionStorage(),apiCC.cleanApiRTCContext(),apiCC.disconnect({invalidateApiCCId:!0}),apiCC.cleanAllEventListener(),apiCC.myEventTable=[]}apiCC!=null&&(apiCC.session=null,apiCC.jsLoaded=!1)},apiRTC.browser==="Mobile Safari"?window.addEventListener("pagehide",function(){apiCC.beforeUnloadFct("unload_MobileSafari")}):window.onbeforeunload=function(){apiCC.beforeUnloadFct("unload")}},9064:(it,ut,s)=>{function tt(ot){return tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ct){return typeof ct}:function(ct){return ct&&typeof Symbol=="function"&&ct.constructor===Symbol&&ct!==Symbol.prototype?"symbol":typeof ct},tt(ot)}s(2222),s(2772),s(4916),s(3123),s(5306),s(2526),s(1817),s(1539),s(2165),s(6992),s(8783),s(3948),it=s.hmd(it),function(ot){var ct="function",yt="undefined",pt="object",gt="string",st="model",ft="name",at="type",ht="vendor",mt="version",St="architecture",It="console",xt="mobile",At="tablet",Nt="smarttv",kt="wearable",Mt="embedded",bt="Amazon",Bt="Apple",Ht="ASUS",Wt="BlackBerry",nn="Google",gn="Huawei",tn="LG",Gt="Microsoft",fn="Motorola",Cn="Samsung",Tn="Sharp",dn="Sony",mn="Xiaomi",yn="Zebra",pn="Facebook",In="Chromium OS",On="Mac OS",_n=function(Hn){for(var Qn={},or=0;or<Hn.length;or++)Qn[Hn[or].toUpperCase()]=Hn[or];return Qn},Mn=function(Hn,Qn){return tt(Hn)===gt&&Nn(Qn).indexOf(Nn(Hn))!==-1},Nn=function(Hn){return Hn.toLowerCase()},wn=function(Hn,Qn){if(tt(Hn)===gt)return Hn=Hn.replace(/^\s\s*/,""),tt(Qn)===yt?Hn:Hn.substring(0,350)},Pn=function(Hn,Qn){for(var or,Wn,ir,nr,xn,Un,vn=0;vn<Qn.length&&!xn;){var kn=Qn[vn],qt=Qn[vn+1];for(or=Wn=0;or<kn.length&&!xn&&kn[or];)if(xn=kn[or++].exec(Hn))for(ir=0;ir<qt.length;ir++)Un=xn[++Wn],tt(nr=qt[ir])===pt&&nr.length>0?nr.length===2?tt(nr[1])==ct?this[nr[0]]=nr[1].call(this,Un):this[nr[0]]=nr[1]:nr.length===3?tt(nr[1])!==ct||nr[1].exec&&nr[1].test?this[nr[0]]=Un?Un.replace(nr[1],nr[2]):void 0:this[nr[0]]=Un?nr[1].call(this,Un,nr[2]):void 0:nr.length===4&&(this[nr[0]]=Un?nr[3].call(this,Un.replace(nr[1],nr[2])):void 0):this[nr]=Un||void 0;vn+=2}},Fn=function(Hn,Qn){for(var or in Qn)if(tt(Qn[or])===pt&&Qn[or].length>0){for(var Wn=0;Wn<Qn[or].length;Wn++)if(Mn(Qn[or][Wn],Hn))return or==="?"?void 0:or}else if(Mn(Qn[or],Hn))return or==="?"?void 0:or;return Hn},ar={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Yn={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[mt,[ft,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[mt,[ft,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[ft,mt],[/opios[\/ ]+([\w\.]+)/i],[mt,[ft,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[mt,[ft,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[ft,mt],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[mt,[ft,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[mt,[ft,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[mt,[ft,"WeChat"]],[/konqueror\/([\w\.]+)/i],[mt,[ft,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[mt,[ft,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[mt,[ft,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[ft,/(.+)/,"$1 Secure Browser"],mt],[/\bfocus\/([\w\.]+)/i],[mt,[ft,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[mt,[ft,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[mt,[ft,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[mt,[ft,"Dolphin"]],[/coast\/([\w\.]+)/i],[mt,[ft,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[mt,[ft,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[mt,[ft,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[ft,"360 Browser"]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[ft,/(.+)/,"$1 Browser"],mt],[/(comodo_dragon)\/([\w\.]+)/i],[[ft,/_/g," "],mt],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[ft,mt],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[ft],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[ft,pn],mt],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[ft,mt],[/\bgsa\/([\w\.]+) .*safari\//i],[mt,[ft,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[mt,[ft,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[mt,[ft,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[ft,"Chrome WebView"],mt],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[mt,[ft,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[ft,mt],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[mt,[ft,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[mt,ft],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[ft,[mt,Fn,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[ft,mt],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[ft,"Netscape"],mt],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[mt,[ft,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[ft,mt],[/(cobalt)\/([\w\.]+)/i],[ft,[mt,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[St,"amd64"]],[/(ia32(?=;))/i],[[St,Nn]],[/((?:i[346]|x)86)[;\)]/i],[[St,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[St,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[St,"armhf"]],[/windows (ce|mobile); ppc;/i],[[St,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[St,/ower/,"",Nn]],[/(sun4\w)[;\)]/i],[[St,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[St,Nn]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[st,[ht,Cn],[at,At]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[st,[ht,Cn],[at,xt]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[st,[ht,Bt],[at,xt]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[st,[ht,Bt],[at,At]],[/(macintosh);/i],[st,[ht,Bt]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[st,[ht,Tn],[at,xt]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[st,[ht,gn],[at,At]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[st,[ht,gn],[at,xt]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[st,/_/g," "],[ht,mn],[at,xt]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[st,/_/g," "],[ht,mn],[at,At]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[st,[ht,"OPPO"],[at,xt]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[st,[ht,"Vivo"],[at,xt]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[st,[ht,"Realme"],[at,xt]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[st,[ht,fn],[at,xt]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[st,[ht,fn],[at,At]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[st,[ht,tn],[at,At]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[st,[ht,tn],[at,xt]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[st,[ht,"Lenovo"],[at,At]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[st,/_/g," "],[ht,"Nokia"],[at,xt]],[/(pixel c)\b/i],[st,[ht,nn],[at,At]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[st,[ht,nn],[at,xt]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[st,[ht,dn],[at,xt]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[st,"Xperia Tablet"],[ht,dn],[at,At]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[st,[ht,"OnePlus"],[at,xt]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[st,[ht,bt],[at,At]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[st,/(.+)/g,"Fire Phone $1"],[ht,bt],[at,xt]],[/(playbook);[-\w\),; ]+(rim)/i],[st,ht,[at,At]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[st,[ht,Wt],[at,xt]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[st,[ht,Ht],[at,At]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[st,[ht,Ht],[at,xt]],[/(nexus 9)/i],[st,[ht,"HTC"],[at,At]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[ht,[st,/_/g," "],[at,xt]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[st,[ht,"Acer"],[at,At]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[st,[ht,"Meizu"],[at,xt]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[ht,st,[at,xt]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[ht,st,[at,At]],[/(surface duo)/i],[st,[ht,Gt],[at,At]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[st,[ht,"Fairphone"],[at,xt]],[/(u304aa)/i],[st,[ht,"AT&T"],[at,xt]],[/\bsie-(\w*)/i],[st,[ht,"Siemens"],[at,xt]],[/\b(rct\w+) b/i],[st,[ht,"RCA"],[at,At]],[/\b(venue[\d ]{2,7}) b/i],[st,[ht,"Dell"],[at,At]],[/\b(q(?:mv|ta)\w+) b/i],[st,[ht,"Verizon"],[at,At]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[st,[ht,"Barnes & Noble"],[at,At]],[/\b(tm\d{3}\w+) b/i],[st,[ht,"NuVision"],[at,At]],[/\b(k88) b/i],[st,[ht,"ZTE"],[at,At]],[/\b(nx\d{3}j) b/i],[st,[ht,"ZTE"],[at,xt]],[/\b(gen\d{3}) b.+49h/i],[st,[ht,"Swiss"],[at,xt]],[/\b(zur\d{3}) b/i],[st,[ht,"Swiss"],[at,At]],[/\b((zeki)?tb.*\b) b/i],[st,[ht,"Zeki"],[at,At]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[ht,"Dragon Touch"],st,[at,At]],[/\b(ns-?\w{0,9}) b/i],[st,[ht,"Insignia"],[at,At]],[/\b((nxa|next)-?\w{0,9}) b/i],[st,[ht,"NextBook"],[at,At]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[ht,"Voice"],st,[at,xt]],[/\b(lvtel\-)?(v1[12]) b/i],[[ht,"LvTel"],st,[at,xt]],[/\b(ph-1) /i],[st,[ht,"Essential"],[at,xt]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[st,[ht,"Envizen"],[at,At]],[/\b(trio[-\w\. ]+) b/i],[st,[ht,"MachSpeed"],[at,At]],[/\btu_(1491) b/i],[st,[ht,"Rotor"],[at,At]],[/(shield[\w ]+) b/i],[st,[ht,"Nvidia"],[at,At]],[/(sprint) (\w+)/i],[ht,st,[at,xt]],[/(kin\.[onetw]{3})/i],[[st,/\./g," "],[ht,Gt],[at,xt]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[st,[ht,yn],[at,At]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[st,[ht,yn],[at,xt]],[/smart-tv.+(samsung)/i],[ht,[at,Nt]],[/hbbtv.+maple;(\d+)/i],[[st,/^/,"SmartTV"],[ht,Cn],[at,Nt]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[ht,tn],[at,Nt]],[/(apple) ?tv/i],[ht,[st,"Apple TV"],[at,Nt]],[/crkey/i],[[st,"Chromecast"],[ht,nn],[at,Nt]],[/droid.+aft(\w)( bui|\))/i],[st,[ht,bt],[at,Nt]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[st,[ht,Tn],[at,Nt]],[/(bravia[\w ]+)( bui|\))/i],[st,[ht,dn],[at,Nt]],[/(mitv-\w{5}) bui/i],[st,[ht,mn],[at,Nt]],[/Hbbtv.*(technisat) (.*);/i],[ht,st,[at,Nt]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[ht,wn],[st,wn],[at,Nt]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[at,Nt]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[ht,st,[at,It]],[/droid.+; (shield) bui/i],[st,[ht,"Nvidia"],[at,It]],[/(playstation [345portablevi]+)/i],[st,[ht,dn],[at,It]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[st,[ht,Gt],[at,It]],[/((pebble))app/i],[ht,st,[at,kt]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[st,[ht,Bt],[at,kt]],[/droid.+; (glass) \d/i],[st,[ht,nn],[at,kt]],[/droid.+; (wt63?0{2,3})\)/i],[st,[ht,yn],[at,kt]],[/(quest( 2| pro)?)/i],[st,[ht,pn],[at,kt]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[ht,[at,Mt]],[/(aeobc)\b/i],[st,[ht,bt],[at,Mt]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[st,[at,xt]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[st,[at,At]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[at,At]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[at,xt]],[/(android[-\w\. ]{0,9});.+buil/i],[st,[ht,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[mt,[ft,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[mt,[ft,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[ft,mt],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[mt,ft]],os:[[/microsoft (windows) (vista|xp)/i],[ft,mt],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[ft,[mt,Fn,ar]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[ft,"Windows"],[mt,Fn,ar]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[mt,/_/g,"."],[ft,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[ft,On],[mt,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[mt,ft],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[ft,mt],[/\(bb(10);/i],[mt,[ft,Wt]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[mt,[ft,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[mt,[ft,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[mt,[ft,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[mt,[ft,"watchOS"]],[/crkey\/([\d\.]+)/i],[mt,[ft,"Chromecast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[ft,In],mt],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[ft,mt],[/(sunos) ?([\w\.\d]*)/i],[[ft,"Solaris"],mt],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[ft,mt]]},Xn=function Hn(Qn,or){if(tt(Qn)===pt&&(or=Qn,Qn=void 0),!(this instanceof Hn))return new Hn(Qn,or).getResult();var Wn=tt(ot)!==yt&&ot.navigator?ot.navigator:void 0,ir=Qn||(Wn&&Wn.userAgent?Wn.userAgent:""),nr=Wn&&Wn.userAgentData?Wn.userAgentData:void 0,xn=or?function(vn,kn){var qt={};for(var Rt in vn)kn[Rt]&&kn[Rt].length%2==0?qt[Rt]=kn[Rt].concat(vn[Rt]):qt[Rt]=vn[Rt];return qt}(Yn,or):Yn,Un=Wn&&Wn.userAgent==ir;return this.getBrowser=function(){var vn,kn={name:void 0,version:void 0};return Pn.call(kn,ir,xn.browser),kn.major=tt(vn=kn.version)===gt?vn.replace(/[^\d\.]/g,"").split(".")[0]:void 0,Un&&Wn&&Wn.brave&&tt(Wn.brave.isBrave)==ct&&(kn.name="Brave"),kn},this.getCPU=function(){var vn={architecture:void 0};return Pn.call(vn,ir,xn.cpu),vn},this.getDevice=function(){var vn={vendor:void 0,model:void 0,type:void 0};return Pn.call(vn,ir,xn.device),Un&&!vn.type&&nr&&nr.mobile&&(vn.type=xt),Un&&vn.model=="Macintosh"&&Wn&&tt(Wn.standalone)!==yt&&Wn.maxTouchPoints&&Wn.maxTouchPoints>2&&(vn.model="iPad",vn.type=At),vn},this.getEngine=function(){var vn={name:void 0,version:void 0};return Pn.call(vn,ir,xn.engine),vn},this.getOS=function(){var vn={name:void 0,version:void 0};return Pn.call(vn,ir,xn.os),Un&&!vn.name&&nr&&nr.platform!="Unknown"&&(vn.name=nr.platform.replace(/chrome os/i,In).replace(/macos/i,On)),vn},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return ir},this.setUA=function(vn){return ir=tt(vn)===gt&&vn.length>350?wn(vn,350):vn,this},this.setUA(ir),this};Xn.VERSION="1.0.35",Xn.BROWSER=_n([ft,mt,"major"]),Xn.CPU=_n([St]),Xn.DEVICE=_n([st,ht,at,It,xt,Nt,At,kt,Mt]),Xn.ENGINE=Xn.OS=_n([ft,mt]),tt(o)!==yt?(tt(it)!==yt&&it.exports&&(o=it.exports=Xn),o.UAParser=Xn,ot.UAParser=Xn):tt(ot)!==yt&&(ot.UAParser=Xn);var tr=tt(ot)!==yt&&(ot.jQuery||ot.Zepto);if(tr&&!tr.ua){var cn=new Xn;tr.ua=cn.getResult(),tr.ua.get=function(){return cn.getUA()},tr.ua.set=function(Hn){cn.setUA(Hn);var Qn=cn.getResult();for(var or in Qn)tr.ua[or]=Qn[or]}}}((typeof window>"u"?"undefined":tt(window))==="object"?window:void 0)},1256:(it,ut,s)=>{s.r(ut),s.d(ut,{Call:()=>qr,CloudApi:()=>dp,Conference:()=>Ws,Contact:()=>No,Conversation:()=>jo,ConversationCall:()=>Kl,DataChannel:()=>Ss,Enterprise:()=>Qs,EventCenter:()=>Mt,EventEmitter:()=>pt,MediaDevice:()=>Ht,Observable:()=>fn,PointerSharingRoom:()=>iu,ReceivedCallInvitation:()=>Ir,ReceivedConversationInvitation:()=>jt,ReceivedConversationJoinRequest:()=>Ho,ReceivedDataChannelInvitation:()=>zo,ReceivedFileTransferInvitation:()=>eo,ReceivedInvitation:()=>kn,ReceivedPointerSharingInvitation:()=>_l,ReceivedWhiteboardInvitation:()=>Cs,SentInvitation:()=>Do,Session:()=>Br,Stream:()=>so,UserAgent:()=>lp,UserData:()=>Io,default:()=>km}),s(7941),s(2526),s(1817),s(1539),s(2165),s(6992),s(8783),s(3948);var tt=s(3173);function ot($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Xt=0,Ot=new Array(Lt);Xt<Lt;Xt++)Ot[Xt]=$t[Xt];return Ot}function ct($t){return ct=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},ct($t)}function yt($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}s(4603),s(4916),s(9714),s(7042),s(561),s(9070),s(8309),s(1038),s(9753);var pt=function(){function $t(){(function(Ot,Ft){if(!(Ot instanceof Ft))throw new TypeError("Cannot call a class as a function")})(this,$t)}var Lt,Xt;return Lt=$t,Xt=[{key:"getListeners",value:function(Ot){var Ft,sn,ln=this._getEvents();if(Ot instanceof RegExp)for(sn in Ft={},ln)ln.hasOwnProperty(sn)&&Ot.test(sn)&&(Ft[sn]=ln[sn]);else Ft=ln[Ot]||(ln[Ot]=[]);return Ft}},{key:"flattenListeners",value:function(Ot){var Ft,sn=[];for(Ft=0;Ft<Ot.length;Ft+=1)sn.push(Ot[Ft].listener);return sn}},{key:"getListenersAsObject",value:function(Ot){var Ft,sn=this.getListeners(Ot);return sn instanceof Array&&((Ft={})[Ot]=sn),Ft||sn}},{key:"emit",value:function(Ot){var Ft=Array.prototype.slice.call(arguments,1);return this.emitEvent(Ot,Ft)}},{key:"addListener",value:function(Ot,Ft){if(!at(Ft))throw new TypeError("listener must be a function");var sn,ln=this.getListenersAsObject(Ot),Jt=ct(Ft)==="object";for(sn in ln)ln.hasOwnProperty(sn)&&st(ln[sn],Ft)===-1&&ln[sn].push(Jt?Ft:{listener:Ft,once:!1});if(Ot==="contactListUpdate"){apiRTC.userAgentInstance.currentSession.contactListUpdateListenerSetted=!0;var dt,Ct=function(zt,Qt){var Zt=typeof Symbol<"u"&&zt[Symbol.iterator]||zt["@@iterator"];if(!Zt){if(Array.isArray(zt)||(Zt=function(dr,hr){if(dr){if(typeof dr=="string")return ot(dr,hr);var Ar=Object.prototype.toString.call(dr).slice(8,-1);return Ar==="Object"&&dr.constructor&&(Ar=dr.constructor.name),Ar==="Map"||Ar==="Set"?Array.from(dr):Ar==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ar)?ot(dr,hr):void 0}}(zt))||Qt&&zt&&typeof zt.length=="number"){Zt&&(zt=Zt);var on=0,bn=function(){};return{s:bn,n:function(){return on>=zt.length?{done:!0}:{done:!1,value:zt[on++]}},e:function(dr){throw dr},f:bn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Rn,qn=!0,Jn=!1;return{s:function(){Zt=Zt.call(zt)},n:function(){var dr=Zt.next();return qn=dr.done,dr},e:function(dr){Jn=!0,Rn=dr},f:function(){try{qn||Zt.return==null||Zt.return()}finally{if(Jn)throw Rn}}}}(apiRTC.userAgentInstance.currentSession.waitingContactListUpdateEvent);try{for(Ct.s();!(dt=Ct.n()).done;){var Ut=dt.value;this.emit("contactListUpdate",Ut)}}catch(zt){Ct.e(zt)}finally{Ct.f()}apiRTC.userAgentInstance.currentSession.waitingContactListUpdateEvent=[]}else if(Ot==="mediaDeviceChanged"&&apiRTC.mediaDeviceMgr.mediaDeviceChangedDetected===!0){var Vt=apiRTC.mediaDeviceMgr.getMediaDeviceListsDiff(apiRTC.mediaDeviceMgr.mediaDeviceSourceInfosArray,apiRTC.mediaDeviceMgr.mediaDeviceSourceInfosArrayBeforeGotSources);apiRTC.myWebRTC_Event.createMediaDeviceChangedEvent(Vt,"updatedOnDeviceChange",apiRTC.mediaDeviceMgr.realMediaDevicesListInitializationWasAlreadyDone)}return this}},{key:"addOnceListener",value:function(Ot,Ft){return this.addListener(Ot,{listener:Ft,once:!0})}},{key:"defineEvent",value:function(Ot){return this.getListeners(Ot),this}},{key:"defineEvents",value:function(Ot){for(var Ft=0;Ft<Ot.length;Ft+=1)this.defineEvent(Ot[Ft]);return this}},{key:"removeListener",value:function(Ot,Ft){var sn,ln,Jt=this.getListenersAsObject(Ot);for(ln in Jt)Jt.hasOwnProperty(ln)&&(sn=st(Jt[ln],Ft))!==-1&&Jt[ln].splice(sn,1);return this}},{key:"addListeners",value:function(Ot,Ft){return this.manipulateListeners(!1,Ot,Ft)}},{key:"removeListeners",value:function(Ot,Ft){return this.manipulateListeners(!0,Ot,Ft)}},{key:"manipulateListeners",value:function(Ot,Ft,sn){var ln,Jt,dt=Ot?this.removeListener:this.addListener,Ct=Ot?this.removeListeners:this.addListeners;if(ct(Ft)!=="object"||Ft instanceof RegExp)for(ln=sn.length;ln--;)dt.call(this,Ft,sn[ln]);else for(ln in Ft)Ft.hasOwnProperty(ln)&&(Jt=Ft[ln])&&(typeof Jt=="function"?dt.call(this,ln,Jt):Ct.call(this,ln,Jt));return this}},{key:"removeEvent",value:function(Ot){var Ft,sn=ct(Ot),ln=this._getEvents();if(sn==="string")delete ln[Ot];else if(Ot instanceof RegExp)for(Ft in ln)ln.hasOwnProperty(Ft)&&Ot.test(Ft)&&delete ln[Ft];else delete this._events;return this}},{key:"emitEvent",value:function(Ot,Ft){var sn,ln,Jt,dt,Ct=this.getListenersAsObject(Ot);for(dt in Ct)if(Ct.hasOwnProperty(dt))for(sn=Ct[dt].slice(0),Jt=0;Jt<sn.length;Jt++)(ln=sn[Jt]).once===!0&&this.removeListener(Ot,ln.listener),ln.listener.apply(this,Ft||[])===this._getOnceReturnValue()&&this.removeListener(Ot,ln.listener);return this}},{key:"setOnceReturnValue",value:function(Ot){return this._onceReturnValue=Ot,this}},{key:"_getOnceReturnValue",value:function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue}},{key:"_getEvents",value:function(){return this._events||(this._events={})}}],Xt&&yt(Lt.prototype,Xt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}(),gt=pt.prototype,st=function($t,Lt){for(var Xt=$t.length;Xt--;)if($t[Xt].listener===Lt)return Xt;return-1},ft=function($t){return function(){return this[$t].apply(this,arguments)}},at=function $t(Lt){return typeof Lt=="function"||Lt instanceof RegExp||!(!Lt||ct(Lt)!=="object")&&$t(Lt.listener)};gt.on=ft("addListener"),gt.once=ft("addOnceListener"),gt.off=ft("removeListener"),gt.removeAllListeners=ft("removeEvent"),gt.trigger=ft("emitEvent"),s(1249);var ht=s(5945),mt=s(1549),St=s(4708);mt.Y.get("ApiCC");var It={description:"ApiRTC Cloud Communication Library",session:null,jsLoaded:!1,initApiKey:null,initApiCCId:null,extJsLoadingRetryNb:null,extJsLoadingRetryDelay:null,bandwidthTestServer:"https://cloud.apizee.com",bandwidthRatingThresholds:[300,500,1e3,1500,2e3],LOG_LEVEL_OFF:0,LOG_LEVEL_ERROR:1,LOG_LEVEL_WARN:2,LOG_LEVEL_INFO:3,LOG_LEVEL_DEBUG:4,LOG_LEVEL_TRACE:5,browser:ht.Xh,browser_major_version:ht.PR,browser_version:ht.dc,osName:ht.BF,osVersion:ht.MM,osUAParser:ht.ag,browserInfo:ht.cf,browserDetails:St.wL,parser:ht.E2,logStorageActivated:!1,logStorageLevel:3,logStorage:[],eventCenter:null,sioEmbedded:!1,apizee_version:"5.0"};function xt($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}var At=mt.Y.get("EventCenter"),Nt="eventCenterData",kt="[REMOTE-EVENTCENTER]",Mt=function(){function $t(){var Ot=this;(function(Ft,sn){if(!(Ft instanceof sn))throw new TypeError("Cannot call a class as a function")})(this,$t),this.consoleOutputEnabled=!1,this.storageDisabled=!1,typeof apiRTC_React>"u"&&(document.addEventListener("error",function(Ft){Ot.handleErrorEvent(Ft)}),document.addEventListener("userMediaError",function(Ft){Ot.handleErrorEvent(Ft)}))}var Lt,Xt;return Lt=$t,Xt=[{key:"handleErrorEvent",value:function(Ot){var Ft=Ot.detail;if(this.storageDisabled!==!0)if(Ft!==void 0){var sn={},ln={},Jt="UNKNOWN";sn.type=Ot.type;for(var dt=0,Ct=Object.keys(Ft);dt<Ct.length;dt++){var Ut=Ct[dt];Ut!=="eventType"&&(sn[Ut]=Ft[Ut])}sn.systemInfo={apiRTC:It.version,app:ht.$6,device:ht.vO,osName:ht.BF,osVersion:ht.MM,browser:ht.Xh,browser_version:ht.dc},It.session!==null&&It.session!==void 0?Jt=It.session.apiCCId:It.initApiCCId!==null&&It.initApiCCId!==void 0&&(Jt=It.initApiCCId),sn.userInfo={apiCCId:Jt,apiKey:apiRTC.initApiKey};var Vt=localStorage.getItem(Nt);(Vt=Vt?JSON.parse(Vt):[]).unshift(sn),Vt.length>100&&Vt.splice(100,Vt.length-100),localStorage.setItem(Nt,JSON.stringify(Vt)),this.consoleOutputEnabled&&At.error("[EVENTCENTER]",sn),typeof Sentry<"u"&&(Ot.detail.errorCode!=="USER_MEDIA_ERROR"?(ln.type=Ot.type,Ot.detail.error&&(ln.error=Ot.detail.error),Ot.detail.errorInfo&&(ln.errorInfo=Ot.detail.errorInfo),Ot.detail.errorCode&&(ln.errorCode=Ot.detail.errorCode),Ot.detail.callId&&(ln.callId=Ot.detail.callId),Ot.detail.convId&&(ln.convId=Ot.detail.convId),Ot.detail.gumConfig&&(Ot.detail.gumConfig.video===!1?ln.gumConfigVideo=!1:ln.gumConfigVideo=!0),Sentry.withScope(function(zt){zt.setTag("event-center",!0),zt.setTag("userId",It.session.apiCCId),Sentry.captureException(new Error(JSON.stringify(ln)))})):At.debug("Filtering error event for USER_MEDIA_ERROR for Sentry"))}else At.error("Can't handle error event: data is undefined");else At.debug("Event Center is disabled")}},{key:"handleDataAnswer",value:function(Ot){Ot?Ot.map(function(Ft){At.debug(kt+": ",Ft)}):At.debug(kt+": "+this.getUsername()+" has no event records")}},{key:"getStoredData",value:function(){var Ot=localStorage.getItem(Nt);return Ot===void 0?(At.warn("No data was stored by event center"),null):JSON.parse(Ot)}},{key:"clearStoredData",value:function(){localStorage.removeItem(Nt)}},{key:"enableConsoleOutput",value:function(Ot){this.consoleOutputEnabled=Ot}},{key:"disableStorage",value:function(Ot){this.storageDisabled=Ot}}],Xt&&xt(Lt.prototype,Xt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function bt($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}s(3710);var Bt=mt.Y.get("MediaDevice"),Ht=function(){function $t(Ot,Ft,sn,ln){(function(Jt,dt){if(!(Jt instanceof dt))throw new TypeError("Cannot call a class as a function")})(this,$t),Bt.trace("Create "+Ft+" MediaDevice"),this.id=Ot,this.type=Ft,this.label=sn,this.capabilities=ln}var Lt,Xt;return Lt=$t,(Xt=[{key:"getId",value:function(){return this.id.toString()}},{key:"getType",value:function(){return this.type}},{key:"getLabel",value:function(){return this.label}},{key:"isCamera",value:function(){return this.type==="videoinput"}},{key:"isMicrophone",value:function(){return this.type==="audioinput"}},{key:"isAudioOutput",value:function(){return this.type==="audiooutput"}},{key:"getCapabilities",value:function(){return this.capabilities}}])&&bt(Lt.prototype,Xt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}(),Wt=(s(1532),s(4129),s(9653),s(4363),s(2772),s(9554),s(4747),s(8674),s(9575),s(2472),s(2990),s(8927),s(3105),s(5035),s(4345),s(7174),s(2846),s(4731),s(7209),s(6319),s(8867),s(7789),s(3739),s(9368),s(4483),s(2056),s(3462),s(678),s(7462),s(3824),s(5021),s(2974),s(5016),s(2707),s(2564),s(7327),s(9600),s(285),s(1637),s(2479),s(4812),s(2222),s(1058),s(6755),s(4986),s(8304),s(489),s(2419),s(8011),s(2443),s(3680),s(3706),s(2703),s(4819),s(5003),s(1215));function nn($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Xt=0,Ot=new Array(Lt);Xt<Lt;Xt++)Ot[Xt]=$t[Xt];return Ot}function gn($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}var tn=new WeakMap,Gt=new WeakMap,fn=function(){function $t(Ft){(function(sn,ln){if(!(sn instanceof ln))throw new TypeError("Cannot call a class as a function")})(this,$t),Gt.set(this,Ft),tn.set(this,new pt)}var Lt,Xt,Ot;return Lt=$t,Ot=[{key:"getAvailableEvents",value:function(){return[]}}],(Xt=[{key:"on",value:function(Ft,sn){return this.constructor.getAvailableEvents().indexOf(Ft)>-1?tn.get(this).on(Ft,sn):Gt.get(this).error("No such event "+Ft),this}},{key:"removeListener",value:function(Ft,sn){if(this.constructor.getAvailableEvents().indexOf(Ft)>-1){var ln,Jt=!1,dt=function(Ct,Ut){var Vt=typeof Symbol<"u"&&Ct[Symbol.iterator]||Ct["@@iterator"];if(!Vt){if(Array.isArray(Ct)||(Vt=function(Rn,qn){if(Rn){if(typeof Rn=="string")return nn(Rn,qn);var Jn=Object.prototype.toString.call(Rn).slice(8,-1);return Jn==="Object"&&Rn.constructor&&(Jn=Rn.constructor.name),Jn==="Map"||Jn==="Set"?Array.from(Rn):Jn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Jn)?nn(Rn,qn):void 0}}(Ct))||Ut&&Ct&&typeof Ct.length=="number"){Vt&&(Ct=Vt);var zt=0,Qt=function(){};return{s:Qt,n:function(){return zt>=Ct.length?{done:!0}:{done:!1,value:Ct[zt++]}},e:function(Rn){throw Rn},f:Qt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Zt,on=!0,bn=!1;return{s:function(){Vt=Vt.call(Ct)},n:function(){var Rn=Vt.next();return on=Rn.done,Rn},e:function(Rn){bn=!0,Zt=Rn},f:function(){try{on||Vt.return==null||Vt.return()}finally{if(bn)throw Zt}}}}(tn.get(this).getListeners(Ft));try{for(dt.s();!(ln=dt.n()).done;)if(ln.value.listener===sn){Jt=!0;break}}catch(Ct){dt.e(Ct)}finally{dt.f()}Jt?tn.get(this).off(Ft,sn):Gt.get(this).trace("removeListener() - No such listener for event "+Ft)}else Gt.get(this).error("No such event "+Ft);return this}}])&&gn(Lt.prototype,Xt),Ot&&gn(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function Cn($t,Lt){var Xt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Xt){if(Array.isArray($t)||(Xt=function(dt,Ct){if(dt){if(typeof dt=="string")return Tn(dt,Ct);var Ut=Object.prototype.toString.call(dt).slice(8,-1);return Ut==="Object"&&dt.constructor&&(Ut=dt.constructor.name),Ut==="Map"||Ut==="Set"?Array.from(dt):Ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ut)?Tn(dt,Ct):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Xt&&($t=Xt);var Ot=0,Ft=function(){};return{s:Ft,n:function(){return Ot>=$t.length?{done:!0}:{done:!1,value:$t[Ot++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Jt=!1;return{s:function(){Xt=Xt.call($t)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Jt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Jt)throw sn}}}}function Tn($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Xt=0,Ot=new Array(Lt);Xt<Lt;Xt++)Ot[Xt]=$t[Xt];return Ot}function dn($t){return dn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},dn($t)}function mn($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}s(6699),s(2023),s(3843);var yn=mt.Y.get("ApiRTCManager"),pn=["sessionReady","incomingCall","callEstablished","userMediaSuccess","userMediaStop","userMediaError","callRestarting","error","receiveIMMessage","updatePresence","webRTCClientCreated","updateUserStatus","channelEvent","groupChatCreation","groupChatInvitation","groupChatMemberUpdate","addUserInGroupChatAnswer","receiveGroupChatMessage","userDataAnswer","fetchUserDataAnswer","receiveConversationList","receiveConversationHistory","receiveConversationDetailReport","receiveContactOccurrencesFromConversationList","receiveMCUSessionInvitation","MCUSessionCreation","MCUAvailableStream","MCUAvailableStreamUpdate","MCURemoveStream","canPlayRemoteVideo","recordedFileAvailable","receiveData","roomCreation","roomJoined","roomInvitation","roomMemberUpdate","receiveRoomMessage","contactListInRoom","snapShotPhotoUploaded","stopRecord","callAttempt","joinMCUSessionAnswer","hangup","desktopCapture","remoteStreamAdded","remoteStreamRemoved","switchStream","sendDataChannelOpen","sendDataChannelClose","sendDataChannelError","receiveDataChannelOpen","receiveDataChannelClose","receiveDataChannelError","connectedUsersListUpdate","onFileSended","onFileSending","onFileReceiving","onFileReceived","onFileProgress","onFilePending","recordedStreamsAvailable","closingWhiteBoard","webRTCPluginInstallation","onQosStatsUpdate","onQosChange","onQosAudioChange","onQosVideoChange","MCURecordedStreamsAvailable","MCURecordingStarted","MCURecordingStopped","ICECandidateTypeUpdate","disconnectionWarning","MCUAvailableComposite","MCUParticipantEjected","MCUStreamingStarted","MCUStreamingStopped","MCUAvailableReplay","MCURoomModeChanged","onCallStatsUpdate","slowLink","localStreamUpdated","remoteStreamUpdated","audioAmplitude","videoQualityChanged","cpuLimited","bandwidthLimited","simulcastFeedChanged","cloudEventOccurred","groupUnsubscribed","transferBegun","transferProgress","transferEnded"],In=null,On=!1,_n=!1,Mn=function($t){if(In!==null&&In.isInitialized()){if($t==="groupUnsubscribed"||$t==="transferBegun"||$t==="transferProgress"||$t==="transferEnded")return;apiRTC.addEventListener($t,function(Lt){yn.trace("Emiting "+$t,Lt),In.eventEmitter.emit($t,Lt)})}},Nn=function($t){In!==null&&In.isInitialized()&&apiRTC.removeEventListener($t,function(Lt){yn.trace("Emiting "+$t,Lt),In.eventEmitter.emit($t,Lt)})},wn=function(){function $t(){if(function(Ft,sn){if(!(Ft instanceof sn))throw new TypeError("Cannot call a class as a function")}(this,$t),In!==null)throw"Cannot construct singleton ApiRTCManager";this.eventEmitter=new pt,this.apiRTCSession=null,this.whiteBoardClient=null,this.pointerSharingClient=null,this.webRTCClient=null,this.dataClient=null,this.IMClient=null,this.contactDisconnectionDelay=tt.g.CONTACT_DISCONNECTION_DELAY,In=this}var Lt,Xt,Ot;return Lt=$t,Xt=[{key:"onEvent",value:function(Ft,sn){return pn.indexOf(Ft)>-1?this.eventEmitter.on(Ft,sn):yn.error("No such apiRTC event "+Ft),this}},{key:"onceEvent",value:function(Ft,sn){pn.indexOf(Ft)>-1?this.eventEmitter.once(Ft,sn):yn.error("No such apiRTC event "+Ft)}},{key:"sendData",value:function(Ft,sn){var ln=this;return new Promise(function(Jt,dt){ln.dataClient===null?dt(tt.g.ERROR_APIRTC_INITIALISATION_FAILED):ln.dataClient.sendData(Ft,sn,function(Ct){var Ut=tt.g.ERROR_OTHER;Ct!=null?Ct.reason!=="timeoutReached"&&Ct.reason!=="destNotFound"?Jt():(Ct.reason==="timerReached"?Ut=tt.g.ERROR_TIMED_OUT:Ct.reason==="destNotFound"&&(Ut=tt.g.ERROR_NOT_FOUND),dt(Ut)):dt(Ut)})})}},{key:"sendMessage",value:function(Ft,sn){var ln=this,Jt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(dt,Ct){ln.IMClient===null?Ct(tt.g.ERROR_APIRTC_INITIALISATION_FAILED):ln.IMClient.sendMessage(Ft,sn,function(Ut){var Vt=tt.g.ERROR_OTHER;Ut!=null?Ut.reason!=="timeoutReached"&&Ut.reason!=="destNotFound"?dt(Ut.UUCSeq):(Ut.reason==="timerReached"?Vt=tt.g.ERROR_TIMED_OUT:Ut.reason==="destNotFound"&&(Vt=tt.g.ERROR_NOT_FOUND),Ct(Vt)):Ct(Vt)},Jt)})}},{key:"joinGroupChat",value:function(Ft){var sn=this;return new Promise(function(ln,Jt){if(sn.IMClient===null)return Jt(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"joinGroupChat() - cannot join group chat"));sn.IMClient.joinGroupChat(Ft),ln()})}},{key:"leaveGroupChat",value:function(Ft){var sn=this;return new Promise(function(ln,Jt){if(sn.IMClient===null)return Jt(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"leaveGroupChat() - cannot leave group chat"));sn.IMClient.leaveGroupChat(Ft),ln()})}},{key:"sendMessageToGroupChat",value:function(Ft,sn){var ln=this,Jt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(dt,Ct){if(ln.IMClient===null)Ct(tt.g.ERROR_APIRTC_INITIALISATION_FAILED);else{var Ut={};Wt.g.isTypeof(Jt,"metadata","object")&&(Ut.metadata=Jt.metadata),ln.IMClient.sendMessageToGroupChat(Ft,sn,function(Vt){return Vt!==null&&dn(Vt)==="object"?Vt.reason==="ack"?dt(Vt.UUCSeq):Vt.reason==="timeoutReached"?Ct(tt.g.ERROR_TIMED_OUT):Vt.reason==="destNotFound"?Ct(tt.g.ERROR_NOT_FOUND):Ct(tt.g.ERROR_OTHER):Ct(tt.g.ERROR_OTHER)},Ut)}})}},{key:"removeEventListener",value:function(Ft,sn){sn!=null&&(pn.indexOf(Ft)>-1?this.eventEmitter.off(Ft,sn):yn.error("No such apiRTC event "+Ft))}},{key:"isInitialized",value:function(){return On}},{key:"unsubscribeToPresenceGroup",value:function(Ft){this.apiRTCSession!==null?(this.apiRTCSession.unsubscribePresenceGroup([Ft]),In.eventEmitter.emit("groupUnsubscribed",Ft)):yn.error("apiRTC session is not initialized")}},{key:"joinAndSubscribeToPresenceGroup",value:function(Ft){this.apiRTCSession!==null?(this.apiRTCSession.joinPresenceGroup([Ft]),this.apiRTCSession.subscribePresenceGroup([Ft])):yn.error("apiRTC session is not initialized")}},{key:"leaveAndUnsubscribeToPresenceGroup",value:function(Ft){this.apiRTCSession!==null?(this.apiRTCSession.leavePresenceGroup([Ft]),this.unsubscribeToPresenceGroup(Ft)):yn.error("apiRTC session is not initialized")}},{key:"subscribeToCloudEvent",value:function(Ft,sn){this.apiRTCSession?this.apiRTCSession.subscribeToCloudEvent(Ft,sn):yn.error("apiRTC session is not initialized")}},{key:"unsubscribeToCloudEvent",value:function(Ft,sn){this.apiRTCSession?this.apiRTCSession.unsubscribeToCloudEvent(Ft,sn):yn.error("apiRTC session is not initialized")}},{key:"disconnect",value:function(){var Ft=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(apiRTC.disconnect(Ft),On=!1,this.apiRTCSession=null,this.webRTCClient=null,this.dataClient=null,this.IMClient=null,_n){var sn,ln=Cn(pn);try{for(ln.s();!(sn=ln.n()).done;){var Jt=sn.value;Nn(Jt)}}catch(dt){ln.e(dt)}finally{ln.f()}_n=!1}}},{key:"initializeApiRTC",value:function(Ft){return yn.info("initializeApiRTC()"),new Promise(function(sn,ln){if(Ft===void 0||Ft.apiKey===void 0)ln("Invalid apiRTC initialization params");else{var Jt=function(dt){switch(yn.debug("onChannelEventDuringInit()",dt.detail),dt.detail.channelEvent){case"onChannelError":ln("Channel Error : "+dt.detail.event);break;case"onChannelConnectError":ln("Channel Connect Error : "+dt.detail.event);break;case"onChannelOpened":yn.debug("onChannelOpened");break;default:yn.debug("Unhandle case in onChannelEventDuringInit :",dt.detail.channelEvent)}};apiRTC.addEventListener("channelEvent",Jt),Ft.onReady=function(){if(On=!0,In.webRTCClient=apiRTC.session.createWebRTCClient({}),In.webRTCClient.setMCUConnector(Ft.hasOwnProperty("mcu")?Ft.mcu:tt.g.DEFAULT_MCU),Wt.g.isPropertyTypeof(Ft,"turnServerAddress","string")&&In.webRTCClient.setClientTurnServer(Ft.turnServerAddress),In.webRTCClient.setUserAcceptOnIncomingCallBeforeGetUserMedia(!0),Wt.g.isPropertyTypeof(Ft,"userAcceptOnIncomingDataCall","boolean")?In.webRTCClient.setUserAcceptOnIncomingDataCall(Ft.userAcceptOnIncomingDataCall):In.webRTCClient.setUserAcceptOnIncomingDataCall(!0),Wt.g.isPropertyTypeof(Ft,"userAcceptOnIncomingScreenSharingCall","boolean")?In.webRTCClient.setUserAcceptOnIncomingScreenSharingCall(Ft.userAcceptOnIncomingScreenSharingCall):In.webRTCClient.setUserAcceptOnIncomingScreenSharingCall(!1),In.dataClient=apiRTC.session.createDataClient(),In.IMClient=apiRTC.session.createIMClient(),In.pointerSharingClient=apiRTC.session.createPointerSharingClient(),In.webRTCClient.setAllowMultipleCalls(!0),In.apiRTCSession=apiRTC.session,!_n){var dt,Ct=Cn(pn);try{for(Ct.s();!(dt=Ct.n()).done;){var Ut=dt.value;Mn(Ut)}}catch(Vt){Ct.e(Vt)}finally{Ct.f()}_n=!0}apiRTC.removeEventListener("channelEvent",Jt),sn(apiRTC.session.apiCCId)},On=!1,In.apiRTCSession=null,In.webRTCClient=null,In.dataClient=null,In.IMClient=null,apiRTC.init(Ft)}})}},{key:"createWhiteBoard",value:function(){yn.debug("createWhiteBoard()"),In.whiteBoardClient=apiRTC.createWhiteBoard(null,"invisible",null,6e4)}},{key:"getMediaDevices",value:function(){return yn.debug("ApiRTCManager::getMediaDevices()"),new Promise(function(Ft,sn){apiRTC.getMediaDevices().then(function(ln){yn.debug("ApiRTCManager::getMediaDevices(), sources :",ln),Ft(ln)}).catch(function(ln){var Jt="getMediaDevices() - error";yn.error(Jt,ln),sn(new Error(Jt))})})}},{key:"getUserMedia",value:function(Ft){return new Promise(function(sn,ln){apiRTC.getUserMedia(Ft).then(function(Jt){yn.debug("ApiRTCManager::getUserMedia() success"),sn(Jt)}).catch(function(Jt){yn.error("ApiRTCManager::getUserMedia() - Could not get user media :",Jt),ln(new Error("ApiRTCManager::getUserMedia() - Could not get user media :"+Jt))})})}},{key:"setAudioSourceIdInConstraint",value:function(Ft,sn){return apiRTC.setAudioSourceIdInConstraint(Ft,sn)}},{key:"setVideoSourceIdInConstraint",value:function(Ft,sn){return apiRTC.setVideoSourceIdInConstraint(Ft,sn)}},{key:"attachMediaStream",value:function(Ft,sn){apiRTC.attachMediaStream(Ft,sn)}},{key:"addStreamInDiv",value:function(Ft,sn,ln,Jt,dt,Ct,Ut){apiRTC.addStreamInDiv(Ft,sn,ln,Jt,dt,Ct,Ut)}},{key:"removeElementFromDiv",value:function(Ft,sn){yn.debug("removeElementFromDiv"),apiRTC.removeElementFromDiv(Ft,sn)}},{key:"getClientId",value:function(){return this.apiRTCSession!==null&&this.apiRTCSession.apiCCWebRTCClient!==null?this.apiRTCSession.apiCCWebRTCClient.webRTCClient.clientId:null}},{key:"getActiveApiKey",value:function(){return apiRTC.session!==void 0&&apiRTC.session!==null?apiRTC.session.apiKey:null}}],Ot=[{key:"get",value:function(){return In===null&&(In=new $t),In}}],Xt&&mn(Lt.prototype,Xt),Ot&&mn(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function Pn($t){return Pn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Pn($t)}function Fn($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function ar($t,Lt){return ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},ar($t,Lt)}function Yn($t,Lt){if(Lt&&(Pn(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xn($t)}function Xn($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function tr($t){return tr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},tr($t)}var cn=mt.Y.get("Invitation"),Hn=new WeakMap,Qn=["statusChange"],or=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&ar(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=tr(Ft);if(sn){var Ut=tr(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return Yn(this,dt)});function Jt(){var dt;return function(Ct,Ut){if(!(Ct instanceof Ut))throw new TypeError("Cannot call a class as a function")}(this,Jt),(dt=ln.call(this,cn)).id=null,Hn.set(Xn(dt),tt.g.INVITATION_STATUS_STANDBY),dt.apiRTCManager=wn.get(),dt.type="not_defined",dt}return Lt=Jt,Ot=[{key:"getAvailableEvents",value:function(){return Qn}}],(Xt=[{key:"setStatus",value:function(dt){Hn.set(this,dt),tn.get(this).emit("statusChange",{status:dt,id:this.id})}},{key:"getStatus",value:function(){return Hn.get(this)}}])&&Fn(Lt.prototype,Xt),Ot&&Fn(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(fn);function Wn($t){return Wn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Wn($t)}function ir($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function nr($t,Lt){return nr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},nr($t,Lt)}function xn($t,Lt){if(Lt&&(Wn(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}($t)}function Un($t){return Un=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Un($t)}mt.Y.get("ReceivedInvitation");var vn=["statusChange","messageDelivered","messageNotDelivered"],kn=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&nr(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=Un(Ft);if(sn){var Ut=Un(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return xn(this,dt)});function Jt(dt,Ct){var Ut;return function(Vt,zt){if(!(Vt instanceof zt))throw new TypeError("Cannot call a class as a function")}(this,Jt),(Ut=ln.call(this)).invitationType="received",Ut.id=Ct,Ut.sender=dt,Ut.receiveTime=Date.now(),Ut}return Lt=Jt,Ot=[{key:"getAvailableEvents",value:function(){return vn}}],(Xt=[{key:"accept",value:function(){return new Promise}},{key:"decline",value:function(dt){}},{key:"getSender",value:function(){return this.sender}},{key:"getReceiveTime",value:function(){return this.receiveTime}},{key:"getId",value:function(){return this.id}}])&&ir(Lt.prototype,Xt),Ot&&ir(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(or);function qt($t){return qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},qt($t)}function Rt($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function nt($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function vt($t,Lt){return vt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},vt($t,Lt)}function Tt($t,Lt){if(Lt&&(qt(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pt($t)}function Pt($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function wt($t){return wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},wt($t)}var Dt=mt.Y.get("ReceivedInvitation"),Et=new WeakMap,jt=function($t){(function(Jt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Jt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Jt,writable:!0,configurable:!0}}),Object.defineProperty(Jt,"prototype",{writable:!1}),dt&&vt(Jt,dt)})(ln,$t);var Lt,Xt,Ot,Ft,sn=(Ot=ln,Ft=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Jt,dt=wt(Ot);if(Ft){var Ct=wt(this).constructor;Jt=Reflect.construct(dt,arguments,Ct)}else Jt=dt.apply(this,arguments);return Tt(this,Jt)});function ln(Jt,dt,Ct){var Ut,Vt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Rt(this,ln),Ut=sn.call(this,Jt,dt.invitationId),Dt.info("Create ReceivedConversationInvitation"),Ut.conversation=Ct,Ut.type="conversation",Ut.invitationData=dt,Et.set(Pt(Ut),Vt),Ut}return Lt=ln,Xt=[{key:"accept",value:function(Jt){var dt=this,Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ut=function(){return new Promise(function(zt,Qt){var Zt=Et.get(dt);Ct.hasOwnProperty("password")&&(Zt.password=Ct.password),Ct.hasOwnProperty("session")&&(Zt.session=Ct.session),dt.conversation.join(Zt).then(function(){Jt!=null&&dt.conversation.publish(Jt),zt(dt.conversation)}).catch(function(on){Qt(Wt.g.createError(tt.g.ERROR_OTHER,"accept() - cannot join webconf",Dt,{fromError:on}))})})},Vt=function(){return new Promise(function(zt,Qt){dt.conversation.joinGroupChat().then(function(){zt(dt.conversation)}).catch(function(Zt){Qt(Wt.g.createError(tt.g.ERROR_OTHER,"accept() - cannot join groupChat",Dt,{fromError:Zt}))})})};return new Promise(function(zt,Qt){return dt.getStatus()!==tt.g.INVITATION_STATUS_STANDBY?Qt(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"accept() - cannot accept invitation",Dt)):(dt.setStatus(tt.g.INVITATION_STATUS_ACCEPTED),dt.apiRTCManager.sendData(dt.sender.getId(),{event:tt.g.INVITATION_ANSWER_IDENTIFIER,invitationId:dt.id,answer:"accept"}),dt.invitationData&&dt.invitationData.conversationTypes?dt.invitationData.conversationTypes.indexOf("WEBCONF")>=0?Ut().then(zt).catch(Qt):dt.invitationData.conversationTypes.indexOf("GROUP_CHAT")>=0?Vt().then(zt).catch(Qt):void 0:Ut().then(zt).catch(Qt))})}},{key:"decline",value:function(Jt){this.getStatus()===tt.g.INVITATION_STATUS_STANDBY&&(this.setStatus(tt.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:tt.g.INVITATION_ANSWER_IDENTIFIER,invitationId:this.id,reason:Jt,answer:"decline"}))}},{key:"getConversation",value:function(){return this.conversation}}],Xt&&nt(Lt.prototype,Xt),Object.defineProperty(Lt,"prototype",{writable:!1}),ln}(kn);function Yt($t){return Yt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Yt($t)}function en($t,Lt){var Xt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Xt){if(Array.isArray($t)||(Xt=function(dt,Ct){if(dt){if(typeof dt=="string")return Kt(dt,Ct);var Ut=Object.prototype.toString.call(dt).slice(8,-1);return Ut==="Object"&&dt.constructor&&(Ut=dt.constructor.name),Ut==="Map"||Ut==="Set"?Array.from(dt):Ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ut)?Kt(dt,Ct):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Xt&&($t=Xt);var Ot=0,Ft=function(){};return{s:Ft,n:function(){return Ot>=$t.length?{done:!0}:{done:!1,value:$t[Ot++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Jt=!1;return{s:function(){Xt=Xt.call($t)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Jt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Jt)throw sn}}}}function Kt($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Xt=0,Ot=new Array(Lt);Xt<Lt;Xt++)Ot[Xt]=$t[Xt];return Ot}function rn($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function hn($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function an($t,Lt){return an=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},an($t,Lt)}function un($t,Lt){if(Lt&&(Yt(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sn($t)}function Sn($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function En($t){return En=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},En($t)}s(189);var An=mt.Y.get("Call"),Dn=wn.get(),Bn=["streamAdded","streamRemoved","response","accepted","declined","hangup","localStreamAvailable","recordAvailable","statsUpdate","error","disconnectionWarning","userMediaError","desktopCapture","remoteStreamUpdated","recordingStarted","recordingStopped","recordingAvailable"],sr=new Set(["audioSent","videoSent","audioReceived","videoReceived","quality"]),fr=new WeakMap,Cr=new WeakMap,gr=new WeakMap,wr=new WeakMap,Nr=new WeakMap,qr=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&an(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=En(Ft);if(sn){var Ut=En(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return un(this,dt)});function Jt(dt,Ct){var Ut,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(rn(this,Jt),Ut=ln.call(this,An),An.debug("Create Call with id "+dt),fr.set(Sn(Ut),dt),Cr.set(Sn(Ut),Ct),Ut.publishedStreams=new Map,Ut.receivedStreams=new Map,Ut.stats={},gr.set(Sn(Ut),Vt.hasOwnProperty("started")&&Vt.started?tt.g.CALL_STATUS_ONGOING:tt.g.CALL_STATUS_WAITING_FOR_CALLEE),wr.set(Sn(Ut),!!Vt.hasOwnProperty("isRecorded")&&Vt.isRecorded),Vt.isRecorded){Ut.confId=null,Ut.recordingStatus=null;for(var zt=Dn.webRTCClient.webRTCClient.callsTable.length;--zt>=0;){var Qt=Dn.webRTCClient.webRTCClient.callsTable[zt];if(Qt.callId===dt&&Qt.data){Ut.confId=Qt.data.confId;break}}wr.set(Sn(Ut),!0)}else wr.set(Sn(Ut),!1);var Zt={hangup:function(bn){Ut.getId()===bn.detail.callId&&Ut.destroy()},receiveData:function(bn){bn.detail.data.info!==void 0&&bn.detail.data.info===tt.g.INVITATION_ANSWER_IDENTIFIER&&bn.detail.data.invitationId.toString()===Ut.getId()&&Ut.getStatus()===tt.g.CALL_STATUS_WAITING_FOR_CALLEE&&(An.info("Call answer from "+Ut.getContact().getUsername()+" for "+Ut.getId()),bn.detail.data.answer==="accept"?(gr.set(Sn(Ut),tt.g.CALL_STATUS_ONGOING),tn.get(Sn(Ut)).emit("accepted"),tn.get(Sn(Ut)).emit("response","accepted")):(gr.set(Sn(Ut),tt.g.CALL_STATUS_ENDED),tn.get(Sn(Ut)).emit("declined",{reason:"User_Refused_Call"}),tn.get(Sn(Ut)).emit("response","declined")))},remoteStreamUpdated:function(bn){if(Ut.getId()===bn.detail.callId){var Rn={callId:bn.detail.callId,audio:bn.detail.audioIsAvailable&&bn.detail.audioIsActive,audioMuted:bn.detail.audioIsMuted,audioSilent:bn.detail.audioIsSilent,video:bn.detail.videoIsAvailable&&bn.detail.videoIsActive,videoMuted:bn.detail.videoIsMuted,videoSilent:bn.detail.videoIsSilent};tn.get(Sn(Ut)).emit("remoteStreamUpdated",Rn)}},MCURecordingStarted:function(bn){if(wr.get(Sn(Ut))&&bn.detail.roomName===Ut.confId){var Rn=Wt.g.parseRecordingEvent("MCURecordingStarted",bn.detail);Rn.callId==="COMPOSITE"&&(Ut.recordingStatus=Rn,tn.get(Sn(Ut)).emit("recordingStarted",Rn))}},MCURecordingStopped:function(bn){if(wr.get(Sn(Ut))&&bn.detail.roomName===Ut.confId){var Rn=Wt.g.parseRecordingEvent("MCURecordingStopped",bn.detail);Rn.callId==="COMPOSITE"&&(delete Ut.recordingStatus,tn.get(Sn(Ut)).emit("recordingStopped",Rn))}},MCURecordedStreamsAvailable:function(bn){if(wr.get(Sn(Ut))&&bn.detail.roomName===Ut.confId){var Rn=Wt.g.parseRecordingEvent("MCURecordedStreamsAvailable",bn.detail);tn.get(Sn(Ut)).emit("recordingAvailable",Rn)}}};for(var on in Zt)Dn.onEvent(on,Zt[on]);return Nr.set(Sn(Ut),Zt),Ut}return Lt=Jt,Xt=[{key:"destroy",value:function(){var dt=Nr.get(this);if(dt){for(var Ct in dt)Dn.removeEventListener(Ct,dt[Ct]);Nr.delete(this)}}},{key:"getId",value:function(){return fr.get(this).toString()}},{key:"isRecorded",value:function(){return wr.get(this)}},{key:"getContact",value:function(){return Cr.get(this)}},{key:"getStatus",value:function(){return gr.get(this)}},{key:"setStatus",value:function(dt){gr.set(this,dt)}},{key:"getPublishedStreams",value:function(){var dt,Ct=[],Ut=en(this.publishedStreams.values());try{for(Ut.s();!(dt=Ut.n()).done;){var Vt=dt.value;Ct.push(Vt)}}catch(zt){Ut.e(zt)}finally{Ut.f()}return Ct}},{key:"getReceivedStreams",value:function(){var dt,Ct=[],Ut=en(this.receivedStreams.values());try{for(Ut.s();!(dt=Ut.n()).done;){var Vt=dt.value;Ct.push(Vt)}}catch(zt){Ut.e(zt)}finally{Ut.f()}return Ct}},{key:"hangUp",value:function(){this.getStatus()===tt.g.CALL_STATUS_ENDED?An.error("hangUp() - Call has already ended"):Dn.webRTCClient.hangUp(this.getId())}},{key:"getStats",value:function(){return Wt.g.assignObject({},this.stats)}},{key:"stopPublishedStreams",value:function(){return Dn.webRTCClient.webRTCClient.stopMedia(this.getId())}},{key:"replacePublishedStreams",value:function(dt,Ct){var Ut=this,Vt=function(zt){if(yo.has(zt))return yo.get(zt);var Qt=apiCC.getUserMediaStream(zt);if(Qt){var Zt="audio";return Qt.video===!0&&(Zt="video"),new so(Qt.stream,{type:Zt,constructor:!0,userMediaStreamId:Qt.userMediaStreamId})}return null};return new Promise(function(zt,Qt){if(Ut.getStatus()!==tt.g.CALL_STATUS_ONGOING)return Qt(new Error("replacePublishedStreams() - Cannot replace stream as call is not ongoing"));if(dt===null)if(Wt.g.isPropertyTypeof(Ct,"getStream","function")){var Zt={getUserMediaStreamId:function(){return Ct.getStream().then(function(on){return on.userMediaStreamId}).catch(Qt)}};Dn.webRTCClient.webRTCClient.addMedia(Ut.getId(),!0,null,Zt).then(function(on){return zt(Vt(on))}).catch(function(on){return Qt(new Error("replacePublishedStreams() - "+on))})}else Dn.webRTCClient.webRTCClient.addMedia(Ut.getId(),!0,null,null).then(function(on){return zt(Vt(on))}).catch(function(on){return Qt(new Error("replacePublishedStreams() - "+on))});else Dn.webRTCClient.webRTCClient.addMedia(Ut.getId(),!0,dt.userMediaStreamId).then(function(on){return zt(Vt(on))}).catch(function(on){return Qt(new Error("replacePublishedStreams() - "+on))})})}},{key:"getRecordingInfo",value:function(){return wr.get(this)?this.recordingStatus:null}},{key:"startRecording",value:function(){var dt=this;return new Promise(function(Ct,Ut){if(dt.asyncCallbacks)return Ut(Wt.g.createError(tt.g.ERROR_OTHER,"startRecording() - busy",An));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return dt.asyncCallbacks&&(Dn.removeEventListener("error",dt.asyncCallbacks.error),Dn.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),delete dt.asyncCallbacks),Ut(Wt.g.createError(tt.g.ERROR_OTHER,"startRecording() - timeout",An))},tt.g.CONVERSATION_RECORDING_STARTED_DELAY),dt.asyncCallbacks.error=function(Vt){if(dt.confId===Vt.detail.roomName&&Vt.detail.callId==="COMPOSITE"&&Vt.detail.errorCode.indexOf("START_RECORD")>=0)return dt.asyncCallbacks&&(Dn.removeEventListener("error",dt.asyncCallbacks.error),Dn.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Ut(Wt.g.createError(tt.g.ERROR_OTHER,"startRecording() - "+Vt.detail.errorInfo,An))},dt.asyncCallbacks.recordingStarted=function(Vt){if(dt.confId===Vt.detail.roomName&&Vt.detail.callId==="COMPOSITE"){dt.asyncCallbacks&&(Dn.removeEventListener("error",dt.asyncCallbacks.error),Dn.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks);var zt=Wt.g.parseRecordingEvent("MCURecordingStarted",Vt.detail);return Ct(zt)}},Dn.onEvent("error",dt.asyncCallbacks.error),Dn.onEvent("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),Dn.webRTCClient.startCallRecording(fr.get(dt))})}},{key:"stopRecording",value:function(){var dt=this;return new Promise(function(Ct,Ut){if(dt.asyncCallbacks)return Ut(Wt.g.createError(tt.g.ERROR_OTHER,"stopRecording() - busy",An));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return dt.asyncCallbacks&&(Dn.removeEventListener("error",dt.asyncCallbacks.error),Dn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),delete dt.asyncCallbacks),Ut(Wt.g.createError(tt.g.ERROR_OTHER,"stopRecording() - timeout",An))},tt.g.CONVERSATION_RECORDING_STOPPED_DELAY),dt.asyncCallbacks.error=function(Vt){if(dt.confId===Vt.detail.roomName&&Vt.detail.callId==="COMPOSITE"&&Vt.detail.errorCode.indexOf("STOP_RECORD")>=0)return dt.asyncCallbacks&&(Dn.removeEventListener("error",dt.asyncCallbacks.error),Dn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Ut(Wt.g.createError(tt.g.ERROR_OTHER,"stopRecording() - "+Vt.detail.errorInfo,An))},dt.asyncCallbacks.recordingStopped=function(Vt){if(dt.confId===Vt.detail.roomName&&Vt.detail.callId==="COMPOSITE"){dt.asyncCallbacks&&(Dn.removeEventListener("error",dt.asyncCallbacks.error),Dn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks);var zt=Wt.g.parseRecordingEvent("MCURecordingStopped",Vt.detail);return Ct(zt)}},Dn.onEvent("error",dt.asyncCallbacks.error),Dn.onEvent("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),Dn.webRTCClient.stopCallRecording(fr.get(dt))})}},{key:"manageCallEstablishedEvent",value:function(dt){An.debug("callEstablished",dt.detail,this.getId());var Ct=dt.detail.callId.toString();this.getId()===Ct&&(An.info("callEstablished from "+this.getContact().getUsername(),dt),this.getStatus()!==tt.g.CALL_STATUS_ONGOING&&this.getStatus()!==tt.g.CALL_STATUS_ENDED&&(tn.get(this).emit("accepted"),tn.get(this).emit("response","accepted"),gr.set(this,tt.g.CALL_STATUS_ONGOING)))}},{key:"manageRemoteStreamAddedEvent",value:function(dt){An.debug("remoteStreamAdded",dt.detail,this.getId());var Ct=dt.detail.callId.toString();if(this.getId()===Ct){var Ut=dt.detail.destCallType==="audio"?"audio":"video",Vt=dt.detail.callType==="screenSharing",zt=new so(dt.detail.stream,{screensharing:Vt,type:Ut,contact:this.getContact(),streamId:dt.detail.stream.id,callId:dt.detail.callId,callAudioAvailable:dt.detail.audioIsAvailable,callAudioActive:dt.detail.audioIsActive,callAudioMuted:dt.detail.audioIsMuted,callVideoAvailable:dt.detail.videoIsAvailable,callVideoActive:dt.detail.videoIsActive,callVideoMuted:dt.detail.videoIsMuted,constructor:!0});this.receivedStreams.set(dt.detail.stream.id,zt),tn.get(this).emit("streamAdded",zt)}}},{key:"manageRemoteStreamRemovedEvent",value:function(dt){An.debug("remoteStreamRemoved",dt.detail,this.getId());var Ct=dt.detail.callId.toString();if(this.getId()===Ct){var Ut=this.receivedStreams.get(dt.detail.stream.id);this.receivedStreams.delete(dt.detail.stream.id),tn.get(this).emit("streamRemoved",Ut)}}},{key:"manageUserMediaSuccessEvent",value:function(dt){An.debug("UserMediaSuccess",dt.detail,this.getId());var Ct,Ut=null;if(Ct=dt.detail.videoIsAvailable===!0?"video":"audio",dt.detail.callId!==null&&(Ut=dt.detail.callId.toString()),this.getId()===Ut){An.info("localStreamAvailable",dt.detail);var Vt=yo.get(dt.detail.userMediaStreamId);Vt||(Vt=new so(dt.detail.stream,{type:Ct,constructor:!0,userMediaStreamId:dt.detail.userMediaStreamId,callId:this.getId()})),this.publishedStreams.set(Wt.g.guid(),Vt),tn.get(this).emit("localStreamAvailable",Vt)}}},{key:"manageCallStatsUpdateEvent",value:function(dt){if(this.getId()===dt.detail.callId){for(var Ct=0,Ut=Object.keys(dt.detail.stats);Ct<Ut.length;Ct++){var Vt=Ut[Ct];sr.has(Vt)&&(this.stats[Vt]=dt.detail.stats[Vt])}tn.get(this).emit("statsUpdate",Wt.g.assignObject({},{stats:this.stats}))}}},{key:"manageErrorEvent",value:function(dt){if(An.debug("Error",dt.detail,this.getId()),this.getId()===dt.detail.callId){var Ct={errorCode:dt.detail.errorCode,errorInfo:dt.detail.errorInfo};dt.detail.data&&(Ct.descriptor=dt.detail.data),tn.get(this).emit("error",Ct)}}},{key:"manageDisconnectionWarningEvent",value:function(dt){An.debug("DisconnectionWarning",dt.detail,this.getId()),this.getId()===dt.detail.callId&&tn.get(this).emit("disconnectionWarning",{tries:dt.detail.tries})}},{key:"manageHangupEvent",value:function(dt){An.debug("hangup",dt.detail,this.getId());var Ct=dt.detail.callId.toString(),Ut=this.getStatus()===tt.g.CALL_STATUS_WAITING_FOR_CALLEE&&dt.detail.hangupType==="remote";if(this.getId()===Ct&&this.getStatus()!==tt.g.CALL_STATUS_ENDED){gr.set(this,tt.g.CALL_STATUS_ENDED),An.info("Hangup from "+this.getContact().getUsername(),dt);var Vt,zt=en(this.receivedStreams.keys());try{for(zt.s();!(Vt=zt.n()).done;){var Qt=Vt.value,Zt=this.receivedStreams.get(Qt);this.receivedStreams.delete(Qt),tn.get(this).emit("streamRemoved",Zt)}}catch(on){zt.e(on)}finally{zt.f()}tn.get(this).emit("hangup",{from:dt.detail.hangupType,reason:dt.detail.reason}),Ut&&(tn.get(this).emit("declined",{reason:dt.detail.reason}),tn.get(this).emit("response","declined"))}}},{key:"manageRecordAvailableEvent",value:function(dt){An.warn("recordedStreamsAvailable",dt.detail,this.getId()),tn.get(this).emit("recordAvailable",{mediaURL:dt.detail.mediaURL})}},{key:"manageUserMediaErrorEvent",value:function(dt){An.warn("userMediaError",dt.detail,this.getId()),tn.get(this).emit("userMediaError",{callType:dt.detail.callType,error:dt.detail.error,onCallEstablishment:dt.detail.onCallEstablishment,userMediaStreamId:dt.detail.userMediaStreamId,tryAudioCallActivated:dt.detail.tryAudioCallActivated})}},{key:"manageDesktopCaptureEvent",value:function(dt){An.warn("desktopCapture",dt.detail,this.getId()),tn.get(this).emit("desktopCapture",{event:dt.detail.event})}}],Ot=[{key:"getAvailableEvents",value:function(){return Bn}}],Xt&&hn(Lt.prototype,Xt),Ot&&hn(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(fn);function Qr($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Xt=0,Ot=new Array(Lt);Xt<Lt;Xt++)Ot[Xt]=$t[Xt];return Ot}function Sr($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}var Dr=mt.Y.get("ConversationCatalog"),Er=null,Or=function(){function $t(){if(function(Ft,sn){if(!(Ft instanceof sn))throw new TypeError("Cannot call a class as a function")}(this,$t),Er!==null)throw"Cannot construct singleton CallCatalog";this.callList=new Map,Er=this}var Lt,Xt,Ot;return Lt=$t,Ot=[{key:"get",value:function(){return Er===null&&(Er=new $t),Er}}],(Xt=[{key:"getOrCreateCall",value:function(Ft,sn,ln){var Jt=null;return Ft!=null&&(this.callList.has(Ft.toString())?Jt=this.callList.get(Ft.toString()):(Jt=new qr(Ft.toString(),sn,ln),this.callList.set(Ft.toString(),Jt))),Jt}},{key:"getCall",value:function(Ft,sn){var ln=null;if(Ft!=null){if(!this.callList.has(Ft.toString()))return null;ln=this.callList.get(Ft.toString())}else if(sn){var Jt,dt=function(Vt,zt){var Qt=typeof Symbol<"u"&&Vt[Symbol.iterator]||Vt["@@iterator"];if(!Qt){if(Array.isArray(Vt)||(Qt=function(Jn,dr){if(Jn){if(typeof Jn=="string")return Qr(Jn,dr);var hr=Object.prototype.toString.call(Jn).slice(8,-1);return hr==="Object"&&Jn.constructor&&(hr=Jn.constructor.name),hr==="Map"||hr==="Set"?Array.from(Jn):hr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(hr)?Qr(Jn,dr):void 0}}(Vt))||zt&&Vt&&typeof Vt.length=="number"){Qt&&(Vt=Qt);var Zt=0,on=function(){};return{s:on,n:function(){return Zt>=Vt.length?{done:!0}:{done:!1,value:Vt[Zt++]}},e:function(Jn){throw Jn},f:on}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var bn,Rn=!0,qn=!1;return{s:function(){Qt=Qt.call(Vt)},n:function(){var Jn=Qt.next();return Rn=Jn.done,Jn},e:function(Jn){qn=!0,bn=Jn},f:function(){try{Rn||Qt.return==null||Qt.return()}finally{if(qn)throw bn}}}}(this.callList.values());try{for(dt.s();!(Jt=dt.n()).done;){var Ct=Jt.value,Ut=Ct.getContact();if(Ut&&Ut.getId()===sn.getId()){ln=Ct;break}}}catch(Vt){dt.e(Vt)}finally{dt.f()}}return ln}},{key:"removeCallFromList",value:function(Ft){Dr.log("removeCallFromList : av instance.callList :",Er.callList),Er.callList.has(Ft)&&Er.callList.delete(Ft),Dr.log("removeCallFromList : ap instance.callList :",Er.callList)}},{key:"getCalls",value:function(){return this.callList}}])&&Sr(Lt.prototype,Xt),Ot&&Sr(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function Lr($t){return Lr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Lr($t)}function Hr($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function na($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function Vn($t,Lt){return Vn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},Vn($t,Lt)}function zn($t,Lt){if(Lt&&(Lr(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zn($t)}function Zn($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Rr($t){return Rr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Rr($t)}var Gn=mt.Y.get("ReceivedInvitation"),jr=Or.get(),xr=["expired","statusChange"],Ir=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&Vn(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=Rr(Ft);if(sn){var Ut=Rr(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return zn(this,dt)});function Jt(dt,Ct,Ut){var Vt,zt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Hr(this,Jt),Vt=ln.call(this,dt,Ct),Gn.info("Create ReceivedCallInvitation with call type "+Ut),Vt.type="call",Vt.callType=Ut,Vt.isRecordedCall=!!zt.hasOwnProperty("isRecorded")&&zt.isRecorded,Vt.call=jr.getOrCreateCall(Vt.id,Vt.sender,{isRecorded:Vt.isRecorded()}),Vt.apiRTCManager.onEvent("hangup",function(Qt){var Zt=Qt.detail.callId.toString();Vt.id.toString()===Zt&&Vt.getStatus()===tt.g.INVITATION_STATUS_STANDBY&&(Vt.setStatus(tt.g.INVITATION_STATUS_EXPIRED),tn.get(Zn(Vt)).emit("expired"))}),Vt}return Lt=Jt,Xt=[{key:"getCallType",value:function(){return this.callType}},{key:"isRecorded",value:function(){return this.isRecordedCall}},{key:"accept",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,zt){var Qt=Ct.getCallType()==="audio",Zt=!0,on=Ut;Ut.hasOwnProperty("audioOnly")&&(Qt=Ut.audioOnly,delete Ut.audioOnly,on.mediaTypeForIncomingCall!==void 0&&on.mediaTypeForIncomingCall!==null||Ut.audioOnly===!0&&(on.mediaTypeForIncomingCall="AUDIO")),Ut.hasOwnProperty("noStream")&&(on.mediaTypeForIncomingCall="NONE",Zt=!1),on.mediaTypeForIncomingCall==="NONE"&&(Zt=!1),Ct.getStatus()===tt.g.INVITATION_STATUS_STANDBY?(Ct.setStatus(tt.g.INVITATION_STATUS_ACCEPTED),Ct.apiRTCManager.sendData(Ct.sender.getId(),{event:tt.g.INVITATION_ANSWER_IDENTIFIER,invitationId:Ct.id,answer:"accept"}),Ct.call.setStatus(tt.g.CALL_STATUS_ONGOING),Zt&&dt!==null&&dt instanceof so&&(Gn.debug("accept() - A stream was preselected; audio only : ",Qt),on.userMediaStreamId=dt.userMediaStreamId),Ct.apiRTCManager.webRTCClient.acceptCall(Ct.id,on),Vt(Ct.call)):zt(Wt.g.createError(tt.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot join this call, invitation state invalid",Gn))})}},{key:"decline",value:function(dt){this.getStatus()===tt.g.INVITATION_STATUS_STANDBY&&(this.setStatus(tt.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:tt.g.INVITATION_ANSWER_IDENTIFIER,invitationId:this.id,reason:dt,answer:"decline"}),this.apiRTCManager.webRTCClient.refuseCall(this.id))}},{key:"getCall",value:function(){return this.call}}],Ot=[{key:"getAvailableEvents",value:function(){return xr}}],Xt&&na(Lt.prototype,Xt),Ot&&na(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(kn);function jn($t){return jn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},jn($t)}function pr($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function _r($t,Lt){return _r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},_r($t,Lt)}function yr($t,Lt){if(Lt&&(jn(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}($t)}function Kr($t){return Kr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Kr($t)}var $r=mt.Y.get("ReceivedInvitation"),Co=["error","progress","statusChange"],eo=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&_r(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=Kr(Ft);if(sn){var Ut=Kr(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return yr(this,dt)});function Jt(dt,Ct,Ut){var Vt;return function(zt,Qt){if(!(zt instanceof Qt))throw new TypeError("Cannot call a class as a function")}(this,Jt),Vt=ln.call(this,dt,Ct),$r.debug("Create ReceivedFileTransferInvitation"),Vt.type="sendFile",Vt.fileInfo=Ut,Vt.apiRTCManager.onEvent("hangup",function(zt){$r.debug("hangup");var Qt=zt.detail.callId.toString();Vt.getId()===Qt&&($r.debug("hangup for ReceivedFileTransferInvitation"),Vt.getStatus()===tt.g.INVITATION_STATUS_ENDED?$r.debug("invitation ended"):($r.debug("invitation is cancelled"),Vt.setStatus(tt.g.INVITATION_STATUS_CANCELLED)),apiRTC.userAgentInstance.currentSession.invitationsMap.has(zt.detail.remoteId+"-sendfile-"+Qt)&&apiRTC.userAgentInstance.currentSession.invitationsMap.delete(zt.detail.remoteId+"-sendfile-"+Qt))}),Vt}return Lt=Jt,Ot=[{key:"getAvailableEvents",value:function(){return Co}}],(Xt=[{key:"accept",value:function(){var dt=this;return new Promise(function(Ct,Ut){if(dt.getStatus()!==tt.g.INVITATION_STATUS_STANDBY)Ut(Wt.g.createError(tt.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot join this file transfer session, invitation state invalid",$r));else{dt.setStatus(tt.g.INVITATION_STATUS_ACCEPTED),dt.apiRTCManager.sendData(dt.sender.getId(),{event:tt.g.INVITATION_ANSWER_IDENTIFIER,invitationId:dt.id,answer:"accept"});var Vt=dt;dt.apiRTCManager.onEvent("onFileReceived",function zt(Qt){if(Qt.detail.callId.toString()===Vt.id.toString()){if($r.debug("typeof(e.detail.data.file) :",jn(Qt.detail.data.file)),typeof Qt.detail.data.file=="string")Ct({file:Qt.detail.data.file,name:Qt.detail.data.name,type:Qt.detail.data.type});else{var Zt=new FileReader;Zt.addEventListener("loadend",function(){dt.setStatus(tt.g.INVITATION_STATUS_ENDED),dt.apiRTCManager.webRTCClient.hangUp(Vt.id.toString());try{$r.info("accept() - file received from "+Vt.sender.getUsername()+" !"),Ct({file:Qt.detail.data.file,name:Qt.detail.data.name,type:Qt.detail.data.type})}catch(on){$r.error("File Error",on),Ut(Wt.g.createError(tt.g.ERROR_OTHER,"accept() - Could not read file received",$r))}}),Zt.readAsArrayBuffer(Qt.detail.data.file)}dt.apiRTCManager.removeEventListener("onFileReceived",zt)}}),dt.apiRTCManager.onEvent("onFileProgress",function(zt){zt.detail.callId.toString()===Vt.id.toString()&&($r.trace("file transfering",zt.detail),tn.get(Vt).emit("progress",{uuid:zt.detail.uuid,fileSize:zt.detail.fileSize,remainingSize:zt.detail.remainingSize,percentage:zt.detail.percentage,sendChunkNb:zt.detail.sendChunkNb,transferDuration:zt.detail.transferDuration,lastPacket:zt.detail.lastPacket}))}),dt.apiRTCManager.onEvent("receiveDataChannelError",function(zt){zt.detail.callId.toString()===Vt.id.toString()&&($r.warn("receiveDataChannelError",zt.detail),tn.get(Vt).emit("error","receiveDataChannelError"))}),dt.apiRTCManager.webRTCClient.acceptCall(dt.id,{mediaTypeForIncomingCall:"DATA"})}})}},{key:"getFileInfo",value:function(){return this.fileInfo}},{key:"decline",value:function(dt){$r.log("decline"),this.getStatus()===tt.g.INVITATION_STATUS_STANDBY&&(this.setStatus(tt.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:tt.g.INVITATION_ANSWER_IDENTIFIER,invitationId:this.id,reason:dt,answer:"decline"}),this.apiRTCManager.webRTCClient.refuseCall(this.id))}}])&&pr(Lt.prototype,Xt),Ot&&pr(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(kn);function ga($t){return ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},ga($t)}function gs($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function Qo($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function Cl($t,Lt){return Cl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},Cl($t,Lt)}function fp($t,Lt){if(Lt&&(ga(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}($t)}function vs($t){return vs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},vs($t)}var vu=mt.Y.get("ReceivedInvitation"),Cs=function($t){(function(Jt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Jt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Jt,writable:!0,configurable:!0}}),Object.defineProperty(Jt,"prototype",{writable:!1}),dt&&Cl(Jt,dt)})(ln,$t);var Lt,Xt,Ot,Ft,sn=(Ot=ln,Ft=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Jt,dt=vs(Ot);if(Ft){var Ct=vs(this).constructor;Jt=Reflect.construct(dt,arguments,Ct)}else Jt=dt.apply(this,arguments);return fp(this,Jt)});function ln(Jt,dt){var Ct,Ut=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return gs(this,ln),Ct=sn.call(this,Jt,dt),vu.info("Create ReceivedWhiteboardInvitation"),Ct.type="whiteboard",Ut.cloudConvId&&(Ct.cloudConvId=Ut.cloudConvId),Ut.webconf===!0&&(Ct.webconf=!0),Ct}return Lt=ln,(Xt=[{key:"accept",value:function(){var Jt=this;return new Promise(function(dt,Ct){if(Jt.getStatus()===tt.g.INVITATION_STATUS_STANDBY){Jt.setStatus(tt.g.INVITATION_STATUS_ACCEPTED),Jt.apiRTCManager.sendData(Jt.sender.getId(),{event:tt.g.INVITATION_ANSWER_IDENTIFIER,invitationId:"wb-"+Jt.id,answer:"accept"}),Jt.apiRTCManager.whiteBoardClient.leaveRoom(),Jt.apiRTCManager.whiteBoardClient.start();var Ut={};Jt.cloudConvId&&(Ut.convId=Jt.cloudConvId),Jt.webconf===!0&&(Ut.webconf=!0),Jt.apiRTCManager.whiteBoardClient.joinRoom(Jt.id,Ut),dt(Jt.id)}else Ct(Wt.g.createError(tt.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot join this whiteboard session, invitation state invalid",vu))})}},{key:"decline",value:function(Jt){this.getStatus()===tt.g.INVITATION_STATUS_STANDBY&&(this.setStatus(tt.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:tt.g.INVITATION_ANSWER_IDENTIFIER,invitationId:"wb-"+this.id,reason:Jt,answer:"decline"}))}}])&&Qo(Lt.prototype,Xt),Object.defineProperty(Lt,"prototype",{writable:!1}),ln}(kn);function yl($t){return yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},yl($t)}function mp($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function Cu($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function Sl($t,Lt){return Sl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},Sl($t,Lt)}function gp($t,Lt){if(Lt&&(yl(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yr($t)}function Yr($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function bs($t){return bs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},bs($t)}var To=mt.Y.get("DataChannel"),Tl=wn.get(),vp=["response","accepted","declined","error","opened","closed","error","transferProgress","transferComplete","dataReceived","ended"],bu=new WeakMap,yu=new WeakMap,Zo=new WeakMap,ys=new WeakMap,Ss=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&Sl(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=bs(Ft);if(sn){var Ut=bs(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return gp(this,dt)});function Jt(dt,Ct){var Ut,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return mp(this,Jt),Ut=ln.call(this,To),To.debug("Create DataChannel with id "+dt),bu.set(Yr(Ut),dt),yu.set(Yr(Ut),Ct),ys.set(Yr(Ut),tt.g.DATACHANNEL_TYPE_RECEIVE),Vt.hasOwnProperty("type")&&(Vt.type===tt.g.DATACHANNEL_TYPE_RECEIVE?ys.set(Yr(Ut),tt.g.DATACHANNEL_TYPE_RECEIVE):Vt.type===tt.g.DATACHANNEL_TYPE_SEND&&ys.set(Yr(Ut),tt.g.DATACHANNEL_TYPE_SEND)),Zo.set(Yr(Ut),tt.g.DATACHANNEL_STATUS_WAITING),Tl.onEvent("receiveData",function(zt){zt.detail.data.info!==void 0&&zt.detail.data.info===tt.g.INVITATION_ANSWER_IDENTIFIER&&zt.detail.data.invitationId.toString()===Ut.getId()&&Ut.getStatus()===tt.g.DATACHANNEL_STATUS_WAITING&&(To.info("DataChannel answer from "+Ut.getContact().getUsername()+" for "+Ut.getId()),zt.detail.data.answer==="accept"?tn.get(Yr(Ut)).emit("accepted"):(Zo.set(Yr(Ut),tt.g.DATACHANNEL_STATUS_ENDED),tn.get(Yr(Ut)).emit("declined")),tn.get(Yr(Ut)).emit("response"))}).onEvent("callEstablished",function(zt){var Qt=zt.detail.callId.toString();Ut.getId()===Qt&&(To.info("callEstablished from "+Ut.getContact().getUsername(),zt),Ut.getStatus()!==tt.g.DATACHANNEL_STATUS_ONGOING&&Ut.getStatus()!==tt.g.DATACHANNEL_STATUS_ENDED&&tn.get(Yr(Ut)).emit("accepted"))}).onEvent("hangup",function(zt){var Qt=zt.detail.callId.toString(),Zt=Ut.getStatus()===tt.g.DATACHANNEL_STATUS_WAITING&&zt.detail.hangupType==="remote";Ut.getId()===Qt&&Ut.getStatus()!==tt.g.DATACHANNEL_STATUS_ENDED&&(Zo.set(Yr(Ut),tt.g.DATACHANNEL_STATUS_ENDED),To.info("Hangup from "+Ut.getContact().getUsername(),zt),tn.get(Yr(Ut)).emit("ended",{from:zt.detail.hangupType}),Zt&&tn.get(Yr(Ut)).emit("declined"))}).onEvent("onFileReceived",function(zt){if(zt.detail.callId.toString()===Ut.getId()){var Qt=zt.detail.data,Zt=new FileReader;Zt.addEventListener("loadend",function(){try{var on=Wt.g.arrayBuffertoString(Zt.result);To.info("dataReceived !"),tn.get(Yr(Ut)).emit("dataReceived",{uuid:Qt.uuid,data:on})}catch(bn){To.error("dataReceived Error",bn)}}),Zt.readAsArrayBuffer(Qt.file)}}).onEvent("onFileProgress",function(zt){if(zt.detail.callId.toString()===Ut.getId()){var Qt=zt.detail;To.trace("file transfering",Qt);var Zt={uuid:Qt.uuid,fileSize:Qt.fileSize,remainingSize:Qt.remainingSize,percentage:Qt.percentage,sendChunkNb:Qt.sendChunkNb,transferDuration:Qt.transferDuration,lastPacket:Qt.lastPacket};tn.get(Yr(Ut)).emit("transferProgress",Zt),Qt.transferEnded&&tn.get(Yr(Ut)).emit("transferComplete",Zt)}}).onEvent("receiveDataChannelError",function(zt){var Qt=zt.detail.callId.toString();Ut.getId()===Qt&&tn.get(Yr(Ut)).emit("error","receiveDataChannelError")}).onEvent("sendDataChannelError",function(zt){var Qt=zt.detail.callId.toString();Ut.getId()===Qt&&tn.get(Yr(Ut)).emit("error","sendDataChannelError")}).onEvent("receiveDataChannelClose",function(zt){var Qt=zt.detail.callId.toString();Ut.getId()===Qt&&tn.get(Yr(Ut)).emit("closed")}).onEvent("sendDataChannelClose",function(zt){var Qt=zt.detail.callId.toString();Ut.getId()===Qt&&tn.get(Yr(Ut)).emit("closed")}).onEvent("receiveDataChannelOpen",function(zt){var Qt=zt.detail.callId.toString();Ut.getId()===Qt&&(Zo.set(Yr(Ut),tt.g.DATACHANNEL_STATUS_ONGOING),tn.get(Yr(Ut)).emit("opened"))}).onEvent("sendDataChannelOpen",function(zt){var Qt=zt.detail.callId.toString();Ut.getId()===Qt&&tn.get(Yr(Ut)).emit("opened")}),Ut}return Lt=Jt,Xt=[{key:"getId",value:function(){return bu.get(this).toString()}},{key:"getContact",value:function(){return yu.get(this)}},{key:"getType",value:function(){return ys.get(this)}},{key:"getStatus",value:function(){return Zo.get(this)}},{key:"sendData",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,zt){var Qt=!1;Ct.getStatus()!==tt.g.DATACHANNEL_STATUS_ONGOING?zt(Wt.g.createError(tt.g.ERROR_OTHER,"Cannot send data as datachannel session is not ongoing",To)):Ct.getType()!==tt.g.DATACHANNEL_TYPE_SEND?zt(Wt.g.createError(tt.g.ERROR_OTHER,"Cannot send data as datachannel session is receiving only",To)):Tl.webRTCClient.sendDataWithCallId(Ct.getId(),{file:dt,name:Ut.name,type:Ut.type},function(Zt){Qt||(Qt=!0,Vt(Zt.uuid)),To.trace("sendData() - progress : ",Zt);var on={uuid:Zt.uuid,fileSize:Zt.fileSize,remainingSize:Zt.remainingSize,percentage:Zt.percentage,sendChunkNb:Zt.sendChunkNb,transferDuration:Zt.transferDuration,lastPacket:Zt.lastPacket};tn.get(Ct).emit("transferProgress",on),Zt.transferEnded&&tn.get(Ct).emit("transferComplete",on)})})}},{key:"close",value:function(){this.getStatus()===tt.g.DATACHANNEL_STATUS_ENDED?To.error("close() - DataChannel session has already ended"):Tl.webRTCClient.hangUp(this.getId())}}],Ot=[{key:"getAvailableEvents",value:function(){return vp}}],Xt&&Cu(Lt.prototype,Xt),Ot&&Cu(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(fn);function Il($t){return Il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Il($t)}function Su($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function Rl($t,Lt){return Rl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},Rl($t,Lt)}function Cp($t,Lt){if(Lt&&(Il(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tu($t)}function Tu($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Ts($t){return Ts=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Ts($t)}var Iu=mt.Y.get("ReceivedInvitation"),bp=["expired","statusChange"],zo=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&Rl(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=Ts(Ft);if(sn){var Ut=Ts(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return Cp(this,dt)});function Jt(dt,Ct){var Ut;return function(Vt,zt){if(!(Vt instanceof zt))throw new TypeError("Cannot call a class as a function")}(this,Jt),Ut=ln.call(this,dt,Ct),Iu.info("Create ReceivedDataChannelInvitation "),Ut.type="dataChannel",Ut.apiRTCManager.onEvent("hangup",function(Vt){var zt=Vt.detail.callId.toString();Ut.id.toString()===zt&&Ut.getStatus()===tt.g.INVITATION_STATUS_STANDBY&&(Ut.setStatus(tt.g.INVITATION_STATUS_EXPIRED),tn.get(Tu(Ut)).emit("expired"))}),Ut}return Lt=Jt,Ot=[{key:"getAvailableEvents",value:function(){return bp}}],(Xt=[{key:"accept",value:function(){var dt=this;return new Promise(function(Ct,Ut){if(dt.getStatus()===tt.g.INVITATION_STATUS_STANDBY){dt.setStatus(tt.g.INVITATION_STATUS_ACCEPTED),dt.apiRTCManager.sendData(dt.sender.getId(),{event:tt.g.INVITATION_ANSWER_IDENTIFIER,invitationId:dt.id,answer:"accept"});var Vt=new Ss(dt.id,dt.sender,{started:!0,type:tt.g.DATACHANNEL_TYPE_SEND});dt.apiRTCManager.webRTCClient.acceptCall(dt.id,{mediaTypeForIncomingCall:"DATA"}),Ct(Vt)}else Ut(Wt.g.createError(tt.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot join this datachannel session, invitation state invalid",Iu))})}},{key:"decline",value:function(dt){this.getStatus()===tt.g.INVITATION_STATUS_STANDBY&&(this.setStatus(tt.g.INVITATION_STATUS_DECLINED),this.apiRTCManager.sendData(this.sender.getId(),{event:tt.g.INVITATION_ANSWER_IDENTIFIER,invitationId:this.id,reason:dt,answer:"decline"}),this.apiRTCManager.webRTCClient.refuseCall(this.id))}}])&&Su(Lt.prototype,Xt),Ot&&Su(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(kn);function El($t){return El=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},El($t)}function yp($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function Ol($t,Lt){return Ol=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},Ol($t,Lt)}function Sp($t,Lt){if(Lt&&(El(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}($t)}function Is($t){return Is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Is($t)}var Al=mt.Y.get("ReceivedInvitation"),Ho=function($t){(function(Jt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Jt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Jt,writable:!0,configurable:!0}}),Object.defineProperty(Jt,"prototype",{writable:!1}),dt&&Ol(Jt,dt)})(ln,$t);var Lt,Xt,Ot,Ft,sn=(Ot=ln,Ft=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Jt,dt=Is(Ot);if(Ft){var Ct=Is(this).constructor;Jt=Reflect.construct(dt,arguments,Ct)}else Jt=dt.apply(this,arguments);return Sp(this,Jt)});function ln(Jt,dt,Ct){var Ut;return function(Vt,zt){if(!(Vt instanceof zt))throw new TypeError("Cannot call a class as a function")}(this,ln),Ut=sn.call(this,Jt,Ct),Al.info("Create ReceivedConversationJoinRequest"),Ut.type="conversationJoinRequest",Ut.conversation=dt||null,Ut}return Lt=ln,(Xt=[{key:"getConversation",value:function(){return this.conversation}},{key:"accept",value:function(){var Jt=this;return new Promise(function(dt,Ct){Jt.getStatus()===tt.g.INVITATION_STATUS_STANDBY?(Jt.setStatus(tt.g.INVITATION_STATUS_ACCEPTED),Jt.conversation?Jt.conversation.allowEntry(Jt.sender,{invitationId:Jt.id,answer:"accept",ackEnabled:!0}).then(dt).catch(Ct):(Jt.apiRTCManager.sendData(Jt.sender.getId(),{roomname:Jt.id,event:tt.g.INVITATION_ANSWER_IDENTIFIER,invitationId:Jt.id,answer:"accept",command:"access",value:{access:!0}}),dt())):Ct(Wt.g.createError(tt.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot accept request, invitation state invalid",Al))})}},{key:"decline",value:function(Jt){var dt=this;return new Promise(function(Ct,Ut){dt.getStatus()===tt.g.INVITATION_STATUS_STANDBY?(dt.setStatus(tt.g.INVITATION_STATUS_DECLINED),dt.conversation?dt.conversation.denyEntry(dt.sender,{invitationId:dt.id,answer:"decline",reason:Jt}).then(Ct).catch(Ut):(dt.apiRTCManager.sendData(dt.sender.getId(),{roomname:dt.id,event:tt.g.INVITATION_ANSWER_IDENTIFIER,invitationId:dt.id,reason:Jt,answer:"decline",command:"access",value:{access:!1}}),Ct())):Ut(Wt.g.createError(tt.g.ERROR_INVITATION_STATE_INVALID,"decline() - Cannot decline request, invitation state invalid",Al))})}}])&&yp(Lt.prototype,Xt),Object.defineProperty(Lt,"prototype",{writable:!1}),ln}(kn);function Ml($t){return Ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Ml($t)}function Tp($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function xl($t,Lt){return xl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},xl($t,Lt)}function Ip($t,Lt){if(Lt&&(Ml(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}($t)}function Rs($t){return Rs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Rs($t)}var Ru=mt.Y.get("ReceivedInvitation"),_l=function($t){(function(Jt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Jt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Jt,writable:!0,configurable:!0}}),Object.defineProperty(Jt,"prototype",{writable:!1}),dt&&xl(Jt,dt)})(ln,$t);var Lt,Xt,Ot,Ft,sn=(Ot=ln,Ft=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Jt,dt=Rs(Ot);if(Ft){var Ct=Rs(this).constructor;Jt=Reflect.construct(dt,arguments,Ct)}else Jt=dt.apply(this,arguments);return Ip(this,Jt)});function ln(Jt,dt,Ct){var Ut;return function(Vt,zt){if(!(Vt instanceof zt))throw new TypeError("Cannot call a class as a function")}(this,ln),(Ut=sn.call(this,Jt,dt)).session=Ct,Ut.type="pointerSharing",Ut}return Lt=ln,(Xt=[{key:"accept",value:function(){var Jt=this;return new Promise(function(dt,Ct){Jt.getStatus()===tt.g.INVITATION_STATUS_STANDBY?(Jt.setStatus(tt.g.INVITATION_STATUS_ACCEPTED),Jt.session.joinPointerSharingRoom(Jt.id).then(dt).catch(function(Ut){Ct(Wt.g.createError(tt.g.ERROR_OTHER,"accept() - cannot accept invitation",Ru))})):Ct(Wt.g.createError(tt.g.ERROR_INVITATION_STATE_INVALID,"accept() - cannot accept invitation",Ru))})}},{key:"decline",value:function(Jt){this.getStatus()===tt.g.INVITATION_STATUS_STANDBY&&this.setStatus(tt.g.INVITATION_STATUS_DECLINED)}}])&&Tp(Lt.prototype,Xt),Object.defineProperty(Lt,"prototype",{writable:!1}),ln}(kn);function Rp($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}s(4723);var Ur=mt.Y.get("AicConsoleManager"),wu=function(){function $t(){var Ot=this;(function(Ft,sn){if(!(Ft instanceof sn))throw new TypeError("Cannot call a class as a function")})(this,$t),Ur.info("Create AicConsoleManager"),this.ws=null,this.connectedToapplication=!1,this.domStream=null,this.keyboard_mode=0,this.ports=[4545,5858,37371,41793,42803],this.port_index=0,this.aic_agent_running=0,this.ip="127.0.0.1",this.aic_agent_handshake_done=0,this.controlActivated=!1,this.handshakeTimeoutId=0,this.kd=function(Ft){Ot.key_down(Ft)},this.ku=function(Ft){Ot.key_up(Ft)},this.wfl=function(Ft){Ot.window_focus_lost(Ft)},this.mm=function(Ft){Ot.mouse_move(Ft)},this.dc=function(Ft){Ot.mouse_doubleclick(Ft)},this.md=function(Ft){Ot.mouse_down(Ft)},this.mu=function(Ft){Ot.mouse_up(Ft)},this.mw=function(Ft){Ot.mouse_wheel(Ft)}}var Lt,Xt;return Lt=$t,Xt=[{key:"aic_control_onmessage",value:function(Ot){if(Ur.debug("Message to send to remote app :",Ot),apiRTC.session.remoteAccessInvitation!==null){var Ft={event:tt.g.CONTACT_REMOTEACCESS_APP_MESSAGE,invitationId:apiRTC.session.remoteAccessInvitation.id,roomname:apiRTC.session.remoteAccessInvitation.conversation._getTechnicalName(),message:Ot};apiRTC.session.remoteAccessInvitation.send(Ft).then(function(){}).catch(function(sn){Ur.warn("Contact#send CONTACT_REMOTEACCESS_APP_MESSAGE message error:",sn)})}else Ur.error("Error on aic_control_onmessage, remoteAccessInvitation is not initialized")}},{key:"aic_keyboard_keydown",value:function(Ot,Ft){this.aic_control_onmessage('aic_keyboard_keypress("'+Ot+'","KEY_DOWN,'+Ft+'")')}},{key:"aic_keyboard_keyup",value:function(Ot,Ft){this.aic_control_onmessage('aic_keyboard_keypress("'+Ot+'","KEY_UP,'+Ft+'")')}},{key:"key_down",value:function(Ot){if(Ur.debug("key_down"),Ot.target===document.body)if(Ot.preventDefault(),Ot.isComposing||Ot.keyCode===229)Ur.debug("Ignoring event "+Ot);else if(this.keyboard_mode===0){var Ft=(Ot.altKey?"MOD_ALT,":"")+(Ot.ctrlKey?"MOD_CONTROL,":"")+(Ot.metaKey?"MOD_META,":"")+(Ot.shiftKey?"MOD_SHIFT,":"");this.aic_keyboard_keydown(Ot.key,Ft)}else this.keyboard_mode===1&&this.aic_control_onmessage("aic_keyboard_keydown("+Ot.keyCode+")");else Ur.debug("this is not document body, ignoring this event")}},{key:"key_up",value:function(Ot){if(Ur.debug("key_up"),Ot.target===document.body)if(Ot.preventDefault(),Ot.isComposing||Ot.keyCode===229)console.log("Ignoring event "+Ot);else if(this.keyboard_mode===0){var Ft=(Ot.altKey?"MOD_ALT,":"")+(Ot.ctrlKey?"MOD_CONTROL,":"")+(Ot.metaKey?"MOD_META,":"")+(Ot.shiftKey?"MOD_SHIFT,":"");this.aic_keyboard_keyup(Ot.key,Ft)}else this.keyboard_mode===1&&this.aic_control_onmessage("aic_keyboard_keyup("+Ot.keyCode+")");else Ur.debug("this is not document body, ignoring this event")}},{key:"window_focus_lost",value:function(Ot){Ur.debug("window_focus_lost"),this.aic_keyboard_keyup("Shift","MOD_ALT,MOD_CONTROL,MOD_META,MOD_SHIFT")}},{key:"mouse_doubleclick",value:function(Ot){this.mouse_move(Ot),this.aic_control_onmessage("aic_mouse_doubleclick("+Ot.which+")")}},{key:"mouse_down",value:function(Ot){this.mouse_move(Ot),this.aic_control_onmessage("aic_mouse_down("+Ot.which+")")}},{key:"mouse_up",value:function(Ot){this.mouse_move(Ot),this.aic_control_onmessage("aic_mouse_up("+Ot.which+")")}},{key:"mouse_wheel",value:function(Ot){Ot.preventDefault(),this.aic_control_onmessage("aic_mouse_scroll("+Ot.deltaX+","+-1*Ot.deltaY+")")}},{key:"mouse_move",value:function(Ot){var Ft=window.screen.width,sn=window.screen.height;apiRTC.session.remoteAccessInvitation!==null&&(Ft=apiRTC.session.remoteAccessInvitation.screenWidth,sn=apiRTC.session.remoteAccessInvitation.screenHeight);var ln=getComputedStyle(Ot.target),Jt=parseInt(ln.getPropertyValue("width"),10),dt=parseInt(ln.getPropertyValue("height"),10),Ct=0,Ut=0,Vt=!1;Jt/parseInt(Ot.target.videoWidth,10)<=dt/parseInt(Ot.target.videoHeight,10)&&(Vt=!0),Vt===!0?(Ur.debug("Keeping width"),Ut=Jt*Ot.target.videoHeight/Ot.target.videoWidth,Ct=Jt):(Ur.debug("Keeping height"),Ct=dt*Ot.target.videoWidth/Ot.target.videoHeight,Ut=dt);var zt=Ot.target.getBoundingClientRect(),Qt=Ot.clientX-zt.left-(Jt-Ct)/2,Zt=Ot.clientY-zt.top-(dt-Ut)/2,on=Math.floor(Qt/Ct*Ft),bn=Math.floor(Zt/Ut*sn);this.aic_control_onmessage("aic_mouse_move("+on+","+bn+")")}},{key:"searchDOMElement",value:function(Ot){var Ft=this;return new Promise(function(sn,ln){if(Ft.domStream=document.getElementById(Ot),Ft.domStream)sn();else{var Jt="Dom element not found in searchDOMElement";Ur.debug(Jt),ln(new Error(Jt))}})}},{key:"aic_control_start",value:function(){var Ot=this;return new Promise(function(Ft,sn){Ur.debug("aic_control_start"),window.oncontextmenu=function(){return!1};var ln=apiRTC.session.remoteAccessInvitation.screenSharingStreamDOMElementId;Ur.debug("domSearchFilter :",ln),Ot.searchDOMElement(ln).then(function(){if(Ot.domStream)Ur.debug("Adding mouse and keyboard events listeners"),document.addEventListener("keydown",Ot.kd,{passive:!1}),document.addEventListener("keyup",Ot.ku,{passive:!1}),document.addEventListener("blur",Ot.wfl,{passive:!1}),Ot.domStream.addEventListener("mousemove",Ot.mm,!0),Ot.domStream.addEventListener("mousedown",Ot.md,!0),Ot.domStream.addEventListener("mouseup",Ot.mu,!0),Ot.domStream.addEventListener("wheel",Ot.mw,{passive:!1}),Ot.controlActivated=!0,Ft();else{var Jt="Dom element not found";Ur.debug(Jt),sn(new Error(Jt))}}).catch(function(Jt){sn(Jt)})})}},{key:"aic_control_stop",value:function(){var Ot=this;return Ur.debug("aic_control_stop"),new Promise(function(Ft,sn){if(window.oncontextmenu=function(){return!0},Ot.domStream)Ur.debug("Removing mouse and keyboard events listeners"),document.removeEventListener("keydown",Ot.kd,{passive:!1}),document.removeEventListener("keyup",Ot.ku,{passive:!1}),document.removeEventListener("blur",Ot.wfl,{passive:!1}),Ot.domStream.removeEventListener("mousemove",Ot.mm,!0),Ot.domStream.removeEventListener("dblclick",Ot.dc,!0),Ot.domStream.removeEventListener("mousedown",Ot.md,!0),Ot.domStream.removeEventListener("mouseup",Ot.mu,!0),Ot.domStream.removeEventListener("wheel",Ot.mw,{passive:!1}),Ot.controlActivated=!1,Ft();else{var ln="Dom element not found";Ur.debug(ln),sn(new Error(ln))}})}},{key:"aic_agent_send_message",value:function(Ot){this.ws!==void 0?this.ws.readyState===1?this.ws.send(Ot):Ur.info("aic_agent_send_message : ws in not in readyState"):Ur.info("aic_agent_send_message : ws in not defined")}},{key:"ws_onopen",value:function(){var Ot=this;Ur.debug("ws_onopen : Connected"),this.aic_agent_handshake_done=0,this.aic_agent_send_message("aic_agent_start()"),this.handshakeTimeoutId=setTimeout(function(){Ur.error("Timeout reached on handshake"),Ot.ws.close(1e3,"HANDSHAKE_NOK")},1e3)}},{key:"ws_onmessage",value:function(Ot){var Ft=Ot.data;Ur.debug("received_msg :",Ft);var sn=Ft.match(/^aic_notify\(\"([^\"]*)\",\"([^\"]*)\"\)$/);sn&&sn[1]==="aic_agent_version"&&(Ur.debug("aic_agent_version is :",sn[2]),clearTimeout(this.handshakeTimeoutId),this.aic_agent_handshake_done=1,this.connectedToapplication=!0,this.send_application_status("APP_CONNECTION_OK"),apiRTC.session.remoteAccessInvitation!=null&&apiRTC.session.remoteAccessInvitation.fireEvent("application_connection_ok"))}},{key:"ws_onclose",value:function(Ot){var Ft=this;Ur.debug("ws_onclose : Closed - event :",Ot),this.connectedToapplication===!0?(apiRTC.session.remoteAccessInvitation!==null&&apiRTC.session.remoteAccessInvitation.stop(!0),this.connectedToapplication=!1):this.ws_reconnect()===2&&setTimeout(function(){Ft.ws_reconnect()},3e3)}},{key:"ws_onerror",value:function(Ot){Ur.debug("ws_onerror : "+Ot)}},{key:"ws_connect",value:function(Ot){var Ft=this;Ur.debug("ws_connect : Connecting ");var sn="ws://"+this.ip+":"+Ot+"/ws";Ur.debug("... on url :",sn),this.ws=new WebSocket(sn,"ws-server-aic"),this.ws.addEventListener("open",function(ln){Ft.ws_onopen(ln)}),this.ws.addEventListener("message",function(ln){Ft.ws_onmessage(ln)}),this.ws.addEventListener("close",function(ln){Ft.ws_onclose(ln)}),this.ws.addEventListener("error",function(ln){Ft.ws_onerror(ln)})}},{key:"ws_reconnect",value:function(){return this.aic_agent_running===0?0:this.port_index>=this.ports.length?(this.port_index=0,2):(this.ws_connect(this.ports[this.port_index]),this.port_index++,0)}},{key:"send_application_status",value:function(Ot){if(Ur.debug("send_application_status"),apiRTC.session.remoteAccessInvitation!==null){var Ft={event:tt.g.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE,invitationId:apiRTC.session.remoteAccessInvitation.id,roomname:apiRTC.session.remoteAccessInvitation.conversation._getTechnicalName(),status:Ot};apiRTC.session.remoteAccessInvitation.sendMessageToSender(tt.g.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE,Ft).then(function(){}).catch(function(sn){Ur.warn("Contact#send send_application_status message error:",sn)})}else Ur.warn("send_application_status but not linked to a remoteAccessInvitation")}},{key:"aic_agent_start",value:function(){Ur.debug("aic_agent_start"),"WebSocket"in window?(this.aic_agent_running=1,this.send_application_status("APP_CONNECTION_ONGOING"),apiRTC.session.remoteAccessInvitation!=null&&apiRTC.session.remoteAccessInvitation.fireEvent("application_connection_ongoing"),this.ws_reconnect(this.ip)):Ur.error("WebSocket NOT supported by your Browser!")}},{key:"aic_agent_stop",value:function(){Ur.debug("aic_agent_stop"),this.aic_agent_running=0,this.ws.close()}},{key:"aic_agent_exit",value:function(){this.aic_agent_send_message("aic_agent_exit()")}}],Xt&&Rp(Lt.prototype,Xt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function Pl($t){return Pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Pl($t)}function wp($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function Eu($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function Dl($t,Lt){return Dl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},Dl($t,Lt)}function Ep($t,Lt){if(Lt&&(Pl(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}($t)}function ws($t){return ws=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},ws($t)}var xa=mt.Y.get("ReceivedInvitation"),kp=["stop","messageDelivered","messageNotDelivered","application_connection_ongoing","application_connection_ok"],Op=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&Dl(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=ws(Ft);if(sn){var Ut=ws(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return Ep(this,dt)});function Jt(dt,Ct,Ut){var Vt,zt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return wp(this,Jt),xa.debug("Create ReceivedRemoteAccessInvitation"),(Vt=ln.call(this,dt,Ct.invitationId)).type="remoteAccess",Vt.conversation=Ut,zt.cloudConvId&&(Vt.cloudConvId=zt.cloudConvId),zt.webconf===!0&&(Vt.webconf=!0),Vt.aicConsoleManager=null,Vt.screenSharingStreamId=null,Vt.screenSharingStream=null,Vt.apiRTCManager.onEvent("receiveData",function(Qt){xa.debug("ReceivedRemoteAccessInvitation receiveData "),Qt.detail.data.event!==void 0&&Qt.detail.data.event===tt.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER&&Qt.detail.data.invitationId.toString()===Vt.id.toString()?(xa.debug("Received stop for "+Vt.id,Qt.detail.data),Vt.stop(!1,Qt.detail.data.reason)):Qt.detail.data.event===tt.g.CONTACT_REMOTEACCESS_APP_MESSAGE&&Qt.detail.data.invitationId.toString()===Vt.id.toString()&&(xa.debug("Received CONTACT_REMOTEACCESS_APP_MESSAGE for "+Vt.id,Qt.detail.data),Vt.aicConsoleManager!==null?Vt.aicConsoleManager.aic_agent_send_message(Qt.detail.data.message):xa.debug("aicConsoleManager is not initialized"))}),Vt.conversation.on("contactLeft",function(Qt){Qt.id===Vt.sender.id&&(xa.debug("Remote user has left, stopping remoteAccess"),Vt.stop(!1,{code:"AGENT_LEFT"}))}),Vt}return Lt=Jt,Xt=[{key:"accept",value:function(){var dt=this;return new Promise(function(Ct,Ut){if(xa.debug("ReceivedRemoteAccessInvitation accept"),dt.getStatus()===tt.g.INVITATION_STATUS_STANDBY){dt.setStatus(tt.g.INVITATION_STATUS_ACCEPTED);var Vt={event:tt.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER,invitationId:dt.id,roomname:dt.conversation._getTechnicalName(),answer:"accept"};dt.sendMessageToSender(tt.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER,Vt).then(function(){Ct(dt.id)}).catch(function(zt){Ut(zt)})}else Ut(Wt.g.createError(tt.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot accept remote access, invitation state invalid",xa))})}},{key:"decline",value:function(){var dt=this;return new Promise(function(Ct,Ut){if(xa.debug("ReceivedRemoteAccessInvitation decline"),dt.getStatus()===tt.g.INVITATION_STATUS_STANDBY){dt.setStatus(tt.g.INVITATION_STATUS_DECLINED);var Vt={event:tt.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER,invitationId:dt.id,roomname:dt.conversation._getTechnicalName(),answer:"decline"};dt.sendMessageToSender(tt.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER,Vt).then(function(){Ct(dt.id)}).catch(function(zt){Ut(zt)}),dt.stop(!0,{code:"USER_DECLINE"})}else Ut(Wt.g.createError(tt.g.ERROR_INVITATION_STATE_INVALID,"accept() - Cannot decline remote access, invitation state invalid",xa))})}},{key:"sendMessageToSender",value:function(dt,Ct){var Ut=this;return xa.debug("sendMessageToSender :",Ct),new Promise(function(Vt,zt){Ut.apiRTCManager.sendData(Ut.sender.getId(),Ct).then(function(){tn.get(Ut).emit("messageDelivered",{event:dt,contact:Ut.sender,messageData:Ct}),Vt()}).catch(function(Qt){var Zt=Wt.g.createError(Qt,"Invitation not delivered",xa);tn.get(Ut).emit("messageNotDelivered",{error:Zt,contact:Ut.sender,event:dt,messageData:Ct}),zt(Zt)})})}},{key:"fireEvent",value:function(dt,Ct){tn.get(this).emit(dt,Ct)}},{key:"startScreenSharingAndPublish",value:function(){var dt=this;return xa.debug("startScreenSharingAndPublish"),new Promise(function(Ct,Ut){apiRTC.Stream.createDisplayMediaStream({video:{cursor:"always",displaySurface:"monitor"},surfaceSwitching:"exclude",selfBrowserSurface:"exclude",systemAudio:"exclude"}).then(function(Vt){Vt.screensharingRemoteAccessStream=!0;var zt={},Qt={};Qt.invitationId=dt.id,Qt.screenWidth=window.screen.width,Qt.screenHeight=window.screen.height,zt.context={remoteAccessCtx:Qt},dt.screenSharingStreamId=Vt.getId(),dt.screenSharingStream=Vt,xa.debug("setting screenSharingStreamId :",dt.screenSharingStreamId),dt.conversation.publish(Vt,zt).then(function(Zt){dt.aicConsoleManager=new wu,dt.aicConsoleManager.aic_agent_start(),Ct(Zt)}).catch(function(Zt){var on={code:"DISPLAY_MEDIA_PUBLISH_ERROR",error:Zt};dt.stop(!0,on),Ut(Zt)})}).catch(function(Vt){xa.error("error on createDisplayMediaStream :",Vt);var zt={code:"CREATE_DISPLAY_MEDIA_ERROR",error:Vt};dt.stop(!0,zt),Ut(Vt)})})}},{key:"downloadApplication",value:function(){return xa.debug("downloadApplication"),new Promise(function(dt,Ct){fetch("https://dev.cdn.apizee.com/apiRTC/app/remoteAccess.exe").then(function(Ut){return Ut.blob()}).then(function(Ut){var Vt=window.URL.createObjectURL(Ut),zt=document.createElement("a");zt.href=Vt,zt.download="remoteAccess.exe",document.body.appendChild(zt),zt.click(),zt.remove(),dt()}).catch(function(Ut){xa.error("Something went wrong during remote access application loading.. toString :",Ut.toString()),Ct(new Error("error on application fetch :"+Ut.toString()))})})}},{key:"stop",value:function(){var dt=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;xa.debug("stop with sendMessage :",dt),Ct==null&&(Ct={code:"USER_STOP"});var Ut=this.conversation.conversationPublishedStreams.get(this.screenSharingStreamId);if(Ut!=null&&(xa.debug("streamInfo :",Ut),apiCC.session.apiCCWebRTCClient.webRTCClient.onHangup(Ut.callId)),this.screenSharingStream!==null&&(this.screenSharingStream.release(),this.screenSharingStream=null),this.aicConsoleManager!==null&&(this.aicConsoleManager.aic_agent_exit(),this.aicConsoleManager.aic_agent_stop(),this.aicConsoleManager=null),apiRTC.session.remoteAccessInvitation=null,dt){var Vt={event:tt.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER,invitationId:this.id,roomname:this.conversation._getTechnicalName(),reason:Ct};this.sendMessageToSender(tt.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER,Vt).then(function(){}).catch(function(zt){xa.warn("Contact#send stop message error:",zt)})}tn.get(this).emit("stop",Ct)}}],Ot=[{key:"getAvailableEvents",value:function(){return kp}}],Xt&&Eu(Lt.prototype,Xt),Ot&&Eu(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(kn),Ap=s(8364),Go=s.n(Ap);function Es($t){return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Es($t)}function Mp($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function ku($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}s(9601),s(5306);var xp=mt.Y.get("UserData"),_p=wn.get(),Io=function(){function $t(){var Ft=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(var sn in Mp(this,$t),Ft)Ft.hasOwnProperty(sn)&&(this[sn]=Ft[sn])}var Lt,Xt,Ot;return Lt=$t,Ot=[{key:"equals",value:function(Ft,sn){if(!(Ft instanceof Object&&sn instanceof Object))return!1;for(var ln in Ft)if(sn[ln]===void 0||Es(sn[ln])==="object"&&!this.equals(sn[ln],Ft[ln])||sn[ln]!==Ft[ln])return!1;for(var Jt in sn)if(Ft[Jt]===void 0||Es(Ft[Jt])==="object"&&!this.equals(Ft[Jt],sn[Jt])||Ft[Jt]!==sn[Jt])return!1;return!0}}],(Xt=[{key:"get",value:function(Ft){return this.hasOwnProperty(Ft)&&this[Ft]!==void 0&&this[Ft]!=="null"&&this[Ft]!==null?this[Ft]:null}},{key:"setToSession",value:function(){try{var Ft={};for(var sn in this)this.hasOwnProperty(sn)&&typeof this[sn]!="function"&&(Ft[sn]=this[sn]);_p.apiRTCSession.setUserData(Ft)}catch{xp.error("setUserData() - could not set userData")}}},{key:"setProp",value:function(Ft,sn){return this[Ft]=sn,this}},{key:"setProps",value:function(Ft){for(var sn in Ft)Ft.hasOwnProperty(sn)&&(this[sn]=Ft[sn]);return this}}])&&ku(Lt.prototype,Xt),Ot&&ku(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function Nl($t){return Nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Nl($t)}function Pp($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function Ou($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function Ul($t,Lt){return Ul=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},Ul($t,Lt)}function Dp($t,Lt){if(Lt&&(Nl(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ks($t)}function ks($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Os($t){return Os=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Os($t)}var Ao=mt.Y.get("SentInvitation"),Np=["response","receive","statusChange"],Do=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&Ul(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=Os(Ft);if(sn){var Ut=Os(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return Dp(this,dt)});function Jt(dt,Ct){var Ut,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Pp(this,Jt),(Ut=ln.call(this)).conversation=Ct,Ao.info("Create SentInvitation"),Ut.invitationType="sent",Ut.contact=dt,Ut.id=Wt.g.guid(),Ut.sendTime=Date.now(),Ut.expirationTime=null,Ut.expirationTimeout=null,Vt.hasOwnProperty("expirationTime")&&(Ut.expirationTime=Vt.expirationTime,Ut.expirationTimeout=setTimeout(function(){Ut.getStatus()===tt.g.INVITATION_STATUS_STANDBY&&(Ao.info("Conversation invitation expired"),Ut.setStatus(tt.g.INVITATION_STATUS_EXPIRED),tn.get(ks(Ut)).emit("response",Ut.getStatus()))},Vt.expirationTime)),Vt.hasOwnProperty("receiveNotifier")&&Vt.receiveNotifier.on("receive",function(){tn.get(ks(Ut)).emit("receive")}),Ut.apiRTCManager.onEvent("receiveData",function(zt){Ao.debug("SentInvitation receiveData "),zt.detail.data.event!==void 0&&(zt.detail.data.event!==tt.g.INVITATION_ANSWER_IDENTIFIER&&zt.detail.data.event!==tt.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER||zt.detail.data.invitationId.toString()!==Ut.id.toString()||Ut.getStatus()!==tt.g.INVITATION_STATUS_STANDBY||(Ao.debug("Received invitation answer for "+Ut.id,zt.detail.data),Ut.expirationTimeout!==null&&clearTimeout(Ut.expirationTimeout),zt.detail.data.answer==="accept"?Ut.setStatus(tt.g.INVITATION_STATUS_ACCEPTED):Ut.setStatus(tt.g.INVITATION_STATUS_DECLINED),tn.get(ks(Ut)).emit("response",Ut.getStatus())))}),Ut.apiRTCManager.onEvent("hangup",function(zt){Ao.debug("hangup");var Qt=zt.detail.callId.toString();Ut.getId()===Qt&&(Ao.debug("hangup for sentInvitation"),Ut.setStatus(tt.g.INVITATION_STATUS_ENDED))}),Ut}return Lt=Jt,Ot=[{key:"getAvailableEvents",value:function(){return Np}}],(Xt=[{key:"getId",value:function(){return this.id}},{key:"onResponse",value:function(dt){this.on("response",dt)}},{key:"cancel",value:function(){Ao.info("cancel"),this.type==="sendFile"?(Ao.info("cancel sendfile"),this.apiRTCManager.webRTCClient.hangUp(this.id)):Ao.warn("cancel is not managed for invitation with type :",this.type)}},{key:"send",value:function(dt){var Ct=this;return Ao.debug("SentInvitation#send"),new Promise(function(Ut,Vt){Ct.apiRTCManager.sendData(Ct.contact.getId(),dt).then(function(){return Ut()}).catch(function(zt){var Qt=Wt.g.createError(zt,"Invitation not delivered",Ao);return Vt(Qt)})})}}])&&Ou(Lt.prototype,Xt),Ot&&Ou(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(or);function Ll($t){return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Ll($t)}function Up($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function Au($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function $l($t,Lt){return $l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},$l($t,Lt)}function Lp($t,Lt){if(Lt&&(Ll(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return As($t)}function As($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Ms($t){return Ms=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Ms($t)}var mo=mt.Y.get("SentRemoteAccessInvitation"),$p=["response","receive","remoteAccessStreamAdded","stop","application_connection_ongoing","application_connection_ok"],jp=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&$l(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=Ms(Ft);if(sn){var Ut=Ms(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return Lp(this,dt)});function Jt(dt,Ct){var Ut,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Up(this,Jt),Ut=ln.call(this,dt,Ct,Vt),mo.debug("Create sentRemoteAccessInvitation"),Ut.type="remoteAccess",Ut.screenSharingStreamId=null,Ut.screenSharingStream=null,Ut.aicConsoleManager=null,Ut.screenSharingStreamDOMElementId=null,Ut.apiRTCManager.onEvent("receiveData",function(zt){mo.debug("SentRemoteAccessInvitation receiveData "),zt.detail.data.event!==void 0&&(zt.detail.data.event===tt.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER&&zt.detail.data.invitationId.toString()===Ut.id.toString()?(mo.debug("SentRemoteAccessInvitation Received stop for "+Ut.id,zt.detail.data),Ut.stop(!1,zt.detail.data.reason)):zt.detail.data.event===tt.g.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE&&zt.detail.data.invitationId.toString()===Ut.id.toString()&&(mo.debug("CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE : "+Ut.id,zt.detail.data.status),zt.detail.data.status==="APP_CONNECTION_ONGOING"?(tn.get(As(Ut)).emit("application_connection_ongoing"),Ut.aicConsoleManager=new wu,Ut.aicConsoleManager.controlActivated===!0&&Ut.aicConsoleManager.aic_control_stop().then(function(){tn.get(As(Ut)).emit("controlStop")}).catch(function(Qt){mo.debug("aic_control_stop error:",Qt)})):zt.detail.data.status==="APP_CONNECTION_OK"&&tn.get(As(Ut)).emit("application_connection_ok")))}),Ut.conversation.on("contactLeft",function(zt){zt.id===Ut.contact.id&&(mo.debug("Remote user has left, stopping remoteAccess"),Ut.stop(!1,{code:"USER_LEFT"}))}),Ut}return Lt=Jt,Xt=[{key:"setRemoteAccessStream",value:function(dt){mo.debug("setRemoteAccessStream"),this.screenSharingStream=dt,tn.get(this).emit("remoteAccessStreamAdded",this.screenSharingStream)}},{key:"setScreenSharingStreamDOMElementId",value:function(dt){var Ct=this;this.screenSharingStreamDOMElementId=dt,this.aicConsoleManager!==null?this.aicConsoleManager.aic_control_start().then(function(){tn.get(Ct).emit("controlStart")}).catch(function(Ut){mo.warn("aic_control_start error:",Ut)}):mo.debug("aicConsoleManager is not activated")}},{key:"toggleMouseAndKeyboardAccess",value:function(){var dt=this;return mo.debug("toggleMouseAndKeyboardAccess"),new Promise(function(Ct,Ut){if(dt.aicConsoleManager!==null)dt.aicConsoleManager.controlActivated===!0?dt.aicConsoleManager.aic_control_stop().then(function(){tn.get(dt).emit("controlStop"),Ct()}).catch(function(zt){Ut(zt)}):dt.aicConsoleManager.aic_control_start().then(function(){tn.get(dt).emit("controlStart"),Ct()}).catch(function(zt){Ut(zt)});else{var Vt="aicConsoleManager is not activated";mo.debug(Vt),Ut(new Error(Vt))}})}},{key:"getMouseAndKeyboardAccessStatus",value:function(){return this.aicConsoleManager.controlActivated}},{key:"stop",value:function(){var dt=this,Ct=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(mo.debug("stop"),Ut==null&&(Ut={code:"AGENT_STOP"}),this.aicConsoleManager!==null&&(this.aicConsoleManager.controlActivated===!0&&this.aicConsoleManager.aic_control_stop().then(function(){tn.get(dt).emit("controlStop")}).catch(function(zt){mo.warn("aic_control_stop error:",zt)}),this.aicConsoleManager=null),Ct){var Vt={event:tt.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER,invitationId:this.id,roomname:this.conversation._getTechnicalName(),reason:Ut};this.send(Vt).then(function(){}).catch(function(zt){mo.warn("Contact#send stop message error:",zt)})}apiRTC.session.remoteAccessInvitation!==null&&(tn.get(this).emit("stop",Ut),apiRTC.session.remoteAccessInvitation=null)}}],Ot=[{key:"getAvailableEvents",value:function(){return $p}}],Xt&&Au(Lt.prototype,Xt),Ot&&Au(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(Do);function Fl($t){return Fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Fl($t)}function Mu($t,Lt){var Xt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Xt){if(Array.isArray($t)||(Xt=function(dt,Ct){if(dt){if(typeof dt=="string")return xu(dt,Ct);var Ut=Object.prototype.toString.call(dt).slice(8,-1);return Ut==="Object"&&dt.constructor&&(Ut=dt.constructor.name),Ut==="Map"||Ut==="Set"?Array.from(dt):Ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ut)?xu(dt,Ct):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Xt&&($t=Xt);var Ot=0,Ft=function(){};return{s:Ft,n:function(){return Ot>=$t.length?{done:!0}:{done:!1,value:$t[Ot++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Jt=!1;return{s:function(){Xt=Xt.call($t)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Jt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Jt)throw sn}}}}function xu($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Xt=0,Ot=new Array(Lt);Xt<Lt;Xt++)Ot[Xt]=$t[Xt];return Ot}function Fp($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function _u($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function Wl($t,Lt){return Wl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},Wl($t,Lt)}function Wp($t,Lt){if(Lt&&(Fl(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jr($t)}function Jr($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function xs($t){return xs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},xs($t)}var rr=mt.Y.get("Contact"),Vr=wn.get(),es=new(Go()),Bl=Or.get(),Bp=["message","conversationInvitation","data","joinGroup","leaveGroup","whiteboardInvitation","fileSentSuccessfully","fileTransferInvitation","fileTransferProgress","dataChannelInvitation","incomingCall","newMediaAvailable","customEvent","fileTransferError","incomingScreenSharingCall","incomingScreenSharingCallInvitation"],Vl=new WeakMap,Pu=new WeakMap,zl=new Map,No=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&Wl(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=xs(Ft);if(sn){var Ut=xs(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return Wp(this,dt)});function Jt(dt){var Ct,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Fp(this,Jt),Ct=ln.call(this,rr),rr.debug("Create Contact with id "+dt),rr.debug("Create Contact with userData :",Ut),Pu.set(Jr(Ct),dt.toString()),Ct.groups=[],Ct.previousMessages=[],Ct.userData=new Io(Ut),Ct.enterprise=null,Ct.streams=new Map,Ct.profile=null,Ct.fileTransfers=[],Ct.promises=[],Vl.set(Jr(Ct),[]),Vr.onEvent("roomInvitation",function(Vt){if(Vt.detail.senderId!==null&&Vt.detail.senderId!==void 0&&Vt.detail.roomType==="whiteBoard"&&Vt.detail.senderId.toString()===Ct.getId()){rr.info("Received whiteboard invitation from "+Ct.getUsername());var zt={};Vt.detail.cloudConvId&&(zt.cloudConvId=Vt.detail.cloudConvId),Vt.detail.webconf===!0&&(zt.webconf=!0),tn.get(Jr(Ct)).emit("whiteboardInvitation",new Cs(Jr(Ct),Vt.detail.roomId,zt))}}).onEvent("receiveIMMessage",function(Vt){Vt.detail.senderId.toString()===Ct.getId()&&(tn.get(Jr(Ct)).emit("message",{content:Vt.detail.message,uuid:Vt.detail.UUCSeq,time:Vt.detail.time}),Ct.addMessageToHistory(Vt.detail.message,Math.round(Vt.detail.time.getTime()/1e3),Vt.detail.UUCSeq,!0))}).onEvent("receiveData",function(Vt){if(Vt.detail.senderId.toString()===Ct.getId()){rr.debug("Received data e.detail.data : ",Vt.detail.data);var zt=Vt.detail.data,Qt=null,Zt=uo.get();if(zt.roomname!==void 0&&(Qt=Zt.isConference(zt.roomname)?Zt.getOrCreateConference(Zt.getNameFromTechnicalName(zt.roomname)):Zt.getOrCreateConversation(Zt.getNameFromTechnicalName(zt.roomname))),zt.apiRTCRequest===!0&&Ct.manageApiRTCRequest(Vt.detail,Qt),zt.event!==void 0)switch(zt.event){case tt.g.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER:case tt.g.INVITATION_ANSWER_IDENTIFIER:break;case tt.g.CONTACT_SEND_DATA_IDENTIFIER:rr.trace("Received data from "+Ct.getUsername(),zt.content),tn.get(Jr(Ct)).emit("data",zt.content);break;case tt.g.CONVERSATION_INVITATION_IDENTIFIER:if(Qt!==null){rr.debug("Received conversation invitation from "+Ct.getId());var on={};zt.hasOwnProperty("password")&&(on.password=zt.password),tn.get(Jr(Ct)).emit("conversationInvitation",new jt(Jr(Ct),zt,Qt,on))}break;case tt.g.CONTACT_SEND_FILEINFO_IDENTIFIER:rr.debug("Received file info from "+Ct.getUsername(),zt.fileInfo);var bn=zt.callId.toString();if(Wt.g._private.dataCallsFileInfo.set(bn,zt.fileInfo),Wt.g._private.dataCallsOnHold.has(bn)){var Rn=null;apiRTC.userAgentInstance.currentSession.invitationsMap.has(Ct.getId()+"-sendfile-"+bn)?(Rn=apiRTC.userAgentInstance.currentSession.invitationsMap.get(Ct.getId()+"-sendfile-"+bn),rr.debug("invitation already exist :",Rn)):(Rn=new eo(Jr(Ct),bn,zt.fileInfo),apiRTC.userAgentInstance.currentSession.invitationsMap.set(Ct.getId()+"-sendfile-"+bn,Rn)),tn.get(Jr(Ct)).emit("fileTransferInvitation",Rn)}break;case tt.g.CONTACT_DATACHANNEL_INVITATION:rr.debug("Received datachannel invitation from "+Ct.getUsername()),Wt.g._private.dataChannelInvitations.set(zt.callId.toString(),!0),Wt.g._private.dataCallsOnHold.has(zt.callId.toString())&&tn.get(Jr(Ct)).emit("dataChannelInvitation",new zo(Jr(Ct),zt.callId.toString()));break;case tt.g.CONTACT_NEW_MEDIA_IDENTIFIER:rr.debug("New media available from "+Ct.getUsername(),zt.fileinfo),tn.get(Jr(Ct)).emit("newMediaAvailable",{media:zt.media});break;case tt.g.CONTACT_EVENTCENTER_DATA_REQUEST:rr.debug("New request for event center data from "+Ct.getUsername());var qn=apiRTC.eventCenter.getStoredData();if(qn===void 0)return void rr.error("Can't send event center stored data, it's undefined");rr.debug("Sending requested event center data"),Ct.sendCustomEvent(tt.g.CONTACT_EVENTCENTER_DATA_ANSWER,{data:qn});break;case tt.g.CONTACT_EVENTCENTER_DATA_ANSWER:if(rr.debug("New event center data from "+Ct.getUsername()),zt.data===void 0)return void rr.error("Can't handle remote event center data, it's undefined");apiRTC.eventCenter.handleDataAnswer(zt.data);break;case tt.g.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_IDENTIFIER:rr.debug("New getAudioFlowStatus from "+zt.requesterId+" on stream "+zt.streamId);var Jn=Ct.getContact(zt.requesterId),dr=Ct.getLocalStreamPublished();if(dr===null)return Ct.sendToContactRemoteStreamError("No stream found on remote",Jn,zt);Jn.sendCustomEvent(tt.g.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_RESULT_IDENTIFIER,{callId:zt.callId,streamId:zt.streamId,timeout:zt.timeout,audioFlowStatus:dr.getAudioFlowStatus()});break;case tt.g.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_IDENTIFIER:rr.debug("New getVideoFlowStatus from "+zt.requesterId+" on stream "+zt.streamId);var hr=Ct.getContact(zt.requesterId),Ar=Ct.getLocalStreamPublished();if(Ar===null)return Ct.sendToContactRemoteStreamError("No stream found on remote",hr,zt);hr.sendCustomEvent(tt.g.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_RESULT_IDENTIFIER,{callId:zt.callId,streamId:zt.streamId,timeout:zt.timeout,videoFlowStatus:Ar.getVideoFlowStatus()});break;case tt.g.CONTACT_GET_SETTINGS_IDENTIFIER:rr.debug("CONTACT_GET_SETTINGS_IDENTIFIER");var Xr,_i=Ct.getContact(zt.requesterId);if((Xr=zt.mediaStreamId!==void 0?Ct.getLocalStreamWithMediaStreamId(zt.mediaStreamId):Ct.getLocalStreamWithCallId(zt.streamId))===null)return Ct.sendToContactRemoteStreamError("No stream found on remote",_i,zt);Xr.getSettings().then(function(lo){_i.sendCustomEvent(tt.g.CONTACT_GET_SETTINGS_RESULT_IDENTIFIER,{callId:zt.callId,streamId:zt.streamId,timeout:zt.timeout,settings:lo})}).catch(function(lo){Ct.sendToContactRemoteStreamError(lo.message,_i,zt)});break;case tt.g.CONTACT_GET_CAPABILITIES_IDENTIFIER:rr.debug("CONTACT_GET_CAPABILITIES_IDENTIFIER");var Vo,lr=Ct.getContact(zt.requesterId);if((Vo=zt.mediaStreamId!==void 0?Ct.getLocalStreamWithMediaStreamId(zt.mediaStreamId):Ct.getLocalStreamWithCallId(zt.streamId))===null)return Ct.sendToContactRemoteStreamError("No stream found on remote",lr,zt);Vo.getCapabilities().then(function(lo){lr.sendCustomEvent(tt.g.CONTACT_GET_CAPABILITIES_RESULT_IDENTIFIER,{callId:zt.callId,streamId:zt.streamId,timeout:zt.timeout,capabilities:lo})}).catch(function(lo){Ct.sendToContactRemoteStreamError(lo.message,lr,zt)});break;case tt.g.CONTACT_GET_CONSTRAINTS_IDENTIFIER:rr.debug("New getConstraints from "+zt.requesterId);var er=Ct.getContact(zt.requesterId),Tr=Ct.getLocalStreamPublished();if(Tr===null)return Ct.sendToContactRemoteStreamError("No stream found on remote",er,zt);Tr.getConstraints().then(function(lo){er.sendCustomEvent(tt.g.CONTACT_GET_CONSTRAINTS_RESULT_IDENTIFIER,{callId:zt.callId,streamId:zt.streamId,timeout:zt.timeout,constraints:lo})}).catch(function(lo){Ct.sendToContactRemoteStreamError(lo.message,er,zt)});break;case tt.g.CONTACT_APPLY_CONSTRAINTS_IDENTIFIER:var kr;rr.debug("CONTACT_APPLY_CONSTRAINTS_IDENTIFIER"),kr=zt.mediaStreamId!==void 0?Ct.getLocalStreamWithMediaStreamId(zt.mediaStreamId):Ct.getLocalStreamWithCallId(zt.streamId);var br=Ct.getContact(zt.requesterId);if(kr===null)return Ct.sendToContactRemoteStreamError("No stream found on remote",br,zt);kr.applyConstraints(zt.constraints).then(function(){br.sendCustomEvent(tt.g.CONTACT_APPLY_CONSTRAINTS_RESULT_IDENTIFIER,{callId:zt.callId,streamId:zt.streamId,timeout:zt.timeout}),kr.emitConstraintsChanged(zt.constraints)}).catch(function(lo){Ct.sendToContactRemoteStreamError(lo.message,br,zt)});break;case tt.g.CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER:var $a;rr.debug("CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER from :"+zt.requesterId),($a=apiRTC.userAgentInstance.getStreamWithMediaStreamId(zt.mediaStreamId))!=="NOT_FOUND"&&$a.emitConstraintsChanged(zt.constraints);break;case tt.g.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_RESULT_IDENTIFIER:rr.debug("getRemoteAudioFlowStatus result :",zt);var to=Ct.getRemoteStreamSubscribed(zt.callId,zt.streamId);to===null?rr.error("Can't find the local stream to resolve the request.."):to.resolvePendingPromise(zt.timeout,zt.audioFlowStatus);break;case tt.g.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_RESULT_IDENTIFIER:rr.debug("getRemoteVideoFlowStatus result :",zt);var vo=Ct.getRemoteStreamSubscribed(zt.callId,zt.streamId);vo===null?rr.error("Can't find the local stream to resolve the request.."):vo.resolvePendingPromise(zt.timeout,zt.videoFlowStatus);break;case tt.g.CONTACT_GET_SETTINGS_RESULT_IDENTIFIER:rr.debug("remote getSettings result :",zt);var Oo=Ct.getRemoteStreamSubscribed(zt.callId,zt.streamId);Oo===null?rr.error("Can't find the local stream to resolve the request.."):Oo.resolvePendingPromise(zt.timeout,zt.settings);break;case tt.g.CONTACT_GET_CAPABILITIES_RESULT_IDENTIFIER:rr.debug("remote getCapabilities result :",zt);var Wr=Ct.getRemoteStreamSubscribed(zt.callId,zt.streamId);Wr===null?rr.error("Can't find the local stream to resolve the request.."):Wr.resolvePendingPromise(zt.timeout,zt.capabilities);break;case tt.g.CONTACT_GET_CONSTRAINTS_RESULT_IDENTIFIER:rr.debug("remote getConstraints result :",zt);var po=Ct.getRemoteStreamSubscribed(zt.callId,zt.streamId);po===null?rr.error("Can't find the local stream to resolve the request.."):po.resolvePendingPromise(zt.timeout,zt.constraints);break;case tt.g.CONTACT_GET_REMOTE_ERROR:rr.debug("remote stream request error:",zt);var So=Ct.getRemoteStreamSubscribed(zt.callId,zt.streamId);So===null?rr.error("Can't find the local stream to reject the request.."):So.rejectPendingPromise(zt.timeout,zt.message);break;case tt.g.CONTACT_APPLY_CONSTRAINTS_RESULT_IDENTIFIER:rr.debug("remote applyConstraints result :",zt);var hs=Ct.getRemoteStreamSubscribed(zt.callId,zt.streamId);hs===null?rr.error("Can't find the local stream to resolve the request.."):hs.resolvePendingPromise(zt.timeout,zt.constraints);break;default:var fs={event:zt.event,content:zt};Qt!==null&&(fs.conversation=Qt),tn.get(Jr(Ct)).emit("customEvent",fs)}}}).onEvent("incomingCall",function(Vt){if(Vt.detail.callerId.toString()===Ct.getId()){var zt=Vt.detail.callId.toString();if(Vt.detail.callType==="data")if(rr.debug("Received file transfer invitation from "+Ct.getUsername()),Wt.g._private.dataCallsFileInfo.has(zt)){var Qt=Wt.g._private.dataCallsFileInfo.get(zt),Zt=null;apiRTC.userAgentInstance.currentSession.invitationsMap.has(Ct.getId()+"-sendfile-"+zt)?(Zt=apiRTC.userAgentInstance.currentSession.invitationsMap.get(Ct.getId()+"-sendfile-"+zt),rr.debug("invitation already exist :",Zt)):(Zt=new eo(Jr(Ct),zt,Qt),apiRTC.userAgentInstance.currentSession.invitationsMap.set(Ct.getId()+"-sendfile-"+zt,Zt)),tn.get(Jr(Ct)).emit("fileTransferInvitation",Zt)}else Wt.g._private.dataChannelInvitations.has(zt)?tn.get(Jr(Ct)).emit("dataChannelInvitation",new zo(Jr(Ct),zt)):(rr.info("File information has not been received yet, putting invitation on hold"),Wt.g._private.dataCallsOnHold.set(zt));else if(Vt.detail.callType==="screenSharing"||Vt.detail.callType==="screenSharingWithAudio")if(apiRTC.session.apiCCWebRTCClient.webRTCClient.userAcceptOnIncomingScreenSharingCall===!0){rr.debug("Received screenSharingCallInvitation from "+Ct.getUsername());var on=new Ir(Jr(Ct),zt,Vt.detail.callType,{isRecorded:!!Vt.detail.hasOwnProperty("recordedCall")&&Vt.detail.recordedCall});tn.get(Jr(Ct)).emit("incomingScreenSharingCallInvitation",on)}else{rr.debug("Received screenSharingCall from "+Ct.getUsername());var bn=Bl.getOrCreateCall(zt,Jr(Ct),{started:!0,isRecorded:!!Vt.detail.hasOwnProperty("recordedCall")&&Vt.detail.recordedCall});tn.get(Jr(Ct)).emit("incomingScreenSharingCall",bn)}else rr.info("Received call invitation from "+Ct.getUsername()),tn.get(Jr(Ct)).emit("incomingCall",new Ir(Jr(Ct),zt,Vt.detail.callType,{isRecorded:!!Vt.detail.hasOwnProperty("recordedCall")&&Vt.detail.recordedCall}))}}).onEvent("hangup",function(Vt){var zt=Vt.detail.callId.toString();Ct.getId()===Vt.detail.remoteId.toString()&&(rr.debug("hangup event :",Vt.detail),Ct.fileTransfers.includes(zt)&&(rr.info("File transfer finished from "+Ct.getUsername()),Ct.fileTransfers.splice(Ct.fileTransfers.indexOf(zt),1)))}).onEvent("sendDataChannelError",function(Vt){var zt=Vt.detail.callId.toString();Ct.getId()===Vt.detail.remoteId.toString()&&Ct.fileTransfers.includes(zt)&&(rr.info("File transfer error from "+Ct.getUsername()),tn.get(Jr(Ct)).emit("fileTransferError",{error:"sendDataChannelError",invitationId:zt}))}).onEvent("fetchUserDataAnswer",function(Vt){Ct.getId()===Vt.detail.id.toString()&&(Ct.userData=new Io(Vt.detail.userData),Ct.promises.forEach(function(zt){Vt.detail.timeout===zt.timeout&&(clearTimeout(zt.timeout),zt.resolve(Vt.detail.userData))}))}),Ct}return Lt=Jt,Xt=[{key:"getId",value:function(){return Pu.get(this)}},{key:"id",get:function(){return rr.warn("contact.id is deprecated, please use contact.getId() instead"),this.getId()}},{key:"fetchProfileInformation",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Promise(function(Vt,zt){Ct.profile===null||Ut?es.getUserProfile(Vr.getActiveApiKey(),Ct.getId(),dt).then(function(Qt){Ct.profile=Qt,Vt(Qt)}).catch(zt):Vt(Ct.profile)})}},{key:"getActiveStreams",value:function(){return this.streams.values()}},{key:"getLocalStreamWithCallId",value:function(dt){for(var Ct=null,Ut=so.getLocalStreams(),Vt=Ut.next();!Vt.done;){for(var zt=Vt.value,Qt=zt.publishedInConversations.values(),Zt=Qt.next();!Zt.done;)Zt.value===dt&&(rr.debug("Finding Stream in a conversation"),Ct=zt),Zt=Qt.next();zt.callId===dt&&(rr.debug("Finding Stream in a call"),Ct=zt),Vt=Ut.next()}return Ct}},{key:"getLocalStreamPublished",value:function(){var dt=so.getLocalStreams().next();return dt.value===void 0?null:dt.value}},{key:"getLocalStreamWithMediaStreamId",value:function(dt){for(var Ct=null,Ut=so.getLocalStreams(),Vt=Ut.next();!Vt.done;){var zt=Vt.value;if(zt.data.id===dt)return zt;Vt=Ut.next()}return Ct}},{key:"getRemoteStreamSubscribed",value:function(dt,Ct){var Ut=Br.getActiveSession().getCall(dt);if(Ut){rr.debug("remote stream is associated to a call");var Vt,zt=Mu(Ut.getReceivedStreams());try{for(zt.s();!(Vt=zt.n()).done;){var Qt=Vt.value;if(Qt.getId()===Ct)return Qt}}catch(dr){zt.e(dr)}finally{zt.f()}}else{var Zt=Br.getActiveSession().getActiveConversations(),on=Br.getActiveSession().getActiveConferences();for(var bn in Zt){var Rn=Zt[bn].getSubscribedStream(Ct);if(Rn!==void 0)return rr.debug("remote stream is associated to a conversation"),Rn}for(var qn in on){var Jn=on[qn].getSubscribedStream(Ct);if(Jn!==void 0)return rr.debug("remote stream is associated to a conference"),Jn}}return null}},{key:"addMessageToHistory",value:function(dt,Ct,Ut,Vt){Vl.get(this).indexOf(Ut.toString())===-1&&(this.previousMessages.push({content:dt,timestamp:Ct,uuid:Ut,fromContact:Vt}),Vl.get(this).push(Ut.toString()))}},{key:"getPreviousMessages",value:function(){return this.previousMessages.sort(function(dt,Ct){return new Date(Ct.timestamp)-new Date(dt.timestamp)}),this.previousMessages}},{key:"getUserData",value:function(){return this.userData}},{key:"getRemoteAccessSupport",value:function(){var dt=!1;return this.userData.remoteAccessUserSupport==="ON"&&(dt=!0),dt}},{key:"fetchUserData",value:function(){var dt=this;return new Promise(function(Ct,Ut){var Vt=setTimeout(function(){Ut("Timeout error during fetchUserData() process")},5e3);dt.promises.push({timeout:Vt,resolve:Ct}),apiRTC.session.fetchUserData({apiKey:Vr.getActiveApiKey(),id:dt.getId(),timeout:Vt})})}},{key:"getUsername",value:function(){return this.userData.get("username")!==null?this.userData.get("username"):this.userData.get("nickname")!==null?this.userData.get("nickname"):this.getId()}},{key:"getPhotoUrl",value:function(){return this.userData.get("photo_url")!==null?this.userData.get("photo_url"):this.userData.get("photoUrl")!==null?this.userData.get("photoUrl"):null}},{key:"fetchWebSessionInformation",value:function(dt){var Ct=this;return new Promise(function(Ut,Vt){dt instanceof Br?zl.has(Ct.getId()+":"+dt.getId())?Ut(zl.get(Ct.getId()+":"+dt.getId())):es.getWebSession(dt,Ct,Vr.getActiveApiKey()).then(function(zt){zl.set(Ct.getId()+":"+dt.getId(),zt),Ut(zt)}).catch(function(zt){Vt(Wt.g.createError(tt.g.ERROR_OTHER,"fetchWebSessionInformation() - could not fetch web session information",rr))}):Vt(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"fetchWebSessionInformation() - parameter is not an instance of apiRTC.Session",rr))})}},{key:"loadMessageHistory",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,zt){Ct.fetchWebSessionInformation(dt).then(function(Qt){return es.getSessionHistory(Qt.webSessionId,dt.getToken(),Ut)}).then(function(Qt){rr.debug("loadMessageHistory() - got messages",Qt.messages);var Zt,on=Mu(Qt.messages);try{for(on.s();!(Zt=on.n()).done;){var bn=Zt.value;Ct.addMessageToHistory(bn.value,bn.timestamp,bn.uuid,bn.destId.toString()!==Ct.getId())}}catch(Rn){on.e(Rn)}finally{on.f()}Vt()}).catch(function(Qt){zt(Wt.g.createError(tt.g.ERROR_OTHER,"loadMessageHistory() - could not load session history",rr))})})}},{key:"addToGroup",value:function(dt){this.inGroup(dt)||(this.groups.push(dt),tn.get(this).emit("joinGroup",dt))}},{key:"removeFromGroup",value:function(dt){this.inGroup(dt)&&(this.groups.splice(this.groups.indexOf(dt),1),tn.get(this).emit("leaveGroup",dt))}},{key:"inGroup",value:function(dt){return this.groups.includes(dt)}},{key:"isOnline",value:function(){return this.groups.length!==0}},{key:"sendData",value:function(dt){var Ct=this;return this.isOnline()||rr.warn("sendData() - contact "+this.getUsername()+" does not seem to be connected."),new Promise(function(Ut,Vt){Vr.sendData(Ct.getId(),{event:tt.g.CONTACT_SEND_DATA_IDENTIFIER,content:dt}).then(Ut).catch(function(zt){switch(zt){case tt.g.ERROR_TIMED_OUT:Vt(Wt.g.createError(tt.g.ERROR_TIMED_OUT,"sendData() - Data transmission timed out ",rr));break;case tt.g.ERROR_NOT_FOUND:Vt(Wt.g.createError(tt.g.ERROR_NOT_FOUND,"sendData() - Contact was not found ",rr));break;default:Vt(Wt.g.createError(tt.g.ERROR_OTHER,"sendData() - Data default error ",rr))}})})}},{key:"sendCustomEvent",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isOnline()||rr.warn("sendCustomEvent() - contact "+this.getUsername()+" does not seem to be connected."),new Promise(function(Vt,zt){var Qt=Ut;Qt.event=dt,Vr.sendData(Ct.getId(),Qt).then(Vt).catch(function(Zt){switch(Zt){case tt.g.ERROR_TIMED_OUT:zt(Wt.g.createError(tt.g.ERROR_TIMED_OUT,"sendCustomEvent() - Data transmission timed out ",rr));break;case tt.g.ERROR_NOT_FOUND:zt(Wt.g.createError(tt.g.ERROR_NOT_FOUND,"sendCustomEvent() - Contact was not found ",rr));break;default:zt(Wt.g.createError(tt.g.ERROR_OTHER,"sendCustomEvent() - Data transmission timed out ",rr))}})})}},{key:"sendRequest",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isOnline()||rr.warn("sendRequest() - contact "+this.getUsername()+" does not seem to be connected."),new Promise(function(Vt,zt){var Qt=(Math.random()*new Date().getTime()).toString(36).replace(/\./g,"-");Vr.onceEvent("receiveData",function(on){rr.debug("Received data e.detail.data : ",on.detail.data),on.detail.data.apiRTCAnswer===!0&&(on.detail.data.requestUUID===Qt?Vt():rr.error("uuid is not correct"))});var Zt=Ut;Zt.apiRTCRequest=!0,Zt.requestType=dt,Zt.uuid=Qt,Vr.sendData(Ct.getId(),Zt).then(function(){rr.debug("sendData ok")}).catch(function(on){rr.error("Error on sendData",on),zt()})})}},{key:"sendAnswer",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isOnline()||rr.warn("sendRequest() - contact "+this.getUsername()+" does not seem to be connected."),new Promise(function(Vt,zt){var Qt=Ut;Qt.apiRTCAnswer=!0,Qt.answerType=dt,Vr.sendData(Ct.getId(),Qt).then(function(){Vt()}).catch(function(Zt){rr.error("Error on sendData",Zt),zt()})})}},{key:"sendDataAnswer",value:function(dt,Ct,Ut){this.getContact(dt.senderId).sendAnswer(Ct,Ut).then(function(){rr.debug("sendAnswer OK")}).catch(function(Vt){rr.error("Error on sendAnswer",Vt)})}},{key:"manageApiRTCStreamRequest",value:function(dt,Ct){var Ut=this;rr.debug("manageApiRTCStreamRequest : ",dt);var Vt=dt.data.requestType,zt={};zt.requestUUID=dt.data.uuid,zt.result="NOK";var Qt=null;if((Qt=apiRTC.userAgentInstance.getStreamWithRoomNameAndCallId(Ct.getName(),dt.data.streamId))==="NOT_FOUND")zt.reason="STREAM_NOT_FOUND",this.sendDataAnswer(dt,tt.g.CONTACT_ENABLE_VIDEO_ANSWER,zt);else if(Vt!==void 0)switch(Vt){case tt.g.CONTACT_DISABLE_AUDIO_REQUEST:Qt.disableAudio().then(function(){zt.result="OK",Ut.sendDataAnswer(dt,tt.g.CONTACT_DISABLE_AUDIO_ANSWER,zt)}).catch(function(){zt.reason="ERROR_ON_DISABLE_AUDIO",Ut.sendDataAnswer(dt,tt.g.CONTACT_DISABLE_AUDIO_ANSWER,zt)});break;case tt.g.CONTACT_ENABLE_AUDIO_REQUEST:Qt.enableAudio().then(function(){zt.result="OK",Ut.sendDataAnswer(dt,tt.g.CONTACT_ENABLE_AUDIO_ANSWER,zt)}).catch(function(){zt.reason="ERROR_ON_ENABLE_AUDIO",Ut.sendDataAnswer(dt,tt.g.CONTACT_ENABLE_AUDIO_ANSWER,zt)});break;case tt.g.CONTACT_DISABLE_VIDEO_REQUEST:Qt.disableVideo().then(function(){zt.result="OK",Ut.sendDataAnswer(dt,tt.g.CONTACT_DISABLE_VIDEO_ANSWER,zt)}).catch(function(){zt.reason="ERROR_ON_DISABLE_VIDEO",Ut.sendDataAnswer(dt,tt.g.CONTACT_DISABLE_VIDEO_ANSWER,zt)});break;case tt.g.CONTACT_ENABLE_VIDEO_REQUEST:Qt.enableVideo().then(function(){zt.result="OK",Ut.sendDataAnswer(dt,tt.g.CONTACT_ENABLE_VIDEO_ANSWER,zt)}).catch(function(){zt.reason="ERROR_ON_ENABLE_VIDEO",Ut.sendDataAnswer(dt,tt.g.CONTACT_ENABLE_VIDEO_ANSWER,zt)});break;default:rr.error("not a defined apiRTC request :",Vt),zt.reason="ERROR_ON_REQUESTTYPE",this.sendDataAnswer(dt,tt.g.CONTACT_ENABLE_VIDEO_ANSWER,zt)}else rr.error("requestType is undefined :",Vt),zt.reason="ERROR_ON_REQUESTTYPE",this.sendDataAnswer(dt,tt.g.CONTACT_ENABLE_VIDEO_ANSWER,zt)}},{key:"manageApiRTCRequest",value:function(dt,Ct){rr.debug("manageApiRTCRequest : ",dt);var Ut=dt.data.requestType,Vt={};if(Vt.requestUUID=dt.data.uuid,Vt.result="NOK",Ut!==void 0)switch(Ut){case tt.g.CONTACT_DISABLE_AUDIO_REQUEST:case tt.g.CONTACT_ENABLE_AUDIO_REQUEST:case tt.g.CONTACT_DISABLE_VIDEO_REQUEST:case tt.g.CONTACT_ENABLE_VIDEO_REQUEST:this.manageApiRTCStreamRequest(dt,Ct);break;default:rr.error("not a defined apiRTC request :",Ut),Vt.reason="ERROR_ON_REQUESTTYPE",this.sendDataAnswer(dt,tt.g.CONTACT_ENABLE_VIDEO_ANSWER,Vt)}}},{key:"sendMessage",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.isOnline()||rr.warn("sendMessage() - contact "+this.getUsername()+" does not seem to be connected.");var Vt=null,zt=function(){return new Promise(function(Qt,Zt){Ut.hasOwnProperty("session")?Ct.fetchWebSessionInformation(Ut.session).then(function(on){Qt({save:!0,cloudSessionId:on.webSessionId,apiRTCId:Ut.session.getId()})}).catch(Zt):Qt({})})};return new Promise(function(Qt,Zt){return typeof dt!="string"?Zt(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"sendMessage() - message parameter is not instance of string",rr)):dt===""?Zt(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"sendMessage() - message parameter is empty",rr)):void zt().then(function(on){Vt=on,rr.info("sendMessage() - with options :",Vt),Vr.sendMessage(Ct.getId(),dt,Vt).then(function(bn){Ct.addMessageToHistory(dt,Math.floor(Date.now()/1e3),bn,!1),Qt(bn)}).catch(function(bn){switch(bn){case tt.g.ERROR_TIMED_OUT:Zt(Wt.g.createError(tt.g.ERROR_TIMED_OUT,"sendMessage() - Data transmission timed out ",rr));break;case tt.g.ERROR_NOT_FOUND:Zt(Wt.g.createError(tt.g.ERROR_NOT_FOUND,"sendMessage() - Contact was not found ",rr));break;default:Zt(Wt.g.createError(tt.g.ERROR_OTHER,"sendMessage() - Data transmission timed out ",rr))}})},function(on){Zt(Wt.g.createError(tt.g.ERROR_OTHER,"sendMessage() - Error occured when fetching options for sending message",rr))})})}},{key:"inviteTo",value:function(dt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.sendConversationInvitation(dt,Ct)}},{key:"sendConversationInvitation",value:function(dt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return dt instanceof jo?dt.sendInvitation(this,Ct):(rr.error("sendConversationInvitation() - Parameter is not a conversation"),null)}},{key:"sendWhiteboardInvitation",value:function(dt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Vr.whiteBoardClient.roomId!==dt&&(Vr.whiteBoardClient.leaveRoom(),Vr.whiteBoardClient.start(),Vr.whiteBoardClient.joinRoom(dt));var Ut=Ct.context?Ct.context:null,Vt={};Ct.cloudConversationId&&(Vt.convId=Ct.cloudConversationId),Vr.whiteBoardClient.inviteInRoom(dt,this.getId(),Ut,Vt);var zt=new Do(this,null);return zt.id="wb-"+dt,zt.type="whiteboard",zt}},{key:"call",value:function(dt){var Ct,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{mediaTypeForOutgoingCall:"VIDEO",record:!1};this.isOnline()||rr.warn("call() - contact "+this.getUsername()+" does not seem to be connected.");var Vt={},zt=Wt.g.assignObject({},Ut),Qt=!!Ut.hasOwnProperty("audioOnly")&&Ut.audioOnly;Ut.hasOwnProperty("record")&&(zt.record!==void 0&&zt.record!==null||(zt.record=Ut.record)),dt!==null&&dt instanceof so&&(zt.userMediaStreamId=dt.userMediaStreamId,dt.isScreensharing()&&(zt.forceCallType="screenSharing")),zt.cloudConversationId&&(Vt.cloudConvId=zt.cloudConversationId,delete zt.cloudConversationId),Ct=Qt?Vr.webRTCClient.callAudio(this.getId(),Vt,zt):Vr.webRTCClient.call(this.getId(),Vt,zt);var Zt=Bl.getOrCreateCall(Ct,this,{isRecorded:zt.record});return Zt}},{key:"shareScreen",value:function(){var dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.isOnline()||rr.warn("call() - contact "+this.getUsername()+" does not seem to be connected.");var Ct={},Ut=null,Vt=dt,zt=dt.captureSourceType;rr.warn("call() - contact "+this.getUsername()+" does not seem to be connected."),Ut=Vr.webRTCClient.shareScreen(this.getId(),Ct,zt);var Qt=Bl.getOrCreateCall(Ut,this,{isRecorded:Vt.record});return Qt}},{key:"startDataChannel",value:function(){if(this.isOnline()||rr.warn("startDataChannel() - contact "+this.getUsername()+" does not seem to be connected."),!(ht.Xh==="Edge"&&ht.PR<79&&apiRTC.browserDetails.type!=="chrome")){var dt=Vr.webRTCClient.startDataChannel(this.getId());return Vr.sendData(this.getId(),{callId:dt,event:tt.g.CONTACT_DATACHANNEL_INVITATION}),new Ss(dt,this,{type:tt.g.DATACHANNEL_TYPE_SEND})}rr.warn("Cannot startDataChannel as it is not supported on Edge")}},{key:"sendFile",value:function(dt,Ct){if(this.isOnline()||rr.warn("sendFile() - contact "+this.getUsername()+" does not seem to be connected."),ht.Xh==="Edge"&&ht.PR<79&&apiRTC.browserDetails.type!=="chrome")return rr.warn("Cannot sendFile as Datachannel is not supported on Edge"),null;var Ut=Vr.webRTCClient.startDataChannel(this.getId()),Vt=this;if(Ut===void 0)return rr.warn("Error on startDataChannel"),null;Vr.sendData(this.getId(),{fileInfo:dt,callId:Ut,event:tt.g.CONTACT_SEND_FILEINFO_IDENTIFIER}),Vr.onEvent("sendDataChannelOpen",function Qt(Zt){rr.debug("sendFile() - DataChannel open",Zt.detail),Zt.detail.callId.toString()===Ut.toString()&&(Vr.webRTCClient.sendDataWithCallId(Ut,{file:Ct,name:dt.name,type:dt.type},function(on){rr.trace("sendFile() - progress : ",on);var bn={uuid:on.uuid,fileSize:on.fileSize,remainingSize:on.remainingSize,percentage:on.percentage,sendChunkNb:on.sendChunkNb,transferDuration:on.transferDuration,lastPacket:on.lastPacket};tn.get(Vt).emit("fileTransferProgress",{fileInfo:dt,transferInformation:bn}),on.transferEnded&&tn.get(Vt).emit("fileSentSuccessfully",{fileInfo:dt,transferInformation:bn})}),Vr.removeEventListener("sendDataChannelOpen",Qt))}),this.fileTransfers.push(Ut.toString());var zt=new Do(this,null);return zt.id=Ut.toString(),zt.type="sendFile",zt.on("response",function(){zt.getStatus()!==tt.g.INVITATION_STATUS_ACCEPTED&&rr.log("sendFile() - invitation has not been accepted, cleaning listeners")}),zt}},{key:"pushMedia",value:function(dt,Ct){var Ut=this,Vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(zt,Qt){Ut.fetchWebSessionInformation(Ct).then(function(Zt){return Vt.token=Ct.token,es.pushConversationMedia(Zt.conversationId,dt,Vr.getActiveApiKey(),Vt)}).then(function(Zt){Vr.sendData(Ut.getId(),{event:tt.g.CONTACT_NEW_MEDIA_IDENTIFIER,media:{url:Zt.url,id:Zt.id}}),zt({url:Zt.url,id:Zt.id})}).catch(function(Zt){Qt(Wt.g.createError(tt.g.ERROR_OTHER,"pushMedia() - failed to push media",rr))})})}},{key:"fetchMediaList",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return rr.debug("fetchMediaList()"),new Promise(function(Vt,zt){Ct.fetchWebSessionInformation(dt).then(function(Qt){return Ut.token=dt.getToken(),es.getConversationMediaList(Qt.conversationId,Vr.getActiveApiKey(),Ut)}).then(Vt).catch(function(Qt){zt(Wt.g.createError(tt.g.ERROR_OTHER,"getMediaList() - failed to get media list",rr))})})}},{key:"sendEventCenterDataRequest",value:function(){return this.sendCustomEvent(tt.g.CONTACT_EVENTCENTER_DATA_REQUEST)}},{key:"getContact",value:function(dt){return Br.getActiveSession().getOrCreateContact(dt)}},{key:"sendToContactRemoteStreamError",value:function(dt,Ct,Ut){rr.debug("sendToContactRemoteStreamError",dt,Ct,Ut),Ct.sendCustomEvent(tt.g.CONTACT_GET_REMOTE_ERROR,{callId:Ut.callId,streamId:Ut.streamId,timeout:Ut.timeout,message:dt})}},{key:"sendRemoteAccessInvitation",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,zt){if(Ct.isOnline()||rr.warn("sendRemoteAccessInvitation() - contact "+Ct.getUsername()+" does not seem to be connected."),apiRTC.session.remoteAccessInvitation!==null)return rr.warn("sendRemoteAccessInvitation() already ongoing"),zt(new Error("sendRemoteAccessInvitation() already ongoing"));var Qt=new jp(Ct,dt,Ut);apiRTC.session.remoteAccessInvitation=Qt,Qt.type=tt.g.CONTACT_REMOTEACCESS_INVITATION_IDENTIFIER;var Zt={event:tt.g.CONTACT_REMOTEACCESS_INVITATION_IDENTIFIER,invitationId:Qt.id,roomname:Qt.conversation._getTechnicalName(),sendTime:Qt.sendTime};Qt.send(Zt).then(function(){Vt(Qt)}).catch(function(on){return rr.error("Contact#sendRemoteAccessInvitation send error:",on),zt(new Error(on))})})}}],Ot=[{key:"getAvailableEvents",value:function(){return Bp}}],Xt&&_u(Lt.prototype,Xt),Ot&&_u(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(fn);function Hl($t){return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Hl($t)}function Vp($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function Gl($t,Lt){return Gl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},Gl($t,Lt)}function zp($t,Lt){if(Lt&&(Hl(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}($t)}function _s($t){return _s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},_s($t)}var ho=mt.Y.get("ConversationCall"),Fr=wn.get(),Kl=function($t){(function(Jt,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Super expression must either be null or a function");Jt.prototype=Object.create(dt&&dt.prototype,{constructor:{value:Jt,writable:!0,configurable:!0}}),Object.defineProperty(Jt,"prototype",{writable:!1}),dt&&Gl(Jt,dt)})(ln,$t);var Lt,Xt,Ot,Ft,sn=(Ot=ln,Ft=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var Jt,dt=_s(Ot);if(Ft){var Ct=_s(this).constructor;Jt=Reflect.construct(dt,arguments,Ct)}else Jt=dt.apply(this,arguments);return zp(this,Jt)});function ln(Jt,dt,Ct){var Ut;return function(Vt,zt){if(!(Vt instanceof zt))throw new TypeError("Cannot call a class as a function")}(this,ln),(Ut=sn.call(this,ho)).conversation=Jt,Ut.callId=dt,Ut.stream=Ct,Ut}return Lt=ln,Xt=[{key:"getConversation",value:function(){return this.conversation}},{key:"getCallId",value:function(){return this.callId}},{key:"getStream",value:function(){return this.stream}},{key:"isRecorded",value:function(){return!!this.recordingStatus}},{key:"getRecordingInfo",value:function(){return this.isRecorded()?this.recordingStatus:null}},{key:"isStreamed",value:function(){return!!this.streamingStatus}},{key:"getStreamingInfo",value:function(){return this.isStreamed()?this.streamingStatus:null}},{key:"startRecordingPublishedStream",value:function(Jt){var dt=this;return Jt||(Jt={}),new Promise(function(Ct,Ut){if(dt.asyncCallbacks)return Ut(Wt.g.createError(tt.g.ERROR_OTHER,"startRecordingPublishedStream() - busy",ho));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return dt.asyncCallbacks&&(Fr.removeEventListener("error",dt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),delete dt.asyncCallbacks),Ut(Wt.g.createError(tt.g.ERROR_OTHER,"startRecordingPublishedStream() - timeout",ho))},tt.g.CONVERSATION_RECORDING_STARTED_DELAY),dt.asyncCallbacks.error=function(Zt){if(String(Zt.detail.convId)===dt.conversation.getCloudConversationId()&&Zt.detail.callId===dt.callId&&Zt.detail.errorCode.indexOf("START_RECORD")>=0)return dt.asyncCallbacks&&(Fr.removeEventListener("error",dt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Ut(Wt.g.createError(tt.g.ERROR_OTHER,"startRecordingPublishedStream() - "+Zt.detail.errorInfo,ho))},dt.asyncCallbacks.recordingStarted=function(Zt){if(String(Zt.detail.convId)===dt.conversation.getCloudConversationId()&&Zt.detail.callId===dt.callId){dt.asyncCallbacks&&(Fr.removeEventListener("error",dt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStarted",dt.asyncCallbacks.recordingStarted),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks);var on=Wt.g.parseRecordingEvent("MCURecordingStarted",Zt.detail);return Ct(on)}},Fr.onEvent("error",dt.asyncCallbacks.error),Fr.onEvent("MCURecordingStarted",dt.asyncCallbacks.recordingStarted);var Vt="AUDIO-VIDEO";Jt.audioOnly===!0?Vt="AUDIO-ONLY":Jt.videoOnly===!0&&(Vt="VIDEO-ONLY");var zt="userStream";Wt.g.isPropertyTypeof(Jt,"customIdInFilename","string")&&(zt=Jt.customIdInFilename);var Qt={};Wt.g.isPropertyTypeof(Jt,"data","object")&&(Qt=Object.assign({},Jt.data)),Wt.g.isPropertyTypeof(Jt,"ttl","number")&&Jt.ttl>0&&(Qt.ttl=Jt.ttl),Fr.webRTCClient.startRecording(Vt,zt,dt.conversation.getCloudConversationId(),dt.callId,Qt)})}},{key:"stopRecordingPublishedStream",value:function(){var Jt=this;return new Promise(function(dt,Ct){if(Jt.asyncCallbacks)return Ct(Wt.g.createError(tt.g.ERROR_OTHER,"stopRecordingPublishedStream() - busy",ho));Jt.asyncCallbacks={},Jt.asyncCallbacks.timeoutId=setTimeout(function(){return Jt.asyncCallbacks&&(Fr.removeEventListener("error",Jt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStopped",Jt.asyncCallbacks.recordingStopped),delete Jt.asyncCallbacks),dt(Jt.recordingStatus)},tt.g.CONVERSATION_RECORDING_STOPPED_DELAY),Jt.asyncCallbacks.error=function(Ut){if(String(Ut.detail.convId)===Jt.conversation.getCloudConversationId()&&Ut.detail.callId===Jt.callId&&Ut.detail.errorCode.indexOf("STOP_RECORD")>=0)return Jt.asyncCallbacks&&(Fr.removeEventListener("error",Jt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStopped",Jt.asyncCallbacks.recordingStopped),clearTimeout(Jt.asyncCallbacks.timeoutId),delete Jt.asyncCallbacks),Ct(Wt.g.createError(tt.g.ERROR_OTHER,"stopRecordingPublishedStream() - "+Ut.detail.errorInfo,ho))},Jt.asyncCallbacks.recordingStopped=function(Ut){if(String(Ut.detail.convId)===Jt.conversation.getCloudConversationId()&&Ut.detail.callId===Jt.callId){Jt.asyncCallbacks&&(Fr.removeEventListener("error",Jt.asyncCallbacks.error),Fr.removeEventListener("MCURecordingStopped",Jt.asyncCallbacks.recordingStopped),clearTimeout(Jt.asyncCallbacks.timeoutId),delete Jt.asyncCallbacks);var Vt=Wt.g.parseRecordingEvent("MCURecordingStopped",Ut.detail);return dt(Vt)}},Fr.onEvent("error",Jt.asyncCallbacks.error),Fr.onEvent("MCURecordingStopped",Jt.asyncCallbacks.recordingStopped),Fr.webRTCClient.stopRecording(Jt.callId)})}},{key:"replacePublishedStream",value:function(Jt,dt){var Ct=this;return new Promise(function(Ut,Vt){if(Jt===null){if(!Wt.g.isPropertyTypeof(dt,"getStream","function"))return Vt(new Error("replacePublishedStream() - Cannot replace stream, wrong arguments"));Ct.stream.publishedInConversations.delete(Ct.conversation.getName()),Ct.conversation.conversationPublishedStreams.delete(Ct.stream.userMediaStreamId);var zt={getUserMediaStreamId:function(){return dt.getStream().then(function(Zt){Ct.stream=Zt,Zt.publishedInConversations.set(Ct.conversation.getName(),Ct.callId),Ct.conversation.callIdToStreamId.set(Ct.callId,Zt.userMediaStreamId);var on={contact:null,isRemote:!1,hasAudio:Zt.hasAudio(),hasVideo:Zt.hasVideo(),isScreensharing:Zt.isScreensharing(),streamId:Zt.userMediaStreamId,callId:Ct.callId};return Ct.conversation.conversationPublishedStreams.set(Zt.userMediaStreamId,on),Zt.userMediaStreamId}).catch(Vt)}};Fr.webRTCClient.webRTCClient.addMedia(Ct.callId,!0,null,zt).then(function(Zt){return Ut(function(on){if(yo.has(on))return yo.get(on);var bn=apiCC.getUserMediaStream(on);if(bn){var Rn="audio";return bn.video===!0&&(Rn="video"),new so(bn.stream,{type:Rn,constructor:!0,userMediaStreamId:bn.userMediaStreamId})}return null}(Zt))}).catch(function(Zt){return Vt(new Error("replacePublishedStream() - "+Zt))})}else{Ct.stream.publishedInConversations.delete(Ct.conversation.getName()),Ct.conversation.conversationPublishedStreams.delete(Ct.stream.userMediaStreamId),Fr.webRTCClient.webRTCClient.addMedia(Ct.callId,!0,Jt.userMediaStreamId).then(function(Zt){return Ut(Jt)}).catch(function(Zt){return Vt(new Error("replacePublishedStream() - "+Zt))}),Ct.stream=Jt,Jt.publishedInConversations.set(Ct.conversation.getName(),Ct.callId),Ct.conversation.callIdToStreamId.set(Ct.callId,Jt.userMediaStreamId);var Qt={contact:null,isRemote:!1,hasAudio:Jt.hasAudio(),hasVideo:Jt.hasVideo(),isScreensharing:Jt.isScreensharing(),streamId:Jt.userMediaStreamId,callId:Ct.callId};Ct.conversation.conversationPublishedStreams.set(Jt.userMediaStreamId,Qt)}})}},{key:"startStreaming",value:function(){var Jt=this,dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(Ct,Ut){return Jt.asyncCallbacks?Ut(Wt.g.createError(tt.g.ERROR_OTHER,"startStreaming() - busy",ho)):Fr.webRTCClient.startStreaming(dt.service,dt.server,dt.streamKey,Jt.callId)?(Jt.asyncCallbacks={},Jt.asyncCallbacks.timeoutId=setTimeout(function(){return Jt.asyncCallbacks&&(Fr.removeEventListener("MCUStreamingStarted",Jt.asyncCallbacks.streamingStarted),delete Jt.asyncCallbacks),Ut(Wt.g.createError(tt.g.ERROR_OTHER,"startStreaming() - timeout",ho))},tt.g.CONVERSATION_STREAMING_STARTED_DELAY),Jt.asyncCallbacks.streamingStarted=function(Vt){if(Vt.detail.roomName===Jt.conversation._getTechnicalName()&&Vt.detail.callId===Jt.callId){Jt.asyncCallbacks&&(Fr.removeEventListener("MCUStreamingStarted",Jt.asyncCallbacks.streamingStarted),clearTimeout(Jt.asyncCallbacks.timeoutId),delete Jt.asyncCallbacks);var zt=Fs("MCUStreamingStarted",Vt.detail);return Ct(zt)}},void Fr.onEvent("MCUStreamingStarted",Jt.asyncCallbacks.streamingStarted)):Ut(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"startStreaming() - cannot start streaming",ho))})}},{key:"stopStreaming",value:function(){var Jt=this;return new Promise(function(dt,Ct){return Jt.asyncCallbacks?Ct(Wt.g.createError(tt.g.ERROR_OTHER,"stopStreaming() - busy",ho)):Fr.webRTCClient.stopStreaming(Jt.callId)?(Jt.asyncCallbacks={},Jt.asyncCallbacks.timeoutId=setTimeout(function(){return Jt.asyncCallbacks&&(Fr.removeEventListener("MCUStreamingStopped",Jt.asyncCallbacks.streamingStopped),delete Jt.asyncCallbacks),Ct(Wt.g.createError(tt.g.ERROR_OTHER,"stopStreaming() - timeout",ho))},tt.g.CONVERSATION_STREAMING_STOPPED_DELAY),Jt.asyncCallbacks.streamingStopped=function(Ut){if(Ut.detail.roomName===Jt.conversation._getTechnicalName()&&Ut.detail.callId===Jt.callId){Jt.asyncCallbacks&&(Fr.removeEventListener("MCUStreamingStopped",Jt.asyncCallbacks.streamingStopped),clearTimeout(Jt.asyncCallbacks.timeoutId),delete Jt.asyncCallbacks);var Vt=Fs("MCUStreamingStopped",Ut.detail);return dt(Vt)}},void Fr.onEvent("MCUStreamingStopped",Jt.asyncCallbacks.streamingStopped)):Ct(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"stopStreaming() - cannot stop streaming",ho))})}},{key:"changeStreamPriority",value:function(Jt){var dt=this;return new Promise(function(Ct,Ut){return Fr.webRTCClient.changeStreamPriority(dt.callId,Jt)?(dt.conversation.changeStreamPriority(dt.stream.userMediaStreamId,!1,Jt),Ct()):Ut(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"changeStreamPriority() - cannot change stream priority",ho))})}},{key:"updatePublishedStream",value:function(Jt,dt){var Ct=this;return new Promise(function(Ut,Vt){if(Jt!=="audio"&&Jt!=="video")return Vt(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"updatePublishedStream() - wrong type",ho));var zt=dt?"sendonly":"inactive";return Fr.webRTCClient.webRTCClient.processUpdateStream(Ct.callId,Jt,zt)?Ut():Vt(Wt.g.createError(tt.g.ERROR_OTHER,"updatePublishedStream() - cannot update",ho))})}}],Xt&&Vp(Lt.prototype,Xt),Object.defineProperty(Lt,"prototype",{writable:!1}),ln}(fn);function Uo($t,Lt){var Xt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Xt){if(Array.isArray($t)||(Xt=function(dt,Ct){if(dt){if(typeof dt=="string")return Du(dt,Ct);var Ut=Object.prototype.toString.call(dt).slice(8,-1);return Ut==="Object"&&dt.constructor&&(Ut=dt.constructor.name),Ut==="Map"||Ut==="Set"?Array.from(dt):Ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ut)?Du(dt,Ct):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Xt&&($t=Xt);var Ot=0,Ft=function(){};return{s:Ft,n:function(){return Ot>=$t.length?{done:!0}:{done:!1,value:$t[Ot++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Jt=!1;return{s:function(){Xt=Xt.call($t)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Jt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Jt)throw sn}}}}function Du($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Xt=0,Ot=new Array(Lt);Xt<Lt;Xt++)Ot[Xt]=$t[Xt];return Ot}function Nu($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}var no=mt.Y.get("ContactCatalog"),go=null,xo={},bo={leftGroup:{},joinedGroup:{},userDataChanged:[]},Ro=function(){function $t(){if(function(sn,ln){if(!(sn instanceof ln))throw new TypeError("Cannot call a class as a function")}(this,$t),go!==null)throw"Cannot construct singleton ContactCatalog";this.contactList=new Map,this.eventEmitter=new pt,go=this;var Ft=wn.get();Ft.onEvent("connectedUsersListUpdate",function(sn){var ln=apiRTC.session.apiCCId.toString(),Jt={};switch(sn.detail.updateReason){case"newConnectionState":if(sn.detail.status==="online"){no.debug("new connection");var dt,Ct=Uo(sn.detail.usersList);try{for(Ct.s();!(dt=Ct.n()).done;)(Jt={userId:dt.value,group:sn.detail.group}).userId.toString()!==ln&&Gp(Jt)}catch(bn){Ct.e(bn)}finally{Ct.f()}}else{no.debug("new disconnection");var Ut,Vt=Uo(sn.detail.usersList);try{for(Vt.s();!(Ut=Vt.n()).done;)Jt={userId:Ut.value,group:sn.detail.group},xo[Jt.group]===void 0&&(xo[Jt.group]={}),Jt.userId.toString()!==ln&&(xo[Jt.group][Jt.userId.toString()]=setTimeout(Hp(Jt),Ft.contactDisconnectionDelay))}catch(bn){Vt.e(bn)}finally{Vt.f()}}break;case"userDataUpdate":no.debug("userDataUpdate");var zt,Qt=Uo(sn.detail.usersList);try{for(Qt.s();!(zt=Qt.n()).done;)(Jt={userId:zt.value,group:sn.detail.group}).userId.toString()!==ln&&Uu(Jt)}catch(bn){Qt.e(bn)}finally{Qt.f()}break;case"callState":no.debug("callState change for user");var Zt,on=Uo(sn.detail.usersList);try{for(on.s();!(Zt=on.n()).done;)(Jt={userId:Zt.value,group:sn.detail.group}).userId.toString()!==ln&&Uu(Jt)}catch(bn){on.e(bn)}finally{on.f()}break;default:no.warn("default case for updateReason value")}}).onEvent("groupUnsubscribed",function(sn){var ln,Jt=go.getContacts(sn),dt=Uo(Jt.keys());try{for(dt.s();!(ln=dt.n()).done;){var Ct=ln.value;Jt.get(Ct).removeFromGroup(sn)}}catch(Ut){dt.e(Ut)}finally{dt.f()}})}var Lt,Xt,Ot;return Lt=$t,Xt=[{key:"onUpdate",value:function(Ft){this.eventEmitter.on("update",Ft)}},{key:"removeUpdateListener",value:function(Ft){this.eventEmitter.off("update",Ft)}},{key:"getContact",value:function(Ft){return Ft!=null&&this.contactList.has(Ft.toString())?this.contactList.get(Ft.toString()):null}},{key:"getOrCreateContact",value:function(Ft){var sn=null;if(Ft!=null)if(this.contactList.has(Ft.toString()))sn=this.contactList.get(Ft.toString());else try{sn=new No(Ft.toString(),{}),this.contactList.set(Ft.toString(),sn)}catch(ln){no.debug("Contact not added : "+ln)}return sn}},{key:"getContacts",value:function(Ft){if(Ft==null)return this.contactList;var sn,ln=new Map,Jt=Uo(this.contactList.keys());try{for(Jt.s();!(sn=Jt.n()).done;){var dt=sn.value;this.contactList.get(dt).inGroup(Ft)&&ln.set(dt,this.contactList.get(dt))}}catch(Ct){Jt.e(Ct)}finally{Jt.f()}return ln}},{key:"getOnlineContacts",value:function(Ft){var sn=new Map;if(Ft==null){var ln,Jt=Uo(this.contactList.keys());try{for(Jt.s();!(ln=Jt.n()).done;){var dt=ln.value;this.contactList.get(dt).isOnline()&&sn.set(dt,this.contactList.get(dt))}}catch(zt){Jt.e(zt)}finally{Jt.f()}}else{var Ct,Ut=Uo(this.contactList.keys());try{for(Ut.s();!(Ct=Ut.n()).done;){var Vt=Ct.value;this.contactList.get(Vt).inGroup(Ft)&&this.contactList.get(Vt).isOnline()&&sn.set(Vt,this.contactList.get(Vt))}}catch(zt){Ut.e(zt)}finally{Ut.f()}}return sn}}],Ot=[{key:"get",value:function(){return go===null&&(go=new $t),go}}],Xt&&Nu(Lt.prototype,Xt),Ot&&Nu(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function Hp($t){return function(){var Lt=$t.userId.toString();if(no.info("Contact disconnected "+Lt+" from "+$t.group),go.contactList.has(Lt)){var Xt=go.contactList.get(Lt);if(Xt===void 0)return void no.debug("Contact not exist with userId :",Lt);Xt.removeFromGroup($t.group),function(Ot,Ft){no.debug("updateContactListOnUserDisconnect()"),bo.leftGroup[Ot]===void 0&&(bo.leftGroup[Ot]=[]),bo.leftGroup[Ot].push(Ft),Jl()}($t.group,Xt),xo[$t.group]!==void 0&&xo[$t.group][Lt]!==void 0&&delete xo[$t.group][Lt]}}}function Jl(){Object.keys(bo.leftGroup).length===0&&Object.keys(bo.joinedGroup).length===0&&bo.userDataChanged.length===0||(go.eventEmitter.emit("update",bo),bo={leftGroup:{},joinedGroup:{},userDataChanged:[]})}function Gp($t){no.debug("updateContactListOnUserConnection()");var Lt=$t.userId.toString(),Xt=null,Ot=apiRTC.session.getConnectedUserInfo(Lt,"userData");no.debug("userData :",Ot);try{$t.userData=JSON.parse(Ot)}catch(Ft){no.warn("userData parse error : "+Ft)}if(go.contactList.has(Lt))Xt=go.contactList.get($t.userId),Io.equals(Xt.userData,$t.userData)||(Xt.userData=new Io($t.userData),bo.userDataChanged.push(Xt));else{try{Xt=new No(Lt,$t.userData),go.contactList.set(Lt,Xt)}catch(Ft){no.debug("Contact not added : "+Ft)}Xt=go.contactList.get(Lt)}Xt!==void 0?(xo[$t.group]!==void 0&&xo[$t.group][Lt]!==void 0&&(clearTimeout(xo[$t.group][Lt]),delete xo[$t.group][Lt]),Xt.inGroup($t.group)||(Xt.addToGroup($t.group),bo.joinedGroup[$t.group]===void 0&&(bo.joinedGroup[$t.group]=[]),bo.joinedGroup[$t.group].push(Xt)),Jl()):no.debug("Contact not exist with userId :",Lt)}function Uu($t){no.debug("updateContactListOnUserDataUpdate()");var Lt=$t.userId.toString(),Xt=go.contactList.get($t.userId);if(Xt!==void 0){var Ot=apiRTC.session.getConnectedUserInfo(Lt,"userData");no.debug("userData :",Ot);try{$t.userData=JSON.parse(Ot)}catch(Ft){no.warn("userData parse error : "+Ft)}Io.equals(Xt.userData,$t.userData)||(Xt.userData=new Io($t.userData),bo.userDataChanged.push(Xt)),Jl()}else no.debug("Contact not exist with userId :",Lt)}function Ps($t){return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},Ps($t)}function co($t,Lt){var Xt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Xt){if(Array.isArray($t)||(Xt=function(dt,Ct){if(dt){if(typeof dt=="string")return Lu(dt,Ct);var Ut=Object.prototype.toString.call(dt).slice(8,-1);return Ut==="Object"&&dt.constructor&&(Ut=dt.constructor.name),Ut==="Map"||Ut==="Set"?Array.from(dt):Ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ut)?Lu(dt,Ct):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Xt&&($t=Xt);var Ot=0,Ft=function(){};return{s:Ft,n:function(){return Ot>=$t.length?{done:!0}:{done:!1,value:$t[Ot++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Jt=!1;return{s:function(){Xt=Xt.call($t)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Jt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Jt)throw sn}}}}function Lu($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Xt=0,Ot=new Array(Lt);Xt<Lt;Xt++)Ot[Xt]=$t[Xt];return Ot}function qp($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function $u($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function Yl($t,Lt){return Yl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},Yl($t,Lt)}function Kp($t,Lt){if(Lt&&(Ps(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ur($t)}function ur($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Ds($t){return Ds=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Ds($t)}var Ln=mt.Y.get("Conversation"),Kn=wn.get(),wo=new(Go()),ro=Ro.get(),Jp=["adaptationTriggered","audioAmplitude","availableStreamsUpdated","bandwidthLimited","callStatsUpdate","compositeListChanged","contactJoined","contactJoinedWaitingRoom","contactLeft","contactLeftWaitingRoom","cpuLimited","customEvent","data","disconnectionWarning","entryAllowed","entryDenied","error","hangup","joined","left","localStreamUpdated","message","messageNotDelivered","moderatorConnected","newMediaAvailable","newWhiteboardSession","participantEjected","persistentDataUpdated","pointerLocationChanged","pointerSharingEnabled","recordingAvailable","recordingStarted","recordingStopped","remoteStreamUpdated","replayListChanged","roomModeChanged","simulcastFeedChanged","slowLink","streamAdded","streamListChanged","streamRemoved","streamingStarted","streamingStopped","transferPending","transferBegun","transferEnded","transferProgress","whiteboardRoomMemberUpdate","videoQualityChanged","waitingForModeratorAcceptance"],ju=new Set(["CHAT","CALL","GROUP_CHAT","WEBCONF","REPORT","REPORT_PART","TICKET","EVENT","OTHER","BOT"]),Yp=new Set(["audioSent","videoSent","audioReceived","videoReceived","quality"]),Xp=new Set(["CALL_ABORTED","SET_LOCAL_DESCRIPTION_FAILURE","SET_REMOTE_DESCRIPTION_FAILURE"]),ts=new WeakMap,ns=new WeakMap,qo=new WeakMap,Po=new WeakMap,Ns=new WeakMap,Us=new WeakMap,Mo=new WeakMap,Eo=new WeakMap,Xl=new WeakMap,Ql=new WeakMap,Ls=new WeakMap,$s=new WeakMap,js=new WeakMap,jo=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&Yl(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=Ds(Ft);if(sn){var Ut=Ds(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return Kp(this,dt)});function Jt(dt){var Ct,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};qp(this,Jt),Ct=ln.call(this,Ln),Ln.debug("Create Conversation"),dt==null?ts.set(ur(Ct),Wt.g.guid().toString()):ts.set(ur(Ct),dt.toString()),ns.set(ur(Ct),"OTHER"),Ct.active=!Object.prototype.hasOwnProperty.call(Ut,"active")||typeof Ut.active!="boolean"||Ut.active,Ct.meshModeEnabled=Ut.meshModeEnabled===!0,Ct.meshOnlyEnabled=Ut.meshOnlyEnabled===!0,Ct.moderationEnabled=Ut.moderationEnabled===!0,Ct.moderator=Ut.moderator===!0,Ct.conversationCalls=new Map,Ct.callIdToStreamId=new Map,Ct.token=null,Ct.sessionId=null,Ct.webconfId=null,Ct.conversationStreams=new Map,Ct.conversationPublishedStreams=new Map,Ct.groupChatStatus=tt.g.CONVERSATION_STATUS_NOT_JOINED,Ct.status=tt.g.CONVERSATION_STATUS_NOT_JOINED,Ct.whiteboardStarted=tt.g.CONVERSATION_WHITEBOARD_NOT_STARTED,Ct.pointerSharingState=tt.g.STATE_IDLE,Ct.pointerSharingAutoInvite=!1,Ct.pgroupWaitingRoomSubscribedTo=!1,Ns.set(ur(Ct),null),Us.set(ur(Ct),null),Mo.set(ur(Ct),new Map),Po.set(ur(Ct),null),Eo.set(ur(Ct),null),qo.set(ur(Ct),{}),Ls.set(ur(Ct),new Map),js.set(ur(Ct),null),$s.set(ur(Ct),null),Ct.transferCallIds=[],Ct.uploadCap=null,Ct.downloadCap=null,Ct.reservedStreams=[];var Vt={contactCatalog:{}};for(var zt in Vt.contactCatalog.onUpdate=function(Zt){Ln.debug("onUpdate: contactList",Zt);var on=Ct._getTechnicalName();if(Zt.joinedGroup[on]!==void 0){var bn,Rn=co(Zt.joinedGroup[on]);try{for(Rn.s();!(bn=Rn.n()).done;){var qn=bn.value;Ln.debug(qn.getUsername()+" joined conversation "+Ct.getName()),tn.get(ur(Ct)).emit("contactJoined",qn),Ct.pointerSharingState===tt.g.STATE_ACTIVE&&Ct.pointerSharingAutoInvite===!0&&Kn.pointerSharingClient.inviteInRoom(on,qn.getId())}}catch(er){Rn.e(er)}finally{Rn.f()}}else Ln.debug("not an event joinedGroup for conversation");if(Zt.leftGroup[on]!==void 0){var Jn,dr=co(Zt.leftGroup[on]);try{for(dr.s();!(Jn=dr.n()).done;){var hr=Jn.value;Ln.debug(hr.getUsername()+" left conversation "+Ct.getName()),tn.get(ur(Ct)).emit("contactLeft",hr)}}catch(er){dr.e(er)}finally{dr.f()}}else Ln.debug("not an event leftGroup for conversation");if(Ct.getRole()===tt.g.CONVERSATION_ROLE_MODERATOR){var Ar,Xr=ro.getContacts(tt.g.CONVERSATION_WAITING_ROOM_PREFIX+on),_i=co(Ls.get(ur(Ct)).keys());try{for(_i.s();!(Ar=_i.n()).done;){var Vo=Ar.value;if(!Xr.has(Vo)){var lr=ro.getContact(Vo);lr!==null&&(Ln.debug(lr.getUsername()+" left waiting room "+Ct.getName()),tn.get(ur(Ct)).emit("contactLeftWaitingRoom",lr))}}}catch(er){_i.e(er)}finally{_i.f()}Xr.forEach(function(er,Tr){Ls.get(ur(Ct)).has(Tr)||er===null||(Ln.debug(er.getUsername()+" joined waiting room "+Ct.getName()),tn.get(ur(Ct)).emit("contactJoinedWaitingRoom",er),Kn.sendData(Tr,{event:tt.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER,command:"conversationModeratorConnected",roomname:on}).catch(function(kr){var br=Wt.g.createError(kr,"Notification not delivered",Ln);tn.get(ur(Ct)).emit("messageNotDelivered",{error:br,contact:er,event:tt.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER,command:"conversationModeratorConnected"})}))}),Ls.set(ur(Ct),Xr)}},ro.onUpdate(Vt.contactCatalog.onUpdate),tn.get(ur(Ct)).on("contactJoined",function(Zt){Ct.getRole()===tt.g.CONVERSATION_ROLE_MODERATOR&&Kn.sendData(Zt.getId(),{event:tt.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER,command:"conversationModeratorConnected",roomname:Ct._getTechnicalName()}).catch(function(on){var bn=Wt.g.createError(on,"Notification not delivered",Ln);tn.get(ur(Ct)).emit("messageNotDelivered",{error:bn,contact:Zt,event:tt.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER,command:"conversationModeratorConnected"})})}),Vt.apiRTCManager={},Vt.apiRTCManager.receiveData=function(Zt){var on=Zt.detail.data;if(on!==void 0){if(on.roomname===Ct._getTechnicalName()){var bn=ro.getOrCreateContact(Zt.detail.senderId);if(on.event)switch(on.event){case tt.g.CONVERSATION_SEND_DATA_IDENTIFIER:if(Ct.status!==tt.g.CONVERSATION_STATUS_JOINED)break;tn.get(ur(Ct)).emit("data",{sender:bn,content:on.content});break;case tt.g.CONVERSATION_NEW_MEDIA_IDENTIFIER:if(Ct.status!==tt.g.CONVERSATION_STATUS_JOINED)break;Ln.info("New media available in conversation",on.media),tn.get(ur(Ct)).emit("newMediaAvailable",{sender:bn,media:on.media});break;case tt.g.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER:if(Ct.status!==tt.g.CONVERSATION_STATUS_JOINED)break;Ct.updateData();break;case tt.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER:tn.get(ur(Ct)).emit("moderatorConnected",bn);break;case tt.g.CONVERSATION_CLOSED_IDENTIFIER:on.instanceId===Ct.getInstanceId()&&(Ln.info("Conference "+Ct.getName()+" has been closed..."),tn.get(ur(Ct)).emit("closed"),Ct.leave());break;case tt.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER:if(on.access===void 0||on.access===null){Ln.error("Conversation join answer has no access data");break}tn.get(ur(Ct)).emit(on.access?"entryAllowed":"entryDenied");break;default:tn.get(ur(Ct)).emit("customEvent",{event:on.event,content:on,sender:bn})}else if(on.command==="new_snapshot"){if(Ct.status!==tt.g.CONVERSATION_STATUS_JOINED)return;Ln.info("New media available in conversation",on.value.snapshot),tn.get(ur(Ct)).emit("newMediaAvailable",{sender:bn,media:on.value.snapshot})}else Ln.debug("Unprocessed conversation message",on)}}else Ln.debug("Received data undefined, leaving process")},Vt.apiRTCManager.receiveGroupChatMessage=function(Zt){if((Ct.status===tt.g.CONVERSATION_STATUS_JOINED||Ct.groupChatStatus===tt.g.CONVERSATION_STATUS_JOINED)&&Zt.detail.groupChatId.toString()===Ct._getTechnicalName()){var on={sender:ro.getOrCreateContact(Zt.detail.senderId),sender_id:Zt.detail.senderId,content:Zt.detail.message,time:new Date};Wt.g.isTypeof(Zt.detail,"metadata","object")&&(on.metadata=Zt.detail.metadata),tn.get(ur(Ct)).emit("message",on)}},Vt.apiRTCManager.receiveRoomMessage=function(Zt){if(Zt.detail.roomType==="pointerSharing"&&Ct.pointerSharingState===tt.g.STATE_ACTIVE&&Zt.detail.message.type==="pointerLocation"&&Zt.detail.roomId===Ct._getTechnicalName()){var on={sender:ro.getOrCreateContact(Zt.detail.senderId),source:Zt.detail.message.source,x:Zt.detail.message.x,y:Zt.detail.message.y};Wt.g.isPropertyTypeof(Zt.detail.message,"data","object")&&(on.data=Zt.detail.message.data),tn.get(ur(Ct)).emit("pointerLocationChanged",on)}},Vt.apiRTCManager.roomInvitation=function(Zt){if(Ln.info("roomInvitation event handler ",Zt),Zt.detail.roomId.toString()===Ct._getTechnicalName())if(Ln.info("roomInvitation for actual conversation",Zt),Zt.detail.roomType==="whiteBoard"){if(Ct.status===tt.g.CONVERSATION_STATUS_JOINED){var on=ro.getOrCreateContact(Zt.detail.senderId);tn.get(ur(Ct)).emit("newWhiteboardSession",{sender:on})}}else Zt.detail.roomType==="pointerSharing"&&Zl(ur(Ct),!1,!0).then(function(){}).catch(function(bn){})},Vt.apiRTCManager.onFilePending=function(Zt){if(Ct.transferCallIds.includes(Zt.detail.callId)){var on={id:Zt.detail.callId,name:Zt.detail.name,rank:Zt.detail.rank};tn.get(ur(Ct)).emit("transferPending",on)}},Vt.apiRTCManager.onFileSending=function(Zt){if(Ct.transferCallIds.includes(Zt.detail.callId)){var on={id:Zt.detail.callId,name:Zt.detail.name};tn.get(ur(Ct)).emit("transferBegun",on)}},Vt.apiRTCManager.onFileProgress=function(Zt){if(Ct.transferCallIds.includes(Zt.detail.callId)){var on={id:Zt.detail.callId,name:Zt.detail.name,size:Zt.detail.fileSize,remBytes:Zt.detail.remainingSize,percentage:Zt.detail.percentage};tn.get(ur(Ct)).emit("transferProgress",on)}},Vt.apiRTCManager.onFileSended=function(Zt){var on=Ct.transferCallIds.indexOf(Zt.detail.callId);if(on>=0){var bn={id:Zt.detail.callId,name:Zt.detail.name};Zt.detail.error&&(bn.error=Zt.detail.error),tn.get(ur(Ct)).emit("transferEnded",bn),Ct.transferCallIds.splice(on,1)}},Vt.apiRTCManager)Kn.onEvent(zt,Vt.apiRTCManager[zt]);Xl.set(ur(Ct),Vt);var Qt={MCUAvailableStream:function(Zt){var on,bn=co(Zt.detail.streams);try{for(bn.s();!(on=bn.n()).done;){var Rn=on.value;if(Rn.room===Ct._getTechnicalName()){var qn={contact:ro.getOrCreateContact(Rn.attributes.callerId),isRemote:Zt.detail.isRemoteStream,hasAudio:Rn.audio,hasVideo:Rn.video,isAudioMuted:Rn.audioMuted,isVideoMuted:Rn.videoMuted,isScreensharing:Rn.attributes.callType==="screenSharing"||Rn.attributes.callType==="screenSharingWithAudio",isSIP:Rn.sip===!0,isSimulcast:Rn.simulcast===!0,streamId:Rn.id,type:"regular",callId:Rn.attributes.callId,descriptor:Rn.attributes.descriptor,context:Rn.context};Ct.conversationStreams.set(qn.streamId,qn);var Jn={listEventType:"added"};Wt.g.assignObject(Jn,qn),tn.get(ur(Ct)).emit("streamListChanged",Jn)}}}catch(_i){bn.e(_i)}finally{bn.f()}Ln.debug("Nb stream into conversation :"+Ct.conversationStreams.size);var dr,hr={},Ar=co(Ct.conversationStreams.keys());try{for(Ar.s();!(dr=Ar.n()).done;){var Xr=dr.value;hr[Xr]=Ct.conversationStreams.get(Xr)}}catch(_i){Ar.e(_i)}finally{Ar.f()}tn.get(ur(Ct)).emit("availableStreamsUpdated",hr)},MCUAvailableStreamUpdate:function(Zt){var on,bn=co(Zt.detail.streams);try{for(bn.s();!(on=bn.n()).done;){var Rn=on.value;if(Rn.room===Ct._getTechnicalName()){var qn=Ct.conversationStreams.get(Rn.id);if(qn&&qn.type==="regular"){qn.hasAudio=Rn.audio,qn.hasVideo=Rn.video,qn.isAudioMuted=Rn.audioMuted,qn.isVideoMuted=Rn.videoMuted,qn.descriptor=Rn.attributes.descriptor;var Jn={listEventType:"updated"};Wt.g.assignObject(Jn,qn),tn.get(ur(Ct)).emit("streamListChanged",Jn),qn.descriptor&&Object.prototype.hasOwnProperty.call(qn.descriptor,"priority")&&Ct.changeStreamPriority(qn.streamId,!0,qn.descriptor.priority)}}}}catch(_i){bn.e(_i)}finally{bn.f()}Ln.debug("Nb stream into conversation :"+Ct.conversationStreams.size);var dr,hr={},Ar=co(Ct.conversationStreams.keys());try{for(Ar.s();!(dr=Ar.n()).done;){var Xr=dr.value;hr[Xr]=Ct.conversationStreams.get(Xr)}}catch(_i){Ar.e(_i)}finally{Ar.f()}tn.get(ur(Ct)).emit("availableStreamsUpdated",hr)},MCUAvailableComposite:function(Zt){var on,bn=co(Zt.detail.streams);try{for(bn.s();!(on=bn.n()).done;){var Rn=on.value;if(Rn.room===Ct._getTechnicalName()){var qn={isRemote:Zt.detail.isRemoteStream,hasAudio:Rn.audio,hasVideo:Rn.video,isAudioMuted:Rn.audioMuted,isVideoMuted:Rn.videoMuted,isScreensharing:Rn.attributes.callType==="screenSharing"||Rn.attributes.callType==="screenSharingWithAudio",isSIP:Rn.sip===!0,streamId:Rn.id,type:"composite",callId:Rn.attributes.callId,descriptor:Rn.attributes.descriptor,context:Rn.context};Ct.conversationStreams.set(qn.streamId,qn);var Jn={listEventType:"added"};Wt.g.assignObject(Jn,qn),tn.get(ur(Ct)).emit("compositeListChanged",Jn)}}}catch(dr){bn.e(dr)}finally{bn.f()}},MCUAvailableReplay:function(Zt){var on,bn=co(Zt.detail.streams);try{for(bn.s();!(on=bn.n()).done;){var Rn=on.value;if(Rn.room===Ct._getTechnicalName()){var qn={contact:ro.getOrCreateContact(Rn.attributes.callerId),isRemote:Zt.detail.isRemoteStream,hasAudio:Rn.audio,hasVideo:Rn.video,isAudioMuted:Rn.audioMuted,isVideoMuted:Rn.videoMuted,isScreensharing:Rn.attributes.callType==="screenSharing"||Rn.attributes.callType==="screenSharingWithAudio",isSIP:Rn.sip===!0,streamId:Rn.id,type:"replay",callId:Rn.attributes.callId,descriptor:Rn.attributes.descriptor,context:Rn.context};Ct.conversationStreams.set(qn.streamId,qn);var Jn={listEventType:"added"};Wt.g.assignObject(Jn,qn),tn.get(ur(Ct)).emit("replayListChanged",Jn)}}}catch(dr){bn.e(dr)}finally{bn.f()}},MCURemoveStream:function(Zt){if(Ct.conversationStreams.has(Zt.detail.streamId)){var on={listEventType:"removed"};Wt.g.assignObject(on,Ct.conversationStreams.get(Zt.detail.streamId)),on.type==="regular"?tn.get(ur(Ct)).emit("streamListChanged",on):on.type==="composite"&&tn.get(ur(Ct)).emit("compositeListChanged",on),Ct.conversationStreams.delete(Zt.detail.streamId),Ln.debug("Nb stream into conversation :"+Ct.conversationStreams.size);var bn,Rn={},qn=co(Ct.conversationStreams.keys());try{for(qn.s();!(bn=qn.n()).done;){var Jn=bn.value;Rn[Jn]=Ct.conversationStreams.get(Jn)}}catch(dr){qn.e(dr)}finally{qn.f()}tn.get(ur(Ct)).emit("availableStreamsUpdated",Rn)}else Ln.debug("Not a conversation's stream")},remoteStreamAdded:function(Zt){if(Ct.callIdToStreamId.has(Zt.detail.callId)){Ln.info("remoteStreamAdded",Zt.detail);var on=ro.getOrCreateContact(Zt.detail.remoteId),bn=Ct.callIdToStreamId.get(Zt.detail.callId),Rn=Mo.get(ur(Ct));Rn.has(bn)&&tn.get(ur(Ct)).emit("streamRemoved",Rn.get(bn));var qn=Zt.detail.callType==="audio"?"audio":"video",Jn=Zt.detail.callType==="screenSharing",dr=new so(Zt.detail.stream,{type:qn,contact:on,streamId:bn,callId:Zt.detail.callId,callAudioAvailable:Zt.detail.audioIsAvailable,callAudioActive:Zt.detail.audioIsActive,callAudioMuted:Zt.detail.audioIsMuted,callVideoAvailable:Zt.detail.videoIsAvailable,callVideoActive:Zt.detail.videoIsActive,callVideoMuted:Zt.detail.videoIsMuted,screensharing:Jn,constructor:!0});dr.publishedInConversations.set(Ct.getName(),Zt.detail.callId),Mo.get(ur(Ct)).set(bn,dr),apiRTC.session.remoteAccessInvitation!==null&&apiRTC.session.remoteAccessInvitation.screenSharingStreamId===bn?(Ln.debug("This is screensharing stream for remoteAccess"),dr.screensharingRemoteAccessStream=!0,apiRTC.session.remoteAccessInvitation.setRemoteAccessStream(dr)):tn.get(ur(Ct)).emit("streamAdded",dr)}},remoteStreamRemoved:function(Zt){if(Ct.callIdToStreamId.has(Zt.detail.callId)){var on=Ct.callIdToStreamId.get(Zt.detail.callId),bn=Mo.get(ur(Ct));bn.has(on)&&(tn.get(ur(Ct)).emit("streamRemoved",bn.get(on)),bn.delete(on))}},roomMemberUpdate:function(Zt){Ln.info("roomMemberUpdate event handler ",Zt);var on,bn=[],Rn=co(Zt.detail.contactList);try{for(Rn.s();!(on=Rn.n()).done;){var qn=on.value;bn.push(ro.getOrCreateContact(qn.contactId))}}catch(Jn){Rn.e(Jn)}finally{Rn.f()}Zt.detail.roomType==="whiteBoard"&&(Ln.info("Received whiteboard room member update"),tn.get(ur(Ct)).emit("whiteboardRoomMemberUpdate",{contacts:bn,roomId:Zt.detail.roomId,status:Zt.detail.status}))},slowLink:function(Zt){if(Ct.callIdToStreamId.has(Zt.detail.callId)){var on=Ct.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on};Zt.detail.advice&&(bn.advice=Zt.detail.advice),tn.get(ur(Ct)).emit("slowLink",bn)}},videoQualityChanged:function(Zt){if(Ct.callIdToStreamId.has(Zt.detail.callId)){var on=Ct.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on,hint:Zt.detail.hint,profileType:Zt.detail.profileType};Zt.detail.bitrate&&(bn.bitrate=Zt.detail.bitrate),Zt.detail.width&&Zt.detail.height&&(bn.width=Zt.detail.width,bn.height=Zt.detail.height),Zt.detail.frameRate&&(bn.frameRate=Zt.detail.frameRate),tn.get(ur(Ct)).emit("videoQualityChanged",bn)}},simulcastFeedChanged:function(Zt){if(Ct.callIdToStreamId.has(Zt.detail.callId)){var on=Ct.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on,simulcast:Zt.detail.simulcast};tn.get(ur(Ct)).emit("simulcastFeedChanged",bn)}},localStreamUpdated:function(Zt){if(Zt.detail.onCall&&Ct.callIdToStreamId.has(Zt.detail.callId)){var on={callId:Zt.detail.callId,streamId:Zt.detail.userMediaStreamId,audio:Zt.detail.audioIsAvailable&&Zt.detail.audioIsActive,audioMuted:Zt.detail.audioIsMuted,audioSilent:Zt.detail.audioIsSilent,video:Zt.detail.videoIsAvailable&&Zt.detail.videoIsActive,videoMuted:Zt.detail.videoIsMuted,videoSilent:Zt.detail.videoIsSilent,cause:Zt.detail.cause};tn.get(ur(Ct)).emit("localStreamUpdated",on)}},remoteStreamUpdated:function(Zt){var on=Zt.detail,bn=on.callId,Rn=on.cause;if(Ct.callIdToStreamId.has(bn)&&(Rn==="adaptation"||Rn==="userAction")){var qn={callId:bn,streamId:Ct.callIdToStreamId.get(bn),audio:Zt.detail.audioIsAvailable&&Zt.detail.audioIsActive,audioMuted:Zt.detail.audioIsMuted,audioSilent:Zt.detail.audioIsSilent,video:Zt.detail.videoIsAvailable&&Zt.detail.videoIsActive,videoMuted:Zt.detail.videoIsMuted,videoSilent:Zt.detail.videoIsSilent,cause:Rn};setTimeout(function(){tn.get(ur(Ct)).emit("remoteStreamUpdated",qn)})}},MCURecordingStarted:function(Zt){if(Zt.detail.roomName===Ct._getTechnicalName()){var on=Wt.g.parseRecordingEvent("MCURecordingStarted",Zt.detail);if(on.callId==="COMPOSITE")Ct.recordingStatus=on;else{var bn=Ct.conversationCalls.get(on.callId);bn&&(bn.recordingStatus=on)}tn.get(ur(Ct)).emit("recordingStarted",on)}},MCURecordingStopped:function(Zt){if(Zt.detail.roomName===Ct._getTechnicalName()){var on=Wt.g.parseRecordingEvent("MCURecordingStopped",Zt.detail);if(on.callId==="COMPOSITE")delete Ct.recordingStatus;else{var bn=Ct.conversationCalls.get(on.callId);bn&&delete bn.recordingStatus}tn.get(ur(Ct)).emit("recordingStopped",on)}},MCURecordedStreamsAvailable:function(Zt){if(Zt.detail.roomName===Ct._getTechnicalName()){var on=Wt.g.parseRecordingEvent("MCURecordedStreamsAvailable",Zt.detail);tn.get(ur(Ct)).emit("recordingAvailable",on)}},MCUStreamingStarted:function(Zt){if(Zt.detail.roomName===Ct._getTechnicalName()){var on=Fs("MCUStreamingStarted",Zt.detail),bn=Ct.conversationCalls.get(on.callId);bn&&(bn.streamingStatus=on),tn.get(ur(Ct)).emit("streamingStarted",on)}},MCUStreamingStopped:function(Zt){if(Zt.detail.roomName===Ct._getTechnicalName()){var on=Fs("MCUStreamingStopped",Zt.detail),bn=Ct.conversationCalls.get(on.callId);bn&&delete bn.streamingStatus,tn.get(ur(Ct)).emit("streamingStopped",on)}},onCallStatsUpdate:function(Zt){if(Ct.callIdToStreamId.has(Zt.detail.callId)){var on=Ct.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on,stats:{}};Zt.detail.userId&&(bn.mesh=!0,bn.userId=Zt.detail.userId,bn.contact=ro.getOrCreateContact(Zt.detail.userId));for(var Rn=0,qn=Object.keys(Zt.detail.stats);Rn<qn.length;Rn++){var Jn=qn[Rn];Yp.has(Jn)&&(bn.stats[Jn]=Zt.detail.stats[Jn])}tn.get(ur(Ct)).emit("callStatsUpdate",bn)}},cpuLimited:function(Zt){if(Ct.callIdToStreamId.has(Zt.detail.callId)){var on=Ct.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on,encodeUsagePercent:Zt.detail.encodeUsagePercent};tn.get(ur(Ct)).emit("cpuLimited",bn)}},bandwidthLimited:function(Zt){if(Ct.callIdToStreamId.has(Zt.detail.callId)){var on=Ct.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on,resolutionChanged:!0};tn.get(ur(Ct)).emit("bandwidthLimited",bn)}},audioAmplitude:function(Zt){if(Ct.callIdToStreamId.has(Zt.detail.callId)){var on=Ct.callIdToStreamId.get(Zt.detail.callId),bn={callId:Zt.detail.callId,streamId:on,amplitude:Zt.detail.descriptor.amplitude,isSpeaking:Zt.detail.descriptor.isSpeaking,descriptor:{amplitude:Zt.detail.descriptor.amplitude,isSpeaking:Zt.detail.descriptor.isSpeaking}};tn.get(ur(Ct)).emit("audioAmplitude",bn)}},hangup:function(Zt){if(Ct.callIdToStreamId.has(Zt.detail.callId)){var on=Ct.callIdToStreamId.get(Zt.detail.callId),bn=Mo.get(ur(Ct));bn.has(on)&&(tn.get(ur(Ct)).emit("streamRemoved",bn.get(on)),bn.delete(on)),Zt.detail.reason!=="restarted"&&Zt.detail.reason!=="disconnected"&&Zt.detail.reason!=="Broken_by_MCU"&&Zt.detail.reason!=="RTC_Setup_Timeout"&&(Ct.conversationCalls.has(Zt.detail.callId)?Vu(ur(Ct),Zt.detail.callId):(Ct.callIdToStreamId.delete(Zt.detail.callId),Ct.releaseResources(on,{isRemote:!0,triggerAdaptation:!0})),tn.get(ur(Ct)).emit("hangup",{from:Zt.detail.hangupType,reason:Zt.detail.reason,streamId:on}))}},callRestarting:function(Zt){if(Ct.callIdToStreamId.has(Zt.detail.oldCallId)){var on=Ct.callIdToStreamId.get(Zt.detail.oldCallId);Ct.callIdToStreamId.delete(Zt.detail.oldCallId),Ct.callIdToStreamId.set(Zt.detail.newCallId,on)}},MCUParticipantEjected:function(Zt){if(Ct._getTechnicalName()===Zt.detail.roomId){var on=Eo.get(ur(Ct));if(Zt.detail.clientId===on.getId())Ct.leave().catch(function(Rn){Ln.error("leave",Rn)}).then(function(){tn.get(ur(Ct)).emit("participantEjected",{self:!0})});else{var bn=ro.getOrCreateContact(Zt.detail.clientId);tn.get(ur(Ct)).emit("participantEjected",{self:!1,contact:bn})}}},MCURoomModeChanged:function(Zt){Ct._getTechnicalName()===Zt.detail.roomId&&tn.get(ur(Ct)).emit("roomModeChanged",{oldMode:Zt.detail.oldMode,newMode:Zt.detail.newMode,state:Zt.detail.state})}};return Ql.set(ur(Ct),Qt),tn.get(ur(Ct)).on("left",function(){Ct.pgroupWaitingRoomSubscribedTo&&(Kn.apiRTCSession.unsubscribePresenceGroup([tt.g.CONVERSATION_WAITING_ROOM_PREFIX+Ct._getTechnicalName()]),Ct.pgroupWaitingRoomSubscribedTo=!1),Ns.set(ur(Ct),null),Us.set(ur(Ct),null),Eo.set(ur(Ct),null),js.set(ur(Ct),null)}),Ct}return Lt=Jt,Xt=[{key:"destroy",value:function(){uo.get().deleteConversation(this.getName());var dt=Xl.get(this);if(dt){if(dt.apiRTCManager)for(var Ct in dt.apiRTCManager)Kn.removeEventListener(Ct,dt.apiRTCManager[Ct]);dt.contactCatalog&&ro.removeUpdateListener(dt.contactCatalog.onUpdate),Xl.delete(this)}}},{key:"getStatus",value:function(){return this.status}},{key:"getName",value:function(){return ts.get(this).toString()}},{key:"_getTechnicalName",value:function(){return ts.get(this).toString()}},{key:"getRole",value:function(){return Ns.get(this)}},{key:"getInstanceId",value:function(){return js.get(this)}},{key:"getFriendlyName",value:function(){return null}},{key:"getModerator",value:function(){return Us.get(this)}},{key:"getType",value:function(){return ns.get(this)}},{key:"setType",value:function(dt){return!this.isBound()&&!!ju.has(dt)&&(ns.set(this,dt),!0)}},{key:"getCloudConversationId",value:function(){var dt=Po.get(this);return dt?dt.toString():null}},{key:"getMedia",value:function(dt){return new Promise(function(Ct,Ut){apiRTC.CloudApi.cloudFetchMedia(dt).then(function(Vt){Ct(Vt)}).catch(function(Vt){Ut(Vt)})})}},{key:"bind",value:function(dt){var Ct=this;dt||(dt={});var Ut=Po.get(this);return Ut!==null?Promise.resolve(String(Ut)):new Promise(function(Vt,zt){Wu(Ct,dt).then(function(Qt){Vt(String(Qt.id))}).catch(function(Qt){zt(Wt.g.createError(tt.g.ERROR_HTTP,"bind() - cannot bind conversation",Ln,{fromError:Qt}))})})}},{key:"isBound",value:function(){return Po.get(this)!==null}},{key:"isGroupChatJoined",value:function(){return this.groupChatStatus===tt.g.CONVERSATION_STATUS_JOINED}},{key:"joinGroupChat",value:function(){var dt=this;return new Promise(function(Ct,Ut){if(dt.groupChatStatus!==tt.g.CONVERSATION_STATUS_NOT_JOINED)return Ut(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"joinGroupChat() - cannot join group chat",Ln));dt.bind().then(function(){return new Promise(function(Vt,zt){if(dt.asyncCallbacks)return zt(Wt.g.createError(tt.g.ERROR_OTHER,"joinGroupChat() - busy",Ln));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return Kn.removeEventListener("groupChatMemberUpdate",dt.asyncCallbacks.groupChatMemberUpdate),delete dt.asyncCallbacks,zt(Wt.g.createError(tt.g.ERROR_OTHER,"joinGroupChat() - timeout",Ln))},tt.g.CONVERSATION_GROUP_CHAT_MEMBER_UPDATE_DELAY),dt.asyncCallbacks.groupChatMemberUpdate=function(Qt){if(Qt.detail.groupChatId===dt._getTechnicalName()&&Qt.detail.status==="online"&&function(Zt,on){for(var bn=Zt.length;--bn>=0;)if(Zt[bn].contactId===on)return!0;return!1}(Qt.detail.contactList,Kn.getClientId()))return dt.asyncCallbacks&&(Kn.removeEventListener("groupChatMemberUpdate",dt.asyncCallbacks.groupChatMemberUpdate),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Vt()},Kn.onEvent("groupChatMemberUpdate",dt.asyncCallbacks.groupChatMemberUpdate),Kn.joinGroupChat(dt._getTechnicalName())})}).then(function(){dt.groupChatStatus=tt.g.CONVERSATION_STATUS_JOINED,Kn.joinAndSubscribeToPresenceGroup(dt._getTechnicalName()),Ct()}).catch(function(Vt){Ut(Wt.g.createError(tt.g.ERROR_OTHER,"joinGroupChat() - cannot join group chat",Ln,{fromError:Vt}))})})}},{key:"leaveGroupChat",value:function(){var dt=this;return new Promise(function(Ct,Ut){return dt.groupChatStatus!==tt.g.CONVERSATION_STATUS_JOINED?Ut(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"leaveGroupChat() - group chat not joined",Ln)):dt.status!==tt.g.CONVERSATION_STATUS_NOT_JOINED?Ut(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"leaveGroupChat() - webconf active",Ln)):void Kn.leaveGroupChat(dt._getTechnicalName()).then(function(){dt.groupChatStatus=tt.g.CONVERSATION_STATUS_NOT_JOINED,Kn.leaveAndUnsubscribeToPresenceGroup(dt._getTechnicalName()),Ct()}).catch(function(Vt){Ut(Wt.g.createError(tt.g.ERROR_OTHER,"leaveGroupChat() - cannot leave group chat",Ln,{fromError:Vt}))})})}},{key:"isJoined",value:function(){return this.status===tt.g.CONVERSATION_STATUS_JOINED}},{key:"isPublishedStream",value:function(dt){return dt.publishedInConversations.has(this.getName())}},{key:"publish",value:function(dt,Ct){var Ut=this;return Ct||(Ct={}),new Promise(function(Vt,zt){if(Ut.status!==tt.g.CONVERSATION_STATUS_JOINED)return zt(Wt.g.createError(tt.g.ERROR_OTHER,"publish() - conversation not joined",Ln));if(!(dt instanceof so))return zt(Wt.g.createError(tt.g.ERROR_OTHER,"publish() - No stream specified",Ln));if(Ut.isPublishedStream(dt))return zt(Wt.g.createError(tt.g.ERROR_OTHER,"publish() - Stream is already published in this conversation!",Ln));var Qt={};Qt.userMediaStreamId=dt.userMediaStreamId,Ct!==null&&Ps(Ct)==="object"&&(Qt.audioOnly=Ct.audioOnly,Qt.videoOnly=Ct.videoOnly,Qt.private=Ct.private,Qt.record=Ct.record,Qt.turnServerAddress=Ct.turnServerAddress,Qt.profileType=Ct.profileType,Qt.priority=Ct.priority,Qt.downgradeProfileList=Ct.downgradeProfileList,Qt.distributedBroadcastEnabled=Ct.distributedBroadcastEnabled),Wt.g.isPropertyTypeof(Ct,"mediaType","string")&&(Qt.mediaType=Ct.mediaType,Qt.audioOnly&&(Qt.mediaType="AUDIOONLY"),Qt.videoOnly&&(Qt.mediaType="VIDEOONLY")),Wt.g.isPropertyTypeof(Ct,"qos","object")&&(Qt.qos={},Wt.g.isPropertyTypeof(Ct.qos,"videoMinBitrate","number")&&(Qt.qos.videoMinBitrate=Ct.qos.videoMinBitrate),Wt.g.isPropertyTypeof(Ct.qos,"videoMinQuality","string")&&(Qt.qos.videoMinQuality=Ct.qos.videoMinQuality),Wt.g.isPropertyTypeof(Ct.qos,"videoStartBitrate","number")&&(Qt.qos.videoStartBitrate=Ct.qos.videoStartBitrate),Wt.g.isPropertyTypeof(Ct.qos,"videoStartQuality","string")&&(Qt.qos.videoStartQuality=Ct.qos.videoStartQuality),Wt.g.isPropertyTypeof(Ct.qos,"videoForbidInactive","boolean")&&(Qt.qos.videoForbidInactive=Ct.qos.videoForbidInactive)),Wt.g.isPropertyTypeof(Ct,"simulcast","object")&&!Qt.audioOnly&&(Qt.simulcast={},Wt.g.isPropertyTypeof(Ct.simulcast,"mode","string")&&["RID","SDP"].indexOf(Ct.simulcast.mode)>=0&&(Qt.simulcast.mode=Ct.simulcast.mode),Wt.g.isPropertyTypeof(Ct.simulcast,"maxBitrate","number")?Qt.simulcast.maxBitrate=Ct.simulcast.maxBitrate:Wt.g.isPropertyTypeof(Ct.simulcast,"encodings","object")&&(Qt.simulcast.encodings=Object.assign({},Ct.simulcast.encodings))),["audioLabels","videoLabels"].forEach(function(dr){Wt.g.isTypeof(Ct,dr,"array")&&(Qt[dr]=[],Ct[dr].forEach(function(hr){Wt.g.isTypeof(hr,"string")&&Qt[dr].push(hr)}))}),Wt.g.isPropertyTypeof(Ct,"context","object")&&(Qt.context=Ct.context);var Zt=null;if(dt.hasVideo()&&Ut.getNetworkCap({capacity:!0})&&Ct.profileType&&Ct.downgradeProfileList){for(var on=Ct.downgradeProfileList.length;--on>=0;)if(Ct.downgradeProfileList[on].name===Ct.profileType){Ct.downgradeProfileList[on].bitrate&&(Zt=Ct.downgradeProfileList[on].bitrate);break}}if(Zt){if(!Ut.reserveResources(Ct.profileType,Zt,dt.userMediaStreamId,!1,Ct.priority,{isVideoOnly:!dt.hasAudio(),isVideoMuted:Qt.audioOnly,control:!0})&&!Ut.disableLowerPriorityVideo(!1,Zt,Ct.priority)){if(!dt.hasAudio())return zt(Wt.g.createError(tt.g.ERROR_OTHER,"publish() - not enough bandwidth",Ln));Qt.audioOnly=!0}Ut.reserveResources(Ct.profileType,Zt,dt.userMediaStreamId,!1,Ct.priority,{isVideoOnly:!dt.hasAudio(),isVideoMuted:Qt.audioOnly})}Ln.info("callConfiguration:",Qt);var bn=dt.isScreensharing(),Rn=Kn.webRTCClient.publish(Ut.sessionId,Ut.sessionId,Ut.token,Qt,{},{forceScreenSharingCallType:bn});if(!Rn)return Ut.releaseResources(dt.userMediaStreamId),zt(Wt.g.createError(tt.g.ERROR_OTHER,"publish() - failed to establish call",Ln));Ut.conversationCalls.set(Rn,new Kl(Ut,Rn,dt)),dt.publishedInConversations.set(Ut.getName(),Rn),Ut.callIdToStreamId.set(Rn,dt.userMediaStreamId);var qn={contact:null,isRemote:!1,hasAudio:dt.hasAudio(),hasVideo:dt.hasVideo(),isScreensharing:dt.isScreensharing(),streamId:dt.userMediaStreamId,callId:Rn};Ut.conversationPublishedStreams.set(dt.userMediaStreamId,qn);var Jn={callEstablishedHandler:function(dr){dr.detail.callId.toString()===Rn.toString()&&(Kn.removeEventListener("callEstablished",Jn.callEstablishedHandler),Ut.removeListener("error",Jn.errorHandler),Vt(dt))}};Kn.onEvent("callEstablished",Jn.callEstablishedHandler),Jn.errorHandler=function(dr){dr.callId===Rn&&(Kn.removeEventListener("callEstablished",Jn.callEstablishedHandler),Ut.removeListener("error",Jn.errorHandler),Ut.releaseResources(dt.userMediaStreamId),zt(Wt.g.createError(tt.g.ERROR_OTHER,"publish() - "+dr.errorInfo,Ln)))},Ut.on("error",Jn.errorHandler)})}},{key:"unpublish",value:function(dt,Ct){if(Ct||(Ct={}),dt instanceof so)if(this.isPublishedStream(dt)){var Ut=dt.publishedInConversations.get(this.getName()),Vt=!Ct.noTriggerAdaptation;Vu(this,Ut,{stream:dt,triggerAdaptation:Vt}),Kn.webRTCClient&&Kn.webRTCClient.unpublish(Ut)}else Ln.error("unpublish() - Stream is not published to conversation");else Ln.error("unpublish() - No stream specified",dt)}},{key:"getConversationCall",value:function(dt){if(!dt)return null;var Ct=dt.publishedInConversations.get(this.getName());return Ct?this.conversationCalls.get(Ct):null}},{key:"replacePublishedStream",value:function(dt,Ct,Ut){var Vt=this;return Ln.info("replacePublishedStream"),new Promise(function(zt,Qt){var Zt=Vt.getConversationCall(dt);if(Zt===null)return Qt(new Error("CALL_NOT_FOUND"));Zt.replacePublishedStream(Ct,Ut).then(function(on){console.error("replacePublishedStream OK"),zt(on)}).catch(function(on){console.error("replacePublishedStream NOK"),Qt(on)})})}},{key:"getCallId",value:function(dt){return dt.publishedInConversations.get(this.getName())}},{key:"checkAccess",value:function(dt){var Ct=this;return dt||(dt={}),new Promise(function(Ut,Vt){if(dt.force!==!0&&Ct.accessStatus)return Ut(Ct.accessStatus);dt.hasOwnProperty("session")||Br.getActiveSession()===null||(dt.session=Br.getActiveSession()),Ct.bind(dt).then(function(zt){return dt.convId=zt,wo.checkConferenceAccess(Ct._getTechnicalName(),Kn.getActiveApiKey(),dt)}).then(function(zt){return zt.access!==tt.g.CONVERSATION_ACCESS_GRANTED&&zt.access!==tt.g.CONVERSATION_NEED_MODERATOR_ACCEPTATION&&Ln.warn("checkAccess() - unknown access response:",zt.access),zt.role!==tt.g.CONVERSATION_ROLE_MODERATOR&&zt.role!==tt.g.CONVERSATION_ROLE_CONTRIBUTOR&&zt.role!==tt.g.CONVERSATION_ROLE_GUEST&&Ln.warn("checkAccess() - unknown role response:",zt.role),zt.hasOwnProperty("webconfId")&&(Ct.webconfId=zt.webconfId,delete zt.webconfId),Ct.accessStatus=Wt.g.assignObject({},zt),Ut(Ct.accessStatus)}).catch(function(zt){Vt(Wt.g.createError(tt.g.ERROR_APIRTC_INITIALISATION_FAILED,"checkAccess() - cannot check access",Ln,{fromError:zt}))})})}},{key:"join",value:function(){var dt=this,Ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ln.debug("Joining "+this.getName()),new Promise(function(Ut,Vt){if(dt.status!==tt.g.CONVERSATION_STATUS_NOT_JOINED)return Vt(Wt.g.createError(tt.g.ERROR_OTHER,"join() - cannot join conversation",Ln));Ct=Object.assign({},Ct);var zt=!1;Ct.qualityAdaptationEnabled&&(zt=!0,delete Ct.qualityAdaptationEnabled);var Qt=null;Ct.supportedVideoCodecs&&(Qt=Ct.supportedVideoCodecs,delete Ct.supportedVideoCodecs),dt.checkAccess(Ct).then(function(Zt){if(!dt.conference){if(Zt.type!=="public")return Promise.reject(Wt.g.createError(tt.g.ERROR_UNAUTHORIZED,"join() - wrong conference type",Ln));if(Zt.access!==tt.g.CONVERSATION_ACCESS_GRANTED)return Promise.reject(Wt.g.createError(tt.g.ERROR_UNAUTHORIZED,"join() - access to conference not granted",Ln))}return Zp(dt,Zt)}).then(function(Zt){if(Ns.set(dt,Zt.role),dt.status=tt.g.CONVERSATION_STATUS_JOINING,dt.conference)return Ct.hasOwnProperty("password")&&$s.set(dt,Ct.password),dt.friendlyName=Zt.hasOwnProperty("friendlyName")?Zt.friendlyName:dt.friendlyName,js.set(dt,Zt.instanceId),_h(dt,Eo.get(dt),Kn.getActiveApiKey())}).then(function(){var Zt=dt,on=function qn(Jn){if(Ln.debug("joinMCUSessionAnswer",Zt._getTechnicalName(),Jn.detail),Jn.detail.roomId.toString()===Zt._getTechnicalName()){if(Jn.detail.result&&Jn.detail.result.failed){Ln.error("Conversation "+Zt.getName()+" join failed",Jn.detail),this.status=tt.g.CONVERSATION_STATUS_NOT_JOINED;var dr=Jn.detail.result.reason?Jn.detail.result.reason:"join failed";return Vt(Wt.g.createError(tt.g.ERROR_UNAUTHORIZED,"join() - "+dr,Ln))}Ln.info("Conversation "+Zt.getName()+" joined",Jn.detail),Kn.removeEventListener("joinMCUSessionAnswer",qn),Zt.status=tt.g.CONVERSATION_STATUS_JOINED,Zt.token=Jn.detail.token,Zt.sessionId=Jn.detail.sessionId,Zt.mode=Jn.detail.mode,Zt.conversationStreams=new Map;var hr=Ql.get(Zt);Kn.onEvent("MCUAvailableStream",hr.MCUAvailableStream).onEvent("MCUAvailableStreamUpdate",hr.MCUAvailableStreamUpdate).onEvent("MCURemoveStream",hr.MCURemoveStream).onEvent("MCUAvailableComposite",hr.MCUAvailableComposite).onEvent("MCUAvailableReplay",hr.MCUAvailableReplay).onEvent("MCUParticipantEjected",hr.MCUParticipantEjected).onEvent("remoteStreamAdded",hr.remoteStreamAdded).onEvent("remoteStreamRemoved",hr.remoteStreamRemoved).onEvent("roomMemberUpdate",hr.roomMemberUpdate).onEvent("slowLink",hr.slowLink).onEvent("localStreamUpdated",hr.localStreamUpdated).onEvent("remoteStreamUpdated",hr.remoteStreamUpdated).onEvent("simulcastFeedChanged",hr.simulcastFeedChanged).onEvent("MCURecordingStarted",hr.MCURecordingStarted).onEvent("MCURecordingStopped",hr.MCURecordingStopped).onEvent("MCURecordedStreamsAvailable",hr.MCURecordedStreamsAvailable).onEvent("MCUStreamingStarted",hr.MCUStreamingStarted).onEvent("MCUStreamingStopped",hr.MCUStreamingStopped).onEvent("MCURoomModeChanged",hr.MCURoomModeChanged).onEvent("onCallStatsUpdate",hr.onCallStatsUpdate).onEvent("hangup",hr.hangup).onEvent("callRestarting",hr.callRestarting).onEvent("audioAmplitude",hr.audioAmplitude).onEvent("videoQualityChanged",hr.videoQualityChanged).onEvent("cpuLimited",hr.cpuLimited).onEvent("bandwidthLimited",hr.bandwidthLimited),Zt.conference&&Zt.updateData(),Zt.getRole()===tt.g.CONVERSATION_ROLE_MODERATOR&&(Kn.apiRTCSession.subscribePresenceGroup([tt.g.CONVERSATION_WAITING_ROOM_PREFIX+Zt._getTechnicalName()]),Zt.pgroupWaitingRoomSubscribedTo=!0),Zt.groupChatStatus!==tt.g.CONVERSATION_STATUS_NOT_JOINED&&(Zt.groupChatStatus=tt.g.CONVERSATION_STATUS_NOT_JOINED),tn.get(Zt).emit("joined");var Ar={};Jn.detail.mode==="mesh"&&(Ar.mode="mesh",Jn.detail.meshOnly===!0&&(Ar.meshOnly=!0)),Ut(Ar)}};Kn.onEvent("joinMCUSessionAnswer",on);var bn={};bn.convId=dt.getCloudConversationId(),dt.meshModeEnabled&&(bn.meshModeEnabled=dt.meshModeEnabled),dt.meshOnlyEnabled&&(bn.meshOnlyEnabled=dt.meshOnlyEnabled),dt.conference||(dt.moderationEnabled&&(bn.moderationEnabled=!0),dt.getRole()===tt.g.CONVERSATION_ROLE_MODERATOR&&(bn.moderator=!0)),zt&&(bn.qualityAdaptationEnabled=!0),Qt&&(bn.supportedVideoCodecs=Qt);var Rn=Kn.webRTCClient.joinMCUSession(dt._getTechnicalName(),bn);if(Rn instanceof Error)return Kn.removeEventListener("joinMCUSessionAnswer",on),Zt.status=tt.g.CONVERSATION_STATUS_NOT_JOINED,Vt(Wt.g.createError(tt.g.ERROR_OTHER,"join() - cannot join conversation :"+Rn.message,Ln))}).catch(function(Zt){return dt.status=tt.g.CONVERSATION_STATUS_NOT_JOINED,Vt(Wt.g.createError(tt.g.ERROR_OTHER,"join() - cannot join conversation",Ln,{fromError:Zt}))})})}},{key:"cancelJoin",value:function(){return this.cancelJoin0!==null&&typeof this.cancelJoin0=="function"&&this.cancelJoin0()}},{key:"eject",value:function(dt,Ct){var Ut=this;return new Promise(function(Vt,zt){if(Ut.status!==tt.g.CONVERSATION_STATUS_JOINED)return zt(Wt.g.createError(tt.g.ERROR_OTHER,"eject() - conference not joined",Ln));if(Ut.getRole()!==tt.g.CONVERSATION_ROLE_MODERATOR)return zt(Wt.g.createError(tt.g.ERROR_UNAUTHORIZED,"eject() - only moderator can eject a contact",Ln));var Qt={};Qt.timeoutId=setTimeout(function(){return Qt&&(Kn.removeEventListener("MCUParticipantEjected",Qt.ejected),Qt=!1),zt(Wt.g.createError(tt.g.ERROR_OTHER,"eject() - timeout",Ln))},tt.g.CONVERSATION_PARTICIPANT_EJECTION_DELAY),Qt.ejected=function(Zt){if(Zt.detail.roomId===Ut._getTechnicalName()&&Zt.detail.clientId===dt.getId())return Qt&&(clearTimeout(Qt.timeoutId),Kn.removeEventListener("MCUParticipantEjected",Qt.ejected),Qt=!1),Vt()},Kn.onEvent("MCUParticipantEjected",Qt.ejected),Kn.webRTCClient.ejectParticipantFromMCUSession(dt.getId(),Ct)})}},{key:"allowEntry",value:function(dt,Ct){var Ut=this;return Ct||(Ct={}),new Promise(function(Vt,zt){if(Ut.status!==tt.g.CONVERSATION_STATUS_JOINED)return zt(Wt.g.createError(tt.g.ERROR_OTHER,"allowEntry() - conference not joined",Ln));if(!(dt instanceof No))return zt(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"allowEntry() - parameter is not an instance of apiRTC.Contact",Ln));if(Ut.getRole()!==tt.g.CONVERSATION_ROLE_MODERATOR)return zt(Wt.g.createError(tt.g.ERROR_UNAUTHORIZED,"allowEntry() - only moderator can allow entry to a contact",Ln));var Qt={roomname:Ut._getTechnicalName(),event:tt.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,access:!0,command:"access",value:{access:!0}};if(Ct.hasOwnProperty("invitationId")&&(Qt.invitationId=Ct.invitationId),Ct.hasOwnProperty("answer")&&(Qt.answer=Ct.answer),Kn.sendData(dt.getId(),Qt).catch(function(on){var bn=Wt.g.createError(on,"Notification not delivered",Ln);tn.get(Ut).emit("messageNotDelivered",{error:bn,contact:dt,event:tt.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,command:"access"})}),Ct.ackEnabled===!0){var Zt=setInterval(function(){Qt.command="access-new",Kn.sendData(dt.getId(),Qt).catch(function(on){var bn=Wt.g.createError(on,"Notification not delivered",Ln);tn.get(Ut).emit("messageNotDelivered",{error:bn,contact:dt,event:tt.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,command:"access"})})},tt.g.CONVERSATION_JOIN_REQUEST_INTERVAL);Kn.onEvent("receiveData",function on(bn){var Rn=ro.getOrCreateContact(bn.detail.senderId);bn.detail.hasOwnProperty("data")&&bn.detail.data.command==="access-ack"&&bn.detail.data.roomname===Ut._getTechnicalName()&&Rn.getId()===dt.getId()&&(clearInterval(Zt),Kn.removeEventListener("receiveData",on))})}return Vt()})}},{key:"denyEntry",value:function(dt,Ct){var Ut=this;return Ct||(Ct={}),new Promise(function(Vt,zt){if(Ut.status!==tt.g.CONVERSATION_STATUS_JOINED)return zt(Wt.g.createError(tt.g.ERROR_OTHER,"denyEntry() - conference not joined",Ln));if(!(dt instanceof No))return zt(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"denyEntry() - parameter is not an instance of apiRTC.Contact",Ln));if(Ut.getRole()!==tt.g.CONVERSATION_ROLE_MODERATOR)return zt(Wt.g.createError(tt.g.ERROR_UNAUTHORIZED,"denyEntry() - only moderator can deny entry to a contact",Ln));var Qt={roomname:Ut._getTechnicalName(),event:tt.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,access:!1,command:"access",value:{access:!1}};return Ct.hasOwnProperty("invitationId")&&(Qt.invitationId=Ct.invitationId),Ct.hasOwnProperty("answer")&&(Qt.answer=Ct.answer),Ct.hasOwnProperty("reason")&&(Qt.reason=Ct.reason),Kn.sendData(dt.getId(),Qt).catch(function(Zt){var on=Wt.g.createError(Zt,"Notification not delivered",Ln);tn.get(Ut).emit("messageNotDelivered",{error:on,contact:dt,event:tt.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER,command:"access"})}),Vt()})}},{key:"sendJoinRequest",value:function(){var dt=this;if(this.status===tt.g.CONVERSATION_STATUS_WAITING){if(!this.joinRequestIntervalId){var Ct=Qp(this);Ct&&(Kn.sendData(Ct,{roomname:this._getTechnicalName(),event:tt.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER,invitationId:this._getTechnicalName(),sendTime:Date.now(),command:"userWaiting",value:{username:Fu()}}).catch(function(Ut){var Vt=Wt.g.createError(Ut,"Notification not delivered",Ln);tn.get(dt).emit("messageNotDelivered",{error:Vt,contact:dt.getModerator(),event:tt.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER,command:"userWaiting"})}),this.joinRequestIntervalId=setInterval(function(){Kn.sendData(Ct,{roomname:dt._getTechnicalName(),event:tt.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER,invitationId:dt._getTechnicalName(),sendTime:Date.now(),command:"userWaiting-new",value:{username:Fu()}}).catch(function(Ut){var Vt=Wt.g.createError(Ut,"Notification not delivered",Ln);tn.get(dt).emit("messageNotDelivered",{error:Vt,contact:dt.getModerator(),event:tt.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER,command:"userWaiting-new"})})},tt.g.CONVERSATION_JOIN_REQUEST_INTERVAL))}}else Ln.error("sendJoinRequest() - Not in conversation's waiting room, cannot send join request")}},{key:"leave",value:function(){var dt=this;return new Promise(function(Ct,Ut){if(dt.status!==tt.g.CONVERSATION_STATUS_JOINED)return Ut(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"leave() - webconf not joined",Ln));for(var Vt=Ql.get(dt),zt=0,Qt=Object.keys(Vt);zt<Qt.length;zt++){var Zt=Qt[zt];Ln.info("Session, removing apiRTCManager event :",Zt);var on=Vt[Zt];Kn.removeEventListener(Zt,on)}var bn,Rn=co(dt.conversationStreams.keys());try{for(Rn.s();!(bn=Rn.n()).done;){var qn=bn.value;Ln.trace("Leave() - unsubscribe to "+qn),Kn.webRTCClient!==null&&Kn.webRTCClient.unsubscribe(qn)}}catch(Jn){Rn.e(Jn)}finally{Rn.f()}Zl(dt,!1,!1).then(function(){}).catch(function(Jn){}),Kn.webRTCClient!==null&&Kn.IMClient.leaveGroupChat(dt._getTechnicalName()),dt.whiteboardStarted===tt.g.CONVERSATION_WHITEBOARD_STARTED&&Kn.whiteBoardClient.roomId===dt._getTechnicalName()&&(Kn.whiteBoardClient.leaveRoom(),Kn.whiteBoardClient.stop(),dt.whiteboardStarted=tt.g.CONVERSATION_WHITEBOARD_NOT_STARTED),Kn.webRTCClient!==null&&Kn.webRTCClient.leaveMCUSession(),dt.conversationStreams=new Map,dt.status=tt.g.CONVERSATION_STATUS_NOT_JOINED,tn.get(dt).emit("left"),Ct()})}},{key:"subscribeToStream",value:function(dt,Ct){var Ut=this;if(Ct||(Ct={}),Ln.debug("subscribeToMedia",dt),!this.isJoined())return Promise.reject(Wt.g.createError(tt.g.ERROR_OTHER,"subscribeToMedia() - conversation not joined",Ln));var Vt={};Ct.turnServerAddress!==null&&Ct.turnServerAddress!==void 0&&(Vt.turnServerAddress=Ct.turnServerAddress),Wt.g.isPropertyTypeof(Ct,"qos","object")&&(Vt.qos={},Wt.g.isPropertyTypeof(Ct.qos,"videoForbidInactive","boolean")&&(Vt.qos.videoForbidInactive=Ct.qos.videoForbidInactive));var zt=Number(dt),Qt=Kn.webRTCClient.getStreamFromList(zt),Zt=this.conversationStreams.get(zt);if(!Qt||!Zt)return Promise.reject(Wt.g.createError(tt.g.ERROR_OTHER,"subscribeToMedia() - no such stream",Ln));if(Wt.g.isPropertyTypeof(Ct,"simulcast","object")){var on=["high","medium","low"];Vt.simulcast={},Ct.simulcast.streamQuality&&(on.indexOf(Ct.simulcast.streamQuality)>=0?Vt.simulcast.streamQuality=Ct.simulcast.streamQuality:Vt.simulcast.streamQuality="default"),Ct.simulcast.streamFrameRate&&(on.indexOf(Ct.simulcast.streamFrameRate)>=0?Vt.simulcast.streamFrameRate=Ct.simulcast.streamFrameRate:Vt.simulcast.streamFrameRate="default")}return new Promise(function(bn,Rn){var qn="VIDEO";if(Zt.hasVideo&&Ut.getNetworkCap({capacity:!0})&&Wt.g.isPropertyTypeof(Zt,"descriptor","object")){var Jn=Zt.descriptor;if(!Ut.reserveResources(Jn.profileType,Jn.bitrate,zt,!0,Jn.priority,{isVideoOnly:!Zt.hasAudio,isVideoMuted:Ct.audioOnly,control:!0})&&!Ut.disableLowerPriorityVideo(!0,Jn.bitrate,Jn.priority)){if(!Zt.hasAudio)return Rn(Wt.g.createError(tt.g.ERROR_OTHER,"subscribeToMedia() - not enough bandwidth",Ln));Ct.audioOnly=!0}Ut.reserveResources(Jn.profileType,Jn.bitrate,zt,!0,Jn.priority,{isVideoOnly:!Zt.hasAudio,isVideoMuted:Ct.audioOnly})}Ct.audioOnly===!0?qn="AUDIOONLY":Ct.videoOnly===!0&&(qn="VIDEOONLY");var dr=Kn.webRTCClient.subscribe([Qt],qn,{},Vt,Ct)[0];if(!dr)return Ut.releaseResources(zt),Rn(Wt.g.createError(tt.g.ERROR_OTHER,"subscribeToMedia() - stream not available",Ln));Ut.callIdToStreamId.set(dr,zt),Ln.debug("Subscribed to stream "+dt+" through call "+dr);var hr={streamAddedHandler:function(Ar){Ar.streamId===zt&&(Ut.removeListener("streamAdded",hr.streamAddedHandler),Ut.removeListener("error",hr.errorHandler),bn(Ar))}};Ut.on("streamAdded",hr.streamAddedHandler),hr.errorHandler=function(Ar){Ar.callId===dr&&(Ut.removeListener("streamAdded",hr.streamAddedHandler),Ut.removeListener("error",hr.errorHandler),Ut.releaseResources(zt),Rn(Wt.g.createError(tt.g.ERROR_OTHER,"subscribeToMedia() - "+Ar.errorInfo,Ln)))},Ut.on("error",hr.errorHandler)})}},{key:"updateSubscribedStream",value:function(dt,Ct){Ct||(Ct={});var Ut=Number(dt);if(!Mo.get(this).has(Ut))return Ln.error("updateSubscribedStream() - Conversation stream "+dt+" does not exist or was not subscribed to"),Promise.reject("wrong streamId");var Vt=Mo.get(this).get(Ut);if(Wt.g.isTypeof(Ct.simulcast,"object"))return Kn.webRTCClient.webRTCClient.updateSimulcastFeedOnCall(Vt.callId,Ct.simulcast);var zt="VIDEO";return Ct.audioOnly===!0?zt="AUDIOONLY":Ct.videoOnly===!0&&(zt="VIDEOONLY"),Kn.webRTCClient.webRTCClient.updateMediaTypeOnCall(Vt.callId,zt)}},{key:"unsubscribeToStream",value:function(dt,Ct){Ct||(Ct={});var Ut=Number(dt);Kn.webRTCClient!==null&&Kn.webRTCClient.unsubscribe(Ut);var Vt=!Ct.noTriggerAdaptation;this.releaseResources(dt,{isRemote:!0,triggerAdaptation:Vt})}},{key:"subscribeToMedia",value:function(dt,Ct){return this.subscribeToStream(dt,Ct)}},{key:"unsubscribeToMedia",value:function(dt){this.unsubscribeToStream(dt)}},{key:"startRecording",value:function(dt){var Ct=this;return dt||(dt={}),new Promise(function(Ut,Vt){if(Ct.status!==tt.g.CONVERSATION_STATUS_JOINED)return Vt(Wt.g.createError(tt.g.ERROR_OTHER,"startRecording() - conversation not joined",Ln));if(Ct.asyncCallbacks)return Vt(Wt.g.createError(tt.g.ERROR_OTHER,"startRecording() - busy",Ln));Ct.asyncCallbacks={},Ct.asyncCallbacks.timeoutId=setTimeout(function(){return Ct.asyncCallbacks&&(Kn.removeEventListener("error",Ct.asyncCallbacks.error),Kn.removeEventListener("MCURecordingStarted",Ct.asyncCallbacks.recordingStarted),delete Ct.asyncCallbacks),Vt(Wt.g.createError(tt.g.ERROR_OTHER,"startRecording() - timeout",Ln))},tt.g.CONVERSATION_RECORDING_STARTED_DELAY),Ct.asyncCallbacks.error=function(on){if(String(on.detail.convId)===Ct.getCloudConversationId()&&on.detail.callId==="COMPOSITE"&&on.detail.errorCode.indexOf("START_RECORD")>=0)return Ct.asyncCallbacks&&(Kn.removeEventListener("error",Ct.asyncCallbacks.error),Kn.removeEventListener("MCURecordingStarted",Ct.asyncCallbacks.recordingStarted),clearTimeout(Ct.asyncCallbacks.timeoutId),delete Ct.asyncCallbacks),Vt(Wt.g.createError(tt.g.ERROR_OTHER,"startRecording() - "+on.detail.errorInfo,Ln))},Ct.asyncCallbacks.recordingStarted=function(on){if(String(on.detail.convId)===Ct.getCloudConversationId()&&on.detail.callId==="COMPOSITE"){Ct.asyncCallbacks&&(Kn.removeEventListener("error",Ct.asyncCallbacks.error),Kn.removeEventListener("MCURecordingStarted",Ct.asyncCallbacks.recordingStarted),clearTimeout(Ct.asyncCallbacks.timeoutId),delete Ct.asyncCallbacks);var bn=Wt.g.parseRecordingEvent("MCURecordingStarted",on.detail);return Ut(bn)}},Kn.onEvent("error",Ct.asyncCallbacks.error),Kn.onEvent("MCURecordingStarted",Ct.asyncCallbacks.recordingStarted);var zt="AUDIO-VIDEO";dt.audioOnly===!0?zt="AUDIO-ONLY":dt.videoOnly===!0&&(zt="VIDEO-ONLY");var Qt="composite";Wt.g.isPropertyTypeof(dt,"customIdInFilename","string")&&(Qt=dt.customIdInFilename);var Zt={};Wt.g.isPropertyTypeof(dt,"data","object")&&(Zt=Wt.g.assignObject({},dt.data)),["complete","efficient","audioOnly"].indexOf(dt.mode)>=0?Zt.mode=dt.mode:Zt.mode="complete",Zt.labelEnabled=dt.labelEnabled===!0,Zt.labelEnabled===!0&&(Zt.labels=[],Wt.g.isTypeof(dt.labels,"array")&&dt.labels.forEach(function(on){Wt.g.isTypeof(on,"string")&&Zt.labels.push(on)})),Wt.g.isTypeof(dt,"ttl","number")&&dt.ttl>0&&(Zt.ttl=dt.ttl),Kn.webRTCClient.startCompositeRecording(zt,Qt,Ct.getCloudConversationId(),Zt)})}},{key:"stopRecording",value:function(){var dt=this;return new Promise(function(Ct,Ut){if(dt.asyncCallbacks)return Ut(Wt.g.createError(tt.g.ERROR_OTHER,"stopRecording() - busy",Ln));dt.asyncCallbacks={},dt.asyncCallbacks.timeoutId=setTimeout(function(){return dt.asyncCallbacks&&(Kn.removeEventListener("error",dt.asyncCallbacks.error),Kn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),delete dt.asyncCallbacks),Ct(dt.recordingStatus)},tt.g.CONVERSATION_RECORDING_STOPPED_DELAY),dt.asyncCallbacks.error=function(Vt){if(String(Vt.detail.convId)===dt.getCloudConversationId()&&Vt.detail.callId==="COMPOSITE"&&Vt.detail.errorCode.indexOf("STOP_RECORD")>=0)return dt.asyncCallbacks&&(Kn.removeEventListener("error",dt.asyncCallbacks.error),Kn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks),Ut(Wt.g.createError(tt.g.ERROR_OTHER,"stopRecording() - "+Vt.detail.errorInfo,Ln))},dt.asyncCallbacks.recordingStopped=function(Vt){if(String(Vt.detail.convId)===dt.getCloudConversationId()&&Vt.detail.callId==="COMPOSITE"){dt.asyncCallbacks&&(Kn.removeEventListener("error",dt.asyncCallbacks.error),Kn.removeEventListener("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),clearTimeout(dt.asyncCallbacks.timeoutId),delete dt.asyncCallbacks);var zt=Wt.g.parseRecordingEvent("MCURecordingStopped",Vt.detail);return Ct(zt)}},Kn.onEvent("error",dt.asyncCallbacks.error),Kn.onEvent("MCURecordingStopped",dt.asyncCallbacks.recordingStopped),Kn.webRTCClient.stopCompositeRecording()})}},{key:"getContacts",value:function(){Ln.debug("getContacts()");var dt={};if(this.isBound()){var Ct,Ut=Ro.get().getContacts(this._getTechnicalName()),Vt=co(Ut.keys());try{for(Vt.s();!(Ct=Vt.n()).done;){var zt=Ct.value;dt[zt]=Ut.get(zt)}}catch(Qt){Vt.e(Qt)}finally{Vt.f()}}else Ln.warn("getContacts() - Cannot get contacts as conversation is not joined");return dt}},{key:"getContactsArray",value:function(){Ln.debug("getContactsArray()");var dt=[];if(this.isBound()){var Ct,Ut=Ro.get().getContacts(this._getTechnicalName()),Vt=co(Ut.keys());try{for(Vt.s();!(Ct=Vt.n()).done;){var zt=Ct.value;dt.push(Ut.get(zt))}}catch(Qt){Vt.e(Qt)}finally{Vt.f()}}else Ln.warn("getContacts() - Cannot get contacts as conversation is not joined");return dt}},{key:"getContactsNumber",value:function(){Ln.debug("getContactsNumber()");var dt=0;return this.isBound()?dt=Ro.get().getContacts(this._getTechnicalName()).size:Ln.warn("getContactsNumber() - Cannot get contacts as conversation is not joined"),dt}},{key:"getData",value:function(){return Ln.debug("getData()"),this.isBound()||Ln.warn("getData() - Cannot get most recent data as conversation is not joined, you may want to call Conversation.updateData() instead"),qo.get(this)}},{key:"setData",value:function(dt){var Ct=this;return new Promise(function(Ut,Vt){Ct.bind().then(function(){return wo.setConversationData(Po.get(Ct),JSON.stringify(dt),Kn.getActiveApiKey(),{token:Eo.get(Ct).token})}).then(function(){qo.set(Ct,dt),Kn.dataClient.sendDataToGroup(Ct._getTechnicalName(),{event:tt.g.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER,roomname:Ct._getTechnicalName()}),Ut()}).catch(function(){Vt(Wt.g.createError(tt.g.ERROR_OTHER,"setData() - cannot set conversation data",Ln))})})}},{key:"updateData",value:function(){var dt=this;return new Promise(function(Ct,Ut){(dt.isBound()?Wu(dt):dt.bind()).then(function(){Ct(),tn.get(dt).emit("persistentDataUpdated",qo.get(dt))}).catch(function(Vt){Ut(Wt.g.createError(tt.g.ERROR_OTHER,"updateData() - cannot update conversation data",Ln,{fromError:Vt}))})})}},{key:"getAvailableMediaList",value:function(){return Ln.warn("Function deprecated, please use Conversation.getAvailableStreamList() instead"),this.getAvailableStreamList()}},{key:"getAvailableStreamList",value:function(){var dt,Ct=[],Ut=co(this.conversationStreams.keys());try{for(Ut.s();!(dt=Ut.n()).done;){var Vt=dt.value;Ct.push(this.conversationStreams.get(Vt))}}catch(zt){Ut.e(zt)}finally{Ut.f()}return Ct}},{key:"getStreamInfo",value:function(dt){return this.conversationStreams.get(dt)}},{key:"getSubscribedStream",value:function(dt){return Mo.get(this).get(Number(dt))}},{key:"linkWhiteboardClientToConversation",value:function(){Ln.warn("DEPRECATED : linkWhiteboardClientToConversation : no more needed")}},{key:"startNewWhiteboardSession",value:function(dt,Ct){var Ut=this;return Ln.debug("startNewWhiteboardSession()"),new Promise(function(Vt,zt){Ut.bind().then(function(){if(Ut.asyncCallbacks)return zt(Wt.g.createError(tt.g.ERROR_OTHER,"startNewWhiteboardSession() - busy",Ln));if(Ut.whiteboardStarted!==tt.g.CONVERSATION_WHITEBOARD_NOT_STARTED)return Vt();Kn.whiteBoardClient.start(),Ut.asyncCallbacks={},Ut.asyncCallbacks.ackHandler=function(Zt){var on=Zt.detail;on.roomId===Ut._getTechnicalName()&&on.roomType==="whiteBoard"&&(on.eventType==="roomCreation"&&on.status==="roomCreated"||on.eventType==="roomJoined"&&on.status==="roomJoined")&&(Ut.asyncCallbacks&&(Kn.removeEventListener("roomCreation",Ut.asyncCallbacks.ackHandler),Kn.removeEventListener("roomJoined",Ut.asyncCallbacks.ackHandler),clearTimeout(Ut.asyncCallbacks.timeoutId),delete Ut.asyncCallbacks),Kn.whiteBoardClient.setCanvas(dt),Ct!=null&&Kn.whiteBoardClient.setUserCursorColor(Ct),Kn.whiteBoardClient.deleteHistory(),Ut.whiteboardStarted=tt.g.CONVERSATION_WHITEBOARD_STARTED,Vt())},Kn.onEvent("roomCreation",Ut.asyncCallbacks.ackHandler),Kn.onEvent("roomJoined",Ut.asyncCallbacks.ackHandler),Ut.asyncCallbacks.timeoutId=setTimeout(function(){return Ut.asyncCallbacks&&(Kn.removeEventListener("roomCreation",Ut.asyncCallbacks.ackHandler),Kn.removeEventListener("roomJoined",Ut.asyncCallbacks.ackHandler),delete Ut.asyncCallbacks),zt(Wt.g.createError(tt.g.ERROR_OTHER,"startNewWhiteboardSession() - timeout",Ln))},tt.g.CONVERSATION_WHITEBOARD_START_DELAY);var Qt=Ut.getCloudConversationId();Kn.whiteBoardClient.joinRoom(Ut._getTechnicalName(),{convId:Qt,webconf:!0})}).catch(function(Qt){zt(Wt.g.createError(tt.g.ERROR_OTHER,"startNewWhiteboardSession() - cannot start whiteboard session",Ln,{fromError:Qt}))})})}},{key:"stopNewWhiteboardSession",value:function(){var dt=this;return Ln.debug("stopNewWhiteboardSession()"),new Promise(function(Ct,Ut){dt.bind().then(function(){return dt.whiteboardStarted!==tt.g.CONVERSATION_WHITEBOARD_STARTED?(Ln.error("Conversation is not joined!"),Ut(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"stopWhiteBoard() - Conversation not joined",Ln))):Kn.whiteBoardClient.roomId!==dt._getTechnicalName()?(Ln.error("Whiteboard session is not joined for this conversation!"),Ut(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"stopWhiteBoard() - whiteboard not joined",Ln))):(Kn.whiteBoardClient.leaveRoom(),Kn.whiteBoardClient.stop(),dt.whiteboardStarted=tt.g.CONVERSATION_WHITEBOARD_NOT_STARTED,void Ct())}).catch(function(Vt){Ut(Wt.g.createError(tt.g.ERROR_OTHER,"stopNewWhiteboardSession() - cannot stop whiteboard session",Ln,{fromError:Vt}))})})}},{key:"enablePointerSharing",value:function(dt){return Zl(this,!0,dt)}},{key:"sendPointerLocation",value:function(dt,Ct,Ut,Vt){Kn.pointerSharingClient.sendPointerLocation(this._getTechnicalName(),dt,Ct,Ut,Vt)}},{key:"sendData",value:function(dt){var Ct=this;return new Promise(function(Ut,Vt){Ct.bind().then(function(){Kn.dataClient.sendDataToGroup(Ct._getTechnicalName(),{event:tt.g.CONVERSATION_SEND_DATA_IDENTIFIER,content:dt,roomname:Ct._getTechnicalName()}),Ut()}).catch(function(zt){Vt(Wt.g.createError(tt.g.ERROR_OTHER,"sendData() - cannot send data",Ln))})})}},{key:"sendRawData",value:function(dt){var Ct=this;return new Promise(function(Ut,Vt){Ct.bind().then(function(){Kn.dataClient.sendDataToGroup(Ct._getTechnicalName(),dt),Ut()}).catch(function(zt){Vt(Wt.g.createError(tt.g.ERROR_OTHER,"sendRawData() - cannot send data",Ln))})})}},{key:"sendCustomEvent",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,zt){Ct.bind().then(function(){var Qt=Ut;Qt.event=dt,Qt.roomname=Ct._getTechnicalName(),Kn.dataClient.sendDataToGroup(Ct._getTechnicalName(),Qt),Vt()}).catch(function(Qt){zt(Wt.g.createError(tt.g.ERROR_OTHER,"sendCustomEvent() - cannot send data",Ln))})})}},{key:"sendMessage",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Vt=function(zt){return new Promise(function(Qt,Zt){var on=Eo.get(Ct);on!==null?wo.saveGroupChatMessage(Ct,on,Kn.getActiveApiKey(),dt,zt,Ut).then(function(){Qt(zt)}).catch(Zt):Qt(zt)})};return new Promise(function(zt,Qt){if(Ct.groupChatStatus!==tt.g.CONVERSATION_STATUS_JOINED&&Ct.status!==tt.g.CONVERSATION_STATUS_JOINED)return Qt(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"sendMessage() - group chat not joined",Ln));if(dt===null||typeof dt!="string")return Qt(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"sendMessage() - wrong type of message",Ln));if(dt==="")return Qt(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"sendMessage() - message parameter is empty",Ln));var Zt={};Wt.g.isTypeof(Ut,"metadata","object")&&(Zt.metadata=Ut.metadata),Kn.sendMessageToGroupChat(Ct._getTechnicalName(),dt,Zt).then(function(on){Vt(on).then(function(){zt(on)}).catch(function(bn){Qt(Wt.g.createError(tt.g.ERROR_OTHER,"sendMessage() - error on save",Ln,{fromError:bn}))})}).catch(function(on){Qt(Wt.g.createError(tt.g.ERROR_OTHER,"sendMessage() - cannot send message",Ln,{fromError:on}))})})}},{key:"pushMedia",value:function(dt,Ct){var Ut=this;return Ct||(Ct={}),new Promise(function(Vt,zt){Ut.bind().then(function(){return Ct.hasOwnProperty("token")||(Ct.token=Eo.get(Ut).token),wo.pushConversationMedia(Po.get(Ut),dt,Kn.getActiveApiKey(),Ct)}).then(function(Qt){Kn.dataClient.sendDataToGroup(Ut._getTechnicalName(),{event:tt.g.CONVERSATION_NEW_MEDIA_IDENTIFIER,roomname:Ut._getTechnicalName(),media:{url:Qt.url,id:Qt.id},command:"new_snapshot",value:{snapshot:Qt.url}}),Vt({url:Qt.url,id:Qt.id})}).catch(function(Qt){zt(Wt.g.createError(tt.g.ERROR_OTHER,"pushMedia() - cannot push media",Ln,{fromError:Qt}))})})}},{key:"pushData",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ut=Wt.g.assignObject({},Ut),new Promise(function(Vt,zt){if(Kn.webRTCClient.webRTCClient.dataChannelCapable!==!0||Ut.forceHTTP===!0){if(!dt.file)return zt(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"pushData() - missing file",Ln));var Qt={};if(Wt.g.isTypeof(dt,"metadata","object"))try{Qt.metadata=JSON.stringify(dt.metadata)}catch(Zt){Ln.error("JSON.stringify",Zt)}Qt.asFile=!0,Wt.g.isTypeof(dt,"filename","string")?Qt.filename=dt.filename:Qt.filename=dt.file.name,dt.overwrite===!0&&(Qt.overwrite=!0),Wt.g.isTypeof(dt,"ttl","number")&&dt.ttl>0&&(Qt.ttl=dt.ttl),Ct.pushMedia(dt.file,Qt).then(Vt).catch(zt)}else Ct.bind().then(function(){var Zt=Ct._getTechnicalName(),on={};Ut.hasOwnProperty("turnServerAddress")&&(on.turnServerAddress=Ut.turnServerAddress,delete Ut.turnServerAddress);var bn=Kn.webRTCClient.webRTCClient.pushData(Ct.getCloudConversationId(),dt,on,{success:function(Rn){if(Rn.state!=="complete")return zt(Wt.g.createError(tt.g.ERROR_OTHER,"pushData() - cannot push data",Ln));Kn.dataClient.sendDataToGroup(Zt,{event:tt.g.CONVERSATION_NEW_MEDIA_IDENTIFIER,roomname:Zt,media:{url:Rn.mediaURL,id:Rn.mediaId},command:"new_snapshot",value:{snapshot:Rn.mediaURL}}),Vt({url:Rn.mediaURL,id:Rn.mediaId})},failure:function(Rn,qn){if(Rn==="iceFailed"){var Jn=Wt.g.assignObject({},Ut);return Jn.forceHTTP=!0,void Ct.pushData(dt,Jn).then(Vt).catch(zt)}if(Rn==="timeout"){if(qn){var dr=Ct.transferCallIds.indexOf(qn);dr>=0&&Ct.transferCallIds.splice(dr,1)}return zt(Wt.g.createError(tt.g.ERROR_TIMED_OUT,"pushData() - push data timed out",Ln))}return zt(Rn==="canceled"?Wt.g.createError(tt.g.ERROR_OPERATION_CANCELED,"pushData() - push data canceled",Ln):Wt.g.createError(tt.g.ERROR_OTHER,"pushData() - cannot push data",Ln,{fromError:Rn}))}});if(!bn)return zt(Wt.g.createError(tt.g.ERROR_OTHER,"pushData() - cannot push data",Ln));Ct.transferCallIds.push(bn)}).catch(function(Zt){return zt(Wt.g.createError(tt.g.ERROR_OTHER,"pushData() - cannot push data",Ln,{fromError:Zt}))})})}},{key:"cancelPushData",value:function(dt){var Ct=this;return new Promise(function(Ut,Vt){if(!Ct.transferCallIds.includes(dt))return Vt(Wt.g.createError(tt.g.ERROR_OTHER,"cancelPushData() - no such push data",Ln));var zt=Kn.webRTCClient.webRTCClient.cancelPushData(dt);if(zt)return Vt(Wt.g.createError(tt.g.ERROR_OTHER,"cancelPushData() - "+zt,Ln));Ut()})}},{key:"fetchMediaList",value:function(dt,Ct){var Ut=this;return Ct||(Ct={}),new Promise(function(Vt,zt){Ut.bind().then(function(){return Object.prototype.hasOwnProperty.call(Ct,"token")||(Wt.g.isTypeof(dt,"object")&&dt instanceof Br?Ct.token=dt.getToken():Ct.token=Eo.get(Ut).token),wo.getConversationMediaList(Po.get(Ut),Kn.getActiveApiKey(),Ct)}).then(Vt).catch(function(Qt){zt(Wt.g.createError(tt.g.ERROR_OTHER,"fetchMediaList() - cannot fetch media list",Ln,{fromError:Qt}))})})}},{key:"getWaitingRoomContacts",value:function(){Ln.debug("getWaitingRoomContacts()");var dt={};if(this.status!==tt.g.CONVERSATION_STATUS_JOINED)Ln.error("getWaitingRoomContacts() - Conversation is not joined, cannot get waiting room contacts");else if(this.getRole()!==tt.g.CONVERSATION_ROLE_MODERATOR)Ln.error("getWaitingRoomContacts() - Role is not moderator, cannot get waiting room contacts");else{var Ct,Ut=Ro.get().getContacts(tt.g.CONVERSATION_WAITING_ROOM_PREFIX+this._getTechnicalName()),Vt=co(Ut.keys());try{for(Vt.s();!(Ct=Vt.n()).done;){var zt=Ct.value;dt[zt]=Ut.get(zt)}}catch(Qt){Vt.e(Qt)}finally{Vt.f()}}return dt}},{key:"fetchMessageHistory",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Vt,zt){Ct.bind().then(function(){return Object.prototype.hasOwnProperty.call(Ut,"token")?wo.loadGroupChatMessages(Ct,null,Ut.token):(Wt.g.isTypeof(dt,"object")&&dt instanceof Br||(dt=Eo.get(Ct)),wo.loadGroupChatMessages(Ct,dt))}).then(function(Qt){var Zt=Qt.map(function(on){var bn={content:on.content,timestamp:1e3*on.created_at,date:new Date(1e3*on.created_at),sender_id:on.user_id,display_name:on.display_name};return on.user_id.toString()!==dt.getId()&&(bn.sender=dt.getOrCreateContact(on.user_id)),bn});Vt(Zt)}).catch(function(Qt){zt(Wt.g.createError(tt.g.ERROR_OTHER,"fetchMessageHistory() - cannot fetch message history",Ln))})})}},{key:"sendInvitation",value:function(dt,Ct){var Ut=this;if(Ct||(Ct={}),dt instanceof No){Ln.info("Invite "+dt.getId()+" to "+this._getTechnicalName()),dt.isOnline()||Ln.warn("sendInvitation() - contact "+dt.getUsername()+" does not seem to be connected.");var Vt={receiveNotifier:new pt};Ct.hasOwnProperty("expirationTime")&&(Vt.expirationTime=Ct.expirationTime);var zt=new Do(dt,this,Vt);zt.type="conversation";var Qt={event:tt.g.CONVERSATION_INVITATION_IDENTIFIER,invitationId:zt.id,roomname:this._getTechnicalName(),sendTime:zt.sendTime,conversationTypes:[]};return this.status===tt.g.CONVERSATION_STATUS_JOINED?Qt.conversationTypes.push("WEBCONF"):this.groupChatStatus===tt.g.CONVERSATION_STATUS_JOINED&&Qt.conversationTypes.push("GROUP_CHAT"),Kn.sendData(dt.getId(),Qt).then(function(){Vt.receiveNotifier.emit("receive")}).catch(function(Zt){var on=Wt.g.createError(Zt,"Invitation not delivered",Ln);tn.get(Ut).emit("messageNotDelivered",{error:on,contact:dt,event:tt.g.CONVERSATION_INVITATION_IDENTIFIER})}),zt}return Ln.error("Parameter is not a contact"),null}},{key:"isRecorded",value:function(){return!!this.recordingStatus}},{key:"getRecordingInfo",value:function(){return this.isRecorded()?this.recordingStatus:null}},{key:"setNetworkCap",value:function(dt,Ct){return typeof dt!="number"||typeof Ct!="number"?(Ln.error("setNetworkCap - wrong cap",dt,Ct),!1):dt<=0||Ct<=0?(this.uploadCap=null,this.downloadCap=null,!0):(this.uploadCap=dt,this.downloadCap=Ct,!0)}},{key:"getNetworkCap",value:function(){var dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.uploadCap||!this.downloadCap)return null;if(dt.capacity)return[this.uploadCap,this.downloadCap];for(var Ct=this.uploadCap,Ut=this.downloadCap,Vt=this.reservedStreams.length;--Vt>=0;)this.reservedStreams[Vt].isVideoMuted||(this.reservedStreams[Vt].isRemote?Ut-=this.reservedStreams[Vt].resource:Ct-=this.reservedStreams[Vt].resource);return[Ct,Ut]}},{key:"getStreamResourceReservation",value:function(dt){for(var Ct=this.reservedStreams.length;--Ct>=0;)if(this.reservedStreams[Ct].streamId===dt)return this.reservedStreams[Ct];return null}},{key:"reserveResources",value:function(dt,Ct,Ut,Vt,zt){var Qt=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(Ln.debug("reserveResources",Ut),this.getStreamResourceReservation(Ut))throw new Error("reserveResources - already reserved stream");var Zt=!1,on={streamId:Ut,profileType:dt,priority:zt,resource:Ct,isRemote:Vt};if(on.isVideoOnly=!!Qt.isVideoOnly,Qt.isVideoMuted)on.isVideoMuted=!0,Zt=!0;else{on.isVideoMuted=!1;var bn=this.getNetworkCap();Zt=Vt?bn[1]>=on.resource:bn[0]>=on.resource}if(Qt.control)return Zt;if(!Zt)throw new Error("reserveResources - no such bandwidth availability");return this.reservedStreams.push(on),this.reservedStreams.sort(function(Rn,qn){return Rn.priority>qn.priority?-1:Rn.priority===qn.priority?0:1}),Ln.debug("reservedStreams",this.reservedStreams),!0}},{key:"releaseResources",value:function(dt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.getNetworkCap({capacity:!0}))return!1;Ln.debug("releaseResources",dt);for(var Ut=!1,Vt=this.reservedStreams.length;--Vt>=0;)if(this.reservedStreams[Vt].streamId===dt){this.reservedStreams.splice(Vt,1),Ut=!0;break}return Ln.debug("reservedStreams",this.reservedStreams),Ut&&Ct.triggerAdaptation&&this.enableHigherPriorityVideo(!!Ct.isRemote),Ut}},{key:"changeStreamPriority",value:function(dt,Ct,Ut){Ln.debug("changeStreamPriority",dt,Ct,Ut);for(var Vt=null,zt=this.reservedStreams.length;--zt>=0;)if(this.reservedStreams[zt].isRemote===Ct&&this.reservedStreams[zt].streamId===dt){Vt=this.reservedStreams[zt];break}return!(!Vt||Vt.priority===Ut||(Vt.priority=Ut,this.reservedStreams.sort(function(Qt,Zt){return Qt.priority>Zt.priority?-1:Qt.priority===Zt.priority?0:1}),Ln.debug("reservedStreams",this.reservedStreams),Vt.isVideoMuted?this.disableLowerPriorityVideo(Vt.isRemote,Vt.resource,Vt.priority)&&Hu(this,Vt):this.enableHigherPriorityVideo(Vt.isRemote,{resource:Vt.resource,priority:Vt.priority,control:!0})&&(zu(this,Vt),this.enableHigherPriorityVideo(Vt.isRemote)),0))}},{key:"disableLowerPriorityVideo",value:function(dt,Ct,Ut){Ln.debug("disableLowerPriorityVideo",dt,Ct,Ut);for(var Vt=[],zt=0,Qt=this.reservedStreams.length;--Qt>=0&&(this.reservedStreams[Qt].isRemote!==dt||this.reservedStreams[Qt].isVideoMuted||this.reservedStreams[Qt].priority>=Ut||(Vt.push(this.reservedStreams[Qt]),!((zt+=this.reservedStreams[Qt].resource)>=Ct))););if(Vt.length===0||zt<Ct)return!1;for(var Zt=Vt.length;--Zt>=0;)zu(this,Vt[Zt]);return!0}},{key:"enableHigherPriorityVideo",value:function(dt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ln.debug("enableHigherPriorityVideo",dt);var Ut=this.getNetworkCap(),Vt=dt?Ut[1]:Ut[0];Ct.resource&&Ct.resource>0&&(Vt+=Ct.resource);for(var zt=[],Qt=0;Qt<this.reservedStreams.length;Qt+=1)this.reservedStreams[Qt].isRemote===dt&&this.reservedStreams[Qt].isVideoMuted&&(Object.prototype.hasOwnProperty.call(Ct,"priority")&&this.reservedStreams[Qt].priority<=Ct.priority||this.reservedStreams[Qt].resource<=Vt&&(Vt-=this.reservedStreams[Qt].resource,zt.push(this.reservedStreams[Qt])));if(zt.length===0)return!1;if(Ct.control)return!0;for(var Zt=zt.length;--Zt>=0;)Hu(this,zt[Zt]);return!0}},{key:"startComposite",value:function(){var dt=this;return new Promise(function(Ct,Ut){if(dt.status!==tt.g.CONVERSATION_STATUS_JOINED)return Ut(Wt.g.createError(tt.g.ERROR_OTHER,"startComposite() - conversation not joined",Ln));Kn.webRTCClient.startComposite(dt._getTechnicalName()),Ct()})}},{key:"stopComposite",value:function(){var dt=this;return new Promise(function(Ct,Ut){if(dt.status!==tt.g.CONVERSATION_STATUS_JOINED)return Ut(Wt.g.createError(tt.g.ERROR_OTHER,"stopComposite() - conversation not joined",Ln));Kn.webRTCClient.stopComposite(dt._getTechnicalName()),Ct()})}},{key:"callVoIP",value:function(dt){var Ct=this;return new Promise(function(Ut,Vt){return dt&&typeof dt=="string"?Ct.status!==tt.g.CONVERSATION_STATUS_JOINED?Vt(Wt.g.createError(tt.g.ERROR_OTHER,"callVoIP() - conversation not joined",Ln)):void Kn.webRTCClient.webRTCClient.MCUClient.inviteVoIP(Ct._getTechnicalName(),Ct.getCloudConversationId(),dt).then(Ut).catch(function(zt){Vt(Wt.g.createError(tt.g.ERROR_OTHER,"callVoIP() - "+zt.message,Ln))}):Vt(Wt.g.createError(tt.g.ERROR_OTHER,"callVoIP() - wrong phoneNumber",Ln))})}},{key:"manageDisconnectionWarningEvent",value:function(dt){Ln.debug("manageDisconnectionWarningEvent",dt.detail);var Ct={};if(this.callIdToStreamId.has(dt.detail.callId)){Ln.debug("call is linked with conversation");var Ut=this.callIdToStreamId.get(dt.detail.callId);Ct=dt.detail.settingUpType==="publish"||dt.detail.settingUpType==="shareScreen"?this.conversationPublishedStreams.get(Ut):this.conversationStreams.get(Ut),tn.get(this).emit("disconnectionWarning",{streamInfo:Ct})}else Ln.debug("call is not linked with conversation")}},{key:"manageErrorEvent",value:function(dt){if(Ln.debug("manageErrorEvent",dt.detail),dt.detail.errorCode==="DISTANT_ICE_CONNECTION_STATE_DISCONNECTED"||dt.detail.errorCode==="DISTANT_ICE_CONNECTION_STATE_FAILED")tn.get(this).emit("error",{errorCode:dt.detail.errorCode,errorInfo:dt.detail.errorInfo,descriptor:dt.detail.data});else if(this.callIdToStreamId.has(dt.detail.callId)){Ln.debug("call is linked with conversation");var Ct=this.callIdToStreamId.get(dt.detail.callId),Ut={streamInfo:dt.detail.settingUpType==="publish"?this.conversationPublishedStreams.get(Ct):this.conversationStreams.get(Ct),errorCode:dt.detail.errorCode,errorInfo:dt.detail.errorInfo,callId:dt.detail.callId,streamId:Ct};if(dt.detail.data&&(Ut.descriptor=dt.detail.data),tn.get(this).emit("error",Ut),Xp.has(dt.detail.errorCode)){var Vt=this.conversationCalls.get(dt.detail.callId);Vt?this.unpublish(Vt.stream):(this.unsubscribeToStream(Ct),dt.detail.errorCode==="CALL_ABORTED"&&this.callIdToStreamId.delete(dt.detail.callId))}}else Ln.debug("call is not linked with conversation")}}],Ot=[{key:"getAvailableEvents",value:function(){return Jp}}],Xt&&$u(Lt.prototype,Xt),Ot&&$u(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(fn),Fu=function(){var $t="guest";if(apiRTC.userAgentInstance){var Lt=apiRTC.userAgentInstance.getUsername();Lt&&($t=Lt)}return $t},Wu=function($t){var Lt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Xt,Ot){var Ft=null;if(Wt.g.isPropertyTypeof(Lt,"session","object")&&Lt.session instanceof Br)Ft=Lt.session;else{if(Br.getActiveSession()===null)return Ot(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"getOrCreateConversation() - missing session",Ln));Ft=Br.getActiveSession()}var sn={};sn.token=Ft.getToken(),sn.active=$t.active,wo.getOrCreateConversation($t,Kn.getActiveApiKey(),sn).then(function(ln){Wt.g.isTypeof(ln,"public_id","string")&&(ln.id=ln.public_id,delete ln.public_id),Po.set($t,ln.id),qo.set($t,ln.data),Wt.g.isTypeof(ln.typeString,"string")&&ju.has(ln.typeString)&&ns.set($t,ln.typeString),Eo.set($t,Ft),Xt(ln)}).catch(function(ln){Po.set($t,null),qo.set($t,null),ns.set($t,null),Ot(Wt.g.createError(tt.g.ERROR_HTTP,"getOrCreateConversation() - cannot get/create conversation",Ln,{fromError:ln}))})})},Qp=function($t){var Lt=$t.getModerator();return Lt?Lt.getId():!$t.conference&&$t.moderationEnabled?"#":null},Zp=function($t,Lt){return new Promise(function(Xt,Ot){if($t.conference){if(Lt.access===tt.g.CONVERSATION_ACCESS_GRANTED)return Xt(Lt);if(Lt.access!==tt.g.CONVERSATION_NEED_MODERATOR_ACCEPTATION)return Ot(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"You were not allowed to join the conference"));var Ft=ro.getOrCreateContact(Lt.moderator);Us.set($t,Ft),Bu($t).then(function(){Xt(Lt)}).catch(Ot)}else{if(!$t.moderationEnabled)return Xt(Object.assign(Lt,{access:tt.g.CONVERSATION_ACCESS_GRANTED,role:tt.g.CONVERSATION_ROLE_GUEST}));if($t.moderator)return Xt(Object.assign(Lt,{access:tt.g.CONVERSATION_ACCESS_GRANTED,role:tt.g.CONVERSATION_ROLE_MODERATOR}));Bu($t).then(function(){Xt(Object.assign(Lt,{access:tt.g.CONVERSATION_NEED_MODERATOR_ACCEPTATION,role:tt.g.CONVERSATION_ROLE_GUEST}))}).catch(Ot)}})},Bu=function($t){return new Promise(function(Lt,Xt){var Ot=$t.getModerator();$t.status=tt.g.CONVERSATION_STATUS_WAITING;var Ft=!1,sn=setTimeout(function(){Kn.apiRTCSession.joinPresenceGroup([tt.g.CONVERSATION_WAITING_ROOM_PREFIX+$t._getTechnicalName()],{doneByApiRTC:!0}),Ft=!0},tt.g.JOIN_WAITING_ROOM_PRESENCE_GROUP_TIMEOUT);Ot&&tn.get($t).emit("waitingForModeratorAcceptance",Ot);var ln=new Do(Ot,$t);ln.id=$t._getTechnicalName(),ln.type=$t.conference?"conference":"conversation",$t.sendJoinRequest();var Jt=function dt(Ct){Ln.debug("dataMessage (waitingRoom)",Ct.detail);var Ut=Ct.detail.data;if(Ut.roomname===$t._getTechnicalName()){var Vt=Ct.detail.senderId.toString();Ut.command==="access"||Ut.command==="access-new"||Ut.event===tt.g.CONVERSATION_JOIN_ANSWER_IDENTIFIER?(delete $t.cancelJoin0,$t.joinRequestIntervalId&&(clearInterval($t.joinRequestIntervalId),delete $t.joinRequestIntervalId),Kn.removeEventListener("receiveData",dt),Ft===!0?Kn.apiRTCSession.leavePresenceGroup([tt.g.CONVERSATION_WAITING_ROOM_PREFIX+$t._getTechnicalName()],{doneByApiRTC:!0}):sn&&clearTimeout(sn),Ut.value.hasOwnProperty("access")&&Ut.value.access||Ut.access?(Kn.sendData(Vt,{roomname:$t._getTechnicalName(),command:"access-ack"}).catch(function(zt){var Qt=Wt.g.createError(zt,"Notification not delivered",Ln);tn.get($t).emit("messageNotDelivered",{error:Qt,contact:Ot,command:"access-ack"})}),Lt()):($t.status=tt.g.CONVERSATION_STATUS_NOT_JOINED,Xt(Wt.g.createError(tt.g.ERROR_NOT_ALLOWED,"You were not allowed to join the conversation",Ln)))):Ut.event===tt.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER&&Ut.roomname===$t._getTechnicalName()&&tn.get($t).emit("moderatorConnected",ro.getOrCreateContact(Vt))}};Kn.onEvent("receiveData",Jt),ln.onResponse(function(dt){Kn.removeEventListener("receiveData",Jt),Ft===!0?Kn.apiRTCSession.leavePresenceGroup([tt.g.CONVERSATION_WAITING_ROOM_PREFIX+$t._getTechnicalName()]):sn&&clearTimeout(sn),dt===tt.g.INVITATION_STATUS_ACCEPTED?Lt():($t.status=tt.g.CONVERSATION_STATUS_NOT_JOINED,Xt(Wt.g.createError(tt.g.ERROR_NOT_ALLOWED,"You were not allowed to join the conversation",Ln)))}),$t.cancelJoin0=function(){return delete $t.cancelJoin0,$t.joinRequestIntervalId&&(clearInterval($t.joinRequestIntervalId),delete $t.joinRequestIntervalId),Kn.removeEventListener("receiveData",Jt),Ft===!0?Kn.apiRTCSession.leavePresenceGroup([tt.g.CONVERSATION_WAITING_ROOM_PREFIX+$t._getTechnicalName()],{doneByApiRTC:!0}):sn&&clearTimeout(sn),$t.status=tt.g.CONVERSATION_STATUS_NOT_JOINED,Xt(Wt.g.createError(tt.g.ERROR_OPERATION_CANCELED,"Operation canceled",Ln)),!0}})},_h=function($t,Lt,Xt){return new Promise(function(Ot){wo.updateConferencePresence($t,Lt,Xt).then(Ot,function(Ft){Ln.warn("updateConferencePresence",Ft),Ot()})})},Vu=function($t,Lt){var Xt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Ot=Xt.stream;if(!Ot){var Ft=$t.conversationCalls.get(Lt);if(!Ft)return!1;Ot=Ft.stream}return Xt.noTriggerAdaptation?$t.releaseResources(Ot.userMediaStreamId):$t.releaseResources(Ot.userMediaStreamId,{triggerAdaptation:!0}),Ot.publishedInConversations.delete($t.getName()),$t.conversationPublishedStreams.delete(Ot.userMediaStreamId),$t.callIdToStreamId.delete(Lt),$t.conversationCalls.delete(Lt),!0},zu=function($t,Lt){var Xt={streamId:Lt.streamId,isRemote:Lt.isRemote};if(Lt.isRemote)if(Lt.isVideoOnly){Xt.action="hangup";var Ot=Mo.get($t).get(Lt.streamId);Ot&&(Xt.callId=Ot.callId),Ln.debug("disableVideoTrack - hangup",Lt.streamId),$t.unsubscribeToStream(Lt.streamId,{noTriggerAdaptation:!0})}else{Xt.action="disableTrack",Xt.trackType="video";var Ft=Mo.get($t).get(Lt.streamId);Ft&&(Xt.callId=Ft.callId),Ln.debug("disableVideoTrack - disable video track",Lt.streamId),$t.updateSubscribedStream(Lt.streamId,{audioOnly:!0}).catch(function(dt){Ln.error("disableVideoTrack - updateSubscribedStream",dt)}),Lt.isVideoMuted=!0}else if(Lt.isVideoOnly){Xt.action="hangup";var sn=yo.get(Lt.streamId),ln=$t.getConversationCall(sn);ln&&(Xt.callId=ln.callId),Ln.debug("disableVideoTrack - hangup",Lt.streamId),$t.unpublish(sn,{noTriggerAdaptation:!0})}else{var Jt=$t.getConversationCall(yo.get(Lt.streamId));Jt?(Xt.action="disableTrack",Xt.trackType="video",Xt.callId=Jt.callId,Ln.debug("disableVideoTrack - disable video track",Lt.streamId),Jt.updatePublishedStream("video",!1).catch(function(dt){Ln.error("disableVideoTrack - updatePublishedStream",dt)}),Lt.isVideoMuted=!0):Xt=null}Xt&&tn.get($t).emit("adaptationTriggered",Xt)},Hu=function($t,Lt){var Xt={streamId:Lt.streamId,isRemote:Lt.isRemote,action:"enableTrack",trackType:"video"};if(Lt.isRemote){var Ot=Mo.get($t).get(Lt.streamId);Ot&&(Xt.callId=Ot.callId),Ln.debug("enableVideoTrack - enable video track",Lt.streamId),$t.updateSubscribedStream(Lt.streamId,{audioOnly:!1}).catch(function(sn){Ln.error("enableVideoTrack - updateSubscribedStream",sn)}),Lt.isVideoMuted=!1}else{var Ft=$t.getConversationCall(yo.get(Lt.streamId));Ft?(Xt.callId=Ft.callId,Ln.debug("enableVideoTrack - enable video track",Lt.streamId),Ft.updatePublishedStream("video",!0).catch(function(sn){Ln.error("enableVideoTrack - updatePublishedStream",sn)}),Lt.isVideoMuted=!1):Xt=null}Xt&&tn.get($t).emit("adaptationTriggered",Xt)},Zl=function($t,Lt,Xt){return Xt===!0?$t.pointerSharingState===tt.g.STATE_IDLE?($t.pointerSharingState=tt.g.STATE_JOINING,new Promise(function(Ot,Ft){Kn.pointerSharingClient.joinRoom($t._getTechnicalName(),{success:function(sn){$t.pointerSharingState=tt.g.STATE_ACTIVE,Lt===!0&&($t.pointerSharingAutoInvite=!0);var ln={enabled:!0,roomId:sn};tn.get($t).emit("pointerSharingEnabled",ln),Ot(),$t.pointerSharingAutoInvite===!0&&ro.getContacts($t._getTechnicalName()).forEach(function(Jt){Kn.pointerSharingClient.inviteInRoom($t._getTechnicalName(),Jt.getId())})},failure:function(sn,ln){$t.pointerSharingState=tt.g.STATE_IDLE,$t.pointerSharingAutoInvite=!1,Ft(sn)}})})):Promise.reject(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"enablePointerSharing() - cannot enable pointer sharing")):Xt===!1?$t.pointerSharingState===tt.g.STATE_ACTIVE?($t.pointerSharingState=tt.g.STATE_LEAVING,new Promise(function(Ot,Ft){Kn.pointerSharingClient.leaveRoom($t._getTechnicalName()),$t.pointerSharingState=tt.g.STATE_IDLE,$t.pointerSharingAutoInvite=!1;var sn={enabled:!1,roomId:$t._getTechnicalName()};tn.get($t).emit("pointerSharingEnabled",sn),Ot()})):Promise.reject(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"enablePointerSharing() - cannot disable pointer sharing")):Promise.reject(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"enablePointerSharing() - cannot enable/disable pointer sharing"))},Fs=function($t,Lt){var Xt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return["roomName","callId","clientId"].forEach(function(Ot){Lt.hasOwnProperty(Ot)&&(Xt[Ot]=String(Lt[Ot]))}),Xt};function _c($t){return _c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},_c($t)}function _f($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function Gu($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function _d(){return _d=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function($t,Lt,Xt){var Ot=em($t,Lt);if(Ot){var Ft=Object.getOwnPropertyDescriptor(Ot,Lt);return Ft.get?Ft.get.call(arguments.length<3?$t:Xt):Ft.value}},_d.apply(this,arguments)}function em($t,Lt){for(;!Object.prototype.hasOwnProperty.call($t,Lt)&&($t=Ko($t))!==null;);return $t}function eu($t,Lt){return eu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},eu($t,Lt)}function tm($t,Lt){if(Lt&&(_c(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Xt){if(Xt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xt}($t)}function Ko($t){return Ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Ko($t)}var ba=mt.Y.get("Conference"),nm=jo.getAvailableEvents().concat(["closed"]),Ws=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&eu(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=Ko(Ft);if(sn){var Ut=Ko(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return tm(this,dt)});function Jt(dt){var Ct,Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _f(this,Jt),Ct=ln.call(this,dt,Ut),ba.info("Create conference"),Ct.conference=!0,Ct.friendlyName=Ut.hasOwnProperty("friendlyName")?Ut.friendlyName:dt,Ct}return Lt=Jt,Ot=[{key:"getAvailableEvents",value:function(){return nm}}],(Xt=[{key:"destroy",value:function(){uo.get().deleteConference(this.getName()),_d(Ko(Jt.prototype),"destroy",this).call(this)}},{key:"_getTechnicalName",value:function(){return rm()+ts.get(this)}},{key:"getFriendlyName",value:function(){return this.friendlyName}},{key:"getInfo",value:function(){var dt=this;return new Promise(function(Ct,Ut){var Vt={},zt=Eo.get(dt);zt&&(Vt.token=zt.getToken()),wo.getWebconf(dt._getTechnicalName(),Vt).then(function(Qt){return Ct({dtmfCode:Qt.dtmfCode,endTime:Qt.end,hasPassword:Qt.hasPassword,sipNumber:Qt.sipNumber,startTime:Qt.start,state:Qt.state,type:Qt.type})}).catch(function(Qt){return Ut(Wt.g.createError(tt.g.ERROR_OTHER,"getInfo() - Cannot get conference info",ba))})})}},{key:"close",value:function(){var dt=this;return ba.debug("Closing "+this.getName()),new Promise(function(Ct,Ut){dt.status!==tt.g.CONVERSATION_STATUS_JOINED?Ut(Wt.g.createError(tt.g.ERROR_OTHER,"close() - Conversation has to be joined to be closed",ba)):dt.getRole()!==tt.g.CONVERSATION_ROLE_MODERATOR?Ut(Wt.g.createError(tt.g.ERROR_UNAUTHORIZED,"close() - Role has to be moderator to close the conversation",ba)):wo.closeConferenceInstance(dt,Eo.get(dt)).then(function(){ba.debug("Conversation closed successfully"),Kn.dataClient.sendDataToGroup(dt._getTechnicalName(),{event:tt.g.CONVERSATION_CLOSED_IDENTIFIER,instanceId:dt.getInstanceId(),roomname:dt._getTechnicalName()}),tn.get(dt).emit("closed"),dt.leave(),Ct()}).catch(function(Vt){var zt="close() - An error occured when closing conversation",Qt={error:new Error(zt),code:tt.g.ERROR_OTHER};ba.error(zt,Vt),Vt.hasOwnProperty("code")?Qt.code=Vt.code:Vt.hasOwnProperty("http_code")&&(Qt.code=Vt.http_code.toString().startsWith("4")?tt.g.ERROR_UNAUTHORIZED:tt.g.ERROR_SERVER_UNAVAILABLE),Ut(Qt)})})}},{key:"sendInvitation",value:function(dt,Ct){var Ut=this;if(Ct||(Ct={}),dt instanceof No){ba.info("Invite "+dt.getId()+" to "+this._getTechnicalName()),dt.isOnline()||ba.warn("sendInvitation() - contact "+dt.getUsername()+" does not seem to be connected.");var Vt={receiveNotifier:new pt};Ct.hasOwnProperty("expirationTime")&&(Vt.expirationTime=Ct.expirationTime);var zt=new Do(dt,this,Vt),Qt={event:tt.g.CONVERSATION_INVITATION_IDENTIFIER,invitationId:zt.id,roomname:this._getTechnicalName(),friendlyName:this.getFriendlyName(),sendTime:zt.sendTime};return zt.type="conference",$s.get(this)!==null&&(Qt.password=$s.get(this)),Kn.sendData(dt.getId(),Qt).then(function(){Vt.receiveNotifier.emit("receive")}).catch(function(Zt){var on=Wt.g.createError(Zt,"Invitation not delivered",ba);tn.get(Ut).emit("messageNotDelivered",{error:on,contact:dt,event:tt.g.CONVERSATION_INVITATION_IDENTIFIER})}),zt}return ba.error("Parameter is not a contact"),null}},{key:"getTags",value:function(){var dt=this;return new Promise(function(Ct,Ut){var Vt=Br.getActiveSession();if(!Vt)return Ut(Wt.g.createError(tt.g.ERROR_NOT_ALLOWED,"getTags() - no session found",ba));var zt=Vt.getUserAgent().getEnterprise();if(!zt)return Ut(Wt.g.createError(tt.g.ERROR_NOT_ALLOWED,"getTags() - no enterprise found",ba));zt.getTags(dt).then(function(Qt){for(var Zt=[],on=0;on<Qt.length;on+=1)Qt[on].selected===!0&&Zt.push(Qt[on]);return Ct(Zt)}).catch(function(Qt){return Ut(Wt.g.createError(tt.g.ERROR_NOT_ALLOWED,"getTags() - cannot get tags",ba,{fromError:Qt}))})})}},{key:"setTags",value:function(dt){var Ct=this;return new Promise(function(Ut,Vt){if(!Array.isArray(dt))return Vt(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"setTags() - wrong tags",ba));if(!Ct.webconfId)return Vt(Wt.g.createError(tt.g.ERROR_NOT_ALLOWED,"setTags() - no webconf found",ba));var zt=Br.getActiveSession();if(!zt)return Vt(Wt.g.createError(tt.g.ERROR_NOT_ALLOWED,"setTags() - no session found",ba));var Qt=zt.getUserAgent().getEnterprise();if(!Qt)return Vt(Wt.g.createError(tt.g.ERROR_NOT_ALLOWED,"setTags() - no enterprise found",ba));var Zt=zt.getToken();if(!Zt)return Vt(Wt.g.createError(tt.g.ERROR_NOT_ALLOWED,"setTags() - no token found",ba));for(var on=[],bn=0;bn<dt.length;bn+=1){if(!dt[bn].hasOwnProperty("id"))return Vt(Wt.g.createError(tt.g.ERROR_BAD_PARAMETER,"setTags() - wrong tags",ba));on.push(dt[bn].id)}wo.updateWebconfTags(Qt.getId(),Ct.webconfId,on,Zt).then(function(){return Ut()}).catch(function(Rn){return Vt(Wt.g.createError(tt.g.ERROR_OTHER,"setTags() - cannot set tags",ba,{fromError:Rn}))})})}}])&&Gu(Lt.prototype,Xt),Ot&&Gu(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(jo),rm=function(){return Kn.getActiveApiKey()+":"};function qu($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}mt.Y.get("ConversationCatalog");var rs=null,uo=function(){function $t(){if(function(Ft,sn){if(!(Ft instanceof sn))throw new TypeError("Cannot call a class as a function")}(this,$t),rs!==null)throw"Cannot construct singleton ConversationCatalog";this.conversationList=new Map,this.conferenceList=new Map,rs=this}var Lt,Xt,Ot;return Lt=$t,Xt=[{key:"deleteConversation",value:function(Ft){return!!(Wt.g.isTypeof(Ft,"string")&&Ft.length>0)&&this.conversationList.delete(Ft)}},{key:"deleteConference",value:function(Ft){return!!(Wt.g.isTypeof(Ft,"string")&&Ft.length>0)&&this.conferenceList.delete(Ft)}},{key:"getOrCreateConversation",value:function(Ft){var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ln=null;return Ft!=null&&Ft!==""?this.conversationList.has(Ft.toString())?ln=this.conversationList.get(Ft.toString()):(ln=new jo(Ft.toString(),sn),this.conversationList.set(Ft.toString(),ln)):(ln=new jo(null,sn),this.conversationList.set(ln.getName(),ln)),ln}},{key:"getOrCreateConference",value:function(Ft){var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ln=null;return Ft!=null&&Ft!==""?this.conferenceList.has(Ft.toString())?ln=this.conferenceList.get(Ft.toString()):(ln=new Ws(Ft.toString(),sn),this.conferenceList.set(Ft.toString(),ln)):(ln=new Ws(null,sn),this.conferenceList.set(ln.getName(),ln)),ln}},{key:"getConversations",value:function(){return this.conversationList}},{key:"getConferences",value:function(){return this.conferenceList}},{key:"isConference",value:function(Ft){return Ku(Ft).hasOwnProperty("apiKey")}},{key:"getNameFromTechnicalName",value:function(Ft){return Ku(Ft).name}}],Ot=[{key:"get",value:function(){return rs===null&&(rs=new $t),rs}}],Xt&&qu(Lt.prototype,Xt),Ot&&qu(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function Ku($t){var Lt=$t.match(/^([^:]+)[:]([^:]+)$/);return Lt===null||Lt.length<3?{name:$t}:{apiKey:Lt[1],name:Lt[2]}}function tu($t){return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},tu($t)}function Jo($t,Lt){var Xt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Xt){if(Array.isArray($t)||(Xt=function(dt,Ct){if(dt){if(typeof dt=="string")return Ju(dt,Ct);var Ut=Object.prototype.toString.call(dt).slice(8,-1);return Ut==="Object"&&dt.constructor&&(Ut=dt.constructor.name),Ut==="Map"||Ut==="Set"?Array.from(dt):Ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ut)?Ju(dt,Ct):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Xt&&($t=Xt);var Ot=0,Ft=function(){};return{s:Ft,n:function(){return Ot>=$t.length?{done:!0}:{done:!1,value:$t[Ot++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Jt=!1;return{s:function(){Xt=Xt.call($t)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Jt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Jt)throw sn}}}}function Ju($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Xt=0,Ot=new Array(Lt);Xt<Lt;Xt++)Ot[Xt]=$t[Xt];return Ot}function Yu($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function nu($t,Lt){return nu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},nu($t,Lt)}function im($t,Lt){if(Lt&&(tu(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pr($t)}function Pr($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Bs($t){return Bs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Bs($t)}var cr=mt.Y.get("Session"),zr=wn.get(),Vs=new(Go()),ao=Or.get(),am=["rawData","whiteboardInvitation","fileTransferInvitation","conversationMessage","conversationData","dataChannelInvitation","contactMessage","contactData","customEvent","conversationInvitation","incomingCall","disconnect","error","contactListUpdate","reconnecting","reconnection","conversationJoinRequest","newMediaAvailableFromContact","whiteboardRoomMemberUpdate","incomingScreenSharingCall","pointerSharingInvitation","pointerLocationChanged","incomingScreenSharingCallInvitation","cloudEventOccurred","remoteAccessInvitation"],Xu=new WeakMap,as=new WeakMap,zs=null,ru=new WeakMap,ss=new WeakMap,Br=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&nu(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=Bs(Ft);if(sn){var Ut=Bs(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return im(this,dt)});function Jt(dt){var Ct;(function(Qt,Zt){if(!(Qt instanceof Zt))throw new TypeError("Cannot call a class as a function")})(this,Jt),Ct=ln.call(this,cr),cr.debug("Create Session"),Ct.id=null,Ct.token=null,Ct.ccsToken=null,Xu.set(Pr(Ct),dt),as.set(Pr(Ct),null),ss.set(Pr(Ct),{}),Ct.isRecording=!1,Ct.userData=new Io,Ct.contactListUpdateListenerSetted=!1,Ct.waitingContactListUpdateEvent=[];var Ut=Ro.get(),Vt=uo.get(),zt={};return Ct.invitationsMap=new Map,zt.channelEvent=function(Qt){switch(Qt.detail.channelEvent){case"onChannelReconnecting":tn.get(Pr(Ct)).emit("reconnecting",Qt);break;case"onChannelReconnect":tn.get(Pr(Ct)).emit("reconnection",Qt);break;case"onChannelError":tn.get(Pr(Ct)).emit("error",Qt);break;case"onChannelDisconnect":cr.error("Session :: onChannelDisconnect"),tn.get(Pr(Ct)).emit("disconnect",Qt)}},zt.incomingCall=function(Qt){var Zt=Ut.getOrCreateContact(Qt.detail.callerId),on=Qt.detail.callId.toString();if(Qt.detail.callType==="data")if(cr.info("Received file transfer invitation from "+Zt.getUsername()),Wt.g._private.dataCallsFileInfo.has(on)){var bn=Wt.g._private.dataCallsFileInfo.get(on),Rn=null;Ct.invitationsMap.has(Qt.detail.callerId+"-sendfile-"+on)?(Rn=Ct.invitationsMap.get(Qt.detail.callerId+"-sendfile-"+on),cr.debug("invitation already exist :",Rn)):(Rn=new eo(Zt,on,bn),Ct.invitationsMap.set(Qt.detail.callerId+"-sendfile-"+on,Rn)),tn.get(Pr(Ct)).emit("fileTransferInvitation",Rn)}else Wt.g._private.dataChannelInvitations.has(on)?tn.get(Pr(Ct)).emit("dataChannelInvitation",new zo(Zt,on)):(cr.debug("File information has not been received yet, putting invitation on hold"),Wt.g._private.dataCallsOnHold.set(on));else if(Qt.detail.callType==="screenSharing"||Qt.detail.callType==="screenSharingWithAudio")if(apiRTC.session.apiCCWebRTCClient.webRTCClient.userAcceptOnIncomingScreenSharingCall===!0){cr.debug("Received screenSharingCallInvitation from "+Zt.getUsername());var qn=new Ir(Zt,on,Qt.detail.callType,{isRecorded:!!Qt.detail.hasOwnProperty("recordedCall")&&Qt.detail.recordedCall});tn.get(Pr(Ct)).emit("incomingScreenSharingCallInvitation",qn)}else{cr.debug("Received screenSharingCall from "+Zt.getUsername());var Jn=ao.getOrCreateCall(on,Zt,{started:!0,isRecorded:!!Qt.detail.hasOwnProperty("recordedCall")&&Qt.detail.recordedCall});tn.get(Pr(Ct)).emit("incomingScreenSharingCall",Jn)}else{cr.info("Received call invitation from "+Zt.getUsername());var dr=new Ir(Zt,on,Qt.detail.callType,{isRecorded:!!Qt.detail.hasOwnProperty("recordedCall")&&Qt.detail.recordedCall});tn.get(Pr(Ct)).emit("incomingCall",dr)}},zt.roomInvitation=function(Qt){var Zt=Ut.getOrCreateContact(Qt.detail.senderId);if(Qt.detail.roomType==="whiteBoard"){if(Zt!==null){cr.info("Received whiteboard invitation from "+Zt.getUsername());var on={};Qt.detail.cloudConvId&&(on.cloudConvId=Qt.detail.cloudConvId),Qt.detail.webconf===!0&&(on.webconf=!0),tn.get(Pr(Ct)).emit("whiteboardInvitation",new Cs(Zt,Qt.detail.roomId,on))}}else Qt.detail.roomType==="pointerSharing"&&(Zt===null||Vt.getConversations().has(Qt.detail.roomId)||Vt.getConferences().has(Qt.detail.roomId)||(cr.info("Received pointer sharing invitation from "+Zt.getUsername()),tn.get(Pr(Ct)).emit("pointerSharingInvitation",new _l(Zt,Qt.detail.roomId,Pr(Ct)))))},zt.roomMemberUpdate=function(Qt){var Zt,on=[],bn=Jo(Qt.detail.contactList);try{for(bn.s();!(Zt=bn.n()).done;){var Rn=Zt.value;on.push(Ut.getOrCreateContact(Rn.contactId))}}catch(qn){bn.e(qn)}finally{bn.f()}Qt.detail.roomType==="whiteBoard"&&(cr.info("Received whiteboard room member update"),tn.get(Pr(Ct)).emit("whiteboardRoomMemberUpdate",{contacts:on,roomId:Qt.detail.roomId,status:Qt.detail.status}))},zt.receiveRoomMessage=function(Qt){if(cr.debug("receiveRoomMessage",Qt),Qt.detail.roomType==="pointerSharing"&&Qt.detail.message.type==="pointerLocation"&&ss.get(Pr(Ct)).hasOwnProperty(Qt.detail.roomId)){var Zt={sender:Ut.getOrCreateContact(Qt.detail.senderId),source:Qt.detail.message.source,x:Qt.detail.message.x,y:Qt.detail.message.y};Wt.g.isPropertyTypeof(Qt.detail.message,"data","object")&&(Zt.data=Qt.detail.message.data),tn.get(Pr(Ct)).emit("pointerLocationChanged",Zt)}},zt.receiveIMMessage=function(Qt){var Zt=Ut.getOrCreateContact(Qt.detail.senderId);cr.debug("Received IM from "+Zt.getUsername()+" : ",Qt.detail.message),tn.get(Pr(Ct)).emit("contactMessage",{sender:Zt,content:Qt.detail.message,uuid:Qt.detail.UUCSeq,time:Qt.detail.time})},zt.receiveData=function(Qt){var Zt=Ut.getOrCreateContact(Qt.detail.senderId),on=Qt.detail.data;if(on!==void 0){var bn=null;if(on.roomname!==void 0&&(bn=Vt.isConference(on.roomname)?Vt.getOrCreateConference(Vt.getNameFromTechnicalName(on.roomname)):Vt.getOrCreateConversation(Vt.getNameFromTechnicalName(on.roomname))),cr.trace("Received data from "+Zt.getId(),Qt.detail),tn.get(Pr(Ct)).emit("rawData",{sender:Zt,content:on}),on.event!==void 0)switch(on.event){case tt.g.INVITATION_ANSWER_IDENTIFIER:case tt.g.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER:break;case tt.g.CONTACT_SEND_DATA_IDENTIFIER:cr.debug("Received contact data from "+Zt.getUsername(),on.content),tn.get(Pr(Ct)).emit("contactData",{sender:Zt,content:on.content});break;case tt.g.CONVERSATION_SEND_DATA_IDENTIFIER:on.roomname!==void 0&&(cr.debug("Received conversation data from "+Zt.getUsername(),on.content),tn.get(Pr(Ct)).emit("conversationData",{sender:Zt,conversation:bn,content:on.content}));break;case tt.g.CONTACT_NEW_MEDIA_IDENTIFIER:tn.get(Pr(Ct)).emit("newMediaAvailableFromContact",{sender:Zt,media:on.media});break;case tt.g.CONTACT_DATACHANNEL_INVITATION:cr.debug("Received datachannel invitation from "+Zt.getUsername()),Wt.g._private.dataChannelInvitations.set(on.callId.toString(),!0),Wt.g._private.dataCallsOnHold.has(on.callId.toString())&&tn.get(Pr(Ct)).emit("dataChannelInvitation",new zo(Zt,on.callId.toString()));break;case tt.g.CONTACT_SEND_FILEINFO_IDENTIFIER:cr.debug("Received file info from "+Zt.getUsername(),on.fileInfo);var Rn=on.callId.toString();if(Wt.g._private.dataCallsFileInfo.set(Rn,on.fileInfo),Wt.g._private.dataCallsOnHold.has(Rn)){var qn=null;Ct.invitationsMap.has(Zt.getId()+"-sendfile-"+Rn)?(qn=Ct.invitationsMap.get(Zt.getId()+"-sendfile-"+Rn),cr.debug("invitation already exist :",qn)):(qn=new eo(Zt,Rn,on.fileInfo),Ct.invitationsMap.set(Qt.detail.callerId+"-sendfile-"+Rn,qn)),tn.get(Pr(Ct)).emit("fileTransferInvitation",qn)}else cr.debug("no dataCallsOnHold");break;case tt.g.CONVERSATION_INVITATION_IDENTIFIER:if(on.roomname!==void 0){cr.info("Received conversation invitation from "+Zt.getUsername());var Jn={session:Pr(Ct)};on.hasOwnProperty("password")&&(Jn.password=on.password),bn?(on.hasOwnProperty("friendlyName")&&bn.name===bn.friendlyName&&(bn.friendlyName=on.friendlyName),tn.get(Pr(Ct)).emit("conversationInvitation",new jt(Zt,on,bn,Jn))):tn.get(Pr(Ct)).emit("conversationInvitation",new jt(Zt,on,null,Jn))}break;case tt.g.CONVERSATION_JOIN_REQUEST_IDENTIFIER:cr.info("Received conversation join request from "+Zt.getUsername()),bn?tn.get(Pr(Ct)).emit("conversationJoinRequest",new Ho(Zt,bn,on.invitationId)):tn.get(Pr(Ct)).emit("conversationJoinRequest",new Ho(Zt,null,null));break;case tt.g.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER:case tt.g.CONVERSATION_CLOSED_IDENTIFIER:break;case tt.g.CONTACT_REMOTEACCESS_INVITATION_IDENTIFIER:if(cr.debug("Received remote access invitation"),apiRTC.session.remoteAccessInvitation===null){var dr=new Op(Zt,on,bn,{});apiRTC.session.remoteAccessInvitation=dr,tn.get(Pr(Ct)).emit("remoteAccessInvitation",dr)}else cr.error("remoteAccess session is already ongoing");break;case tt.g.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER:case tt.g.CONTACT_REMOTEACCESS_STOP_IDENTIFIER:case tt.g.CONTACT_REMOTEACCESS_APP_MESSAGE:case tt.g.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE:break;default:var hr={event:on.event,content:on,sender:Zt};bn!==null&&(hr.conversation=bn),tn.get(Pr(Ct)).emit("customEvent",hr)}else if(on.command!==void 0)switch(on.command){case"userWaiting":case"userWaiting-new":cr.info("Received conversation join request from "+Zt.getUsername()),bn?tn.get(Pr(Ct)).emit("conversationJoinRequest",new Ho(Zt,bn,null)):tn.get(Pr(Ct)).emit("conversationJoinRequest",new Ho(Zt,null,null))}}else cr.debug("Received data undefined, leaving process")},zt.receiveGroupChatMessage=function(Qt){var Zt=Ut.getOrCreateContact(Qt.detail.senderId),on=null,bn=Qt.detail.groupChatId.toString();if(bn!==void 0&&(on=Vt.isConference(bn)?Vt.getOrCreateConference(Vt.getNameFromTechnicalName(bn)):Vt.getOrCreateConversation(Vt.getNameFromTechnicalName(bn))),on!==null){cr.debug("Received conversation message from "+Zt.getUsername(),Qt.detail.message);var Rn={sender:Zt,conversation:on,content:Qt.detail.message};Wt.g.isTypeof(Qt.detail,"metadata","object")&&(Rn.metadata=Qt.detail.metadata),tn.get(Pr(Ct)).emit("conversationMessage",Rn)}},zt.cloudEventOccurred=function(Qt){var Zt={topic:Qt.detail.topic,target:Qt.detail.target};tn.get(Pr(Ct)).emit("cloudEventOccurred",Zt)},zt.callEstablished=function(Qt){if(Qt.detail.callId!==void 0){var Zt=Qt.detail.callId.toString();cr.debug("callEstablished",Qt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&on.manageCallEstablishedEvent(Qt)}else cr.debug("callEstablished",Qt.detail)},zt.remoteStreamAdded=function(Qt){if(Qt.detail.callId!==void 0){var Zt=Qt.detail.callId.toString();cr.debug("remoteStreamAdded",Qt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&on.manageRemoteStreamAddedEvent(Qt)}else cr.debug("remoteStreamAdded",Qt.detail)},zt.remoteStreamRemoved=function(Qt){if(Qt.detail.callId!==void 0){var Zt=Qt.detail.callId.toString();cr.debug("remoteStreamRemoved",Qt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&on.manageRemoteStreamRemovedEvent(Qt)}else cr.debug("remoteStreamRemoved",Qt.detail)},zt.userMediaSuccess=function(Qt){var Zt=null;if(Qt.detail.callId!==void 0&&Qt.detail.callId!==null){Zt=Qt.detail.callId.toString(),cr.debug("userMediaSuccess",Qt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&on.manageUserMediaSuccessEvent(Qt)}else cr.debug("userMediaSuccess",Qt.detail)},zt.onCallStatsUpdate=function(Qt){if(Qt.detail.callId!==void 0){var Zt=Qt.detail.callId.toString(),on=ao.getCall(Zt,null,{});on!==null&&on.manageCallStatsUpdateEvent(Qt)}else cr.debug("onCallStatsUpdate",Qt.detail)},zt.error=function(Qt){if(cr.debug("error",Qt.detail),Qt.detail.roomName!==null&&Qt.detail.roomName!==void 0){cr.debug("error on conversation :",Qt.detail,Qt.detail.roomName,Qt.detail.callId);var Zt=null;Qt.detail.roomName!==void 0&&(Zt=Vt.isConference(Qt.detail.roomName)?Vt.getOrCreateConference(Vt.getNameFromTechnicalName(Qt.detail.roomName)):Vt.getOrCreateConversation(Vt.getNameFromTechnicalName(Qt.detail.roomName)))!==null&&Zt.manageErrorEvent(Qt)}else if(Qt.detail.callId!==void 0){var on=Qt.detail.callId.toString();cr.debug("error",Qt.detail,on);var bn=ao.getCall(on,null,{});bn!==null&&(bn.manageErrorEvent(Qt),Qt.detail.errorCode==="RECORDING_FAILED"&&ao.removeCallFromList(bn.getId()))}else cr.debug("error",Qt.detail),tn.get(Pr(Ct)).emit("error",Qt.detail)},zt.disconnectionWarning=function(Qt){if(Qt.detail.roomName!==null){cr.debug("disconnectionWarning on conversation :",Qt.detail,Qt.detail.roomName,Qt.detail.callId);var Zt=null;Qt.detail.roomName!==void 0&&(Zt=Vt.isConference(Qt.detail.roomName)?Vt.getOrCreateConference(Vt.getNameFromTechnicalName(Qt.detail.roomName)):Vt.getOrCreateConversation(Vt.getNameFromTechnicalName(Qt.detail.roomName)))!==null&&Zt.manageDisconnectionWarningEvent(Qt)}else if(Qt.detail.callId){var on=Qt.detail.callId.toString();cr.debug("disconnectionWarning",Qt.detail,on);var bn=ao.getCall(on,null,{});bn!==null&&bn.manageDisconnectionWarningEvent(Qt)}else cr.debug("disconnectionWarning",Qt.detail)},zt.hangup=function(Qt){if(Qt.detail.callId){var Zt=Qt.detail.callId.toString();cr.debug("hangup",Qt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&(on.manageHangupEvent(Qt),on.isRecorded()===!1&&ao.removeCallFromList(on.getId()))}else cr.debug("hangup",Qt.detail)},zt.recordedStreamsAvailable=function(Qt){if(Qt.detail.userId2){var Zt=Ut.getOrCreateContact(Qt.detail.userId2),on=ao.getCall(null,Zt);on&&(on.manageRecordAvailableEvent(Qt),ao.removeCallFromList(on.getId()))}else cr.debug("recordedStreamsAvailable",Qt.detail)},zt.desktopCapture=function(Qt){if(Qt.detail.callId){var Zt=Qt.detail.callId.toString();cr.warn("desktopCapture",Qt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&(on.manageDesktopCaptureEvent(Qt),ao.removeCallFromList(on.getId()))}else cr.debug("desktopCapture",Qt.detail)},zt.userMediaError=function(Qt){if(Qt.detail.callId){var Zt=Qt.detail.callId.toString();cr.warn("userMediaError",Qt.detail,Zt);var on=ao.getCall(Zt,null,{});on!==null&&(on.manageUserMediaErrorEvent(Qt),Qt.detail.tryAudioCallActivated===!1&&ao.removeCallFromList(on.getId()))}else cr.debug("userMediaError",Qt.detail)},cr.debug("av apiRTCManager onEvent ..."),zr.onEvent("disconnectionWarning",zt.disconnectionWarning).onEvent("incomingCall",zt.incomingCall).onEvent("roomInvitation",zt.roomInvitation).onEvent("roomMemberUpdate",zt.roomMemberUpdate).onEvent("receiveRoomMessage",zt.receiveRoomMessage).onEvent("receiveIMMessage",zt.receiveIMMessage).onEvent("receiveData",zt.receiveData).onEvent("receiveGroupChatMessage",zt.receiveGroupChatMessage).onEvent("cloudEventOccurred",zt.cloudEventOccurred).onEvent("callEstablished",zt.callEstablished).onEvent("remoteStreamAdded",zt.remoteStreamAdded).onEvent("remoteStreamRemoved",zt.remoteStreamRemoved).onEvent("userMediaSuccess",zt.userMediaSuccess).onEvent("onCallStatsUpdate",zt.onCallStatsUpdate).onEvent("error",zt.error).onEvent("hangup",zt.hangup).onEvent("recordedStreamsAvailable",zt.recordedStreamsAvailable).onEvent("desktopCapture",zt.desktopCapture).onEvent("userMediaError",zt.userMediaError),apiRTC.addEventListener("channelEvent",zt.channelEvent),Ut.onUpdate(function(Qt){Ct.contactListUpdateListenerSetted===!1&&(cr.debug("No listener for contactListUpdate, storing event ..."),Ct.waitingContactListUpdateEvent.push(Qt)),tn.get(Pr(Ct)).emit("contactListUpdate",Qt)}),ru.set(Pr(Ct),zt),Ct}return Lt=Jt,Xt=[{key:"getToken",value:function(){return this.token}},{key:"getApzToken",value:function(){var dt=null;return apiRTC.session!==void 0&&apiRTC.session!==null&&(dt=apiRTC.session.JWTApzToken),dt}},{key:"getId",value:function(){return this.id}},{key:"getUserAgent",value:function(){return Xu.get(this)}},{key:"getContact",value:function(dt){return cr.warn("getContact() - Method deprecated, use Session.getOrCreateContact() instead"),Ro.get().getOrCreateContact(dt)}},{key:"getOrCreateContact",value:function(dt){return Ro.get().getOrCreateContact(dt)}},{key:"createConversation",value:function(dt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return cr.warn("createConversation() - Method deprecated, use Session.getConversation() instead"),this.getConversation(dt,Ct)}},{key:"getConversation",value:function(dt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return cr.trace("Getting conversation "+dt,Ct),uo.get().getOrCreateConversation(dt)}},{key:"getConference",value:function(dt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return cr.trace("Getting conference "+dt,Ct),uo.get().getOrCreateConference(dt)}},{key:"getOrCreateConversation",value:function(dt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ut=uo.get().getNameFromTechnicalName(dt);return uo.get().isConference(dt)?uo.get().getOrCreateConference(Ut,Ct):uo.get().getOrCreateConversation(Ut,Ct)}},{key:"getOrCreateConference",value:function(dt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.getOrCreateConversation(dt,Ct)}},{key:"getActiveConversations",value:function(){var dt,Ct={},Ut=uo.get().getConversations(),Vt=Jo(Ut.keys());try{for(Vt.s();!(dt=Vt.n()).done;){var zt=dt.value,Qt=Ut.get(zt);Qt.isJoined()&&(Ct[zt]=Qt)}}catch(Zt){Vt.e(Zt)}finally{Vt.f()}return Ct}},{key:"getActiveConferences",value:function(){var dt,Ct={},Ut=uo.get().getConferences(),Vt=Jo(Ut.keys());try{for(Vt.s();!(dt=Vt.n()).done;){var zt=dt.value,Qt=Ut.get(zt);Qt.isJoined()&&(Ct[zt]=Qt)}}catch(Zt){Vt.e(Zt)}finally{Vt.f()}return Ct}},{key:"getWhiteboardClient",value:function(){return cr.trace("getWhiteboardClient()"),zr.whiteBoardClient}},{key:"setUserData",value:function(dt){this.userData.setProps(dt).setToSession()}},{key:"setUsername",value:function(dt){this.userData.setProp("username",dt).setToSession()}},{key:"setPhotoUrl",value:function(dt){this.userData.setProp("photo_url",dt).setToSession()}},{key:"getUserData",value:function(){return this.userData}},{key:"getUsername",value:function(){return this.userData.get("username")!==null?this.userData.get("username"):this.userData.get("nickname")!==null?this.userData.get("nickname"):this.id.toString()}},{key:"getPhotoUrl",value:function(){return this.userData.get("photo_url")!==null?this.userData.get("photo_url"):this.userData.get("photoUrl")!==null?this.userData.get("photoUrl"):null}},{key:"subscribeToGroup",value:function(dt){if(this.getSubscribedPresenceGroup().includes(dt)){cr.debug("Already subscribed to this group");var Ct=apiCC.session.subscribeToPresenceGroupAddedByApiRTC.indexOf(dt);Ct!==-1&&apiCC.session.subscribeToPresenceGroupAddedByApiRTC.splice(Ct,1)}else zr.apiRTCSession.subscribePresenceGroup([dt])}},{key:"unsubscribeToGroup",value:function(dt){this.getSubscribedPresenceGroup().includes(dt)?zr.unsubscribeToPresenceGroup(dt):cr.debug("Not subscribed to this group")}},{key:"joinGroup",value:function(dt){if(this.getPresenceGroup().includes(dt)){cr.debug("Already joined this group");var Ct=apiCC.session.presenceGroupAddedByApiRTC.indexOf(dt);Ct!==-1&&apiCC.session.presenceGroupAddedByApiRTC.splice(Ct,1)}else zr.joinAndSubscribeToPresenceGroup(dt)}},{key:"leaveGroup",value:function(dt){this.getPresenceGroup().includes(dt)?zr.leaveAndUnsubscribeToPresenceGroup(dt):cr.debug("Group was not joined")}},{key:"subscribeToCloudEvent",value:function(dt,Ct){zr.subscribeToCloudEvent(dt,Ct)}},{key:"unsubscribeToCloudEvent",value:function(dt,Ct){zr.unsubscribeToCloudEvent(dt,Ct)}},{key:"joinConversationSpace",value:function(dt){zr.apiRTCSession.joinConversationSpace(dt)}},{key:"leaveConversationSpace",value:function(dt){zr.apiRTCSession.leaveConversationSpace(dt)}},{key:"getContacts",value:function(dt){cr.trace("getContacts()");var Ct,Ut={},Vt=Ro.get().getContacts(dt),zt=Jo(Vt.keys());try{for(zt.s();!(Ct=zt.n()).done;){var Qt=Ct.value;Ut[Qt]=Vt.get(Qt)}}catch(Zt){zt.e(Zt)}finally{zt.f()}return Ut}},{key:"getContactsArray",value:function(dt){cr.log("getContactsArray");var Ct=Ro.get().getContacts(dt);return Array.from(Ct.values())}},{key:"getOnlineContactsArray",value:function(dt){cr.log("getOnlineContactsArray");var Ct=Ro.get().getOnlineContacts(dt);return Array.from(Ct.values())}},{key:"getCall",value:function(dt){return cr.trace("getCall()"),Or.get().getCall(dt)}},{key:"getCalls",value:function(){cr.trace("getCalls()");var dt,Ct={},Ut=Or.get().getCalls(),Vt=Jo(Ut.keys());try{for(Vt.s();!(dt=Vt.n()).done;){var zt=dt.value;Ct[zt]=Ut.get(zt)}}catch(Qt){Vt.e(Qt)}finally{Vt.f()}return Ct}},{key:"disconnect",value:function(){var dt=this,Ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{invalidateUserToken:!0};return new Promise(function(Ut,Vt){if(cr.info("disconnect()"),dt.token===null&&dt.id===null)cr.error("disconnect() - Session is already disconnected"),Vt("disconnect() - Session is already disconnected");else{var zt,Qt=Jo(uo.get().getConversations().keys());try{for(Qt.s();!(zt=Qt.n()).done;){var Zt=zt.value;Zt.status===tt.g.CONVERSATION_STATUS_JOINED&&Zt.leave()}}catch(dr){Qt.e(dr)}finally{Qt.f()}if(clearInterval(as.get(dt)),as.set(dt,null),dt.token!==null&&Ct.hasOwnProperty("invalidateUserToken")&&Ct.invalidateUserToken)Vs.invalidateUserToken(dt.token).then(function(){zs=null,Ct.invalidateApiCCId=!0,zr.disconnect(Ct),dt.id=null,dt.token=null;for(var dr=ru.get(dt),hr=0,Ar=Object.keys(dr);hr<Ar.length;hr++){var Xr=Ar[hr];cr.info("Session, removing apiRTCManager event :",Xr);var _i=dr[Xr];zr.removeEventListener(Xr,_i)}Ut()}).catch(function(dr){cr.error("disconnect() - An error occured during disconnection",dr),Vt(new Error("disconnect() - An error occured during disconnection"))});else{zs=null,zr.disconnect(Ct),dt.id=null;for(var on=ru.get(dt),bn=0,Rn=Object.keys(on);bn<Rn.length;bn++){var qn=Rn[bn];cr.info("Session, removing apiRTCManager event :",qn);var Jn=on[qn];zr.removeEventListener(qn,Jn)}Ut()}}})}},{key:"cloudRequest",value:function(dt,Ct,Ut){return Vs.cloudRequest(dt,Ct,Ut)}},{key:"sendRawData",value:function(dt,Ct){return new Promise(function(Ut,Vt){dt!=null?zr.sendData(dt.getId(),Ct).then(Ut).catch(function(zt){switch(zt){case tt.g.ERROR_TIMED_OUT:Vt(Wt.g.createError(tt.g.ERROR_TIMED_OUT,"sendRawData() - Data transmission timed out ",cr));break;case tt.g.ERROR_NOT_FOUND:Vt(Wt.g.createError(tt.g.ERROR_NOT_FOUND,"sendRawData() - Contact was not found ",cr));break;default:Vt(Wt.g.createError(tt.g.ERROR_OTHER,"sendRawData() - Data transmission timed out ",cr))}}):Vt(Wt.g.createError(tt.g.ERROR_OTHER,"sendRawData() - Contact undefined",cr))})}},{key:"startRecordingOutgoingStream",value:function(dt,Ct){this.isRecording?cr.error("startRecordingOutgoingStream() - already recording"):(zr.webRTCClient.startRecording(dt,Ct),this.isRecording=!0)}},{key:"stopRecordingOutgoingStream",value:function(){var dt=this;return new Promise(function(Ct,Ut){dt.isRecording?(dt.isRecording=!1,zr.onceEvent("MCURecordedStreamsAvailable",function(Vt){Ct({filename:Vt.detail.recordedFileName,url:tt.g.RECORD_PLAY_URL+Vt.detail.recordedFileName})}),zr.webRTCClient.stopRecording()):(cr.error("stopRecordingOutgoingStream() - not recording"),Ut(new Error("stopRecordingOutgoingStream() - not recording")))})}},{key:"init",value:function(dt){var Ct=this;this.id=dt,zs=this,as.get(this)===null&&as.set(this,setInterval(function(){om(Ct)},3e4))}},{key:"setMCUServer",value:function(dt){zr.webRTCClient.setMCUConnector(dt)}},{key:"allowMultipleCalls",value:function(dt){zr.webRTCClient.setAllowMultipleCalls(dt)}},{key:"setCallStatsMonitoringEnabled",value:function(dt,Ct){zr.webRTCClient.enableCallStatsMonitoring(dt,Ct)}},{key:"setQualityEvaluatingEnabled",value:function(dt,Ct){zr.webRTCClient.enableQualityEvaluating(dt,Ct)}},{key:"getContactFromWebSession",value:function(dt){var Ct=this;return new Promise(function(Ut,Vt){Vs.getSessionHistory(dt,Ct.getToken()).then(function(zt){zt.exist.toString()!=="1"?Vt(Wt.g.createError(tt.g.ERROR_NOT_FOUND,"No such web session",cr)):zt.user1.toString()===Ct.getId()?Ut(Ct.getContact(zt.user2)):zt.user2.toString()===Ct.getId()?Ut(Ct.getContact(zt.user1)):Vt(Wt.g.createError(tt.g.ERROR_UNAUTHORIZED,"User has no access to this web session",cr))}).catch(function(zt){zt.hasOwnProperty("code")?Vt({code:zt.code,error:zt.error}):zt.hasOwnProperty("http_code")?zt.http_code.toString().startsWith("4")?Vt(Wt.g.createError(tt.g.ERROR_OTHER,"Error while getting contact from websession",cr)):Vt(Wt.g.createError(tt.g.ERROR_SERVER_UNAVAILABLE,"Error while getting contact from websession",cr)):Vt(Wt.g.createError(tt.g.ERROR_OTHER,"Error while getting contact from websession",cr))})})}},{key:"joinPointerSharingRoom",value:function(dt){var Ct=this;return new Promise(function(Ut,Vt){if(ss.get(Ct).hasOwnProperty(dt))return Vt(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"joinPointerSharingRoom() - cannot join pointer sharing room again",cr));zr.pointerSharingClient.joinRoom(dt,{success:function(zt){var Qt=new iu(Ct,zt);ss.get(Ct)[zt]=Qt,Ut(Qt)},failure:function(zt,Qt){Vt(zt==="timeout"?Wt.g.createError(tt.g.ERROR_TIMED_OUT,"joinPointerSharingRoom() - cannot join pointer sharing room",cr):Wt.g.createError(tt.g.ERROR_OTHER,"joinPointerSharingRoom() - cannot join pointer sharing room",cr))}})})}},{key:"getSubscribedPresenceGroup",value:function(){return apiCC!==void 0&&apiCC.session!==null&&apiCC.session!==void 0?apiCC.session.subscribeToPresenceGroup:[]}},{key:"getPresenceGroup",value:function(){return apiCC!==void 0&&apiCC.session!==null&&apiCC.session!==void 0?apiCC.session.presenceGroup:[]}}],Ot=[{key:"getAvailableEvents",value:function(){return am}},{key:"getActiveSession",value:function(){return zs}}],Xt&&Yu(Lt.prototype,Xt),Ot&&Yu(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(fn),iu=function($t,Lt){this.session=$t,this.roomId=Lt,this.getRoomId=function(){return this.roomId},this.isActive=function(){return this.session!==null&&this.roomId!==null&&zr.pointerSharingClient.roomActive(this.roomId)},this.leaveRoom=function(){var Xt=this;return new Promise(function(Ot,Ft){if(Xt.session===null||Xt.roomId===null)return Ft(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"leaveRoom() - cannot leave room again",cr));zr.pointerSharingClient.leaveRoom(Xt.roomId),delete ss.get(Xt.session)[Xt.roomId],Xt.session=null,Xt.roomId=null,Ot()})},this.invite=function(Xt,Ot){var Ft=this;return new Promise(function(sn,ln){if(Ft.session===null||Ft.roomId===null)return ln(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"invite() - cannot invite",cr));zr.pointerSharingClient.inviteInRoom(Ft.roomId,Xt.getId(),Ot),sn()})},this.sendPointerLocation=function(Xt,Ot,Ft,sn){var ln=this;return new Promise(function(Jt,dt){return ln.session===null||ln.roomId===null?dt(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"sendPointerLocation() - cannot send pointer location",cr)):zr.pointerSharingClient.sendPointerLocation(ln.roomId,Xt,Ot,Ft,sn)?void Jt():dt(Wt.g.createError(tt.g.ERROR_WRONG_STATE,"sendPointerLocation() - cannot send pointer location",cr))})}},om=function($t){for(var Lt=$t.getActiveConferences(),Xt=0,Ot=Object.keys(Lt);Xt<Ot.length;Xt++){var Ft=Lt[Ot[Xt]];Vs.updateConferencePresence(Ft,$t,zr.getActiveApiKey())}},au=s(7618);function Hs($t){var Lt=typeof Map=="function"?new Map:void 0;return Hs=function(Xt){if(Xt===null||(Ot=Xt,Function.toString.call(Ot).indexOf("[native code]")===-1))return Xt;var Ot;if(typeof Xt!="function")throw new TypeError("Super expression must either be null or a function");if(Lt!==void 0){if(Lt.has(Xt))return Lt.get(Xt);Lt.set(Xt,Ft)}function Ft(){return ou(Xt,arguments,Fo(this).constructor)}return Ft.prototype=Object.create(Xt.prototype,{constructor:{value:Ft,enumerable:!1,writable:!0,configurable:!0}}),cs(Ft,Xt)},Hs($t)}function ou($t,Lt,Xt){return ou=tp()?Reflect.construct.bind():function(Ot,Ft,sn){var ln=[null];ln.push.apply(ln,Ft);var Jt=new(Function.bind.apply(Ot,ln));return sn&&cs(Jt,sn.prototype),Jt},ou.apply(null,arguments)}function su(){return su=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function($t,Lt,Xt){var Ot=sm($t,Lt);if(Ot){var Ft=Object.getOwnPropertyDescriptor(Ot,Lt);return Ft.get?Ft.get.call(arguments.length<3?$t:Xt):Ft.value}},su.apply(this,arguments)}function sm($t,Lt){for(;!Object.prototype.hasOwnProperty.call($t,Lt)&&($t=Fo($t))!==null;);return $t}function ls($t){return ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},ls($t)}function oo(){oo=function(){return $t};var $t={},Lt=Object.prototype,Xt=Lt.hasOwnProperty,Ot=typeof Symbol=="function"?Symbol:{},Ft=Ot.iterator||"@@iterator",sn=Ot.asyncIterator||"@@asyncIterator",ln=Ot.toStringTag||"@@toStringTag";function Jt(lr,er,Tr){return Object.defineProperty(lr,er,{value:Tr,enumerable:!0,configurable:!0,writable:!0}),lr[er]}try{Jt({},"")}catch{Jt=function(er,Tr,kr){return er[Tr]=kr}}function dt(lr,er,Tr,kr){var br=er&&er.prototype instanceof Vt?er:Vt,$a=Object.create(br.prototype),to=new Xr(kr||[]);return $a._invoke=function(vo,Oo,Wr){var po="suspendedStart";return function(So,hs){if(po==="executing")throw new Error("Generator is already running");if(po==="completed"){if(So==="throw")throw hs;return{value:void 0,done:!0}}for(Wr.method=So,Wr.arg=hs;;){var fs=Wr.delegate;if(fs){var lo=dr(fs,Wr);if(lo){if(lo===Ut)continue;return lo}}if(Wr.method==="next")Wr.sent=Wr._sent=Wr.arg;else if(Wr.method==="throw"){if(po==="suspendedStart")throw po="completed",Wr.arg;Wr.dispatchException(Wr.arg)}else Wr.method==="return"&&Wr.abrupt("return",Wr.arg);po="executing";var ms=Ct(vo,Oo,Wr);if(ms.type==="normal"){if(po=Wr.done?"completed":"suspendedYield",ms.arg===Ut)continue;return{value:ms.arg,done:Wr.done}}ms.type==="throw"&&(po="completed",Wr.method="throw",Wr.arg=ms.arg)}}}(lr,Tr,to),$a}function Ct(lr,er,Tr){try{return{type:"normal",arg:lr.call(er,Tr)}}catch(kr){return{type:"throw",arg:kr}}}$t.wrap=dt;var Ut={};function Vt(){}function zt(){}function Qt(){}var Zt={};Jt(Zt,Ft,function(){return this});var on=Object.getPrototypeOf,bn=on&&on(on(_i([])));bn&&bn!==Lt&&Xt.call(bn,Ft)&&(Zt=bn);var Rn=Qt.prototype=Vt.prototype=Object.create(Zt);function qn(lr){["next","throw","return"].forEach(function(er){Jt(lr,er,function(Tr){return this._invoke(er,Tr)})})}function Jn(lr,er){function Tr(br,$a,to,vo){var Oo=Ct(lr[br],lr,$a);if(Oo.type!=="throw"){var Wr=Oo.arg,po=Wr.value;return po&&ls(po)=="object"&&Xt.call(po,"__await")?er.resolve(po.__await).then(function(So){Tr("next",So,to,vo)},function(So){Tr("throw",So,to,vo)}):er.resolve(po).then(function(So){Wr.value=So,to(Wr)},function(So){return Tr("throw",So,to,vo)})}vo(Oo.arg)}var kr;this._invoke=function(br,$a){function to(){return new er(function(vo,Oo){Tr(br,$a,vo,Oo)})}return kr=kr?kr.then(to,to):to()}}function dr(lr,er){var Tr=lr.iterator[er.method];if(Tr===void 0){if(er.delegate=null,er.method==="throw"){if(lr.iterator.return&&(er.method="return",er.arg=void 0,dr(lr,er),er.method==="throw"))return Ut;er.method="throw",er.arg=new TypeError("The iterator does not provide a 'throw' method")}return Ut}var kr=Ct(Tr,lr.iterator,er.arg);if(kr.type==="throw")return er.method="throw",er.arg=kr.arg,er.delegate=null,Ut;var br=kr.arg;return br?br.done?(er[lr.resultName]=br.value,er.next=lr.nextLoc,er.method!=="return"&&(er.method="next",er.arg=void 0),er.delegate=null,Ut):br:(er.method="throw",er.arg=new TypeError("iterator result is not an object"),er.delegate=null,Ut)}function hr(lr){var er={tryLoc:lr[0]};1 in lr&&(er.catchLoc=lr[1]),2 in lr&&(er.finallyLoc=lr[2],er.afterLoc=lr[3]),this.tryEntries.push(er)}function Ar(lr){var er=lr.completion||{};er.type="normal",delete er.arg,lr.completion=er}function Xr(lr){this.tryEntries=[{tryLoc:"root"}],lr.forEach(hr,this),this.reset(!0)}function _i(lr){if(lr){var er=lr[Ft];if(er)return er.call(lr);if(typeof lr.next=="function")return lr;if(!isNaN(lr.length)){var Tr=-1,kr=function br(){for(;++Tr<lr.length;)if(Xt.call(lr,Tr))return br.value=lr[Tr],br.done=!1,br;return br.value=void 0,br.done=!0,br};return kr.next=kr}}return{next:Vo}}function Vo(){return{value:void 0,done:!0}}return zt.prototype=Qt,Jt(Rn,"constructor",Qt),Jt(Qt,"constructor",zt),zt.displayName=Jt(Qt,ln,"GeneratorFunction"),$t.isGeneratorFunction=function(lr){var er=typeof lr=="function"&&lr.constructor;return!!er&&(er===zt||(er.displayName||er.name)==="GeneratorFunction")},$t.mark=function(lr){return Object.setPrototypeOf?Object.setPrototypeOf(lr,Qt):(lr.__proto__=Qt,Jt(lr,ln,"GeneratorFunction")),lr.prototype=Object.create(Rn),lr},$t.awrap=function(lr){return{__await:lr}},qn(Jn.prototype),Jt(Jn.prototype,sn,function(){return this}),$t.AsyncIterator=Jn,$t.async=function(lr,er,Tr,kr,br){br===void 0&&(br=Promise);var $a=new Jn(dt(lr,er,Tr,kr),br);return $t.isGeneratorFunction(er)?$a:$a.next().then(function(to){return to.done?to.value:$a.next()})},qn(Rn),Jt(Rn,ln,"Generator"),Jt(Rn,Ft,function(){return this}),Jt(Rn,"toString",function(){return"[object Generator]"}),$t.keys=function(lr){var er=[];for(var Tr in lr)er.push(Tr);return er.reverse(),function kr(){for(;er.length;){var br=er.pop();if(br in lr)return kr.value=br,kr.done=!1,kr}return kr.done=!0,kr}},$t.values=_i,Xr.prototype={constructor:Xr,reset:function(lr){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Ar),!lr)for(var er in this)er.charAt(0)==="t"&&Xt.call(this,er)&&!isNaN(+er.slice(1))&&(this[er]=void 0)},stop:function(){this.done=!0;var lr=this.tryEntries[0].completion;if(lr.type==="throw")throw lr.arg;return this.rval},dispatchException:function(lr){if(this.done)throw lr;var er=this;function Tr(Oo,Wr){return $a.type="throw",$a.arg=lr,er.next=Oo,Wr&&(er.method="next",er.arg=void 0),!!Wr}for(var kr=this.tryEntries.length-1;kr>=0;--kr){var br=this.tryEntries[kr],$a=br.completion;if(br.tryLoc==="root")return Tr("end");if(br.tryLoc<=this.prev){var to=Xt.call(br,"catchLoc"),vo=Xt.call(br,"finallyLoc");if(to&&vo){if(this.prev<br.catchLoc)return Tr(br.catchLoc,!0);if(this.prev<br.finallyLoc)return Tr(br.finallyLoc)}else if(to){if(this.prev<br.catchLoc)return Tr(br.catchLoc,!0)}else{if(!vo)throw new Error("try statement without catch or finally");if(this.prev<br.finallyLoc)return Tr(br.finallyLoc)}}}},abrupt:function(lr,er){for(var Tr=this.tryEntries.length-1;Tr>=0;--Tr){var kr=this.tryEntries[Tr];if(kr.tryLoc<=this.prev&&Xt.call(kr,"finallyLoc")&&this.prev<kr.finallyLoc){var br=kr;break}}br&&(lr==="break"||lr==="continue")&&br.tryLoc<=er&&er<=br.finallyLoc&&(br=null);var $a=br?br.completion:{};return $a.type=lr,$a.arg=er,br?(this.method="next",this.next=br.finallyLoc,Ut):this.complete($a)},complete:function(lr,er){if(lr.type==="throw")throw lr.arg;return lr.type==="break"||lr.type==="continue"?this.next=lr.arg:lr.type==="return"?(this.rval=this.arg=lr.arg,this.method="return",this.next="end"):lr.type==="normal"&&er&&(this.next=er),Ut},finish:function(lr){for(var er=this.tryEntries.length-1;er>=0;--er){var Tr=this.tryEntries[er];if(Tr.finallyLoc===lr)return this.complete(Tr.completion,Tr.afterLoc),Ar(Tr),Ut}},catch:function(lr){for(var er=this.tryEntries.length-1;er>=0;--er){var Tr=this.tryEntries[er];if(Tr.tryLoc===lr){var kr=Tr.completion;if(kr.type==="throw"){var br=kr.arg;Ar(Tr)}return br}}throw new Error("illegal catch attempt")},delegateYield:function(lr,er,Tr){return this.delegate={iterator:_i(lr),resultName:er,nextLoc:Tr},this.method==="next"&&(this.arg=void 0),Ut}},$t}function Qu($t,Lt,Xt,Ot,Ft,sn,ln){try{var Jt=$t[sn](ln),dt=Jt.value}catch(Ct){return void Xt(Ct)}Jt.done?Lt(dt):Promise.resolve(dt).then(Ot,Ft)}function Lo($t){return function(){var Lt=this,Xt=arguments;return new Promise(function(Ot,Ft){var sn=$t.apply(Lt,Xt);function ln(dt){Qu(sn,Ot,Ft,ln,Jt,"next",dt)}function Jt(dt){Qu(sn,Ot,Ft,ln,Jt,"throw",dt)}ln(void 0)})}}function $o($t,Lt){var Xt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Xt){if(Array.isArray($t)||(Xt=function(dt,Ct){if(dt){if(typeof dt=="string")return Zu(dt,Ct);var Ut=Object.prototype.toString.call(dt).slice(8,-1);return Ut==="Object"&&dt.constructor&&(Ut=dt.constructor.name),Ut==="Map"||Ut==="Set"?Array.from(dt):Ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ut)?Zu(dt,Ct):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Xt&&($t=Xt);var Ot=0,Ft=function(){};return{s:Ft,n:function(){return Ot>=$t.length?{done:!0}:{done:!1,value:$t[Ot++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Jt=!1;return{s:function(){Xt=Xt.call($t)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Jt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Jt)throw sn}}}}function Zu($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Xt=0,Ot=new Array(Lt);Xt<Lt;Xt++)Ot[Xt]=$t[Xt];return Ot}function Gs($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function ep($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function qs($t,Lt,Xt){return Lt&&ep($t.prototype,Lt),Xt&&ep($t,Xt),Object.defineProperty($t,"prototype",{writable:!1}),$t}function Ks($t,Lt){if(typeof Lt!="function"&&Lt!==null)throw new TypeError("Super expression must either be null or a function");$t.prototype=Object.create(Lt&&Lt.prototype,{constructor:{value:$t,writable:!0,configurable:!0}}),Object.defineProperty($t,"prototype",{writable:!1}),Lt&&cs($t,Lt)}function cs($t,Lt){return cs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},cs($t,Lt)}function Js($t){var Lt=tp();return function(){var Xt,Ot=Fo($t);if(Lt){var Ft=Fo(this).constructor;Xt=Reflect.construct(Ot,arguments,Ft)}else Xt=Ot.apply(this,arguments);return lm(this,Xt)}}function lm($t,Lt){if(Lt&&(ls(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zr($t)}function Zr($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function tp(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fo($t){return Fo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Fo($t)}var $n=mt.Y.get("Stream"),lu=wn.get(),cm=uo.get(),dm=["stopped","trackStopped","audioAmplitude","audioAmplitudeInfo","muteStateChange","activeStateChange","backgroundSubstractionStopVisibilityChange","backgroundSubstractionStopComputeTime","AIESnapshot","AIELog","flowStatusChanged","audioFlowStatusChanged","videoFlowStatusChanged","remoteAudioFlowStatusChanged","remoteVideoFlowStatusChanged","release","constraintsChanged"],yo=new Map,Ys=new WeakMap,ds=new WeakMap,us=new WeakMap,cu=new WeakMap,Yo={},so=function($t){Ks(Xt,$t);var Lt=Js(Xt);function Xt(Ot){var Ft,sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Gs(this,Xt),Ft=Lt.call(this,$n),sn.constructor!==!0)throw new Error("Stream constructor should not be used directly, please use a static method of class Stream such as : createStreamFromUserMedia, createStreamFromMediaStream, createScreensharingStream");if(delete sn.constructor,!sn.hasOwnProperty("type"))throw new Error("Cannot create Stream with no type");if($n.debug("Create Stream with options",sn),Ft.data=Ot,Ft.audioInput=sn.hasOwnProperty("audioInput")?sn.audioInput:null,Ft.videoInput=sn.hasOwnProperty("videoInput")?sn.videoInput:null,Ft.audioFilterIsApplied=!1,Ft.videoFilterIsApplied=!1,Ft.audioAppliedFilter="none",Ft.videoAppliedFilter="none",Ft.originalMediaTrack=null,sn.hasOwnProperty("userMediaStreamId")?(Ft.userMediaStreamId=sn.userMediaStreamId,Ft.isRemote=!1,yo.set(Ft.userMediaStreamId,Zr(Ft))):(Ft.userMediaStreamId=null,Ft.isRemote=!0),Wt.g.isPropertyTypeof(sn,"streamId","number")?Ft.streamId=sn.streamId:Ft.userMediaStreamId!==null?Ft.streamId=Number(Ft.userMediaStreamId):Number.MAX_SAFE_INTEGER!==void 0?Ft.streamId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER):Ft.streamId=Math.floor(1024*Math.random()*1024*1024),Ft.contact=sn.hasOwnProperty("contact")?sn.contact:null,sn.hasOwnProperty("callId")?(Ft.callId=sn.callId,Ft.callAudioAvailable=sn.callAudioAvailable,Ft.callAudioActive=sn.callAudioActive,Ft.callAudioMuted=sn.callAudioMuted,Ft.callAudioSilent=sn.callAudioSilent,Ft.callVideoAvailable=sn.callVideoAvailable,Ft.callVideoActive=sn.callVideoActive,Ft.callVideoMuted=sn.callVideoMuted,Ft.callVideoSilent=sn.callVideoSilent):Ft.callId=null,Ft.publishedInConversations=new Map,Ft.mediaRecorder=null,Ft.recordedBlobs=[],Ys.set(Zr(Ft),!!sn.hasOwnProperty("screensharing")&&sn.screensharing),ds.set(Zr(Ft),null),us.set(Zr(Ft),null),Ft.screensharingRemoteAccessStream=!1,apiRTC.userAgentInstance.apiRTCStreamsList.set(Ft.streamId,Zr(Ft)),Ft.type=sn.type,apiRTC.browser!=="IE"&&Ft.data!==null){var ln,Jt=function(on){on.addEventListener("ended",function(bn){Yo.hasOwnProperty(on.id)||(tn.get(Zr(Ft)).emit("trackStopped",{type:on.kind,id:on.id,reason:"ended"}),Yo[on.id]=!0)})},dt=$o(Ft.data.getVideoTracks());try{for(dt.s();!(ln=dt.n()).done;){var Ct=ln.value;Jt(Ct)}}catch(on){dt.e(on)}finally{dt.f()}var Ut,Vt=$o(Ft.data.getAudioTracks());try{for(Vt.s();!(Ut=Vt.n()).done;){var zt=Ut.value;Jt(zt)}}catch(on){Vt.e(on)}finally{Vt.f()}}var Qt={};if(Wt.g.isTypeof(Ft.userMediaStreamId,"string")?(Qt.userMediaStop=function(on){if(on.detail.userMediaStreamId===Ft.userMediaStreamId){var bn={streamId:Ft.streamId,userMediaStreamId:Ft.userMediaStreamId};tn.get(Zr(Ft)).emit("stopped",bn);var Rn=cu.get(Zr(Ft));if(Rn)for(var qn in Rn)apiRTC.removeEventListener(qn,Rn[qn])}},Qt.localStreamUpdated=function(on){if(on.detail.userMediaStreamId===Ft.userMediaStreamId&&on.detail.callId===null){if(on.detail.changeList.indexOf("audioIsMuted")>=0){var bn={streamId:Ft.streamId,userMediaStreamId:Ft.userMediaStreamId,type:"audio",muted:on.detail.audioIsMuted};tn.get(Zr(Ft)).emit("muteStateChange",bn),Ft.sendAudioFlowStatusChanged(),Ft.sendFlowStatusChanged("audio")}if(on.detail.changeList.indexOf("videoIsMuted")>=0){var Rn={streamId:Ft.streamId,userMediaStreamId:Ft.userMediaStreamId,type:"video",muted:on.detail.videoIsMuted};tn.get(Zr(Ft)).emit("muteStateChange",Rn),Ft.sendVideoFlowStatusChanged(),Ft.sendFlowStatusChanged("video")}on.detail.changeList.indexOf("audioIsSilent")>=0&&(Ft.sendAudioFlowStatusChanged(),Ft.sendFlowStatusChanged("audio")),on.detail.changeList.indexOf("videoIsSilent")>=0&&(Ft.sendVideoFlowStatusChanged(),Ft.sendFlowStatusChanged("video"))}},Qt.backgroundSubstractionStopVisibilityChange=function(on){if(on.detail.userMediaStreamId===Ft.userMediaStreamId){var bn={streamId:Ft.streamId,userMediaStreamId:Ft.userMediaStreamId};tn.get(Zr(Ft)).emit("backgroundSubstractionStopVisibilityChange",bn)}},Qt.backgroundSubstractionStopComputeTime=function(on){if(on.detail.userMediaStreamId===Ft.userMediaStreamId){var bn={streamId:Ft.streamId,userMediaStreamId:Ft.userMediaStreamId};tn.get(Zr(Ft)).emit("backgroundSubstractionStopComputeTime",bn)}},Qt.AIESnapshot=function(on){if(on.detail.userMediaStreamId===Ft.userMediaStreamId){var bn=on.detail.image;tn.get(Zr(Ft)).emit("AIESnapshot",bn)}},Qt.AIELog=function(on){if(on.detail.userMediaStreamId===Ft.userMediaStreamId){var bn=on.detail.log;tn.get(Zr(Ft)).emit("AIELog",bn)}}):Wt.g.isTypeof(Ft.callId,"string")&&(Qt.hangup=function(on){if(on.detail.hangupType==="remote"&&on.detail.callId===Ft.callId){var bn={streamId:Ft.streamId,callId:Ft.callId};tn.get(Zr(Ft)).emit("stopped",bn);var Rn=cu.get(Zr(Ft));for(var qn in Rn)apiRTC.removeEventListener(qn,Rn[qn])}},Qt.remoteStreamUpdated=function(on){if(on.detail.callId===Ft.callId){if(on.detail.changeList.indexOf("audioIsActive")>=0){Ft.callAudioActive=on.detail.audioIsActive;var bn={streamId:Ft.streamId,callId:Ft.callId,type:"audio",active:on.detail.audioIsActive};tn.get(Zr(Ft)).emit("activeStateChange",bn)}if(on.detail.changeList.indexOf("audioIsMuted")>=0){Ft.callAudioMuted=on.detail.audioIsMuted;var Rn={streamId:Ft.streamId,callId:Ft.callId,type:"audio",muted:on.detail.audioIsMuted};tn.get(Zr(Ft)).emit("muteStateChange",Rn),Ft.sendRemoteAudioFlowStatusChanged({enabled:!on.detail.audioIsMuted,muted:on.detail.audioIsSilent}),Ft.sendFlowStatusChangedForRemote("audio",{enabled:!on.detail.audioIsMuted,muted:on.detail.audioIsSilent})}if(on.detail.changeList.indexOf("videoIsActive")>=0){Ft.callVideoActive=on.detail.videoIsActive;var qn={streamId:Ft.streamId,callId:Ft.callId,type:"video",active:on.detail.videoIsActive};tn.get(Zr(Ft)).emit("activeStateChange",qn)}if(on.detail.changeList.indexOf("videoIsMuted")>=0){Ft.callVideoMuted=on.detail.videoIsMuted;var Jn={streamId:Ft.streamId,callId:Ft.callId,type:"video",muted:on.detail.videoIsMuted};tn.get(Zr(Ft)).emit("muteStateChange",Jn),Ft.sendRemoteVideoFlowStatusChanged({enabled:!on.detail.videoIsMuted,muted:on.detail.videoIsSilent}),Ft.sendFlowStatusChangedForRemote("video",{enabled:!on.detail.videoIsMuted,muted:on.detail.videoIsSilent})}on.detail.changeList.indexOf("audioIsSilent")>=0&&(Ft.callAudioSilent=on.detail.audioIsSilent,Ft.sendRemoteAudioFlowStatusChanged({enabled:!on.detail.audioIsMuted,muted:on.detail.audioIsSilent}),Ft.sendFlowStatusChangedForRemote("audio",{enabled:!on.detail.audioIsMuted,muted:on.detail.audioIsSilent})),on.detail.changeList.indexOf("videoIsSilent")>=0&&(Ft.callVideoSilent=on.detail.videoIsSilent,Ft.sendRemoteVideoFlowStatusChanged({enabled:!on.detail.videoIsMuted,muted:on.detail.videoIsSilent}),Ft.sendFlowStatusChangedForRemote("video",{enabled:!on.detail.videoIsMuted,muted:on.detail.videoIsSilent})),on.detail.changeList.indexOf("audioIsSilentLocally")>=0&&(Ft.sendAudioFlowStatusChanged(),Ft.sendFlowStatusChanged("audio")),on.detail.changeList.indexOf("videoIsSilentLocally")>=0&&(Ft.sendVideoFlowStatusChanged(),Ft.sendFlowStatusChanged("video"))}}),Object.keys(Qt).length>0)for(var Zt in cu.set(Zr(Ft),Qt),Qt)apiRTC.addEventListener(Zt,Qt[Zt]);return Ft}return qs(Xt,[{key:"getContact",value:function(){return this.contact}},{key:"getData",value:function(){return this.data}},{key:"getConversations",value:function(){var Ot,Ft=[],sn=$o(this.publishedInConversations.keys());try{for(sn.s();!(Ot=sn.n()).done;){var ln=Ot.value;Ft.push(cm.getConversations(ln))}}catch(Jt){sn.e(Jt)}finally{sn.f()}return Ft}},{key:"isScreensharing",value:function(){return Ys.get(this)}},{key:"isScreensharingRemoteAccess",value:function(){return this.screensharingRemoteAccessStream}},{key:"hasData",value:function(){return this.data!==null}},{key:"hasVideo",value:function(){return this.callId?this.callVideoAvailable&&this.callVideoActive:!!this.hasData()&&this.data.getVideoTracks().length>0}},{key:"hasAudio",value:function(){return this.callId?this.callAudioAvailable&&this.callAudioActive:!!this.hasData()&&this.data.getAudioTracks().length>0}},{key:"isVideoMuted",value:function(){if(this.callId)return this.callVideoSilent;if(this.hasData()){var Ot=this.data.getVideoTracks();if(Ot&&Ot.length>0)return Ot[0].muted}return!0}},{key:"isVideoEnabled",value:function(){if(this.callId)return!this.callVideoMuted;if(this.hasData()){var Ot=this.data.getVideoTracks();return Ot&&Ot.length>0&&Ot[0].enabled}return!1}},{key:"isAudioMuted",value:function(){if(this.callId)return this.callAudioSilent;if(this.hasData()){var Ot=this.data.getAudioTracks();if(Ot&&Ot.length>0)return Ot[0].muted}return!0}},{key:"isAudioEnabled",value:function(){if(this.callId)return!this.callAudioMuted;if(this.hasData()){var Ot=this.data.getAudioTracks();return Ot&&Ot.length>0&&Ot[0].enabled}return!1}},{key:"getType",value:function(){return this.type}},{key:"release",value:function(){var Ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.childType==="noiseReduction"&&this.parent!==void 0){apiCC.audioProcessor.stopAudioNodeCtx(this.parent.nodeCtx);var Ft=apiCC.getUserMediaStream(this.parent.userMediaStreamId);apiCC.audioProcessor.listenToAudio(this.parent.data,Ft)}this.hasData()&&(this.releaseAudio(),this.releaseVideo(),this.data=null,this.userMediaStreamId&&(apiCC.releaseUserMediaStream(this.userMediaStreamId),yo.delete(this.userMediaStreamId))),tn.get(this).emit("release",{streamId:this.streamId,userMediaStreamId:this.userMediaStreamId}),Ot.releaseChildrenStream!==!1&&this.releaseAllChildren(),Ot.releaseParentStream!==!1&&this.parent!==void 0&&($n.debug("release parent is also requested"),this.parent.release(Ot)),console.debug("Removing in apiRTCStreamsList :",this.streamId),apiRTC.userAgentInstance.apiRTCStreamsList.delete(this.streamId)}},{key:"releaseAudio",value:function(){var Ot=this;this.hasData()&&(this.disableAudioAnalysis(),this.data.getAudioTracks().forEach(function(Ft){Ft.stop(),Yo.hasOwnProperty(Ft.id)||(tn.get(Ot).emit("trackStopped",{type:Ft.kind,id:Ft.id,reason:"releaseAudio"}),Yo[Ft.id]=!0)}))}},{key:"releaseVideo",value:function(){var Ot=this;this.hasData()&&this.data.getVideoTracks().forEach(function(Ft){Ft.stop(),Yo.hasOwnProperty(Ft.id)||(tn.get(Ot).emit("trackStopped",{type:Ft.kind,id:Ft.id,reason:"releaseVideo"}),Yo[Ft.id]=!0)})}},{key:"muteAudio",value:function(){$n.warn("This method is deprecated now, please use Stream.disableAudio() instead"),this.disableAudio()}},{key:"muteVideo",value:function(){$n.warn("This method is deprecated now, please use Stream.disableVideo() instead"),this.disableVideo()}},{key:"unmuteAudio",value:function(){$n.warn("This method is deprecated now, please use Stream.enableAudio() instead"),this.enableAudio()}},{key:"unmuteVideo",value:function(){$n.warn("This method is deprecated now, please use Stream.enableVideo() instead"),this.enableVideo()}},{key:"sendStreamRequest",value:function(Ot,Ft,sn){var ln={};ln.streamId=this.streamId;var Jt=this.publishedInConversations.keys();ln.roomname=Jt.next().value,this.contact.sendRequest(Ot,ln).then(function(){return Ft()}).catch(function(dt){return $n.error("Error on sendRequest :",dt),sn()})}},{key:"enableAudio",value:function(){var Ot=this,Ft=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return new Promise(function(){var sn=Lo(oo().mark(function ln(Jt,dt){var Ct;return oo().wrap(function(Ut){for(;;)switch(Ut.prev=Ut.next){case 0:if(Ot.isAudioEnabled()!==!0||Ot.isRemote!==!1){Ut.next=3;break}return $n.debug("audio already enabled"),Ut.abrupt("return",Jt());case 3:if(!Ot.userMediaStreamId){Ut.next=16;break}if(Ct=apiCC.getUserMediaStream(Ot.userMediaStreamId)){Ut.next=7;break}return Ut.abrupt("return",dt());case 7:if(Ct.unMuteAudioOnStreams("enabled"),Ot.parent===void 0){Ut.next=12;break}return $n.debug("this is a child stream, need to unmute parent if necessary"),Ut.next=12,Ot.parent.enableAudio();case 12:return Ot.childrens!==void 0&&Ot.childrens.forEach(function(){var Vt=Lo(oo().mark(function zt(Qt,Zt){return oo().wrap(function(on){for(;;)switch(on.prev=on.next){case 0:return on.next=2,Qt.enableAudio();case 2:case"end":return on.stop()}},zt)}));return function(zt,Qt){return Vt.apply(this,arguments)}}()),Ut.abrupt("return",Jt());case 16:if(!Ot.callId){Ut.next=29;break}if(Ft!==!0){Ut.next=23;break}$n.debug("enableAudio remote with applyRemotely"),$n.debug("this.contact :",Ot.contact),Ot.sendStreamRequest(tt.g.CONTACT_ENABLE_AUDIO_REQUEST,Jt,dt),Ut.next=28;break;case 23:if(Ot.hasData()){Ut.next=25;break}return Ut.abrupt("return",dt());case 25:Ot.data.getAudioTracks().forEach(function(Vt){Vt.enabled=!0}),Ot.sendAudioFlowStatusChanged(),Ot.sendFlowStatusChanged("audio");case 28:return Ut.abrupt("return",Jt());case 29:return Ut.abrupt("return",dt());case 30:case"end":return Ut.stop()}},ln)}));return function(ln,Jt){return sn.apply(this,arguments)}}())}},{key:"disableAudio",value:function(){var Ot=this,Ft=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return new Promise(function(){var sn=Lo(oo().mark(function ln(Jt,dt){var Ct;return oo().wrap(function(Ut){for(;;)switch(Ut.prev=Ut.next){case 0:if(Ot.isAudioEnabled()!==!1||Ot.isRemote!==!1){Ut.next=3;break}return $n.debug("audio already disabled"),Ut.abrupt("return",Jt());case 3:if(!Ot.userMediaStreamId){Ut.next=16;break}if(Ct=apiCC.getUserMediaStream(Ot.userMediaStreamId)){Ut.next=7;break}return Ut.abrupt("return",dt());case 7:if(Ct.muteAudioOnStreams("enabled"),Ot.parent===void 0){Ut.next=12;break}return $n.debug("this is a child stream, need to mute parent if necessary"),Ut.next=12,Ot.parent.disableAudio();case 12:return Ot.childrens!==void 0&&Ot.childrens.forEach(function(){var Vt=Lo(oo().mark(function zt(Qt,Zt){return oo().wrap(function(on){for(;;)switch(on.prev=on.next){case 0:return on.next=2,Qt.disableAudio();case 2:case"end":return on.stop()}},zt)}));return function(zt,Qt){return Vt.apply(this,arguments)}}()),Ut.abrupt("return",Jt());case 16:if(!Ot.callId){Ut.next=29;break}if(Ft!==!0){Ut.next=23;break}$n.debug("disableAudio remote with applyRemotely"),$n.debug("this.contact :",Ot.contact),Ot.sendStreamRequest(tt.g.CONTACT_DISABLE_AUDIO_REQUEST,Jt,dt),Ut.next=28;break;case 23:if(Ot.hasData()){Ut.next=25;break}return Ut.abrupt("return",dt());case 25:Ot.data.getAudioTracks().forEach(function(Vt){Vt.enabled=!1}),Ot.sendAudioFlowStatusChanged(),Ot.sendFlowStatusChanged("audio");case 28:return Ut.abrupt("return",Jt());case 29:return Ut.abrupt("return",dt());case 30:case"end":return Ut.stop()}},ln)}));return function(ln,Jt){return sn.apply(this,arguments)}}())}},{key:"enableVideo",value:function(){var Ot=this,Ft=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return new Promise(function(){var sn=Lo(oo().mark(function ln(Jt,dt){var Ct;return oo().wrap(function(Ut){for(;;)switch(Ut.prev=Ut.next){case 0:if(Ot.isVideoEnabled()!==!0||Ot.isRemote!==!1){Ut.next=3;break}return $n.debug("video already enabled"),Ut.abrupt("return",Jt());case 3:if(!Ot.userMediaStreamId){Ut.next=16;break}if(Ct=apiCC.getUserMediaStream(Ot.userMediaStreamId)){Ut.next=7;break}return Ut.abrupt("return",dt());case 7:if(Ct.unMuteVideoOnStreams("enabled"),Ot.parent===void 0){Ut.next=12;break}return $n.debug("this is a child stream, need to unmute parent if necessary"),Ut.next=12,Ot.parent.enableVideo();case 12:return Ot.childrens!==void 0&&Ot.childrens.forEach(function(){var Vt=Lo(oo().mark(function zt(Qt,Zt){return oo().wrap(function(on){for(;;)switch(on.prev=on.next){case 0:return on.next=2,Qt.enableVideo();case 2:case"end":return on.stop()}},zt)}));return function(zt,Qt){return Vt.apply(this,arguments)}}()),Ut.abrupt("return",Jt());case 16:if(!Ot.callId){Ut.next=29;break}if(Ft!==!0){Ut.next=23;break}$n.debug("enableVideo remote with applyRemotely"),$n.debug("this.contact :",Ot.contact),Ot.sendStreamRequest(tt.g.CONTACT_ENABLE_VIDEO_REQUEST,Jt,dt),Ut.next=28;break;case 23:if(Ot.hasData()){Ut.next=25;break}return Ut.abrupt("return",dt());case 25:Ot.data.getVideoTracks().forEach(function(Vt){Vt.enabled=!0}),Ot.sendVideoFlowStatusChanged(),Ot.sendFlowStatusChanged("video");case 28:return Ut.abrupt("return",Jt());case 29:return Ut.abrupt("return",dt());case 30:case"end":return Ut.stop()}},ln)}));return function(ln,Jt){return sn.apply(this,arguments)}}())}},{key:"disableVideo",value:function(){var Ot=this,Ft=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return new Promise(function(){var sn=Lo(oo().mark(function ln(Jt,dt){var Ct;return oo().wrap(function(Ut){for(;;)switch(Ut.prev=Ut.next){case 0:if(Ot.isVideoEnabled()!==!1||Ot.isRemote!==!1){Ut.next=3;break}return $n.debug("video already disabled"),Ut.abrupt("return",Jt());case 3:if(!Ot.userMediaStreamId){Ut.next=16;break}if(Ct=apiCC.getUserMediaStream(Ot.userMediaStreamId)){Ut.next=7;break}return Ut.abrupt("return",dt());case 7:if(Ct.muteVideoOnStreams("enabled"),Ot.parent===void 0){Ut.next=12;break}return $n.debug("this is a child stream, need to mute parent if necessary"),Ut.next=12,Ot.parent.disableVideo();case 12:return Ot.childrens!==void 0&&Ot.childrens.forEach(function(){var Vt=Lo(oo().mark(function zt(Qt,Zt){return oo().wrap(function(on){for(;;)switch(on.prev=on.next){case 0:return on.next=2,Qt.disableVideo();case 2:case"end":return on.stop()}},zt)}));return function(zt,Qt){return Vt.apply(this,arguments)}}()),Ut.abrupt("return",Jt());case 16:if(!Ot.callId){Ut.next=29;break}if(Ft!==!0){Ut.next=23;break}$n.debug("disableVideo remote with applyRemotely"),$n.debug("this.contact :",Ot.contact),Ot.sendStreamRequest(tt.g.CONTACT_DISABLE_VIDEO_REQUEST,Jt,dt),Ut.next=28;break;case 23:if(Ot.hasData()){Ut.next=25;break}return Ut.abrupt("return",dt());case 25:Ot.data.getVideoTracks().forEach(function(Vt){Vt.enabled=!1}),Ot.sendVideoFlowStatusChanged(),Ot.sendFlowStatusChanged("video");case 28:return Ut.abrupt("return",Jt());case 29:return Ut.abrupt("return",dt());case 30:case"end":return Ut.stop()}},ln)}));return function(ln,Jt){return sn.apply(this,arguments)}}())}},{key:"getAudioFlowStatus",value:function(){var Ot={};return this.data.getAudioTracks().forEach(function(Ft){Ot.enabled=Ft.enabled,Ot.muted=Ft.muted}),Ot}},{key:"getVideoFlowStatus",value:function(){var Ot={};return this.data.getVideoTracks().forEach(function(Ft){Ot.enabled=Ft.enabled,Ot.muted=Ft.muted}),Ot}},{key:"getRemoteAudioFlowStatus",value:function(){var Ot=this;return new Promise(function(Ft,sn){if(!Ot.isRemote)return sn("Please use this function on a remote Stream");if($n.debug("getRemoteAudioFlowStatus()"),Ot.contact===null)return sn("No contact associated");var ln=Ot.addPendingPromise("getRemoteAudioFlowStatus",Ft,sn);Ot.contact.sendCustomEvent(tt.g.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:Ot.callId,streamId:Ot.getId(),timeout:ln})})}},{key:"getRemoteVideoFlowStatus",value:function(){var Ot=this;return new Promise(function(Ft,sn){if(!Ot.isRemote)return sn("Please use this function on a remote Stream");if($n.debug("getRemoteVideoFlowStatus()"),Ot.contact===null)return sn("No contact associated");var ln=Ot.addPendingPromise("getRemoteVideoFlowStatus",Ft,sn);Ot.contact.sendCustomEvent(tt.g.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:Ot.callId,streamId:Ot.getId(),timeout:ln})})}},{key:"attachToElement",value:function(Ot){$n.debug("attachToElement"),lu.attachMediaStream(Ot,this.data)}},{key:"addInDiv",value:function(Ot,Ft,sn,ln,Jt){$n.debug("addInDiv"),lu.addStreamInDiv(this.data,this.type,Ot,Ft,sn,ln,Jt)}},{key:"removeFromDiv",value:function(Ot,Ft){$n.debug("removeFromDiv"),lu.removeElementFromDiv(Ot,Ft)}},{key:"startRecord",value:function(Ot){return $n.info("startRecord :",Ot),apiCC.recordMgr.record(this.data,Ot)}},{key:"stopRecord",value:function(){return $n.info("stopRecord() - Stopping record"),apiCC.recordMgr.stop()}},{key:"pauseRecord",value:function(){return $n.info("pauseRecord() - Pausing record"),apiCC.recordMgr.pause()}},{key:"resumeRecord",value:function(){return $n.info("resumeRecord() - Resuming record"),apiCC.recordMgr.resume()}},{key:"enableAudioAnalysis",value:function(){var Ot=this,Ft=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};$n.info("enableAudioAnalysis()");var sn=Wt.g.getAudioContext(),ln=null,Jt=!1,dt=us.get(this),Ct=ds.get(this);sn?this.hasData()?dt!==null||Ct!==null?$n.error("enableAudioAnalysis() - Audio analysis already enabled"):(dt=sn.createMediaStreamSource(this.data),(Ct=sn.createScriptProcessor(2048,1,1)).connect(sn.destination),Ct.onaudioprocess=function(){var Ut,Vt=new Uint8Array(Ct.analyser.frequencyBinCount),zt=0;Ct.analyser.getByteFrequencyData(Vt);var Qt,Zt=$o(Vt);try{for(Zt.s();!(Qt=Zt.n()).done;)zt+=Qt.value}catch(qn){Zt.e(qn)}finally{Zt.f()}Ut=zt/Vt.length,tn.get(Ot).emit("audioAmplitude",Ut);var on=0;Vt.sort(function(qn,Jn){return Jn-qn}),Vt=Vt.slice(0,50);for(var bn=0;bn<Vt.length;bn++)on+=Vt[bn];Ut=on/Vt.length;var Rn=typeof Ft.threshold=="number"?Ft.threshold:tt.g.STREAM_AUDIO_ANALYSIS_THRESHOLD;Ut>Rn&&(Jt||(Jt=!0,tn.get(Ot).emit("audioAmplitudeInfo",{amplitude:Ut,isSpeaking:!0})),ln!==null&&clearTimeout(ln),ln=setTimeout(function(){tn.get(Ot).emit("audioAmplitudeInfo",{amplitude:Ut,isSpeaking:!1}),Jt=!1},1e3))},Ct.analyser=sn.createAnalyser(),Ct.analyser.smoothingTimeConstant=.5,Ct.analyser.fftSize=1024,dt.connect(Ct.analyser),Ct.analyser.connect(Ct),ds.set(this,Ct),us.set(this,dt)):$n.error("enableAudioAnalysis() - Stream has no data, unable to enable audio analysis"):$n.error("enableAudioAnalysis() - AudioContext is not available, unable to enable audio analysis")}},{key:"disableAudioAnalysis",value:function(){$n.info("disableAudioAnalysis()");var Ot=us.get(this),Ft=ds.get(this);Ot!==null&&Ot.disconnect(),Ft!==null&&(Ft.analyser.disconnect(),Ft.disconnect()),ds.set(this,null),us.set(this,null)}},{key:"takeSnapshot",value:function(){var Ot=this,Ft=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};$n.info("takeSnapshot()");var sn=null,ln=null;return new Promise(function(Jt,dt){if(Ot.hasData()){Ot.hasVideo()||$n.warn("takeSnapshot() - This stream does not have a video track"),sn=document.createElement("video"),ln=function(zt){if(Ct.width=sn.videoWidth,Ct.height=sn.videoHeight,Ft.hasOwnProperty("width")&&(Ct.width=Ft.width),Ft.hasOwnProperty("height")&&(Ct.height=Ft.height),Ft.hasOwnProperty("filters")){for(var Qt=[],Zt=0,on=Object.keys(Ft.filters);Zt<on.length;Zt++){var bn=on[Zt];Qt.push(bn+"("+Ft.filters[bn]+")")}Ut.filter=Qt.join(" ")}Ut.drawImage(sn,0,0,Ct.width,Ct.height),zt===!0&&sn.remove(),Ft.hasOwnProperty("output")&&Ft.output==="blob"?Ft.outputMimeType!==void 0?($n.debug("options.outputMimeType is defined :",Ft.outputMimeType),Ct.toBlob(function(Rn){Jt(Rn)},Ft.outputMimeType,Ft.outputQualityArgument)):Ct.toBlob(function(Rn){Jt(Rn)},"image/png"):Ft.outputMimeType!==void 0?($n.debug("options.outputMimeType is defined :",Ft.outputMimeType),Jt(Ct.toDataURL(Ft.outputMimeType,Ft.outputQualityArgument))):Jt(Ct.toDataURL("image/png"))};var Ct=document.createElement("canvas"),Ut=Ct.getContext("2d");Ft.divId===void 0||Ft.divId===null?setTimeout(function(){Ot.attachToElement(sn),sn.addEventListener("canplay",function(){ln(!0)}),sn.muted=!0,sn.play()},1e3):(sn=document.getElementById(Ft.divId))===null?$n.error("divId not found for snapshot"):ln(!1)}else{var Vt="takeSnapshot() - Stream has no data, cannot get snapshot";$n.error(Vt),dt(new Error(Vt))}})}},{key:"getId",value:function(){return String(this.streamId)}},{key:"getOwner",value:function(){return this.contact?this.contact:Br.getActiveSession().getUserAgent()}},{key:"getLabels",value:function(){var Ot={};return this.hasData()&&this.data.getAudioTracks().length>0&&(Ot.audioSourceLabel="",this.data.getAudioTracks()[0].label&&(Ot.audioSourceLabel=this.data.getAudioTracks()[0].label)),this.hasData()&&this.data.getVideoTracks().length>0&&(Ot.videoSourceLabel="",this.data.getVideoTracks()[0].label&&(Ot.videoSourceLabel=this.data.getVideoTracks()[0].label)),$n.debug("getLabels:",Ot),Ot}},{key:"checkImageCaptureCompatibility",value:function(){return typeof ImageCapture>"u"}},{key:"getLocalMediaStreamTrack",value:function(){var Ot=null;return this.data.getVideoTracks().length===1&&(Ot=this.data.getVideoTracks()[0]),Ot}},{key:"getLocalMediaStreamAudioTrack",value:function(){var Ot=null;return this.data.getAudioTracks().length===1&&(Ot=this.data.getAudioTracks()[0]),Ot}},{key:"applyConstraints",value:function(Ot){var Ft=this;return new Promise(function(sn,ln){if(Ft.isRemote){if($n.debug("applyConstraints() on a remote stream"),Ft.contact===null)return ln("No contact associated");var Jt=Ft.addPendingPromise("applyConstraints",sn,ln);Ft.contact.sendCustomEvent(tt.g.CONTACT_APPLY_CONSTRAINTS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:Ft.callId,streamId:Ft.getId(),timeout:Jt,constraints:Ot})}else{if($n.debug("applyConstraints() local"),!MediaStreamTrack.prototype.hasOwnProperty("applyConstraints"))return ln("Navigator not compatible with this function");var dt=null,Ct=null;if(Ot===void 0)return ln("Missing argument");Ot.audio!==void 0&&(dt=Ft.getLocalMediaStreamAudioTrack().applyConstraints(Ot.audio)),Ot.video!==void 0&&(Ct=Ft.getLocalMediaStreamTrack().applyConstraints(Ot.video)),Promise.all([dt,Ct]).then(function(Ut){$n.debug("Constraints applied :",Ot);var Vt,zt=uo.get().getConversations(),Qt=$o(zt.keys());try{for(Qt.s();!(Vt=Qt.n()).done;){var Zt=Vt.value,on=zt.get(Zt).getContactsArray(),bn=void 0;for(bn=0;bn<on.length;bn++)on[bn].sendCustomEvent(tt.g.CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:Ft.callId,streamId:Ft.getId(),constraints:Ot,mediaStreamId:Ft.data.id})}}catch(qn){Qt.e(qn)}finally{Qt.f()}if(Ft.callId!==null){$n.debug("This stream is used in a call, send CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER to remote");var Rn=apiCC.session.apiCCWebRTCClient.webRTCClient.findCallWithCallId(Ft.callId);Rn!==null&&Br.getActiveSession().getOrCreateContact(Rn.remoteId).sendCustomEvent(tt.g.CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:Ft.callId,streamId:Ft.getId(),constraints:Ot,mediaStreamId:Ft.data.id})}return sn()}).catch(function(Ut){return $n.error("reject Promise all :",Ut),ln(Ut)})}})}},{key:"applyConstraint",value:function(Ot,Ft){$n.error("Due to a certain amount of problems with this function it has been desactivated, please use Stream.applyConstraints instead")}},{key:"setCapability",value:function(Ot,Ft){$n.error("Due to a certain amount of problems with this function it has been desactivated, please use Stream.applyConstraints instead")}},{key:"getSettings",value:function(){var Ot=this;return new Promise(function(Ft,sn){if(!Ot.isRemote)return $n.debug("getSettings()"),MediaStreamTrack.prototype.hasOwnProperty("getSettings")?Ft({audio:Ot.getStreamTrackSettings(Ot.getLocalMediaStreamAudioTrack()),video:Ot.getStreamTrackSettings(Ot.getLocalMediaStreamTrack())}):sn("Navigator not compatible with this function");if($n.error("getSettings() on a remote stream"),Ot.contact===null)return sn("No contact associated");var ln=Ot.addPendingPromise("getSettings",Ft,sn);Ot.contact.sendCustomEvent(tt.g.CONTACT_GET_SETTINGS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:Ot.callId,streamId:Ot.getId(),timeout:ln})})}},{key:"getStreamTrackSettings",value:function(Ot){if(Ot!==null)return Ot.getSettings()}},{key:"getCapabilities",value:function(){var Ot=this;return new Promise(function(Ft,sn){if(!Ot.isRemote)return $n.debug("getCapabilities()"),MediaStreamTrack.prototype.hasOwnProperty("getCapabilities")?Ft({audio:Ot.getStreamTrackCapabilities(Ot.getLocalMediaStreamAudioTrack()),video:Ot.getStreamTrackCapabilities(Ot.getLocalMediaStreamTrack())}):sn("Navigator not compatible with this function");if($n.debug("getCapabilities() on a remote stream"),Ot.contact===null)return sn("No contact associated");var ln=Ot.addPendingPromise("getCapabilities",Ft,sn);Ot.contact.sendCustomEvent(tt.g.CONTACT_GET_CAPABILITIES_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:Ot.callId,streamId:Ot.getId(),timeout:ln})})}},{key:"getStreamTrackCapabilities",value:function(Ot){return Ot!==null?Ot.getCapabilities():{}}},{key:"getConstraints",value:function(){var Ot=this;return new Promise(function(Ft,sn){if(!Ot.isRemote)return $n.debug("getConstraints()"),MediaStreamTrack.prototype.hasOwnProperty("getConstraints")?Ft({audio:Ot.getStreamTrackConstraints(Ot.getLocalMediaStreamAudioTrack()),video:Ot.getStreamTrackConstraints(Ot.getLocalMediaStreamTrack())}):sn("Navigator not compatible with this function");if($n.debug("getConstraints() on a remote stream"),Ot.contact===null)return sn("No contact associated");var ln=Ot.addPendingPromise("getConstraints",Ft,sn);Ot.contact.sendCustomEvent(tt.g.CONTACT_GET_CONSTRAINTS_IDENTIFIER,{requesterId:Br.getActiveSession().getUserAgent().userId,callId:Ot.callId,streamId:Ot.getId(),timeout:ln})})}},{key:"getStreamTrackConstraints",value:function(Ot){return Ot!==null?Ot.getConstraints():{}}},{key:"takePhoto",value:function(){var Ot=this;return new Promise(function(Ft,sn){if($n.debug("takePhoto()"),Ot.checkImageCaptureCompatibility())sn("Your navigator is not compatible with takePhoto()");else{var ln=Ot.getLocalMediaStreamTrack();ln!==null?new ImageCapture(ln).takePhoto().then(function(Jt){var dt=new Image;dt.src=URL.createObjectURL(Jt),Ft(dt)}).catch(function(Jt){sn("takePhoto() error: ",Jt)}):sn("No local mediaStreamTrack found")}})}},{key:"activateAIAnnotations",value:function(){var Ot=this.getStreamAIE();Ot!==null&&Ot.activateAnnotations()}},{key:"stopAIAnnotations",value:function(){var Ot=this.getStreamAIE();Ot!==null&&Ot.stopAnnotations()}},{key:"activateAILogs",value:function(){var Ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(typeof Ot!="number")return $n.error("minLogPeriod parameter must be an integer");var Ft=this.getStreamAIE();Ft!==null&&Ft.activateLogs(Ot)}},{key:"stopAILogs",value:function(){var Ot=this.getStreamAIE();Ot!==null&&Ot.stopLogs()}},{key:"activateAISnapshots",value:function(){var Ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(typeof Ot!="number")return $n.error("minSnapshotPeriod parameter must be an integer");var Ft=this.getStreamAIE();Ft!==null&&Ft.activateSnapshots(Ot)}},{key:"stopAISnapshots",value:function(){var Ot=this.getStreamAIE();Ot!==null&&Ot.stopSnapshots()}},{key:"getStreamAIE",value:function(){var Ot=null;if(apiCC!==void 0){var Ft=apiCC.getUserMediaStream(this.userMediaStreamId);if(Ft.mediaFilterManager!==null){var sn=Ft.mediaFilterManager.filters;Object.values(sn).forEach(function(ln){ln.streamAIE!==null&&(Ot=ln.streamAIE)}),Ot===null&&$n.error("Applied filter is not an AI filter")}else $n.error("No filter applied on stream")}return Ot}},{key:"addChildren",value:function(Ot,Ft){this.childrenTypeExists(Ft)?$n.error("This stream already has a sub instance running for this"):(this.childrens===void 0&&(this.childrens=[]),this.childrens.push(Ot))}},{key:"releaseChildren",value:function(Ot){this.childrens!==void 0&&this.childrens.forEach(function(Ft,sn){Ft.childType===Ot&&Ft.release({releaseParentStream:!1})})}},{key:"releaseAllChildren",value:function(){$n.debug("releaseAllChildren"),this.childrens!==void 0&&this.childrens.forEach(function(Ot,Ft){Ot.release({releaseParentStream:!1})})}},{key:"removeChildren",value:function(Ot){var Ft=this;this.childrens!==void 0&&this.childrens.forEach(function(sn,ln){if(sn.childType===Ot)return Ft.childrens.splice(ln,1)})}},{key:"childrenTypeExists",value:function(Ot){var Ft=!1;return this.childrens!==void 0&&this.childrens.forEach(function(sn){sn.childType===Ot&&(Ft=!0)}),Ft}},{key:"createChildStreamFromStream",value:function(Ot,Ft){var sn=this,ln=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(Jt,dt){$n.debug("createChildStreamFromStream");var Ct={};Ct.type=tt.g.STREAM_TYPE_NO_INPUT,Ot.getAudioTracks().length>0&&(Ct.type=tt.g.STREAM_TYPE_AUDIO),Ot.getVideoTracks().length>0&&(Ct.type=tt.g.STREAM_TYPE_VIDEO);var Ut=sn;apiRTC.createUserMediaStream({type:"media",stream:Ot,success:function(Vt){$n.debug("[createChildStreamFromStream] success; userMediaStreamId: "+Vt.userMediaStreamId),Ct.constructor=!0,Ct.userMediaStreamId=Vt.userMediaStreamId;var zt=new um(Vt.stream,Ct,Ut,Ft);zt.parentStreamCtx=ln,ln.audioFilterIsApplied===!0&&(zt.audioFilterIsApplied=ln.audioFilterIsApplied,zt.audioAppliedFilter=ln.audioAppliedFilter),ln.videoFilterIsApplied===!0&&(zt.videoFilterIsApplied=ln.videoFilterIsApplied,zt.videoAppliedFilter=ln.videoAppliedFilter),Jt(zt)},failure:function(Vt,zt){$n.debug("[createChildStreamFromStream] failure :",zt),dt()},childStreamType:Ft})})}},{key:"applyMuteStatusFromParent",value:function(){var Ot=this,Ft=0;this.data.getAudioTracks().forEach(function(ln){ln.enabled=Ot.parent.data.getAudioTracks()[Ft].enabled,Ft++});var sn=0;this.data.getVideoTracks().forEach(function(ln){ln.enabled=Ot.parent.data.getVideoTracks()[sn].enabled,sn++})}},{key:"loadTFLiteModule",value:function(){return new Promise(function(Ot,Ft){var sn;if(sn=au.feature.simd?"https://cdn.apizee.com/apiRTC/lib/tflite/tflite-simd.js":"https://cdn.apizee.com/apiRTC/lib/tflite/tflite.js",apiRTC.userAgentInstance.tFLiteModuleLoaded===!1){$n.debug("loading tflite");var ln={async:!0,numRetries:20,reqdelay:200,success:function(){$n.debug("loaded successfully",au.feature.simd),au.feature.simd?createTFLiteSIMDModule().then(function(Jt){apiRTC.userAgentInstance.tFLiteSIMDModule=Jt,apiRTC.userAgentInstance.tFLiteModuleLoaded=!0,Ot(Jt)}):createTFLiteModule().then(function(Jt){apiRTC.userAgentInstance.tFLiteSIMDModule=Jt,apiRTC.userAgentInstance.tFLiteModuleLoaded=!0,Ot(Jt)})},error:function(Jt){Ft("Resources loading failed, depsNotFound: "+Jt)},retrycb:function(Jt,dt){$n.warn("Blur API module loading retry :"+Jt+" ,delay before retry :"+dt)}};apiCC.resourcesLoader.loadjs([sn],"blur-api",ln)}else $n.debug("tflite already loaded and TFLiteSIMDModule already created"),Ot(apiRTC.userAgentInstance.tFLiteSIMDModule)})}},{key:"setupTFLiteModule",value:function(Ot){return new Promise(function(Ft,sn){$n.debug("setupTFLiteModule"),apiRTC.userAgentInstance.modelLoadedInModule===!1?($n.debug("loading model landscape"),fetch("https://cdn.apizee.com/apiRTC/lib/tflite/models/selfie_segmentation_landscape.tflite").then(function(ln){if(!ln.ok)throw new Error("Failed to download tflite model!");$n.debug("loaded successfully");var Jt=Ot._getModelBufferMemoryOffset();ln.arrayBuffer().then(function(dt){Ot.HEAPU8.set(new Uint8Array(dt),Jt),Ot._loadModel(dt.byteLength),$n.debug("module setup complete"),apiRTC.userAgentInstance.modelLoadedInModule=!0,apiRTC.userAgentInstance.tFLiteSIMDModule=Ot,Ft(Ot)})}).catch(function(ln){$n.error("Something went wrong during tflite model loading..",ln)})):($n.debug("model landscape already loaded in module"),Ft(apiRTC.userAgentInstance.tFLiteSIMDModule))})}},{key:"onMaskFrameTimer",value:function(Ot){Ot.data.id===this.blurVariables.TIMEOUT_TICK&&this.renderMask()}},{key:"renderMask",value:function(){this.resizeSource(),this.runInference(),this.runPostProcessing(),this.blurVariables.maskFrameTimerWorker.postMessage({id:this.blurVariables.SET_TIMEOUT,timeMs:1e3/30})}},{key:"resizeSource",value:function(){this.blurVariables.segmentationMaskCtx.drawImage(this.blurVariables.inputVideoElement,0,0,this.blurVariables.inputVideoElement.width,this.blurVariables.inputVideoElement.height,0,0,this.blurVariables.width,this.blurVariables.height);for(var Ot=this.blurVariables.segmentationMaskCtx.getImageData(0,0,this.blurVariables.width,this.blurVariables.height),Ft=this.blurVariables.tfliteModel._getInputMemoryOffset()/4,sn=0;sn<this.blurVariables.segmentationPixelCount;sn++)this.blurVariables.tfliteModel.HEAPF32[Ft+3*sn]=Ot.data[4*sn]/255,this.blurVariables.tfliteModel.HEAPF32[Ft+3*sn+1]=Ot.data[4*sn+1]/255,this.blurVariables.tfliteModel.HEAPF32[Ft+3*sn+2]=Ot.data[4*sn+2]/255}},{key:"runInference",value:function(){this.blurVariables.tfliteModel._runInference();for(var Ot=this.blurVariables.tfliteModel._getOutputMemoryOffset()/4,Ft=0;Ft<this.blurVariables.segmentationPixelCount;Ft++){var sn=this.blurVariables.tfliteModel.HEAPF32[Ot+Ft];this.blurVariables.segmentationMask.data[4*Ft+3]=255*sn}this.blurVariables.segmentationMaskCtx.putImageData(this.blurVariables.segmentationMask,0,0)}},{key:"runPostProcessing",value:function(){var Ot=this.blurVariables.firstVideoTrack.getSettings?this.blurVariables.firstVideoTrack.getSettings():this.blurVariables.firstVideoTrack.getConstraints(),Ft=Ot.height,sn=Ot.width;if(this.blurVariables.outputCanvasElement.height=Ft,this.blurVariables.outputCanvasElement.width=sn,this.blurVariables.outputCanvasCtx.globalCompositeOperation="copy",this.blurVariables.outputCanvasCtx.filter=this.blurVariables.virtualBackground==="image"?"blur(4px)":"blur(8px)",this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.segmentationMaskCanvas,0,0,this.blurVariables.width,this.blurVariables.height,0,0,this.blurVariables.inputVideoElement.width,this.blurVariables.inputVideoElement.height),this.blurVariables.outputCanvasCtx.globalCompositeOperation="source-in",this.blurVariables.outputCanvasCtx.filter="none",this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.inputVideoElement,0,0),this.blurVariables.outputCanvasCtx.globalCompositeOperation="destination-over",this.blurVariables.virtualBackground==="image")if(this.blurVariables.outputCanvasElement.width/this.blurVariables.outputCanvasElement.height===this.blurVariables.imageRatio)this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.virtualImage,0,0,this.blurVariables.virtualImage.width,this.blurVariables.virtualImage.height,0,0,this.blurVariables.outputCanvasElement.width,this.blurVariables.outputCanvasElement.height);else if(this.blurVariables.imageRatio>1){var ln=this.blurVariables.virtualImage.height*(this.blurVariables.outputCanvasElement.width/this.blurVariables.outputCanvasElement.height),Jt=this.blurVariables.virtualImage.height,dt=Math.abs(this.blurVariables.virtualImage.width-ln)/2;ln>this.blurVariables.virtualImage.width&&(ln=this.blurVariables.virtualImage.width,dt=0),this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.virtualImage,dt,0,ln,Jt,0,0,this.blurVariables.outputCanvasElement.width,this.blurVariables.outputCanvasElement.height)}else{var Ct=this.blurVariables.virtualImage.width,Ut=this.blurVariables.virtualImage.width/(this.blurVariables.outputCanvasElement.width/this.blurVariables.outputCanvasElement.height),Vt=Math.abs(this.blurVariables.virtualImage.height-Ut)/2;Ut>this.blurVariables.virtualImage.height&&(Ut=this.blurVariables.virtualImage.height,Vt=0),this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.virtualImage,0,Vt,Ct,Ut,0,0,this.blurVariables.outputCanvasElement.width,this.blurVariables.outputCanvasElement.height)}else this.blurVariables.outputCanvasCtx.filter="blur(15px)",this.blurVariables.outputCanvasCtx.drawImage(this.blurVariables.inputVideoElement,0,0)}},{key:"startSelfieSegmentation",value:function(){var Ot=this;return new Promise(function(Ft,sn){$n.debug("startSelfieSegmentation"),Ot.loadTFLiteModule().then(function(ln){Ot.setupTFLiteModule(ln).then(function(Jt){if(Ot.blurVariables.tfliteModel=Jt,Ot.blurVariables.firstVideoTrack=Ot.data.getVideoTracks()[0],Ot.blurVariables.firstVideoTrack!==null&&Ot.blurVariables.firstVideoTrack!==void 0){var dt=Ot.blurVariables.firstVideoTrack.getSettings?Ot.blurVariables.firstVideoTrack.getSettings():Ot.blurVariables.firstVideoTrack.getConstraints(),Ct=dt.height,Ut=dt.frameRate,Vt=dt.width;Ot.blurVariables.height=144,Ot.blurVariables.width=256,Ot.blurVariables.frameRate=Ut,Ot.blurVariables.segmentationPixelCount=Ot.blurVariables.width*Ot.blurVariables.height,Ot.onMaskFrameTimer=Ot.onMaskFrameTimer.bind(Ot),Ot.blurVariables.outputCanvasElement=document.createElement("canvas"),Ot.blurVariables.outputCanvasElement.getContext("2d"),Ot.blurVariables.inputVideoElement=document.createElement("video"),Ot.blurVariables.SET_TIMEOUT=1,Ot.blurVariables.CLEAR_TIMEOUT=2,Ot.blurVariables.TIMEOUT_TICK=3,Ot.blurVariables.maskFrameTimerWorker=new Worker(URL.createObjectURL(new Blob([`
                                        var timer;
                                        onmessage = function(request) {
                                            switch (request.data.id) {
                                            case `.concat(Ot.blurVariables.SET_TIMEOUT,`: {
                                                timer = setTimeout(() => {
                                                    postMessage({ id: `).concat(Ot.blurVariables.TIMEOUT_TICK,` });
                                                }, request.data.timeMs);
                                                break;
                                            }
                                            case `).concat(Ot.blurVariables.CLEAR_TIMEOUT,`: {
                                                if (timer) {
                                                    clearTimeout(timer);
                                                }
                                                break;
                                            }
                                            }
                                        };
                                    `)],{type:"application/javascript"})),{name:"Blur effect worker"}),Ot.blurVariables.maskFrameTimerWorker.onmessage=Ot.onMaskFrameTimer,Ot.blurVariables.segmentationMask=new ImageData(Ot.blurVariables.width,Ot.blurVariables.height),Ot.blurVariables.segmentationMaskCanvas=document.createElement("canvas"),Ot.blurVariables.segmentationMaskCanvas.width=Ot.blurVariables.width,Ot.blurVariables.segmentationMaskCanvas.height=Ot.blurVariables.height,Ot.blurVariables.segmentationMaskCtx=Ot.blurVariables.segmentationMaskCanvas.getContext("2d"),Ot.blurVariables.outputCanvasElement.width=parseInt(Vt,10),Ot.blurVariables.outputCanvasElement.height=parseInt(Ct,10),Ot.blurVariables.outputCanvasCtx=Ot.blurVariables.outputCanvasElement.getContext("2d"),Ot.blurVariables.inputVideoElement.width=parseInt(Vt,10),Ot.blurVariables.inputVideoElement.height=parseInt(Ct,10),Ot.blurVariables.inputVideoElement.autoplay=!0,Ot.blurVariables.inputVideoElement.srcObject=Ot.data,Ot.blurVariables.inputVideoElement.onloadeddata=function(){Ot.blurVariables.inputVideoElement.muted=!0,Ot.blurVariables.maskFrameTimerWorker.postMessage({id:Ot.blurVariables.SET_TIMEOUT,timeMs:1e3/30})},Ft(Ot.blurVariables.outputCanvasElement.captureStream(parseInt(Ot.blurVariables.frameRate,10)))}else sn("No video track on stream")}).catch(function(){return $n.error("Catch on setupTFLiteModule"),sn("Catch on setupTFLiteModule")})}).catch(function(){return $n.error("Catch on loadTFLiteModule"),sn("Catch on loadTFLiteModule")})})}},{key:"stopSelfieSegmentation",value:function(){$n.debug("stopSelfieSegmentation"),this.blurVariables.maskFrameTimerWorker.postMessage({id:this.blurVariables.CLEAR_TIMEOUT}),this.blurVariables.maskFrameTimerWorker.terminate()}},{key:"checkChildTypeConditions",value:function(){return this.childType!==void 0&&this.videoFilterIsApplied?"This stream is already a childStream : need to remove previous applied effect : "+this.childType:this.childrenTypeExists("blur")?"This stream already has a blur sub instance running : need to unblur()":this.childrenTypeExists("backgroundImage")?"This stream already has a backgroundImage sub instance running : need to unBackgroundImage()":MediaStreamTrack.prototype.hasOwnProperty("getSettings")&&MediaStreamTrack.prototype.hasOwnProperty("getConstraints")?"OK":"Navigator not compatible with this function"}},{key:"blur",value:function(){var Ot=this;return new Promise(function(Ft,sn){var ln=Ot.checkChildTypeConditions();if(ln!=="OK")return sn(ln);if(apiCC.userAgentInstance.getCapabilities().backgroundRemoval==="OFF")return sn("Navigator not compatible with this function");var Jt=Ot;Ot.blurVariables={},Ot.blurVariables.virtualBackground="blur",Ot.startSelfieSegmentation().then(function(dt){var Ct,Ut=$o(Jt.data.getAudioTracks());try{for(Ut.s();!(Ct=Ut.n()).done;){var Vt=Ct.value;dt.addTrack(Vt.clone())}}catch(Qt){Ut.e(Qt)}finally{Ut.f()}var zt={audioFilterIsApplied:Ot.audioFilterIsApplied,audioAppliedFilter:Ot.audioAppliedFilter,videoFilterIsApplied:Ot.videoFilterIsApplied,videoAppliedFilter:Ot.videoAppliedFilter,childType:Ot.childType};Jt.createChildStreamFromStream(dt,"blur",zt).then(function(Qt){return Ot.addChildren(Qt,"blur"),Qt.applyMuteStatusFromParent(),Ft(Qt)}).catch(function(){return $n.error("Catch on createChildStreamFromStream blur"),sn("error on createChildStreamFromStream")})}).catch(function(dt){return $n.error("Catch on startSelfieSegmentation blur : ",dt),sn(dt)})})}},{key:"unblur",value:function(){var Ot=this;return new Promise(function(Ft,sn){if(apiCC.userAgentInstance.getCapabilities().backgroundRemoval==="OFF")return sn("Navigator not compatible with this function");if(Ot.childType==="blur"){$n.debug("This is the blurred stream : applying process with parent stream");var ln=Ot.parent;return ln.stopSelfieSegmentation(),ln.releaseChildren("blur"),ln.removeChildren("blur"),Ft(ln)}return Ot.childrenTypeExists("blur")?($n.debug("This is the parent stream : applying process with this stream"),Ot.stopSelfieSegmentation(),Ot.releaseChildren("blur"),Ot.removeChildren("blur"),Ft(Ot)):($n.debug("No blurred instance found for this stream"),sn("No blurred instance found for this stream"))})}},{key:"backgroundImage",value:function(Ot){var Ft=this;return $n.debug("backgroundImage",Ot),new Promise(function(sn,ln){var Jt=Ft.checkChildTypeConditions();if(Jt!=="OK")return ln(Jt);if(apiCC.userAgentInstance.getCapabilities().backgroundRemoval==="OFF")return ln("Navigator not compatible with this function");var dt=Ft;Ft.blurVariables={},Ft.blurVariables.virtualBackground="image",Ft.blurVariables.virtualImage=new Image,Ft.blurVariables.virtualImage.crossOrigin="anonymous",Ft.blurVariables.virtualImage.src=Ot,Ft.blurVariables.virtualImage.onload=function(){Ft.blurVariables.imageRatio=Ft.blurVariables.virtualImage.width/Ft.blurVariables.virtualImage.height,Ft.startSelfieSegmentation().then(function(Ct){var Ut,Vt=$o(dt.data.getAudioTracks());try{for(Vt.s();!(Ut=Vt.n()).done;){var zt=Ut.value;Ct.addTrack(zt.clone())}}catch(Zt){Vt.e(Zt)}finally{Vt.f()}var Qt={audioFilterIsApplied:Ft.audioFilterIsApplied,audioAppliedFilter:Ft.audioAppliedFilter,videoFilterIsApplied:Ft.videoFilterIsApplied,videoAppliedFilter:Ft.videoAppliedFilter,childType:Ft.childType};dt.createChildStreamFromStream(Ct,"backgroundImage",Qt).then(function(Zt){return Ft.addChildren(Zt,"backgroundImage"),Zt.applyMuteStatusFromParent(),sn(Zt)}).catch(function(){return $n.error("Catch on createChildStreamFromStream bck"),ln("error on createChildStreamFromStream")})}).catch(function(Ct){return $n.error("Catch on startSelfieSegmentation bck : ",Ct),ln(Ct)})},Ft.blurVariables.virtualImage.onerror=function(){return $n.debug("Error on image loading"),ln("Error on image loading")}})}},{key:"unBackgroundImage",value:function(){var Ot=this;return $n.debug("unBackgroundImage"),new Promise(function(Ft,sn){if(apiCC.userAgentInstance.getCapabilities().backgroundRemoval==="OFF")return sn("Navigator not compatible with this function");if(Ot.childType==="backgroundImage"){$n.debug("This is the backgroundImage stream : applying process with parent stream");var ln=Ot.parent;return ln.stopSelfieSegmentation(),ln.releaseChildren("backgroundImage"),ln.removeChildren("backgroundImage"),Ft(ln)}return Ot.childrenTypeExists("backgroundImage")?($n.debug("This is the parent stream : applying process with this stream"),Ot.stopSelfieSegmentation(),Ot.releaseChildren("backgroundImage"),Ot.removeChildren("backgroundImage"),Ft(Ot)):($n.debug("No background image instance found for this stream"),sn("No background image instance found for this stream"))})}},{key:"applyVideoProcessor",value:function(Ot,Ft){var sn=this;return new Promise(function(ln,Jt){if(Ot!=="none"&&Ot!=="blur"&&Ot!=="backgroundImage")return Jt(new Gr("Requested videoProcessorType is not correct","none",sn));var dt=sn,Ct="none",Ut=null,Vt=sn,zt=!1;if(sn.childType==="noiseReduction"&&sn.videoFilterIsApplied===!0&&($n.debug("This is a noised reduced stream ... applying filter on parent"),Vt=sn.parent,sn.release({releaseParentStream:!1}),zt=!0),Vt.childType!==void 0&&Vt.videoFilterIsApplied===!0&&(Vt.childType==="blur"?Ct="blur":Vt.childType==="backgroundImage"&&(Ct="backgroundImage"),dt=Vt.parent,Ut=Vt),Vt.childrenTypeExists("blur")&&(Ct="blur",Vt.childrens.forEach(function(on){Ut=on})),Vt.childrenTypeExists("backgroundImage")&&(Ct="backgroundImage",Vt.childrens.forEach(function(on){Ut=on})),$n.debug("actual applied effect =",Ct),Ot==="none"&&Ct==="none")return Jt(new Gr("Requested videoProcessorType none and no effect applied","none",dt));if(Ot==="none"&&Ct==="blur")$n.debug("need to unblur"),dt.unblur().then(function(on){if(zt!==!0)return ln(on);on.startNoiseReduction().then(function(bn){return ln(bn)}).catch(function(bn){return $n.error("Catch on startNoiseReduction :",bn),Jt(new Wo(bn,on.audioAppliedFilter,dt))})}).catch(function(on){return $n.error("Catch on unblur: ",on),Jt(new Gr(on,"none",dt))});else if(Ot==="none"&&Ct==="backgroundImage")$n.debug("need to unBackgroundImage"),dt.unBackgroundImage().then(function(on){if(zt!==!0)return ln(on);on.startNoiseReduction().then(function(bn){return ln(bn)}).catch(function(bn){return $n.error("Catch on startNoiseReduction :",bn),Jt(new Wo(bn,on.audioAppliedFilter,dt))})}).catch(function(on){return $n.error("Catch on unBackgroundImage :",on),Jt(new Gr(on,"none",dt))});else if(Ot==="blur"&&Ct==="none")$n.debug("need to blur"),dt.blur().then(function(on){if(zt!==!0)return ln(on);on.startNoiseReduction().then(function(bn){return ln(bn)}).catch(function(bn){return $n.error("Catch on startNoiseReduction :",bn),Jt(new Wo(bn,on.audioAppliedFilter,dt))})}).catch(function(on){return $n.error("Catch on blur :",on),Jt(new Gr(on,"none",dt))});else{if(Ot==="blur"&&Ct==="blur")return Jt(new Gr("Requested videoProcessorType blur and blur already applied","blur",Ut));if(Ot==="blur"&&Ct==="backgroundImage"){$n.debug("need to unBackgroundImage then blur");var Qt=dt.blurVariables.virtualImage.src;dt.unBackgroundImage().then(function(on){on.blur().then(function(bn){if(zt!==!0)return ln(bn);bn.startNoiseReduction().then(function(Rn){return ln(Rn)}).catch(function(Rn){return $n.error("Catch on startNoiseReduction :",Rn),Jt(new Wo(Rn,bn.audioAppliedFilter,dt))})}).catch(function(bn){$n.warn("Catch on blur - unBackgroundImage to blur :",bn),$n.debug("Reactivating previous effect : backgroundImage"),dt.backgroundImage(Qt).then(function(Rn){if($n.warn("Could not apply blur effect, background restored"),zt!==!0)return Jt(new Gr("Could not apply blur effect, background restored","backgroundImage",Rn));Rn.startNoiseReduction().then(function(qn){return Jt(new Gr("Could not apply blur effect, background restored","backgroundImage",qn))}).catch(function(qn){return $n.error("Catch on startNoiseReduction :",qn),Jt(new Gr("Could not apply blur effect, background restored","backgroundImage",Rn))})}).catch(function(Rn){return $n.error("Could not apply blur effect and error in restoring background :",Rn),Jt(new Gr("Could not apply blur effect and error in restoring background","none",dt))})})}).catch(function(on){return $n.error("Catch on unBackgroundImage :",on),Jt(new Gr(on,"none",dt))})}else if(Ot==="backgroundImage"&&Ct==="none"){if($n.debug("need to backgroundImage"),Ft===void 0||Ft.backgroundImageUrl===void 0)return Jt(new Gr("Error options.backgroundImageUrl is not defined","none",dt));dt.backgroundImage(Ft.backgroundImageUrl).then(function(on){if(zt!==!0)return ln(on);on.startNoiseReduction().then(function(bn){return ln(bn)}).catch(function(bn){return $n.error("Catch on startNoiseReduction :",bn),Jt(new Gr("Could not apply blur effect, background restored","backgroundImage",on))})}).catch(function(on){return $n.error("Catch on backgroundImage :",on),Jt(new Gr(on,"none",dt))})}else if(Ot==="backgroundImage"&&Ct==="blur")$n.debug("need to unblur then backgroundImage"),dt.unblur().then(function(on){on.backgroundImage(Ft.backgroundImageUrl).then(function(bn){if(zt!==!0)return ln(bn);bn.startNoiseReduction().then(function(Rn){return ln(Rn)}).catch(function(Rn){return $n.error("Catch on startNoiseReduction :",Rn),Jt(new Gr("Could not apply blur effect, background restored","backgroundImage",bn))})}).catch(function(bn){$n.warn("Catch on backgroundImage - unBackgroundImage to blur :",bn),$n.debug("Reactivating previous effect : blur"),dt.blur().then(function(Rn){if(zt!==!0)return $n.warn("Could not apply background effect, blur restored"),Jt(new Gr("Could not apply background effect, blur restored","blur",Rn));Rn.startNoiseReduction().then(function(qn){return Jt(new Gr("Could not apply background effect, blur restored","blur",qn))}).catch(function(qn){return $n.error("Catch on startNoiseReduction :",qn),Jt(new Gr("Could not apply background effect, blur restored","blur",Rn))})}).catch(function(Rn){return $n.error("Could not apply background effect and error in restoring blur :",Rn),Jt(new Gr("Could not apply background effect and error in restoring blur","none",dt))})})}).catch(function(on){return $n.error("Catch on unblur :",on),Jt(new Gr(on,"none",dt))});else if(Ot==="backgroundImage"&&Ct==="backgroundImage"){var Zt=dt.blurVariables.virtualImage.src;if(Ft.backgroundImageUrl.startsWith("data:image")===!1&&Zt.substring(Zt.lastIndexOf("/")+1)===Ft.backgroundImageUrl.substring(Ft.backgroundImageUrl.lastIndexOf("/")+1))return $n.debug("Same background image is already applied"),Jt(new Gr("Requested videoProcessorType backgroundImage and backgroundImage with the same image already applied","backgroundImage",Ut));$n.debug("New background image is to be applied"),dt.unBackgroundImage().then(function(on){on.backgroundImage(Ft.backgroundImageUrl).then(function(bn){if(zt!==!0)return ln(bn);bn.startNoiseReduction().then(function(Rn){return ln(Rn)}).catch(function(Rn){return $n.error("Catch on startNoiseReduction :",Rn),Jt(new Gr("Could not apply background effect, blur restored","blur",bn))})}).catch(function(bn){$n.warn("Catch on backgroundImage - change background image :",bn),$n.debug("Reactivating previous effect : backgroundImage"),dt.backgroundImage(Zt).then(function(Rn){if(zt!==!0)return Jt(new Gr("Could not apply new image on background, former background restored","backgroundImage",Rn));Rn.startNoiseReduction().then(function(qn){return $n.warn("Could not apply new image on background, former background restored"),Jt(new Gr("Could not apply new image on background, former background restored","backgroundImage",qn))}).catch(function(qn){return $n.error("Catch on startNoiseReduction :",qn),Jt(new Gr("Could not apply background effect, blur restored","blur",Rn))})}).catch(function(Rn){return $n.error("Could not apply new image on background and error in restoring former background :",Rn),Jt(new Gr("Could not apply new image on background and error in restoring former background","none",dt))})})}).catch(function(on){return $n.error("Catch on unBackgroundImage :",on),Jt(new Gr(on,"none",dt))})}}})}},{key:"checkAudioProcessorType",value:function(Ot){return Ot!=="none"&&Ot!=="noiseReduction"?"Requested audioProcessorType is not correct":Ot==="none"&&this.audioAppliedFilter!=="noiseReduction"?"Not a noised reduction stream":"OK"}},{key:"applyAudioProcessor",value:function(Ot){var Ft=this;return new Promise(function(sn,ln){var Jt=Ft,dt="none",Ct="none",Ut=Ft.checkAudioProcessorType(Ot);if(Ut!=="OK")return ln(new Wo(Ut,Ft.audioAppliedFilter,Ft));if(Ot==="none"){if(Ft.childType!=="noiseReduction"&&Ft.parent.childType==="noiseReduction"?($n.debug("applying process on parent stream as this one must be a video effect stream"),Jt=Ft.parent,dt=Ft.childType,Ft.parent.blurVariables!==void 0&&Ft.parent.blurVariables.virtualImage!==void 0&&(Ct=Ft.parent.blurVariables.virtualImage.src),Ft.release({releaseParentStream:!1})):$n.debug("no noiseReduction applied"),Jt.stopNoiseReduction(),dt==="none"){$n.debug("Release noiseReduction stream");var Vt=Ft.parent;return Jt.release({releaseParentStream:!1}),sn(Vt)}var zt={backgroundImageUrl:Ct};Jt.parent.applyVideoProcessor(dt,zt).then(function(Qt){return $n.debug("Release noiseReduction stream"),Jt.release({releaseParentStream:!1}),sn(Qt)}).catch(function(Qt){return $n.error("Catch on applyVideoProcessor() - reapply effect : ",Qt),ln(new Wo("Error on restoring applied video filter",this.audioAppliedFilter,this))})}else Ot==="noiseReduction"&&Jt.startNoiseReduction().then(function(Qt){return sn(Qt)}).catch(function(Qt){return $n.error("Catch on startNoiseReduction :",Qt),ln(new Wo(Qt,Jt.audioAppliedFilter,Jt))})})}},{key:"startNoiseReduction",value:function(){return apiCC.audioProcessor.startNoiseReduction(this)}},{key:"stopNoiseReduction",value:function(){apiCC.audioProcessor.stopAudioNodeCtx(this.parent.nodeCtx)}},{key:"createMediaStreamTrackProcessor",value:function(){var Ot=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if($n.debug("mediaStreamTrackProcessor kind: ".concat(Ot?"audio":"video"," created")),Ot){var Ft=this.data.getAudioTracks();if(Ft.length)return new MediaStreamTrackProcessor({track:Ft[0]});throw new Error("No audio tracks found")}var sn=this.data.getVideoTracks();if(sn.length)return new MediaStreamTrackProcessor({track:sn[0]});throw new Error("No video tracks found")}},{key:"createMediaStreamTrackGenerator",value:function(){var Ot=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return $n.debug("mediaStreamTrackGenerator kind: ".concat(Ot?"audio":"video"," created")),Ot?new MediaStreamTrackGenerator({kind:"audio"}):new MediaStreamTrackGenerator({kind:"video"})}},{key:"loadSegmentationAPI",value:function(){return new Promise(function(Ot,Ft){var sn={async:!0,numRetries:20,reqdelay:200,success:function(){$n.debug("Segmentation API loaded"),mergeReality.then(Ot)},error:function(ln){Ft("Resources loading failed, depsNotFound: "+ln)},retrycb:function(ln,Jt){$n.warn("Blur API model loading retry :"+ln+" ,delay before retry :"+Jt)}};apiCC.resourcesLoader.loadjs(["https://cdn.apizee.com/apiRTC/lib/mergereality/v1.0/merge_reality.js"],"merge-reality",sn)})}},{key:"startMergeReality",value:function(Ot){var Ft=this;this.mergeRealityData={},this.mergeRealityLib=Ot,this.mergeRealityData.stop=!1,this.mergeRealityData.WIDTH=this.getSettings().width,this.mergeRealityData.HEIGHT=this.getSettings().height,this.mergeRealityData.WEBCAM_CANVAS=new OffscreenCanvas(this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.WEBCAM_CTX=this.mergeRealityData.WEBCAM_CANVAS.getContext("2d",{alpha:!1}),this.mergeRealityData.MASK_CANVAS=new OffscreenCanvas(this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.MASK_CTX=this.mergeRealityData.MASK_CANVAS.getContext("2d",{alpha:!0}),this.mergeRealityData.SCREEN_VIDEO=document.createElement("video"),this.mergeRealityData.BG_SUB=new this.mergeRealityLib.BackgroundSubtractor,this.mergeRealityData.background=new this.mergeRealityLib.BackgroundImage(this.mergeRealityData.WEBCAM_CTX.getImageData(0,0,this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.MSTP=this.createMediaStreamTrackProcessor().readable,this.mergeRealityData.MSTG=this.createMediaStreamTrackGenerator(),this.mergeRealityData.SINK=this.mergeRealityData.MSTG.writable,this.mergeRealityData.MASK_TRANSFORMER=new TransformStream({transform:function(sn,ln){Ft.mergeRealityData.stop||(Ft.mergeRealityData.MASK_CTX.save(),Ft.mergeRealityData.MASK_CTX.clearRect(0,0,Ft.mergeRealityData.WIDTH,Ft.mergeRealityData.HEIGHT),Ft.mergeRealityData.WEBCAM_CTX.clearRect(0,0,Ft.mergeRealityData.WIDTH,Ft.mergeRealityData.HEIGHT),Ft.mergeRealityData.WEBCAM_CTX.drawImage(sn,0,0),Ft.mergeRealityData.MASK_DATA=Ft.mergeRealityData.BG_SUB.computeMask(Ft.mergeRealityData.WEBCAM_CTX.getImageData(0,0,Ft.mergeRealityData.WIDTH,Ft.mergeRealityData.HEIGHT),Ft.mergeRealityData.background),Ft.mergeRealityData.RES=Ft.mergeRealityData.BG_SUB.applyTransparency(Ft.mergeRealityData.WEBCAM_CTX.getImageData(0,0,Ft.mergeRealityData.WIDTH,Ft.mergeRealityData.HEIGHT),Ft.mergeRealityData.MASK_DATA),Ft.mergeRealityData.MASK_CTX.putImageData(Ft.mergeRealityData.RES,0,0),Ft.mergeRealityData.MASK_CTX.globalCompositeOperation="destination-atop",Ft.mergeRealityData.MASK_CTX.drawImage(Ft.mergeRealityData.SCREEN_VIDEO,0,0,Ft.mergeRealityData.WIDTH,Ft.mergeRealityData.HEIGHT),Ft.mergeRealityData.MASK_CTX.restore(),ln.enqueue(new VideoFrame(Ft.mergeRealityData.MASK_CANVAS))),sn.close()}}),this.mergeRealityData.RES_MS=new MediaStream}},{key:"stopMergeReality",value:function(){this.mergeRealityData.stop=!0}},{key:"calibrateBackground",value:function(){this.childrenTypeExists("merge")?this.mergeRealityData.background=new this.mergeRealityLib.BackgroundImage(this.mergeRealityData.WEBCAM_CTX.getImageData(0,0,this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT),this.mergeRealityData.WIDTH,this.mergeRealityData.HEIGHT):$n.error("No merged instance found for this stream")}},{key:"mergeReality",value:function(Ot){var Ft=this;return new Promise(function(sn,ln){return window.MediaStreamTrackGenerator===void 0||window.MediaStreamTrackProcessor===void 0||window.TransformStream===void 0?ln("Your browser does not support InsertableStreams"):Ft.childrenTypeExists("merge")?ln("This stream already has a sub instance running for this"):void Ft.loadSegmentationAPI().then(function(Jt){Ft.startMergeReality(Jt),Ot.attachToElement(Ft.mergeRealityData.SCREEN_VIDEO),Ft.mergeRealityData.SCREEN_VIDEO.autoplay=!0,Ft.mergeRealityData.MSTP.pipeThrough(Ft.mergeRealityData.MASK_TRANSFORMER).pipeTo(Ft.mergeRealityData.SINK),Ft.mergeRealityData.RES_MS.addTrack(Ft.mergeRealityData.MSTG);var dt,Ct=$o(Ft.data.getAudioTracks());try{for(Ct.s();!(dt=Ct.n()).done;){var Ut=dt.value;Ft.mergeRealityData.RES_MS.addTrack(Ut)}}catch(Qt){Ct.e(Qt)}finally{Ct.f()}var Vt=Ft,zt={audioFilterIsApplied:Ft.audioFilterIsApplied,audioAppliedFilter:Ft.audioAppliedFilter,videoFilterIsApplied:Ft.videoFilterIsApplied,videoAppliedFilter:Ft.videoAppliedFilter,childType:Ft.childType};Ft.createChildStreamFromStream(Ft.mergeRealityData.RES_MS,"merge",zt).then(function(Qt){Vt.addChildren(Qt,"merge"),Qt.applyMuteStatusFromParent(),sn(Qt)}).catch(function(){$n.error("Catch on createChildStreamFromStream mergeReality")})})})}},{key:"unmergeReality",value:function(){this.childrenTypeExists("merge")?(this.stopMergeReality(),this.releaseChildren("merge"),this.removeChildren("merge")):$n.error("No merged instance found for this stream")}},{key:"addPendingPromise",value:function(Ot,Ft,sn){var ln=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5e3;return apiCC.addPendingPromise(Ot,Ft,sn,ln)}},{key:"resolvePendingPromise",value:function(Ot,Ft){apiCC.resolvePendingPromise(Ot,Ft)}},{key:"rejectPendingPromise",value:function(Ot,Ft){apiCC.rejectPendingPromise(Ot,Ft)}},{key:"sendAudioFlowStatusChanged",value:function(){var Ot=this.getAudioFlowStatus();tn.get(this).emit("audioFlowStatusChanged",Ot)}},{key:"sendVideoFlowStatusChanged",value:function(){var Ot=this.getVideoFlowStatus();tn.get(this).emit("videoFlowStatusChanged",Ot)}},{key:"sendFlowStatusChanged",value:function(Ot){var Ft;Ot==="audio"?Ft=this.getAudioFlowStatus():Ot==="video"&&(Ft=this.getVideoFlowStatus()),Ft.type=Ot,tn.get(this).emit("flowStatusChanged",Ft)}},{key:"sendFlowStatusChangedForRemote",value:function(Ot,Ft){Ft.type=Ot,tn.get(this).emit("flowStatusChanged",Ft)}},{key:"sendRemoteAudioFlowStatusChanged",value:function(Ot){tn.get(this).emit("remoteAudioFlowStatusChanged",Ot)}},{key:"sendRemoteVideoFlowStatusChanged",value:function(Ot){tn.get(this).emit("remoteVideoFlowStatusChanged",Ot)}},{key:"emitConstraintsChanged",value:function(Ot){tn.get(this).emit("constraintsChanged",Ot)}}],[{key:"getAvailableEvents",value:function(){return dm}},{key:"createStreamFromUserMedia",value:function(Ot,Ft,sn){var ln=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return $n.debug("createStreamFromUserMedia"),$n.debug("audioInput :",Ot),$n.debug("videoInput :",Ft),$n.debug("constraints :",sn),$n.debug("options :",ln),new Promise(function(Jt,dt){var Ct=Ot!==!1&&(Ot!==null||sn===void 0||sn!==void 0&&sn.hasOwnProperty("audio")),Ut=Ft!==!1&&(Ft!==null||sn===void 0||sn!==void 0&&sn.hasOwnProperty("video")),Vt={type:tt.g.STREAM_TYPE_NO_INPUT,audioInput:Ot,videoInput:Ft},zt="media";Ut?Vt.type=tt.g.STREAM_TYPE_VIDEO:Ct&&(Vt.type=tt.g.STREAM_TYPE_AUDIO),Ct&&!Ut?zt="audio":!Ct&&Ut&&(zt="videoOnly"),Ct&&ln.enhancedAudioActivated===!0&&($n.debug("Enhanced Audio is activated"),apiRTC.browser!=="Chrome"?$n.debug("enhancedAudioActivated option is only available for Chrome"):(sn===void 0&&(sn={}),sn.audio&&ls(sn.audio)==="object"||(sn.audio={}),sn.video===void 0&&(sn.video={}),sn.audio.echoCancellation=!1,sn.audio.autoGainControl=!1,sn.audio.noiseSuppression=!1)),apiRTC.createUserMediaStream({audioSourceId:Ot,videoSourceId:Ft,facingMode:ln.facingMode,gum_config:sn,filters:ln.filters,type:zt,success:function(Qt){$n.debug("[createStreamFromUserMedia] success; userMediaStreamId: "+Qt.userMediaStreamId),Vt.constructor=!0,Vt.userMediaStreamId=Qt.userMediaStreamId,Jt(new Xt(Qt.stream,Vt))},failure:function(Qt,Zt){$n.debug("[createStreamFromUserMedia] failure :",Zt),dt(Zt)}})})}},{key:"createStreamFromMediaStream",value:function(Ot){return $n.debug("createStreamFromMediaStream"),new Promise(function(Ft,sn){var ln={};ln.type=tt.g.STREAM_TYPE_NO_INPUT,Ot.getAudioTracks().length>0&&(ln.type=tt.g.STREAM_TYPE_AUDIO),Ot.getVideoTracks().length>0&&(ln.type=tt.g.STREAM_TYPE_VIDEO),apiRTC.createUserMediaStream({type:"media",stream:Ot,success:function(Jt){$n.debug("[createStreamFromUserMedia] success; userMediaStreamId: "+Jt.userMediaStreamId),ln.constructor=!0,ln.userMediaStreamId=Jt.userMediaStreamId,Ft(new Xt(Jt.stream,ln))},failure:function(Jt,dt){$n.debug("[createStreamFromUserMedia] failure :",dt),sn()}})})}},{key:"createScreensharingStream",value:function(Ot){return new Promise(function(Ft,sn){apiRTC.createUserMediaStream({type:"screenSharing",captureSourceType:Ot,success:function(ln){$n.debug("[createStreamFromUserMedia] success; userMediaStreamId: "+ln.userMediaStreamId);var Jt=new Xt(ln.stream,{constructor:!0,type:tt.g.STREAM_TYPE_VIDEO,userMediaStreamId:ln.userMediaStreamId});Ys.set(Jt,!0),Ft(Jt)},failure:function(ln,Jt){$n.debug("[createStreamFromUserMedia] failure :",Jt),sn(Jt)}})})}},{key:"createDisplayMediaStream",value:function(Ot,Ft){return new Promise(function(sn,ln){apiRTC.createUserMediaStream({type:"screenSharing",captureSourceType:Ot,displayMediaStreamConstraints:Ot,forceExtensionOnChrome:Ft,success:function(Jt){$n.debug("[createStreamFromUserMedia] success; userMediaStreamId: "+Jt.userMediaStreamId);var dt=new Xt(Jt.stream,{constructor:!0,type:tt.g.STREAM_TYPE_VIDEO,userMediaStreamId:Jt.userMediaStreamId});Ys.set(dt,!0),sn(dt)},failure:function(Jt,dt){$n.debug("[createStreamFromUserMedia] failure :",dt),ln(dt)}})})}},{key:"getLocalStreams",value:function(){return yo.values()}},{key:"getStream",value:function(Ot){return Ot!=null&&yo.has(Ot.toString())?yo.get(Ot.toString()):null}}]),Xt}(fn),um=function($t){Ks(Xt,$t);var Lt=Js(Xt);function Xt(Ot,Ft,sn,ln){var Jt;return Gs(this,Xt),(Jt=Lt.call(this,Ot,Ft)).parent=sn,Jt.childType=ln,ln==="noiseReduction"&&(Jt.audioFilterIsApplied=!0,Jt.audioAppliedFilter=ln),ln!=="blur"&&ln!=="backgroundImage"||(Jt.videoFilterIsApplied=!0,Jt.videoAppliedFilter=ln),Jt}return qs(Xt,[{key:"release",value:function(Ot){this.childType!=="blur"&&this.childType!=="backgroundImage"||this.parent.stopSelfieSegmentation(),this.parent.removeChildren(this.childType),this.clonedStream!==void 0&&($n.debug("to be released ..."),this.clonedStream.getAudioTracks().forEach(function(Ft){Ft.stop()}),this.clonedStream.getVideoTracks().forEach(function(Ft){Ft.stop()})),su(Fo(Xt.prototype),"release",this).call(this,Ot)}}]),Xt}(so),Gr=function($t){Ks(Xt,$t);var Lt=Js(Xt);function Xt(Ot,Ft,sn){var ln;return Gs(this,Xt),(ln=Lt.call(this,Ot)).name=ln.constructor.name,ln.appliedVideoProcessorType=Ft,ln.stream=sn,ln}return qs(Xt)}(Hs(Error)),Wo=function($t){Ks(Xt,$t);var Lt=Js(Xt);function Xt(Ot,Ft,sn){var ln;return Gs(this,Xt),(ln=Lt.call(this,Ot)).name=ln.constructor.name,ln.appliedAudioProcessorType=Ft,ln.stream=sn,ln}return qs(Xt)}(Hs(Error));function Xs($t,Lt){var Xt=typeof Symbol<"u"&&$t[Symbol.iterator]||$t["@@iterator"];if(!Xt){if(Array.isArray($t)||(Xt=function(dt,Ct){if(dt){if(typeof dt=="string")return np(dt,Ct);var Ut=Object.prototype.toString.call(dt).slice(8,-1);return Ut==="Object"&&dt.constructor&&(Ut=dt.constructor.name),Ut==="Map"||Ut==="Set"?Array.from(dt):Ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ut)?np(dt,Ct):void 0}}($t))||Lt&&$t&&typeof $t.length=="number"){Xt&&($t=Xt);var Ot=0,Ft=function(){};return{s:Ft,n:function(){return Ot>=$t.length?{done:!0}:{done:!1,value:$t[Ot++]}},e:function(dt){throw dt},f:Ft}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sn,ln=!0,Jt=!1;return{s:function(){Xt=Xt.call($t)},n:function(){var dt=Xt.next();return ln=dt.done,dt},e:function(dt){Jt=!0,sn=dt},f:function(){try{ln||Xt.return==null||Xt.return()}finally{if(Jt)throw sn}}}}function np($t,Lt){(Lt==null||Lt>$t.length)&&(Lt=$t.length);for(var Xt=0,Ot=new Array(Lt);Xt<Lt;Xt++)Ot[Xt]=$t[Xt];return Ot}function rp($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}var fo=mt.Y.get("Session"),pm=wn.get(),_o=new(Go()),du=Ro.get(),uu=uo.get(),hm=Symbol("ENTERPRISE_NOT_LOADED"),pu=Symbol("ENTERPRISE_LOADED"),ip=new WeakMap,ap=new WeakMap,op=new WeakMap,Qs=function(){function $t(Ft,sn,ln){if(function(Jt,dt){if(!(Jt instanceof dt))throw new TypeError("Cannot call a class as a function")}(this,$t),fo.info("Create Enterprise"),!(ln instanceof Br))throw"Cannot create Enterprise without a session";ip.set(this,ln),op.set(this,sn),ap.set(this,Ft),this.status=hm}var Lt,Xt,Ot;return Lt=$t,Xt=[{key:"getSession",value:function(){return ip.get(this)}},{key:"getId",value:function(){return ap.get(this).toString()}},{key:"getApiKey",value:function(){return op.get(this).toString()}},{key:"load",value:function(){var Ft=this;return new Promise(function(sn,ln){_o.getEnterpriseUserList(Ft.getId(),Ft.getSession().getToken()).then(function(Jt){fo.info("Enterprise loaded!",Jt);var dt,Ct=Xs(Jt.users);try{for(Ct.s();!(dt=Ct.n()).done;){var Ut=dt.value;if(Ft.getSession().user.userId.toString()!==Ut.id.toString()){var Vt=du.getOrCreateContact(Ut.id);Vt.profile=Ut,Vt.enterprise=Ft,Vt.userData.get("username")===null&&Vt.userData.setProp("username",Ut.username),Vt.userData.get("photo_url")===null&&Vt.userData.setProp("photo_url",Ut.photo_url)}}}catch(zt){Ct.e(zt)}finally{Ct.f()}Ft.status=pu,sn()}).catch(function(Jt){var dt="load() - Enterprise load error",Ct={error:new Error(dt),code:tt.g.ERROR_OTHER};Jt.hasOwnProperty("code")?Ct.code=Jt.code:Jt.hasOwnProperty("http_code")&&(Jt.http_code.toString().startsWith("4")?Ct.code=tt.g.ERROR_INVALID_CREDENTIALS:Ct.code=tt.g.ERROR_SERVER_UNAVAILABLE),fo.error(dt,Jt),ln(Ct)})})}},{key:"getContacts",value:function(){var Ft={};if(this.status!==pu)fo.error("Enterprise is not loaded, unable to getContacts");else{var sn,ln=du.getContacts(),Jt=Xs(ln.keys());try{for(Jt.s();!(sn=Jt.n()).done;){var dt=sn.value,Ct=ln.get(dt);Ct.enterprise!==null&&Ct.enterprise.id.toString()===this.getId()&&(Ft[Ct.getId()]=Ct)}}catch(Ut){Jt.e(Ut)}finally{Jt.f()}}return Ft}},{key:"getConfiguration",value:function(){return null}},{key:"uploadFile",value:function(Ft){var sn=this,ln=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Jt,dt){fo.info("uploadFile()"),sn.status===pu?_o.uploadFile(Ft,sn.getSession().getToken(),ln).then(function(Ct){Jt(Ct.url)}).catch(function(Ct){fo.error(Ct),dt(Ct)}):(fo.error("Enterprise is not loaded, cannot upload file"),dt(new Error("Enterprise is not loaded, cannot upload file")))})}},{key:"getAvailableConferences",value:function(){var Ft=this;return fo.info("getAvailableConferences()"),new Promise(function(sn,ln){var Jt={};_o.getConferenceList(Ft.getSession().getToken()).then(function(dt){var Ct,Ut=Xs(dt);try{for(Ut.s();!(Ct=Ut.n()).done;){var Vt=Ct.value;Jt[Vt.hash]=uu.getOrCreateConference(Vt.hash),Jt[Vt.hash].friendlyName=Vt.friendlyName}}catch(zt){Ut.e(zt)}finally{Ut.f()}sn(Jt)}).catch(function(dt){fo.error(dt),ln(dt)})})}},{key:"getConference",value:function(Ft){var sn=this;return new Promise(function(ln,Jt){var dt={};dt.token=sn.getSession().getToken(),_o.getWebconf(Ft,dt).then(function(Ct){return ln(uu.getOrCreateConference(Ct.hash))}).catch(function(Ct){return fo.error("getConference",Ct),Jt(Ct)})})}},{key:"createPrivateConference",value:function(){var Ft=this,sn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return fo.info("createPrivateConference()"),new Promise(function(ln,Jt){var dt=sn.hasOwnProperty("friendlyName")?sn.friendlyName:Wt.g.guid(),Ct=null,Ut=Ft.getSession().getToken();_o.createConference(Ut,dt,sn).then(function(Vt){(Ct=uu.getOrCreateConference(Vt.hash)).friendlyName=dt;var zt=sn.hasOwnProperty("password")?sn.password:"";return Ct.join({password:zt,session:Ft.getSession()})}).then(function(){ln(Ct)}).catch(function(Vt){var zt="createPrivateConference() - Could not create conference";fo.error(zt,Vt),Jt(new Error(zt))})})}},{key:"getTags",value:function(Ft){var sn=this;return new Promise(function(ln,Jt){var dt={};Ft&&Ft.hasOwnProperty("webconfId")&&(dt.webconfId=Ft.webconfId),_o.getEnterpriseTagList(sn.getId(),sn.getSession().getToken(),dt).then(function(Ct){return Ct.hasOwnProperty("tags")&&Array.isArray(Ct.tags)?ln(Ct.tags):Jt(Wt.g.createError(tt.g.ERROR_OTHER,"getTags() - unexpected response",fo))}).catch(function(Ct){return Jt(Wt.g.createError(tt.g.ERROR_OTHER,"getTags() - cannot get tags",fo,{fromError:Ct}))})})}}],Ot=[{key:"fetchEnterpriseInformation",value:function(Ft){var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return sn.hasOwnProperty("cloudUrl")&&_o.setCloudURL(sn.cloudUrl),_o.getEnterpriseInformation(sn,Ft)}},{key:"fetchSiteAgents",value:function(Ft){var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(ln,Jt){sn.hasOwnProperty("cloudUrl")&&_o.setCloudURL(sn.cloudUrl);var dt=[];_o.getSiteAgents(pm.getActiveApiKey(),Ft,sn).then(function(Ct){var Ut,Vt=Xs(Ct);try{for(Vt.s();!(Ut=Vt.n()).done;){var zt=Ut.value;dt.push({contact:du.getOrCreateContact(zt.id),title:zt.title,nickname:zt.nickname,isPrefered:zt.isPrefered})}}catch(Qt){Vt.e(Qt)}finally{Vt.f()}ln(dt)}).catch(function(Ct){Jt(Wt.g.createError(tt.g.ERROR_OTHER,"fetchSiteAgents() - could not fetch site agents",fo))})})}}],Xt&&rp(Lt.prototype,Xt),Ot&&rp(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}();function hu($t){return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},hu($t)}function fm($t,Lt){if(!($t instanceof Lt))throw new TypeError("Cannot call a class as a function")}function sp($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}function fu($t,Lt){return fu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Xt,Ot){return Xt.__proto__=Ot,Xt},fu($t,Lt)}function mm($t,Lt){if(Lt&&(hu(Lt)==="object"||typeof Lt=="function"))return Lt;if(Lt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bo($t)}function Bo($t){if($t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $t}function Zs($t){return Zs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Lt){return Lt.__proto__||Object.getPrototypeOf(Lt)},Zs($t)}s(3123);var mr=mt.Y.get("UserAgent"),vr=wn.get(),ko=new(Go()),gm="apizee:",vm="apirtc:",Cm="token:",bm="apzkey:",ym="apiKey:",ps=new WeakMap,Sm=["mediaDeviceChanged","externalJsLoadingStatus","ccsConnectionStatus","userMediaError"],lp=function($t){(function(dt,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Super expression must either be null or a function");dt.prototype=Object.create(Ct&&Ct.prototype,{constructor:{value:dt,writable:!0,configurable:!0}}),Object.defineProperty(dt,"prototype",{writable:!1}),Ct&&fu(dt,Ct)})(Jt,$t);var Lt,Xt,Ot,Ft,sn,ln=(Ft=Jt,sn=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var dt,Ct=Zs(Ft);if(sn){var Ut=Zs(this).constructor;dt=Reflect.construct(Ct,arguments,Ut)}else dt=Ct.apply(this,arguments);return mm(this,dt)});function Jt(){var dt,Ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};fm(this,Jt),dt=ln.call(this,mr),mr.debug("Create UserAgent"),dt.uri=Ct.hasOwnProperty("uri")?Ct.uri:null,dt.userId=null,dt.username=null,dt.profile=null,dt.preRegisterUserData=new Io,dt.callStatsMonitoringEnabled=null,dt.callStatsMonitoringInterval=null,dt.meshModeEnabled=null,dt.apiRTCMediaDeviceDetectionEnabled=!!Ct.hasOwnProperty("apiRTCMediaDeviceDetectionEnabled")&&Ct.apiRTCMediaDeviceDetectionEnabled,dt.apiRTCMediaDeviceDetectionDelay=Ct.hasOwnProperty("apiRTCMediaDeviceDetectionDelay")?Ct.apiRTCMediaDeviceDetectionDelay:tt.g.APIRTC_MEDIA_DEVICE_DETECTION_DELAY,dt.targetBandwidthUsage=0,dt.videoBandwidthSettings={overallIncoming:3e3,overallOutgoing:3e3},dt.currentSession=null,dt.enterprise=null,dt.capabilities={whiteboardCursor:"ON",mediaDeviceChanged:"ON",webRTCCompliant:"ON",screenSharingCompliant:"ON",qoSStatCompliant:"ON",backgroundRemoval:"ON",streamCapabilities:"ON",noiseReduction:"ON",remoteAccessUser:"ON"},dt.browser=apiRTC.browser,dt.browser_major_version=apiRTC.browser_major_version,dt.browser_version=apiRTC.browser_version,dt.osName=apiRTC.osName,dt.osVersion=apiRTC.osVersion,dt.browserInfo=apiRTC.browserInfo,dt.browserDetails=apiRTC.browserDetails,dt.tFLiteModuleLoaded=!1,dt.tFLiteSIMDModule=null,dt.modelLoadedInModule=!1,dt.apiRTCStreamsList=new Map,ps.set(Bo(dt),null),vr.createWhiteBoard(),apiCC.activateScreenSharing();var Ut=function(Zt){tn.get(Bo(dt)).emit("mediaDeviceChanged",{added:Zt.detail.diff.added,removed:Zt.detail.diff.removed,updated:Zt.detail.diff.updated,updateReason:Zt.detail.updateReason,firstMediaDeviceListInitialization:Zt.detail.firstMediaDeviceListInitialization})};apiRTC.addEventListener("mediaDeviceChanged",Ut,"UserAgent");var Vt=function(Zt){tn.get(Bo(dt)).emit("externalJsLoadingStatus",{extjs:Zt.detail.extjs,status:Zt.detail.status})};apiRTC.addEventListener("externalJsLoadingStatus",Vt,"UserAgent");var zt=function(Zt){var on=null;Zt.detail.channelEvent==="onChannelOpened"?on="connected":Zt.detail.channelEvent==="onChannelDisconnect"?on="disconnected":Zt.detail.channelEvent==="onChannelReconnecting"?on="retry":(Zt.detail.channelEvent==="onChannelConnectError"||Zt.detail.channelEvent==="onChannelError")&&(on="error"),on!==null&&tn.get(Bo(dt)).emit("ccsConnectionStatus",{status:on})};apiRTC.addEventListener("channelEvent",zt,"UserAgent");var Qt=function(Zt){var on={error:Zt.detail.error};Zt.detail.callType==="media"?(on.audio=!0,on.video=!0,on.screenSharing=!1):Zt.detail.callType==="audio"?(on.audio=!0,on.video=!1,on.screenSharing=!1):Zt.detail.callType==="videoOnly"?(on.audio=!1,on.video=!0,on.screenSharing=!1):Zt.detail.callType==="screenSharing"?(on.audio=!1,on.video=!0,on.screenSharing=!0):Zt.detail.callType==="screenSharingWithAudio"&&(on.audio=!0,on.video=!0,on.screenSharing=!0),tn.get(Bo(dt)).emit("userMediaError",on)};return apiRTC.addEventListener("userMediaError",Qt,"UserAgent"),dt.checkUACapabilities(),dt.capabilities.mediaDeviceChanged==="OFF"&&(mr.debug("mediaDeviceChanged is not supported"),dt.apiRTCMediaDeviceDetectionEnabled===!0&&(mr.debug("apiRTCMediaDeviceDetectionEnabled is activated, starting process"),setInterval(function(){apiCC.mediaDeviceMgr.getMediaDevices()},dt.apiRTCMediaDeviceDetectionDelay))),apiRTC.userAgentInstance=Bo(dt),dt}return Lt=Jt,Xt=[{key:"fetchUserMediaDevices",value:function(){return mr.warn("DEPRECATION WARNING : fetchUserMediaDevices() is now deprecated, use getUserMediaDevices() instead"),new Promise(function(dt,Ct){apiCC.browser==="IE"&&apiCC.browser_version>8?(apiCC.getMediaDevicesWithCB(apiCC.mediaDeviceMgr.gotSources),dt(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray)):apiCC.getMediaDevices().then(function(Ut){apiCC.mediaDeviceMgr.gotSources(Ut),dt(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray)}).catch(function(){mr.log("Error on MediaDeviceManager::getMediaDevices"),apiCC.mediaDeviceMgr.gotSources(null),Ct(Wt.g.createError(tt.g.ERROR_OTHER,"fetchUserMediaDevices() - Could not get media devices",mr))})})}},{key:"getUserMediaDevices",value:function(){return apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray}},{key:"createStream",value:function(){var dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return mr.info("createStream() with option :",dt),so.createStreamFromUserMedia(dt.audioInputId,dt.videoInputId,dt.constraints,dt)}},{key:"createStreamFromMediaStream",value:function(dt){return mr.info("createStreamFromMediaStream()"),so.createStreamFromMediaStream(dt)}},{key:"fetchNetworkInformation_v2",value:function(dt,Ct){mr.debug("fetchNetworkInformation Version 2 :",dt);var Ut=ko.cloudUrl;dt!=null&&(Ut=dt);var Vt={testServer:Ut,httpPing:{},upload:{},download:{}};return Ct!=null&&Array.isArray(Ct)?(apiRTC.bandwidthRatingThresholds=Ct,mr.debug("New bandwidthRatingThresholds is defined :",apiRTC.bandwidthRatingThresholds)):mr.debug("Using default bandwidthRatingThresholds :",apiRTC.bandwidthRatingThresholds),apiRTC.bandwidthTestServer=Ut,mr.info("Start Network test"),new Promise(function(zt,Qt){apiRTC.testUserPing(function(Zt,on){Zt!==null?Qt(Zt):(Vt.httpPing=on,apiRTC.testUserUpload(25e4,function(bn,Rn){bn!==null?Qt(bn):(Vt.upload.kbps=8*Rn.kBPerSec,Vt.upload.rating=Rn.rating,apiRTC.testUserUploadLoop(5e5,Vt.upload,function(qn,Jn){qn!==null?Qt(qn):(Vt.upload.kbps=8*Jn.kBPerSec,Vt.upload.rating=Jn.rating,apiRTC.testUserDownload(256,function(dr,hr){dr!==null?Qt(dr):(Vt.download.kbps=8*hr.kBPerSec,Vt.download.rating=hr.rating,apiRTC.testUserDownloadLoop(1e3,Vt.download,function(Ar,Xr){Ar!==null?Qt(Ar):(Vt.download.kbps=8*Xr.kBPerSec,Vt.download.rating=Xr.rating,zt(Vt))}))}))}))}))})})}},{key:"fetchNetworkInformation_v1",value:function(dt,Ct){mr.debug("fetchNetworkInformation Version 1 :",dt);var Ut=ko.cloudUrl;dt!=null&&(Ut=dt);var Vt={testServer:Ut,httpPing:{},upload:{},download:{}};return Ct!=null&&Array.isArray(Ct)?(apiRTC.bandwidthRatingThresholds=Ct,mr.debug("New bandwidthRatingThresholds is defined :",apiRTC.bandwidthRatingThresholds)):mr.debug("Using default bandwidthRatingThresholds :",apiRTC.bandwidthRatingThresholds),apiRTC.bandwidthTestServer=Ut,mr.info("Start Network test"),new Promise(function(zt,Qt){apiRTC.testUserPing(function(Zt,on){Zt!==null?Qt(Zt):(Vt.httpPing=on,apiRTC.testUserUpload(25e4,function(bn,Rn){bn!==null?Qt(bn):(Vt.upload.kbps=8*Rn.kBPerSec,Vt.upload.rating=Rn.rating,Vt.upload.kbps>=1e3&&apiRTC.testUserUpload(5e5,function(qn,Jn){qn!==null?Qt(qn):(Vt.upload.kbps=8*Jn.kBPerSec,Vt.upload.rating=Jn.rating)}),apiRTC.testUserDownload(256,function(qn,Jn){qn!==null?Qt(qn):(Vt.download.kbps=8*Jn.kBPerSec,Vt.download.rating=Jn.rating,Vt.download.kbps>=500&&Vt.download.kbps<1500?apiRTC.testUserDownload(500,function(dr,hr){dr!==null?Qt(dr):(Vt.download.kbps=8*hr.kBPerSec,Vt.download.rating=hr.rating,zt(Vt))}):Vt.download.kbps>=1500?apiRTC.testUserDownload(768,function(dr,hr){dr!==null?Qt(dr):(Vt.download.kbps=8*hr.kBPerSec,Vt.download.rating=hr.rating,zt(Vt))}):zt(Vt))}))}))})})}},{key:"fetchNetworkInformation",value:function(dt,Ct){return this.fetchNetworkInformation_v1(dt,Ct)}},{key:"fetchGeolocationInformation",value:function(dt){return dt==null&&(dt={enableHighAccuracy:!1,timeout:1/0,maximumAge:0}),new Promise(function(Ct,Ut){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(Vt){Ct(Vt)},function(Vt){Ut(Vt)},dt)})}},{key:"setUserData",value:function(dt){this.currentSession&&this.currentSession.setUserData(dt)}},{key:"setUsername",value:function(dt){this.currentSession?this.currentSession.setUsername(dt):this.preRegisterUserData.setProp("username",dt)}},{key:"setPhotoUrl",value:function(dt){this.currentSession?this.currentSession.setPhotoUrl(dt):this.preRegisterUserData.setProp("photo_url",dt)}},{key:"getUserData",value:function(){return this.currentSession?this.currentSession.getUserData():this.preRegisterUserData}},{key:"getUsername",value:function(){return this.currentSession?this.currentSession.getUsername():this.preRegisterUserData.get("username")!==null?this.preRegisterUserData.get("username"):this.preRegisterUserData.get("nickname")!==null?this.preRegisterUserData.get("nickname"):this.username}},{key:"getPhotoUrl",value:function(){return this.currentSession?this.currentSession.getPhotoUrl():this.preRegisterUserData.get("photo_url")!==null?this.preRegisterUserData.get("photo_url"):this.preRegisterUserData.get("photoUrl")!==null?this.preRegisterUserData.get("photoUrl"):null}},{key:"fetchProfileInformation",value:function(dt){var Ct=this,Ut=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Promise(function(Vt,zt){var Qt=null;Ct.profile===null||Ut?Ct.userId&&(Qt=vr.getActiveApiKey())!==null?ko.getUserProfile(Qt,Ct.userId,dt).then(function(Zt){Ct.profile=Zt,Vt(Zt)}).catch(zt):zt("fetchProfileInformation() - missing registration"):Vt(Ct.profile)})}},{key:"getEnterprise",value:function(){return ps.get(this)}},{key:"getCurrentSession",value:function(){return this.currentSession}},{key:"getEventCenter",value:function(){return apiRTC.eventCenter}},{key:"startWhiteboard",value:function(dt,Ct){mr.trace("startWhiteboard()"),vr.whiteBoardClient.start(),vr.whiteBoardClient.setCanvas(dt),Ct!=null&&vr.whiteBoardClient.setUserCursorColor(Ct)}},{key:"stopWhiteboard",value:function(){mr.trace("stopWhiteboard()"),vr.whiteBoardClient.stop()}},{key:"getWhiteboardClient",value:function(){return mr.trace("getWhiteboardClient()"),vr.whiteBoardClient}},{key:"register",value:function(){var dt=this,Ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(Ut,Vt){if(mr.info("Register "+dt.uri),Ct.hasOwnProperty("uri")&&(dt.uri=Ct.uri),Ct.hasOwnProperty("cloudUrl")&&ko.setCloudURL(Ct.cloudUrl),Ct.hasOwnProperty("cloudFetchRetries")&&ko.setFetchRetries(Ct.cloudFetchRetries),Ct.hasOwnProperty("cloudFetchRetryDelay")&&ko.setFetchRetryDelay(Ct.cloudFetchRetryDelay),dt.uri!==null)if(dt.currentSession)Vt(Wt.g.createError(tt.g.ERROR_APIRTC_SESSION_ALREADY_ON,"register() - Session already ON",mr));else if(dt.uri.startsWith(Cm))Im(dt,Ct,Ut,Vt);else if(dt.uri.startsWith(gm)||dt.uri.startsWith(vm))Tm(dt,Ct,Ut,Vt);else if(dt.uri.startsWith(bm)||dt.uri.startsWith(ym))Rm(dt,Ct,Ut,Vt);else{var zt=dt.uri.split(":")[0];Vt(Wt.g.createError(tt.g.ERROR_REGISTRATION_URI_INVALID,"register() - prefix invalid used for uri :"+zt,mr))}else Vt(Wt.g.createError(tt.g.ERROR_REGISTRATION_URI_INVALID,"register() - Cannot register UserAgent, no uri was specified",mr))})}},{key:"unregister",value:function(){var dt=this,Ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{invalidateUserToken:!0,unregister:!0};return new Promise(function(Ut,Vt){dt.currentSession!==null?dt.currentSession.disconnect(Ct).then(function(){dt.currentSession=null,ps.set(dt,null),Ut()}).catch(function(zt){Vt(Wt.g.createError(tt.g.ERROR_OTHER,"unregister() - unregistration error",mr))}):Vt(Wt.g.createError(tt.g.ERROR_OTHER,"unregister() - no current session",mr))})}},{key:"isRegistered",value:function(){return this.currentSession!==null}},{key:"getDefaultDevices",value:function(){return{audioInput:apiCC.mediaDeviceMgr.defaultAudioInput,audioOutput:apiCC.mediaDeviceMgr.defaultAudioOuput,videoInput:apiCC.mediaDeviceMgr.defaultVideoInput}}},{key:"enableCallStatsMonitoring",value:function(dt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};["chrome","firefox","safari"].indexOf(apiCC.browserDetails.type)<0?mr.warn("enableCallStatsMonitoring() is only supported on Chrome, Firefox and Safari, support on other browsers will be added soon"):dt===!0?(this.callStatsMonitoringEnabled=!0,Wt.g.isPropertyTypeof(Ct,"interval","number")&&Ct.interval>=1e3&&(this.callStatsMonitoringInterval=Ct.interval),this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.enableCallStatsMonitoring(!0,this.callStatsMonitoringInterval)):(this.callStatsMonitoringEnabled=!1,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.enableCallStatsMonitoring(!1))}},{key:"enableActiveSpeakerDetecting",value:function(dt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};dt===!0?Wt.g.isPropertyTypeof(Ct,"threshold","number")&&Ct.threshold>0?apiRTC.enableActiveSpeakerDetecting(!0,Ct.threshold):apiRTC.enableActiveSpeakerDetecting(!0):apiRTC.enableActiveSpeakerDetecting(!1)}},{key:"enableMeshRoomMode",value:function(dt){dt===!1||dt===!0?(this.meshModeEnabled=dt,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.enableMeshRoomMode(dt)):mr.error("Wrong value",dt)}},{key:"setTargetBandwidthUsage",value:function(dt){typeof dt!="number"&&!isNaN(dt)&&dt>0?(this.targetBandwidthUsage=dt,this.isRegistered&&vr.webRTCClient.setVideoBandwidth(dt)):mr.error("Unvalid target bandwidth usage value",dt)}},{key:"setOverallIncomingVideoBandwidth",value:function(dt){dt>0?(this.videoBandwidthSettings.overallIncoming=dt,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setOverallIncomingVideoBandwidth(dt)):(delete this.videoBandwidthSettings.overallIncoming,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setOverallIncomingVideoBandwidth(0))}},{key:"setOverallOutgoingVideoBandwidth",value:function(dt){dt>0?(this.videoBandwidthSettings.overallOutgoing=dt,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setOverallOutgoingVideoBandwidth(dt)):(delete this.videoBandwidthSettings.overallOutgoing,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setOverallOutgoingVideoBandwidth(0))}},{key:"setPerCallIncomingVideoBandwidth",value:function(dt){dt>0?(this.videoBandwidthSettings.perCallIncoming=dt,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setPerCallIncomingVideoBandwidth(dt)):(delete this.videoBandwidthSettings.perCallIncoming,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setPerCallIncomingVideoBandwidth(0))}},{key:"setPerCallOutgoingVideoBandwidth",value:function(dt){dt>0?(this.videoBandwidthSettings.perCallOutgoing=dt,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setPerCallOutgoingVideoBandwidth(dt)):(delete this.videoBandwidthSettings.perCallOutgoing,this.isRegistered&&vr.webRTCClient&&vr.webRTCClient.setPerCallOutgoingVideoBandwidth(0))}},{key:"updateMediaOnCall",value:function(dt,Ct){vr.webRTCClient.updateMediaDeviceOnCall(dt,Ct)}},{key:"getCapabilities",value:function(){return this.capabilities}},{key:"getBrowser",value:function(){return this.browser}},{key:"getBrowserMajorVersion",value:function(){return this.browser_major_version}},{key:"getBrowserVersion",value:function(){return this.browser_version}},{key:"getOsName",value:function(){return this.osName}},{key:"getOsVersion",value:function(){return this.osVersion}},{key:"getBrowserInfo",value:function(){return this.browserInfo}},{key:"getBrowserDetails",value:function(){return this.browserDetails}},{key:"getCPUArchitecture",value:function(){return this.getUserData().cpuArchitecture}},{key:"getDeviceVendor",value:function(){return this.getUserData().deviceVendor}},{key:"getDeviceModel",value:function(){return this.getUserData().deviceModel}},{key:"getEngineName",value:function(){return this.getUserData().engineName}},{key:"getEngineVersion",value:function(){return this.getUserData().engineVersion}},{key:"checkUACapabilities",value:function(){mr.debug("checkUACapabilities"),apiRTC.osName==="iOS"&&(mr.debug("Deactivating whiteboardCursor for iOS"),this.capabilities.whiteboardCursor="OFF"),apiRTC.osName==="Android"&&apiRTC.browser==="Chrome"&&(mr.debug("mediaDeviceChanged not supported on Chrome/Android"),this.capabilities.mediaDeviceChanged="OFF"),ht.Xh!=="Safari"&&ht.Xh!=="Mobile Safari"||(mr.debug("mediaDeviceChanged not supported on Safari"),this.capabilities.mediaDeviceChanged="OFF"),apiRTC.webRTCCompliant===!1&&(mr.debug("WebRTC not compliant"),this.capabilities.webRTCCompliant="OFF"),apiRTC.screenSharingCompliant===!1&&(mr.debug("screenSharing not compliant"),this.capabilities.screenSharingCompliant="OFF"),apiRTC.qoSStatCompliant===!1&&(mr.debug("qoS Stat not compliant"),this.capabilities.qoSStatCompliant="OFF"),ht.Xh!=="Safari"&&ht.Xh!=="Mobile Safari"||(mr.debug("background removal not compliant"),this.capabilities.backgroundRemoval="ON",mr.debug("noiseReduction not compliant"),this.capabilities.noiseReduction="OFF"),"getCapabilities"in MediaStreamTrack.prototype||(mr.debug("Stream capabilities not compliant"),this.capabilities.streamCapabilities="OFF"),(apiRTC.osName!=="Windows"&&apiRTC.osVersion!=="10"||apiRTC.osName!=="Windows"&&apiRTC.osVersion!=="11")&&(mr.debug("remoteAccessUser not compliant"),this.capabilities.remoteAccessUser="OFF")}},{key:"startPrecallTest",value:function(dt,Ct,Ut,Vt,zt){vr.webRTCClient.startPrecallTest(dt,Ct,Ut,Vt,zt)}},{key:"sendLogToCloud",value:function(dt,Ct,Ut,Vt){apiCC.sendLogToCloud(dt,Ct,Ut,Vt)}},{key:"getStreamWithRoomNameAndCallId",value:function(dt,Ct){mr.debug("getStreamWithRoomNameAndCallId");var Ut="NOT_FOUND";return apiRTC.userAgentInstance.apiRTCStreamsList.forEach(function(Vt){var zt=0;if((zt=Vt.publishedInConversations.get(dt))!==void 0&&zt.toString()===Ct.toString())return mr.debug(" Stream is found"),Ut=Vt;mr.debug(" This is not the stream")}),Ut}},{key:"getStreamWithMediaStreamId",value:function(dt){mr.debug("getStreamWithMediaStreamId");var Ct="NOT_FOUND";return apiRTC.userAgentInstance.apiRTCStreamsList.forEach(function(Ut){if(Ut.data.id===dt.toString())return mr.debug(" Stream is found"),Ct=Ut;mr.debug(" This is not the stream")}),Ct}}],Ot=[{key:"getAvailableEvents",value:function(){return Sm}}],Xt&&sp(Lt.prototype,Xt),Ot&&sp(Lt,Ot),Object.defineProperty(Lt,"prototype",{writable:!1}),Jt}(fn),Tm=function($t,Lt,Xt,Ot){var Ft=$t.uri.split(":");mr.debug("register() - Registration using prefix :"+Ft[0]);var sn=Ft[1];Lt.password!==null&&typeof Lt.password=="string"?ko.authentication(sn,Lt.password,Lt.captcha_token).then(function(ln){return cp($t,ln.token,Lt)}).then(function(ln){Xt(ln)}).catch(function(ln){mr.error("registerPrefixApizee err : ",ln.message);var Jt="register() - An error occured during cloud credentials registration :"+JSON.stringify(ln),dt=ln;dt.message=Jt,ln.hasOwnProperty("code")?dt.code=ln.code:ln.hasOwnProperty("http_code")&&(ln.http_code.toString().startsWith("4")?dt.code=tt.g.ERROR_INVALID_CREDENTIALS:dt.code=tt.g.ERROR_SERVER_UNAVAILABLE),Ot(dt)}):Ot(Wt.g.createError(tt.g.ERROR_INVALID_CREDENTIALS,"register() - No password was specified for apizee: UserAgent registration",mr))},Im=function($t,Lt,Xt,Ot){mr.debug("register() - Registration using prefix :token:");var Ft=$t.uri.split(":")[1];ko.checkUserToken(Ft).then(function(sn){return cp($t,Ft,Lt)}).then(Xt).catch(function(sn){Ot(Wt.g.createError(tt.g.ERROR_OTHER,"register() - An error occured during cloud token registration",mr))})},Rm=function($t,Lt,Xt,Ot){var Ft=$t.uri.split(":");mr.debug("register() - Registration using prefix :"+Ft[0]);var sn=Ft[1];if(!sn||typeof sn!="string")return Ot(Wt.g.createError(tt.g.ERROR_OTHER,"register() - Wrong apiKey",mr));new Promise(function(ln,Jt){ko.getPreferredCCS(sn).then(function(dt){Lt.ccs&&Lt.ccs!==dt.ccs&&(mr.debug("Overloading CCS address with init option"),dt.ccs=Lt.ccs),ln(dt)}).catch(function(){Jt(Wt.g.createError(tt.g.ERROR_OTHER,"register() - Could not get preferred CCS",mr))})}).then(function(ln){$t.currentSession=new Br($t),$t.currentSession.user=$t,$t.currentSession.token=null,Wt.g.isPropertyTypeof(Lt,"nickname","string")?$t.username=Lt.nickname:$t.username="guest-"+Wt.g.guid().substr(0,13),$t.preRegisterUserData.setProp("username",$t.username),$t.preRegisterUserData.setProp("userConfId",$t.username+Date.now()),Lt.userData&&$t.preRegisterUserData.setProps(Lt.userData);var Jt={apiKey:sn,MCUActivated:!0,mcu:Lt.hasOwnProperty("mcu")?Lt.mcu:tt.g.DEFAULT_MCU,nickname:$t.username,ccsServer:ln.ccs,bandwidthTestServer:ko.cloudUrl,webRTCPluginActivated:!0,userData:$t.preRegisterUserData,tryAudioCallAfterUserMediaError:!0,extJsLoadingRetryNb:Lt.extJsLoadingRetryNb,extJsLoadingRetryDelay:Lt.extJsLoadingRetryDelay,ccsConnectionRetryNb:Lt.ccsConnectionRetryNb,ccsConnectionRetryDelay:Lt.ccsConnectionRetryDelay,turnServerAddress:Lt.turnServerAddress,userAcceptOnIncomingDataCall:Lt.userAcceptOnIncomingDataCall,userAcceptOnIncomingScreenSharingCall:Lt.userAcceptOnIncomingScreenSharingCall,cloudIsSecured:ln.secure};return Lt.hasOwnProperty("id")&&(Jt.apiCCId=Lt.id),Wt.g.isPropertyTypeof(Lt,"idPersistenceTimeout","number")&&Lt.idPersistenceTimeout>=0&&(Jt.apiCCIdPersistenceTimeout=Lt.idPersistenceTimeout),Lt.hasOwnProperty("groups")&&(Jt.presenceGroup=Lt.groups),Lt.hasOwnProperty("subscribeTo")&&(Jt.subscribeToPresenceGroup=Lt.subscribeTo),Lt.hasOwnProperty("contactDisconnectionDelay")&&(mr.debug("Setting contactDisconnectionDelay :",Lt.contactDisconnectionDelay),vr.contactDisconnectionDelay=Lt.contactDisconnectionDelay),Jt.idConversionActivated=!1,Lt.hasOwnProperty("idConversionActivated")&&(Jt.idConversionActivated=Lt.idConversionActivated),Lt.hasOwnProperty("conversationSpace")&&(Jt.conversationSpace=Lt.conversationSpace),Lt.hasOwnProperty("token")&&(Jt.token=Lt.token,$t.currentSession.ccsToken=Lt.token),vr.initializeApiRTC(Jt)}).then(function(ln){$t.callStatsMonitoringEnabled!==!1&&$t.callStatsMonitoringEnabled!==!0||vr.webRTCClient.enableCallStatsMonitoring($t.callStatsMonitoringEnabled,$t.callStatsMonitoringInterval),$t.meshModeEnabled!==!1&&$t.meshModeEnabled!==!0||vr.webRTCClient.enableMeshRoomMode($t.meshModeEnabled),$t.targetBandwidthUsage>0&&vr.webRTCClient.setVideoBandwidth($t.targetBandwidthUsage),$t.videoBandwidthSettings.overallIncoming>0&&vr.webRTCClient.setOverallIncomingVideoBandwidth($t.videoBandwidthSettings.overallIncoming),$t.videoBandwidthSettings.overallOutgoing>0&&vr.webRTCClient.setOverallOutgoingVideoBandwidth($t.videoBandwidthSettings.overallOutgoing),$t.videoBandwidthSettings.perCallIncoming>0&&vr.webRTCClient.setPerCallIncomingVideoBandwidth($t.videoBandwidthSettings.perCallIncoming),$t.videoBandwidthSettings.perCallOutgoing>0&&vr.webRTCClient.setPerCallOutgoingVideoBandwidth($t.videoBandwidthSettings.perCallOutgoing),$t.userId=ln,$t.currentSession.init(ln),mr.log("register() - APIRTC init OK",ln),vr.apiRTCSession.userData!==void 0&&vr.apiRTCSession.userData!==null&&($t.currentSession.userData=new Io(vr.apiRTCSession.userData)),Xt($t.currentSession)}).catch(function(ln){Ot(Wt.g.createError(tt.g.ERROR_APIRTC_INITIALISATION_FAILED,"register() - ApiRTC Initialization error : "+ln,mr)),delete $t.currentSession,$t.currentSession=null})},cp=function($t,Lt){var Xt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Ot=null,Ft=null;return mr.debug("initializeCloudUASession :",Xt),new Promise(function(sn,ln){ko.getConnectedUserInformation(Lt).then(function(Jt){if(Ft=Jt,mr.debug("Connected user information : ",Jt),$t.currentSession=new Br($t),$t.currentSession.user=$t,$t.currentSession.token=Jt.token,Xt.hasOwnProperty("idPersistenceTimeout")&&($t.currentSession.idPersistenceTimeout=Xt.idPersistenceTimeout),$t.username=Jt.nickname,$t.preRegisterUserData.setProp("username",$t.username),$t.preRegisterUserData.setProp("nickname",$t.username),$t.preRegisterUserData.setProp("photo_url",Jt.photo_url),Jt.mail&&$t.preRegisterUserData.setProp("mail",Jt.mail),$t.preRegisterUserData.setProp("userConfId",$t.username+Date.now()),Xt.userData&&$t.preRegisterUserData.setProps(Xt.userData),!Xt.hasOwnProperty("overLoadedApiRTCKey")||Xt.overLoadedApiRTCKey===null||Xt.overLoadedApiRTCKey===void 0||Jt.apiKey===Xt.overLoadedApiRTCKey)return $t.userId=Jt.userId,Ot=new Qs(Jt.enterpriseId,Jt.apiKey,$t.currentSession),ps.set($t,Ot),Ot.load();mr.debug("overLoadedApiRTCKey is defined :",Xt.overLoadedApiRTCKey),Ot=new Qs(Jt.enterpriseId,Xt.overLoadedApiRTCKey,$t.currentSession),delete Xt.id,$t.userId=null,ps.set($t,Ot),mr.debug("... no enterprise users data loading")}).then(function(){var Jt={apiKey:Ot.getApiKey(),ccsServer:Xt.ccs||Ft.ccs,MCUActivated:!0,mcu:Xt.hasOwnProperty("mcu")?Xt.mcu:tt.g.DEFAULT_MCU,nickname:$t.username,bandwidthTestServer:ko.cloudUrl,webRTCPluginActivated:!0,apiCCId:Xt.hasOwnProperty("id")?Xt.id:$t.userId,userData:$t.preRegisterUserData,tryAudioCallAfterUserMediaError:!0,presenceGroup:["agent"],subscribeToPresenceGroup:["agent","visitor"],extJsLoadingRetryNb:Xt.extJsLoadingRetryNb,extJsLoadingRetryDelay:Xt.extJsLoadingRetryDelay,ccsConnectionRetryNb:Xt.ccsConnectionRetryNb,ccsConnectionRetryDelay:Xt.ccsConnectionRetryDelay,turnServerAddress:Xt.turnServerAddress,userAcceptOnIncomingDataCall:Xt.userAcceptOnIncomingDataCall,userAcceptOnIncomingScreenSharingCall:Xt.userAcceptOnIncomingScreenSharingCall};return Wt.g.isPropertyTypeof(Xt,"idPersistenceTimeout","number")&&Xt.idPersistenceTimeout>=0&&(Jt.apiCCIdPersistenceTimeout=Xt.idPersistenceTimeout),Xt.hasOwnProperty("groups")&&(Jt.presenceGroup=Xt.groups),Xt.hasOwnProperty("subscribeTo")&&(Jt.subscribeToPresenceGroup=Xt.subscribeTo),Xt.hasOwnProperty("contactDisconnectionDelay")&&(mr.debug("Setting contactDisconnectionDelay :",Xt.contactDisconnectionDelay),vr.contactDisconnectionDelay=Xt.contactDisconnectionDelay),Jt.idConversionActivated=!1,Xt.hasOwnProperty("idConversionActivated")&&(Jt.idConversionActivated=Xt.idConversionActivated),Xt.hasOwnProperty("conversationSpace")&&(Jt.conversationSpace=Xt.conversationSpace),vr.initializeApiRTC(Jt)}).then(function(Jt){$t.callStatsMonitoringEnabled!==!1&&$t.callStatsMonitoringEnabled!==!0||vr.webRTCClient.enableCallStatsMonitoring($t.callStatsMonitoringEnabled,$t.callStatsMonitoringInterval),$t.meshModeEnabled!==!1&&$t.meshModeEnabled!==!0||vr.webRTCClient.enableMeshRoomMode($t.meshModeEnabled),$t.targetBandwidthUsage>0&&vr.webRTCClient.setVideoBandwidth($t.targetBandwidthUsage),$t.videoBandwidthSettings.overallIncoming>0&&vr.webRTCClient.setOverallIncomingVideoBandwidth($t.videoBandwidthSettings.overallIncoming),$t.videoBandwidthSettings.overallOutgoing>0&&vr.webRTCClient.setOverallOutgoingVideoBandwidth($t.videoBandwidthSettings.overallOutgoing),$t.videoBandwidthSettings.perCallIncoming>0&&vr.webRTCClient.setPerCallIncomingVideoBandwidth($t.videoBandwidthSettings.perCallIncoming),$t.videoBandwidthSettings.perCallOutgoing>0&&vr.webRTCClient.setPerCallOutgoingVideoBandwidth($t.videoBandwidthSettings.perCallOutgoing),$t.currentSession.init(Jt),mr.info("APIRTC init OK",Jt),vr.apiRTCSession.userData!==void 0&&vr.apiRTCSession.userData!==null&&($t.currentSession.userData=new Io(vr.apiRTCSession.userData)),sn($t.currentSession)}).catch(function(Jt){mr.error(Jt),ln(Jt)})})};function wm($t,Lt){for(var Xt=0;Xt<Lt.length;Xt++){var Ot=Lt[Xt];Ot.enumerable=Ot.enumerable||!1,Ot.configurable=!0,"value"in Ot&&(Ot.writable=!0),Object.defineProperty($t,Ot.key,Ot)}}var Xo=mt.Y.get("ResourcesLoader"),Em=function(){function $t(){(function(Ot,Ft){if(!(Ot instanceof Ft))throw new TypeError("Cannot call a class as a function")})(this,$t),this.loadedJsLinks=[]}var Lt,Xt;return Lt=$t,Xt=[{key:"loadjs",value:function(Ot){function Ft(sn,ln,Jt){return Ot.apply(this,arguments)}return Ft.toString=function(){return Ot.toString()},Ft}(function(Ot,Ft,sn){var ln=this;Xo.info("Load js resources",Ot),Xo.debug("Already loaded js",this.loadedJsLinks);var Jt=sn.success;if((Ot=Ot.filter(function(dt){return!ln.loadedJsLinks.includes(dt)})).length===0)return Xo.debug("Skip resources loading, all resources previously loaded"),void(Jt instanceof Function&&Jt());Xo.debug("Filtered resources to load",Ot),sn.success=function(){ln.loadedJsLinks.push.apply(ln.loadedJsLinks,Ot),Jt instanceof Function&&Jt()},_e(Ot,Ft,sn)})},{key:"unloadjs",value:function(Ot){var Ft=this;Xo.info("Unload js",Ot),Ot.forEach(function(sn){var ln=document.querySelector('script[src="'+sn+'"]');ln!==void 0&&(ln.remove(),Ft.loadedJsLinks=Ft.loadedJsLinks.filter(function(Jt){return Jt!==sn}))}),Xo.debug("Scripts unloaded, currently loaded js",this.loadedJsLinks)}},{key:"reset",value:function(){unloadjs(this.loadedJsLinks),this.loadedJsLinks=[]}}],Xt&&wm(Lt.prototype,Xt),Object.defineProperty(Lt,"prototype",{writable:!1}),$t}(),Mr=mt.Y.get("Init"),_a=mt.Y.get("MediaDeviceManager");function mu($t){return mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Lt){return typeof Lt}:function(Lt){return Lt&&typeof Symbol=="function"&&Lt.constructor===Symbol&&Lt!==Symbol.prototype?"symbol":typeof Lt},mu($t)}it=s.hmd(it),console!=null&&(typeof apiRTC_React<"u"?console.info&&console.info("Loading APIRTC_REACT_NATIVE_MODULE"):console.info&&console.info("Loading APIRTC_MODULE")),window.Prototype&&delete Array.prototype.toJSON;var dp=new(Go());It.version="5.0.14",It.utils={},It.eventCenter=new Mt,It.resourcesLoader=new Em;for(var gu=0,up=Object.keys(tt.g);gu<up.length;gu++){var pp=up[gu];It[pp]=tt.g[pp]}It.utils.EventEmitter=pt,It.utils.EventCenter=Mt,It.MediaDevice=Ht,It.Stream=so,It.Call=qr,It.Conversation=jo,It.ConversationCall=Kl,It.Conference=Ws,It.Contact=No,It.Enterprise=Qs,It.SentInvitation=Do,It.ReceivedInvitation=kn,It.ReceivedCallInvitation=Ir,It.ReceivedConversationJoinRequest=Ho,It.ReceivedConversationInvitation=jt,It.ReceivedFileTransferInvitation=eo,It.ReceivedWhiteboardInvitation=Cs,It.ReceivedDataChannelInvitation=zo,It.ReceivedPointerSharingInvitation=_l,It.PointerSharingRoom=iu,It.Session=Br,It.UserAgent=lp,It.UserData=Io,It.CloudApi=dp,It.DataChannel=Ss,It.Observable=fn,It.setLogLevel=function($t){mt.Y.setLogLevel($t)};var hp=!1;window.apiRTC===void 0?(mu(it)==="object"&&it.exports&&(it.exports=It),window.apiRTC2=window.apiRTC=window.apiCC=window.CC=It,hp=!0):console.info("APIRTC_MODULE already loaded with version :",apiRTC.version),s(4170),hp===!0&&(It.init=function($t){var Lt,Xt;if(Mr.info("apiRTC initialization, version is :"+apiCC.version),Mr.info("osName :"+apiCC.osName),Mr.info("osVersion :"+apiCC.osVersion),Mr.info("browser :"+apiCC.browser),Mr.info("browser_version :"+apiCC.browser_version),Lt=$t.apiKey,Xt=!0,Mr.info("apiKey :",Lt),Lt.indexOf("[")!==-1&&(Xt=!1),Xt===!0)if($t.hasOwnProperty("apiCCId")&&$t.apiCCId!==null&&$t.apiCCId!==""&&function(ln){if(ln!==null){var Jt=ln;if(typeof Jt=="number"&&(Jt=String(Jt)),typeof Jt=="string")return Jt.length<=128}return!1}($t.apiCCId)!==!0)Mr.error("apiCCId format is not correct, leaving connection process");else{var Ot="";if(Ot=window!==void 0&&window.location!==void 0&&window.location.protocol!==void 0&&window.location.protocol!="https:"?"http":"https",ht.ag.name!=="iOS"&&ht.ag.name!=="Android"||(Mr.log(ht.ag.name+" detected forcing protocol to https"),Ot="https"),$t.ccsServer===void 0?(Mr.debug("Setting ccsServer"),window!==void 0&&window.location!==void 0&&window.location.protocol!==void 0?window.location.protocol=="https:"||ht.ag.name==="iOS"||ht.ag.name==="Android"?$t.ccsServer="ccs5.apizee.com:443":$t.ccsServer="ccs5.apizee.com:80":$t.ccsServer="ccs5.apizee.com:443"):Mr.log("ccsServer is defined on init()"),$t.bandwidthTestServer!==null&&$t.bandwidthTestServer!==void 0?(Mr.log("bandwidthTestServer is defined :",$t.bandwidthTestServer),apiCC.bandwidthTestServer=$t.bandwidthTestServer):Mr.log("bandwidthTestServer is not defined"),$t.userData!==void 0&&Mr.log("userData :",$t.userData),apiCC.extJsLoadingRetryNb=$t.extJsLoadingRetryNb,apiCC.extJsLoadingRetryDelay=$t.extJsLoadingRetryDelay,apiCC.jsLoaded===!1){apiCC.initApiKey=$t.apiKey,apiCC.initApiCCId=$t.apiCCId;var Ft=function(){Mr.log("sio loaded"),apiCC.jsLoaded=!0,apiCC.session=new apiCC.ApiCCSession($t),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("sio","loaded")},sn={success:Ft,error:function(){Mr.error("sio loading error"),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("sio","error")},retrycb:function(){Mr.warn("sio retry"),apiCC.myWebRTC_Event.createExternalJsLoadingStatusEvent("sio","retry")}};apiCC.sioEmbedded?(window.rtcio=io,Ft()):apiRTC_sioLoader.load(Ot,$t,sn)}else Mr.log("apiRTC JS Librairies already loaded"),Mr.log("initParameters have changed, need to reload session connection"),apiCC.addEventListener("sessionReady",$t.onReady),Mr.log("initParameters.userData :",$t.userData),$t.apiCCId!==void 0&&$t.apiCCId!==""&&$t.apiCCId!==null||(Mr.log("keeping apiCCId defined by apiRTC :"+$t.apiCCId),$t.apiCCId=apiCC.session.apiCCId),Mr.log("initParameters.apiCCId :"+$t.apiCCId),$t.userData!==null&&$t.userData!==void 0?(Mr.log("userData is defined :",$t.userData),apiCC.session.userData=$t.userData):Mr.log("userData is not defined"),Mr.log("apiCC.session.userData :",apiCC.session.userData),$t.token!==null&&$t.token!==void 0?(Mr.log("token is defined :"+$t.token),apiCC.session.token=$t.token):(Mr.log("token is not defined"),apiCC.session.token=null),$t.conversationSpace!==null&&$t.conversationSpace!==void 0?(Mr.log("conversationSpace is defined :"+$t.conversationSpace),apiCC.session.conversationSpace=$t.conversationSpace):(Mr.log("conversationSpace is not defined"),apiCC.session.conversationSpace=null),apiCC.session.reOpenChannel($t.apiCCId,$t.apiKey),$t.nickname!==null&&$t.nickname!==void 0?(Mr.log("Nickname is defined :"+$t.nickname),apiCC.session.nickname=$t.nickname):(Mr.log("Nickname is not defined, setting to apiCCId value :"+apiCC.session.apiCCId),apiCC.session.nickname=apiCC.session.apiCCId),$t.photoURL!==null&&$t.photoURL!==void 0?(Mr.log("photoURL is defined :"+$t.photoURL),apiCC.session.photoURL=$t.photoURL):(Mr.log("photoURL is not defined"),apiCC.session.photoURL=null),$t.presenceGroup!==null&&$t.presenceGroup!==void 0?(Mr.log("presenceGroup is defined :"+$t.presenceGroup),JSON.stringify(apiCC.session.presenceGroup)!==JSON.stringify($t.presenceGroup)&&(Mr.log("presenceGroup updated on initParameters"),apiCC.session.channel.updatePresenceGroupIsNeeded=!0,apiCC.session.channel.oldPresenceGroup===null&&(apiCC.session.channel.oldPresenceGroup=apiCC.session.presenceGroup),apiCC.session.channel.newPresenceGroup=$t.presenceGroup,apiCC.session.presenceGroup=$t.presenceGroup)):(Mr.log('presenceGroup is not defined, setting to ["default"]'),JSON.stringify(apiCC.session.presenceGroup)!==JSON.stringify(["default"])&&(Mr.log("presenceGroup updated on initParameters"),apiCC.session.channel.updatePresenceGroupIsNeeded=!0,apiCC.session.channel.oldPresenceGroup===null&&(apiCC.session.channel.oldPresenceGroup=apiCC.session.presenceGroup),apiCC.session.channel.newPresenceGroup=["default"],apiCC.session.presenceGroup=["default"])),$t.subscribeToPresenceGroup!==null&&$t.subscribeToPresenceGroup!==void 0?(Mr.log("subscribeToPresenceGroup is defined :"+$t.subscribeToPresenceGroup),JSON.stringify(apiCC.session.subscribeToPresenceGroup)!==JSON.stringify($t.subscribeToPresenceGroup)&&(Mr.log("subscribeToPresenceGroup updated on initParameters"),apiCC.session.channel.updateSubscribeToPresenceGroupIsNeeded=!0,apiCC.session.channel.oldSubscribeToPresenceGroup===null&&(apiCC.session.channel.oldSubscribeToPresenceGroup=apiCC.session.subscribeToPresenceGroup),apiCC.session.channel.newSubscribeToPresenceGroup=$t.subscribeToPresenceGroup,apiCC.session.subscribeToPresenceGroup=$t.subscribeToPresenceGroup)):(Mr.log('subscribeToPresenceGroup is not defined, setting to ["default"]'),JSON.stringify(apiCC.session.subscribeToPresenceGroup)!==JSON.stringify(["default"])&&(Mr.log("subscribeToPresenceGroup updated on initParameters"),apiCC.session.channel.updateSubscribeToPresenceGroupIsNeeded=!0,apiCC.session.channel.oldSubscribeToPresenceGroup===null&&(apiCC.session.channel.oldSubscribeToPresenceGroup=apiCC.session.subscribeToPresenceGroup),apiCC.session.channel.newSubscribeToPresenceGroup=["default"],apiCC.session.subscribeToPresenceGroup=["default"])),apiCC.initApiKey=$t.apiKey,apiCC.initApiCCId=$t.apiCCId}else Mr.error("Apikey format is not correct, leaving connection process")},s(8560),It.mediaDeviceMgr=new function(){this.audioDevicePresent=!0,this.videoDevicePresent=!0,this.audioOutputPresent=!0,this.mediaSourceInfos=null,this.mediaDeviceChangedDetected=!1,this.mediaDeviceSourceInfosArray={audioinput:{},audiooutput:{},videoinput:{}},this.mediaDeviceSourceInfosArrayBeforeGotSources=null,this.defaultVideoInput=null,this.defaultAudioInput=null,this.defaultAudioOuput=null,this.realMediaDevicesListInitialization=!1,this.realMediaDevicesListInitializationWasAlreadyDone=!1,_a.debug("MediaDeviceManager"),navigator.mediaDevices!==null&&navigator.mediaDevices!==void 0&&(navigator.mediaDevices.ondevicechange=function($t){_a.debug("Media device have changed"),apiCC.mediaDeviceMgr.getMediaDevices("updatedOnDeviceChange")}),this.gotSources=function($t,Lt){_a.debug("gotSources : sourceInfos :",$t),apiCC.mediaDeviceMgr.audioDevicePresent=!1,apiCC.mediaDeviceMgr.videoDevicePresent=!1,apiCC.mediaDeviceMgr.audioOutputPresent=!1;var Xt=!1;apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArrayBeforeGotSources=apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray;var Ot={},Ft=!1;(0,St.fS)(apiCC.mediaDeviceMgr.mediaSourceInfos,$t)||(_a.debug("MediaDevices change detected"),Xt=!0);var sn,ln=null,Jt=0,dt=0,Ct=0,Ut=null;if(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray={audioinput:{},audiooutput:{},videoinput:{}},apiCC.mediaDeviceMgr.mediaSourceInfos=$t,$t!==null)for(sn=0;sn!==$t.length;++sn)(ln=$t[sn]).deviceId!==null&&ln.deviceId!==""?(Ut=new Ht(ln.deviceId,ln.kind),ln.label!==null&&ln.label!==void 0&&(this.realMediaDevicesListInitialization=!0)):(_a.debug("MediaDevices change but deviceId is not correct, using fakedeviceId :",sn),Ut=new Ht(sn,ln.kind)),ln.kind==="audio"||ln.kind==="audioinput"?(apiCC.mediaDeviceMgr.audioDevicePresent||(apiCC.mediaDeviceMgr.audioDevicePresent=!0),Ut.label=ln.label||"microphone "+ ++Jt,apiCC.mediaDeviceMgr.defaultAudioInput===null&&(apiCC.mediaDeviceMgr.defaultAudioInput=Ut),ln.getCapabilities!==null&&ln.getCapabilities!==void 0?Ut.capabilities=ln.getCapabilities():_a.debug("getCapabilities not defined")):ln.kind==="video"||ln.kind==="videoinput"?(apiCC.mediaDeviceMgr.videoDevicePresent||(apiCC.mediaDeviceMgr.videoDevicePresent=!0),Ut.label=ln.label||"camera "+ ++dt,apiCC.mediaDeviceMgr.defaultVideoInput===null&&(apiCC.mediaDeviceMgr.defaultVideoInput=Ut),ln.getCapabilities!==null&&ln.getCapabilities!==void 0?Ut.capabilities=ln.getCapabilities():_a.debug("getCapabilities not defined")):ln.kind==="audiooutput"?(apiCC.mediaDeviceMgr.audioOutputPresent||(apiCC.mediaDeviceMgr.audioOutputPresent=!0),Ut.label=ln.label||"audio output "+ ++Ct,apiCC.mediaDeviceMgr.defaultAudioOuput===null&&(apiCC.mediaDeviceMgr.defaultAudioOuput=Ut)):(Ut.label=ln.label||"other source "+ln.deviceId,_a.trace("Detected some other kind of source : "+ln.kind)),_a.trace("Local device : "+Ut.label+" - "+Ut.id),apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray[Ut.type]===void 0&&(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray[Ut.type]={}),apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray[Ut.type][Ut.id]=Ut;else _a.warn("Media detection is not supported by browser, considering micro and camera present"),apiCC.mediaDeviceMgr.audioDevicePresent=!0,apiCC.mediaDeviceMgr.videoDevicePresent=!0,apiCC.mediaDeviceMgr.audioOutputPresent=!0;if(_a.log("Audio device detected :"+apiCC.mediaDeviceMgr.audioDevicePresent),_a.log("Video device detected :"+apiCC.mediaDeviceMgr.videoDevicePresent),_a.log("audio Output device detected :"+apiCC.mediaDeviceMgr.audioOutputPresent),_a.debug("mediaDeviceSourceInfosArray :",apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray),apiCC.mediaDeviceMgr.audioDevicePresent===!1?apiCC.mediaDeviceMgr.videoDevicePresent===!1?apiCC.myWebRTC_Event.createErrorEvent("Video device is not present","NO_AUDIO_NO_VIDEO_DEVICE"):apiCC.myWebRTC_Event.createErrorEvent("Audio device is not present","NO_AUDIO_DEVICE"):apiCC.mediaDeviceMgr.videoDevicePresent===!1&&apiCC.myWebRTC_Event.createErrorEvent("Video device is not present","NO_VIDEO_DEVICE"),(0,St.fS)(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray,apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArrayBeforeGotSources)||(_a.debug("mediaDeviceSourceInfosArray change detected"),Xt=!0),Xt===!0){_a.debug("fireMediaChangedEvent :",Xt);var Vt=this.getMediaDeviceListsDiff(apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArray,apiCC.mediaDeviceMgr.mediaDeviceSourceInfosArrayBeforeGotSources);this.realMediaDevicesListInitialization===!0&&this.realMediaDevicesListInitializationWasAlreadyDone===!1&&(_a.debug("This is the first real initialization of media device list"),Ft=!0),this.realMediaDevicesListInitialization===!0&&(this.realMediaDevicesListInitializationWasAlreadyDone=!0),this.mediaDeviceChangedDetected=!0,apiCC.myWebRTC_Event!==null&&apiCC.myWebRTC_Event.createMediaDeviceChangedEvent(Vt,Lt,Ft),_a.debug("fireMediaChangedEvent :",apiCC.mediaDeviceMgr.mediaSourceInfos)}apiCC.session&&apiCC.session.apiCCWebRTCClient&&(apiCC.session.apiCCWebRTCClient.webRTCClient.setGumConfigWithDevicePresent(),Ot.audioDevicePresent=apiCC.mediaDeviceMgr.audioDevicePresent,Ot.videoDevicePresent=apiCC.mediaDeviceMgr.videoDevicePresent,apiCC.session.setUserData(Ot))},this.getMediaDevices=function($t){_a.debug("MediaDeviceManager::getMediaDevices : updateReason :",$t),apiCC.browser==="IE"&&apiCC.browser_version>8?apiCC.getMediaDevicesWithCB(apiCC.mediaDeviceMgr.gotSources):apiCC.getMediaDevices().then(function(Lt){apiCC.mediaDeviceMgr.gotSources(Lt,$t)}).catch(function(){_a.log("Error on MediaDeviceManager::getMediaDevices"),apiCC.mediaDeviceMgr.gotSources(null,$t)})},this.getMediaDeviceListsDiff=function($t,Lt){Lt!==void 0&&Lt||(Lt={}),$t!==void 0&&$t||($t={});for(var Xt=[],Ot=[],Ft=[],sn=0,ln=Object.keys(Lt);sn<ln.length;sn++){var Jt=ln[sn];if($t[Jt]===void 0)Ot[Jt]=Lt[Jt];else for(var dt=0,Ct=Object.keys(Lt[Jt]);dt<Ct.length;dt++){var Ut=Ct[dt];$t[Jt][Ut]===void 0&&(Ot[Jt]===void 0&&(Ot[Jt]={}),Ot[Jt][Ut]=Lt[Jt][Ut])}}for(var Vt=0,zt=Object.keys($t);Vt<zt.length;Vt++)for(var Qt=zt[Vt],Zt=0,on=Object.keys($t[Qt]);Zt<on.length;Zt++){var bn=on[Zt];Lt[Qt]!==void 0&&Lt[Qt][bn]!==void 0||(Xt[Qt]===void 0&&(Xt[Qt]={}),Xt[Qt][bn]=$t[Qt][bn]),Lt[Qt]!==void 0&&Lt[Qt][bn]!==void 0&&$t[Qt][bn].label!==Lt[Qt][bn].label&&(Ft[Qt]===void 0&&(Ft[Qt]={}),Ft[Qt][bn]=$t[Qt][bn])}return{added:Object.keys(Xt).length>0?Xt:null,removed:Object.keys(Ot).length>0?Ot:null,updated:Object.keys(Ft).length>0?Ft:null}}},It.mediaDeviceMgr.getMediaDevices(),It.webRTCCompliant=It.isWebRTCCompliant(),It.qoSStatCompliant=It.isQoSStatCompliant(),It.screenSharingCompliant=It.isScreenSharingCompliant());const km=apiRTC},1549:(it,ut,s)=>{s.d(ut,{Y:()=>ft}),s(6992),s(1532),s(1539),s(8783),s(3948),s(2772),s(4916),s(5306),s(2222),s(5268),s(3710),s(3161),s(9653),s(9070),s(9753),s(2526),s(1817),s(2165),s(1038),s(7042),s(8309);var tt=s(3173);function ot(at){return function(ht){if(Array.isArray(ht))return ct(ht)}(at)||function(ht){if(typeof Symbol<"u"&&ht[Symbol.iterator]!=null||ht["@@iterator"]!=null)return Array.from(ht)}(at)||function(ht,mt){if(ht){if(typeof ht=="string")return ct(ht,mt);var St=Object.prototype.toString.call(ht).slice(8,-1);return St==="Object"&&ht.constructor&&(St=ht.constructor.name),St==="Map"||St==="Set"?Array.from(ht):St==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(St)?ct(ht,mt):void 0}}(at)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ct(at,ht){(ht==null||ht>at.length)&&(ht=at.length);for(var mt=0,St=new Array(ht);mt<ht;mt++)St[mt]=at[mt];return St}function yt(at,ht){for(var mt=0;mt<ht.length;mt++){var St=ht[mt];St.enumerable=St.enumerable||!1,St.configurable=!0,"value"in St&&(St.writable=!0),Object.defineProperty(at,St.key,St)}}var pt=new Map,gt=tt.g.LOG_LEVEL_WARN,st=function(at){var ht,mt=null,St=null;for(ht=0;ht<at.length;ht++)typeof at[ht]=="string"&&(at[ht].indexOf('"type":"invite"')!==-1?at[ht].indexOf("candidate")===-1?at[ht].indexOf("S->C:")===-1?at[ht]="invite C->S: without candidate":at[ht]="invite S->C: without candidate":at[ht].indexOf("S->C:")===-1?at[ht]="invite C->S: with candidate":at[ht]="invite S->C: with candidate":at[ht].indexOf('"type":"200OK"')!==-1?at[ht].indexOf("candidate")===-1?at[ht].indexOf("S->C:")===-1?at[ht]="200OK C->S: without candidate":at[ht]="200OK S->C: without candidate":at[ht].indexOf("S->C:")===-1?at[ht]="200OK C->S: with candidate":at[ht]="200OK S->C: with candidate":at[ht].indexOf('"type":"candidate"')!==-1&&(at[ht].indexOf("S->C:")===-1?(mt=at[ht].replace(/C->S: /g,""),St=JSON.parse(mt),at[ht]="candidate C->S:"+St.candidate):(mt=at[ht].replace(/onChannelMessage S->C: /g,""),St=JSON.parse(mt),at[ht]="candidate S->C:"+St.candidate)));return at},ft=function(){function at(It){if(function(xt,At){if(!(xt instanceof At))throw new TypeError("Cannot call a class as a function")}(this,at),pt.has(It))throw new Error("Cannot construct singleton Logger");this.category=It,pt.set(It,this)}var ht,mt,St;return ht=at,mt=[{key:"trace",value:function(){for(var It=arguments.length,xt=new Array(It),At=0;At<It;At++)xt[At]=arguments[At];this.logMessage.apply(this,[tt.g.LOG_LEVEL_TRACE].concat(xt))}},{key:"log",value:function(){for(var It=arguments.length,xt=new Array(It),At=0;At<It;At++)xt[At]=arguments[At];this.logMessage.apply(this,[tt.g.LOG_LEVEL_DEBUG].concat(xt))}},{key:"debug",value:function(){for(var It=arguments.length,xt=new Array(It),At=0;At<It;At++)xt[At]=arguments[At];this.logMessage.apply(this,[tt.g.LOG_LEVEL_DEBUG].concat(xt))}},{key:"info",value:function(){for(var It=arguments.length,xt=new Array(It),At=0;At<It;At++)xt[At]=arguments[At];this.logMessage.apply(this,[tt.g.LOG_LEVEL_INFO].concat(xt))}},{key:"warn",value:function(){for(var It=arguments.length,xt=new Array(It),At=0;At<It;At++)xt[At]=arguments[At];this.logMessage.apply(this,[tt.g.LOG_LEVEL_WARN].concat(xt))}},{key:"error",value:function(){for(var It=arguments.length,xt=new Array(It),At=0;At<It;At++)xt[At]=arguments[At];this.logMessage.apply(this,[tt.g.LOG_LEVEL_ERROR].concat(xt))}},{key:"logMessage",value:function(It){for(var xt=arguments.length,At=new Array(xt>1?xt-1:0),Nt=1;Nt<xt;Nt++)At[Nt-1]=arguments[Nt];if(console!=null){if(It<=gt){var kt="[".concat(new Date().toISOString(),"]");switch(It in tt.g.LOG_LEVEL_LABELS&&(kt+="[".concat(tt.g.LOG_LEVEL_LABELS[It],"]")),kt+=tt.g.LOG_PREFIX+"(".concat(this.category,")"),It){case tt.g.LOG_LEVEL_ERROR:var Mt;console.error&&(Mt=console).error.apply(Mt,[kt].concat(ot(At)));break;case tt.g.LOG_LEVEL_WARN:var bt;console.warn&&(bt=console).warn.apply(bt,[kt].concat(ot(At)));break;case tt.g.LOG_LEVEL_INFO:var Bt;console.info&&(Bt=console).info.apply(Bt,[kt].concat(ot(At)));break;default:var Ht;console.log&&(Ht=console).log.apply(Ht,[kt].concat(ot(At)))}}typeof apiCC<"u"&&apiCC.logStorageActivated&&It<=apiCC.logStorageLevel&&(At=st(At),apiCC.logStorage.push(JSON.stringify({name:"log",args:{0:"(".concat(this.category,")")+":"+At}})))}}}],St=[{key:"get",value:function(It){return pt.has(It)?pt.get(It):new at(It)}},{key:"setLogLevel",value:function(It){if(!Number.isInteger(It)||It<0)throw"Log level invalid";gt=It}},{key:"getLogLevel",value:function(){return gt}}],mt&&yt(ht.prototype,mt),St&&yt(ht,St),Object.defineProperty(ht,"prototype",{writable:!1}),at}()},3173:(it,ut,s)=>{s.d(ut,{g:()=>tt}),s(2526),s(1817),s(1539);var tt={LOG_PREFIX:"apiRTC",LOG_LEVEL_OFF:0,LOG_LEVEL_ERROR:1,LOG_LEVEL_WARN:2,LOG_LEVEL_INFO:3,LOG_LEVEL_DEBUG:4,LOG_LEVEL_TRACE:5,LOG_LEVEL_LABELS:{}};tt.LOG_LEVEL_LABELS[tt.LOG_LEVEL_ERROR]="ERROR",tt.LOG_LEVEL_LABELS[tt.LOG_LEVEL_WARN]="WARN",tt.LOG_LEVEL_LABELS[tt.LOG_LEVEL_INFO]="INFO",tt.LOG_LEVEL_LABELS[tt.LOG_LEVEL_DEBUG]="DEBUG",tt.LOG_LEVEL_LABELS[tt.LOG_LEVEL_TRACE]="TRACE",tt.ERROR_OTHER=0,tt.ERROR_INVALID_CREDENTIALS=1,tt.ERROR_NETWORK_UNAVAILABLE=2,tt.ERROR_SERVER_UNAVAILABLE=3,tt.ERROR_UNAUTHORIZED=4,tt.ERROR_APIRTC_INITIALISATION_FAILED=5,tt.ERROR_APIRTC_SESSION_ALREADY_ON=6,tt.ERROR_REGISTRATION_URI_INVALID=7,tt.ERROR_NOT_FOUND=8,tt.ERROR_BAD_PARAMETER=9,tt.ERROR_INVITATION_STATE_INVALID=10,tt.ERROR_TIMED_OUT=11,tt.ERROR_STREAM_RECORD=12,tt.ERROR_HTTP=13,tt.ERROR_NOT_ALLOWED=14,tt.ERROR_OPERATION_CANCELED=15,tt.ERROR_WRONG_STATE=16,tt.MEDIA_TYPE_PHOTO=0,tt.MEDIA_TYPE_VIDEO=1,tt.MEDIA_TYPE_AUDIO=2,tt.MEDIA_TYPE_DOC=3,tt.CONTACT_SEND_DATA_IDENTIFIER="contact_data",tt.CONTACT_NEW_MEDIA_IDENTIFIER="contact_new_media",tt.CONTACT_SEND_FILEINFO_IDENTIFIER="contact_file_info",tt.CONTACT_DATACHANNEL_INVITATION="contact_datachannel_invitation",tt.CONTACT_EVENTCENTER_DATA_REQUEST="contact_event_center_data_request",tt.CONTACT_EVENTCENTER_DATA_ANSWER="contact_event_center_data_answer",tt.CONTACT_GET_CAPABILITIES_IDENTIFIER="contact_get_capabilities",tt.CONTACT_GET_CAPABILITIES_RESULT_IDENTIFIER="contact_get_capabilities_result",tt.CONTACT_GET_SETTINGS_IDENTIFIER="contact_get_settings",tt.CONTACT_GET_SETTINGS_RESULT_IDENTIFIER="contact_get_settings_result",tt.CONTACT_GET_CONSTRAINTS_IDENTIFIER="contact_get_constraints",tt.CONTACT_GET_CONSTRAINTS_RESULT_IDENTIFIER="contact_get_constraints_result",tt.CONTACT_CHANGED_CONSTRAINTS_IDENTIFIER="contact_changed_constraints",tt.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_IDENTIFIER="contact_get_remote_audio_flow_status",tt.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_IDENTIFIER="contact_get_remote_video_flow_status",tt.CONTACT_GET_REMOTE_AUDIO_FLOW_STATUS_RESULT_IDENTIFIER="contact_get_remote_audio_flow_status_result",tt.CONTACT_GET_REMOTE_VIDEO_FLOW_STATUS_RESULT_IDENTIFIER="contact_get_remote_video_flow_status_result",tt.CONTACT_GET_REMOTE_ERROR="contact_get_remote_error",tt.CONTACT_APPLY_CONSTRAINTS_IDENTIFIER="contact_apply_constraints_identifier",tt.CONTACT_APPLY_CONSTRAINTS_RESULT_IDENTIFIER="contact_apply_constraints_result_identifier",tt.CONTACT_DISABLE_AUDIO_REQUEST="contact_disable_audio_request",tt.CONTACT_DISABLE_AUDIO_ANSWER="contact_disable_audio_answer",tt.CONTACT_ENABLE_AUDIO_REQUEST="contact_enable_audio_request",tt.CONTACT_ENABLE_AUDIO_ANSWER="contact_enable_audio_answer",tt.CONTACT_DISABLE_VIDEO_REQUEST="contact_disable_video_request",tt.CONTACT_DISABLE_VIDEO_ANSWER="contact_disable_video_answer",tt.CONTACT_ENABLE_VIDEO_REQUEST="contact_enable_video_request",tt.CONTACT_ENABLE_VIDEO_ANSWER="contact_enable_video_answer",tt.CONTACT_REMOTEACCESS_INVITATION_IDENTIFIER="contact_remote_access_invite",tt.CONTACT_REMOTEACCESS_ANSWER_IDENTIFIER="contact_remote_access_answer",tt.CONTACT_REMOTEACCESS_STOP_IDENTIFIER="contact_remote_access_stop",tt.CONTACT_REMOTEACCESS_APP_STATUS_MESSAGE="contact_remote_access_app_status_message",tt.CONTACT_REMOTEACCESS_APP_MESSAGE="contact_remote_access_app_message",tt.CONVERSATION_ACCESS_GRANTED="GRANTED",tt.CONVERSATION_NEED_MODERATOR_ACCEPTATION="NEED_MODERATOR_ACCEPTATION",tt.CONVERSATION_ROLE_MODERATOR="moderator",tt.CONVERSATION_ROLE_CONTRIBUTOR="contributor",tt.CONVERSATION_ROLE_GUEST="guest",tt.CONVERSATION_WAITING_ROOM_PREFIX="waiting-room-",tt.CONVERSATION_SEND_DATA_IDENTIFIER="conv_data",tt.CONVERSATION_PERSISTENT_DATA_UPDATE_IDENTIFIER="conv_persistent_data_update",tt.CONVERSATION_JOIN_REQUEST_IDENTIFIER="conv_join_req",tt.CONVERSATION_JOIN_ANSWER_IDENTIFIER="conv_join_ans",tt.CONVERSATION_MODERATOR_CONNECTED_IDENTIFIER="conv_moderator_connected",tt.CONVERSATION_NEW_MEDIA_IDENTIFIER="conv_new_media",tt.CONVERSATION_CLOSED_IDENTIFIER="conv_closed",tt.CONVERSATION_INVITATION_IDENTIFIER="conv_invite",tt.INVITATION_ANSWER_IDENTIFIER="invite_ans",tt.RECORD_BASE_URL="https://data2.apizee.com:10000/videoManager",tt.RECORD_PLAY_URL=tt.RECORD_BASE_URL+"?action=play&recordedFileName=",tt.DEFAULT_MCU="mcu4.apizee.com",tt.DEFAULT_TURNADDRESS="mp1.apizee.com",tt.CALL_STATUS_WAITING_FOR_CALLEE=Symbol("CALL_STATUS_WAITING_FOR_CALLEE"),tt.CALL_STATUS_ONGOING=Symbol("CALL_STATUS_ONGOING"),tt.CALL_STATUS_ENDED=Symbol("CALL_STATUS_ENDED"),tt.DATACHANNEL_STATUS_WAITING=Symbol("DATACHANNEL_STATUS_WAITING"),tt.DATACHANNEL_STATUS_ONGOING=Symbol("DATACHANNEL_STATUS_ONGOING"),tt.DATACHANNEL_STATUS_ENDED=Symbol("DATACHANNEL_STATUS_ENDED"),tt.DATACHANNEL_TYPE_RECEIVE=Symbol("DATACHANNEL_TYPE_RECEIVE"),tt.DATACHANNEL_TYPE_SEND=Symbol("DATACHANNEL_TYPE_SEND"),tt.CONVERSATION_STATUS_JOINED=Symbol("CONVERSATION_STATUS_JOINED"),tt.CONVERSATION_STATUS_NOT_JOINED=Symbol("CONVERSATION_STATUS_NOT_JOINED"),tt.CONVERSATION_STATUS_WAITING=Symbol("CONVERSATION_STATUS_WAITING"),tt.CONVERSATION_STATUS_JOINING=Symbol("CONVERSATION_STATUS_JOINING"),tt.CONVERSATION_WHITEBOARD_STARTED=Symbol("CONVERSATION_WHITEBOARD_STARTED"),tt.CONVERSATION_WHITEBOARD_NOT_STARTED=Symbol("CONVERSATION_WHITEBOARD_NOT_STARTED"),tt.STATE_IDLE=Symbol("STATE_IDLE"),tt.STATE_JOINING=Symbol("STATE_JOINING"),tt.STATE_ACTIVE=Symbol("STATE_ACTIVE"),tt.STATE_LEAVING=Symbol("STATE_LEAVING"),tt.INVITATION_STATUS_ACCEPTED=Symbol("INVITATION_STATUS_ACCEPTED"),tt.INVITATION_STATUS_DECLINED=Symbol("INVITATION_STATUS_DECLINED"),tt.INVITATION_STATUS_STANDBY=Symbol("INVITATION_STATUS_STANDBY"),tt.INVITATION_STATUS_EXPIRED=Symbol("INVITATION_STATUS_EXPIRED"),tt.INVITATION_STATUS_CANCELLED=Symbol("INVITATION_STATUS_CANCELLED"),tt.INVITATION_STATUS_ENDED=Symbol("INVITATION_STATUS_ENDED"),tt.STREAM_TYPE_NO_INPUT="no_input",tt.STREAM_TYPE_AUDIO="audio",tt.STREAM_TYPE_VIDEO="video",tt.STREAM_AUDIO_ANALYSIS_THRESHOLD=100,tt.STREAM_AUDIO_NOISE_REDUCTION_VAI={soft:.7,medium:.8,hard:.9},tt.CONTACT_DISCONNECTION_DELAY=1e4,tt.CONVERSATION_JOIN_REQUEST_INTERVAL=5e3,tt.APIRTC_MEDIA_DEVICE_DETECTION_DELAY=1e4,tt.CONVERSATION_GROUP_CHAT_MEMBER_UPDATE_DELAY=5e3,tt.CONVERSATION_WHITEBOARD_START_DELAY=5e3,tt.CONVERSATION_RECORDING_STARTED_DELAY=1e4,tt.CONVERSATION_RECORDING_STOPPED_DELAY=5e3,tt.CONVERSATION_STREAMING_STARTED_DELAY=1e4,tt.CONVERSATION_STREAMING_STOPPED_DELAY=1e4,tt.CONVERSATION_PARTICIPANT_EJECTION_DELAY=5e3,tt.JOIN_WAITING_ROOM_PRESENCE_GROUP_TIMEOUT=3e3},1215:(it,ut,s)=>{function tt(pt){return tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(gt){return typeof gt}:function(gt){return gt&&typeof Symbol=="function"&&gt.constructor===Symbol&&gt!==Symbol.prototype?"symbol":typeof gt},tt(pt)}function ot(pt,gt){return arguments.length===3?ct(arguments[0],arguments[1],arguments[2]):gt==="null"?pt===null:gt==="array"?pt!==null&&tt(pt)==="object"&&Array.isArray(pt):pt!==null&&tt(pt)===gt}function ct(pt,gt,st){if(gt!==null&&tt(gt)==="object"&&Array.isArray(gt)&&gt.length>=1){var ft=gt[0];if(gt.length>1)return ot(pt,"object")&&ot(ft,"string")&&pt.hasOwnProperty(ft)&&ot(pt[ft],"object")&&ct(pt[ft],gt.slice(1),st);gt=ft}return st==="undefined"?ot(pt,"object")&&ot(gt,"string")&&!pt.hasOwnProperty(gt)&&ot(pt[gt],st):ot(pt,"object")&&ot(gt,"string")&&pt.hasOwnProperty(gt)&&ot(pt[gt],st)}s.d(ut,{g:()=>yt}),s(4916),s(5306),s(3710),s(1539),s(9714),s(7941),s(9575),s(6716),s(9554),s(6992),s(1532),s(8783),s(3948),s(9753),s(7042),s(3843),s(2564),s(2526),s(1817),s(2165);var yt={assignObject:function(pt,gt){var st,ft,at;for(pt==null&&(pt={}),st=1;st<arguments.length;st+=1)for(ft in at=arguments[st])at.hasOwnProperty(ft)&&(pt[ft]=at[ft]);return pt},throttle:function(pt,gt){var st,ft,at,ht=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},mt=null,St=0,It=function(){St=ht.leading===!1?0:Date.now(),mt=null,at=pt.apply(st,ft),mt||(st=ft=null)};return function(){var xt=Date.now();St||ht.leading!==!1||(St=xt);var At=gt-(xt-St);return st=this,ft=arguments,At<=0||At>gt?(mt&&(clearTimeout(mt),mt=null),St=xt,at=pt.apply(st,ft),mt||(st=ft=null)):mt||ht.trailing===!1||(mt=setTimeout(It,At)),at}},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(pt){var gt=16*Math.random()|0;return(pt==="x"?gt:3&gt|8).toString(16)})},hashString:function(pt){for(var gt=0,st=0,ft=pt.length;st<ft;)gt=(gt<<5)-gt+pt.charCodeAt(st++)<<0;return Math.abs(gt)},arrayBuffertoString:function(pt){var gt=new DataView(pt);return new TextDecoder("utf-8").decode(gt)},getAudioContext:function(){return apiRTC.audioProcessor.getOrCreateAudioContext()},parseRecordingEvent:function(pt,gt){var st=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return["roomName","callId","recordType","convId","mediaId","mediaURL","recordedFileName"].forEach(function(ft){gt.hasOwnProperty(ft)&&(st[ft]=String(gt[ft]))}),gt.mediaType==="AUDIO-ONLY"?(st.audioOnly=!0,st.videoOnly=!1):gt.mediaType==="VIDEO-ONLY"?(st.audioOnly=!1,st.videoOnly=!0):(st.audioOnly=!1,st.videoOnly=!1),st.recordType==="composite"&&(gt.hasOwnProperty("mode")?st.mode=gt.mode:st.mode="complete",gt.hasOwnProperty("labelEnabled")?(st.labelEnabled=gt.labelEnabled===!0,st.labelEnabled===!0&&gt.hasOwnProperty("labels")&&(st.labels=gt.labels)):st.labelEnabled=!1),st},paramsToQueryString:function(pt){for(var gt="",st=0,ft=Object.keys(pt);st<ft.length;st++){var at=ft[st];gt+=gt===""?"?":"&",pt[at]===null||pt[at]===void 0?console.warn("apiRTC Utils - paramsToQueryString : "+at+" is undefined!"):gt+=at+"="+pt[at].toString()}return gt},createError:function(pt,gt,st){var ft=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};st&&st.error(gt);var at={code:pt};return gt instanceof String?at.error=new Error(gt):gt instanceof Error?at.error=gt:at.error=new Error(String(gt)),ot(ft,"object")&&(ft.hasOwnProperty("fromError")&&(at.fromError=ft.fromError),ft.hasOwnProperty("httpCode")&&(at.httpCode=ft.httpCode)),at},isSet:function(pt){return pt!=null},isTypeof:ot,isPropertyTypeof:ct,_private:{dataCallsOnHold:new Map,dataChannelInvitations:new Map,dataCallsFileInfo:new Map}}},9662:(it,ut,s)=>{var tt=s(614),ot=s(6330),ct=TypeError;it.exports=function(yt){if(tt(yt))return yt;throw ct(ot(yt)+" is not a function")}},9483:(it,ut,s)=>{var tt=s(4411),ot=s(6330),ct=TypeError;it.exports=function(yt){if(tt(yt))return yt;throw ct(ot(yt)+" is not a constructor")}},6077:(it,ut,s)=>{var tt=s(614),ot=String,ct=TypeError;it.exports=function(yt){if(typeof yt=="object"||tt(yt))return yt;throw ct("Can't set "+ot(yt)+" as a prototype")}},1223:(it,ut,s)=>{var tt=s(5112),ot=s(30),ct=s(3070).f,yt=tt("unscopables"),pt=Array.prototype;pt[yt]==null&&ct(pt,yt,{configurable:!0,value:ot(null)}),it.exports=function(gt){pt[yt][gt]=!0}},1530:(it,ut,s)=>{var tt=s(8710).charAt;it.exports=function(ot,ct,yt){return ct+(yt?tt(ot,ct).length:1)}},5787:(it,ut,s)=>{var tt=s(7976),ot=TypeError;it.exports=function(ct,yt){if(tt(yt,ct))return ct;throw ot("Incorrect invocation")}},9670:(it,ut,s)=>{var tt=s(111),ot=String,ct=TypeError;it.exports=function(yt){if(tt(yt))return yt;throw ct(ot(yt)+" is not an object")}},4019:it=>{it.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},7556:(it,ut,s)=>{var tt=s(7293);it.exports=tt(function(){if(typeof ArrayBuffer=="function"){var ot=new ArrayBuffer(8);Object.isExtensible(ot)&&Object.defineProperty(ot,"a",{value:8})}})},260:(it,ut,s)=>{var tt,ot,ct,yt=s(4019),pt=s(9781),gt=s(7854),st=s(614),ft=s(111),at=s(2597),ht=s(648),mt=s(6330),St=s(8880),It=s(8052),xt=s(3070).f,At=s(7976),Nt=s(9518),kt=s(7674),Mt=s(5112),bt=s(9711),Bt=s(9909),Ht=Bt.enforce,Wt=Bt.get,nn=gt.Int8Array,gn=nn&&nn.prototype,tn=gt.Uint8ClampedArray,Gt=tn&&tn.prototype,fn=nn&&Nt(nn),Cn=gn&&Nt(gn),Tn=Object.prototype,dn=gt.TypeError,mn=Mt("toStringTag"),yn=bt("TYPED_ARRAY_TAG"),pn=yt&&!!kt&&ht(gt.opera)!=="Opera",In=!1,On={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},_n={BigInt64Array:8,BigUint64Array:8},Mn=function(wn){var Pn=Nt(wn);if(ft(Pn)){var Fn=Wt(Pn);return Fn&&at(Fn,"TypedArrayConstructor")?Fn.TypedArrayConstructor:Mn(Pn)}},Nn=function(wn){if(!ft(wn))return!1;var Pn=ht(wn);return at(On,Pn)||at(_n,Pn)};for(tt in On)(ct=(ot=gt[tt])&&ot.prototype)?Ht(ct).TypedArrayConstructor=ot:pn=!1;for(tt in _n)(ct=(ot=gt[tt])&&ot.prototype)&&(Ht(ct).TypedArrayConstructor=ot);if((!pn||!st(fn)||fn===Function.prototype)&&(fn=function(){throw dn("Incorrect invocation")},pn))for(tt in On)gt[tt]&&kt(gt[tt],fn);if((!pn||!Cn||Cn===Tn)&&(Cn=fn.prototype,pn))for(tt in On)gt[tt]&&kt(gt[tt].prototype,Cn);if(pn&&Nt(Gt)!==Cn&&kt(Gt,Cn),pt&&!at(Cn,mn))for(tt in In=!0,xt(Cn,mn,{get:function(){return ft(this)?this[yn]:void 0}}),On)gt[tt]&&St(gt[tt],yn,tt);it.exports={NATIVE_ARRAY_BUFFER_VIEWS:pn,TYPED_ARRAY_TAG:In&&yn,aTypedArray:function(wn){if(Nn(wn))return wn;throw dn("Target is not a typed array")},aTypedArrayConstructor:function(wn){if(st(wn)&&(!kt||At(fn,wn)))return wn;throw dn(mt(wn)+" is not a typed array constructor")},exportTypedArrayMethod:function(wn,Pn,Fn,ar){if(pt){if(Fn)for(var Yn in On){var Xn=gt[Yn];if(Xn&&at(Xn.prototype,wn))try{delete Xn.prototype[wn]}catch{try{Xn.prototype[wn]=Pn}catch{}}}Cn[wn]&&!Fn||It(Cn,wn,Fn?Pn:pn&&gn[wn]||Pn,ar)}},exportTypedArrayStaticMethod:function(wn,Pn,Fn){var ar,Yn;if(pt){if(kt){if(Fn){for(ar in On)if((Yn=gt[ar])&&at(Yn,wn))try{delete Yn[wn]}catch{}}if(fn[wn]&&!Fn)return;try{return It(fn,wn,Fn?Pn:pn&&fn[wn]||Pn)}catch{}}for(ar in On)!(Yn=gt[ar])||Yn[wn]&&!Fn||It(Yn,wn,Pn)}},getTypedArrayConstructor:Mn,isView:function(wn){if(!ft(wn))return!1;var Pn=ht(wn);return Pn==="DataView"||at(On,Pn)||at(_n,Pn)},isTypedArray:Nn,TypedArray:fn,TypedArrayPrototype:Cn}},3331:(it,ut,s)=>{var tt=s(7854),ot=s(1702),ct=s(9781),yt=s(4019),pt=s(6530),gt=s(8880),st=s(9190),ft=s(7293),at=s(5787),ht=s(9303),mt=s(7466),St=s(7067),It=s(1179),xt=s(9518),At=s(7674),Nt=s(8006).f,kt=s(3070).f,Mt=s(1285),bt=s(1589),Bt=s(8003),Ht=s(9909),Wt=pt.PROPER,nn=pt.CONFIGURABLE,gn=Ht.get,tn=Ht.set,Gt="ArrayBuffer",fn="Wrong index",Cn=tt.ArrayBuffer,Tn=Cn,dn=Tn&&Tn.prototype,mn=tt.DataView,yn=mn&&mn.prototype,pn=Object.prototype,In=tt.Array,On=tt.RangeError,_n=ot(Mt),Mn=ot([].reverse),Nn=It.pack,wn=It.unpack,Pn=function(vn){return[255&vn]},Fn=function(vn){return[255&vn,vn>>8&255]},ar=function(vn){return[255&vn,vn>>8&255,vn>>16&255,vn>>24&255]},Yn=function(vn){return vn[3]<<24|vn[2]<<16|vn[1]<<8|vn[0]},Xn=function(vn){return Nn(vn,23,4)},tr=function(vn){return Nn(vn,52,8)},cn=function(vn,kn){kt(vn.prototype,kn,{get:function(){return gn(this)[kn]}})},Hn=function(vn,kn,qt,Rt){var nt=St(qt),vt=gn(vn);if(nt+kn>vt.byteLength)throw On(fn);var Tt=gn(vt.buffer).bytes,Pt=nt+vt.byteOffset,wt=bt(Tt,Pt,Pt+kn);return Rt?wt:Mn(wt)},Qn=function(vn,kn,qt,Rt,nt,vt){var Tt=St(qt),Pt=gn(vn);if(Tt+kn>Pt.byteLength)throw On(fn);for(var wt=gn(Pt.buffer).bytes,Dt=Tt+Pt.byteOffset,Et=Rt(+nt),jt=0;jt<kn;jt++)wt[Dt+jt]=Et[vt?jt:kn-jt-1]};if(yt){var or=Wt&&Cn.name!==Gt;if(ft(function(){Cn(1)})&&ft(function(){new Cn(-1)})&&!ft(function(){return new Cn,new Cn(1.5),new Cn(NaN),or&&!nn}))or&&nn&&gt(Cn,"name",Gt);else{(Tn=function(vn){return at(this,dn),new Cn(St(vn))}).prototype=dn;for(var Wn,ir=Nt(Cn),nr=0;ir.length>nr;)(Wn=ir[nr++])in Tn||gt(Tn,Wn,Cn[Wn]);dn.constructor=Tn}At&&xt(yn)!==pn&&At(yn,pn);var xn=new mn(new Tn(2)),Un=ot(yn.setInt8);xn.setInt8(0,2147483648),xn.setInt8(1,2147483649),!xn.getInt8(0)&&xn.getInt8(1)||st(yn,{setInt8:function(vn,kn){Un(this,vn,kn<<24>>24)},setUint8:function(vn,kn){Un(this,vn,kn<<24>>24)}},{unsafe:!0})}else dn=(Tn=function(vn){at(this,dn);var kn=St(vn);tn(this,{bytes:_n(In(kn),0),byteLength:kn}),ct||(this.byteLength=kn)}).prototype,yn=(mn=function(vn,kn,qt){at(this,yn),at(vn,dn);var Rt=gn(vn).byteLength,nt=ht(kn);if(nt<0||nt>Rt)throw On("Wrong offset");if(nt+(qt=qt===void 0?Rt-nt:mt(qt))>Rt)throw On("Wrong length");tn(this,{buffer:vn,byteLength:qt,byteOffset:nt}),ct||(this.buffer=vn,this.byteLength=qt,this.byteOffset=nt)}).prototype,ct&&(cn(Tn,"byteLength"),cn(mn,"buffer"),cn(mn,"byteLength"),cn(mn,"byteOffset")),st(yn,{getInt8:function(vn){return Hn(this,1,vn)[0]<<24>>24},getUint8:function(vn){return Hn(this,1,vn)[0]},getInt16:function(vn){var kn=Hn(this,2,vn,arguments.length>1?arguments[1]:void 0);return(kn[1]<<8|kn[0])<<16>>16},getUint16:function(vn){var kn=Hn(this,2,vn,arguments.length>1?arguments[1]:void 0);return kn[1]<<8|kn[0]},getInt32:function(vn){return Yn(Hn(this,4,vn,arguments.length>1?arguments[1]:void 0))},getUint32:function(vn){return Yn(Hn(this,4,vn,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(vn){return wn(Hn(this,4,vn,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(vn){return wn(Hn(this,8,vn,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(vn,kn){Qn(this,1,vn,Pn,kn)},setUint8:function(vn,kn){Qn(this,1,vn,Pn,kn)},setInt16:function(vn,kn){Qn(this,2,vn,Fn,kn,arguments.length>2?arguments[2]:void 0)},setUint16:function(vn,kn){Qn(this,2,vn,Fn,kn,arguments.length>2?arguments[2]:void 0)},setInt32:function(vn,kn){Qn(this,4,vn,ar,kn,arguments.length>2?arguments[2]:void 0)},setUint32:function(vn,kn){Qn(this,4,vn,ar,kn,arguments.length>2?arguments[2]:void 0)},setFloat32:function(vn,kn){Qn(this,4,vn,Xn,kn,arguments.length>2?arguments[2]:void 0)},setFloat64:function(vn,kn){Qn(this,8,vn,tr,kn,arguments.length>2?arguments[2]:void 0)}});Bt(Tn,Gt),Bt(mn,"DataView"),it.exports={ArrayBuffer:Tn,DataView:mn}},1048:(it,ut,s)=>{var tt=s(7908),ot=s(1400),ct=s(6244),yt=s(5117),pt=Math.min;it.exports=[].copyWithin||function(gt,st){var ft=tt(this),at=ct(ft),ht=ot(gt,at),mt=ot(st,at),St=arguments.length>2?arguments[2]:void 0,It=pt((St===void 0?at:ot(St,at))-mt,at-ht),xt=1;for(mt<ht&&ht<mt+It&&(xt=-1,mt+=It-1,ht+=It-1);It-- >0;)mt in ft?ft[ht]=ft[mt]:yt(ft,ht),ht+=xt,mt+=xt;return ft}},1285:(it,ut,s)=>{var tt=s(7908),ot=s(1400),ct=s(6244);it.exports=function(yt){for(var pt=tt(this),gt=ct(pt),st=arguments.length,ft=ot(st>1?arguments[1]:void 0,gt),at=st>2?arguments[2]:void 0,ht=at===void 0?gt:ot(at,gt);ht>ft;)pt[ft++]=yt;return pt}},8533:(it,ut,s)=>{var tt=s(2092).forEach,ot=s(9341)("forEach");it.exports=ot?[].forEach:function(ct){return tt(this,ct,arguments.length>1?arguments[1]:void 0)}},7745:(it,ut,s)=>{var tt=s(6244);it.exports=function(ot,ct){for(var yt=0,pt=tt(ct),gt=new ot(pt);pt>yt;)gt[yt]=ct[yt++];return gt}},8457:(it,ut,s)=>{var tt=s(9974),ot=s(6916),ct=s(7908),yt=s(3411),pt=s(7659),gt=s(4411),st=s(6244),ft=s(6135),at=s(8554),ht=s(1246),mt=Array;it.exports=function(St){var It=ct(St),xt=gt(this),At=arguments.length,Nt=At>1?arguments[1]:void 0,kt=Nt!==void 0;kt&&(Nt=tt(Nt,At>2?arguments[2]:void 0));var Mt,bt,Bt,Ht,Wt,nn,gn=ht(It),tn=0;if(!gn||this===mt&&pt(gn))for(Mt=st(It),bt=xt?new this(Mt):mt(Mt);Mt>tn;tn++)nn=kt?Nt(It[tn],tn):It[tn],ft(bt,tn,nn);else for(Wt=(Ht=at(It,gn)).next,bt=xt?new this:[];!(Bt=ot(Wt,Ht)).done;tn++)nn=kt?yt(Ht,Nt,[Bt.value,tn],!0):Bt.value,ft(bt,tn,nn);return bt.length=tn,bt}},1318:(it,ut,s)=>{var tt=s(5656),ot=s(1400),ct=s(6244),yt=function(pt){return function(gt,st,ft){var at,ht=tt(gt),mt=ct(ht),St=ot(ft,mt);if(pt&&st!=st){for(;mt>St;)if((at=ht[St++])!=at)return!0}else for(;mt>St;St++)if((pt||St in ht)&&ht[St]===st)return pt||St||0;return!pt&&-1}};it.exports={includes:yt(!0),indexOf:yt(!1)}},2092:(it,ut,s)=>{var tt=s(9974),ot=s(1702),ct=s(8361),yt=s(7908),pt=s(6244),gt=s(5417),st=ot([].push),ft=function(at){var ht=at==1,mt=at==2,St=at==3,It=at==4,xt=at==6,At=at==7,Nt=at==5||xt;return function(kt,Mt,bt,Bt){for(var Ht,Wt,nn=yt(kt),gn=ct(nn),tn=tt(Mt,bt),Gt=pt(gn),fn=0,Cn=Bt||gt,Tn=ht?Cn(kt,Gt):mt||At?Cn(kt,0):void 0;Gt>fn;fn++)if((Nt||fn in gn)&&(Wt=tn(Ht=gn[fn],fn,nn),at))if(ht)Tn[fn]=Wt;else if(Wt)switch(at){case 3:return!0;case 5:return Ht;case 6:return fn;case 2:st(Tn,Ht)}else switch(at){case 4:return!1;case 7:st(Tn,Ht)}return xt?-1:St||It?It:Tn}};it.exports={forEach:ft(0),map:ft(1),filter:ft(2),some:ft(3),every:ft(4),find:ft(5),findIndex:ft(6),filterReject:ft(7)}},6583:(it,ut,s)=>{var tt=s(2104),ot=s(5656),ct=s(9303),yt=s(6244),pt=s(9341),gt=Math.min,st=[].lastIndexOf,ft=!!st&&1/[1].lastIndexOf(1,-0)<0,at=pt("lastIndexOf"),ht=ft||!at;it.exports=ht?function(mt){if(ft)return tt(st,this,arguments)||0;var St=ot(this),It=yt(St),xt=It-1;for(arguments.length>1&&(xt=gt(xt,ct(arguments[1]))),xt<0&&(xt=It+xt);xt>=0;xt--)if(xt in St&&St[xt]===mt)return xt||0;return-1}:st},1194:(it,ut,s)=>{var tt=s(7293),ot=s(5112),ct=s(7392),yt=ot("species");it.exports=function(pt){return ct>=51||!tt(function(){var gt=[];return(gt.constructor={})[yt]=function(){return{foo:1}},gt[pt](Boolean).foo!==1})}},9341:(it,ut,s)=>{var tt=s(7293);it.exports=function(ot,ct){var yt=[][ot];return!!yt&&tt(function(){yt.call(null,ct||function(){return 1},1)})}},3671:(it,ut,s)=>{var tt=s(9662),ot=s(7908),ct=s(8361),yt=s(6244),pt=TypeError,gt=function(st){return function(ft,at,ht,mt){tt(at);var St=ot(ft),It=ct(St),xt=yt(St),At=st?xt-1:0,Nt=st?-1:1;if(ht<2)for(;;){if(At in It){mt=It[At],At+=Nt;break}if(At+=Nt,st?At<0:xt<=At)throw pt("Reduce of empty array with no initial value")}for(;st?At>=0:xt>At;At+=Nt)At in It&&(mt=at(mt,It[At],At,St));return mt}};it.exports={left:gt(!1),right:gt(!0)}},1589:(it,ut,s)=>{var tt=s(1400),ot=s(6244),ct=s(6135),yt=Array,pt=Math.max;it.exports=function(gt,st,ft){for(var at=ot(gt),ht=tt(st,at),mt=tt(ft===void 0?at:ft,at),St=yt(pt(mt-ht,0)),It=0;ht<mt;ht++,It++)ct(St,It,gt[ht]);return St.length=It,St}},206:(it,ut,s)=>{var tt=s(1702);it.exports=tt([].slice)},4362:(it,ut,s)=>{var tt=s(1589),ot=Math.floor,ct=function(gt,st){var ft=gt.length,at=ot(ft/2);return ft<8?yt(gt,st):pt(gt,ct(tt(gt,0,at),st),ct(tt(gt,at),st),st)},yt=function(gt,st){for(var ft,at,ht=gt.length,mt=1;mt<ht;){for(at=mt,ft=gt[mt];at&&st(gt[at-1],ft)>0;)gt[at]=gt[--at];at!==mt++&&(gt[at]=ft)}return gt},pt=function(gt,st,ft,at){for(var ht=st.length,mt=ft.length,St=0,It=0;St<ht||It<mt;)gt[St+It]=St<ht&&It<mt?at(st[St],ft[It])<=0?st[St++]:ft[It++]:St<ht?st[St++]:ft[It++];return gt};it.exports=ct},7475:(it,ut,s)=>{var tt=s(3157),ot=s(4411),ct=s(111),yt=s(5112)("species"),pt=Array;it.exports=function(gt){var st;return tt(gt)&&(st=gt.constructor,(ot(st)&&(st===pt||tt(st.prototype))||ct(st)&&(st=st[yt])===null)&&(st=void 0)),st===void 0?pt:st}},5417:(it,ut,s)=>{var tt=s(7475);it.exports=function(ot,ct){return new(tt(ot))(ct===0?0:ct)}},3411:(it,ut,s)=>{var tt=s(9670),ot=s(9212);it.exports=function(ct,yt,pt,gt){try{return gt?yt(tt(pt)[0],pt[1]):yt(pt)}catch(st){ot(ct,"throw",st)}}},7072:(it,ut,s)=>{var tt=s(5112)("iterator"),ot=!1;try{var ct=0,yt={next:function(){return{done:!!ct++}},return:function(){ot=!0}};yt[tt]=function(){return this},Array.from(yt,function(){throw 2})}catch{}it.exports=function(pt,gt){if(!gt&&!ot)return!1;var st=!1;try{var ft={};ft[tt]=function(){return{next:function(){return{done:st=!0}}}},pt(ft)}catch{}return st}},4326:(it,ut,s)=>{var tt=s(1702),ot=tt({}.toString),ct=tt("".slice);it.exports=function(yt){return ct(ot(yt),8,-1)}},648:(it,ut,s)=>{var tt=s(1694),ot=s(614),ct=s(4326),yt=s(5112)("toStringTag"),pt=Object,gt=ct(function(){return arguments}())=="Arguments";it.exports=tt?ct:function(st){var ft,at,ht;return st===void 0?"Undefined":st===null?"Null":typeof(at=function(mt,St){try{return mt[St]}catch{}}(ft=pt(st),yt))=="string"?at:gt?ct(ft):(ht=ct(ft))=="Object"&&ot(ft.callee)?"Arguments":ht}},5631:(it,ut,s)=>{var tt=s(3070).f,ot=s(30),ct=s(9190),yt=s(9974),pt=s(5787),gt=s(408),st=s(654),ft=s(6340),at=s(9781),ht=s(2423).fastKey,mt=s(9909),St=mt.set,It=mt.getterFor;it.exports={getConstructor:function(xt,At,Nt,kt){var Mt=xt(function(nn,gn){pt(nn,bt),St(nn,{type:At,index:ot(null),first:void 0,last:void 0,size:0}),at||(nn.size=0),gn!=null&&gt(gn,nn[kt],{that:nn,AS_ENTRIES:Nt})}),bt=Mt.prototype,Bt=It(At),Ht=function(nn,gn,tn){var Gt,fn,Cn=Bt(nn),Tn=Wt(nn,gn);return Tn?Tn.value=tn:(Cn.last=Tn={index:fn=ht(gn,!0),key:gn,value:tn,previous:Gt=Cn.last,next:void 0,removed:!1},Cn.first||(Cn.first=Tn),Gt&&(Gt.next=Tn),at?Cn.size++:nn.size++,fn!=="F"&&(Cn.index[fn]=Tn)),nn},Wt=function(nn,gn){var tn,Gt=Bt(nn),fn=ht(gn);if(fn!=="F")return Gt.index[fn];for(tn=Gt.first;tn;tn=tn.next)if(tn.key==gn)return tn};return ct(bt,{clear:function(){for(var nn=Bt(this),gn=nn.index,tn=nn.first;tn;)tn.removed=!0,tn.previous&&(tn.previous=tn.previous.next=void 0),delete gn[tn.index],tn=tn.next;nn.first=nn.last=void 0,at?nn.size=0:this.size=0},delete:function(nn){var gn=this,tn=Bt(gn),Gt=Wt(gn,nn);if(Gt){var fn=Gt.next,Cn=Gt.previous;delete tn.index[Gt.index],Gt.removed=!0,Cn&&(Cn.next=fn),fn&&(fn.previous=Cn),tn.first==Gt&&(tn.first=fn),tn.last==Gt&&(tn.last=Cn),at?tn.size--:gn.size--}return!!Gt},forEach:function(nn){for(var gn,tn=Bt(this),Gt=yt(nn,arguments.length>1?arguments[1]:void 0);gn=gn?gn.next:tn.first;)for(Gt(gn.value,gn.key,this);gn&&gn.removed;)gn=gn.previous},has:function(nn){return!!Wt(this,nn)}}),ct(bt,Nt?{get:function(nn){var gn=Wt(this,nn);return gn&&gn.value},set:function(nn,gn){return Ht(this,nn===0?0:nn,gn)}}:{add:function(nn){return Ht(this,nn=nn===0?0:nn,nn)}}),at&&tt(bt,"size",{get:function(){return Bt(this).size}}),Mt},setStrong:function(xt,At,Nt){var kt=At+" Iterator",Mt=It(At),bt=It(kt);st(xt,At,function(Bt,Ht){St(this,{type:kt,target:Bt,state:Mt(Bt),kind:Ht,last:void 0})},function(){for(var Bt=bt(this),Ht=Bt.kind,Wt=Bt.last;Wt&&Wt.removed;)Wt=Wt.previous;return Bt.target&&(Bt.last=Wt=Wt?Wt.next:Bt.state.first)?Ht=="keys"?{value:Wt.key,done:!1}:Ht=="values"?{value:Wt.value,done:!1}:{value:[Wt.key,Wt.value],done:!1}:(Bt.target=void 0,{value:void 0,done:!0})},Nt?"entries":"values",!Nt,!0),ft(At)}}},9320:(it,ut,s)=>{var tt=s(1702),ot=s(9190),ct=s(2423).getWeakData,yt=s(9670),pt=s(111),gt=s(5787),st=s(408),ft=s(2092),at=s(2597),ht=s(9909),mt=ht.set,St=ht.getterFor,It=ft.find,xt=ft.findIndex,At=tt([].splice),Nt=0,kt=function(Bt){return Bt.frozen||(Bt.frozen=new Mt)},Mt=function(){this.entries=[]},bt=function(Bt,Ht){return It(Bt.entries,function(Wt){return Wt[0]===Ht})};Mt.prototype={get:function(Bt){var Ht=bt(this,Bt);if(Ht)return Ht[1]},has:function(Bt){return!!bt(this,Bt)},set:function(Bt,Ht){var Wt=bt(this,Bt);Wt?Wt[1]=Ht:this.entries.push([Bt,Ht])},delete:function(Bt){var Ht=xt(this.entries,function(Wt){return Wt[0]===Bt});return~Ht&&At(this.entries,Ht,1),!!~Ht}},it.exports={getConstructor:function(Bt,Ht,Wt,nn){var gn=Bt(function(Cn,Tn){gt(Cn,tn),mt(Cn,{type:Ht,id:Nt++,frozen:void 0}),Tn!=null&&st(Tn,Cn[nn],{that:Cn,AS_ENTRIES:Wt})}),tn=gn.prototype,Gt=St(Ht),fn=function(Cn,Tn,dn){var mn=Gt(Cn),yn=ct(yt(Tn),!0);return yn===!0?kt(mn).set(Tn,dn):yn[mn.id]=dn,Cn};return ot(tn,{delete:function(Cn){var Tn=Gt(this);if(!pt(Cn))return!1;var dn=ct(Cn);return dn===!0?kt(Tn).delete(Cn):dn&&at(dn,Tn.id)&&delete dn[Tn.id]},has:function(Cn){var Tn=Gt(this);if(!pt(Cn))return!1;var dn=ct(Cn);return dn===!0?kt(Tn).has(Cn):dn&&at(dn,Tn.id)}}),ot(tn,Wt?{get:function(Cn){var Tn=Gt(this);if(pt(Cn)){var dn=ct(Cn);return dn===!0?kt(Tn).get(Cn):dn?dn[Tn.id]:void 0}},set:function(Cn,Tn){return fn(this,Cn,Tn)}}:{add:function(Cn){return fn(this,Cn,!0)}}),gn}}},7710:(it,ut,s)=>{var tt=s(2109),ot=s(7854),ct=s(1702),yt=s(4705),pt=s(8052),gt=s(2423),st=s(408),ft=s(5787),at=s(614),ht=s(111),mt=s(7293),St=s(7072),It=s(8003),xt=s(9587);it.exports=function(At,Nt,kt){var Mt=At.indexOf("Map")!==-1,bt=At.indexOf("Weak")!==-1,Bt=Mt?"set":"add",Ht=ot[At],Wt=Ht&&Ht.prototype,nn=Ht,gn={},tn=function(mn){var yn=ct(Wt[mn]);pt(Wt,mn,mn=="add"?function(pn){return yn(this,pn===0?0:pn),this}:mn=="delete"?function(pn){return!(bt&&!ht(pn))&&yn(this,pn===0?0:pn)}:mn=="get"?function(pn){return bt&&!ht(pn)?void 0:yn(this,pn===0?0:pn)}:mn=="has"?function(pn){return!(bt&&!ht(pn))&&yn(this,pn===0?0:pn)}:function(pn,In){return yn(this,pn===0?0:pn,In),this})};if(yt(At,!at(Ht)||!(bt||Wt.forEach&&!mt(function(){new Ht().entries().next()}))))nn=kt.getConstructor(Nt,At,Mt,Bt),gt.enable();else if(yt(At,!0)){var Gt=new nn,fn=Gt[Bt](bt?{}:-0,1)!=Gt,Cn=mt(function(){Gt.has(1)}),Tn=St(function(mn){new Ht(mn)}),dn=!bt&&mt(function(){for(var mn=new Ht,yn=5;yn--;)mn[Bt](yn,yn);return!mn.has(-0)});Tn||((nn=Nt(function(mn,yn){ft(mn,Wt);var pn=xt(new Ht,mn,nn);return yn!=null&&st(yn,pn[Bt],{that:pn,AS_ENTRIES:Mt}),pn})).prototype=Wt,Wt.constructor=nn),(Cn||dn)&&(tn("delete"),tn("has"),Mt&&tn("get")),(dn||fn)&&tn(Bt),bt&&Wt.clear&&delete Wt.clear}return gn[At]=nn,tt({global:!0,constructor:!0,forced:nn!=Ht},gn),It(nn,At),bt||kt.setStrong(nn,At,Mt),nn}},9920:(it,ut,s)=>{var tt=s(2597),ot=s(3887),ct=s(1236),yt=s(3070);it.exports=function(pt,gt,st){for(var ft=ot(gt),at=yt.f,ht=ct.f,mt=0;mt<ft.length;mt++){var St=ft[mt];tt(pt,St)||st&&tt(st,St)||at(pt,St,ht(gt,St))}}},4964:(it,ut,s)=>{var tt=s(5112)("match");it.exports=function(ot){var ct=/./;try{"/./"[ot](ct)}catch{try{return ct[tt]=!1,"/./"[ot](ct)}catch{}}return!1}},8544:(it,ut,s)=>{var tt=s(7293);it.exports=!tt(function(){function ot(){}return ot.prototype.constructor=null,Object.getPrototypeOf(new ot)!==ot.prototype})},4994:(it,ut,s)=>{var tt=s(3383).IteratorPrototype,ot=s(30),ct=s(9114),yt=s(8003),pt=s(7497),gt=function(){return this};it.exports=function(st,ft,at,ht){var mt=ft+" Iterator";return st.prototype=ot(tt,{next:ct(+!ht,at)}),yt(st,mt,!1,!0),pt[mt]=gt,st}},8880:(it,ut,s)=>{var tt=s(9781),ot=s(3070),ct=s(9114);it.exports=tt?function(yt,pt,gt){return ot.f(yt,pt,ct(1,gt))}:function(yt,pt,gt){return yt[pt]=gt,yt}},9114:it=>{it.exports=function(ut,s){return{enumerable:!(1&ut),configurable:!(2&ut),writable:!(4&ut),value:s}}},6135:(it,ut,s)=>{var tt=s(4948),ot=s(3070),ct=s(9114);it.exports=function(yt,pt,gt){var st=tt(pt);st in yt?ot.f(yt,st,ct(0,gt)):yt[st]=gt}},5573:(it,ut,s)=>{var tt=s(1702),ot=s(7293),ct=s(6650).start,yt=RangeError,pt=Math.abs,gt=Date.prototype,st=gt.toISOString,ft=tt(gt.getTime),at=tt(gt.getUTCDate),ht=tt(gt.getUTCFullYear),mt=tt(gt.getUTCHours),St=tt(gt.getUTCMilliseconds),It=tt(gt.getUTCMinutes),xt=tt(gt.getUTCMonth),At=tt(gt.getUTCSeconds);it.exports=ot(function(){return st.call(new Date(-50000000000001))!="0385-07-25T07:06:39.999Z"})||!ot(function(){st.call(new Date(NaN))})?function(){if(!isFinite(ft(this)))throw yt("Invalid time value");var Nt=this,kt=ht(Nt),Mt=St(Nt),bt=kt<0?"-":kt>9999?"+":"";return bt+ct(pt(kt),bt?6:4,0)+"-"+ct(xt(Nt)+1,2,0)+"-"+ct(at(Nt),2,0)+"T"+ct(mt(Nt),2,0)+":"+ct(It(Nt),2,0)+":"+ct(At(Nt),2,0)+"."+ct(Mt,3,0)+"Z"}:st},7045:(it,ut,s)=>{var tt=s(6339),ot=s(3070);it.exports=function(ct,yt,pt){return pt.get&&tt(pt.get,yt,{getter:!0}),pt.set&&tt(pt.set,yt,{setter:!0}),ot.f(ct,yt,pt)}},8052:(it,ut,s)=>{var tt=s(614),ot=s(3070),ct=s(6339),yt=s(3072);it.exports=function(pt,gt,st,ft){ft||(ft={});var at=ft.enumerable,ht=ft.name!==void 0?ft.name:gt;if(tt(st)&&ct(st,ht,ft),ft.global)at?pt[gt]=st:yt(gt,st);else{try{ft.unsafe?pt[gt]&&(at=!0):delete pt[gt]}catch{}at?pt[gt]=st:ot.f(pt,gt,{value:st,enumerable:!1,configurable:!ft.nonConfigurable,writable:!ft.nonWritable})}return pt}},9190:(it,ut,s)=>{var tt=s(8052);it.exports=function(ot,ct,yt){for(var pt in ct)tt(ot,pt,ct[pt],yt);return ot}},3072:(it,ut,s)=>{var tt=s(7854),ot=Object.defineProperty;it.exports=function(ct,yt){try{ot(tt,ct,{value:yt,configurable:!0,writable:!0})}catch{tt[ct]=yt}return yt}},654:(it,ut,s)=>{var tt=s(2109),ot=s(6916),ct=s(1913),yt=s(6530),pt=s(614),gt=s(4994),st=s(9518),ft=s(7674),at=s(8003),ht=s(8880),mt=s(8052),St=s(5112),It=s(7497),xt=s(3383),At=yt.PROPER,Nt=yt.CONFIGURABLE,kt=xt.IteratorPrototype,Mt=xt.BUGGY_SAFARI_ITERATORS,bt=St("iterator"),Bt="keys",Ht="values",Wt="entries",nn=function(){return this};it.exports=function(gn,tn,Gt,fn,Cn,Tn,dn){gt(Gt,tn,fn);var mn,yn,pn,In=function(Fn){if(Fn===Cn&&wn)return wn;if(!Mt&&Fn in Mn)return Mn[Fn];switch(Fn){case Bt:case Ht:case Wt:return function(){return new Gt(this,Fn)}}return function(){return new Gt(this)}},On=tn+" Iterator",_n=!1,Mn=gn.prototype,Nn=Mn[bt]||Mn["@@iterator"]||Cn&&Mn[Cn],wn=!Mt&&Nn||In(Cn),Pn=tn=="Array"&&Mn.entries||Nn;if(Pn&&(mn=st(Pn.call(new gn)))!==Object.prototype&&mn.next&&(ct||st(mn)===kt||(ft?ft(mn,kt):pt(mn[bt])||mt(mn,bt,nn)),at(mn,On,!0,!0),ct&&(It[On]=nn)),At&&Cn==Ht&&Nn&&Nn.name!==Ht&&(!ct&&Nt?ht(Mn,"name",Ht):(_n=!0,wn=function(){return ot(Nn,this)})),Cn)if(yn={values:In(Ht),keys:Tn?wn:In(Bt),entries:In(Wt)},dn)for(pn in yn)(Mt||_n||!(pn in Mn))&&mt(Mn,pn,yn[pn]);else tt({target:tn,proto:!0,forced:Mt||_n},yn);return ct&&!dn||Mn[bt]===wn||mt(Mn,bt,wn,{name:Cn}),It[tn]=wn,yn}},7235:(it,ut,s)=>{var tt=s(857),ot=s(2597),ct=s(6061),yt=s(3070).f;it.exports=function(pt){var gt=tt.Symbol||(tt.Symbol={});ot(gt,pt)||yt(gt,pt,{value:ct.f(pt)})}},5117:(it,ut,s)=>{var tt=s(6330),ot=TypeError;it.exports=function(ct,yt){if(!delete ct[yt])throw ot("Cannot delete property "+tt(yt)+" of "+tt(ct))}},9781:(it,ut,s)=>{var tt=s(7293);it.exports=!tt(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},317:(it,ut,s)=>{var tt=s(7854),ot=s(111),ct=tt.document,yt=ot(ct)&&ot(ct.createElement);it.exports=function(pt){return yt?ct.createElement(pt):{}}},7207:it=>{var ut=TypeError;it.exports=function(s){if(s>9007199254740991)throw ut("Maximum allowed index exceeded");return s}},8324:it=>{it.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:(it,ut,s)=>{var tt=s(317)("span").classList,ot=tt&&tt.constructor&&tt.constructor.prototype;it.exports=ot===Object.prototype?void 0:ot},8886:(it,ut,s)=>{var tt=s(8113).match(/firefox\/(\d+)/i);it.exports=!!tt&&+tt[1]},7871:it=>{it.exports=typeof window=="object"&&typeof Deno!="object"},256:(it,ut,s)=>{var tt=s(8113);it.exports=/MSIE|Trident/.test(tt)},1528:(it,ut,s)=>{var tt=s(8113),ot=s(7854);it.exports=/ipad|iphone|ipod/i.test(tt)&&ot.Pebble!==void 0},6833:(it,ut,s)=>{var tt=s(8113);it.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(tt)},2805:(it,ut,s)=>{var tt=s(4326),ot=s(7854);it.exports=tt(ot.process)=="process"},1036:(it,ut,s)=>{var tt=s(8113);it.exports=/web0s(?!.*chrome)/i.test(tt)},8113:(it,ut,s)=>{var tt=s(5005);it.exports=tt("navigator","userAgent")||""},7392:(it,ut,s)=>{var tt,ot,ct=s(7854),yt=s(8113),pt=ct.process,gt=ct.Deno,st=pt&&pt.versions||gt&&gt.version,ft=st&&st.v8;ft&&(ot=(tt=ft.split("."))[0]>0&&tt[0]<4?1:+(tt[0]+tt[1])),!ot&&yt&&(!(tt=yt.match(/Edge\/(\d+)/))||tt[1]>=74)&&(tt=yt.match(/Chrome\/(\d+)/))&&(ot=+tt[1]),it.exports=ot},8008:(it,ut,s)=>{var tt=s(8113).match(/AppleWebKit\/(\d+)\./);it.exports=!!tt&&+tt[1]},748:it=>{it.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:(it,ut,s)=>{var tt=s(7854),ot=s(1236).f,ct=s(8880),yt=s(8052),pt=s(3072),gt=s(9920),st=s(4705);it.exports=function(ft,at){var ht,mt,St,It,xt,At=ft.target,Nt=ft.global,kt=ft.stat;if(ht=Nt?tt:kt?tt[At]||pt(At,{}):(tt[At]||{}).prototype)for(mt in at){if(It=at[mt],St=ft.dontCallGetSet?(xt=ot(ht,mt))&&xt.value:ht[mt],!st(Nt?mt:At+(kt?".":"#")+mt,ft.forced)&&St!==void 0){if(typeof It==typeof St)continue;gt(It,St)}(ft.sham||St&&St.sham)&&ct(It,"sham",!0),yt(ht,mt,It,ft)}}},7293:it=>{it.exports=function(ut){try{return!!ut()}catch{return!0}}},7007:(it,ut,s)=>{s(4916);var tt=s(1702),ot=s(8052),ct=s(2261),yt=s(7293),pt=s(5112),gt=s(8880),st=pt("species"),ft=RegExp.prototype;it.exports=function(at,ht,mt,St){var It=pt(at),xt=!yt(function(){var Mt={};return Mt[It]=function(){return 7},""[at](Mt)!=7}),At=xt&&!yt(function(){var Mt=!1,bt=/a/;return at==="split"&&((bt={}).constructor={},bt.constructor[st]=function(){return bt},bt.flags="",bt[It]=/./[It]),bt.exec=function(){return Mt=!0,null},bt[It](""),!Mt});if(!xt||!At||mt){var Nt=tt(/./[It]),kt=ht(It,""[at],function(Mt,bt,Bt,Ht,Wt){var nn=tt(Mt),gn=bt.exec;return gn===ct||gn===ft.exec?xt&&!Wt?{done:!0,value:Nt(bt,Bt,Ht)}:{done:!0,value:nn(Bt,bt,Ht)}:{done:!1}});ot(String.prototype,at,kt[0]),ot(ft,It,kt[1])}St&&gt(ft[It],"sham",!0)}},6677:(it,ut,s)=>{var tt=s(7293);it.exports=!tt(function(){return Object.isExtensible(Object.preventExtensions({}))})},2104:(it,ut,s)=>{var tt=s(4374),ot=Function.prototype,ct=ot.apply,yt=ot.call;it.exports=typeof Reflect=="object"&&Reflect.apply||(tt?yt.bind(ct):function(){return yt.apply(ct,arguments)})},9974:(it,ut,s)=>{var tt=s(1702),ot=s(9662),ct=s(4374),yt=tt(tt.bind);it.exports=function(pt,gt){return ot(pt),gt===void 0?pt:ct?yt(pt,gt):function(){return pt.apply(gt,arguments)}}},4374:(it,ut,s)=>{var tt=s(7293);it.exports=!tt(function(){var ot=(function(){}).bind();return typeof ot!="function"||ot.hasOwnProperty("prototype")})},7065:(it,ut,s)=>{var tt=s(1702),ot=s(9662),ct=s(111),yt=s(2597),pt=s(206),gt=s(4374),st=Function,ft=tt([].concat),at=tt([].join),ht={},mt=function(St,It,xt){if(!yt(ht,It)){for(var At=[],Nt=0;Nt<It;Nt++)At[Nt]="a["+Nt+"]";ht[It]=st("C,a","return new C("+at(At,",")+")")}return ht[It](St,xt)};it.exports=gt?st.bind:function(St){var It=ot(this),xt=It.prototype,At=pt(arguments,1),Nt=function(){var kt=ft(At,pt(arguments));return this instanceof Nt?mt(It,kt.length,kt):It.apply(St,kt)};return ct(xt)&&(Nt.prototype=xt),Nt}},6916:(it,ut,s)=>{var tt=s(4374),ot=Function.prototype.call;it.exports=tt?ot.bind(ot):function(){return ot.apply(ot,arguments)}},6530:(it,ut,s)=>{var tt=s(9781),ot=s(2597),ct=Function.prototype,yt=tt&&Object.getOwnPropertyDescriptor,pt=ot(ct,"name"),gt=pt&&(function(){}).name==="something",st=pt&&(!tt||tt&&yt(ct,"name").configurable);it.exports={EXISTS:pt,PROPER:gt,CONFIGURABLE:st}},1702:(it,ut,s)=>{var tt=s(4374),ot=Function.prototype,ct=ot.bind,yt=ot.call,pt=tt&&ct.bind(yt,yt);it.exports=tt?function(gt){return gt&&pt(gt)}:function(gt){return gt&&function(){return yt.apply(gt,arguments)}}},5005:(it,ut,s)=>{var tt=s(7854),ot=s(614),ct=function(yt){return ot(yt)?yt:void 0};it.exports=function(yt,pt){return arguments.length<2?ct(tt[yt]):tt[yt]&&tt[yt][pt]}},1246:(it,ut,s)=>{var tt=s(648),ot=s(8173),ct=s(7497),yt=s(5112)("iterator");it.exports=function(pt){if(pt!=null)return ot(pt,yt)||ot(pt,"@@iterator")||ct[tt(pt)]}},8554:(it,ut,s)=>{var tt=s(6916),ot=s(9662),ct=s(9670),yt=s(6330),pt=s(1246),gt=TypeError;it.exports=function(st,ft){var at=arguments.length<2?pt(st):ft;if(ot(at))return ct(tt(at,st));throw gt(yt(st)+" is not iterable")}},8173:(it,ut,s)=>{var tt=s(9662);it.exports=function(ot,ct){var yt=ot[ct];return yt==null?void 0:tt(yt)}},647:(it,ut,s)=>{var tt=s(1702),ot=s(7908),ct=Math.floor,yt=tt("".charAt),pt=tt("".replace),gt=tt("".slice),st=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,ft=/\$([$&'`]|\d{1,2})/g;it.exports=function(at,ht,mt,St,It,xt){var At=mt+at.length,Nt=St.length,kt=ft;return It!==void 0&&(It=ot(It),kt=st),pt(xt,kt,function(Mt,bt){var Bt;switch(yt(bt,0)){case"$":return"$";case"&":return at;case"`":return gt(ht,0,mt);case"'":return gt(ht,At);case"<":Bt=It[gt(bt,1,-1)];break;default:var Ht=+bt;if(Ht===0)return Mt;if(Ht>Nt){var Wt=ct(Ht/10);return Wt===0?Mt:Wt<=Nt?St[Wt-1]===void 0?yt(bt,1):St[Wt-1]+yt(bt,1):Mt}Bt=St[Ht-1]}return Bt===void 0?"":Bt})}},7854:(it,ut,s)=>{var tt=function(ot){return ot&&ot.Math==Math&&ot};it.exports=tt(typeof globalThis=="object"&&globalThis)||tt(typeof window=="object"&&window)||tt(typeof self=="object"&&self)||tt(typeof s.g=="object"&&s.g)||function(){return this}()||Function("return this")()},2597:(it,ut,s)=>{var tt=s(1702),ot=s(7908),ct=tt({}.hasOwnProperty);it.exports=Object.hasOwn||function(yt,pt){return ct(ot(yt),pt)}},3501:it=>{it.exports={}},842:(it,ut,s)=>{var tt=s(7854);it.exports=function(ot,ct){var yt=tt.console;yt&&yt.error&&(arguments.length==1?yt.error(ot):yt.error(ot,ct))}},490:(it,ut,s)=>{var tt=s(5005);it.exports=tt("document","documentElement")},4664:(it,ut,s)=>{var tt=s(9781),ot=s(7293),ct=s(317);it.exports=!tt&&!ot(function(){return Object.defineProperty(ct("div"),"a",{get:function(){return 7}}).a!=7})},1179:it=>{var ut=Array,s=Math.abs,tt=Math.pow,ot=Math.floor,ct=Math.log,yt=Math.LN2;it.exports={pack:function(pt,gt,st){var ft,at,ht,mt=ut(st),St=8*st-gt-1,It=(1<<St)-1,xt=It>>1,At=gt===23?tt(2,-24)-tt(2,-77):0,Nt=pt<0||pt===0&&1/pt<0?1:0,kt=0;for((pt=s(pt))!=pt||pt===1/0?(at=pt!=pt?1:0,ft=It):(ft=ot(ct(pt)/yt),pt*(ht=tt(2,-ft))<1&&(ft--,ht*=2),(pt+=ft+xt>=1?At/ht:At*tt(2,1-xt))*ht>=2&&(ft++,ht/=2),ft+xt>=It?(at=0,ft=It):ft+xt>=1?(at=(pt*ht-1)*tt(2,gt),ft+=xt):(at=pt*tt(2,xt-1)*tt(2,gt),ft=0));gt>=8;)mt[kt++]=255&at,at/=256,gt-=8;for(ft=ft<<gt|at,St+=gt;St>0;)mt[kt++]=255&ft,ft/=256,St-=8;return mt[--kt]|=128*Nt,mt},unpack:function(pt,gt){var st,ft=pt.length,at=8*ft-gt-1,ht=(1<<at)-1,mt=ht>>1,St=at-7,It=ft-1,xt=pt[It--],At=127&xt;for(xt>>=7;St>0;)At=256*At+pt[It--],St-=8;for(st=At&(1<<-St)-1,At>>=-St,St+=gt;St>0;)st=256*st+pt[It--],St-=8;if(At===0)At=1-mt;else{if(At===ht)return st?NaN:xt?-1/0:1/0;st+=tt(2,gt),At-=mt}return(xt?-1:1)*st*tt(2,At-gt)}}},8361:(it,ut,s)=>{var tt=s(1702),ot=s(7293),ct=s(4326),yt=Object,pt=tt("".split);it.exports=ot(function(){return!yt("z").propertyIsEnumerable(0)})?function(gt){return ct(gt)=="String"?pt(gt,""):yt(gt)}:yt},9587:(it,ut,s)=>{var tt=s(614),ot=s(111),ct=s(7674);it.exports=function(yt,pt,gt){var st,ft;return ct&&tt(st=pt.constructor)&&st!==gt&&ot(ft=st.prototype)&&ft!==gt.prototype&&ct(yt,ft),yt}},2788:(it,ut,s)=>{var tt=s(1702),ot=s(614),ct=s(5465),yt=tt(Function.toString);ot(ct.inspectSource)||(ct.inspectSource=function(pt){return yt(pt)}),it.exports=ct.inspectSource},2423:(it,ut,s)=>{var tt=s(2109),ot=s(1702),ct=s(3501),yt=s(111),pt=s(2597),gt=s(3070).f,st=s(8006),ft=s(1156),at=s(2050),ht=s(9711),mt=s(6677),St=!1,It=ht("meta"),xt=0,At=function(kt){gt(kt,It,{value:{objectID:"O"+xt++,weakData:{}}})},Nt=it.exports={enable:function(){Nt.enable=function(){},St=!0;var kt=st.f,Mt=ot([].splice),bt={};bt[It]=1,kt(bt).length&&(st.f=function(Bt){for(var Ht=kt(Bt),Wt=0,nn=Ht.length;Wt<nn;Wt++)if(Ht[Wt]===It){Mt(Ht,Wt,1);break}return Ht},tt({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:ft.f}))},fastKey:function(kt,Mt){if(!yt(kt))return typeof kt=="symbol"?kt:(typeof kt=="string"?"S":"P")+kt;if(!pt(kt,It)){if(!at(kt))return"F";if(!Mt)return"E";At(kt)}return kt[It].objectID},getWeakData:function(kt,Mt){if(!pt(kt,It)){if(!at(kt))return!0;if(!Mt)return!1;At(kt)}return kt[It].weakData},onFreeze:function(kt){return mt&&St&&at(kt)&&!pt(kt,It)&&At(kt),kt}};ct[It]=!0},9909:(it,ut,s)=>{var tt,ot,ct,yt=s(8536),pt=s(7854),gt=s(1702),st=s(111),ft=s(8880),at=s(2597),ht=s(5465),mt=s(6200),St=s(3501),It="Object already initialized",xt=pt.TypeError,At=pt.WeakMap;if(yt||ht.state){var Nt=ht.state||(ht.state=new At),kt=gt(Nt.get),Mt=gt(Nt.has),bt=gt(Nt.set);tt=function(Ht,Wt){if(Mt(Nt,Ht))throw new xt(It);return Wt.facade=Ht,bt(Nt,Ht,Wt),Wt},ot=function(Ht){return kt(Nt,Ht)||{}},ct=function(Ht){return Mt(Nt,Ht)}}else{var Bt=mt("state");St[Bt]=!0,tt=function(Ht,Wt){if(at(Ht,Bt))throw new xt(It);return Wt.facade=Ht,ft(Ht,Bt,Wt),Wt},ot=function(Ht){return at(Ht,Bt)?Ht[Bt]:{}},ct=function(Ht){return at(Ht,Bt)}}it.exports={set:tt,get:ot,has:ct,enforce:function(Ht){return ct(Ht)?ot(Ht):tt(Ht,{})},getterFor:function(Ht){return function(Wt){var nn;if(!st(Wt)||(nn=ot(Wt)).type!==Ht)throw xt("Incompatible receiver, "+Ht+" required");return nn}}}},7659:(it,ut,s)=>{var tt=s(5112),ot=s(7497),ct=tt("iterator"),yt=Array.prototype;it.exports=function(pt){return pt!==void 0&&(ot.Array===pt||yt[ct]===pt)}},3157:(it,ut,s)=>{var tt=s(4326);it.exports=Array.isArray||function(ot){return tt(ot)=="Array"}},614:it=>{it.exports=function(ut){return typeof ut=="function"}},4411:(it,ut,s)=>{var tt=s(1702),ot=s(7293),ct=s(614),yt=s(648),pt=s(5005),gt=s(2788),st=function(){},ft=[],at=pt("Reflect","construct"),ht=/^\s*(?:class|function)\b/,mt=tt(ht.exec),St=!ht.exec(st),It=function(At){if(!ct(At))return!1;try{return at(st,ft,At),!0}catch{return!1}},xt=function(At){if(!ct(At))return!1;switch(yt(At)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return St||!!mt(ht,gt(At))}catch{return!0}};xt.sham=!0,it.exports=!at||ot(function(){var At;return It(It.call)||!It(Object)||!It(function(){At=!0})||At})?xt:It},5032:(it,ut,s)=>{var tt=s(2597);it.exports=function(ot){return ot!==void 0&&(tt(ot,"value")||tt(ot,"writable"))}},4705:(it,ut,s)=>{var tt=s(7293),ot=s(614),ct=/#|\.prototype\./,yt=function(at,ht){var mt=gt[pt(at)];return mt==ft||mt!=st&&(ot(ht)?tt(ht):!!ht)},pt=yt.normalize=function(at){return String(at).replace(ct,".").toLowerCase()},gt=yt.data={},st=yt.NATIVE="N",ft=yt.POLYFILL="P";it.exports=yt},5988:(it,ut,s)=>{var tt=s(111),ot=Math.floor;it.exports=Number.isInteger||function(ct){return!tt(ct)&&isFinite(ct)&&ot(ct)===ct}},111:(it,ut,s)=>{var tt=s(614);it.exports=function(ot){return typeof ot=="object"?ot!==null:tt(ot)}},1913:it=>{it.exports=!1},7850:(it,ut,s)=>{var tt=s(111),ot=s(4326),ct=s(5112)("match");it.exports=function(yt){var pt;return tt(yt)&&((pt=yt[ct])!==void 0?!!pt:ot(yt)=="RegExp")}},2190:(it,ut,s)=>{var tt=s(5005),ot=s(614),ct=s(7976),yt=s(3307),pt=Object;it.exports=yt?function(gt){return typeof gt=="symbol"}:function(gt){var st=tt("Symbol");return ot(st)&&ct(st.prototype,pt(gt))}},408:(it,ut,s)=>{var tt=s(9974),ot=s(6916),ct=s(9670),yt=s(6330),pt=s(7659),gt=s(6244),st=s(7976),ft=s(8554),at=s(1246),ht=s(9212),mt=TypeError,St=function(xt,At){this.stopped=xt,this.result=At},It=St.prototype;it.exports=function(xt,At,Nt){var kt,Mt,bt,Bt,Ht,Wt,nn,gn=Nt&&Nt.that,tn=!(!Nt||!Nt.AS_ENTRIES),Gt=!(!Nt||!Nt.IS_RECORD),fn=!(!Nt||!Nt.IS_ITERATOR),Cn=!(!Nt||!Nt.INTERRUPTED),Tn=tt(At,gn),dn=function(yn){return kt&&ht(kt,"normal",yn),new St(!0,yn)},mn=function(yn){return tn?(ct(yn),Cn?Tn(yn[0],yn[1],dn):Tn(yn[0],yn[1])):Cn?Tn(yn,dn):Tn(yn)};if(Gt)kt=xt.iterator;else if(fn)kt=xt;else{if(!(Mt=at(xt)))throw mt(yt(xt)+" is not iterable");if(pt(Mt)){for(bt=0,Bt=gt(xt);Bt>bt;bt++)if((Ht=mn(xt[bt]))&&st(It,Ht))return Ht;return new St(!1)}kt=ft(xt,Mt)}for(Wt=Gt?xt.next:kt.next;!(nn=ot(Wt,kt)).done;){try{Ht=mn(nn.value)}catch(yn){ht(kt,"throw",yn)}if(typeof Ht=="object"&&Ht&&st(It,Ht))return Ht}return new St(!1)}},9212:(it,ut,s)=>{var tt=s(6916),ot=s(9670),ct=s(8173);it.exports=function(yt,pt,gt){var st,ft;ot(yt);try{if(!(st=ct(yt,"return"))){if(pt==="throw")throw gt;return gt}st=tt(st,yt)}catch(at){ft=!0,st=at}if(pt==="throw")throw gt;if(ft)throw st;return ot(st),gt}},3383:(it,ut,s)=>{var tt,ot,ct,yt=s(7293),pt=s(614),gt=s(30),st=s(9518),ft=s(8052),at=s(5112),ht=s(1913),mt=at("iterator"),St=!1;[].keys&&("next"in(ct=[].keys())?(ot=st(st(ct)))!==Object.prototype&&(tt=ot):St=!0),tt==null||yt(function(){var It={};return tt[mt].call(It)!==It})?tt={}:ht&&(tt=gt(tt)),pt(tt[mt])||ft(tt,mt,function(){return this}),it.exports={IteratorPrototype:tt,BUGGY_SAFARI_ITERATORS:St}},7497:it=>{it.exports={}},6244:(it,ut,s)=>{var tt=s(7466);it.exports=function(ot){return tt(ot.length)}},6339:(it,ut,s)=>{var tt=s(7293),ot=s(614),ct=s(2597),yt=s(9781),pt=s(6530).CONFIGURABLE,gt=s(2788),st=s(9909),ft=st.enforce,at=st.get,ht=Object.defineProperty,mt=yt&&!tt(function(){return ht(function(){},"length",{value:8}).length!==8}),St=String(String).split("String"),It=it.exports=function(xt,At,Nt){String(At).slice(0,7)==="Symbol("&&(At="["+String(At).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),Nt&&Nt.getter&&(At="get "+At),Nt&&Nt.setter&&(At="set "+At),(!ct(xt,"name")||pt&&xt.name!==At)&&(yt?ht(xt,"name",{value:At,configurable:!0}):xt.name=At),mt&&Nt&&ct(Nt,"arity")&&xt.length!==Nt.arity&&ht(xt,"length",{value:Nt.arity});try{Nt&&ct(Nt,"constructor")&&Nt.constructor?yt&&ht(xt,"prototype",{writable:!1}):xt.prototype&&(xt.prototype=void 0)}catch{}var kt=ft(xt);return ct(kt,"source")||(kt.source=St.join(typeof At=="string"?At:"")),xt};Function.prototype.toString=It(function(){return ot(this)&&at(this).source||gt(this)},"toString")},403:it=>{var ut=Math.log,s=Math.LOG10E;it.exports=Math.log10||function(tt){return ut(tt)*s}},4758:it=>{var ut=Math.ceil,s=Math.floor;it.exports=Math.trunc||function(tt){var ot=+tt;return(ot>0?s:ut)(ot)}},5948:(it,ut,s)=>{var tt,ot,ct,yt,pt,gt,st,ft,at=s(7854),ht=s(9974),mt=s(1236).f,St=s(261).set,It=s(6833),xt=s(1528),At=s(1036),Nt=s(2805),kt=at.MutationObserver||at.WebKitMutationObserver,Mt=at.document,bt=at.process,Bt=at.Promise,Ht=mt(at,"queueMicrotask"),Wt=Ht&&Ht.value;Wt||(tt=function(){var nn,gn;for(Nt&&(nn=bt.domain)&&nn.exit();ot;){gn=ot.fn,ot=ot.next;try{gn()}catch(tn){throw ot?yt():ct=void 0,tn}}ct=void 0,nn&&nn.enter()},It||Nt||At||!kt||!Mt?!xt&&Bt&&Bt.resolve?((st=Bt.resolve(void 0)).constructor=Bt,ft=ht(st.then,st),yt=function(){ft(tt)}):Nt?yt=function(){bt.nextTick(tt)}:(St=ht(St,at),yt=function(){St(tt)}):(pt=!0,gt=Mt.createTextNode(""),new kt(tt).observe(gt,{characterData:!0}),yt=function(){gt.data=pt=!pt})),it.exports=Wt||function(nn){var gn={fn:nn,next:void 0};ct&&(ct.next=gn),ot||(ot=gn,yt()),ct=gn}},735:(it,ut,s)=>{var tt=s(133);it.exports=tt&&!!Symbol.for&&!!Symbol.keyFor},133:(it,ut,s)=>{var tt=s(7392),ot=s(7293);it.exports=!!Object.getOwnPropertySymbols&&!ot(function(){var ct=Symbol();return!String(ct)||!(Object(ct)instanceof Symbol)||!Symbol.sham&&tt&&tt<41})},590:(it,ut,s)=>{var tt=s(7293),ot=s(5112),ct=s(1913),yt=ot("iterator");it.exports=!tt(function(){var pt=new URL("b?a=1&b=2&c=3","http://a"),gt=pt.searchParams,st="";return pt.pathname="c%20d",gt.forEach(function(ft,at){gt.delete("b"),st+=at+ft}),ct&&!pt.toJSON||!gt.sort||pt.href!=="http://a/c%20d?a=1&c=3"||gt.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!gt[yt]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://").host!=="xn--e1aybc"||new URL("http://a#").hash!=="#%D0%B1"||st!=="a1c3"||new URL("http://x",void 0).host!=="x"})},8536:(it,ut,s)=>{var tt=s(7854),ot=s(614),ct=s(2788),yt=tt.WeakMap;it.exports=ot(yt)&&/native code/.test(ct(yt))},8523:(it,ut,s)=>{var tt=s(9662),ot=function(ct){var yt,pt;this.promise=new ct(function(gt,st){if(yt!==void 0||pt!==void 0)throw TypeError("Bad Promise constructor");yt=gt,pt=st}),this.resolve=tt(yt),this.reject=tt(pt)};it.exports.f=function(ct){return new ot(ct)}},3929:(it,ut,s)=>{var tt=s(7850),ot=TypeError;it.exports=function(ct){if(tt(ct))throw ot("The method doesn't accept regular expressions");return ct}},3009:(it,ut,s)=>{var tt=s(7854),ot=s(7293),ct=s(1702),yt=s(1340),pt=s(3111).trim,gt=s(1361),st=tt.parseInt,ft=tt.Symbol,at=ft&&ft.iterator,ht=/^[+-]?0x/i,mt=ct(ht.exec),St=st(gt+"08")!==8||st(gt+"0x16")!==22||at&&!ot(function(){st(Object(at))});it.exports=St?function(It,xt){var At=pt(yt(It));return st(At,xt>>>0||(mt(ht,At)?16:10))}:st},1574:(it,ut,s)=>{var tt=s(9781),ot=s(1702),ct=s(6916),yt=s(7293),pt=s(1956),gt=s(5181),st=s(5296),ft=s(7908),at=s(8361),ht=Object.assign,mt=Object.defineProperty,St=ot([].concat);it.exports=!ht||yt(function(){if(tt&&ht({b:1},ht(mt({},"a",{enumerable:!0,get:function(){mt(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var It={},xt={},At=Symbol(),Nt="abcdefghijklmnopqrst";return It[At]=7,Nt.split("").forEach(function(kt){xt[kt]=kt}),ht({},It)[At]!=7||pt(ht({},xt)).join("")!=Nt})?function(It,xt){for(var At=ft(It),Nt=arguments.length,kt=1,Mt=gt.f,bt=st.f;Nt>kt;)for(var Bt,Ht=at(arguments[kt++]),Wt=Mt?St(pt(Ht),Mt(Ht)):pt(Ht),nn=Wt.length,gn=0;nn>gn;)Bt=Wt[gn++],tt&&!ct(bt,Ht,Bt)||(At[Bt]=Ht[Bt]);return At}:ht},30:(it,ut,s)=>{var tt,ot=s(9670),ct=s(6048),yt=s(748),pt=s(3501),gt=s(490),st=s(317),ft=s(6200)("IE_PROTO"),at=function(){},ht=function(It){return"<script>"+It+"<\/script>"},mt=function(It){It.write(ht("")),It.close();var xt=It.parentWindow.Object;return It=null,xt},St=function(){try{tt=new ActiveXObject("htmlfile")}catch{}var It,xt;St=typeof document<"u"?document.domain&&tt?mt(tt):((xt=st("iframe")).style.display="none",gt.appendChild(xt),xt.src="javascript:",(It=xt.contentWindow.document).open(),It.write(ht("document.F=Object")),It.close(),It.F):mt(tt);for(var At=yt.length;At--;)delete St.prototype[yt[At]];return St()};pt[ft]=!0,it.exports=Object.create||function(It,xt){var At;return It!==null?(at.prototype=ot(It),At=new at,at.prototype=null,At[ft]=It):At=St(),xt===void 0?At:ct.f(At,xt)}},6048:(it,ut,s)=>{var tt=s(9781),ot=s(3353),ct=s(3070),yt=s(9670),pt=s(5656),gt=s(1956);ut.f=tt&&!ot?Object.defineProperties:function(st,ft){yt(st);for(var at,ht=pt(ft),mt=gt(ft),St=mt.length,It=0;St>It;)ct.f(st,at=mt[It++],ht[at]);return st}},3070:(it,ut,s)=>{var tt=s(9781),ot=s(4664),ct=s(3353),yt=s(9670),pt=s(4948),gt=TypeError,st=Object.defineProperty,ft=Object.getOwnPropertyDescriptor;ut.f=tt?ct?function(at,ht,mt){if(yt(at),ht=pt(ht),yt(mt),typeof at=="function"&&ht==="prototype"&&"value"in mt&&"writable"in mt&&!mt.writable){var St=ft(at,ht);St&&St.writable&&(at[ht]=mt.value,mt={configurable:"configurable"in mt?mt.configurable:St.configurable,enumerable:"enumerable"in mt?mt.enumerable:St.enumerable,writable:!1})}return st(at,ht,mt)}:st:function(at,ht,mt){if(yt(at),ht=pt(ht),yt(mt),ot)try{return st(at,ht,mt)}catch{}if("get"in mt||"set"in mt)throw gt("Accessors not supported");return"value"in mt&&(at[ht]=mt.value),at}},1236:(it,ut,s)=>{var tt=s(9781),ot=s(6916),ct=s(5296),yt=s(9114),pt=s(5656),gt=s(4948),st=s(2597),ft=s(4664),at=Object.getOwnPropertyDescriptor;ut.f=tt?at:function(ht,mt){if(ht=pt(ht),mt=gt(mt),ft)try{return at(ht,mt)}catch{}if(st(ht,mt))return yt(!ot(ct.f,ht,mt),ht[mt])}},1156:(it,ut,s)=>{var tt=s(4326),ot=s(5656),ct=s(8006).f,yt=s(1589),pt=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];it.exports.f=function(gt){return pt&&tt(gt)=="Window"?function(st){try{return ct(st)}catch{return yt(pt)}}(gt):ct(ot(gt))}},8006:(it,ut,s)=>{var tt=s(6324),ot=s(748).concat("length","prototype");ut.f=Object.getOwnPropertyNames||function(ct){return tt(ct,ot)}},5181:(it,ut)=>{ut.f=Object.getOwnPropertySymbols},9518:(it,ut,s)=>{var tt=s(2597),ot=s(614),ct=s(7908),yt=s(6200),pt=s(8544),gt=yt("IE_PROTO"),st=Object,ft=st.prototype;it.exports=pt?st.getPrototypeOf:function(at){var ht=ct(at);if(tt(ht,gt))return ht[gt];var mt=ht.constructor;return ot(mt)&&ht instanceof mt?mt.prototype:ht instanceof st?ft:null}},2050:(it,ut,s)=>{var tt=s(7293),ot=s(111),ct=s(4326),yt=s(7556),pt=Object.isExtensible,gt=tt(function(){});it.exports=gt||yt?function(st){return!!ot(st)&&(!yt||ct(st)!="ArrayBuffer")&&(!pt||pt(st))}:pt},7976:(it,ut,s)=>{var tt=s(1702);it.exports=tt({}.isPrototypeOf)},6324:(it,ut,s)=>{var tt=s(1702),ot=s(2597),ct=s(5656),yt=s(1318).indexOf,pt=s(3501),gt=tt([].push);it.exports=function(st,ft){var at,ht=ct(st),mt=0,St=[];for(at in ht)!ot(pt,at)&&ot(ht,at)&&gt(St,at);for(;ft.length>mt;)ot(ht,at=ft[mt++])&&(~yt(St,at)||gt(St,at));return St}},1956:(it,ut,s)=>{var tt=s(6324),ot=s(748);it.exports=Object.keys||function(ct){return tt(ct,ot)}},5296:(it,ut)=>{var s={}.propertyIsEnumerable,tt=Object.getOwnPropertyDescriptor,ot=tt&&!s.call({1:2},1);ut.f=ot?function(ct){var yt=tt(this,ct);return!!yt&&yt.enumerable}:s},7674:(it,ut,s)=>{var tt=s(1702),ot=s(9670),ct=s(6077);it.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var yt,pt=!1,gt={};try{(yt=tt(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(gt,[]),pt=gt instanceof Array}catch{}return function(st,ft){return ot(st),ct(ft),pt?yt(st,ft):st.__proto__=ft,st}}():void 0)},4699:(it,ut,s)=>{var tt=s(9781),ot=s(1702),ct=s(1956),yt=s(5656),pt=ot(s(5296).f),gt=ot([].push),st=function(ft){return function(at){for(var ht,mt=yt(at),St=ct(mt),It=St.length,xt=0,At=[];It>xt;)ht=St[xt++],tt&&!pt(mt,ht)||gt(At,ft?[ht,mt[ht]]:mt[ht]);return At}};it.exports={entries:st(!0),values:st(!1)}},288:(it,ut,s)=>{var tt=s(1694),ot=s(648);it.exports=tt?{}.toString:function(){return"[object "+ot(this)+"]"}},2140:(it,ut,s)=>{var tt=s(6916),ot=s(614),ct=s(111),yt=TypeError;it.exports=function(pt,gt){var st,ft;if(gt==="string"&&ot(st=pt.toString)&&!ct(ft=tt(st,pt))||ot(st=pt.valueOf)&&!ct(ft=tt(st,pt))||gt!=="string"&&ot(st=pt.toString)&&!ct(ft=tt(st,pt)))return ft;throw yt("Can't convert object to primitive value")}},3887:(it,ut,s)=>{var tt=s(5005),ot=s(1702),ct=s(8006),yt=s(5181),pt=s(9670),gt=ot([].concat);it.exports=tt("Reflect","ownKeys")||function(st){var ft=ct.f(pt(st)),at=yt.f;return at?gt(ft,at(st)):ft}},857:(it,ut,s)=>{var tt=s(7854);it.exports=tt},2534:it=>{it.exports=function(ut){try{return{error:!1,value:ut()}}catch(s){return{error:!0,value:s}}}},3702:(it,ut,s)=>{var tt=s(7854),ot=s(2492),ct=s(614),yt=s(4705),pt=s(2788),gt=s(5112),st=s(7871),ft=s(1913),at=s(7392),ht=ot&&ot.prototype,mt=gt("species"),St=!1,It=ct(tt.PromiseRejectionEvent),xt=yt("Promise",function(){var At=pt(ot),Nt=At!==String(ot);if(!Nt&&at===66||ft&&(!ht.catch||!ht.finally))return!0;if(at>=51&&/native code/.test(At))return!1;var kt=new ot(function(bt){bt(1)}),Mt=function(bt){bt(function(){},function(){})};return(kt.constructor={})[mt]=Mt,!(St=kt.then(function(){})instanceof Mt)||!Nt&&st&&!It});it.exports={CONSTRUCTOR:xt,REJECTION_EVENT:It,SUBCLASSING:St}},2492:(it,ut,s)=>{var tt=s(7854);it.exports=tt.Promise},9478:(it,ut,s)=>{var tt=s(9670),ot=s(111),ct=s(8523);it.exports=function(yt,pt){if(tt(yt),ot(pt)&&pt.constructor===yt)return pt;var gt=ct.f(yt);return(0,gt.resolve)(pt),gt.promise}},612:(it,ut,s)=>{var tt=s(2492),ot=s(7072),ct=s(3702).CONSTRUCTOR;it.exports=ct||!ot(function(yt){tt.all(yt).then(void 0,function(){})})},2626:(it,ut,s)=>{var tt=s(3070).f;it.exports=function(ot,ct,yt){yt in ot||tt(ot,yt,{configurable:!0,get:function(){return ct[yt]},set:function(pt){ct[yt]=pt}})}},8572:it=>{var ut=function(){this.head=null,this.tail=null};ut.prototype={add:function(s){var tt={item:s,next:null};this.head?this.tail.next=tt:this.head=tt,this.tail=tt},get:function(){var s=this.head;if(s)return this.head=s.next,this.tail===s&&(this.tail=null),s.item}},it.exports=ut},7651:(it,ut,s)=>{var tt=s(6916),ot=s(9670),ct=s(614),yt=s(4326),pt=s(2261),gt=TypeError;it.exports=function(st,ft){var at=st.exec;if(ct(at)){var ht=tt(at,st,ft);return ht!==null&&ot(ht),ht}if(yt(st)==="RegExp")return tt(pt,st,ft);throw gt("RegExp#exec called on incompatible receiver")}},2261:(it,ut,s)=>{var tt,ot,ct=s(6916),yt=s(1702),pt=s(1340),gt=s(7066),st=s(2999),ft=s(2309),at=s(30),ht=s(9909).get,mt=s(9441),St=s(7168),It=ft("native-string-replace",String.prototype.replace),xt=RegExp.prototype.exec,At=xt,Nt=yt("".charAt),kt=yt("".indexOf),Mt=yt("".replace),bt=yt("".slice),Bt=(ot=/b*/g,ct(xt,tt=/a/,"a"),ct(xt,ot,"a"),tt.lastIndex!==0||ot.lastIndex!==0),Ht=st.BROKEN_CARET,Wt=/()??/.exec("")[1]!==void 0;(Bt||Wt||Ht||mt||St)&&(At=function(nn){var gn,tn,Gt,fn,Cn,Tn,dn,mn=this,yn=ht(mn),pn=pt(nn),In=yn.raw;if(In)return In.lastIndex=mn.lastIndex,gn=ct(At,In,pn),mn.lastIndex=In.lastIndex,gn;var On=yn.groups,_n=Ht&&mn.sticky,Mn=ct(gt,mn),Nn=mn.source,wn=0,Pn=pn;if(_n&&(Mn=Mt(Mn,"y",""),kt(Mn,"g")===-1&&(Mn+="g"),Pn=bt(pn,mn.lastIndex),mn.lastIndex>0&&(!mn.multiline||mn.multiline&&Nt(pn,mn.lastIndex-1)!==`
`)&&(Nn="(?: "+Nn+")",Pn=" "+Pn,wn++),tn=new RegExp("^(?:"+Nn+")",Mn)),Wt&&(tn=new RegExp("^"+Nn+"$(?!\\s)",Mn)),Bt&&(Gt=mn.lastIndex),fn=ct(xt,_n?tn:mn,Pn),_n?fn?(fn.input=bt(fn.input,wn),fn[0]=bt(fn[0],wn),fn.index=mn.lastIndex,mn.lastIndex+=fn[0].length):mn.lastIndex=0:Bt&&fn&&(mn.lastIndex=mn.global?fn.index+fn[0].length:Gt),Wt&&fn&&fn.length>1&&ct(It,fn[0],tn,function(){for(Cn=1;Cn<arguments.length-2;Cn++)arguments[Cn]===void 0&&(fn[Cn]=void 0)}),fn&&On)for(fn.groups=Tn=at(null),Cn=0;Cn<On.length;Cn++)Tn[(dn=On[Cn])[0]]=fn[dn[1]];return fn}),it.exports=At},7066:(it,ut,s)=>{var tt=s(9670);it.exports=function(){var ot=tt(this),ct="";return ot.hasIndices&&(ct+="d"),ot.global&&(ct+="g"),ot.ignoreCase&&(ct+="i"),ot.multiline&&(ct+="m"),ot.dotAll&&(ct+="s"),ot.unicode&&(ct+="u"),ot.unicodeSets&&(ct+="v"),ot.sticky&&(ct+="y"),ct}},4706:(it,ut,s)=>{var tt=s(6916),ot=s(2597),ct=s(7976),yt=s(7066),pt=RegExp.prototype;it.exports=function(gt){var st=gt.flags;return st!==void 0||"flags"in pt||ot(gt,"flags")||!ct(pt,gt)?st:tt(yt,gt)}},2999:(it,ut,s)=>{var tt=s(7293),ot=s(7854).RegExp,ct=tt(function(){var gt=ot("a","y");return gt.lastIndex=2,gt.exec("abcd")!=null}),yt=ct||tt(function(){return!ot("a","y").sticky}),pt=ct||tt(function(){var gt=ot("^r","gy");return gt.lastIndex=2,gt.exec("str")!=null});it.exports={BROKEN_CARET:pt,MISSED_STICKY:yt,UNSUPPORTED_Y:ct}},9441:(it,ut,s)=>{var tt=s(7293),ot=s(7854).RegExp;it.exports=tt(function(){var ct=ot(".","s");return!(ct.dotAll&&ct.exec(`
`)&&ct.flags==="s")})},7168:(it,ut,s)=>{var tt=s(7293),ot=s(7854).RegExp;it.exports=tt(function(){var ct=ot("(?<a>b)","g");return ct.exec("b").groups.a!=="b"||"b".replace(ct,"$<a>c")!=="bc"})},4488:it=>{var ut=TypeError;it.exports=function(s){if(s==null)throw ut("Can't call method on "+s);return s}},1150:it=>{it.exports=Object.is||function(ut,s){return ut===s?ut!==0||1/ut==1/s:ut!=ut&&s!=s}},7152:(it,ut,s)=>{var tt=s(7854),ot=s(2104),ct=s(614),yt=s(8113),pt=s(206),gt=s(8053),st=/MSIE .\./.test(yt),ft=tt.Function,at=function(ht){return st?function(mt,St){var It=gt(arguments.length,1)>2,xt=ct(mt)?mt:ft(mt),At=It?pt(arguments,2):void 0;return ht(It?function(){ot(xt,this,At)}:xt,St)}:ht};it.exports={setTimeout:at(tt.setTimeout),setInterval:at(tt.setInterval)}},6340:(it,ut,s)=>{var tt=s(5005),ot=s(3070),ct=s(5112),yt=s(9781),pt=ct("species");it.exports=function(gt){var st=tt(gt),ft=ot.f;yt&&st&&!st[pt]&&ft(st,pt,{configurable:!0,get:function(){return this}})}},8003:(it,ut,s)=>{var tt=s(3070).f,ot=s(2597),ct=s(5112)("toStringTag");it.exports=function(yt,pt,gt){yt&&!gt&&(yt=yt.prototype),yt&&!ot(yt,ct)&&tt(yt,ct,{configurable:!0,value:pt})}},6200:(it,ut,s)=>{var tt=s(2309),ot=s(9711),ct=tt("keys");it.exports=function(yt){return ct[yt]||(ct[yt]=ot(yt))}},5465:(it,ut,s)=>{var tt=s(7854),ot=s(3072),ct="__core-js_shared__",yt=tt[ct]||ot(ct,{});it.exports=yt},2309:(it,ut,s)=>{var tt=s(1913),ot=s(5465);(it.exports=function(ct,yt){return ot[ct]||(ot[ct]=yt!==void 0?yt:{})})("versions",[]).push({version:"3.23.4",mode:tt?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.4/LICENSE",source:"https://github.com/zloirock/core-js"})},6707:(it,ut,s)=>{var tt=s(9670),ot=s(9483),ct=s(5112)("species");it.exports=function(yt,pt){var gt,st=tt(yt).constructor;return st===void 0||(gt=tt(st)[ct])==null?pt:ot(gt)}},8710:(it,ut,s)=>{var tt=s(1702),ot=s(9303),ct=s(1340),yt=s(4488),pt=tt("".charAt),gt=tt("".charCodeAt),st=tt("".slice),ft=function(at){return function(ht,mt){var St,It,xt=ct(yt(ht)),At=ot(mt),Nt=xt.length;return At<0||At>=Nt?at?"":void 0:(St=gt(xt,At))<55296||St>56319||At+1===Nt||(It=gt(xt,At+1))<56320||It>57343?at?pt(xt,At):St:at?st(xt,At,At+2):It-56320+(St-55296<<10)+65536}};it.exports={codeAt:ft(!1),charAt:ft(!0)}},6650:(it,ut,s)=>{var tt=s(1702),ot=s(7466),ct=s(1340),yt=s(8415),pt=s(4488),gt=tt(yt),st=tt("".slice),ft=Math.ceil,at=function(ht){return function(mt,St,It){var xt,At,Nt=ct(pt(mt)),kt=ot(St),Mt=Nt.length,bt=It===void 0?" ":ct(It);return kt<=Mt||bt==""?Nt:((At=gt(bt,ft((xt=kt-Mt)/bt.length))).length>xt&&(At=st(At,0,xt)),ht?Nt+At:At+Nt)}};it.exports={start:at(!1),end:at(!0)}},3197:(it,ut,s)=>{var tt=s(1702),ot=2147483647,ct=/[^\0-\u007E]/,yt=/[.\u3002\uFF0E\uFF61]/g,pt="Overflow: input needs wider integers to process",gt=RangeError,st=tt(yt.exec),ft=Math.floor,at=String.fromCharCode,ht=tt("".charCodeAt),mt=tt([].join),St=tt([].push),It=tt("".replace),xt=tt("".split),At=tt("".toLowerCase),Nt=function(bt){return bt+22+75*(bt<26)},kt=function(bt,Bt,Ht){var Wt=0;for(bt=Ht?ft(bt/700):bt>>1,bt+=ft(bt/Bt);bt>455;)bt=ft(bt/35),Wt+=36;return ft(Wt+36*bt/(bt+38))},Mt=function(bt){var Bt=[];bt=function(_n){for(var Mn=[],Nn=0,wn=_n.length;Nn<wn;){var Pn=ht(_n,Nn++);if(Pn>=55296&&Pn<=56319&&Nn<wn){var Fn=ht(_n,Nn++);(64512&Fn)==56320?St(Mn,((1023&Pn)<<10)+(1023&Fn)+65536):(St(Mn,Pn),Nn--)}else St(Mn,Pn)}return Mn}(bt);var Ht,Wt,nn=bt.length,gn=128,tn=0,Gt=72;for(Ht=0;Ht<bt.length;Ht++)(Wt=bt[Ht])<128&&St(Bt,at(Wt));var fn=Bt.length,Cn=fn;for(fn&&St(Bt,"-");Cn<nn;){var Tn=ot;for(Ht=0;Ht<bt.length;Ht++)(Wt=bt[Ht])>=gn&&Wt<Tn&&(Tn=Wt);var dn=Cn+1;if(Tn-gn>ft((ot-tn)/dn))throw gt(pt);for(tn+=(Tn-gn)*dn,gn=Tn,Ht=0;Ht<bt.length;Ht++){if((Wt=bt[Ht])<gn&&++tn>ot)throw gt(pt);if(Wt==gn){for(var mn=tn,yn=36;;){var pn=yn<=Gt?1:yn>=Gt+26?26:yn-Gt;if(mn<pn)break;var In=mn-pn,On=36-pn;St(Bt,at(Nt(pn+In%On))),mn=ft(In/On),yn+=36}St(Bt,at(Nt(mn))),Gt=kt(tn,dn,Cn==fn),tn=0,Cn++}}tn++,gn++}return mt(Bt,"")};it.exports=function(bt){var Bt,Ht,Wt=[],nn=xt(It(At(bt),yt,"."),".");for(Bt=0;Bt<nn.length;Bt++)Ht=nn[Bt],St(Wt,st(ct,Ht)?"xn--"+Mt(Ht):Ht);return mt(Wt,".")}},8415:(it,ut,s)=>{var tt=s(9303),ot=s(1340),ct=s(4488),yt=RangeError;it.exports=function(pt){var gt=ot(ct(this)),st="",ft=tt(pt);if(ft<0||ft==1/0)throw yt("Wrong number of repetitions");for(;ft>0;(ft>>>=1)&&(gt+=gt))1&ft&&(st+=gt);return st}},3111:(it,ut,s)=>{var tt=s(1702),ot=s(4488),ct=s(1340),yt=s(1361),pt=tt("".replace),gt="["+yt+"]",st=RegExp("^"+gt+gt+"*"),ft=RegExp(gt+gt+"*$"),at=function(ht){return function(mt){var St=ct(ot(mt));return 1&ht&&(St=pt(St,st,"")),2&ht&&(St=pt(St,ft,"")),St}};it.exports={start:at(1),end:at(2),trim:at(3)}},6532:(it,ut,s)=>{var tt=s(6916),ot=s(5005),ct=s(5112),yt=s(8052);it.exports=function(){var pt=ot("Symbol"),gt=pt&&pt.prototype,st=gt&&gt.valueOf,ft=ct("toPrimitive");gt&&!gt[ft]&&yt(gt,ft,function(at){return tt(st,this)},{arity:1})}},261:(it,ut,s)=>{var tt,ot,ct,yt,pt=s(7854),gt=s(2104),st=s(9974),ft=s(614),at=s(2597),ht=s(7293),mt=s(490),St=s(206),It=s(317),xt=s(8053),At=s(6833),Nt=s(2805),kt=pt.setImmediate,Mt=pt.clearImmediate,bt=pt.process,Bt=pt.Dispatch,Ht=pt.Function,Wt=pt.MessageChannel,nn=pt.String,gn=0,tn={};try{tt=pt.location}catch{}var Gt=function(dn){if(at(tn,dn)){var mn=tn[dn];delete tn[dn],mn()}},fn=function(dn){return function(){Gt(dn)}},Cn=function(dn){Gt(dn.data)},Tn=function(dn){pt.postMessage(nn(dn),tt.protocol+"//"+tt.host)};kt&&Mt||(kt=function(dn){xt(arguments.length,1);var mn=ft(dn)?dn:Ht(dn),yn=St(arguments,1);return tn[++gn]=function(){gt(mn,void 0,yn)},ot(gn),gn},Mt=function(dn){delete tn[dn]},Nt?ot=function(dn){bt.nextTick(fn(dn))}:Bt&&Bt.now?ot=function(dn){Bt.now(fn(dn))}:Wt&&!At?(yt=(ct=new Wt).port2,ct.port1.onmessage=Cn,ot=st(yt.postMessage,yt)):pt.addEventListener&&ft(pt.postMessage)&&!pt.importScripts&&tt&&tt.protocol!=="file:"&&!ht(Tn)?(ot=Tn,pt.addEventListener("message",Cn,!1)):ot="onreadystatechange"in It("script")?function(dn){mt.appendChild(It("script")).onreadystatechange=function(){mt.removeChild(this),Gt(dn)}}:function(dn){setTimeout(fn(dn),0)}),it.exports={set:kt,clear:Mt}},863:(it,ut,s)=>{var tt=s(1702);it.exports=tt(1 .valueOf)},1400:(it,ut,s)=>{var tt=s(9303),ot=Math.max,ct=Math.min;it.exports=function(yt,pt){var gt=tt(yt);return gt<0?ot(gt+pt,0):ct(gt,pt)}},4599:(it,ut,s)=>{var tt=s(7593),ot=TypeError;it.exports=function(ct){var yt=tt(ct,"number");if(typeof yt=="number")throw ot("Can't convert number to bigint");return BigInt(yt)}},7067:(it,ut,s)=>{var tt=s(9303),ot=s(7466),ct=RangeError;it.exports=function(yt){if(yt===void 0)return 0;var pt=tt(yt),gt=ot(pt);if(pt!==gt)throw ct("Wrong length or index");return gt}},5656:(it,ut,s)=>{var tt=s(8361),ot=s(4488);it.exports=function(ct){return tt(ot(ct))}},9303:(it,ut,s)=>{var tt=s(4758);it.exports=function(ot){var ct=+ot;return ct!=ct||ct===0?0:tt(ct)}},7466:(it,ut,s)=>{var tt=s(9303),ot=Math.min;it.exports=function(ct){return ct>0?ot(tt(ct),9007199254740991):0}},7908:(it,ut,s)=>{var tt=s(4488),ot=Object;it.exports=function(ct){return ot(tt(ct))}},4590:(it,ut,s)=>{var tt=s(3002),ot=RangeError;it.exports=function(ct,yt){var pt=tt(ct);if(pt%yt)throw ot("Wrong offset");return pt}},3002:(it,ut,s)=>{var tt=s(9303),ot=RangeError;it.exports=function(ct){var yt=tt(ct);if(yt<0)throw ot("The argument can't be less than 0");return yt}},7593:(it,ut,s)=>{var tt=s(6916),ot=s(111),ct=s(2190),yt=s(8173),pt=s(2140),gt=s(5112),st=TypeError,ft=gt("toPrimitive");it.exports=function(at,ht){if(!ot(at)||ct(at))return at;var mt,St=yt(at,ft);if(St){if(ht===void 0&&(ht="default"),mt=tt(St,at,ht),!ot(mt)||ct(mt))return mt;throw st("Can't convert object to primitive value")}return ht===void 0&&(ht="number"),pt(at,ht)}},4948:(it,ut,s)=>{var tt=s(7593),ot=s(2190);it.exports=function(ct){var yt=tt(ct,"string");return ot(yt)?yt:yt+""}},1694:(it,ut,s)=>{var tt={};tt[s(5112)("toStringTag")]="z",it.exports=String(tt)==="[object z]"},1340:(it,ut,s)=>{var tt=s(648),ot=String;it.exports=function(ct){if(tt(ct)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return ot(ct)}},6330:it=>{var ut=String;it.exports=function(s){try{return ut(s)}catch{return"Object"}}},9843:(it,ut,s)=>{var tt=s(2109),ot=s(7854),ct=s(6916),yt=s(9781),pt=s(3832),gt=s(260),st=s(3331),ft=s(5787),at=s(9114),ht=s(8880),mt=s(5988),St=s(7466),It=s(7067),xt=s(4590),At=s(4948),Nt=s(2597),kt=s(648),Mt=s(111),bt=s(2190),Bt=s(30),Ht=s(7976),Wt=s(7674),nn=s(8006).f,gn=s(7321),tn=s(2092).forEach,Gt=s(6340),fn=s(3070),Cn=s(1236),Tn=s(9909),dn=s(9587),mn=Tn.get,yn=Tn.set,pn=Tn.enforce,In=fn.f,On=Cn.f,_n=Math.round,Mn=ot.RangeError,Nn=st.ArrayBuffer,wn=Nn.prototype,Pn=st.DataView,Fn=gt.NATIVE_ARRAY_BUFFER_VIEWS,ar=gt.TYPED_ARRAY_TAG,Yn=gt.TypedArray,Xn=gt.TypedArrayPrototype,tr=gt.aTypedArrayConstructor,cn=gt.isTypedArray,Hn="BYTES_PER_ELEMENT",Qn="Wrong length",or=function(vn,kn){tr(vn);for(var qt=0,Rt=kn.length,nt=new vn(Rt);Rt>qt;)nt[qt]=kn[qt++];return nt},Wn=function(vn,kn){In(vn,kn,{get:function(){return mn(this)[kn]}})},ir=function(vn){var kn;return Ht(wn,vn)||(kn=kt(vn))=="ArrayBuffer"||kn=="SharedArrayBuffer"},nr=function(vn,kn){return cn(vn)&&!bt(kn)&&kn in vn&&mt(+kn)&&kn>=0},xn=function(vn,kn){return kn=At(kn),nr(vn,kn)?at(2,vn[kn]):On(vn,kn)},Un=function(vn,kn,qt){return kn=At(kn),!(nr(vn,kn)&&Mt(qt)&&Nt(qt,"value"))||Nt(qt,"get")||Nt(qt,"set")||qt.configurable||Nt(qt,"writable")&&!qt.writable||Nt(qt,"enumerable")&&!qt.enumerable?In(vn,kn,qt):(vn[kn]=qt.value,vn)};yt?(Fn||(Cn.f=xn,fn.f=Un,Wn(Xn,"buffer"),Wn(Xn,"byteOffset"),Wn(Xn,"byteLength"),Wn(Xn,"length")),tt({target:"Object",stat:!0,forced:!Fn},{getOwnPropertyDescriptor:xn,defineProperty:Un}),it.exports=function(vn,kn,qt){var Rt=vn.match(/\d+$/)[0]/8,nt=vn+(qt?"Clamped":"")+"Array",vt="get"+vn,Tt="set"+vn,Pt=ot[nt],wt=Pt,Dt=wt&&wt.prototype,Et={},jt=function(en,Kt){In(en,Kt,{get:function(){return function(rn,hn){var an=mn(rn);return an.view[vt](hn*Rt+an.byteOffset,!0)}(this,Kt)},set:function(rn){return function(hn,an,un){var Sn=mn(hn);qt&&(un=(un=_n(un))<0?0:un>255?255:255&un),Sn.view[Tt](an*Rt+Sn.byteOffset,un,!0)}(this,Kt,rn)},enumerable:!0})};Fn?pt&&(wt=kn(function(en,Kt,rn,hn){return ft(en,Dt),dn(Mt(Kt)?ir(Kt)?hn!==void 0?new Pt(Kt,xt(rn,Rt),hn):rn!==void 0?new Pt(Kt,xt(rn,Rt)):new Pt(Kt):cn(Kt)?or(wt,Kt):ct(gn,wt,Kt):new Pt(It(Kt)),en,wt)}),Wt&&Wt(wt,Yn),tn(nn(Pt),function(en){en in wt||ht(wt,en,Pt[en])}),wt.prototype=Dt):(wt=kn(function(en,Kt,rn,hn){ft(en,Dt);var an,un,Sn,En=0,An=0;if(Mt(Kt)){if(!ir(Kt))return cn(Kt)?or(wt,Kt):ct(gn,wt,Kt);an=Kt,An=xt(rn,Rt);var Dn=Kt.byteLength;if(hn===void 0){if(Dn%Rt||(un=Dn-An)<0)throw Mn(Qn)}else if((un=St(hn)*Rt)+An>Dn)throw Mn(Qn);Sn=un/Rt}else Sn=It(Kt),an=new Nn(un=Sn*Rt);for(yn(en,{buffer:an,byteOffset:An,byteLength:un,length:Sn,view:new Pn(an)});En<Sn;)jt(en,En++)}),Wt&&Wt(wt,Yn),Dt=wt.prototype=Bt(Xn)),Dt.constructor!==wt&&ht(Dt,"constructor",wt),pn(Dt).TypedArrayConstructor=wt,ar&&ht(Dt,ar,nt);var Yt=wt!=Pt;Et[nt]=wt,tt({global:!0,constructor:!0,forced:Yt,sham:!Fn},Et),Hn in wt||ht(wt,Hn,Rt),Hn in Dt||ht(Dt,Hn,Rt),Gt(nt)}):it.exports=function(){}},3832:(it,ut,s)=>{var tt=s(7854),ot=s(7293),ct=s(7072),yt=s(260).NATIVE_ARRAY_BUFFER_VIEWS,pt=tt.ArrayBuffer,gt=tt.Int8Array;it.exports=!yt||!ot(function(){gt(1)})||!ot(function(){new gt(-1)})||!ct(function(st){new gt,new gt(null),new gt(1.5),new gt(st)},!0)||ot(function(){return new gt(new pt(2),1,void 0).length!==1})},3074:(it,ut,s)=>{var tt=s(7745),ot=s(6304);it.exports=function(ct,yt){return tt(ot(ct),yt)}},7321:(it,ut,s)=>{var tt=s(9974),ot=s(6916),ct=s(9483),yt=s(7908),pt=s(6244),gt=s(8554),st=s(1246),ft=s(7659),at=s(260).aTypedArrayConstructor;it.exports=function(ht){var mt,St,It,xt,At,Nt,kt=ct(this),Mt=yt(ht),bt=arguments.length,Bt=bt>1?arguments[1]:void 0,Ht=Bt!==void 0,Wt=st(Mt);if(Wt&&!ft(Wt))for(Nt=(At=gt(Mt,Wt)).next,Mt=[];!(xt=ot(Nt,At)).done;)Mt.push(xt.value);for(Ht&&bt>2&&(Bt=tt(Bt,arguments[2])),St=pt(Mt),It=new(at(kt))(St),mt=0;St>mt;mt++)It[mt]=Ht?Bt(Mt[mt],mt):Mt[mt];return It}},6304:(it,ut,s)=>{var tt=s(260),ot=s(6707),ct=tt.aTypedArrayConstructor,yt=tt.getTypedArrayConstructor;it.exports=function(pt){return ct(ot(pt,yt(pt)))}},9711:(it,ut,s)=>{var tt=s(1702),ot=0,ct=Math.random(),yt=tt(1 .toString);it.exports=function(pt){return"Symbol("+(pt===void 0?"":pt)+")_"+yt(++ot+ct,36)}},3307:(it,ut,s)=>{var tt=s(133);it.exports=tt&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3353:(it,ut,s)=>{var tt=s(9781),ot=s(7293);it.exports=tt&&ot(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},8053:it=>{var ut=TypeError;it.exports=function(s,tt){if(s<tt)throw ut("Not enough arguments");return s}},6061:(it,ut,s)=>{var tt=s(5112);ut.f=tt},5112:(it,ut,s)=>{var tt=s(7854),ot=s(2309),ct=s(2597),yt=s(9711),pt=s(133),gt=s(3307),st=ot("wks"),ft=tt.Symbol,at=ft&&ft.for,ht=gt?ft:ft&&ft.withoutSetter||yt;it.exports=function(mt){if(!ct(st,mt)||!pt&&typeof st[mt]!="string"){var St="Symbol."+mt;pt&&ct(ft,mt)?st[mt]=ft[mt]:st[mt]=gt&&at?at(St):ht(St)}return st[mt]}},1361:it=>{it.exports=`	
\v\f\r \u2028\u2029\uFEFF`},8264:(it,ut,s)=>{var tt=s(2109),ot=s(7854),ct=s(3331),yt=s(6340),pt=ct.ArrayBuffer;tt({global:!0,constructor:!0,forced:ot.ArrayBuffer!==pt},{ArrayBuffer:pt}),yt("ArrayBuffer")},9575:(it,ut,s)=>{var tt=s(2109),ot=s(1702),ct=s(7293),yt=s(3331),pt=s(9670),gt=s(1400),st=s(7466),ft=s(6707),at=yt.ArrayBuffer,ht=yt.DataView,mt=ht.prototype,St=ot(at.prototype.slice),It=ot(mt.getUint8),xt=ot(mt.setUint8);tt({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:ct(function(){return!new at(2).slice(1,void 0).byteLength})},{slice:function(At,Nt){if(St&&Nt===void 0)return St(pt(this),At);for(var kt=pt(this).byteLength,Mt=gt(At,kt),bt=gt(Nt===void 0?kt:Nt,kt),Bt=new(ft(this,at))(st(bt-Mt)),Ht=new ht(this),Wt=new ht(Bt),nn=0;Mt<bt;)xt(Wt,nn++,It(Ht,Mt++));return Bt}})},2222:(it,ut,s)=>{var tt=s(2109),ot=s(7293),ct=s(3157),yt=s(111),pt=s(7908),gt=s(6244),st=s(7207),ft=s(6135),at=s(5417),ht=s(1194),mt=s(5112),St=s(7392),It=mt("isConcatSpreadable"),xt=St>=51||!ot(function(){var kt=[];return kt[It]=!1,kt.concat()[0]!==kt}),At=ht("concat"),Nt=function(kt){if(!yt(kt))return!1;var Mt=kt[It];return Mt!==void 0?!!Mt:ct(kt)};tt({target:"Array",proto:!0,arity:1,forced:!xt||!At},{concat:function(kt){var Mt,bt,Bt,Ht,Wt,nn=pt(this),gn=at(nn,0),tn=0;for(Mt=-1,Bt=arguments.length;Mt<Bt;Mt++)if(Nt(Wt=Mt===-1?nn:arguments[Mt]))for(Ht=gt(Wt),st(tn+Ht),bt=0;bt<Ht;bt++,tn++)bt in Wt&&ft(gn,tn,Wt[bt]);else st(tn+1),ft(gn,tn++,Wt);return gn.length=tn,gn}})},3290:(it,ut,s)=>{var tt=s(2109),ot=s(1285),ct=s(1223);tt({target:"Array",proto:!0},{fill:ot}),ct("fill")},7327:(it,ut,s)=>{var tt=s(2109),ot=s(2092).filter;tt({target:"Array",proto:!0,forced:!s(1194)("filter")},{filter:function(ct){return ot(this,ct,arguments.length>1?arguments[1]:void 0)}})},4553:(it,ut,s)=>{var tt=s(2109),ot=s(2092).findIndex,ct=s(1223),yt="findIndex",pt=!0;yt in[]&&Array(1).findIndex(function(){pt=!1}),tt({target:"Array",proto:!0,forced:pt},{findIndex:function(gt){return ot(this,gt,arguments.length>1?arguments[1]:void 0)}}),ct(yt)},9826:(it,ut,s)=>{var tt=s(2109),ot=s(2092).find,ct=s(1223),yt="find",pt=!0;yt in[]&&Array(1).find(function(){pt=!1}),tt({target:"Array",proto:!0,forced:pt},{find:function(gt){return ot(this,gt,arguments.length>1?arguments[1]:void 0)}}),ct(yt)},9554:(it,ut,s)=>{var tt=s(2109),ot=s(8533);tt({target:"Array",proto:!0,forced:[].forEach!=ot},{forEach:ot})},1038:(it,ut,s)=>{var tt=s(2109),ot=s(8457);tt({target:"Array",stat:!0,forced:!s(7072)(function(ct){Array.from(ct)})},{from:ot})},6699:(it,ut,s)=>{var tt=s(2109),ot=s(1318).includes,ct=s(7293),yt=s(1223);tt({target:"Array",proto:!0,forced:ct(function(){return!Array(1).includes()})},{includes:function(pt){return ot(this,pt,arguments.length>1?arguments[1]:void 0)}}),yt("includes")},2772:(it,ut,s)=>{var tt=s(2109),ot=s(1702),ct=s(1318).indexOf,yt=s(9341),pt=ot([].indexOf),gt=!!pt&&1/pt([1],1,-0)<0,st=yt("indexOf");tt({target:"Array",proto:!0,forced:gt||!st},{indexOf:function(ft){var at=arguments.length>1?arguments[1]:void 0;return gt?pt(this,ft,at)||0:ct(this,ft,at)}})},9753:(it,ut,s)=>{s(2109)({target:"Array",stat:!0},{isArray:s(3157)})},6992:(it,ut,s)=>{var tt=s(5656),ot=s(1223),ct=s(7497),yt=s(9909),pt=s(3070).f,gt=s(654),st=s(1913),ft=s(9781),at="Array Iterator",ht=yt.set,mt=yt.getterFor(at);it.exports=gt(Array,"Array",function(It,xt){ht(this,{type:at,target:tt(It),index:0,kind:xt})},function(){var It=mt(this),xt=It.target,At=It.kind,Nt=It.index++;return!xt||Nt>=xt.length?(It.target=void 0,{value:void 0,done:!0}):At=="keys"?{value:Nt,done:!1}:At=="values"?{value:xt[Nt],done:!1}:{value:[Nt,xt[Nt]],done:!1}},"values");var St=ct.Arguments=ct.Array;if(ot("keys"),ot("values"),ot("entries"),!st&&ft&&St.name!=="values")try{pt(St,"name",{value:"values"})}catch{}},9600:(it,ut,s)=>{var tt=s(2109),ot=s(1702),ct=s(8361),yt=s(5656),pt=s(9341),gt=ot([].join),st=ct!=Object,ft=pt("join",",");tt({target:"Array",proto:!0,forced:st||!ft},{join:function(at){return gt(yt(this),at===void 0?",":at)}})},4986:(it,ut,s)=>{var tt=s(2109),ot=s(6583);tt({target:"Array",proto:!0,forced:ot!==[].lastIndexOf},{lastIndexOf:ot})},1249:(it,ut,s)=>{var tt=s(2109),ot=s(2092).map;tt({target:"Array",proto:!0,forced:!s(1194)("map")},{map:function(ct){return ot(this,ct,arguments.length>1?arguments[1]:void 0)}})},7042:(it,ut,s)=>{var tt=s(2109),ot=s(3157),ct=s(4411),yt=s(111),pt=s(1400),gt=s(6244),st=s(5656),ft=s(6135),at=s(5112),ht=s(1194),mt=s(206),St=ht("slice"),It=at("species"),xt=Array,At=Math.max;tt({target:"Array",proto:!0,forced:!St},{slice:function(Nt,kt){var Mt,bt,Bt,Ht=st(this),Wt=gt(Ht),nn=pt(Nt,Wt),gn=pt(kt===void 0?Wt:kt,Wt);if(ot(Ht)&&(Mt=Ht.constructor,(ct(Mt)&&(Mt===xt||ot(Mt.prototype))||yt(Mt)&&(Mt=Mt[It])===null)&&(Mt=void 0),Mt===xt||Mt===void 0))return mt(Ht,nn,gn);for(bt=new(Mt===void 0?xt:Mt)(At(gn-nn,0)),Bt=0;nn<gn;nn++,Bt++)nn in Ht&&ft(bt,Bt,Ht[nn]);return bt.length=Bt,bt}})},2707:(it,ut,s)=>{var tt=s(2109),ot=s(1702),ct=s(9662),yt=s(7908),pt=s(6244),gt=s(5117),st=s(1340),ft=s(7293),at=s(4362),ht=s(9341),mt=s(8886),St=s(256),It=s(7392),xt=s(8008),At=[],Nt=ot(At.sort),kt=ot(At.push),Mt=ft(function(){At.sort(void 0)}),bt=ft(function(){At.sort(null)}),Bt=ht("sort"),Ht=!ft(function(){if(It)return It<70;if(!(mt&&mt>3)){if(St)return!0;if(xt)return xt<603;var Wt,nn,gn,tn,Gt="";for(Wt=65;Wt<76;Wt++){switch(nn=String.fromCharCode(Wt),Wt){case 66:case 69:case 70:case 72:gn=3;break;case 68:case 71:gn=4;break;default:gn=2}for(tn=0;tn<47;tn++)At.push({k:nn+tn,v:gn})}for(At.sort(function(fn,Cn){return Cn.v-fn.v}),tn=0;tn<At.length;tn++)nn=At[tn].k.charAt(0),Gt.charAt(Gt.length-1)!==nn&&(Gt+=nn);return Gt!=="DGBEFHACIJK"}});tt({target:"Array",proto:!0,forced:Mt||!bt||!Bt||!Ht},{sort:function(Wt){Wt!==void 0&&ct(Wt);var nn=yt(this);if(Ht)return Wt===void 0?Nt(nn):Nt(nn,Wt);var gn,tn,Gt=[],fn=pt(nn);for(tn=0;tn<fn;tn++)tn in nn&&kt(Gt,nn[tn]);for(at(Gt,function(Cn){return function(Tn,dn){return dn===void 0?-1:Tn===void 0?1:Cn!==void 0?+Cn(Tn,dn)||0:st(Tn)>st(dn)?1:-1}}(Wt)),gn=Gt.length,tn=0;tn<gn;)nn[tn]=Gt[tn++];for(;tn<fn;)gt(nn,tn++);return nn}})},561:(it,ut,s)=>{var tt=s(2109),ot=s(7908),ct=s(1400),yt=s(9303),pt=s(6244),gt=s(7207),st=s(5417),ft=s(6135),at=s(5117),ht=s(1194)("splice"),mt=Math.max,St=Math.min;tt({target:"Array",proto:!0,forced:!ht},{splice:function(It,xt){var At,Nt,kt,Mt,bt,Bt,Ht=ot(this),Wt=pt(Ht),nn=ct(It,Wt),gn=arguments.length;for(gn===0?At=Nt=0:gn===1?(At=0,Nt=Wt-nn):(At=gn-2,Nt=St(mt(yt(xt),0),Wt-nn)),gt(Wt+At-Nt),kt=st(Ht,Nt),Mt=0;Mt<Nt;Mt++)(bt=nn+Mt)in Ht&&ft(kt,Mt,Ht[bt]);if(kt.length=Nt,At<Nt){for(Mt=nn;Mt<Wt-Nt;Mt++)Bt=Mt+At,(bt=Mt+Nt)in Ht?Ht[Bt]=Ht[bt]:at(Ht,Bt);for(Mt=Wt;Mt>Wt-Nt+At;Mt--)at(Ht,Mt-1)}else if(At>Nt)for(Mt=Wt-Nt;Mt>nn;Mt--)Bt=Mt+At-1,(bt=Mt+Nt-1)in Ht?Ht[Bt]=Ht[bt]:at(Ht,Bt);for(Mt=0;Mt<At;Mt++)Ht[Mt+nn]=arguments[Mt+2];return Ht.length=Wt-Nt+At,kt}})},3690:(it,ut,s)=>{var tt=s(2109),ot=s(3331);tt({global:!0,constructor:!0,forced:!s(4019)},{DataView:ot.DataView})},6716:(it,ut,s)=>{s(3690)},3843:(it,ut,s)=>{var tt=s(2109),ot=s(1702),ct=Date,yt=ot(ct.prototype.getTime);tt({target:"Date",stat:!0},{now:function(){return yt(new ct)}})},5268:(it,ut,s)=>{var tt=s(2109),ot=s(5573);tt({target:"Date",proto:!0,forced:Date.prototype.toISOString!==ot},{toISOString:ot})},5735:(it,ut,s)=>{var tt=s(2109),ot=s(7293),ct=s(7908),yt=s(7593);tt({target:"Date",proto:!0,arity:1,forced:ot(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1})},{toJSON:function(pt){var gt=ct(this),st=yt(gt,"number");return typeof st!="number"||isFinite(st)?gt.toISOString():null}})},3710:(it,ut,s)=>{var tt=s(1702),ot=s(8052),ct=Date.prototype,yt="Invalid Date",pt=tt(ct.toString),gt=tt(ct.getTime);String(new Date(NaN))!=yt&&ot(ct,"toString",function(){var st=gt(this);return st==st?pt(this):yt})},4812:(it,ut,s)=>{var tt=s(2109),ot=s(7065);tt({target:"Function",proto:!0,forced:Function.bind!==ot},{bind:ot})},8309:(it,ut,s)=>{var tt=s(9781),ot=s(6530).EXISTS,ct=s(1702),yt=s(3070).f,pt=Function.prototype,gt=ct(pt.toString),st=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,ft=ct(st.exec);tt&&!ot&&yt(pt,"name",{configurable:!0,get:function(){try{return ft(st,gt(this))[1]}catch{return""}}})},8862:(it,ut,s)=>{var tt=s(2109),ot=s(5005),ct=s(2104),yt=s(6916),pt=s(1702),gt=s(7293),st=s(3157),ft=s(614),at=s(111),ht=s(2190),mt=s(206),St=s(133),It=ot("JSON","stringify"),xt=pt(/./.exec),At=pt("".charAt),Nt=pt("".charCodeAt),kt=pt("".replace),Mt=pt(1 .toString),bt=/[\uD800-\uDFFF]/g,Bt=/^[\uD800-\uDBFF]$/,Ht=/^[\uDC00-\uDFFF]$/,Wt=!St||gt(function(){var Gt=ot("Symbol")();return It([Gt])!="[null]"||It({a:Gt})!="{}"||It(Object(Gt))!="{}"}),nn=gt(function(){return It("\uDF06\uD834")!=='"\\udf06\\ud834"'||It("\uDEAD")!=='"\\udead"'}),gn=function(Gt,fn){var Cn=mt(arguments),Tn=fn;if((at(fn)||Gt!==void 0)&&!ht(Gt))return st(fn)||(fn=function(dn,mn){if(ft(Tn)&&(mn=yt(Tn,this,dn,mn)),!ht(mn))return mn}),Cn[1]=fn,ct(It,null,Cn)},tn=function(Gt,fn,Cn){var Tn=At(Cn,fn-1),dn=At(Cn,fn+1);return xt(Bt,Gt)&&!xt(Ht,dn)||xt(Ht,Gt)&&!xt(Bt,Tn)?"\\u"+Mt(Nt(Gt,0),16):Gt};It&&tt({target:"JSON",stat:!0,arity:3,forced:Wt||nn},{stringify:function(Gt,fn,Cn){var Tn=mt(arguments),dn=ct(Wt?gn:It,null,Tn);return nn&&typeof dn=="string"?kt(dn,bt,tn):dn}})},3706:(it,ut,s)=>{var tt=s(7854);s(8003)(tt.JSON,"JSON",!0)},9098:(it,ut,s)=>{s(7710)("Map",function(tt){return function(){return tt(this,arguments.length?arguments[0]:void 0)}},s(5631))},1532:(it,ut,s)=>{s(9098)},658:(it,ut,s)=>{s(2109)({target:"Math",stat:!0},{log10:s(403)})},2703:(it,ut,s)=>{s(8003)(Math,"Math",!0)},9653:(it,ut,s)=>{var tt=s(9781),ot=s(7854),ct=s(1702),yt=s(4705),pt=s(8052),gt=s(2597),st=s(9587),ft=s(7976),at=s(2190),ht=s(7593),mt=s(7293),St=s(8006).f,It=s(1236).f,xt=s(3070).f,At=s(863),Nt=s(3111).trim,kt="Number",Mt=ot.Number,bt=Mt.prototype,Bt=ot.TypeError,Ht=ct("".slice),Wt=ct("".charCodeAt),nn=function(Tn){var dn=ht(Tn,"number");return typeof dn=="bigint"?dn:gn(dn)},gn=function(Tn){var dn,mn,yn,pn,In,On,_n,Mn,Nn=ht(Tn,"number");if(at(Nn))throw Bt("Cannot convert a Symbol value to a number");if(typeof Nn=="string"&&Nn.length>2){if(Nn=Nt(Nn),(dn=Wt(Nn,0))===43||dn===45){if((mn=Wt(Nn,2))===88||mn===120)return NaN}else if(dn===48){switch(Wt(Nn,1)){case 66:case 98:yn=2,pn=49;break;case 79:case 111:yn=8,pn=55;break;default:return+Nn}for(On=(In=Ht(Nn,2)).length,_n=0;_n<On;_n++)if((Mn=Wt(In,_n))<48||Mn>pn)return NaN;return parseInt(In,yn)}}return+Nn};if(yt(kt,!Mt(" 0o1")||!Mt("0b1")||Mt("+0x1"))){for(var tn,Gt=function(Tn){var dn=arguments.length<1?0:Mt(nn(Tn)),mn=this;return ft(bt,mn)&&mt(function(){At(mn)})?st(Object(dn),mn,Gt):dn},fn=tt?St(Mt):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Cn=0;fn.length>Cn;Cn++)gt(Mt,tn=fn[Cn])&&!gt(Gt,tn)&&xt(Gt,tn,It(Mt,tn));Gt.prototype=bt,bt.constructor=Gt,pt(ot,kt,Gt,{constructor:!0})}},3161:(it,ut,s)=>{s(2109)({target:"Number",stat:!0},{isInteger:s(5988)})},4363:(it,ut,s)=>{s(2109)({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991})},9601:(it,ut,s)=>{var tt=s(2109),ot=s(1574);tt({target:"Object",stat:!0,arity:2,forced:Object.assign!==ot},{assign:ot})},8011:(it,ut,s)=>{s(2109)({target:"Object",stat:!0,sham:!s(9781)},{create:s(30)})},9070:(it,ut,s)=>{var tt=s(2109),ot=s(9781),ct=s(3070).f;tt({target:"Object",stat:!0,forced:Object.defineProperty!==ct,sham:!ot},{defineProperty:ct})},9720:(it,ut,s)=>{var tt=s(2109),ot=s(4699).entries;tt({target:"Object",stat:!0},{entries:function(ct){return ot(ct)}})},5003:(it,ut,s)=>{var tt=s(2109),ot=s(7293),ct=s(5656),yt=s(1236).f,pt=s(9781),gt=ot(function(){yt(1)});tt({target:"Object",stat:!0,forced:!pt||gt,sham:!pt},{getOwnPropertyDescriptor:function(st,ft){return yt(ct(st),ft)}})},9660:(it,ut,s)=>{var tt=s(2109),ot=s(133),ct=s(7293),yt=s(5181),pt=s(7908);tt({target:"Object",stat:!0,forced:!ot||ct(function(){yt.f(1)})},{getOwnPropertySymbols:function(gt){var st=yt.f;return st?st(pt(gt)):[]}})},489:(it,ut,s)=>{var tt=s(2109),ot=s(7293),ct=s(7908),yt=s(9518),pt=s(8544);tt({target:"Object",stat:!0,forced:ot(function(){yt(1)}),sham:!pt},{getPrototypeOf:function(gt){return yt(ct(gt))}})},7941:(it,ut,s)=>{var tt=s(2109),ot=s(7908),ct=s(1956);tt({target:"Object",stat:!0,forced:s(7293)(function(){ct(1)})},{keys:function(yt){return ct(ot(yt))}})},8304:(it,ut,s)=>{s(2109)({target:"Object",stat:!0},{setPrototypeOf:s(7674)})},1539:(it,ut,s)=>{var tt=s(1694),ot=s(8052),ct=s(288);tt||ot(Object.prototype,"toString",ct,{unsafe:!0})},2479:(it,ut,s)=>{var tt=s(2109),ot=s(4699).values;tt({target:"Object",stat:!0},{values:function(ct){return ot(ct)}})},1058:(it,ut,s)=>{var tt=s(2109),ot=s(3009);tt({global:!0,forced:parseInt!=ot},{parseInt:ot})},821:(it,ut,s)=>{var tt=s(2109),ot=s(6916),ct=s(9662),yt=s(8523),pt=s(2534),gt=s(408);tt({target:"Promise",stat:!0,forced:s(612)},{all:function(st){var ft=this,at=yt.f(ft),ht=at.resolve,mt=at.reject,St=pt(function(){var It=ct(ft.resolve),xt=[],At=0,Nt=1;gt(st,function(kt){var Mt=At++,bt=!1;Nt++,ot(It,ft,kt).then(function(Bt){bt||(bt=!0,xt[Mt]=Bt,--Nt||ht(xt))},mt)}),--Nt||ht(xt)});return St.error&&mt(St.value),at.promise}})},4164:(it,ut,s)=>{var tt=s(2109),ot=s(1913),ct=s(3702).CONSTRUCTOR,yt=s(2492),pt=s(5005),gt=s(614),st=s(8052),ft=yt&&yt.prototype;if(tt({target:"Promise",proto:!0,forced:ct,real:!0},{catch:function(ht){return this.then(void 0,ht)}}),!ot&&gt(yt)){var at=pt("Promise").prototype.catch;ft.catch!==at&&st(ft,"catch",at,{unsafe:!0})}},3401:(it,ut,s)=>{var tt,ot,ct,yt=s(2109),pt=s(1913),gt=s(2805),st=s(7854),ft=s(6916),at=s(8052),ht=s(7674),mt=s(8003),St=s(6340),It=s(9662),xt=s(614),At=s(111),Nt=s(5787),kt=s(6707),Mt=s(261).set,bt=s(5948),Bt=s(842),Ht=s(2534),Wt=s(8572),nn=s(9909),gn=s(2492),tn=s(3702),Gt=s(8523),fn="Promise",Cn=tn.CONSTRUCTOR,Tn=tn.REJECTION_EVENT,dn=tn.SUBCLASSING,mn=nn.getterFor(fn),yn=nn.set,pn=gn&&gn.prototype,In=gn,On=pn,_n=st.TypeError,Mn=st.document,Nn=st.process,wn=Gt.f,Pn=wn,Fn=!!(Mn&&Mn.createEvent&&st.dispatchEvent),ar="unhandledrejection",Yn=function(xn){var Un;return!(!At(xn)||!xt(Un=xn.then))&&Un},Xn=function(xn,Un){var vn,kn,qt,Rt=Un.value,nt=Un.state==1,vt=nt?xn.ok:xn.fail,Tt=xn.resolve,Pt=xn.reject,wt=xn.domain;try{vt?(nt||(Un.rejection===2&&or(Un),Un.rejection=1),vt===!0?vn=Rt:(wt&&wt.enter(),vn=vt(Rt),wt&&(wt.exit(),qt=!0)),vn===xn.promise?Pt(_n("Promise-chain cycle")):(kn=Yn(vn))?ft(kn,vn,Tt,Pt):Tt(vn)):Pt(Rt)}catch(Dt){wt&&!qt&&wt.exit(),Pt(Dt)}},tr=function(xn,Un){xn.notified||(xn.notified=!0,bt(function(){for(var vn,kn=xn.reactions;vn=kn.get();)Xn(vn,xn);xn.notified=!1,Un&&!xn.rejection&&Hn(xn)}))},cn=function(xn,Un,vn){var kn,qt;Fn?((kn=Mn.createEvent("Event")).promise=Un,kn.reason=vn,kn.initEvent(xn,!1,!0),st.dispatchEvent(kn)):kn={promise:Un,reason:vn},!Tn&&(qt=st["on"+xn])?qt(kn):xn===ar&&Bt("Unhandled promise rejection",vn)},Hn=function(xn){ft(Mt,st,function(){var Un,vn=xn.facade,kn=xn.value;if(Qn(xn)&&(Un=Ht(function(){gt?Nn.emit("unhandledRejection",kn,vn):cn(ar,vn,kn)}),xn.rejection=gt||Qn(xn)?2:1,Un.error))throw Un.value})},Qn=function(xn){return xn.rejection!==1&&!xn.parent},or=function(xn){ft(Mt,st,function(){var Un=xn.facade;gt?Nn.emit("rejectionHandled",Un):cn("rejectionhandled",Un,xn.value)})},Wn=function(xn,Un,vn){return function(kn){xn(Un,kn,vn)}},ir=function(xn,Un,vn){xn.done||(xn.done=!0,vn&&(xn=vn),xn.value=Un,xn.state=2,tr(xn,!0))},nr=function(xn,Un,vn){if(!xn.done){xn.done=!0,vn&&(xn=vn);try{if(xn.facade===Un)throw _n("Promise can't be resolved itself");var kn=Yn(Un);kn?bt(function(){var qt={done:!1};try{ft(kn,Un,Wn(nr,qt,xn),Wn(ir,qt,xn))}catch(Rt){ir(qt,Rt,xn)}}):(xn.value=Un,xn.state=1,tr(xn,!1))}catch(qt){ir({done:!1},qt,xn)}}};if(Cn&&(On=(In=function(xn){Nt(this,On),It(xn),ft(tt,this);var Un=mn(this);try{xn(Wn(nr,Un),Wn(ir,Un))}catch(vn){ir(Un,vn)}}).prototype,(tt=function(xn){yn(this,{type:fn,done:!1,notified:!1,parent:!1,reactions:new Wt,rejection:!1,state:0,value:void 0})}).prototype=at(On,"then",function(xn,Un){var vn=mn(this),kn=wn(kt(this,In));return vn.parent=!0,kn.ok=!xt(xn)||xn,kn.fail=xt(Un)&&Un,kn.domain=gt?Nn.domain:void 0,vn.state==0?vn.reactions.add(kn):bt(function(){Xn(kn,vn)}),kn.promise}),ot=function(){var xn=new tt,Un=mn(xn);this.promise=xn,this.resolve=Wn(nr,Un),this.reject=Wn(ir,Un)},Gt.f=wn=function(xn){return xn===In||xn===void 0?new ot(xn):Pn(xn)},!pt&&xt(gn)&&pn!==Object.prototype)){ct=pn.then,dn||at(pn,"then",function(xn,Un){var vn=this;return new In(function(kn,qt){ft(ct,vn,kn,qt)}).then(xn,Un)},{unsafe:!0});try{delete pn.constructor}catch{}ht&&ht(pn,On)}yt({global:!0,constructor:!0,wrap:!0,forced:Cn},{Promise:In}),mt(In,fn,!1,!0),St(fn)},8674:(it,ut,s)=>{s(3401),s(821),s(4164),s(6027),s(683),s(6294)},6027:(it,ut,s)=>{var tt=s(2109),ot=s(6916),ct=s(9662),yt=s(8523),pt=s(2534),gt=s(408);tt({target:"Promise",stat:!0,forced:s(612)},{race:function(st){var ft=this,at=yt.f(ft),ht=at.reject,mt=pt(function(){var St=ct(ft.resolve);gt(st,function(It){ot(St,ft,It).then(at.resolve,ht)})});return mt.error&&ht(mt.value),at.promise}})},683:(it,ut,s)=>{var tt=s(2109),ot=s(6916),ct=s(8523);tt({target:"Promise",stat:!0,forced:s(3702).CONSTRUCTOR},{reject:function(yt){var pt=ct.f(this);return ot(pt.reject,void 0,yt),pt.promise}})},6294:(it,ut,s)=>{var tt=s(2109),ot=s(5005),ct=s(1913),yt=s(2492),pt=s(3702).CONSTRUCTOR,gt=s(9478),st=ot("Promise"),ft=ct&&!pt;tt({target:"Promise",stat:!0,forced:ct||pt},{resolve:function(at){return gt(ft&&this===st?yt:this,at)}})},2419:(it,ut,s)=>{var tt=s(2109),ot=s(5005),ct=s(2104),yt=s(7065),pt=s(9483),gt=s(9670),st=s(111),ft=s(30),at=s(7293),ht=ot("Reflect","construct"),mt=Object.prototype,St=[].push,It=at(function(){function Nt(){}return!(ht(function(){},[],Nt)instanceof Nt)}),xt=!at(function(){ht(function(){})}),At=It||xt;tt({target:"Reflect",stat:!0,forced:At,sham:At},{construct:function(Nt,kt){pt(Nt),gt(kt);var Mt=arguments.length<3?Nt:pt(arguments[2]);if(xt&&!It)return ht(Nt,kt,Mt);if(Nt==Mt){switch(kt.length){case 0:return new Nt;case 1:return new Nt(kt[0]);case 2:return new Nt(kt[0],kt[1]);case 3:return new Nt(kt[0],kt[1],kt[2]);case 4:return new Nt(kt[0],kt[1],kt[2],kt[3])}var bt=[null];return ct(St,bt,kt),new(ct(yt,Nt,bt))}var Bt=Mt.prototype,Ht=ft(st(Bt)?Bt:mt),Wt=ct(Nt,Ht,kt);return st(Wt)?Wt:Ht}})},4819:(it,ut,s)=>{var tt=s(2109),ot=s(6916),ct=s(111),yt=s(9670),pt=s(5032),gt=s(1236),st=s(9518);tt({target:"Reflect",stat:!0},{get:function ft(at,ht){var mt,St,It=arguments.length<3?at:arguments[2];return yt(at)===It?at[ht]:(mt=gt.f(at,ht))?pt(mt)?mt.value:mt.get===void 0?void 0:ot(mt.get,It):ct(St=st(at))?ft(St,ht,It):void 0}})},4603:(it,ut,s)=>{var tt=s(9781),ot=s(7854),ct=s(1702),yt=s(4705),pt=s(9587),gt=s(8880),st=s(8006).f,ft=s(7976),at=s(7850),ht=s(1340),mt=s(4706),St=s(2999),It=s(2626),xt=s(8052),At=s(7293),Nt=s(2597),kt=s(9909).enforce,Mt=s(6340),bt=s(5112),Bt=s(9441),Ht=s(7168),Wt=bt("match"),nn=ot.RegExp,gn=nn.prototype,tn=ot.SyntaxError,Gt=ct(gn.exec),fn=ct("".charAt),Cn=ct("".replace),Tn=ct("".indexOf),dn=ct("".slice),mn=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,yn=/a/g,pn=/a/g,In=new nn(yn)!==yn,On=St.MISSED_STICKY,_n=St.UNSUPPORTED_Y;if(yt("RegExp",tt&&(!In||On||Bt||Ht||At(function(){return pn[Wt]=!1,nn(yn)!=yn||nn(pn)==pn||nn(yn,"i")!="/a/i"})))){for(var Mn=function(Pn,Fn){var ar,Yn,Xn,tr,cn,Hn,Qn=ft(gn,this),or=at(Pn),Wn=Fn===void 0,ir=[],nr=Pn;if(!Qn&&or&&Wn&&Pn.constructor===Mn)return Pn;if((or||ft(gn,Pn))&&(Pn=Pn.source,Wn&&(Fn=mt(nr))),Pn=Pn===void 0?"":ht(Pn),Fn=Fn===void 0?"":ht(Fn),nr=Pn,Bt&&"dotAll"in yn&&(Yn=!!Fn&&Tn(Fn,"s")>-1)&&(Fn=Cn(Fn,/s/g,"")),ar=Fn,On&&"sticky"in yn&&(Xn=!!Fn&&Tn(Fn,"y")>-1)&&_n&&(Fn=Cn(Fn,/y/g,"")),Ht&&(tr=function(xn){for(var Un,vn=xn.length,kn=0,qt="",Rt=[],nt={},vt=!1,Tt=!1,Pt=0,wt="";kn<=vn;kn++){if((Un=fn(xn,kn))==="\\")Un+=fn(xn,++kn);else if(Un==="]")vt=!1;else if(!vt)switch(!0){case Un==="[":vt=!0;break;case Un==="(":Gt(mn,dn(xn,kn+1))&&(kn+=2,Tt=!0),qt+=Un,Pt++;continue;case(Un===">"&&Tt):if(wt===""||Nt(nt,wt))throw new tn("Invalid capture group name");nt[wt]=!0,Rt[Rt.length]=[wt,Pt],Tt=!1,wt="";continue}Tt?wt+=Un:qt+=Un}return[qt,Rt]}(Pn),Pn=tr[0],ir=tr[1]),cn=pt(nn(Pn,Fn),Qn?this:gn,Mn),(Yn||Xn||ir.length)&&(Hn=kt(cn),Yn&&(Hn.dotAll=!0,Hn.raw=Mn(function(xn){for(var Un,vn=xn.length,kn=0,qt="",Rt=!1;kn<=vn;kn++)(Un=fn(xn,kn))!=="\\"?Rt||Un!=="."?(Un==="["?Rt=!0:Un==="]"&&(Rt=!1),qt+=Un):qt+="[\\s\\S]":qt+=Un+fn(xn,++kn);return qt}(Pn),ar)),Xn&&(Hn.sticky=!0),ir.length&&(Hn.groups=ir)),Pn!==nr)try{gt(cn,"source",nr===""?"(?:)":nr)}catch{}return cn},Nn=st(nn),wn=0;Nn.length>wn;)It(Mn,nn,Nn[wn++]);gn.constructor=Mn,Mn.prototype=gn,xt(ot,"RegExp",Mn,{constructor:!0})}Mt("RegExp")},4916:(it,ut,s)=>{var tt=s(2109),ot=s(2261);tt({target:"RegExp",proto:!0,forced:/./.exec!==ot},{exec:ot})},9714:(it,ut,s)=>{var tt=s(6530).PROPER,ot=s(8052),ct=s(9670),yt=s(1340),pt=s(7293),gt=s(4706),st="toString",ft=RegExp.prototype.toString,at=pt(function(){return ft.call({source:"a",flags:"b"})!="/a/b"}),ht=tt&&ft.name!=st;(at||ht)&&ot(RegExp.prototype,st,function(){var mt=ct(this);return"/"+yt(mt.source)+"/"+yt(gt(mt))},{unsafe:!0})},7227:(it,ut,s)=>{s(7710)("Set",function(tt){return function(){return tt(this,arguments.length?arguments[0]:void 0)}},s(5631))},189:(it,ut,s)=>{s(7227)},2023:(it,ut,s)=>{var tt=s(2109),ot=s(1702),ct=s(3929),yt=s(4488),pt=s(1340),gt=s(4964),st=ot("".indexOf);tt({target:"String",proto:!0,forced:!gt("includes")},{includes:function(ft){return!!~st(pt(yt(this)),pt(ct(ft)),arguments.length>1?arguments[1]:void 0)}})},8783:(it,ut,s)=>{var tt=s(8710).charAt,ot=s(1340),ct=s(9909),yt=s(654),pt="String Iterator",gt=ct.set,st=ct.getterFor(pt);yt(String,"String",function(ft){gt(this,{type:pt,string:ot(ft),index:0})},function(){var ft,at=st(this),ht=at.string,mt=at.index;return mt>=ht.length?{value:void 0,done:!0}:(ft=tt(ht,mt),at.index+=ft.length,{value:ft,done:!1})})},4723:(it,ut,s)=>{var tt=s(6916),ot=s(7007),ct=s(9670),yt=s(7466),pt=s(1340),gt=s(4488),st=s(8173),ft=s(1530),at=s(7651);ot("match",function(ht,mt,St){return[function(It){var xt=gt(this),At=It==null?void 0:st(It,ht);return At?tt(At,It,xt):new RegExp(It)[ht](pt(xt))},function(It){var xt=ct(this),At=pt(It),Nt=St(mt,xt,At);if(Nt.done)return Nt.value;if(!xt.global)return at(xt,At);var kt=xt.unicode;xt.lastIndex=0;for(var Mt,bt=[],Bt=0;(Mt=at(xt,At))!==null;){var Ht=pt(Mt[0]);bt[Bt]=Ht,Ht===""&&(xt.lastIndex=ft(At,yt(xt.lastIndex),kt)),Bt++}return Bt===0?null:bt}]})},5306:(it,ut,s)=>{var tt=s(2104),ot=s(6916),ct=s(1702),yt=s(7007),pt=s(7293),gt=s(9670),st=s(614),ft=s(9303),at=s(7466),ht=s(1340),mt=s(4488),St=s(1530),It=s(8173),xt=s(647),At=s(7651),Nt=s(5112)("replace"),kt=Math.max,Mt=Math.min,bt=ct([].concat),Bt=ct([].push),Ht=ct("".indexOf),Wt=ct("".slice),nn="a".replace(/./,"$0")==="$0",gn=!!/./[Nt]&&/./[Nt]("a","$0")==="";yt("replace",function(tn,Gt,fn){var Cn=gn?"$":"$0";return[function(Tn,dn){var mn=mt(this),yn=Tn==null?void 0:It(Tn,Nt);return yn?ot(yn,Tn,mn,dn):ot(Gt,ht(mn),Tn,dn)},function(Tn,dn){var mn=gt(this),yn=ht(Tn);if(typeof dn=="string"&&Ht(dn,Cn)===-1&&Ht(dn,"$<")===-1){var pn=fn(Gt,mn,yn,dn);if(pn.done)return pn.value}var In=st(dn);In||(dn=ht(dn));var On=mn.global;if(On){var _n=mn.unicode;mn.lastIndex=0}for(var Mn=[];;){var Nn=At(mn,yn);if(Nn===null||(Bt(Mn,Nn),!On))break;ht(Nn[0])===""&&(mn.lastIndex=St(yn,at(mn.lastIndex),_n))}for(var wn,Pn="",Fn=0,ar=0;ar<Mn.length;ar++){for(var Yn=ht((Nn=Mn[ar])[0]),Xn=kt(Mt(ft(Nn.index),yn.length),0),tr=[],cn=1;cn<Nn.length;cn++)Bt(tr,(wn=Nn[cn])===void 0?wn:String(wn));var Hn=Nn.groups;if(In){var Qn=bt([Yn],tr,Xn,yn);Hn!==void 0&&Bt(Qn,Hn);var or=ht(tt(dn,void 0,Qn))}else or=xt(Yn,yn,Xn,tr,Hn,dn);Xn>=Fn&&(Pn+=Wt(yn,Fn,Xn)+or,Fn=Xn+Yn.length)}return Pn+Wt(yn,Fn)}]},!!pt(function(){var tn=/./;return tn.exec=function(){var Gt=[];return Gt.groups={a:"7"},Gt},"".replace(tn,"$<a>")!=="7"})||!nn||gn)},4765:(it,ut,s)=>{var tt=s(6916),ot=s(7007),ct=s(9670),yt=s(4488),pt=s(1150),gt=s(1340),st=s(8173),ft=s(7651);ot("search",function(at,ht,mt){return[function(St){var It=yt(this),xt=St==null?void 0:st(St,at);return xt?tt(xt,St,It):new RegExp(St)[at](gt(It))},function(St){var It=ct(this),xt=gt(St),At=mt(ht,It,xt);if(At.done)return At.value;var Nt=It.lastIndex;pt(Nt,0)||(It.lastIndex=0);var kt=ft(It,xt);return pt(It.lastIndex,Nt)||(It.lastIndex=Nt),kt===null?-1:kt.index}]})},3123:(it,ut,s)=>{var tt=s(2104),ot=s(6916),ct=s(1702),yt=s(7007),pt=s(7850),gt=s(9670),st=s(4488),ft=s(6707),at=s(1530),ht=s(7466),mt=s(1340),St=s(8173),It=s(1589),xt=s(7651),At=s(2261),Nt=s(2999),kt=s(7293),Mt=Nt.UNSUPPORTED_Y,bt=4294967295,Bt=Math.min,Ht=[].push,Wt=ct(/./.exec),nn=ct(Ht),gn=ct("".slice);yt("split",function(tn,Gt,fn){var Cn;return Cn="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?function(Tn,dn){var mn=mt(st(this)),yn=dn===void 0?bt:dn>>>0;if(yn===0)return[];if(Tn===void 0)return[mn];if(!pt(Tn))return ot(Gt,mn,Tn,yn);for(var pn,In,On,_n=[],Mn=(Tn.ignoreCase?"i":"")+(Tn.multiline?"m":"")+(Tn.unicode?"u":"")+(Tn.sticky?"y":""),Nn=0,wn=new RegExp(Tn.source,Mn+"g");(pn=ot(At,wn,mn))&&!((In=wn.lastIndex)>Nn&&(nn(_n,gn(mn,Nn,pn.index)),pn.length>1&&pn.index<mn.length&&tt(Ht,_n,It(pn,1)),On=pn[0].length,Nn=In,_n.length>=yn));)wn.lastIndex===pn.index&&wn.lastIndex++;return Nn===mn.length?!On&&Wt(wn,"")||nn(_n,""):nn(_n,gn(mn,Nn)),_n.length>yn?It(_n,0,yn):_n}:"0".split(void 0,0).length?function(Tn,dn){return Tn===void 0&&dn===0?[]:ot(Gt,this,Tn,dn)}:Gt,[function(Tn,dn){var mn=st(this),yn=Tn==null?void 0:St(Tn,tn);return yn?ot(yn,Tn,mn,dn):ot(Cn,mt(mn),Tn,dn)},function(Tn,dn){var mn=gt(this),yn=mt(Tn),pn=fn(Cn,mn,yn,dn,Cn!==Gt);if(pn.done)return pn.value;var In=ft(mn,RegExp),On=mn.unicode,_n=(mn.ignoreCase?"i":"")+(mn.multiline?"m":"")+(mn.unicode?"u":"")+(Mt?"g":"y"),Mn=new In(Mt?"^(?:"+mn.source+")":mn,_n),Nn=dn===void 0?bt:dn>>>0;if(Nn===0)return[];if(yn.length===0)return xt(Mn,yn)===null?[yn]:[];for(var wn=0,Pn=0,Fn=[];Pn<yn.length;){Mn.lastIndex=Mt?0:Pn;var ar,Yn=xt(Mn,Mt?gn(yn,Pn):yn);if(Yn===null||(ar=Bt(ht(Mn.lastIndex+(Mt?Pn:0)),yn.length))===wn)Pn=at(yn,Pn,On);else{if(nn(Fn,gn(yn,wn,Pn)),Fn.length===Nn)return Fn;for(var Xn=1;Xn<=Yn.length-1;Xn++)if(nn(Fn,Yn[Xn]),Fn.length===Nn)return Fn;Pn=wn=ar}}return nn(Fn,gn(yn,wn)),Fn}]},!!kt(function(){var tn=/(?:)/,Gt=tn.exec;tn.exec=function(){return Gt.apply(this,arguments)};var fn="ab".split(tn);return fn.length!==2||fn[0]!=="a"||fn[1]!=="b"}),Mt)},6755:(it,ut,s)=>{var tt,ot=s(2109),ct=s(1702),yt=s(1236).f,pt=s(7466),gt=s(1340),st=s(3929),ft=s(4488),at=s(4964),ht=s(1913),mt=ct("".startsWith),St=ct("".slice),It=Math.min,xt=at("startsWith");ot({target:"String",proto:!0,forced:!(!ht&&!xt&&(tt=yt(String.prototype,"startsWith"),tt&&!tt.writable)||xt)},{startsWith:function(At){var Nt=gt(ft(this));st(At);var kt=pt(It(arguments.length>1?arguments[1]:void 0,Nt.length)),Mt=gt(At);return mt?mt(Nt,Mt,kt):St(Nt,kt,kt+Mt.length)===Mt}})},2443:(it,ut,s)=>{s(7235)("asyncIterator")},4032:(it,ut,s)=>{var tt=s(2109),ot=s(7854),ct=s(6916),yt=s(1702),pt=s(1913),gt=s(9781),st=s(133),ft=s(7293),at=s(2597),ht=s(7976),mt=s(9670),St=s(5656),It=s(4948),xt=s(1340),At=s(9114),Nt=s(30),kt=s(1956),Mt=s(8006),bt=s(1156),Bt=s(5181),Ht=s(1236),Wt=s(3070),nn=s(6048),gn=s(5296),tn=s(8052),Gt=s(2309),fn=s(6200),Cn=s(3501),Tn=s(9711),dn=s(5112),mn=s(6061),yn=s(7235),pn=s(6532),In=s(8003),On=s(9909),_n=s(2092).forEach,Mn=fn("hidden"),Nn="Symbol",wn=On.set,Pn=On.getterFor(Nn),Fn=Object.prototype,ar=ot.Symbol,Yn=ar&&ar.prototype,Xn=ot.TypeError,tr=ot.QObject,cn=Ht.f,Hn=Wt.f,Qn=bt.f,or=gn.f,Wn=yt([].push),ir=Gt("symbols"),nr=Gt("op-symbols"),xn=Gt("wks"),Un=!tr||!tr.prototype||!tr.prototype.findChild,vn=gt&&ft(function(){return Nt(Hn({},"a",{get:function(){return Hn(this,"a",{value:7}).a}})).a!=7})?function(wt,Dt,Et){var jt=cn(Fn,Dt);jt&&delete Fn[Dt],Hn(wt,Dt,Et),jt&&wt!==Fn&&Hn(Fn,Dt,jt)}:Hn,kn=function(wt,Dt){var Et=ir[wt]=Nt(Yn);return wn(Et,{type:Nn,tag:wt,description:Dt}),gt||(Et.description=Dt),Et},qt=function(wt,Dt,Et){wt===Fn&&qt(nr,Dt,Et),mt(wt);var jt=It(Dt);return mt(Et),at(ir,jt)?(Et.enumerable?(at(wt,Mn)&&wt[Mn][jt]&&(wt[Mn][jt]=!1),Et=Nt(Et,{enumerable:At(0,!1)})):(at(wt,Mn)||Hn(wt,Mn,At(1,{})),wt[Mn][jt]=!0),vn(wt,jt,Et)):Hn(wt,jt,Et)},Rt=function(wt,Dt){mt(wt);var Et=St(Dt),jt=kt(Et).concat(Pt(Et));return _n(jt,function(Yt){gt&&!ct(nt,Et,Yt)||qt(wt,Yt,Et[Yt])}),wt},nt=function(wt){var Dt=It(wt),Et=ct(or,this,Dt);return!(this===Fn&&at(ir,Dt)&&!at(nr,Dt))&&(!(Et||!at(this,Dt)||!at(ir,Dt)||at(this,Mn)&&this[Mn][Dt])||Et)},vt=function(wt,Dt){var Et=St(wt),jt=It(Dt);if(Et!==Fn||!at(ir,jt)||at(nr,jt)){var Yt=cn(Et,jt);return!Yt||!at(ir,jt)||at(Et,Mn)&&Et[Mn][jt]||(Yt.enumerable=!0),Yt}},Tt=function(wt){var Dt=Qn(St(wt)),Et=[];return _n(Dt,function(jt){at(ir,jt)||at(Cn,jt)||Wn(Et,jt)}),Et},Pt=function(wt){var Dt=wt===Fn,Et=Qn(Dt?nr:St(wt)),jt=[];return _n(Et,function(Yt){!at(ir,Yt)||Dt&&!at(Fn,Yt)||Wn(jt,ir[Yt])}),jt};st||(tn(Yn=(ar=function(){if(ht(Yn,this))throw Xn("Symbol is not a constructor");var wt=arguments.length&&arguments[0]!==void 0?xt(arguments[0]):void 0,Dt=Tn(wt),Et=function(jt){this===Fn&&ct(Et,nr,jt),at(this,Mn)&&at(this[Mn],Dt)&&(this[Mn][Dt]=!1),vn(this,Dt,At(1,jt))};return gt&&Un&&vn(Fn,Dt,{configurable:!0,set:Et}),kn(Dt,wt)}).prototype,"toString",function(){return Pn(this).tag}),tn(ar,"withoutSetter",function(wt){return kn(Tn(wt),wt)}),gn.f=nt,Wt.f=qt,nn.f=Rt,Ht.f=vt,Mt.f=bt.f=Tt,Bt.f=Pt,mn.f=function(wt){return kn(dn(wt),wt)},gt&&(Hn(Yn,"description",{configurable:!0,get:function(){return Pn(this).description}}),pt||tn(Fn,"propertyIsEnumerable",nt,{unsafe:!0}))),tt({global:!0,constructor:!0,wrap:!0,forced:!st,sham:!st},{Symbol:ar}),_n(kt(xn),function(wt){yn(wt)}),tt({target:Nn,stat:!0,forced:!st},{useSetter:function(){Un=!0},useSimple:function(){Un=!1}}),tt({target:"Object",stat:!0,forced:!st,sham:!gt},{create:function(wt,Dt){return Dt===void 0?Nt(wt):Rt(Nt(wt),Dt)},defineProperty:qt,defineProperties:Rt,getOwnPropertyDescriptor:vt}),tt({target:"Object",stat:!0,forced:!st},{getOwnPropertyNames:Tt}),pn(),In(ar,Nn),Cn[Mn]=!0},1817:(it,ut,s)=>{var tt=s(2109),ot=s(9781),ct=s(7854),yt=s(1702),pt=s(2597),gt=s(614),st=s(7976),ft=s(1340),at=s(3070).f,ht=s(9920),mt=ct.Symbol,St=mt&&mt.prototype;if(ot&&gt(mt)&&(!("description"in St)||mt().description!==void 0)){var It={},xt=function(){var Ht=arguments.length<1||arguments[0]===void 0?void 0:ft(arguments[0]),Wt=st(St,this)?new mt(Ht):Ht===void 0?mt():mt(Ht);return Ht===""&&(It[Wt]=!0),Wt};ht(xt,mt),xt.prototype=St,St.constructor=xt;var At=String(mt("test"))=="Symbol(test)",Nt=yt(St.toString),kt=yt(St.valueOf),Mt=/^Symbol\((.*)\)[^)]+$/,bt=yt("".replace),Bt=yt("".slice);at(St,"description",{configurable:!0,get:function(){var Ht=kt(this),Wt=Nt(Ht);if(pt(It,Ht))return"";var nn=At?Bt(Wt,7,-1):bt(Wt,Mt,"$1");return nn===""?void 0:nn}}),tt({global:!0,constructor:!0,forced:!0},{Symbol:xt})}},763:(it,ut,s)=>{var tt=s(2109),ot=s(5005),ct=s(2597),yt=s(1340),pt=s(2309),gt=s(735),st=pt("string-to-symbol-registry"),ft=pt("symbol-to-string-registry");tt({target:"Symbol",stat:!0,forced:!gt},{for:function(at){var ht=yt(at);if(ct(st,ht))return st[ht];var mt=ot("Symbol")(ht);return st[ht]=mt,ft[mt]=ht,mt}})},2165:(it,ut,s)=>{s(7235)("iterator")},2526:(it,ut,s)=>{s(4032),s(763),s(6620),s(8862),s(9660)},6620:(it,ut,s)=>{var tt=s(2109),ot=s(2597),ct=s(2190),yt=s(6330),pt=s(2309),gt=s(735),st=pt("symbol-to-string-registry");tt({target:"Symbol",stat:!0,forced:!gt},{keyFor:function(ft){if(!ct(ft))throw TypeError(yt(ft)+" is not a symbol");if(ot(st,ft))return st[ft]}})},3680:(it,ut,s)=>{var tt=s(5005),ot=s(7235),ct=s(8003);ot("toStringTag"),ct(tt("Symbol"),"Symbol")},2990:(it,ut,s)=>{var tt=s(1702),ot=s(260),ct=tt(s(1048)),yt=ot.aTypedArray;(0,ot.exportTypedArrayMethod)("copyWithin",function(pt,gt){return ct(yt(this),pt,gt,arguments.length>2?arguments[2]:void 0)})},8927:(it,ut,s)=>{var tt=s(260),ot=s(2092).every,ct=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("every",function(yt){return ot(ct(this),yt,arguments.length>1?arguments[1]:void 0)})},3105:(it,ut,s)=>{var tt=s(260),ot=s(1285),ct=s(4599),yt=s(648),pt=s(6916),gt=s(1702),st=s(7293),ft=tt.aTypedArray,at=tt.exportTypedArrayMethod,ht=gt("".slice);at("fill",function(mt){var St=arguments.length;ft(this);var It=ht(yt(this),0,3)==="Big"?ct(mt):+mt;return pt(ot,this,It,St>1?arguments[1]:void 0,St>2?arguments[2]:void 0)},st(function(){var mt=0;return new Int8Array(2).fill({valueOf:function(){return mt++}}),mt!==1}))},5035:(it,ut,s)=>{var tt=s(260),ot=s(2092).filter,ct=s(3074),yt=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("filter",function(pt){var gt=ot(yt(this),pt,arguments.length>1?arguments[1]:void 0);return ct(this,gt)})},7174:(it,ut,s)=>{var tt=s(260),ot=s(2092).findIndex,ct=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("findIndex",function(yt){return ot(ct(this),yt,arguments.length>1?arguments[1]:void 0)})},4345:(it,ut,s)=>{var tt=s(260),ot=s(2092).find,ct=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("find",function(yt){return ot(ct(this),yt,arguments.length>1?arguments[1]:void 0)})},2846:(it,ut,s)=>{var tt=s(260),ot=s(2092).forEach,ct=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("forEach",function(yt){ot(ct(this),yt,arguments.length>1?arguments[1]:void 0)})},4731:(it,ut,s)=>{var tt=s(260),ot=s(1318).includes,ct=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("includes",function(yt){return ot(ct(this),yt,arguments.length>1?arguments[1]:void 0)})},7209:(it,ut,s)=>{var tt=s(260),ot=s(1318).indexOf,ct=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("indexOf",function(yt){return ot(ct(this),yt,arguments.length>1?arguments[1]:void 0)})},6319:(it,ut,s)=>{var tt=s(7854),ot=s(7293),ct=s(1702),yt=s(260),pt=s(6992),gt=s(5112)("iterator"),st=tt.Uint8Array,ft=ct(pt.values),at=ct(pt.keys),ht=ct(pt.entries),mt=yt.aTypedArray,St=yt.exportTypedArrayMethod,It=st&&st.prototype,xt=!ot(function(){It[gt].call([1])}),At=!!It&&It.values&&It[gt]===It.values&&It.values.name==="values",Nt=function(){return ft(mt(this))};St("entries",function(){return ht(mt(this))},xt),St("keys",function(){return at(mt(this))},xt),St("values",Nt,xt||!At,{name:"values"}),St(gt,Nt,xt||!At,{name:"values"})},8867:(it,ut,s)=>{var tt=s(260),ot=s(1702),ct=tt.aTypedArray,yt=tt.exportTypedArrayMethod,pt=ot([].join);yt("join",function(gt){return pt(ct(this),gt)})},7789:(it,ut,s)=>{var tt=s(260),ot=s(2104),ct=s(6583),yt=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("lastIndexOf",function(pt){var gt=arguments.length;return ot(ct,yt(this),gt>1?[pt,arguments[1]]:[pt])})},3739:(it,ut,s)=>{var tt=s(260),ot=s(2092).map,ct=s(6304),yt=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("map",function(pt){return ot(yt(this),pt,arguments.length>1?arguments[1]:void 0,function(gt,st){return new(ct(gt))(st)})})},4483:(it,ut,s)=>{var tt=s(260),ot=s(3671).right,ct=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("reduceRight",function(yt){var pt=arguments.length;return ot(ct(this),yt,pt,pt>1?arguments[1]:void 0)})},9368:(it,ut,s)=>{var tt=s(260),ot=s(3671).left,ct=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("reduce",function(yt){var pt=arguments.length;return ot(ct(this),yt,pt,pt>1?arguments[1]:void 0)})},2056:(it,ut,s)=>{var tt=s(260),ot=tt.aTypedArray,ct=tt.exportTypedArrayMethod,yt=Math.floor;ct("reverse",function(){for(var pt,gt=this,st=ot(gt).length,ft=yt(st/2),at=0;at<ft;)pt=gt[at],gt[at++]=gt[--st],gt[st]=pt;return gt})},3462:(it,ut,s)=>{var tt=s(7854),ot=s(6916),ct=s(260),yt=s(6244),pt=s(4590),gt=s(7908),st=s(7293),ft=tt.RangeError,at=tt.Int8Array,ht=at&&at.prototype,mt=ht&&ht.set,St=ct.aTypedArray,It=ct.exportTypedArrayMethod,xt=!st(function(){var Nt=new Uint8ClampedArray(2);return ot(mt,Nt,{length:1,0:3},1),Nt[1]!==3}),At=xt&&ct.NATIVE_ARRAY_BUFFER_VIEWS&&st(function(){var Nt=new at(2);return Nt.set(1),Nt.set("2",1),Nt[0]!==0||Nt[1]!==2});It("set",function(Nt){St(this);var kt=pt(arguments.length>1?arguments[1]:void 0,1),Mt=gt(Nt);if(xt)return ot(mt,this,Mt,kt);var bt=this.length,Bt=yt(Mt),Ht=0;if(Bt+kt>bt)throw ft("Wrong length");for(;Ht<Bt;)this[kt+Ht]=Mt[Ht++]},!xt||At)},678:(it,ut,s)=>{var tt=s(260),ot=s(6304),ct=s(7293),yt=s(206),pt=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("slice",function(gt,st){for(var ft=yt(pt(this),gt,st),at=ot(this),ht=0,mt=ft.length,St=new at(mt);mt>ht;)St[ht]=ft[ht++];return St},ct(function(){new Int8Array(1).slice()}))},7462:(it,ut,s)=>{var tt=s(260),ot=s(2092).some,ct=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("some",function(yt){return ot(ct(this),yt,arguments.length>1?arguments[1]:void 0)})},3824:(it,ut,s)=>{var tt=s(7854),ot=s(1702),ct=s(7293),yt=s(9662),pt=s(4362),gt=s(260),st=s(8886),ft=s(256),at=s(7392),ht=s(8008),mt=gt.aTypedArray,St=gt.exportTypedArrayMethod,It=tt.Uint16Array,xt=It&&ot(It.prototype.sort),At=!(!xt||ct(function(){xt(new It(2),null)})&&ct(function(){xt(new It(2),{})})),Nt=!!xt&&!ct(function(){if(at)return at<74;if(st)return st<67;if(ft)return!0;if(ht)return ht<602;var kt,Mt,bt=new It(516),Bt=Array(516);for(kt=0;kt<516;kt++)Mt=kt%4,bt[kt]=515-kt,Bt[kt]=kt-2*Mt+3;for(xt(bt,function(Ht,Wt){return(Ht/4|0)-(Wt/4|0)}),kt=0;kt<516;kt++)if(bt[kt]!==Bt[kt])return!0});St("sort",function(kt){return kt!==void 0&&yt(kt),Nt?xt(this,kt):pt(mt(this),function(Mt){return function(bt,Bt){return Mt!==void 0?+Mt(bt,Bt)||0:Bt!=Bt?-1:bt!=bt?1:bt===0&&Bt===0?1/bt>0&&1/Bt<0?1:-1:bt>Bt}}(kt))},!Nt||At)},5021:(it,ut,s)=>{var tt=s(260),ot=s(7466),ct=s(1400),yt=s(6304),pt=tt.aTypedArray;(0,tt.exportTypedArrayMethod)("subarray",function(gt,st){var ft=pt(this),at=ft.length,ht=ct(gt,at);return new(yt(ft))(ft.buffer,ft.byteOffset+ht*ft.BYTES_PER_ELEMENT,ot((st===void 0?at:ct(st,at))-ht))})},2974:(it,ut,s)=>{var tt=s(7854),ot=s(2104),ct=s(260),yt=s(7293),pt=s(206),gt=tt.Int8Array,st=ct.aTypedArray,ft=ct.exportTypedArrayMethod,at=[].toLocaleString,ht=!!gt&&yt(function(){at.call(new gt(1))});ft("toLocaleString",function(){return ot(at,ht?pt(st(this)):st(this),pt(arguments))},yt(function(){return[1,2].toLocaleString()!=new gt([1,2]).toLocaleString()})||!yt(function(){gt.prototype.toLocaleString.call([1,2])}))},5016:(it,ut,s)=>{var tt=s(260).exportTypedArrayMethod,ot=s(7293),ct=s(7854),yt=s(1702),pt=ct.Uint8Array,gt=pt&&pt.prototype||{},st=[].toString,ft=yt([].join);ot(function(){st.call({})})&&(st=function(){return ft(this)});var at=gt.toString!=st;tt("toString",st,at)},2472:(it,ut,s)=>{s(9843)("Uint8",function(tt){return function(ot,ct,yt){return tt(this,ot,ct,yt)}})},9743:(it,ut,s)=>{s(9843)("Uint8",function(tt){return function(ot,ct,yt){return tt(this,ot,ct,yt)}},!0)},1202:(it,ut,s)=>{var tt,ot=s(7854),ct=s(1702),yt=s(9190),pt=s(2423),gt=s(7710),st=s(9320),ft=s(111),at=s(2050),ht=s(9909).enforce,mt=s(8536),St=!ot.ActiveXObject&&"ActiveXObject"in ot,It=function(Bt){return function(){return Bt(this,arguments.length?arguments[0]:void 0)}},xt=gt("WeakMap",It,st);if(mt&&St){tt=st.getConstructor(It,"WeakMap",!0),pt.enable();var At=xt.prototype,Nt=ct(At.delete),kt=ct(At.has),Mt=ct(At.get),bt=ct(At.set);yt(At,{delete:function(Bt){if(ft(Bt)&&!at(Bt)){var Ht=ht(this);return Ht.frozen||(Ht.frozen=new tt),Nt(this,Bt)||Ht.frozen.delete(Bt)}return Nt(this,Bt)},has:function(Bt){if(ft(Bt)&&!at(Bt)){var Ht=ht(this);return Ht.frozen||(Ht.frozen=new tt),kt(this,Bt)||Ht.frozen.has(Bt)}return kt(this,Bt)},get:function(Bt){if(ft(Bt)&&!at(Bt)){var Ht=ht(this);return Ht.frozen||(Ht.frozen=new tt),kt(this,Bt)?Mt(this,Bt):Ht.frozen.get(Bt)}return Mt(this,Bt)},set:function(Bt,Ht){if(ft(Bt)&&!at(Bt)){var Wt=ht(this);Wt.frozen||(Wt.frozen=new tt),kt(this,Bt)?bt(this,Bt,Ht):Wt.frozen.set(Bt,Ht)}else bt(this,Bt,Ht);return this}})}},4129:(it,ut,s)=>{s(1202)},4747:(it,ut,s)=>{var tt=s(7854),ot=s(8324),ct=s(8509),yt=s(8533),pt=s(8880),gt=function(ft){if(ft&&ft.forEach!==yt)try{pt(ft,"forEach",yt)}catch{ft.forEach=yt}};for(var st in ot)ot[st]&&gt(tt[st]&&tt[st].prototype);gt(ct)},3948:(it,ut,s)=>{var tt=s(7854),ot=s(8324),ct=s(8509),yt=s(6992),pt=s(8880),gt=s(5112),st=gt("iterator"),ft=gt("toStringTag"),at=yt.values,ht=function(St,It){if(St){if(St[st]!==at)try{pt(St,st,at)}catch{St[st]=at}if(St[ft]||pt(St,ft,It),ot[It]){for(var xt in yt)if(St[xt]!==yt[xt])try{pt(St,xt,yt[xt])}catch{St[xt]=yt[xt]}}}};for(var mt in ot)ht(tt[mt]&&tt[mt].prototype,mt);ht(ct,"DOMTokenList")},6815:(it,ut,s)=>{var tt=s(2109),ot=s(7854),ct=s(7152).setInterval;tt({global:!0,bind:!0,forced:ot.setInterval!==ct},{setInterval:ct})},8417:(it,ut,s)=>{var tt=s(2109),ot=s(7854),ct=s(7152).setTimeout;tt({global:!0,bind:!0,forced:ot.setTimeout!==ct},{setTimeout:ct})},2564:(it,ut,s)=>{s(6815),s(8417)},5556:(it,ut,s)=>{s(6992);var tt=s(2109),ot=s(7854),ct=s(6916),yt=s(1702),pt=s(9781),gt=s(590),st=s(8052),ft=s(9190),at=s(8003),ht=s(4994),mt=s(9909),St=s(5787),It=s(614),xt=s(2597),At=s(9974),Nt=s(648),kt=s(9670),Mt=s(111),bt=s(1340),Bt=s(30),Ht=s(9114),Wt=s(8554),nn=s(1246),gn=s(8053),tn=s(5112),Gt=s(4362),fn=tn("iterator"),Cn="URLSearchParams",Tn="URLSearchParamsIterator",dn=mt.set,mn=mt.getterFor(Cn),yn=mt.getterFor(Tn),pn=Object.getOwnPropertyDescriptor,In=function(Kt){if(!pt)return ot[Kt];var rn=pn(ot,Kt);return rn&&rn.value},On=In("fetch"),_n=In("Request"),Mn=In("Headers"),Nn=_n&&_n.prototype,wn=Mn&&Mn.prototype,Pn=ot.RegExp,Fn=ot.TypeError,ar=ot.decodeURIComponent,Yn=ot.encodeURIComponent,Xn=yt("".charAt),tr=yt([].join),cn=yt([].push),Hn=yt("".replace),Qn=yt([].shift),or=yt([].splice),Wn=yt("".split),ir=yt("".slice),nr=/\+/g,xn=Array(4),Un=function(Kt){return xn[Kt-1]||(xn[Kt-1]=Pn("((?:%[\\da-f]{2}){"+Kt+"})","gi"))},vn=function(Kt){try{return ar(Kt)}catch{return Kt}},kn=function(Kt){var rn=Hn(Kt,nr," "),hn=4;try{return ar(rn)}catch{for(;hn;)rn=Hn(rn,Un(hn--),vn);return rn}},qt=/[!'()~]|%20/g,Rt={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},nt=function(Kt){return Rt[Kt]},vt=function(Kt){return Hn(Yn(Kt),qt,nt)},Tt=ht(function(Kt,rn){dn(this,{type:Tn,iterator:Wt(mn(Kt).entries),kind:rn})},"Iterator",function(){var Kt=yn(this),rn=Kt.kind,hn=Kt.iterator.next(),an=hn.value;return hn.done||(hn.value=rn==="keys"?an.key:rn==="values"?an.value:[an.key,an.value]),hn},!0),Pt=function(Kt){this.entries=[],this.url=null,Kt!==void 0&&(Mt(Kt)?this.parseObject(Kt):this.parseQuery(typeof Kt=="string"?Xn(Kt,0)==="?"?ir(Kt,1):Kt:bt(Kt)))};Pt.prototype={type:Cn,bindURL:function(Kt){this.url=Kt,this.update()},parseObject:function(Kt){var rn,hn,an,un,Sn,En,An,Dn=nn(Kt);if(Dn)for(hn=(rn=Wt(Kt,Dn)).next;!(an=ct(hn,rn)).done;){if(Sn=(un=Wt(kt(an.value))).next,(En=ct(Sn,un)).done||(An=ct(Sn,un)).done||!ct(Sn,un).done)throw Fn("Expected sequence with length 2");cn(this.entries,{key:bt(En.value),value:bt(An.value)})}else for(var Bn in Kt)xt(Kt,Bn)&&cn(this.entries,{key:Bn,value:bt(Kt[Bn])})},parseQuery:function(Kt){if(Kt)for(var rn,hn,an=Wn(Kt,"&"),un=0;un<an.length;)(rn=an[un++]).length&&(hn=Wn(rn,"="),cn(this.entries,{key:kn(Qn(hn)),value:kn(tr(hn,"="))}))},serialize:function(){for(var Kt,rn=this.entries,hn=[],an=0;an<rn.length;)Kt=rn[an++],cn(hn,vt(Kt.key)+"="+vt(Kt.value));return tr(hn,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var wt=function(){St(this,Dt);var Kt=arguments.length>0?arguments[0]:void 0;dn(this,new Pt(Kt))},Dt=wt.prototype;if(ft(Dt,{append:function(Kt,rn){gn(arguments.length,2);var hn=mn(this);cn(hn.entries,{key:bt(Kt),value:bt(rn)}),hn.updateURL()},delete:function(Kt){gn(arguments.length,1);for(var rn=mn(this),hn=rn.entries,an=bt(Kt),un=0;un<hn.length;)hn[un].key===an?or(hn,un,1):un++;rn.updateURL()},get:function(Kt){gn(arguments.length,1);for(var rn=mn(this).entries,hn=bt(Kt),an=0;an<rn.length;an++)if(rn[an].key===hn)return rn[an].value;return null},getAll:function(Kt){gn(arguments.length,1);for(var rn=mn(this).entries,hn=bt(Kt),an=[],un=0;un<rn.length;un++)rn[un].key===hn&&cn(an,rn[un].value);return an},has:function(Kt){gn(arguments.length,1);for(var rn=mn(this).entries,hn=bt(Kt),an=0;an<rn.length;)if(rn[an++].key===hn)return!0;return!1},set:function(Kt,rn){gn(arguments.length,1);for(var hn,an=mn(this),un=an.entries,Sn=!1,En=bt(Kt),An=bt(rn),Dn=0;Dn<un.length;Dn++)(hn=un[Dn]).key===En&&(Sn?or(un,Dn--,1):(Sn=!0,hn.value=An));Sn||cn(un,{key:En,value:An}),an.updateURL()},sort:function(){var Kt=mn(this);Gt(Kt.entries,function(rn,hn){return rn.key>hn.key?1:-1}),Kt.updateURL()},forEach:function(Kt){for(var rn,hn=mn(this).entries,an=At(Kt,arguments.length>1?arguments[1]:void 0),un=0;un<hn.length;)an((rn=hn[un++]).value,rn.key,this)},keys:function(){return new Tt(this,"keys")},values:function(){return new Tt(this,"values")},entries:function(){return new Tt(this,"entries")}},{enumerable:!0}),st(Dt,fn,Dt.entries,{name:"entries"}),st(Dt,"toString",function(){return mn(this).serialize()},{enumerable:!0}),at(wt,Cn),tt({global:!0,constructor:!0,forced:!gt},{URLSearchParams:wt}),!gt&&It(Mn)){var Et=yt(wn.has),jt=yt(wn.set),Yt=function(Kt){if(Mt(Kt)){var rn,hn=Kt.body;if(Nt(hn)===Cn)return rn=Kt.headers?new Mn(Kt.headers):new Mn,Et(rn,"content-type")||jt(rn,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Bt(Kt,{body:Ht(0,bt(hn)),headers:Ht(0,rn)})}return Kt};if(It(On)&&tt({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(Kt){return On(Kt,arguments.length>1?Yt(arguments[1]):{})}}),It(_n)){var en=function(Kt){return St(this,Nn),new _n(Kt,arguments.length>1?Yt(arguments[1]):{})};Nn.constructor=en,en.prototype=Nn,tt({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:en})}}it.exports={URLSearchParams:wt,getState:mn}},1637:(it,ut,s)=>{s(5556)},8789:(it,ut,s)=>{s(8783);var tt,ot=s(2109),ct=s(9781),yt=s(590),pt=s(7854),gt=s(9974),st=s(1702),ft=s(8052),at=s(7045),ht=s(5787),mt=s(2597),St=s(1574),It=s(8457),xt=s(1589),At=s(8710).codeAt,Nt=s(3197),kt=s(1340),Mt=s(8003),bt=s(8053),Bt=s(5556),Ht=s(9909),Wt=Ht.set,nn=Ht.getterFor("URL"),gn=Bt.URLSearchParams,tn=Bt.getState,Gt=pt.URL,fn=pt.TypeError,Cn=pt.parseInt,Tn=Math.floor,dn=Math.pow,mn=st("".charAt),yn=st(/./.exec),pn=st([].join),In=st(1 .toString),On=st([].pop),_n=st([].push),Mn=st("".replace),Nn=st([].shift),wn=st("".split),Pn=st("".slice),Fn=st("".toLowerCase),ar=st([].unshift),Yn="Invalid scheme",Xn="Invalid host",tr="Invalid port",cn=/[a-z]/i,Hn=/[\d+-.a-z]/i,Qn=/\d/,or=/^0x/i,Wn=/^[0-7]+$/,ir=/^\d+$/,nr=/^[\da-f]+$/i,xn=/[\0\t\n\r #%/:<>?@[\\\]^|]/,Un=/[\0\t\n\r #/:<>?@[\\\]^|]/,vn=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,kn=/[\t\n\r]/g,qt=function(Vn){var zn,Zn,Rr,Gn;if(typeof Vn=="number"){for(zn=[],Zn=0;Zn<4;Zn++)ar(zn,Vn%256),Vn=Tn(Vn/256);return pn(zn,".")}if(typeof Vn=="object"){for(zn="",Rr=function(jr){for(var xr=null,Ir=1,jn=null,pr=0,_r=0;_r<8;_r++)jr[_r]!==0?(pr>Ir&&(xr=jn,Ir=pr),jn=null,pr=0):(jn===null&&(jn=_r),++pr);return pr>Ir&&(xr=jn,Ir=pr),xr}(Vn),Zn=0;Zn<8;Zn++)Gn&&Vn[Zn]===0||(Gn&&(Gn=!1),Rr===Zn?(zn+=Zn?":":"::",Gn=!0):(zn+=In(Vn[Zn],16),Zn<7&&(zn+=":")));return"["+zn+"]"}return Vn},Rt={},nt=St({},Rt,{" ":1,'"':1,"<":1,">":1,"`":1}),vt=St({},nt,{"#":1,"?":1,"{":1,"}":1}),Tt=St({},vt,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Pt=function(Vn,zn){var Zn=At(Vn,0);return Zn>32&&Zn<127&&!mt(zn,Vn)?Vn:encodeURIComponent(Vn)},wt={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Dt=function(Vn,zn){var Zn;return Vn.length==2&&yn(cn,mn(Vn,0))&&((Zn=mn(Vn,1))==":"||!zn&&Zn=="|")},Et=function(Vn){var zn;return Vn.length>1&&Dt(Pn(Vn,0,2))&&(Vn.length==2||(zn=mn(Vn,2))==="/"||zn==="\\"||zn==="?"||zn==="#")},jt=function(Vn){return Vn==="."||Fn(Vn)==="%2e"},Yt={},en={},Kt={},rn={},hn={},an={},un={},Sn={},En={},An={},Dn={},Bn={},sr={},fr={},Cr={},gr={},wr={},Nr={},qr={},Qr={},Sr={},Dr=function(Vn,zn,Zn){var Rr,Gn,jr,xr=kt(Vn);if(zn){if(Gn=this.parse(xr))throw fn(Gn);this.searchParams=null}else{if(Zn!==void 0&&(Rr=new Dr(Zn,!0)),Gn=this.parse(xr,null,Rr))throw fn(Gn);(jr=tn(new gn)).bindURL(this),this.searchParams=jr}};Dr.prototype={type:"URL",parse:function(Vn,zn,Zn){var Rr,Gn,jr,xr,Ir,jn=this,pr=zn||Yt,_r=0,yr="",Kr=!1,$r=!1,Co=!1;for(Vn=kt(Vn),zn||(jn.scheme="",jn.username="",jn.password="",jn.host=null,jn.port=null,jn.path=[],jn.query=null,jn.fragment=null,jn.cannotBeABaseURL=!1,Vn=Mn(Vn,vn,"")),Vn=Mn(Vn,kn,""),Rr=It(Vn);_r<=Rr.length;){switch(Gn=Rr[_r],pr){case Yt:if(!Gn||!yn(cn,Gn)){if(zn)return Yn;pr=Kt;continue}yr+=Fn(Gn),pr=en;break;case en:if(Gn&&(yn(Hn,Gn)||Gn=="+"||Gn=="-"||Gn=="."))yr+=Fn(Gn);else{if(Gn!=":"){if(zn)return Yn;yr="",pr=Kt,_r=0;continue}if(zn&&(jn.isSpecial()!=mt(wt,yr)||yr=="file"&&(jn.includesCredentials()||jn.port!==null)||jn.scheme=="file"&&!jn.host))return;if(jn.scheme=yr,zn)return void(jn.isSpecial()&&wt[jn.scheme]==jn.port&&(jn.port=null));yr="",jn.scheme=="file"?pr=fr:jn.isSpecial()&&Zn&&Zn.scheme==jn.scheme?pr=rn:jn.isSpecial()?pr=Sn:Rr[_r+1]=="/"?(pr=hn,_r++):(jn.cannotBeABaseURL=!0,_n(jn.path,""),pr=qr)}break;case Kt:if(!Zn||Zn.cannotBeABaseURL&&Gn!="#")return Yn;if(Zn.cannotBeABaseURL&&Gn=="#"){jn.scheme=Zn.scheme,jn.path=xt(Zn.path),jn.query=Zn.query,jn.fragment="",jn.cannotBeABaseURL=!0,pr=Sr;break}pr=Zn.scheme=="file"?fr:an;continue;case rn:if(Gn!="/"||Rr[_r+1]!="/"){pr=an;continue}pr=En,_r++;break;case hn:if(Gn=="/"){pr=An;break}pr=Nr;continue;case an:if(jn.scheme=Zn.scheme,Gn==tt)jn.username=Zn.username,jn.password=Zn.password,jn.host=Zn.host,jn.port=Zn.port,jn.path=xt(Zn.path),jn.query=Zn.query;else if(Gn=="/"||Gn=="\\"&&jn.isSpecial())pr=un;else if(Gn=="?")jn.username=Zn.username,jn.password=Zn.password,jn.host=Zn.host,jn.port=Zn.port,jn.path=xt(Zn.path),jn.query="",pr=Qr;else{if(Gn!="#"){jn.username=Zn.username,jn.password=Zn.password,jn.host=Zn.host,jn.port=Zn.port,jn.path=xt(Zn.path),jn.path.length--,pr=Nr;continue}jn.username=Zn.username,jn.password=Zn.password,jn.host=Zn.host,jn.port=Zn.port,jn.path=xt(Zn.path),jn.query=Zn.query,jn.fragment="",pr=Sr}break;case un:if(!jn.isSpecial()||Gn!="/"&&Gn!="\\"){if(Gn!="/"){jn.username=Zn.username,jn.password=Zn.password,jn.host=Zn.host,jn.port=Zn.port,pr=Nr;continue}pr=An}else pr=En;break;case Sn:if(pr=En,Gn!="/"||mn(yr,_r+1)!="/")continue;_r++;break;case En:if(Gn!="/"&&Gn!="\\"){pr=An;continue}break;case An:if(Gn=="@"){Kr&&(yr="%40"+yr),Kr=!0,jr=It(yr);for(var eo=0;eo<jr.length;eo++){var ga=jr[eo];if(ga!=":"||Co){var gs=Pt(ga,Tt);Co?jn.password+=gs:jn.username+=gs}else Co=!0}yr=""}else if(Gn==tt||Gn=="/"||Gn=="?"||Gn=="#"||Gn=="\\"&&jn.isSpecial()){if(Kr&&yr=="")return"Invalid authority";_r-=It(yr).length+1,yr="",pr=Dn}else yr+=Gn;break;case Dn:case Bn:if(zn&&jn.scheme=="file"){pr=gr;continue}if(Gn!=":"||$r){if(Gn==tt||Gn=="/"||Gn=="?"||Gn=="#"||Gn=="\\"&&jn.isSpecial()){if(jn.isSpecial()&&yr=="")return Xn;if(zn&&yr==""&&(jn.includesCredentials()||jn.port!==null))return;if(xr=jn.parseHost(yr))return xr;if(yr="",pr=wr,zn)return;continue}Gn=="["?$r=!0:Gn=="]"&&($r=!1),yr+=Gn}else{if(yr=="")return Xn;if(xr=jn.parseHost(yr))return xr;if(yr="",pr=sr,zn==Bn)return}break;case sr:if(!yn(Qn,Gn)){if(Gn==tt||Gn=="/"||Gn=="?"||Gn=="#"||Gn=="\\"&&jn.isSpecial()||zn){if(yr!=""){var Qo=Cn(yr,10);if(Qo>65535)return tr;jn.port=jn.isSpecial()&&Qo===wt[jn.scheme]?null:Qo,yr=""}if(zn)return;pr=wr;continue}return tr}yr+=Gn;break;case fr:if(jn.scheme="file",Gn=="/"||Gn=="\\")pr=Cr;else{if(!Zn||Zn.scheme!="file"){pr=Nr;continue}if(Gn==tt)jn.host=Zn.host,jn.path=xt(Zn.path),jn.query=Zn.query;else if(Gn=="?")jn.host=Zn.host,jn.path=xt(Zn.path),jn.query="",pr=Qr;else{if(Gn!="#"){Et(pn(xt(Rr,_r),""))||(jn.host=Zn.host,jn.path=xt(Zn.path),jn.shortenPath()),pr=Nr;continue}jn.host=Zn.host,jn.path=xt(Zn.path),jn.query=Zn.query,jn.fragment="",pr=Sr}}break;case Cr:if(Gn=="/"||Gn=="\\"){pr=gr;break}Zn&&Zn.scheme=="file"&&!Et(pn(xt(Rr,_r),""))&&(Dt(Zn.path[0],!0)?_n(jn.path,Zn.path[0]):jn.host=Zn.host),pr=Nr;continue;case gr:if(Gn==tt||Gn=="/"||Gn=="\\"||Gn=="?"||Gn=="#"){if(!zn&&Dt(yr))pr=Nr;else if(yr==""){if(jn.host="",zn)return;pr=wr}else{if(xr=jn.parseHost(yr))return xr;if(jn.host=="localhost"&&(jn.host=""),zn)return;yr="",pr=wr}continue}yr+=Gn;break;case wr:if(jn.isSpecial()){if(pr=Nr,Gn!="/"&&Gn!="\\")continue}else if(zn||Gn!="?")if(zn||Gn!="#"){if(Gn!=tt&&(pr=Nr,Gn!="/"))continue}else jn.fragment="",pr=Sr;else jn.query="",pr=Qr;break;case Nr:if(Gn==tt||Gn=="/"||Gn=="\\"&&jn.isSpecial()||!zn&&(Gn=="?"||Gn=="#")){if((Ir=Fn(Ir=yr))===".."||Ir==="%2e."||Ir===".%2e"||Ir==="%2e%2e"?(jn.shortenPath(),Gn=="/"||Gn=="\\"&&jn.isSpecial()||_n(jn.path,"")):jt(yr)?Gn=="/"||Gn=="\\"&&jn.isSpecial()||_n(jn.path,""):(jn.scheme=="file"&&!jn.path.length&&Dt(yr)&&(jn.host&&(jn.host=""),yr=mn(yr,0)+":"),_n(jn.path,yr)),yr="",jn.scheme=="file"&&(Gn==tt||Gn=="?"||Gn=="#"))for(;jn.path.length>1&&jn.path[0]==="";)Nn(jn.path);Gn=="?"?(jn.query="",pr=Qr):Gn=="#"&&(jn.fragment="",pr=Sr)}else yr+=Pt(Gn,vt);break;case qr:Gn=="?"?(jn.query="",pr=Qr):Gn=="#"?(jn.fragment="",pr=Sr):Gn!=tt&&(jn.path[0]+=Pt(Gn,Rt));break;case Qr:zn||Gn!="#"?Gn!=tt&&(Gn=="'"&&jn.isSpecial()?jn.query+="%27":jn.query+=Gn=="#"?"%23":Pt(Gn,Rt)):(jn.fragment="",pr=Sr);break;case Sr:Gn!=tt&&(jn.fragment+=Pt(Gn,nt))}_r++}},parseHost:function(Vn){var zn,Zn,Rr;if(mn(Vn,0)=="["){if(mn(Vn,Vn.length-1)!="]"||(zn=function(Gn){var jr,xr,Ir,jn,pr,_r,yr,Kr=[0,0,0,0,0,0,0,0],$r=0,Co=null,eo=0,ga=function(){return mn(Gn,eo)};if(ga()==":"){if(mn(Gn,1)!=":")return;eo+=2,Co=++$r}for(;ga();){if($r==8)return;if(ga()!=":"){for(jr=xr=0;xr<4&&yn(nr,ga());)jr=16*jr+Cn(ga(),16),eo++,xr++;if(ga()=="."){if(xr==0||(eo-=xr,$r>6))return;for(Ir=0;ga();){if(jn=null,Ir>0){if(!(ga()=="."&&Ir<4))return;eo++}if(!yn(Qn,ga()))return;for(;yn(Qn,ga());){if(pr=Cn(ga(),10),jn===null)jn=pr;else{if(jn==0)return;jn=10*jn+pr}if(jn>255)return;eo++}Kr[$r]=256*Kr[$r]+jn,++Ir!=2&&Ir!=4||$r++}if(Ir!=4)return;break}if(ga()==":"){if(eo++,!ga())return}else if(ga())return;Kr[$r++]=jr}else{if(Co!==null)return;eo++,Co=++$r}}if(Co!==null)for(_r=$r-Co,$r=7;$r!=0&&_r>0;)yr=Kr[$r],Kr[$r--]=Kr[Co+_r-1],Kr[Co+--_r]=yr;else if($r!=8)return;return Kr}(Pn(Vn,1,-1)),!zn))return Xn;this.host=zn}else if(this.isSpecial()){if(Vn=Nt(Vn),yn(xn,Vn)||(zn=function(Gn){var jr,xr,Ir,jn,pr,_r,yr,Kr=wn(Gn,".");if(Kr.length&&Kr[Kr.length-1]==""&&Kr.length--,(jr=Kr.length)>4)return Gn;for(xr=[],Ir=0;Ir<jr;Ir++){if((jn=Kr[Ir])=="")return Gn;if(pr=10,jn.length>1&&mn(jn,0)=="0"&&(pr=yn(or,jn)?16:8,jn=Pn(jn,pr==8?1:2)),jn==="")_r=0;else{if(!yn(pr==10?ir:pr==8?Wn:nr,jn))return Gn;_r=Cn(jn,pr)}_n(xr,_r)}for(Ir=0;Ir<jr;Ir++)if(_r=xr[Ir],Ir==jr-1){if(_r>=dn(256,5-jr))return null}else if(_r>255)return null;for(yr=On(xr),Ir=0;Ir<xr.length;Ir++)yr+=xr[Ir]*dn(256,3-Ir);return yr}(Vn),zn===null))return Xn;this.host=zn}else{if(yn(Un,Vn))return Xn;for(zn="",Zn=It(Vn),Rr=0;Rr<Zn.length;Rr++)zn+=Pt(Zn[Rr],Rt);this.host=zn}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return mt(wt,this.scheme)},shortenPath:function(){var Vn=this.path,zn=Vn.length;!zn||this.scheme=="file"&&zn==1&&Dt(Vn[0],!0)||Vn.length--},serialize:function(){var Vn=this,zn=Vn.scheme,Zn=Vn.username,Rr=Vn.password,Gn=Vn.host,jr=Vn.port,xr=Vn.path,Ir=Vn.query,jn=Vn.fragment,pr=zn+":";return Gn!==null?(pr+="//",Vn.includesCredentials()&&(pr+=Zn+(Rr?":"+Rr:"")+"@"),pr+=qt(Gn),jr!==null&&(pr+=":"+jr)):zn=="file"&&(pr+="//"),pr+=Vn.cannotBeABaseURL?xr[0]:xr.length?"/"+pn(xr,"/"):"",Ir!==null&&(pr+="?"+Ir),jn!==null&&(pr+="#"+jn),pr},setHref:function(Vn){var zn=this.parse(Vn);if(zn)throw fn(zn);this.searchParams.update()},getOrigin:function(){var Vn=this.scheme,zn=this.port;if(Vn=="blob")try{return new Er(Vn.path[0]).origin}catch{return"null"}return Vn!="file"&&this.isSpecial()?Vn+"://"+qt(this.host)+(zn!==null?":"+zn:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(Vn){this.parse(kt(Vn)+":",Yt)},getUsername:function(){return this.username},setUsername:function(Vn){var zn=It(kt(Vn));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var Zn=0;Zn<zn.length;Zn++)this.username+=Pt(zn[Zn],Tt)}},getPassword:function(){return this.password},setPassword:function(Vn){var zn=It(kt(Vn));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var Zn=0;Zn<zn.length;Zn++)this.password+=Pt(zn[Zn],Tt)}},getHost:function(){var Vn=this.host,zn=this.port;return Vn===null?"":zn===null?qt(Vn):qt(Vn)+":"+zn},setHost:function(Vn){this.cannotBeABaseURL||this.parse(Vn,Dn)},getHostname:function(){var Vn=this.host;return Vn===null?"":qt(Vn)},setHostname:function(Vn){this.cannotBeABaseURL||this.parse(Vn,Bn)},getPort:function(){var Vn=this.port;return Vn===null?"":kt(Vn)},setPort:function(Vn){this.cannotHaveUsernamePasswordPort()||((Vn=kt(Vn))==""?this.port=null:this.parse(Vn,sr))},getPathname:function(){var Vn=this.path;return this.cannotBeABaseURL?Vn[0]:Vn.length?"/"+pn(Vn,"/"):""},setPathname:function(Vn){this.cannotBeABaseURL||(this.path=[],this.parse(Vn,wr))},getSearch:function(){var Vn=this.query;return Vn?"?"+Vn:""},setSearch:function(Vn){(Vn=kt(Vn))==""?this.query=null:(mn(Vn,0)=="?"&&(Vn=Pn(Vn,1)),this.query="",this.parse(Vn,Qr)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var Vn=this.fragment;return Vn?"#"+Vn:""},setHash:function(Vn){(Vn=kt(Vn))!=""?(mn(Vn,0)=="#"&&(Vn=Pn(Vn,1)),this.fragment="",this.parse(Vn,Sr)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Er=function(Vn){var zn=ht(this,Or),Zn=bt(arguments.length,1)>1?arguments[1]:void 0,Rr=Wt(zn,new Dr(Vn,!1,Zn));ct||(zn.href=Rr.serialize(),zn.origin=Rr.getOrigin(),zn.protocol=Rr.getProtocol(),zn.username=Rr.getUsername(),zn.password=Rr.getPassword(),zn.host=Rr.getHost(),zn.hostname=Rr.getHostname(),zn.port=Rr.getPort(),zn.pathname=Rr.getPathname(),zn.search=Rr.getSearch(),zn.searchParams=Rr.getSearchParams(),zn.hash=Rr.getHash())},Or=Er.prototype,Lr=function(Vn,zn){return{get:function(){return nn(this)[Vn]()},set:zn&&function(Zn){return nn(this)[zn](Zn)},configurable:!0,enumerable:!0}};if(ct&&(at(Or,"href",Lr("serialize","setHref")),at(Or,"origin",Lr("getOrigin")),at(Or,"protocol",Lr("getProtocol","setProtocol")),at(Or,"username",Lr("getUsername","setUsername")),at(Or,"password",Lr("getPassword","setPassword")),at(Or,"host",Lr("getHost","setHost")),at(Or,"hostname",Lr("getHostname","setHostname")),at(Or,"port",Lr("getPort","setPort")),at(Or,"pathname",Lr("getPathname","setPathname")),at(Or,"search",Lr("getSearch","setSearch")),at(Or,"searchParams",Lr("getSearchParams")),at(Or,"hash",Lr("getHash","setHash"))),ft(Or,"toJSON",function(){return nn(this).serialize()},{enumerable:!0}),ft(Or,"toString",function(){return nn(this).serialize()},{enumerable:!0}),Gt){var Hr=Gt.createObjectURL,na=Gt.revokeObjectURL;Hr&&ft(Er,"createObjectURL",gt(Hr,Gt)),na&&ft(Er,"revokeObjectURL",gt(na,Gt))}Mt(Er,"URL"),ot({global:!0,constructor:!0,forced:!yt,sham:!ct},{URL:Er})},285:(it,ut,s)=>{s(8789)},3753:(it,ut,s)=>{var tt=s(2109),ot=s(6916);tt({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return ot(URL.prototype.toString,this)}})},7987:function(it,ut,s){var tt,ot;tt=function(ct){var yt,pt,gt={template:"[%t] %l:",levelFormatter:function(at){return at.toUpperCase()},nameFormatter:function(at){return at||"root"},timestampFormatter:function(at){return at.toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1")},format:void 0},st={},ft={reg:function(at){if(!at||!at.getLogger)throw new TypeError("Argument is not a root logger");yt=at},apply:function(at,ht){if(!at||!at.setLevel)throw new TypeError("Argument is not a logger");var mt=at.methodFactory,St=at.name||"",It=st[St]||st[""]||gt;return st[St]||(at.methodFactory=function(xt,At,Nt){var kt=mt(xt,At,Nt),Mt=st[Nt]||st[""],bt=Mt.template.indexOf("%t")!==-1,Bt=Mt.template.indexOf("%l")!==-1,Ht=Mt.template.indexOf("%n")!==-1;return function(){for(var Wt="",nn=arguments.length,gn=Array(nn),tn=0;tn<nn;tn++)gn[tn]=arguments[tn];if(St||!st[Nt]){var Gt=Mt.timestampFormatter(new Date),fn=Mt.levelFormatter(xt),Cn=Mt.nameFormatter(Nt);Mt.format?Wt+=Mt.format(fn,Cn,Gt):(Wt+=Mt.template,bt&&(Wt=Wt.replace(/%t/,Gt)),Bt&&(Wt=Wt.replace(/%l/,fn)),Ht&&(Wt=Wt.replace(/%n/,Cn))),gn.length&&typeof gn[0]=="string"?gn[0]=Wt+" "+gn[0]:gn.unshift(Wt)}kt.apply(void 0,gn)}}),(ht=ht||{}).template&&(ht.format=void 0),st[St]=function(xt){for(var At,Nt=1,kt=arguments.length;Nt<kt;Nt++)for(At in arguments[Nt])Object.prototype.hasOwnProperty.call(arguments[Nt],At)&&(xt[At]=arguments[Nt][At]);return xt}({},It,ht),at.setLevel(at.getLevel()),yt||at.warn("It is necessary to call the function reg() of loglevel-plugin-prefix before calling apply. From the next release, it will throw an error. See more: https://github.com/kutuluk/loglevel-plugin-prefix/blob/master/README.md"),at}};return ct&&(pt=ct.prefix,ft.noConflict=function(){return ct.prefix===ft&&(ct.prefix=pt),ft}),ft},(ot=tt.call(ut,s,ut,it))===void 0||(it.exports=ot)},2043:function(it,ut,s){var tt,ot;(function(ct,yt){tt=function(){var pt=function(){},gt="undefined",st=typeof window!==gt&&typeof window.navigator!==gt&&/Trident\/|MSIE /.test(window.navigator.userAgent),ft=["trace","debug","info","warn","error"];function at(bt,Bt){var Ht=bt[Bt];if(typeof Ht.bind=="function")return Ht.bind(bt);try{return Function.prototype.bind.call(Ht,bt)}catch{return function(){return Function.prototype.apply.apply(Ht,[bt,arguments])}}}function ht(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function mt(bt){return bt==="debug"&&(bt="log"),typeof console!==gt&&(bt==="trace"&&st?ht:console[bt]!==void 0?at(console,bt):console.log!==void 0?at(console,"log"):pt)}function St(bt,Bt){for(var Ht=0;Ht<ft.length;Ht++){var Wt=ft[Ht];this[Wt]=Ht<bt?pt:this.methodFactory(Wt,bt,Bt)}this.log=this.debug}function It(bt,Bt,Ht){return function(){typeof console!==gt&&(St.call(this,Bt,Ht),this[bt].apply(this,arguments))}}function xt(bt,Bt,Ht){return mt(bt)||It.apply(this,arguments)}function At(bt,Bt,Ht){var Wt,nn=this;Bt=Bt??"WARN";var gn="loglevel";function tn(){var fn;if(typeof window!==gt&&gn){try{fn=window.localStorage[gn]}catch{}if(typeof fn===gt)try{var Cn=window.document.cookie,Tn=Cn.indexOf(encodeURIComponent(gn)+"=");Tn!==-1&&(fn=/^([^;]+)/.exec(Cn.slice(Tn))[1])}catch{}return nn.levels[fn]===void 0&&(fn=void 0),fn}}typeof bt=="string"?gn+=":"+bt:typeof bt=="symbol"&&(gn=void 0),nn.name=bt,nn.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},nn.methodFactory=Ht||xt,nn.getLevel=function(){return Wt},nn.setLevel=function(fn,Cn){if(typeof fn=="string"&&nn.levels[fn.toUpperCase()]!==void 0&&(fn=nn.levels[fn.toUpperCase()]),!(typeof fn=="number"&&fn>=0&&fn<=nn.levels.SILENT))throw"log.setLevel() called with invalid level: "+fn;if(Wt=fn,Cn!==!1&&function(Tn){var dn=(ft[Tn]||"silent").toUpperCase();if(typeof window!==gt&&gn){try{return void(window.localStorage[gn]=dn)}catch{}try{window.document.cookie=encodeURIComponent(gn)+"="+dn+";"}catch{}}}(fn),St.call(nn,fn,bt),typeof console===gt&&fn<nn.levels.SILENT)return"No console available for logging"},nn.setDefaultLevel=function(fn){Bt=fn,tn()||nn.setLevel(fn,!1)},nn.resetLevel=function(){nn.setLevel(Bt,!1),function(){if(typeof window!==gt&&gn){try{return void window.localStorage.removeItem(gn)}catch{}try{window.document.cookie=encodeURIComponent(gn)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}()},nn.enableAll=function(fn){nn.setLevel(nn.levels.TRACE,fn)},nn.disableAll=function(fn){nn.setLevel(nn.levels.SILENT,fn)};var Gt=tn();Gt==null&&(Gt=Bt),nn.setLevel(Gt,!1)}var Nt=new At,kt={};Nt.getLogger=function(bt){if(typeof bt!="symbol"&&typeof bt!="string"||bt==="")throw new TypeError("You must supply a name when creating a logger.");var Bt=kt[bt];return Bt||(Bt=kt[bt]=new At(bt,Nt.getLevel(),Nt.methodFactory)),Bt};var Mt=typeof window!==gt?window.log:void 0;return Nt.noConflict=function(){return typeof window!==gt&&window.log===Nt&&(window.log=Mt),Nt},Nt.getLoggers=function(){return kt},Nt.default=Nt,Nt},(ot=tt.call(ut,s,ut,it))===void 0||(it.exports=ot)})()},7618:it=>{function ut(Wt,nn){if(!tt)return!1;const gn=Wt.buffer;let tn=at.get(gn);if(tn==null){if((tn=s.validate(gn))&&nn)try{new s.Instance(new s.Module(gn)).exports[0]()}catch{tn=!1}at.set(gn,tn)}return tn}const s=globalThis.WebAssembly,tt=typeof s=="object",ot=Wt=>Wt!==void 0,ct=(...Wt)=>Uint8Array.of(0,97,115,109,1,0,0,0,...Wt),yt=(...Wt)=>Uint32Array.of(1836278016,1,...Wt),pt=(...Wt)=>yt(1610679297,33751040,...Wt,40239360,259),gt=(...Wt)=>ct(1,4,1,96,0,0,3,2,1,0,...Wt,11,0,10,4,110,97,109,101,2,3,1,0,0),st=(...Wt)=>Uint16Array.of(24832,28019,1,0,1025,24577,0,515,1,...Wt),ft=(...Wt)=>st(...Wt,2842,4096,28164,28001,357,260,256,560,259,0),at=new WeakMap,ht=yt(1610679553,58589440,117440770,805372165,101318656,1107297281,268438272,1835101700,17039717,36700416,259),mt=ct(5,3,1,4,1,0,8,4,110,97,109,101,2,1,0),St=st(773,1,2561,269,11,65,65,65,3068,2816,2560,28164,28001,613,259,0),It=yt(1610679297,33751040,134873089,100664833,185276736),xt=ct(2,8,1,1,97,1,98,3,127,1,6,6,1,127,1,65,0,11,7,5,1,1,97,3,1,0,8,4,110,97,109,101,2,1,0),At=Uint16Array.of(24832,28019,1,0,1537,24577,512,32639,515,1,2058,1537,16640,16640,2816,2560,28164,28001,613,259,0),Nt=ft(3082,2561,17152,0,0,252),kt=ft(2058,1537,16640,49152),Mt=pt(101318657,301990913,268438272,1835101700,17039717),bt=gt(5,4,1,3,1,1,10,7,1,5,0,254,3,0),Bt=pt(84344833,6357249,17369600,4259847,186257917,1845758464),Ht=gt(10,7,1,5,0,208,112,26);it.exports={support:(Wt=1)=>tt&&ut(Uint32Array.of(1836278016,Wt)),get supportStreaming(){return tt&&ot(s.instantiateStreaming)},feature:{get bigInt(){return ut(ht,!0)},get bulk(){return ut(St)},get exceptions(){return ut(It)},get memory64(){return ut(mt)},get mutableGlobal(){return ut(xt)},get multiValue(){return ut(At)},get saturateConversions(){return ut(Nt)},get signExtensions(){return ut(kt)},get tailCall(){return ut(Mt)},get threads(){return ut(bt)},get simd(){return ut(Bt)},get references(){return ut(Ht)},get typeReflection(){return tt&&ot(s.Memory.type)},get funcReferences(){return tt&&ot(s.Function)}}}}},rt={};function lt(it){var ut=rt[it];if(ut!==void 0)return ut.exports;var s=rt[it]={id:it,loaded:!1,exports:{}};return et[it].call(s.exports,s,s.exports,lt),s.loaded=!0,s.exports}return lt.amdO={},lt.n=it=>{var ut=it&&it.__esModule?()=>it.default:()=>it;return lt.d(ut,{a:ut}),ut},lt.d=(it,ut)=>{for(var s in ut)lt.o(ut,s)&&!lt.o(it,s)&&Object.defineProperty(it,s,{enumerable:!0,get:ut[s]})},lt.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),lt.hmd=it=>((it=Object.create(it)).children||(it.children=[]),Object.defineProperty(it,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+it.id)}}),it),lt.o=(it,ut)=>Object.prototype.hasOwnProperty.call(it,ut),lt.r=it=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(it,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(it,"__esModule",{value:!0})},lt(1256)})())})(apiRTC_min,apiRTC_min.exports);var apiRTC_minExports=apiRTC_min.exports;function _objectWithoutPropertiesLoose(a,o){if(a==null)return{};var _e={},et=Object.keys(a),rt,lt;for(lt=0;lt<et.length;lt++)rt=et[lt],!(o.indexOf(rt)>=0)&&(_e[rt]=a[rt]);return _e}function _extends(){return _extends=Object.assign?Object.assign.bind():function(a){for(var o=1;o<arguments.length;o++){var _e=arguments[o];for(var et in _e)Object.prototype.hasOwnProperty.call(_e,et)&&(a[et]=_e[et])}return a},_extends.apply(this,arguments)}function r$1(a){var o,_e,et="";if(typeof a=="string"||typeof a=="number")et+=a;else if(typeof a=="object")if(Array.isArray(a))for(o=0;o<a.length;o++)a[o]&&(_e=r$1(a[o]))&&(et&&(et+=" "),et+=_e);else for(o in a)a[o]&&(et&&(et+=" "),et+=o);return et}function clsx(){for(var a,o,_e=0,et="";_e<arguments.length;)(a=arguments[_e++])&&(o=r$1(a))&&(et&&(et+=" "),et+=o);return et}function isPlainObject(a){return a!==null&&typeof a=="object"&&a.constructor===Object}function deepClone(a){if(!isPlainObject(a))return a;const o={};return Object.keys(a).forEach(_e=>{o[_e]=deepClone(a[_e])}),o}function deepmerge(a,o,_e={clone:!0}){const et=_e.clone?_extends({},a):a;return isPlainObject(a)&&isPlainObject(o)&&Object.keys(o).forEach(rt=>{rt!=="__proto__"&&(isPlainObject(o[rt])&&rt in a&&isPlainObject(a[rt])?et[rt]=deepmerge(a[rt],o[rt],_e):_e.clone?et[rt]=isPlainObject(o[rt])?deepClone(o[rt]):o[rt]:et[rt]=o[rt])}),et}function formatMuiErrorMessage(a){let o="https://mui.com/production-error/?code="+a;for(let _e=1;_e<arguments.length;_e+=1)o+="&args[]="+encodeURIComponent(arguments[_e]);return"Minified MUI error #"+a+"; visit "+o+" for the full message."}var reactIs_production_min$1={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b$2=Symbol.for("react.element"),c$2=Symbol.for("react.portal"),d$2=Symbol.for("react.fragment"),e$1=Symbol.for("react.strict_mode"),f$1=Symbol.for("react.profiler"),g$2=Symbol.for("react.provider"),h$2=Symbol.for("react.context"),k$1=Symbol.for("react.server_context"),l$1=Symbol.for("react.forward_ref"),m$2=Symbol.for("react.suspense"),n$1=Symbol.for("react.suspense_list"),p$1=Symbol.for("react.memo"),q$2=Symbol.for("react.lazy"),t$1=Symbol.for("react.offscreen"),u$1;u$1=Symbol.for("react.module.reference");function v$2(a){if(typeof a=="object"&&a!==null){var o=a.$$typeof;switch(o){case b$2:switch(a=a.type,a){case d$2:case f$1:case e$1:case m$2:case n$1:return a;default:switch(a=a&&a.$$typeof,a){case k$1:case h$2:case l$1:case q$2:case p$1:case g$2:return a;default:return o}}case c$2:return o}}}reactIs_production_min$1.ContextConsumer=h$2;reactIs_production_min$1.ContextProvider=g$2;reactIs_production_min$1.Element=b$2;reactIs_production_min$1.ForwardRef=l$1;reactIs_production_min$1.Fragment=d$2;reactIs_production_min$1.Lazy=q$2;reactIs_production_min$1.Memo=p$1;reactIs_production_min$1.Portal=c$2;reactIs_production_min$1.Profiler=f$1;reactIs_production_min$1.StrictMode=e$1;reactIs_production_min$1.Suspense=m$2;reactIs_production_min$1.SuspenseList=n$1;reactIs_production_min$1.isAsyncMode=function(){return!1};reactIs_production_min$1.isConcurrentMode=function(){return!1};reactIs_production_min$1.isContextConsumer=function(a){return v$2(a)===h$2};reactIs_production_min$1.isContextProvider=function(a){return v$2(a)===g$2};reactIs_production_min$1.isElement=function(a){return typeof a=="object"&&a!==null&&a.$$typeof===b$2};reactIs_production_min$1.isForwardRef=function(a){return v$2(a)===l$1};reactIs_production_min$1.isFragment=function(a){return v$2(a)===d$2};reactIs_production_min$1.isLazy=function(a){return v$2(a)===q$2};reactIs_production_min$1.isMemo=function(a){return v$2(a)===p$1};reactIs_production_min$1.isPortal=function(a){return v$2(a)===c$2};reactIs_production_min$1.isProfiler=function(a){return v$2(a)===f$1};reactIs_production_min$1.isStrictMode=function(a){return v$2(a)===e$1};reactIs_production_min$1.isSuspense=function(a){return v$2(a)===m$2};reactIs_production_min$1.isSuspenseList=function(a){return v$2(a)===n$1};reactIs_production_min$1.isValidElementType=function(a){return typeof a=="string"||typeof a=="function"||a===d$2||a===f$1||a===e$1||a===m$2||a===n$1||a===t$1||typeof a=="object"&&a!==null&&(a.$$typeof===q$2||a.$$typeof===p$1||a.$$typeof===g$2||a.$$typeof===h$2||a.$$typeof===l$1||a.$$typeof===u$1||a.getModuleId!==void 0)};reactIs_production_min$1.typeOf=v$2;function capitalize(a){if(typeof a!="string")throw new Error(formatMuiErrorMessage(7));return a.charAt(0).toUpperCase()+a.slice(1)}function createChainedFunction(...a){return a.reduce((o,_e)=>_e==null?o:function(...rt){o.apply(this,rt),_e.apply(this,rt)},()=>{})}function debounce$1(a,o=166){let _e;function et(...rt){const lt=()=>{a.apply(this,rt)};clearTimeout(_e),_e=setTimeout(lt,o)}return et.clear=()=>{clearTimeout(_e)},et}function ownerDocument(a){return a&&a.ownerDocument||document}function ownerWindow(a){return ownerDocument(a).defaultView||window}function setRef(a,o){typeof a=="function"?a(o):a&&(a.current=o)}const useEnhancedEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,useEnhancedEffect$1=useEnhancedEffect;let globalId=0;function useGlobalId(a){const[o,_e]=reactExports.useState(a),et=a||o;return reactExports.useEffect(()=>{o==null&&(globalId+=1,_e(`mui-${globalId}`))},[o]),et}const maybeReactUseId=React$2["useId"];function useId(a){if(maybeReactUseId!==void 0){const o=maybeReactUseId();return a??o}return useGlobalId(a)}function useControlled({controlled:a,default:o,name:_e,state:et="value"}){const{current:rt}=reactExports.useRef(a!==void 0),[lt,it]=reactExports.useState(o),ut=rt?a:lt,s=reactExports.useCallback(tt=>{rt||it(tt)},[]);return[ut,s]}function useEventCallback(a){const o=reactExports.useRef(a);return useEnhancedEffect$1(()=>{o.current=a}),reactExports.useCallback((..._e)=>(0,o.current)(..._e),[])}function useForkRef(...a){return reactExports.useMemo(()=>a.every(o=>o==null)?null:o=>{a.forEach(_e=>{setRef(_e,o)})},a)}let hadKeyboardEvent=!0,hadFocusVisibleRecently=!1,hadFocusVisibleRecentlyTimeout;const inputTypesWhitelist={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function focusTriggersKeyboardModality(a){const{type:o,tagName:_e}=a;return!!(_e==="INPUT"&&inputTypesWhitelist[o]&&!a.readOnly||_e==="TEXTAREA"&&!a.readOnly||a.isContentEditable)}function handleKeyDown(a){a.metaKey||a.altKey||a.ctrlKey||(hadKeyboardEvent=!0)}function handlePointerDown(){hadKeyboardEvent=!1}function handleVisibilityChange(){this.visibilityState==="hidden"&&hadFocusVisibleRecently&&(hadKeyboardEvent=!0)}function prepare(a){a.addEventListener("keydown",handleKeyDown,!0),a.addEventListener("mousedown",handlePointerDown,!0),a.addEventListener("pointerdown",handlePointerDown,!0),a.addEventListener("touchstart",handlePointerDown,!0),a.addEventListener("visibilitychange",handleVisibilityChange,!0)}function isFocusVisible(a){const{target:o}=a;try{return o.matches(":focus-visible")}catch{}return hadKeyboardEvent||focusTriggersKeyboardModality(o)}function useIsFocusVisible(){const a=reactExports.useCallback(rt=>{rt!=null&&prepare(rt.ownerDocument)},[]),o=reactExports.useRef(!1);function _e(){return o.current?(hadFocusVisibleRecently=!0,window.clearTimeout(hadFocusVisibleRecentlyTimeout),hadFocusVisibleRecentlyTimeout=window.setTimeout(()=>{hadFocusVisibleRecently=!1},100),o.current=!1,!0):!1}function et(rt){return isFocusVisible(rt)?(o.current=!0,!0):!1}return{isFocusVisibleRef:o,onFocus:et,onBlur:_e,ref:a}}function getScrollbarSize(a){const o=a.documentElement.clientWidth;return Math.abs(window.innerWidth-o)}function resolveProps(a,o){const _e=_extends({},o);return Object.keys(a).forEach(et=>{if(et.toString().match(/^(components|slots)$/))_e[et]=_extends({},a[et],_e[et]);else if(et.toString().match(/^(componentsProps|slotProps)$/)){const rt=a[et]||{},lt=o[et];_e[et]={},!lt||!Object.keys(lt)?_e[et]=rt:!rt||!Object.keys(rt)?_e[et]=lt:(_e[et]=_extends({},lt),Object.keys(rt).forEach(it=>{_e[et][it]=resolveProps(rt[it],lt[it])}))}else _e[et]===void 0&&(_e[et]=a[et])}),_e}function composeClasses(a,o,_e=void 0){const et={};return Object.keys(a).forEach(rt=>{et[rt]=a[rt].reduce((lt,it)=>{if(it){const ut=o(it);ut!==""&&lt.push(ut),_e&&_e[it]&&lt.push(_e[it])}return lt},[]).join(" ")}),et}const defaultGenerator=a=>a,createClassNameGenerator=()=>{let a=defaultGenerator;return{configure(o){a=o},generate(o){return a(o)},reset(){a=defaultGenerator}}},ClassNameGenerator=createClassNameGenerator(),ClassNameGenerator$1=ClassNameGenerator,globalStateClassesMapping={active:"active",checked:"checked",completed:"completed",disabled:"disabled",readOnly:"readOnly",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",required:"required",selected:"selected"};function generateUtilityClass(a,o,_e="Mui"){const et=globalStateClassesMapping[o];return et?`${_e}-${et}`:`${ClassNameGenerator$1.generate(a)}-${o}`}function generateUtilityClasses(a,o,_e="Mui"){const et={};return o.forEach(rt=>{et[rt]=generateUtilityClass(a,rt,_e)}),et}function memoize$1(a){var o=Object.create(null);return function(_e){return o[_e]===void 0&&(o[_e]=a(_e)),o[_e]}}var reactPropsRegex=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,isPropValid=memoize$1(function(a){return reactPropsRegex.test(a)||a.charCodeAt(0)===111&&a.charCodeAt(1)===110&&a.charCodeAt(2)<91});function sheetForTag(a){if(a.sheet)return a.sheet;for(var o=0;o<document.styleSheets.length;o++)if(document.styleSheets[o].ownerNode===a)return document.styleSheets[o]}function createStyleElement(a){var o=document.createElement("style");return o.setAttribute("data-emotion",a.key),a.nonce!==void 0&&o.setAttribute("nonce",a.nonce),o.appendChild(document.createTextNode("")),o.setAttribute("data-s",""),o}var StyleSheet=function(){function a(_e){var et=this;this._insertTag=function(rt){var lt;et.tags.length===0?et.insertionPoint?lt=et.insertionPoint.nextSibling:et.prepend?lt=et.container.firstChild:lt=et.before:lt=et.tags[et.tags.length-1].nextSibling,et.container.insertBefore(rt,lt),et.tags.push(rt)},this.isSpeedy=_e.speedy===void 0?!0:_e.speedy,this.tags=[],this.ctr=0,this.nonce=_e.nonce,this.key=_e.key,this.container=_e.container,this.prepend=_e.prepend,this.insertionPoint=_e.insertionPoint,this.before=null}var o=a.prototype;return o.hydrate=function(et){et.forEach(this._insertTag)},o.insert=function(et){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(createStyleElement(this));var rt=this.tags[this.tags.length-1];if(this.isSpeedy){var lt=sheetForTag(rt);try{lt.insertRule(et,lt.cssRules.length)}catch{}}else rt.appendChild(document.createTextNode(et));this.ctr++},o.flush=function(){this.tags.forEach(function(et){return et.parentNode&&et.parentNode.removeChild(et)}),this.tags=[],this.ctr=0},a}(),MS="-ms-",MOZ="-moz-",WEBKIT="-webkit-",COMMENT="comm",RULESET="rule",DECLARATION="decl",IMPORT="@import",KEYFRAMES="@keyframes",abs=Math.abs,from=String.fromCharCode,assign=Object.assign;function hash$2(a,o){return charat(a,0)^45?(((o<<2^charat(a,0))<<2^charat(a,1))<<2^charat(a,2))<<2^charat(a,3):0}function trim(a){return a.trim()}function match(a,o){return(a=o.exec(a))?a[0]:a}function replace(a,o,_e){return a.replace(o,_e)}function indexof(a,o){return a.indexOf(o)}function charat(a,o){return a.charCodeAt(o)|0}function substr(a,o,_e){return a.slice(o,_e)}function strlen(a){return a.length}function sizeof(a){return a.length}function append(a,o){return o.push(a),a}function combine(a,o){return a.map(o).join("")}var line=1,column=1,length=0,position=0,character=0,characters="";function node(a,o,_e,et,rt,lt,it){return{value:a,root:o,parent:_e,type:et,props:rt,children:lt,line,column,length:it,return:""}}function copy(a,o){return assign(node("",null,null,"",null,null,0),a,{length:-a.length},o)}function char(){return character}function prev(){return character=position>0?charat(characters,--position):0,column--,character===10&&(column=1,line--),character}function next(){return character=position<length?charat(characters,position++):0,column++,character===10&&(column=1,line++),character}function peek(){return charat(characters,position)}function caret(){return position}function slice(a,o){return substr(characters,a,o)}function token(a){switch(a){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function alloc(a){return line=column=1,length=strlen(characters=a),position=0,[]}function dealloc(a){return characters="",a}function delimit(a){return trim(slice(position-1,delimiter(a===91?a+2:a===40?a+1:a)))}function whitespace(a){for(;(character=peek())&&character<33;)next();return token(a)>2||token(character)>3?"":" "}function escaping(a,o){for(;--o&&next()&&!(character<48||character>102||character>57&&character<65||character>70&&character<97););return slice(a,caret()+(o<6&&peek()==32&&next()==32))}function delimiter(a){for(;next();)switch(character){case a:return position;case 34:case 39:a!==34&&a!==39&&delimiter(character);break;case 40:a===41&&delimiter(a);break;case 92:next();break}return position}function commenter(a,o){for(;next()&&a+character!==47+10;)if(a+character===42+42&&peek()===47)break;return"/*"+slice(o,position-1)+"*"+from(a===47?a:next())}function identifier(a){for(;!token(peek());)next();return slice(a,position)}function compile(a){return dealloc(parse("",null,null,null,[""],a=alloc(a),0,[0],a))}function parse(a,o,_e,et,rt,lt,it,ut,s){for(var tt=0,ot=0,ct=it,yt=0,pt=0,gt=0,st=1,ft=1,at=1,ht=0,mt="",St=rt,It=lt,xt=et,At=mt;ft;)switch(gt=ht,ht=next()){case 40:if(gt!=108&&charat(At,ct-1)==58){indexof(At+=replace(delimit(ht),"&","&\f"),"&\f")!=-1&&(at=-1);break}case 34:case 39:case 91:At+=delimit(ht);break;case 9:case 10:case 13:case 32:At+=whitespace(gt);break;case 92:At+=escaping(caret()-1,7);continue;case 47:switch(peek()){case 42:case 47:append(comment(commenter(next(),caret()),o,_e),s);break;default:At+="/"}break;case 123*st:ut[tt++]=strlen(At)*at;case 125*st:case 59:case 0:switch(ht){case 0:case 125:ft=0;case 59+ot:at==-1&&(At=replace(At,/\f/g,"")),pt>0&&strlen(At)-ct&&append(pt>32?declaration(At+";",et,_e,ct-1):declaration(replace(At," ","")+";",et,_e,ct-2),s);break;case 59:At+=";";default:if(append(xt=ruleset(At,o,_e,tt,ot,rt,ut,mt,St=[],It=[],ct),lt),ht===123)if(ot===0)parse(At,o,xt,xt,St,lt,ct,ut,It);else switch(yt===99&&charat(At,3)===110?100:yt){case 100:case 109:case 115:parse(a,xt,xt,et&&append(ruleset(a,xt,xt,0,0,rt,ut,mt,rt,St=[],ct),It),rt,It,ct,ut,et?St:It);break;default:parse(At,xt,xt,xt,[""],It,0,ut,It)}}tt=ot=pt=0,st=at=1,mt=At="",ct=it;break;case 58:ct=1+strlen(At),pt=gt;default:if(st<1){if(ht==123)--st;else if(ht==125&&st++==0&&prev()==125)continue}switch(At+=from(ht),ht*st){case 38:at=ot>0?1:(At+="\f",-1);break;case 44:ut[tt++]=(strlen(At)-1)*at,at=1;break;case 64:peek()===45&&(At+=delimit(next())),yt=peek(),ot=ct=strlen(mt=At+=identifier(caret())),ht++;break;case 45:gt===45&&strlen(At)==2&&(st=0)}}return lt}function ruleset(a,o,_e,et,rt,lt,it,ut,s,tt,ot){for(var ct=rt-1,yt=rt===0?lt:[""],pt=sizeof(yt),gt=0,st=0,ft=0;gt<et;++gt)for(var at=0,ht=substr(a,ct+1,ct=abs(st=it[gt])),mt=a;at<pt;++at)(mt=trim(st>0?yt[at]+" "+ht:replace(ht,/&\f/g,yt[at])))&&(s[ft++]=mt);return node(a,o,_e,rt===0?RULESET:ut,s,tt,ot)}function comment(a,o,_e){return node(a,o,_e,COMMENT,from(char()),substr(a,2,-2),0)}function declaration(a,o,_e,et){return node(a,o,_e,DECLARATION,substr(a,0,et),substr(a,et+1,-1),et)}function serialize(a,o){for(var _e="",et=sizeof(a),rt=0;rt<et;rt++)_e+=o(a[rt],rt,a,o)||"";return _e}function stringify(a,o,_e,et){switch(a.type){case IMPORT:case DECLARATION:return a.return=a.return||a.value;case COMMENT:return"";case KEYFRAMES:return a.return=a.value+"{"+serialize(a.children,et)+"}";case RULESET:a.value=a.props.join(",")}return strlen(_e=serialize(a.children,et))?a.return=a.value+"{"+_e+"}":""}function middleware(a){var o=sizeof(a);return function(_e,et,rt,lt){for(var it="",ut=0;ut<o;ut++)it+=a[ut](_e,et,rt,lt)||"";return it}}function rulesheet(a){return function(o){o.root||(o=o.return)&&a(o)}}var identifierWithPointTracking=function(o,_e,et){for(var rt=0,lt=0;rt=lt,lt=peek(),rt===38&&lt===12&&(_e[et]=1),!token(lt);)next();return slice(o,position)},toRules=function(o,_e){var et=-1,rt=44;do switch(token(rt)){case 0:rt===38&&peek()===12&&(_e[et]=1),o[et]+=identifierWithPointTracking(position-1,_e,et);break;case 2:o[et]+=delimit(rt);break;case 4:if(rt===44){o[++et]=peek()===58?"&\f":"",_e[et]=o[et].length;break}default:o[et]+=from(rt)}while(rt=next());return o},getRules=function(o,_e){return dealloc(toRules(alloc(o),_e))},fixedElements=new WeakMap,compat=function(o){if(!(o.type!=="rule"||!o.parent||o.length<1)){for(var _e=o.value,et=o.parent,rt=o.column===et.column&&o.line===et.line;et.type!=="rule";)if(et=et.parent,!et)return;if(!(o.props.length===1&&_e.charCodeAt(0)!==58&&!fixedElements.get(et))&&!rt){fixedElements.set(o,!0);for(var lt=[],it=getRules(_e,lt),ut=et.props,s=0,tt=0;s<it.length;s++)for(var ot=0;ot<ut.length;ot++,tt++)o.props[tt]=lt[s]?it[s].replace(/&\f/g,ut[ot]):ut[ot]+" "+it[s]}}},removeLabel=function(o){if(o.type==="decl"){var _e=o.value;_e.charCodeAt(0)===108&&_e.charCodeAt(2)===98&&(o.return="",o.value="")}};function prefix(a,o){switch(hash$2(a,o)){case 5103:return WEBKIT+"print-"+a+a;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return WEBKIT+a+a;case 5349:case 4246:case 4810:case 6968:case 2756:return WEBKIT+a+MOZ+a+MS+a+a;case 6828:case 4268:return WEBKIT+a+MS+a+a;case 6165:return WEBKIT+a+MS+"flex-"+a+a;case 5187:return WEBKIT+a+replace(a,/(\w+).+(:[^]+)/,WEBKIT+"box-$1$2"+MS+"flex-$1$2")+a;case 5443:return WEBKIT+a+MS+"flex-item-"+replace(a,/flex-|-self/,"")+a;case 4675:return WEBKIT+a+MS+"flex-line-pack"+replace(a,/align-content|flex-|-self/,"")+a;case 5548:return WEBKIT+a+MS+replace(a,"shrink","negative")+a;case 5292:return WEBKIT+a+MS+replace(a,"basis","preferred-size")+a;case 6060:return WEBKIT+"box-"+replace(a,"-grow","")+WEBKIT+a+MS+replace(a,"grow","positive")+a;case 4554:return WEBKIT+replace(a,/([^-])(transform)/g,"$1"+WEBKIT+"$2")+a;case 6187:return replace(replace(replace(a,/(zoom-|grab)/,WEBKIT+"$1"),/(image-set)/,WEBKIT+"$1"),a,"")+a;case 5495:case 3959:return replace(a,/(image-set\([^]*)/,WEBKIT+"$1$`$1");case 4968:return replace(replace(a,/(.+:)(flex-)?(.*)/,WEBKIT+"box-pack:$3"+MS+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+WEBKIT+a+a;case 4095:case 3583:case 4068:case 2532:return replace(a,/(.+)-inline(.+)/,WEBKIT+"$1$2")+a;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(strlen(a)-1-o>6)switch(charat(a,o+1)){case 109:if(charat(a,o+4)!==45)break;case 102:return replace(a,/(.+:)(.+)-([^]+)/,"$1"+WEBKIT+"$2-$3$1"+MOZ+(charat(a,o+3)==108?"$3":"$2-$3"))+a;case 115:return~indexof(a,"stretch")?prefix(replace(a,"stretch","fill-available"),o)+a:a}break;case 4949:if(charat(a,o+1)!==115)break;case 6444:switch(charat(a,strlen(a)-3-(~indexof(a,"!important")&&10))){case 107:return replace(a,":",":"+WEBKIT)+a;case 101:return replace(a,/(.+:)([^;!]+)(;|!.+)?/,"$1"+WEBKIT+(charat(a,14)===45?"inline-":"")+"box$3$1"+WEBKIT+"$2$3$1"+MS+"$2box$3")+a}break;case 5936:switch(charat(a,o+11)){case 114:return WEBKIT+a+MS+replace(a,/[svh]\w+-[tblr]{2}/,"tb")+a;case 108:return WEBKIT+a+MS+replace(a,/[svh]\w+-[tblr]{2}/,"tb-rl")+a;case 45:return WEBKIT+a+MS+replace(a,/[svh]\w+-[tblr]{2}/,"lr")+a}return WEBKIT+a+MS+a+a}return a}var prefixer=function(o,_e,et,rt){if(o.length>-1&&!o.return)switch(o.type){case DECLARATION:o.return=prefix(o.value,o.length);break;case KEYFRAMES:return serialize([copy(o,{value:replace(o.value,"@","@"+WEBKIT)})],rt);case RULESET:if(o.length)return combine(o.props,function(lt){switch(match(lt,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return serialize([copy(o,{props:[replace(lt,/:(read-\w+)/,":"+MOZ+"$1")]})],rt);case"::placeholder":return serialize([copy(o,{props:[replace(lt,/:(plac\w+)/,":"+WEBKIT+"input-$1")]}),copy(o,{props:[replace(lt,/:(plac\w+)/,":"+MOZ+"$1")]}),copy(o,{props:[replace(lt,/:(plac\w+)/,MS+"input-$1")]})],rt)}return""})}},defaultStylisPlugins=[prefixer],createCache=function(o){var _e=o.key;if(_e==="css"){var et=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(et,function(st){var ft=st.getAttribute("data-emotion");ft.indexOf(" ")!==-1&&(document.head.appendChild(st),st.setAttribute("data-s",""))})}var rt=o.stylisPlugins||defaultStylisPlugins,lt={},it,ut=[];it=o.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+_e+' "]'),function(st){for(var ft=st.getAttribute("data-emotion").split(" "),at=1;at<ft.length;at++)lt[ft[at]]=!0;ut.push(st)});var s,tt=[compat,removeLabel];{var ot,ct=[stringify,rulesheet(function(st){ot.insert(st)})],yt=middleware(tt.concat(rt,ct)),pt=function(ft){return serialize(compile(ft),yt)};s=function(ft,at,ht,mt){ot=ht,pt(ft?ft+"{"+at.styles+"}":at.styles),mt&&(gt.inserted[at.name]=!0)}}var gt={key:_e,sheet:new StyleSheet({key:_e,container:it,nonce:o.nonce,speedy:o.speedy,prepend:o.prepend,insertionPoint:o.insertionPoint}),nonce:o.nonce,inserted:lt,registered:{},insert:s};return gt.sheet.hydrate(ut),gt},reactIs$1={exports:{}},reactIs_production_min={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b$1=typeof Symbol=="function"&&Symbol.for,c$1=b$1?Symbol.for("react.element"):60103,d$1=b$1?Symbol.for("react.portal"):60106,e=b$1?Symbol.for("react.fragment"):60107,f=b$1?Symbol.for("react.strict_mode"):60108,g$1=b$1?Symbol.for("react.profiler"):60114,h$1=b$1?Symbol.for("react.provider"):60109,k=b$1?Symbol.for("react.context"):60110,l=b$1?Symbol.for("react.async_mode"):60111,m$1=b$1?Symbol.for("react.concurrent_mode"):60111,n=b$1?Symbol.for("react.forward_ref"):60112,p=b$1?Symbol.for("react.suspense"):60113,q$1=b$1?Symbol.for("react.suspense_list"):60120,r=b$1?Symbol.for("react.memo"):60115,t=b$1?Symbol.for("react.lazy"):60116,v$1=b$1?Symbol.for("react.block"):60121,w$2=b$1?Symbol.for("react.fundamental"):60117,x$1=b$1?Symbol.for("react.responder"):60118,y$1=b$1?Symbol.for("react.scope"):60119;function z$1(a){if(typeof a=="object"&&a!==null){var o=a.$$typeof;switch(o){case c$1:switch(a=a.type,a){case l:case m$1:case e:case g$1:case f:case p:return a;default:switch(a=a&&a.$$typeof,a){case k:case n:case t:case r:case h$1:return a;default:return o}}case d$1:return o}}}function A$2(a){return z$1(a)===m$1}reactIs_production_min.AsyncMode=l;reactIs_production_min.ConcurrentMode=m$1;reactIs_production_min.ContextConsumer=k;reactIs_production_min.ContextProvider=h$1;reactIs_production_min.Element=c$1;reactIs_production_min.ForwardRef=n;reactIs_production_min.Fragment=e;reactIs_production_min.Lazy=t;reactIs_production_min.Memo=r;reactIs_production_min.Portal=d$1;reactIs_production_min.Profiler=g$1;reactIs_production_min.StrictMode=f;reactIs_production_min.Suspense=p;reactIs_production_min.isAsyncMode=function(a){return A$2(a)||z$1(a)===l};reactIs_production_min.isConcurrentMode=A$2;reactIs_production_min.isContextConsumer=function(a){return z$1(a)===k};reactIs_production_min.isContextProvider=function(a){return z$1(a)===h$1};reactIs_production_min.isElement=function(a){return typeof a=="object"&&a!==null&&a.$$typeof===c$1};reactIs_production_min.isForwardRef=function(a){return z$1(a)===n};reactIs_production_min.isFragment=function(a){return z$1(a)===e};reactIs_production_min.isLazy=function(a){return z$1(a)===t};reactIs_production_min.isMemo=function(a){return z$1(a)===r};reactIs_production_min.isPortal=function(a){return z$1(a)===d$1};reactIs_production_min.isProfiler=function(a){return z$1(a)===g$1};reactIs_production_min.isStrictMode=function(a){return z$1(a)===f};reactIs_production_min.isSuspense=function(a){return z$1(a)===p};reactIs_production_min.isValidElementType=function(a){return typeof a=="string"||typeof a=="function"||a===e||a===m$1||a===g$1||a===f||a===p||a===q$1||typeof a=="object"&&a!==null&&(a.$$typeof===t||a.$$typeof===r||a.$$typeof===h$1||a.$$typeof===k||a.$$typeof===n||a.$$typeof===w$2||a.$$typeof===x$1||a.$$typeof===y$1||a.$$typeof===v$1)};reactIs_production_min.typeOf=z$1;reactIs$1.exports=reactIs_production_min;var reactIsExports=reactIs$1.exports,reactIs=reactIsExports,FORWARD_REF_STATICS={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},MEMO_STATICS={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},TYPE_STATICS={};TYPE_STATICS[reactIs.ForwardRef]=FORWARD_REF_STATICS;TYPE_STATICS[reactIs.Memo]=MEMO_STATICS;var isBrowser=!0;function getRegisteredStyles(a,o,_e){var et="";return _e.split(" ").forEach(function(rt){a[rt]!==void 0?o.push(a[rt]+";"):et+=rt+" "}),et}var registerStyles=function(o,_e,et){var rt=o.key+"-"+_e.name;(et===!1||isBrowser===!1)&&o.registered[rt]===void 0&&(o.registered[rt]=_e.styles)},insertStyles=function(o,_e,et){registerStyles(o,_e,et);var rt=o.key+"-"+_e.name;if(o.inserted[_e.name]===void 0){var lt=_e;do o.insert(_e===lt?"."+rt:"",lt,o.sheet,!0),lt=lt.next;while(lt!==void 0)}};function murmur2(a){for(var o=0,_e,et=0,rt=a.length;rt>=4;++et,rt-=4)_e=a.charCodeAt(et)&255|(a.charCodeAt(++et)&255)<<8|(a.charCodeAt(++et)&255)<<16|(a.charCodeAt(++et)&255)<<24,_e=(_e&65535)*1540483477+((_e>>>16)*59797<<16),_e^=_e>>>24,o=(_e&65535)*1540483477+((_e>>>16)*59797<<16)^(o&65535)*1540483477+((o>>>16)*59797<<16);switch(rt){case 3:o^=(a.charCodeAt(et+2)&255)<<16;case 2:o^=(a.charCodeAt(et+1)&255)<<8;case 1:o^=a.charCodeAt(et)&255,o=(o&65535)*1540483477+((o>>>16)*59797<<16)}return o^=o>>>13,o=(o&65535)*1540483477+((o>>>16)*59797<<16),((o^o>>>15)>>>0).toString(36)}var unitlessKeys={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},hyphenateRegex=/[A-Z]|^ms/g,animationRegex=/_EMO_([^_]+?)_([^]*?)_EMO_/g,isCustomProperty=function(o){return o.charCodeAt(1)===45},isProcessableValue=function(o){return o!=null&&typeof o!="boolean"},processStyleName=memoize$1(function(a){return isCustomProperty(a)?a:a.replace(hyphenateRegex,"-$&").toLowerCase()}),processStyleValue=function(o,_e){switch(o){case"animation":case"animationName":if(typeof _e=="string")return _e.replace(animationRegex,function(et,rt,lt){return cursor={name:rt,styles:lt,next:cursor},rt})}return unitlessKeys[o]!==1&&!isCustomProperty(o)&&typeof _e=="number"&&_e!==0?_e+"px":_e},noComponentSelectorMessage="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function handleInterpolation(a,o,_e){if(_e==null)return"";if(_e.__emotion_styles!==void 0)return _e;switch(typeof _e){case"boolean":return"";case"object":{if(_e.anim===1)return cursor={name:_e.name,styles:_e.styles,next:cursor},_e.name;if(_e.styles!==void 0){var et=_e.next;if(et!==void 0)for(;et!==void 0;)cursor={name:et.name,styles:et.styles,next:cursor},et=et.next;var rt=_e.styles+";";return rt}return createStringFromObject(a,o,_e)}case"function":{if(a!==void 0){var lt=cursor,it=_e(a);return cursor=lt,handleInterpolation(a,o,it)}break}}if(o==null)return _e;var ut=o[_e];return ut!==void 0?ut:_e}function createStringFromObject(a,o,_e){var et="";if(Array.isArray(_e))for(var rt=0;rt<_e.length;rt++)et+=handleInterpolation(a,o,_e[rt])+";";else for(var lt in _e){var it=_e[lt];if(typeof it!="object")o!=null&&o[it]!==void 0?et+=lt+"{"+o[it]+"}":isProcessableValue(it)&&(et+=processStyleName(lt)+":"+processStyleValue(lt,it)+";");else if(Array.isArray(it)&&typeof it[0]=="string"&&(o==null||o[it[0]]===void 0))for(var ut=0;ut<it.length;ut++)isProcessableValue(it[ut])&&(et+=processStyleName(lt)+":"+processStyleValue(lt,it[ut])+";");else{var s=handleInterpolation(a,o,it);switch(lt){case"animation":case"animationName":{et+=processStyleName(lt)+":"+s+";";break}default:et+=lt+"{"+s+"}"}}}return et}var labelPattern=/label:\s*([^\s;\n{]+)\s*(;|$)/g,cursor,serializeStyles=function(o,_e,et){if(o.length===1&&typeof o[0]=="object"&&o[0]!==null&&o[0].styles!==void 0)return o[0];var rt=!0,lt="";cursor=void 0;var it=o[0];it==null||it.raw===void 0?(rt=!1,lt+=handleInterpolation(et,_e,it)):lt+=it[0];for(var ut=1;ut<o.length;ut++)lt+=handleInterpolation(et,_e,o[ut]),rt&&(lt+=it[ut]);labelPattern.lastIndex=0;for(var s="",tt;(tt=labelPattern.exec(lt))!==null;)s+="-"+tt[1];var ot=murmur2(lt)+s;return{name:ot,styles:lt,next:cursor}},syncFallback=function(o){return o()},useInsertionEffect=React$2["useInsertionEffect"]?React$2["useInsertionEffect"]:!1,useInsertionEffectAlwaysWithSyncFallback=useInsertionEffect||syncFallback,useInsertionEffectWithLayoutFallback=useInsertionEffect||reactExports.useLayoutEffect,EmotionCacheContext=reactExports.createContext(typeof HTMLElement<"u"?createCache({key:"css"}):null);EmotionCacheContext.Provider;var withEmotionCache=function(o){return reactExports.forwardRef(function(_e,et){var rt=reactExports.useContext(EmotionCacheContext);return o(_e,rt,et)})},ThemeContext$2=reactExports.createContext({}),Global=withEmotionCache(function(a,o){var _e=a.styles,et=serializeStyles([_e],void 0,reactExports.useContext(ThemeContext$2)),rt=reactExports.useRef();return useInsertionEffectWithLayoutFallback(function(){var lt=o.key+"-global",it=new o.sheet.constructor({key:lt,nonce:o.sheet.nonce,container:o.sheet.container,speedy:o.sheet.isSpeedy}),ut=!1,s=document.querySelector('style[data-emotion="'+lt+" "+et.name+'"]');return o.sheet.tags.length&&(it.before=o.sheet.tags[0]),s!==null&&(ut=!0,s.setAttribute("data-emotion",lt),it.hydrate([s])),rt.current=[it,ut],function(){it.flush()}},[o]),useInsertionEffectWithLayoutFallback(function(){var lt=rt.current,it=lt[0],ut=lt[1];if(ut){lt[1]=!1;return}if(et.next!==void 0&&insertStyles(o,et.next,!0),it.tags.length){var s=it.tags[it.tags.length-1].nextElementSibling;it.before=s,it.flush()}o.insert("",et,it,!1)},[o,et.name]),null});function css(){for(var a=arguments.length,o=new Array(a),_e=0;_e<a;_e++)o[_e]=arguments[_e];return serializeStyles(o)}var keyframes=function(){var o=css.apply(void 0,arguments),_e="animation-"+o.name;return{name:_e,styles:"@keyframes "+_e+"{"+o.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},testOmitPropsOnStringTag=isPropValid,testOmitPropsOnComponent=function(o){return o!=="theme"},getDefaultShouldForwardProp=function(o){return typeof o=="string"&&o.charCodeAt(0)>96?testOmitPropsOnStringTag:testOmitPropsOnComponent},composeShouldForwardProps=function(o,_e,et){var rt;if(_e){var lt=_e.shouldForwardProp;rt=o.__emotion_forwardProp&&lt?function(it){return o.__emotion_forwardProp(it)&&lt(it)}:lt}return typeof rt!="function"&&et&&(rt=o.__emotion_forwardProp),rt},Insertion=function(o){var _e=o.cache,et=o.serialized,rt=o.isStringTag;return registerStyles(_e,et,rt),useInsertionEffectAlwaysWithSyncFallback(function(){return insertStyles(_e,et,rt)}),null},createStyled$1=function a(o,_e){var et=o.__emotion_real===o,rt=et&&o.__emotion_base||o,lt,it;_e!==void 0&&(lt=_e.label,it=_e.target);var ut=composeShouldForwardProps(o,_e,et),s=ut||getDefaultShouldForwardProp(rt),tt=!s("as");return function(){var ot=arguments,ct=et&&o.__emotion_styles!==void 0?o.__emotion_styles.slice(0):[];if(lt!==void 0&&ct.push("label:"+lt+";"),ot[0]==null||ot[0].raw===void 0)ct.push.apply(ct,ot);else{ct.push(ot[0][0]);for(var yt=ot.length,pt=1;pt<yt;pt++)ct.push(ot[pt],ot[0][pt])}var gt=withEmotionCache(function(st,ft,at){var ht=tt&&st.as||rt,mt="",St=[],It=st;if(st.theme==null){It={};for(var xt in st)It[xt]=st[xt];It.theme=reactExports.useContext(ThemeContext$2)}typeof st.className=="string"?mt=getRegisteredStyles(ft.registered,St,st.className):st.className!=null&&(mt=st.className+" ");var At=serializeStyles(ct.concat(St),ft.registered,It);mt+=ft.key+"-"+At.name,it!==void 0&&(mt+=" "+it);var Nt=tt&&ut===void 0?getDefaultShouldForwardProp(ht):s,kt={};for(var Mt in st)tt&&Mt==="as"||Nt(Mt)&&(kt[Mt]=st[Mt]);return kt.className=mt,kt.ref=at,reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(Insertion,{cache:ft,serialized:At,isStringTag:typeof ht=="string"}),reactExports.createElement(ht,kt))});return gt.displayName=lt!==void 0?lt:"Styled("+(typeof rt=="string"?rt:rt.displayName||rt.name||"Component")+")",gt.defaultProps=o.defaultProps,gt.__emotion_real=gt,gt.__emotion_base=rt,gt.__emotion_styles=ct,gt.__emotion_forwardProp=ut,Object.defineProperty(gt,"toString",{value:function(){return"."+it}}),gt.withComponent=function(st,ft){return a(st,_extends({},_e,ft,{shouldForwardProp:composeShouldForwardProps(gt,ft,!0)})).apply(void 0,ct)},gt}};const createStyled$2=createStyled$1;var tags=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],newStyled=createStyled$2.bind();tags.forEach(function(a){newStyled[a]=newStyled(a)});const emStyled=newStyled;function isEmpty$4(a){return a==null||Object.keys(a).length===0}function GlobalStyles$2(a){const{styles:o,defaultTheme:_e={}}=a,et=typeof o=="function"?rt=>o(isEmpty$4(rt)?_e:rt):o;return jsxRuntimeExports.jsx(Global,{styles:et})}/**
 * @mui/styled-engine v5.12.3
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function styled$3(a,o){return emStyled(a,o)}const internal_processStyles=(a,o)=>{Array.isArray(a.__emotion_styles)&&(a.__emotion_styles=o(a.__emotion_styles))},_excluded$U=["values","unit","step"],sortBreakpointsValues=a=>{const o=Object.keys(a).map(_e=>({key:_e,val:a[_e]}))||[];return o.sort((_e,et)=>_e.val-et.val),o.reduce((_e,et)=>_extends({},_e,{[et.key]:et.val}),{})};function createBreakpoints(a){const{values:o={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:_e="px",step:et=5}=a,rt=_objectWithoutPropertiesLoose(a,_excluded$U),lt=sortBreakpointsValues(o),it=Object.keys(lt);function ut(yt){return`@media (min-width:${typeof o[yt]=="number"?o[yt]:yt}${_e})`}function s(yt){return`@media (max-width:${(typeof o[yt]=="number"?o[yt]:yt)-et/100}${_e})`}function tt(yt,pt){const gt=it.indexOf(pt);return`@media (min-width:${typeof o[yt]=="number"?o[yt]:yt}${_e}) and (max-width:${(gt!==-1&&typeof o[it[gt]]=="number"?o[it[gt]]:pt)-et/100}${_e})`}function ot(yt){return it.indexOf(yt)+1<it.length?tt(yt,it[it.indexOf(yt)+1]):ut(yt)}function ct(yt){const pt=it.indexOf(yt);return pt===0?ut(it[1]):pt===it.length-1?s(it[pt]):tt(yt,it[it.indexOf(yt)+1]).replace("@media","@media not all and")}return _extends({keys:it,values:lt,up:ut,down:s,between:tt,only:ot,not:ct,unit:_e},rt)}const shape={borderRadius:4},shape$1=shape;function merge(a,o){return o?deepmerge(a,o,{clone:!1}):a}const values$1={xs:0,sm:600,md:900,lg:1200,xl:1536},defaultBreakpoints={keys:["xs","sm","md","lg","xl"],up:a=>`@media (min-width:${values$1[a]}px)`};function handleBreakpoints(a,o,_e){const et=a.theme||{};if(Array.isArray(o)){const lt=et.breakpoints||defaultBreakpoints;return o.reduce((it,ut,s)=>(it[lt.up(lt.keys[s])]=_e(o[s]),it),{})}if(typeof o=="object"){const lt=et.breakpoints||defaultBreakpoints;return Object.keys(o).reduce((it,ut)=>{if(Object.keys(lt.values||values$1).indexOf(ut)!==-1){const s=lt.up(ut);it[s]=_e(o[ut],ut)}else{const s=ut;it[s]=o[s]}return it},{})}return _e(o)}function createEmptyBreakpointObject(a={}){var o;return((o=a.keys)==null?void 0:o.reduce((et,rt)=>{const lt=a.up(rt);return et[lt]={},et},{}))||{}}function removeUnusedBreakpoints(a,o){return a.reduce((_e,et)=>{const rt=_e[et];return(!rt||Object.keys(rt).length===0)&&delete _e[et],_e},o)}function mergeBreakpointsInOrder(a,...o){const _e=createEmptyBreakpointObject(a),et=[_e,...o].reduce((rt,lt)=>deepmerge(rt,lt),{});return removeUnusedBreakpoints(Object.keys(_e),et)}function computeBreakpointsBase(a,o){if(typeof a!="object")return{};const _e={},et=Object.keys(o);return Array.isArray(a)?et.forEach((rt,lt)=>{lt<a.length&&(_e[rt]=!0)}):et.forEach(rt=>{a[rt]!=null&&(_e[rt]=!0)}),_e}function resolveBreakpointValues({values:a,breakpoints:o,base:_e}){const et=_e||computeBreakpointsBase(a,o),rt=Object.keys(et);if(rt.length===0)return a;let lt;return rt.reduce((it,ut,s)=>(Array.isArray(a)?(it[ut]=a[s]!=null?a[s]:a[lt],lt=s):typeof a=="object"?(it[ut]=a[ut]!=null?a[ut]:a[lt],lt=ut):it[ut]=a,it),{})}function getPath(a,o,_e=!0){if(!o||typeof o!="string")return null;if(a&&a.vars&&_e){const et=`vars.${o}`.split(".").reduce((rt,lt)=>rt&&rt[lt]?rt[lt]:null,a);if(et!=null)return et}return o.split(".").reduce((et,rt)=>et&&et[rt]!=null?et[rt]:null,a)}function getStyleValue$1(a,o,_e,et=_e){let rt;return typeof a=="function"?rt=a(_e):Array.isArray(a)?rt=a[_e]||et:rt=getPath(a,_e)||et,o&&(rt=o(rt,et,a)),rt}function style$2(a){const{prop:o,cssProperty:_e=a.prop,themeKey:et,transform:rt}=a,lt=it=>{if(it[o]==null)return null;const ut=it[o],s=it.theme,tt=getPath(s,et)||{};return handleBreakpoints(it,ut,ct=>{let yt=getStyleValue$1(tt,rt,ct);return ct===yt&&typeof ct=="string"&&(yt=getStyleValue$1(tt,rt,`${o}${ct==="default"?"":capitalize(ct)}`,ct)),_e===!1?yt:{[_e]:yt}})};return lt.propTypes={},lt.filterProps=[o],lt}function memoize(a){const o={};return _e=>(o[_e]===void 0&&(o[_e]=a(_e)),o[_e])}const properties={m:"margin",p:"padding"},directions={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},aliases={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},getCssProperties=memoize(a=>{if(a.length>2)if(aliases[a])a=aliases[a];else return[a];const[o,_e]=a.split(""),et=properties[o],rt=directions[_e]||"";return Array.isArray(rt)?rt.map(lt=>et+lt):[et+rt]}),marginKeys=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],paddingKeys=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...marginKeys,...paddingKeys];function createUnaryUnit(a,o,_e,et){var rt;const lt=(rt=getPath(a,o,!1))!=null?rt:_e;return typeof lt=="number"?it=>typeof it=="string"?it:lt*it:Array.isArray(lt)?it=>typeof it=="string"?it:lt[it]:typeof lt=="function"?lt:()=>{}}function createUnarySpacing(a){return createUnaryUnit(a,"spacing",8)}function getValue(a,o){if(typeof o=="string"||o==null)return o;const _e=Math.abs(o),et=a(_e);return o>=0?et:typeof et=="number"?-et:`-${et}`}function getStyleFromPropValue(a,o){return _e=>a.reduce((et,rt)=>(et[rt]=getValue(o,_e),et),{})}function resolveCssProperty(a,o,_e,et){if(o.indexOf(_e)===-1)return null;const rt=getCssProperties(_e),lt=getStyleFromPropValue(rt,et),it=a[_e];return handleBreakpoints(a,it,lt)}function style$1(a,o){const _e=createUnarySpacing(a.theme);return Object.keys(a).map(et=>resolveCssProperty(a,o,et,_e)).reduce(merge,{})}function margin(a){return style$1(a,marginKeys)}margin.propTypes={};margin.filterProps=marginKeys;function padding(a){return style$1(a,paddingKeys)}padding.propTypes={};padding.filterProps=paddingKeys;function createSpacing(a=8){if(a.mui)return a;const o=createUnarySpacing({spacing:a}),_e=(...et)=>(et.length===0?[1]:et).map(lt=>{const it=o(lt);return typeof it=="number"?`${it}px`:it}).join(" ");return _e.mui=!0,_e}function compose(...a){const o=a.reduce((et,rt)=>(rt.filterProps.forEach(lt=>{et[lt]=rt}),et),{}),_e=et=>Object.keys(et).reduce((rt,lt)=>o[lt]?merge(rt,o[lt](et)):rt,{});return _e.propTypes={},_e.filterProps=a.reduce((et,rt)=>et.concat(rt.filterProps),[]),_e}function borderTransform(a){return typeof a!="number"?a:`${a}px solid`}const border=style$2({prop:"border",themeKey:"borders",transform:borderTransform}),borderTop=style$2({prop:"borderTop",themeKey:"borders",transform:borderTransform}),borderRight=style$2({prop:"borderRight",themeKey:"borders",transform:borderTransform}),borderBottom=style$2({prop:"borderBottom",themeKey:"borders",transform:borderTransform}),borderLeft=style$2({prop:"borderLeft",themeKey:"borders",transform:borderTransform}),borderColor=style$2({prop:"borderColor",themeKey:"palette"}),borderTopColor=style$2({prop:"borderTopColor",themeKey:"palette"}),borderRightColor=style$2({prop:"borderRightColor",themeKey:"palette"}),borderBottomColor=style$2({prop:"borderBottomColor",themeKey:"palette"}),borderLeftColor=style$2({prop:"borderLeftColor",themeKey:"palette"}),borderRadius=a=>{if(a.borderRadius!==void 0&&a.borderRadius!==null){const o=createUnaryUnit(a.theme,"shape.borderRadius",4),_e=et=>({borderRadius:getValue(o,et)});return handleBreakpoints(a,a.borderRadius,_e)}return null};borderRadius.propTypes={};borderRadius.filterProps=["borderRadius"];compose(border,borderTop,borderRight,borderBottom,borderLeft,borderColor,borderTopColor,borderRightColor,borderBottomColor,borderLeftColor,borderRadius);const gap=a=>{if(a.gap!==void 0&&a.gap!==null){const o=createUnaryUnit(a.theme,"spacing",8),_e=et=>({gap:getValue(o,et)});return handleBreakpoints(a,a.gap,_e)}return null};gap.propTypes={};gap.filterProps=["gap"];const columnGap=a=>{if(a.columnGap!==void 0&&a.columnGap!==null){const o=createUnaryUnit(a.theme,"spacing",8),_e=et=>({columnGap:getValue(o,et)});return handleBreakpoints(a,a.columnGap,_e)}return null};columnGap.propTypes={};columnGap.filterProps=["columnGap"];const rowGap=a=>{if(a.rowGap!==void 0&&a.rowGap!==null){const o=createUnaryUnit(a.theme,"spacing",8),_e=et=>({rowGap:getValue(o,et)});return handleBreakpoints(a,a.rowGap,_e)}return null};rowGap.propTypes={};rowGap.filterProps=["rowGap"];const gridColumn=style$2({prop:"gridColumn"}),gridRow=style$2({prop:"gridRow"}),gridAutoFlow=style$2({prop:"gridAutoFlow"}),gridAutoColumns=style$2({prop:"gridAutoColumns"}),gridAutoRows=style$2({prop:"gridAutoRows"}),gridTemplateColumns=style$2({prop:"gridTemplateColumns"}),gridTemplateRows=style$2({prop:"gridTemplateRows"}),gridTemplateAreas=style$2({prop:"gridTemplateAreas"}),gridArea=style$2({prop:"gridArea"});compose(gap,columnGap,rowGap,gridColumn,gridRow,gridAutoFlow,gridAutoColumns,gridAutoRows,gridTemplateColumns,gridTemplateRows,gridTemplateAreas,gridArea);function paletteTransform(a,o){return o==="grey"?o:a}const color=style$2({prop:"color",themeKey:"palette",transform:paletteTransform}),bgcolor=style$2({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:paletteTransform}),backgroundColor=style$2({prop:"backgroundColor",themeKey:"palette",transform:paletteTransform});compose(color,bgcolor,backgroundColor);function sizingTransform(a){return a<=1&&a!==0?`${a*100}%`:a}const width=style$2({prop:"width",transform:sizingTransform}),maxWidth=a=>{if(a.maxWidth!==void 0&&a.maxWidth!==null){const o=_e=>{var et,rt,lt;return{maxWidth:((et=a.theme)==null||(rt=et.breakpoints)==null||(lt=rt.values)==null?void 0:lt[_e])||values$1[_e]||sizingTransform(_e)}};return handleBreakpoints(a,a.maxWidth,o)}return null};maxWidth.filterProps=["maxWidth"];const minWidth=style$2({prop:"minWidth",transform:sizingTransform}),height=style$2({prop:"height",transform:sizingTransform}),maxHeight=style$2({prop:"maxHeight",transform:sizingTransform}),minHeight=style$2({prop:"minHeight",transform:sizingTransform});style$2({prop:"size",cssProperty:"width",transform:sizingTransform});style$2({prop:"size",cssProperty:"height",transform:sizingTransform});const boxSizing=style$2({prop:"boxSizing"});compose(width,maxWidth,minWidth,height,maxHeight,minHeight,boxSizing);const defaultSxConfig={border:{themeKey:"borders",transform:borderTransform},borderTop:{themeKey:"borders",transform:borderTransform},borderRight:{themeKey:"borders",transform:borderTransform},borderBottom:{themeKey:"borders",transform:borderTransform},borderLeft:{themeKey:"borders",transform:borderTransform},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:borderRadius},color:{themeKey:"palette",transform:paletteTransform},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:paletteTransform},backgroundColor:{themeKey:"palette",transform:paletteTransform},p:{style:padding},pt:{style:padding},pr:{style:padding},pb:{style:padding},pl:{style:padding},px:{style:padding},py:{style:padding},padding:{style:padding},paddingTop:{style:padding},paddingRight:{style:padding},paddingBottom:{style:padding},paddingLeft:{style:padding},paddingX:{style:padding},paddingY:{style:padding},paddingInline:{style:padding},paddingInlineStart:{style:padding},paddingInlineEnd:{style:padding},paddingBlock:{style:padding},paddingBlockStart:{style:padding},paddingBlockEnd:{style:padding},m:{style:margin},mt:{style:margin},mr:{style:margin},mb:{style:margin},ml:{style:margin},mx:{style:margin},my:{style:margin},margin:{style:margin},marginTop:{style:margin},marginRight:{style:margin},marginBottom:{style:margin},marginLeft:{style:margin},marginX:{style:margin},marginY:{style:margin},marginInline:{style:margin},marginInlineStart:{style:margin},marginInlineEnd:{style:margin},marginBlock:{style:margin},marginBlockStart:{style:margin},marginBlockEnd:{style:margin},displayPrint:{cssProperty:!1,transform:a=>({"@media print":{display:a}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:gap},rowGap:{style:rowGap},columnGap:{style:columnGap},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:sizingTransform},maxWidth:{style:maxWidth},minWidth:{transform:sizingTransform},height:{transform:sizingTransform},maxHeight:{transform:sizingTransform},minHeight:{transform:sizingTransform},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},defaultSxConfig$1=defaultSxConfig;function objectsHaveSameKeys(...a){const o=a.reduce((et,rt)=>et.concat(Object.keys(rt)),[]),_e=new Set(o);return a.every(et=>_e.size===Object.keys(et).length)}function callIfFn(a,o){return typeof a=="function"?a(o):a}function unstable_createStyleFunctionSx(){function a(_e,et,rt,lt){const it={[_e]:et,theme:rt},ut=lt[_e];if(!ut)return{[_e]:et};const{cssProperty:s=_e,themeKey:tt,transform:ot,style:ct}=ut;if(et==null)return null;if(tt==="typography"&&et==="inherit")return{[_e]:et};const yt=getPath(rt,tt)||{};return ct?ct(it):handleBreakpoints(it,et,gt=>{let st=getStyleValue$1(yt,ot,gt);return gt===st&&typeof gt=="string"&&(st=getStyleValue$1(yt,ot,`${_e}${gt==="default"?"":capitalize(gt)}`,gt)),s===!1?st:{[s]:st}})}function o(_e){var et;const{sx:rt,theme:lt={}}=_e||{};if(!rt)return null;const it=(et=lt.unstable_sxConfig)!=null?et:defaultSxConfig$1;function ut(s){let tt=s;if(typeof s=="function")tt=s(lt);else if(typeof s!="object")return s;if(!tt)return null;const ot=createEmptyBreakpointObject(lt.breakpoints),ct=Object.keys(ot);let yt=ot;return Object.keys(tt).forEach(pt=>{const gt=callIfFn(tt[pt],lt);if(gt!=null)if(typeof gt=="object")if(it[pt])yt=merge(yt,a(pt,gt,lt,it));else{const st=handleBreakpoints({theme:lt},gt,ft=>({[pt]:ft}));objectsHaveSameKeys(st,gt)?yt[pt]=o({sx:gt,theme:lt}):yt=merge(yt,st)}else yt=merge(yt,a(pt,gt,lt,it))}),removeUnusedBreakpoints(ct,yt)}return Array.isArray(rt)?rt.map(ut):ut(rt)}return o}const styleFunctionSx=unstable_createStyleFunctionSx();styleFunctionSx.filterProps=["sx"];const styleFunctionSx$1=styleFunctionSx,_excluded$T=["breakpoints","palette","spacing","shape"];function createTheme$1(a={},...o){const{breakpoints:_e={},palette:et={},spacing:rt,shape:lt={}}=a,it=_objectWithoutPropertiesLoose(a,_excluded$T),ut=createBreakpoints(_e),s=createSpacing(rt);let tt=deepmerge({breakpoints:ut,direction:"ltr",components:{},palette:_extends({mode:"light"},et),spacing:s,shape:_extends({},shape$1,lt)},it);return tt=o.reduce((ot,ct)=>deepmerge(ot,ct),tt),tt.unstable_sxConfig=_extends({},defaultSxConfig$1,it==null?void 0:it.unstable_sxConfig),tt.unstable_sx=function(ct){return styleFunctionSx$1({sx:ct,theme:this})},tt}function isObjectEmpty(a){return Object.keys(a).length===0}function useTheme$3(a=null){const o=reactExports.useContext(ThemeContext$2);return!o||isObjectEmpty(o)?a:o}const systemDefaultTheme$1=createTheme$1();function useTheme$2(a=systemDefaultTheme$1){return useTheme$3(a)}function GlobalStyles$1({styles:a,themeId:o,defaultTheme:_e={}}){const et=useTheme$2(_e),rt=typeof a=="function"?a(o&&et[o]||et):a;return jsxRuntimeExports.jsx(GlobalStyles$2,{styles:rt})}const _excluded$S=["sx"],splitProps=a=>{var o,_e;const et={systemProps:{},otherProps:{}},rt=(o=a==null||(_e=a.theme)==null?void 0:_e.unstable_sxConfig)!=null?o:defaultSxConfig$1;return Object.keys(a).forEach(lt=>{rt[lt]?et.systemProps[lt]=a[lt]:et.otherProps[lt]=a[lt]}),et};function extendSxProp(a){const{sx:o}=a,_e=_objectWithoutPropertiesLoose(a,_excluded$S),{systemProps:et,otherProps:rt}=splitProps(_e);let lt;return Array.isArray(o)?lt=[et,...o]:typeof o=="function"?lt=(...it)=>{const ut=o(...it);return isPlainObject(ut)?_extends({},et,ut):et}:lt=_extends({},et,o),_extends({},rt,{sx:lt})}const _excluded$R=["className","component"];function createBox(a={}){const{themeId:o,defaultTheme:_e,defaultClassName:et="MuiBox-root",generateClassName:rt}=a,lt=styled$3("div",{shouldForwardProp:ut=>ut!=="theme"&&ut!=="sx"&&ut!=="as"})(styleFunctionSx$1);return reactExports.forwardRef(function(s,tt){const ot=useTheme$2(_e),ct=extendSxProp(s),{className:yt,component:pt="div"}=ct,gt=_objectWithoutPropertiesLoose(ct,_excluded$R);return jsxRuntimeExports.jsx(lt,_extends({as:pt,ref:tt,className:clsx(yt,rt?rt(et):et),theme:o&&ot[o]||ot},gt))})}const _excluded$Q=["variant"];function isEmpty$3(a){return a.length===0}function propsToClassKey(a){const{variant:o}=a,_e=_objectWithoutPropertiesLoose(a,_excluded$Q);let et=o||"";return Object.keys(_e).sort().forEach(rt=>{rt==="color"?et+=isEmpty$3(et)?a[rt]:capitalize(a[rt]):et+=`${isEmpty$3(et)?rt:capitalize(rt)}${capitalize(a[rt].toString())}`}),et}const _excluded$P=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function isEmpty$2(a){return Object.keys(a).length===0}function isStringTag(a){return typeof a=="string"&&a.charCodeAt(0)>96}const getStyleOverrides=(a,o)=>o.components&&o.components[a]&&o.components[a].styleOverrides?o.components[a].styleOverrides:null,getVariantStyles=(a,o)=>{let _e=[];o&&o.components&&o.components[a]&&o.components[a].variants&&(_e=o.components[a].variants);const et={};return _e.forEach(rt=>{const lt=propsToClassKey(rt.props);et[lt]=rt.style}),et},variantsResolver=(a,o,_e,et)=>{var rt,lt;const{ownerState:it={}}=a,ut=[],s=_e==null||(rt=_e.components)==null||(lt=rt[et])==null?void 0:lt.variants;return s&&s.forEach(tt=>{let ot=!0;Object.keys(tt.props).forEach(ct=>{it[ct]!==tt.props[ct]&&a[ct]!==tt.props[ct]&&(ot=!1)}),ot&&ut.push(o[propsToClassKey(tt.props)])}),ut};function shouldForwardProp(a){return a!=="ownerState"&&a!=="theme"&&a!=="sx"&&a!=="as"}const systemDefaultTheme=createTheme$1();function resolveTheme({defaultTheme:a,theme:o,themeId:_e}){return isEmpty$2(o)?a:o[_e]||o}function createStyled(a={}){const{themeId:o,defaultTheme:_e=systemDefaultTheme,rootShouldForwardProp:et=shouldForwardProp,slotShouldForwardProp:rt=shouldForwardProp}=a,lt=it=>styleFunctionSx$1(_extends({},it,{theme:resolveTheme(_extends({},it,{defaultTheme:_e,themeId:o}))}));return lt.__mui_systemSx=!0,(it,ut={})=>{internal_processStyles(it,St=>St.filter(It=>!(It!=null&&It.__mui_systemSx)));const{name:s,slot:tt,skipVariantsResolver:ot,skipSx:ct,overridesResolver:yt}=ut,pt=_objectWithoutPropertiesLoose(ut,_excluded$P),gt=ot!==void 0?ot:tt&&tt!=="Root"||!1,st=ct||!1;let ft,at=shouldForwardProp;tt==="Root"?at=et:tt?at=rt:isStringTag(it)&&(at=void 0);const ht=styled$3(it,_extends({shouldForwardProp:at,label:ft},pt)),mt=(St,...It)=>{const xt=It?It.map(Mt=>typeof Mt=="function"&&Mt.__emotion_real!==Mt?bt=>Mt(_extends({},bt,{theme:resolveTheme(_extends({},bt,{defaultTheme:_e,themeId:o}))})):Mt):[];let At=St;s&&yt&&xt.push(Mt=>{const bt=resolveTheme(_extends({},Mt,{defaultTheme:_e,themeId:o})),Bt=getStyleOverrides(s,bt);if(Bt){const Ht={};return Object.entries(Bt).forEach(([Wt,nn])=>{Ht[Wt]=typeof nn=="function"?nn(_extends({},Mt,{theme:bt})):nn}),yt(Mt,Ht)}return null}),s&&!gt&&xt.push(Mt=>{const bt=resolveTheme(_extends({},Mt,{defaultTheme:_e,themeId:o}));return variantsResolver(Mt,getVariantStyles(s,bt),bt,s)}),st||xt.push(lt);const Nt=xt.length-It.length;if(Array.isArray(St)&&Nt>0){const Mt=new Array(Nt).fill("");At=[...St,...Mt],At.raw=[...St.raw,...Mt]}else typeof St=="function"&&St.__emotion_real!==St&&(At=Mt=>St(_extends({},Mt,{theme:resolveTheme(_extends({},Mt,{defaultTheme:_e,themeId:o}))})));const kt=ht(At,...xt);return it.muiName&&(kt.muiName=it.muiName),kt};return ht.withConfig&&(mt.withConfig=ht.withConfig),mt}}const styled$2=createStyled(),systemStyled=styled$2;function getThemeProps(a){const{theme:o,name:_e,props:et}=a;return!o||!o.components||!o.components[_e]||!o.components[_e].defaultProps?et:resolveProps(o.components[_e].defaultProps,et)}function useThemeProps$1({props:a,name:o,defaultTheme:_e,themeId:et}){let rt=useTheme$2(_e);return et&&(rt=rt[et]||rt),getThemeProps({theme:rt,name:o,props:a})}function clamp(a,o=0,_e=1){return Math.min(Math.max(o,a),_e)}function hexToRgb(a){a=a.slice(1);const o=new RegExp(`.{1,${a.length>=6?2:1}}`,"g");let _e=a.match(o);return _e&&_e[0].length===1&&(_e=_e.map(et=>et+et)),_e?`rgb${_e.length===4?"a":""}(${_e.map((et,rt)=>rt<3?parseInt(et,16):Math.round(parseInt(et,16)/255*1e3)/1e3).join(", ")})`:""}function decomposeColor(a){if(a.type)return a;if(a.charAt(0)==="#")return decomposeColor(hexToRgb(a));const o=a.indexOf("("),_e=a.substring(0,o);if(["rgb","rgba","hsl","hsla","color"].indexOf(_e)===-1)throw new Error(formatMuiErrorMessage(9,a));let et=a.substring(o+1,a.length-1),rt;if(_e==="color"){if(et=et.split(" "),rt=et.shift(),et.length===4&&et[3].charAt(0)==="/"&&(et[3]=et[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(rt)===-1)throw new Error(formatMuiErrorMessage(10,rt))}else et=et.split(",");return et=et.map(lt=>parseFloat(lt)),{type:_e,values:et,colorSpace:rt}}function recomposeColor(a){const{type:o,colorSpace:_e}=a;let{values:et}=a;return o.indexOf("rgb")!==-1?et=et.map((rt,lt)=>lt<3?parseInt(rt,10):rt):o.indexOf("hsl")!==-1&&(et[1]=`${et[1]}%`,et[2]=`${et[2]}%`),o.indexOf("color")!==-1?et=`${_e} ${et.join(" ")}`:et=`${et.join(", ")}`,`${o}(${et})`}function hslToRgb(a){a=decomposeColor(a);const{values:o}=a,_e=o[0],et=o[1]/100,rt=o[2]/100,lt=et*Math.min(rt,1-rt),it=(tt,ot=(tt+_e/30)%12)=>rt-lt*Math.max(Math.min(ot-3,9-ot,1),-1);let ut="rgb";const s=[Math.round(it(0)*255),Math.round(it(8)*255),Math.round(it(4)*255)];return a.type==="hsla"&&(ut+="a",s.push(o[3])),recomposeColor({type:ut,values:s})}function getLuminance(a){a=decomposeColor(a);let o=a.type==="hsl"||a.type==="hsla"?decomposeColor(hslToRgb(a)).values:a.values;return o=o.map(_e=>(a.type!=="color"&&(_e/=255),_e<=.03928?_e/12.92:((_e+.055)/1.055)**2.4)),Number((.2126*o[0]+.7152*o[1]+.0722*o[2]).toFixed(3))}function getContrastRatio(a,o){const _e=getLuminance(a),et=getLuminance(o);return(Math.max(_e,et)+.05)/(Math.min(_e,et)+.05)}function alpha(a,o){return a=decomposeColor(a),o=clamp(o),(a.type==="rgb"||a.type==="hsl")&&(a.type+="a"),a.type==="color"?a.values[3]=`/${o}`:a.values[3]=o,recomposeColor(a)}function darken(a,o){if(a=decomposeColor(a),o=clamp(o),a.type.indexOf("hsl")!==-1)a.values[2]*=1-o;else if(a.type.indexOf("rgb")!==-1||a.type.indexOf("color")!==-1)for(let _e=0;_e<3;_e+=1)a.values[_e]*=1-o;return recomposeColor(a)}function lighten(a,o){if(a=decomposeColor(a),o=clamp(o),a.type.indexOf("hsl")!==-1)a.values[2]+=(100-a.values[2])*o;else if(a.type.indexOf("rgb")!==-1)for(let _e=0;_e<3;_e+=1)a.values[_e]+=(255-a.values[_e])*o;else if(a.type.indexOf("color")!==-1)for(let _e=0;_e<3;_e+=1)a.values[_e]+=(1-a.values[_e])*o;return recomposeColor(a)}const ThemeContext=reactExports.createContext(null),ThemeContext$1=ThemeContext;function useTheme$1(){return reactExports.useContext(ThemeContext$1)}const hasSymbol=typeof Symbol=="function"&&Symbol.for,nested=hasSymbol?Symbol.for("mui.nested"):"__THEME_NESTED__";function mergeOuterLocalTheme(a,o){return typeof o=="function"?o(a):_extends({},a,o)}function ThemeProvider$2(a){const{children:o,theme:_e}=a,et=useTheme$1(),rt=reactExports.useMemo(()=>{const lt=et===null?_e:mergeOuterLocalTheme(et,_e);return lt!=null&&(lt[nested]=et!==null),lt},[_e,et]);return jsxRuntimeExports.jsx(ThemeContext$1.Provider,{value:rt,children:o})}const EMPTY_THEME={};function useThemeScoping(a,o,_e,et=!1){return reactExports.useMemo(()=>{const rt=a&&o[a]||o;if(typeof _e=="function"){const lt=_e(rt),it=a?_extends({},o,{[a]:lt}):lt;return et?()=>it:it}return a?_extends({},o,{[a]:_e}):_extends({},o,_e)},[a,o,_e,et])}function ThemeProvider$1(a){const{children:o,theme:_e,themeId:et}=a,rt=useTheme$3(EMPTY_THEME),lt=useTheme$1()||EMPTY_THEME,it=useThemeScoping(et,rt,_e),ut=useThemeScoping(et,lt,_e,!0);return jsxRuntimeExports.jsx(ThemeProvider$2,{theme:ut,children:jsxRuntimeExports.jsx(ThemeContext$2.Provider,{value:it,children:o})})}const _excluded$O=["className","component","disableGutters","fixed","maxWidth","classes"],defaultTheme$4=createTheme$1(),defaultCreateStyledComponent$1=systemStyled("div",{name:"MuiContainer",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[`maxWidth${capitalize(String(_e.maxWidth))}`],_e.fixed&&o.fixed,_e.disableGutters&&o.disableGutters]}}),useThemePropsDefault$1=a=>useThemeProps$1({props:a,name:"MuiContainer",defaultTheme:defaultTheme$4}),useUtilityClasses$z=(a,o)=>{const _e=s=>generateUtilityClass(o,s),{classes:et,fixed:rt,disableGutters:lt,maxWidth:it}=a,ut={root:["root",it&&`maxWidth${capitalize(String(it))}`,rt&&"fixed",lt&&"disableGutters"]};return composeClasses(ut,_e,et)};function createContainer(a={}){const{createStyledComponent:o=defaultCreateStyledComponent$1,useThemeProps:_e=useThemePropsDefault$1,componentName:et="MuiContainer"}=a,rt=o(({theme:it,ownerState:ut})=>_extends({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!ut.disableGutters&&{paddingLeft:it.spacing(2),paddingRight:it.spacing(2),[it.breakpoints.up("sm")]:{paddingLeft:it.spacing(3),paddingRight:it.spacing(3)}}),({theme:it,ownerState:ut})=>ut.fixed&&Object.keys(it.breakpoints.values).reduce((s,tt)=>{const ot=tt,ct=it.breakpoints.values[ot];return ct!==0&&(s[it.breakpoints.up(ot)]={maxWidth:`${ct}${it.breakpoints.unit}`}),s},{}),({theme:it,ownerState:ut})=>_extends({},ut.maxWidth==="xs"&&{[it.breakpoints.up("xs")]:{maxWidth:Math.max(it.breakpoints.values.xs,444)}},ut.maxWidth&&ut.maxWidth!=="xs"&&{[it.breakpoints.up(ut.maxWidth)]:{maxWidth:`${it.breakpoints.values[ut.maxWidth]}${it.breakpoints.unit}`}}));return reactExports.forwardRef(function(ut,s){const tt=_e(ut),{className:ot,component:ct="div",disableGutters:yt=!1,fixed:pt=!1,maxWidth:gt="lg"}=tt,st=_objectWithoutPropertiesLoose(tt,_excluded$O),ft=_extends({},tt,{component:ct,disableGutters:yt,fixed:pt,maxWidth:gt}),at=useUtilityClasses$z(ft,et);return jsxRuntimeExports.jsx(rt,_extends({as:ct,ownerState:ft,className:clsx(at.root,ot),ref:s},st))})}const _excluded$N=["component","direction","spacing","divider","children","className","useFlexGap"],defaultTheme$3=createTheme$1(),defaultCreateStyledComponent=systemStyled("div",{name:"MuiStack",slot:"Root",overridesResolver:(a,o)=>o.root});function useThemePropsDefault(a){return useThemeProps$1({props:a,name:"MuiStack",defaultTheme:defaultTheme$3})}function joinChildren(a,o){const _e=reactExports.Children.toArray(a).filter(Boolean);return _e.reduce((et,rt,lt)=>(et.push(rt),lt<_e.length-1&&et.push(reactExports.cloneElement(o,{key:`separator-${lt}`})),et),[])}const getSideFromDirection=a=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[a],style=({ownerState:a,theme:o})=>{let _e=_extends({display:"flex",flexDirection:"column"},handleBreakpoints({theme:o},resolveBreakpointValues({values:a.direction,breakpoints:o.breakpoints.values}),et=>({flexDirection:et})));if(a.spacing){const et=createUnarySpacing(o),rt=Object.keys(o.breakpoints.values).reduce((s,tt)=>((typeof a.spacing=="object"&&a.spacing[tt]!=null||typeof a.direction=="object"&&a.direction[tt]!=null)&&(s[tt]=!0),s),{}),lt=resolveBreakpointValues({values:a.direction,base:rt}),it=resolveBreakpointValues({values:a.spacing,base:rt});typeof lt=="object"&&Object.keys(lt).forEach((s,tt,ot)=>{if(!lt[s]){const yt=tt>0?lt[ot[tt-1]]:"column";lt[s]=yt}}),_e=deepmerge(_e,handleBreakpoints({theme:o},it,(s,tt)=>a.useFlexGap?{gap:getValue(et,s)}:{"& > :not(style) + :not(style)":{margin:0,[`margin${getSideFromDirection(tt?lt[tt]:a.direction)}`]:getValue(et,s)}}))}return _e=mergeBreakpointsInOrder(o.breakpoints,_e),_e};function createStack(a={}){const{createStyledComponent:o=defaultCreateStyledComponent,useThemeProps:_e=useThemePropsDefault,componentName:et="MuiStack"}=a,rt=()=>composeClasses({root:["root"]},s=>generateUtilityClass(et,s),{}),lt=o(style);return reactExports.forwardRef(function(s,tt){const ot=_e(s),ct=extendSxProp(ot),{component:yt="div",direction:pt="column",spacing:gt=0,divider:st,children:ft,className:at,useFlexGap:ht=!1}=ct,mt=_objectWithoutPropertiesLoose(ct,_excluded$N),St={direction:pt,spacing:gt,useFlexGap:ht},It=rt();return jsxRuntimeExports.jsx(lt,_extends({as:yt,ownerState:St,ref:tt,className:clsx(It.root,at)},mt,{children:st?joinChildren(ft,st):ft}))})}function isHostComponent(a){return typeof a=="string"}function appendOwnerState(a,o,_e){return a===void 0||isHostComponent(a)?o:_extends({},o,{ownerState:_extends({},o.ownerState,_e)})}const defaultContextValue={disableDefaultClasses:!1},ClassNameConfiguratorContext=reactExports.createContext(defaultContextValue);function useClassNamesOverride(a){const{disableDefaultClasses:o}=reactExports.useContext(ClassNameConfiguratorContext);return _e=>o?"":a(_e)}function extractEventHandlers(a,o=[]){if(a===void 0)return{};const _e={};return Object.keys(a).filter(et=>et.match(/^on[A-Z]/)&&typeof a[et]=="function"&&!o.includes(et)).forEach(et=>{_e[et]=a[et]}),_e}function resolveComponentProps(a,o){return typeof a=="function"?a(o):a}function omitEventHandlers(a){if(a===void 0)return{};const o={};return Object.keys(a).filter(_e=>!(_e.match(/^on[A-Z]/)&&typeof a[_e]=="function")).forEach(_e=>{o[_e]=a[_e]}),o}function mergeSlotProps(a){const{getSlotProps:o,additionalProps:_e,externalSlotProps:et,externalForwardedProps:rt,className:lt}=a;if(!o){const pt=clsx(rt==null?void 0:rt.className,et==null?void 0:et.className,lt,_e==null?void 0:_e.className),gt=_extends({},_e==null?void 0:_e.style,rt==null?void 0:rt.style,et==null?void 0:et.style),st=_extends({},_e,rt,et);return pt.length>0&&(st.className=pt),Object.keys(gt).length>0&&(st.style=gt),{props:st,internalRef:void 0}}const it=extractEventHandlers(_extends({},rt,et)),ut=omitEventHandlers(et),s=omitEventHandlers(rt),tt=o(it),ot=clsx(tt==null?void 0:tt.className,_e==null?void 0:_e.className,lt,rt==null?void 0:rt.className,et==null?void 0:et.className),ct=_extends({},tt==null?void 0:tt.style,_e==null?void 0:_e.style,rt==null?void 0:rt.style,et==null?void 0:et.style),yt=_extends({},tt,_e,s,ut);return ot.length>0&&(yt.className=ot),Object.keys(ct).length>0&&(yt.style=ct),{props:yt,internalRef:tt.ref}}const _excluded$M=["elementType","externalSlotProps","ownerState"];function useSlotProps(a){var o;const{elementType:_e,externalSlotProps:et,ownerState:rt}=a,lt=_objectWithoutPropertiesLoose(a,_excluded$M),it=resolveComponentProps(et,rt),{props:ut,internalRef:s}=mergeSlotProps(_extends({},lt,{externalSlotProps:it})),tt=useForkRef(s,it==null?void 0:it.ref,(o=a.additionalProps)==null?void 0:o.ref);return appendOwnerState(_e,_extends({},ut,{ref:tt}),rt)}const candidatesSelector=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function getTabIndex(a){const o=parseInt(a.getAttribute("tabindex")||"",10);return Number.isNaN(o)?a.contentEditable==="true"||(a.nodeName==="AUDIO"||a.nodeName==="VIDEO"||a.nodeName==="DETAILS")&&a.getAttribute("tabindex")===null?0:a.tabIndex:o}function isNonTabbableRadio(a){if(a.tagName!=="INPUT"||a.type!=="radio"||!a.name)return!1;const o=et=>a.ownerDocument.querySelector(`input[type="radio"]${et}`);let _e=o(`[name="${a.name}"]:checked`);return _e||(_e=o(`[name="${a.name}"]`)),_e!==a}function isNodeMatchingSelectorFocusable(a){return!(a.disabled||a.tagName==="INPUT"&&a.type==="hidden"||isNonTabbableRadio(a))}function defaultGetTabbable(a){const o=[],_e=[];return Array.from(a.querySelectorAll(candidatesSelector)).forEach((et,rt)=>{const lt=getTabIndex(et);lt===-1||!isNodeMatchingSelectorFocusable(et)||(lt===0?o.push(et):_e.push({documentOrder:rt,tabIndex:lt,node:et}))}),_e.sort((et,rt)=>et.tabIndex===rt.tabIndex?et.documentOrder-rt.documentOrder:et.tabIndex-rt.tabIndex).map(et=>et.node).concat(o)}function defaultIsEnabled(){return!0}function FocusTrap(a){const{children:o,disableAutoFocus:_e=!1,disableEnforceFocus:et=!1,disableRestoreFocus:rt=!1,getTabbable:lt=defaultGetTabbable,isEnabled:it=defaultIsEnabled,open:ut}=a,s=reactExports.useRef(!1),tt=reactExports.useRef(null),ot=reactExports.useRef(null),ct=reactExports.useRef(null),yt=reactExports.useRef(null),pt=reactExports.useRef(!1),gt=reactExports.useRef(null),st=useForkRef(o.ref,gt),ft=reactExports.useRef(null);reactExports.useEffect(()=>{!ut||!gt.current||(pt.current=!_e)},[_e,ut]),reactExports.useEffect(()=>{if(!ut||!gt.current)return;const mt=ownerDocument(gt.current);return gt.current.contains(mt.activeElement)||(gt.current.hasAttribute("tabIndex")||gt.current.setAttribute("tabIndex","-1"),pt.current&&gt.current.focus()),()=>{rt||(ct.current&&ct.current.focus&&(s.current=!0,ct.current.focus()),ct.current=null)}},[ut]),reactExports.useEffect(()=>{if(!ut||!gt.current)return;const mt=ownerDocument(gt.current),St=At=>{const{current:Nt}=gt;if(Nt!==null){if(!mt.hasFocus()||et||!it()||s.current){s.current=!1;return}if(!Nt.contains(mt.activeElement)){if(At&&yt.current!==At.target||mt.activeElement!==yt.current)yt.current=null;else if(yt.current!==null)return;if(!pt.current)return;let bt=[];if((mt.activeElement===tt.current||mt.activeElement===ot.current)&&(bt=lt(gt.current)),bt.length>0){var kt,Mt;const Bt=!!((kt=ft.current)!=null&&kt.shiftKey&&((Mt=ft.current)==null?void 0:Mt.key)==="Tab"),Ht=bt[0],Wt=bt[bt.length-1];typeof Ht!="string"&&typeof Wt!="string"&&(Bt?Wt.focus():Ht.focus())}else Nt.focus()}}},It=At=>{ft.current=At,!(et||!it()||At.key!=="Tab")&&mt.activeElement===gt.current&&At.shiftKey&&(s.current=!0,ot.current&&ot.current.focus())};mt.addEventListener("focusin",St),mt.addEventListener("keydown",It,!0);const xt=setInterval(()=>{mt.activeElement&&mt.activeElement.tagName==="BODY"&&St(null)},50);return()=>{clearInterval(xt),mt.removeEventListener("focusin",St),mt.removeEventListener("keydown",It,!0)}},[_e,et,rt,it,ut,lt]);const at=mt=>{ct.current===null&&(ct.current=mt.relatedTarget),pt.current=!0,yt.current=mt.target;const St=o.props.onFocus;St&&St(mt)},ht=mt=>{ct.current===null&&(ct.current=mt.relatedTarget),pt.current=!0};return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{tabIndex:ut?0:-1,onFocus:ht,ref:tt,"data-testid":"sentinelStart"}),reactExports.cloneElement(o,{ref:st,onFocus:at}),jsxRuntimeExports.jsx("div",{tabIndex:ut?0:-1,onFocus:ht,ref:ot,"data-testid":"sentinelEnd"})]})}var top="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[top,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce(function(a,o){return a.concat([o+"-"+start,o+"-"+end])},[]),placements=[].concat(basePlacements,[auto]).reduce(function(a,o){return a.concat([o,o+"-"+start,o+"-"+end])},[]),beforeRead="beforeRead",read="read",afterRead="afterRead",beforeMain="beforeMain",main="main",afterMain="afterMain",beforeWrite="beforeWrite",write="write",afterWrite="afterWrite",modifierPhases=[beforeRead,read,afterRead,beforeMain,main,afterMain,beforeWrite,write,afterWrite];function getNodeName(a){return a?(a.nodeName||"").toLowerCase():null}function getWindow(a){if(a==null)return window;if(a.toString()!=="[object Window]"){var o=a.ownerDocument;return o&&o.defaultView||window}return a}function isElement(a){var o=getWindow(a).Element;return a instanceof o||a instanceof Element}function isHTMLElement$1(a){var o=getWindow(a).HTMLElement;return a instanceof o||a instanceof HTMLElement}function isShadowRoot(a){if(typeof ShadowRoot>"u")return!1;var o=getWindow(a).ShadowRoot;return a instanceof o||a instanceof ShadowRoot}function applyStyles(a){var o=a.state;Object.keys(o.elements).forEach(function(_e){var et=o.styles[_e]||{},rt=o.attributes[_e]||{},lt=o.elements[_e];!isHTMLElement$1(lt)||!getNodeName(lt)||(Object.assign(lt.style,et),Object.keys(rt).forEach(function(it){var ut=rt[it];ut===!1?lt.removeAttribute(it):lt.setAttribute(it,ut===!0?"":ut)}))})}function effect$2(a){var o=a.state,_e={popper:{position:o.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(o.elements.popper.style,_e.popper),o.styles=_e,o.elements.arrow&&Object.assign(o.elements.arrow.style,_e.arrow),function(){Object.keys(o.elements).forEach(function(et){var rt=o.elements[et],lt=o.attributes[et]||{},it=Object.keys(o.styles.hasOwnProperty(et)?o.styles[et]:_e[et]),ut=it.reduce(function(s,tt){return s[tt]="",s},{});!isHTMLElement$1(rt)||!getNodeName(rt)||(Object.assign(rt.style,ut),Object.keys(lt).forEach(function(s){rt.removeAttribute(s)}))})}}const applyStyles$1={name:"applyStyles",enabled:!0,phase:"write",fn:applyStyles,effect:effect$2,requires:["computeStyles"]};function getBasePlacement(a){return a.split("-")[0]}var max=Math.max,min=Math.min,round$2=Math.round;function getUAString(){var a=navigator.userAgentData;return a!=null&&a.brands&&Array.isArray(a.brands)?a.brands.map(function(o){return o.brand+"/"+o.version}).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(a,o,_e){o===void 0&&(o=!1),_e===void 0&&(_e=!1);var et=a.getBoundingClientRect(),rt=1,lt=1;o&&isHTMLElement$1(a)&&(rt=a.offsetWidth>0&&round$2(et.width)/a.offsetWidth||1,lt=a.offsetHeight>0&&round$2(et.height)/a.offsetHeight||1);var it=isElement(a)?getWindow(a):window,ut=it.visualViewport,s=!isLayoutViewport()&&_e,tt=(et.left+(s&&ut?ut.offsetLeft:0))/rt,ot=(et.top+(s&&ut?ut.offsetTop:0))/lt,ct=et.width/rt,yt=et.height/lt;return{width:ct,height:yt,top:ot,right:tt+ct,bottom:ot+yt,left:tt,x:tt,y:ot}}function getLayoutRect(a){var o=getBoundingClientRect(a),_e=a.offsetWidth,et=a.offsetHeight;return Math.abs(o.width-_e)<=1&&(_e=o.width),Math.abs(o.height-et)<=1&&(et=o.height),{x:a.offsetLeft,y:a.offsetTop,width:_e,height:et}}function contains(a,o){var _e=o.getRootNode&&o.getRootNode();if(a.contains(o))return!0;if(_e&&isShadowRoot(_e)){var et=o;do{if(et&&a.isSameNode(et))return!0;et=et.parentNode||et.host}while(et)}return!1}function getComputedStyle$1(a){return getWindow(a).getComputedStyle(a)}function isTableElement(a){return["table","td","th"].indexOf(getNodeName(a))>=0}function getDocumentElement(a){return((isElement(a)?a.ownerDocument:a.document)||window.document).documentElement}function getParentNode(a){return getNodeName(a)==="html"?a:a.assignedSlot||a.parentNode||(isShadowRoot(a)?a.host:null)||getDocumentElement(a)}function getTrueOffsetParent(a){return!isHTMLElement$1(a)||getComputedStyle$1(a).position==="fixed"?null:a.offsetParent}function getContainingBlock(a){var o=/firefox/i.test(getUAString()),_e=/Trident/i.test(getUAString());if(_e&&isHTMLElement$1(a)){var et=getComputedStyle$1(a);if(et.position==="fixed")return null}var rt=getParentNode(a);for(isShadowRoot(rt)&&(rt=rt.host);isHTMLElement$1(rt)&&["html","body"].indexOf(getNodeName(rt))<0;){var lt=getComputedStyle$1(rt);if(lt.transform!=="none"||lt.perspective!=="none"||lt.contain==="paint"||["transform","perspective"].indexOf(lt.willChange)!==-1||o&&lt.willChange==="filter"||o&&lt.filter&&lt.filter!=="none")return rt;rt=rt.parentNode}return null}function getOffsetParent(a){for(var o=getWindow(a),_e=getTrueOffsetParent(a);_e&&isTableElement(_e)&&getComputedStyle$1(_e).position==="static";)_e=getTrueOffsetParent(_e);return _e&&(getNodeName(_e)==="html"||getNodeName(_e)==="body"&&getComputedStyle$1(_e).position==="static")?o:_e||getContainingBlock(a)||o}function getMainAxisFromPlacement(a){return["top","bottom"].indexOf(a)>=0?"x":"y"}function within(a,o,_e){return max(a,min(o,_e))}function withinMaxClamp(a,o,_e){var et=within(a,o,_e);return et>_e?_e:et}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(a){return Object.assign({},getFreshSideObject(),a)}function expandToHashMap(a,o){return o.reduce(function(_e,et){return _e[et]=a,_e},{})}var toPaddingObject=function(o,_e){return o=typeof o=="function"?o(Object.assign({},_e.rects,{placement:_e.placement})):o,mergePaddingObject(typeof o!="number"?o:expandToHashMap(o,basePlacements))};function arrow(a){var o,_e=a.state,et=a.name,rt=a.options,lt=_e.elements.arrow,it=_e.modifiersData.popperOffsets,ut=getBasePlacement(_e.placement),s=getMainAxisFromPlacement(ut),tt=[left,right].indexOf(ut)>=0,ot=tt?"height":"width";if(!(!lt||!it)){var ct=toPaddingObject(rt.padding,_e),yt=getLayoutRect(lt),pt=s==="y"?top:left,gt=s==="y"?bottom:right,st=_e.rects.reference[ot]+_e.rects.reference[s]-it[s]-_e.rects.popper[ot],ft=it[s]-_e.rects.reference[s],at=getOffsetParent(lt),ht=at?s==="y"?at.clientHeight||0:at.clientWidth||0:0,mt=st/2-ft/2,St=ct[pt],It=ht-yt[ot]-ct[gt],xt=ht/2-yt[ot]/2+mt,At=within(St,xt,It),Nt=s;_e.modifiersData[et]=(o={},o[Nt]=At,o.centerOffset=At-xt,o)}}function effect$1(a){var o=a.state,_e=a.options,et=_e.element,rt=et===void 0?"[data-popper-arrow]":et;rt!=null&&(typeof rt=="string"&&(rt=o.elements.popper.querySelector(rt),!rt)||contains(o.elements.popper,rt)&&(o.elements.arrow=rt))}const arrow$1={name:"arrow",enabled:!0,phase:"main",fn:arrow,effect:effect$1,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getVariation(a){return a.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(a,o){var _e=a.x,et=a.y,rt=o.devicePixelRatio||1;return{x:round$2(_e*rt)/rt||0,y:round$2(et*rt)/rt||0}}function mapToStyles(a){var o,_e=a.popper,et=a.popperRect,rt=a.placement,lt=a.variation,it=a.offsets,ut=a.position,s=a.gpuAcceleration,tt=a.adaptive,ot=a.roundOffsets,ct=a.isFixed,yt=it.x,pt=yt===void 0?0:yt,gt=it.y,st=gt===void 0?0:gt,ft=typeof ot=="function"?ot({x:pt,y:st}):{x:pt,y:st};pt=ft.x,st=ft.y;var at=it.hasOwnProperty("x"),ht=it.hasOwnProperty("y"),mt=left,St=top,It=window;if(tt){var xt=getOffsetParent(_e),At="clientHeight",Nt="clientWidth";if(xt===getWindow(_e)&&(xt=getDocumentElement(_e),getComputedStyle$1(xt).position!=="static"&&ut==="absolute"&&(At="scrollHeight",Nt="scrollWidth")),xt=xt,rt===top||(rt===left||rt===right)&&lt===end){St=bottom;var kt=ct&&xt===It&&It.visualViewport?It.visualViewport.height:xt[At];st-=kt-et.height,st*=s?1:-1}if(rt===left||(rt===top||rt===bottom)&&lt===end){mt=right;var Mt=ct&&xt===It&&It.visualViewport?It.visualViewport.width:xt[Nt];pt-=Mt-et.width,pt*=s?1:-1}}var bt=Object.assign({position:ut},tt&&unsetSides),Bt=ot===!0?roundOffsetsByDPR({x:pt,y:st},getWindow(_e)):{x:pt,y:st};if(pt=Bt.x,st=Bt.y,s){var Ht;return Object.assign({},bt,(Ht={},Ht[St]=ht?"0":"",Ht[mt]=at?"0":"",Ht.transform=(It.devicePixelRatio||1)<=1?"translate("+pt+"px, "+st+"px)":"translate3d("+pt+"px, "+st+"px, 0)",Ht))}return Object.assign({},bt,(o={},o[St]=ht?st+"px":"",o[mt]=at?pt+"px":"",o.transform="",o))}function computeStyles(a){var o=a.state,_e=a.options,et=_e.gpuAcceleration,rt=et===void 0?!0:et,lt=_e.adaptive,it=lt===void 0?!0:lt,ut=_e.roundOffsets,s=ut===void 0?!0:ut,tt={placement:getBasePlacement(o.placement),variation:getVariation(o.placement),popper:o.elements.popper,popperRect:o.rects.popper,gpuAcceleration:rt,isFixed:o.options.strategy==="fixed"};o.modifiersData.popperOffsets!=null&&(o.styles.popper=Object.assign({},o.styles.popper,mapToStyles(Object.assign({},tt,{offsets:o.modifiersData.popperOffsets,position:o.options.strategy,adaptive:it,roundOffsets:s})))),o.modifiersData.arrow!=null&&(o.styles.arrow=Object.assign({},o.styles.arrow,mapToStyles(Object.assign({},tt,{offsets:o.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:s})))),o.attributes.popper=Object.assign({},o.attributes.popper,{"data-popper-placement":o.placement})}const computeStyles$1={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};var passive={passive:!0};function effect(a){var o=a.state,_e=a.instance,et=a.options,rt=et.scroll,lt=rt===void 0?!0:rt,it=et.resize,ut=it===void 0?!0:it,s=getWindow(o.elements.popper),tt=[].concat(o.scrollParents.reference,o.scrollParents.popper);return lt&&tt.forEach(function(ot){ot.addEventListener("scroll",_e.update,passive)}),ut&&s.addEventListener("resize",_e.update,passive),function(){lt&&tt.forEach(function(ot){ot.removeEventListener("scroll",_e.update,passive)}),ut&&s.removeEventListener("resize",_e.update,passive)}}const eventListeners={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect,data:{}};var hash$1={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(a){return a.replace(/left|right|bottom|top/g,function(o){return hash$1[o]})}var hash={start:"end",end:"start"};function getOppositeVariationPlacement(a){return a.replace(/start|end/g,function(o){return hash[o]})}function getWindowScroll(a){var o=getWindow(a),_e=o.pageXOffset,et=o.pageYOffset;return{scrollLeft:_e,scrollTop:et}}function getWindowScrollBarX(a){return getBoundingClientRect(getDocumentElement(a)).left+getWindowScroll(a).scrollLeft}function getViewportRect(a,o){var _e=getWindow(a),et=getDocumentElement(a),rt=_e.visualViewport,lt=et.clientWidth,it=et.clientHeight,ut=0,s=0;if(rt){lt=rt.width,it=rt.height;var tt=isLayoutViewport();(tt||!tt&&o==="fixed")&&(ut=rt.offsetLeft,s=rt.offsetTop)}return{width:lt,height:it,x:ut+getWindowScrollBarX(a),y:s}}function getDocumentRect(a){var o,_e=getDocumentElement(a),et=getWindowScroll(a),rt=(o=a.ownerDocument)==null?void 0:o.body,lt=max(_e.scrollWidth,_e.clientWidth,rt?rt.scrollWidth:0,rt?rt.clientWidth:0),it=max(_e.scrollHeight,_e.clientHeight,rt?rt.scrollHeight:0,rt?rt.clientHeight:0),ut=-et.scrollLeft+getWindowScrollBarX(a),s=-et.scrollTop;return getComputedStyle$1(rt||_e).direction==="rtl"&&(ut+=max(_e.clientWidth,rt?rt.clientWidth:0)-lt),{width:lt,height:it,x:ut,y:s}}function isScrollParent(a){var o=getComputedStyle$1(a),_e=o.overflow,et=o.overflowX,rt=o.overflowY;return/auto|scroll|overlay|hidden/.test(_e+rt+et)}function getScrollParent(a){return["html","body","#document"].indexOf(getNodeName(a))>=0?a.ownerDocument.body:isHTMLElement$1(a)&&isScrollParent(a)?a:getScrollParent(getParentNode(a))}function listScrollParents(a,o){var _e;o===void 0&&(o=[]);var et=getScrollParent(a),rt=et===((_e=a.ownerDocument)==null?void 0:_e.body),lt=getWindow(et),it=rt?[lt].concat(lt.visualViewport||[],isScrollParent(et)?et:[]):et,ut=o.concat(it);return rt?ut:ut.concat(listScrollParents(getParentNode(it)))}function rectToClientRect(a){return Object.assign({},a,{left:a.x,top:a.y,right:a.x+a.width,bottom:a.y+a.height})}function getInnerBoundingClientRect(a,o){var _e=getBoundingClientRect(a,!1,o==="fixed");return _e.top=_e.top+a.clientTop,_e.left=_e.left+a.clientLeft,_e.bottom=_e.top+a.clientHeight,_e.right=_e.left+a.clientWidth,_e.width=a.clientWidth,_e.height=a.clientHeight,_e.x=_e.left,_e.y=_e.top,_e}function getClientRectFromMixedType(a,o,_e){return o===viewport?rectToClientRect(getViewportRect(a,_e)):isElement(o)?getInnerBoundingClientRect(o,_e):rectToClientRect(getDocumentRect(getDocumentElement(a)))}function getClippingParents(a){var o=listScrollParents(getParentNode(a)),_e=["absolute","fixed"].indexOf(getComputedStyle$1(a).position)>=0,et=_e&&isHTMLElement$1(a)?getOffsetParent(a):a;return isElement(et)?o.filter(function(rt){return isElement(rt)&&contains(rt,et)&&getNodeName(rt)!=="body"}):[]}function getClippingRect(a,o,_e,et){var rt=o==="clippingParents"?getClippingParents(a):[].concat(o),lt=[].concat(rt,[_e]),it=lt[0],ut=lt.reduce(function(s,tt){var ot=getClientRectFromMixedType(a,tt,et);return s.top=max(ot.top,s.top),s.right=min(ot.right,s.right),s.bottom=min(ot.bottom,s.bottom),s.left=max(ot.left,s.left),s},getClientRectFromMixedType(a,it,et));return ut.width=ut.right-ut.left,ut.height=ut.bottom-ut.top,ut.x=ut.left,ut.y=ut.top,ut}function computeOffsets(a){var o=a.reference,_e=a.element,et=a.placement,rt=et?getBasePlacement(et):null,lt=et?getVariation(et):null,it=o.x+o.width/2-_e.width/2,ut=o.y+o.height/2-_e.height/2,s;switch(rt){case top:s={x:it,y:o.y-_e.height};break;case bottom:s={x:it,y:o.y+o.height};break;case right:s={x:o.x+o.width,y:ut};break;case left:s={x:o.x-_e.width,y:ut};break;default:s={x:o.x,y:o.y}}var tt=rt?getMainAxisFromPlacement(rt):null;if(tt!=null){var ot=tt==="y"?"height":"width";switch(lt){case start:s[tt]=s[tt]-(o[ot]/2-_e[ot]/2);break;case end:s[tt]=s[tt]+(o[ot]/2-_e[ot]/2);break}}return s}function detectOverflow(a,o){o===void 0&&(o={});var _e=o,et=_e.placement,rt=et===void 0?a.placement:et,lt=_e.strategy,it=lt===void 0?a.strategy:lt,ut=_e.boundary,s=ut===void 0?clippingParents:ut,tt=_e.rootBoundary,ot=tt===void 0?viewport:tt,ct=_e.elementContext,yt=ct===void 0?popper:ct,pt=_e.altBoundary,gt=pt===void 0?!1:pt,st=_e.padding,ft=st===void 0?0:st,at=mergePaddingObject(typeof ft!="number"?ft:expandToHashMap(ft,basePlacements)),ht=yt===popper?reference:popper,mt=a.rects.popper,St=a.elements[gt?ht:yt],It=getClippingRect(isElement(St)?St:St.contextElement||getDocumentElement(a.elements.popper),s,ot,it),xt=getBoundingClientRect(a.elements.reference),At=computeOffsets({reference:xt,element:mt,strategy:"absolute",placement:rt}),Nt=rectToClientRect(Object.assign({},mt,At)),kt=yt===popper?Nt:xt,Mt={top:It.top-kt.top+at.top,bottom:kt.bottom-It.bottom+at.bottom,left:It.left-kt.left+at.left,right:kt.right-It.right+at.right},bt=a.modifiersData.offset;if(yt===popper&&bt){var Bt=bt[rt];Object.keys(Mt).forEach(function(Ht){var Wt=[right,bottom].indexOf(Ht)>=0?1:-1,nn=[top,bottom].indexOf(Ht)>=0?"y":"x";Mt[Ht]+=Bt[nn]*Wt})}return Mt}function computeAutoPlacement(a,o){o===void 0&&(o={});var _e=o,et=_e.placement,rt=_e.boundary,lt=_e.rootBoundary,it=_e.padding,ut=_e.flipVariations,s=_e.allowedAutoPlacements,tt=s===void 0?placements:s,ot=getVariation(et),ct=ot?ut?variationPlacements:variationPlacements.filter(function(gt){return getVariation(gt)===ot}):basePlacements,yt=ct.filter(function(gt){return tt.indexOf(gt)>=0});yt.length===0&&(yt=ct);var pt=yt.reduce(function(gt,st){return gt[st]=detectOverflow(a,{placement:st,boundary:rt,rootBoundary:lt,padding:it})[getBasePlacement(st)],gt},{});return Object.keys(pt).sort(function(gt,st){return pt[gt]-pt[st]})}function getExpandedFallbackPlacements(a){if(getBasePlacement(a)===auto)return[];var o=getOppositePlacement(a);return[getOppositeVariationPlacement(a),o,getOppositeVariationPlacement(o)]}function flip(a){var o=a.state,_e=a.options,et=a.name;if(!o.modifiersData[et]._skip){for(var rt=_e.mainAxis,lt=rt===void 0?!0:rt,it=_e.altAxis,ut=it===void 0?!0:it,s=_e.fallbackPlacements,tt=_e.padding,ot=_e.boundary,ct=_e.rootBoundary,yt=_e.altBoundary,pt=_e.flipVariations,gt=pt===void 0?!0:pt,st=_e.allowedAutoPlacements,ft=o.options.placement,at=getBasePlacement(ft),ht=at===ft,mt=s||(ht||!gt?[getOppositePlacement(ft)]:getExpandedFallbackPlacements(ft)),St=[ft].concat(mt).reduce(function(yn,pn){return yn.concat(getBasePlacement(pn)===auto?computeAutoPlacement(o,{placement:pn,boundary:ot,rootBoundary:ct,padding:tt,flipVariations:gt,allowedAutoPlacements:st}):pn)},[]),It=o.rects.reference,xt=o.rects.popper,At=new Map,Nt=!0,kt=St[0],Mt=0;Mt<St.length;Mt++){var bt=St[Mt],Bt=getBasePlacement(bt),Ht=getVariation(bt)===start,Wt=[top,bottom].indexOf(Bt)>=0,nn=Wt?"width":"height",gn=detectOverflow(o,{placement:bt,boundary:ot,rootBoundary:ct,altBoundary:yt,padding:tt}),tn=Wt?Ht?right:left:Ht?bottom:top;It[nn]>xt[nn]&&(tn=getOppositePlacement(tn));var Gt=getOppositePlacement(tn),fn=[];if(lt&&fn.push(gn[Bt]<=0),ut&&fn.push(gn[tn]<=0,gn[Gt]<=0),fn.every(function(yn){return yn})){kt=bt,Nt=!1;break}At.set(bt,fn)}if(Nt)for(var Cn=gt?3:1,Tn=function(pn){var In=St.find(function(On){var _n=At.get(On);if(_n)return _n.slice(0,pn).every(function(Mn){return Mn})});if(In)return kt=In,"break"},dn=Cn;dn>0;dn--){var mn=Tn(dn);if(mn==="break")break}o.placement!==kt&&(o.modifiersData[et]._skip=!0,o.placement=kt,o.reset=!0)}}const flip$1={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(a,o,_e){return _e===void 0&&(_e={x:0,y:0}),{top:a.top-o.height-_e.y,right:a.right-o.width+_e.x,bottom:a.bottom-o.height+_e.y,left:a.left-o.width-_e.x}}function isAnySideFullyClipped(a){return[top,right,bottom,left].some(function(o){return a[o]>=0})}function hide(a){var o=a.state,_e=a.name,et=o.rects.reference,rt=o.rects.popper,lt=o.modifiersData.preventOverflow,it=detectOverflow(o,{elementContext:"reference"}),ut=detectOverflow(o,{altBoundary:!0}),s=getSideOffsets(it,et),tt=getSideOffsets(ut,rt,lt),ot=isAnySideFullyClipped(s),ct=isAnySideFullyClipped(tt);o.modifiersData[_e]={referenceClippingOffsets:s,popperEscapeOffsets:tt,isReferenceHidden:ot,hasPopperEscaped:ct},o.attributes.popper=Object.assign({},o.attributes.popper,{"data-popper-reference-hidden":ot,"data-popper-escaped":ct})}const hide$1={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(a,o,_e){var et=getBasePlacement(a),rt=[left,top].indexOf(et)>=0?-1:1,lt=typeof _e=="function"?_e(Object.assign({},o,{placement:a})):_e,it=lt[0],ut=lt[1];return it=it||0,ut=(ut||0)*rt,[left,right].indexOf(et)>=0?{x:ut,y:it}:{x:it,y:ut}}function offset(a){var o=a.state,_e=a.options,et=a.name,rt=_e.offset,lt=rt===void 0?[0,0]:rt,it=placements.reduce(function(ot,ct){return ot[ct]=distanceAndSkiddingToXY(ct,o.rects,lt),ot},{}),ut=it[o.placement],s=ut.x,tt=ut.y;o.modifiersData.popperOffsets!=null&&(o.modifiersData.popperOffsets.x+=s,o.modifiersData.popperOffsets.y+=tt),o.modifiersData[et]=it}const offset$1={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset};function popperOffsets(a){var o=a.state,_e=a.name;o.modifiersData[_e]=computeOffsets({reference:o.rects.reference,element:o.rects.popper,strategy:"absolute",placement:o.placement})}const popperOffsets$1={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(a){return a==="x"?"y":"x"}function preventOverflow(a){var o=a.state,_e=a.options,et=a.name,rt=_e.mainAxis,lt=rt===void 0?!0:rt,it=_e.altAxis,ut=it===void 0?!1:it,s=_e.boundary,tt=_e.rootBoundary,ot=_e.altBoundary,ct=_e.padding,yt=_e.tether,pt=yt===void 0?!0:yt,gt=_e.tetherOffset,st=gt===void 0?0:gt,ft=detectOverflow(o,{boundary:s,rootBoundary:tt,padding:ct,altBoundary:ot}),at=getBasePlacement(o.placement),ht=getVariation(o.placement),mt=!ht,St=getMainAxisFromPlacement(at),It=getAltAxis(St),xt=o.modifiersData.popperOffsets,At=o.rects.reference,Nt=o.rects.popper,kt=typeof st=="function"?st(Object.assign({},o.rects,{placement:o.placement})):st,Mt=typeof kt=="number"?{mainAxis:kt,altAxis:kt}:Object.assign({mainAxis:0,altAxis:0},kt),bt=o.modifiersData.offset?o.modifiersData.offset[o.placement]:null,Bt={x:0,y:0};if(xt){if(lt){var Ht,Wt=St==="y"?top:left,nn=St==="y"?bottom:right,gn=St==="y"?"height":"width",tn=xt[St],Gt=tn+ft[Wt],fn=tn-ft[nn],Cn=pt?-Nt[gn]/2:0,Tn=ht===start?At[gn]:Nt[gn],dn=ht===start?-Nt[gn]:-At[gn],mn=o.elements.arrow,yn=pt&&mn?getLayoutRect(mn):{width:0,height:0},pn=o.modifiersData["arrow#persistent"]?o.modifiersData["arrow#persistent"].padding:getFreshSideObject(),In=pn[Wt],On=pn[nn],_n=within(0,At[gn],yn[gn]),Mn=mt?At[gn]/2-Cn-_n-In-Mt.mainAxis:Tn-_n-In-Mt.mainAxis,Nn=mt?-At[gn]/2+Cn+_n+On+Mt.mainAxis:dn+_n+On+Mt.mainAxis,wn=o.elements.arrow&&getOffsetParent(o.elements.arrow),Pn=wn?St==="y"?wn.clientTop||0:wn.clientLeft||0:0,Fn=(Ht=bt==null?void 0:bt[St])!=null?Ht:0,ar=tn+Mn-Fn-Pn,Yn=tn+Nn-Fn,Xn=within(pt?min(Gt,ar):Gt,tn,pt?max(fn,Yn):fn);xt[St]=Xn,Bt[St]=Xn-tn}if(ut){var tr,cn=St==="x"?top:left,Hn=St==="x"?bottom:right,Qn=xt[It],or=It==="y"?"height":"width",Wn=Qn+ft[cn],ir=Qn-ft[Hn],nr=[top,left].indexOf(at)!==-1,xn=(tr=bt==null?void 0:bt[It])!=null?tr:0,Un=nr?Wn:Qn-At[or]-Nt[or]-xn+Mt.altAxis,vn=nr?Qn+At[or]+Nt[or]-xn-Mt.altAxis:ir,kn=pt&&nr?withinMaxClamp(Un,Qn,vn):within(pt?Un:Wn,Qn,pt?vn:ir);xt[It]=kn,Bt[It]=kn-Qn}o.modifiersData[et]=Bt}}const preventOverflow$1={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(a){return{scrollLeft:a.scrollLeft,scrollTop:a.scrollTop}}function getNodeScroll(a){return a===getWindow(a)||!isHTMLElement$1(a)?getWindowScroll(a):getHTMLElementScroll(a)}function isElementScaled(a){var o=a.getBoundingClientRect(),_e=round$2(o.width)/a.offsetWidth||1,et=round$2(o.height)/a.offsetHeight||1;return _e!==1||et!==1}function getCompositeRect(a,o,_e){_e===void 0&&(_e=!1);var et=isHTMLElement$1(o),rt=isHTMLElement$1(o)&&isElementScaled(o),lt=getDocumentElement(o),it=getBoundingClientRect(a,rt,_e),ut={scrollLeft:0,scrollTop:0},s={x:0,y:0};return(et||!et&&!_e)&&((getNodeName(o)!=="body"||isScrollParent(lt))&&(ut=getNodeScroll(o)),isHTMLElement$1(o)?(s=getBoundingClientRect(o,!0),s.x+=o.clientLeft,s.y+=o.clientTop):lt&&(s.x=getWindowScrollBarX(lt))),{x:it.left+ut.scrollLeft-s.x,y:it.top+ut.scrollTop-s.y,width:it.width,height:it.height}}function order(a){var o=new Map,_e=new Set,et=[];a.forEach(function(lt){o.set(lt.name,lt)});function rt(lt){_e.add(lt.name);var it=[].concat(lt.requires||[],lt.requiresIfExists||[]);it.forEach(function(ut){if(!_e.has(ut)){var s=o.get(ut);s&&rt(s)}}),et.push(lt)}return a.forEach(function(lt){_e.has(lt.name)||rt(lt)}),et}function orderModifiers(a){var o=order(a);return modifierPhases.reduce(function(_e,et){return _e.concat(o.filter(function(rt){return rt.phase===et}))},[])}function debounce(a){var o;return function(){return o||(o=new Promise(function(_e){Promise.resolve().then(function(){o=void 0,_e(a())})})),o}}function mergeByName(a){var o=a.reduce(function(_e,et){var rt=_e[et.name];return _e[et.name]=rt?Object.assign({},rt,et,{options:Object.assign({},rt.options,et.options),data:Object.assign({},rt.data,et.data)}):et,_e},{});return Object.keys(o).map(function(_e){return o[_e]})}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var a=arguments.length,o=new Array(a),_e=0;_e<a;_e++)o[_e]=arguments[_e];return!o.some(function(et){return!(et&&typeof et.getBoundingClientRect=="function")})}function popperGenerator(a){a===void 0&&(a={});var o=a,_e=o.defaultModifiers,et=_e===void 0?[]:_e,rt=o.defaultOptions,lt=rt===void 0?DEFAULT_OPTIONS:rt;return function(ut,s,tt){tt===void 0&&(tt=lt);var ot={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,lt),modifiersData:{},elements:{reference:ut,popper:s},attributes:{},styles:{}},ct=[],yt=!1,pt={state:ot,setOptions:function(at){var ht=typeof at=="function"?at(ot.options):at;st(),ot.options=Object.assign({},lt,ot.options,ht),ot.scrollParents={reference:isElement(ut)?listScrollParents(ut):ut.contextElement?listScrollParents(ut.contextElement):[],popper:listScrollParents(s)};var mt=orderModifiers(mergeByName([].concat(et,ot.options.modifiers)));return ot.orderedModifiers=mt.filter(function(St){return St.enabled}),gt(),pt.update()},forceUpdate:function(){if(!yt){var at=ot.elements,ht=at.reference,mt=at.popper;if(areValidElements(ht,mt)){ot.rects={reference:getCompositeRect(ht,getOffsetParent(mt),ot.options.strategy==="fixed"),popper:getLayoutRect(mt)},ot.reset=!1,ot.placement=ot.options.placement,ot.orderedModifiers.forEach(function(Mt){return ot.modifiersData[Mt.name]=Object.assign({},Mt.data)});for(var St=0;St<ot.orderedModifiers.length;St++){if(ot.reset===!0){ot.reset=!1,St=-1;continue}var It=ot.orderedModifiers[St],xt=It.fn,At=It.options,Nt=At===void 0?{}:At,kt=It.name;typeof xt=="function"&&(ot=xt({state:ot,options:Nt,name:kt,instance:pt})||ot)}}}},update:debounce(function(){return new Promise(function(ft){pt.forceUpdate(),ft(ot)})}),destroy:function(){st(),yt=!0}};if(!areValidElements(ut,s))return pt;pt.setOptions(tt).then(function(ft){!yt&&tt.onFirstUpdate&&tt.onFirstUpdate(ft)});function gt(){ot.orderedModifiers.forEach(function(ft){var at=ft.name,ht=ft.options,mt=ht===void 0?{}:ht,St=ft.effect;if(typeof St=="function"){var It=St({state:ot,name:at,instance:pt,options:mt}),xt=function(){};ct.push(It||xt)}})}function st(){ct.forEach(function(ft){return ft()}),ct=[]}return pt}}var defaultModifiers=[eventListeners,popperOffsets$1,computeStyles$1,applyStyles$1,offset$1,flip$1,preventOverflow$1,arrow$1,hide$1],createPopper=popperGenerator({defaultModifiers});function getContainer$1(a){return typeof a=="function"?a():a}const Portal=reactExports.forwardRef(function(o,_e){const{children:et,container:rt,disablePortal:lt=!1}=o,[it,ut]=reactExports.useState(null),s=useForkRef(reactExports.isValidElement(et)?et.ref:null,_e);if(useEnhancedEffect$1(()=>{lt||ut(getContainer$1(rt)||document.body)},[rt,lt]),useEnhancedEffect$1(()=>{if(it&&!lt)return setRef(_e,it),()=>{setRef(_e,null)}},[_e,it,lt]),lt){if(reactExports.isValidElement(et)){const tt={ref:s};return reactExports.cloneElement(et,tt)}return jsxRuntimeExports.jsx(reactExports.Fragment,{children:et})}return jsxRuntimeExports.jsx(reactExports.Fragment,{children:it&&reactDomExports.createPortal(et,it)})}),Portal$1=Portal;function getPopperUtilityClass(a){return generateUtilityClass("MuiPopper",a)}generateUtilityClasses("MuiPopper",["root"]);const _excluded$L=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],_excluded2$2=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function flipPlacement(a,o){if(o==="ltr")return a;switch(a){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return a}}function resolveAnchorEl$1(a){return typeof a=="function"?a():a}function isHTMLElement(a){return a.nodeType!==void 0}const useUtilityClasses$y=()=>composeClasses({root:["root"]},useClassNamesOverride(getPopperUtilityClass)),defaultPopperOptions={},PopperTooltip=reactExports.forwardRef(function(o,_e){var et;const{anchorEl:rt,children:lt,direction:it,disablePortal:ut,modifiers:s,open:tt,placement:ot,popperOptions:ct,popperRef:yt,slotProps:pt={},slots:gt={},TransitionProps:st}=o,ft=_objectWithoutPropertiesLoose(o,_excluded$L),at=reactExports.useRef(null),ht=useForkRef(at,_e),mt=reactExports.useRef(null),St=useForkRef(mt,yt),It=reactExports.useRef(St);useEnhancedEffect$1(()=>{It.current=St},[St]),reactExports.useImperativeHandle(yt,()=>mt.current,[]);const xt=flipPlacement(ot,it),[At,Nt]=reactExports.useState(xt),[kt,Mt]=reactExports.useState(resolveAnchorEl$1(rt));reactExports.useEffect(()=>{mt.current&&mt.current.forceUpdate()}),reactExports.useEffect(()=>{rt&&Mt(resolveAnchorEl$1(rt))},[rt]),useEnhancedEffect$1(()=>{if(!kt||!tt)return;const nn=Gt=>{Nt(Gt.placement)};let gn=[{name:"preventOverflow",options:{altBoundary:ut}},{name:"flip",options:{altBoundary:ut}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Gt})=>{nn(Gt)}}];s!=null&&(gn=gn.concat(s)),ct&&ct.modifiers!=null&&(gn=gn.concat(ct.modifiers));const tn=createPopper(kt,at.current,_extends({placement:xt},ct,{modifiers:gn}));return It.current(tn),()=>{tn.destroy(),It.current(null)}},[kt,ut,s,tt,ct,xt]);const bt={placement:At};st!==null&&(bt.TransitionProps=st);const Bt=useUtilityClasses$y(),Ht=(et=gt.root)!=null?et:"div",Wt=useSlotProps({elementType:Ht,externalSlotProps:pt.root,externalForwardedProps:ft,additionalProps:{role:"tooltip",ref:ht},ownerState:o,className:Bt.root});return jsxRuntimeExports.jsx(Ht,_extends({},Wt,{children:typeof lt=="function"?lt(bt):lt}))}),Popper$2=reactExports.forwardRef(function(o,_e){const{anchorEl:et,children:rt,container:lt,direction:it="ltr",disablePortal:ut=!1,keepMounted:s=!1,modifiers:tt,open:ot,placement:ct="bottom",popperOptions:yt=defaultPopperOptions,popperRef:pt,style:gt,transition:st=!1,slotProps:ft={},slots:at={}}=o,ht=_objectWithoutPropertiesLoose(o,_excluded2$2),[mt,St]=reactExports.useState(!0),It=()=>{St(!1)},xt=()=>{St(!0)};if(!s&&!ot&&(!st||mt))return null;let At;if(lt)At=lt;else if(et){const Mt=resolveAnchorEl$1(et);At=Mt&&isHTMLElement(Mt)?ownerDocument(Mt).body:ownerDocument(null).body}const Nt=!ot&&s&&(!st||mt)?"none":void 0,kt=st?{in:ot,onEnter:It,onExited:xt}:void 0;return jsxRuntimeExports.jsx(Portal$1,{disablePortal:ut,container:At,children:jsxRuntimeExports.jsx(PopperTooltip,_extends({anchorEl:et,direction:it,disablePortal:ut,modifiers:tt,ref:_e,open:st?!mt:ot,placement:ct,popperOptions:yt,popperRef:pt,slotProps:ft,slots:at},ht,{style:_extends({position:"fixed",top:0,left:0,display:Nt},gt),TransitionProps:kt,children:rt}))})}),BasePopper=Popper$2;function isOverflowing(a){const o=ownerDocument(a);return o.body===a?ownerWindow(a).innerWidth>o.documentElement.clientWidth:a.scrollHeight>a.clientHeight}function ariaHidden(a,o){o?a.setAttribute("aria-hidden","true"):a.removeAttribute("aria-hidden")}function getPaddingRight(a){return parseInt(ownerWindow(a).getComputedStyle(a).paddingRight,10)||0}function isAriaHiddenForbiddenOnElement(a){const _e=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(a.tagName)!==-1,et=a.tagName==="INPUT"&&a.getAttribute("type")==="hidden";return _e||et}function ariaHiddenSiblings(a,o,_e,et,rt){const lt=[o,_e,...et];[].forEach.call(a.children,it=>{const ut=lt.indexOf(it)===-1,s=!isAriaHiddenForbiddenOnElement(it);ut&&s&&ariaHidden(it,rt)})}function findIndexOf(a,o){let _e=-1;return a.some((et,rt)=>o(et)?(_e=rt,!0):!1),_e}function handleContainer(a,o){const _e=[],et=a.container;if(!o.disableScrollLock){if(isOverflowing(et)){const it=getScrollbarSize(ownerDocument(et));_e.push({value:et.style.paddingRight,property:"padding-right",el:et}),et.style.paddingRight=`${getPaddingRight(et)+it}px`;const ut=ownerDocument(et).querySelectorAll(".mui-fixed");[].forEach.call(ut,s=>{_e.push({value:s.style.paddingRight,property:"padding-right",el:s}),s.style.paddingRight=`${getPaddingRight(s)+it}px`})}let lt;if(et.parentNode instanceof DocumentFragment)lt=ownerDocument(et).body;else{const it=et.parentElement,ut=ownerWindow(et);lt=(it==null?void 0:it.nodeName)==="HTML"&&ut.getComputedStyle(it).overflowY==="scroll"?it:et}_e.push({value:lt.style.overflow,property:"overflow",el:lt},{value:lt.style.overflowX,property:"overflow-x",el:lt},{value:lt.style.overflowY,property:"overflow-y",el:lt}),lt.style.overflow="hidden"}return()=>{_e.forEach(({value:lt,el:it,property:ut})=>{lt?it.style.setProperty(ut,lt):it.style.removeProperty(ut)})}}function getHiddenSiblings(a){const o=[];return[].forEach.call(a.children,_e=>{_e.getAttribute("aria-hidden")==="true"&&o.push(_e)}),o}class ModalManager{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(o,_e){let et=this.modals.indexOf(o);if(et!==-1)return et;et=this.modals.length,this.modals.push(o),o.modalRef&&ariaHidden(o.modalRef,!1);const rt=getHiddenSiblings(_e);ariaHiddenSiblings(_e,o.mount,o.modalRef,rt,!0);const lt=findIndexOf(this.containers,it=>it.container===_e);return lt!==-1?(this.containers[lt].modals.push(o),et):(this.containers.push({modals:[o],container:_e,restore:null,hiddenSiblings:rt}),et)}mount(o,_e){const et=findIndexOf(this.containers,lt=>lt.modals.indexOf(o)!==-1),rt=this.containers[et];rt.restore||(rt.restore=handleContainer(rt,_e))}remove(o,_e=!0){const et=this.modals.indexOf(o);if(et===-1)return et;const rt=findIndexOf(this.containers,it=>it.modals.indexOf(o)!==-1),lt=this.containers[rt];if(lt.modals.splice(lt.modals.indexOf(o),1),this.modals.splice(et,1),lt.modals.length===0)lt.restore&&lt.restore(),o.modalRef&&ariaHidden(o.modalRef,_e),ariaHiddenSiblings(lt.container,o.mount,o.modalRef,lt.hiddenSiblings,!1),this.containers.splice(rt,1);else{const it=lt.modals[lt.modals.length-1];it.modalRef&&ariaHidden(it.modalRef,!1)}return et}isTopModal(o){return this.modals.length>0&&this.modals[this.modals.length-1]===o}}function getModalUtilityClass(a){return generateUtilityClass("MuiModal",a)}generateUtilityClasses("MuiModal",["root","hidden","backdrop"]);const _excluded$K=["children","closeAfterTransition","container","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onKeyDown","open","onTransitionEnter","onTransitionExited","slotProps","slots"],useUtilityClasses$x=a=>{const{open:o,exited:_e}=a;return composeClasses({root:["root",!o&&_e&&"hidden"],backdrop:["backdrop"]},useClassNamesOverride(getModalUtilityClass))};function getContainer(a){return typeof a=="function"?a():a}function getHasTransition(a){return a?a.props.hasOwnProperty("in"):!1}const defaultManager=new ModalManager,Modal$2=reactExports.forwardRef(function(o,_e){var et,rt;const{children:lt,closeAfterTransition:it=!1,container:ut,disableAutoFocus:s=!1,disableEnforceFocus:tt=!1,disableEscapeKeyDown:ot=!1,disablePortal:ct=!1,disableRestoreFocus:yt=!1,disableScrollLock:pt=!1,hideBackdrop:gt=!1,keepMounted:st=!1,manager:ft=defaultManager,onBackdropClick:at,onClose:ht,onKeyDown:mt,open:St,onTransitionEnter:It,onTransitionExited:xt,slotProps:At={},slots:Nt={}}=o,kt=_objectWithoutPropertiesLoose(o,_excluded$K),Mt=ft,[bt,Bt]=reactExports.useState(!St),Ht=reactExports.useRef({}),Wt=reactExports.useRef(null),nn=reactExports.useRef(null),gn=useForkRef(nn,_e),tn=getHasTransition(lt),Gt=(et=o["aria-hidden"])!=null?et:!0,fn=()=>ownerDocument(Wt.current),Cn=()=>(Ht.current.modalRef=nn.current,Ht.current.mountNode=Wt.current,Ht.current),Tn=()=>{Mt.mount(Cn(),{disableScrollLock:pt}),nn.current&&(nn.current.scrollTop=0)},dn=useEventCallback(()=>{const tr=getContainer(ut)||fn().body;Mt.add(Cn(),tr),nn.current&&Tn()}),mn=reactExports.useCallback(()=>Mt.isTopModal(Cn()),[Mt]),yn=useEventCallback(tr=>{Wt.current=tr,!(!tr||!nn.current)&&(St&&mn()?Tn():ariaHidden(nn.current,Gt))}),pn=reactExports.useCallback(()=>{Mt.remove(Cn(),Gt)},[Mt,Gt]);reactExports.useEffect(()=>()=>{pn()},[pn]),reactExports.useEffect(()=>{St?dn():(!tn||!it)&&pn()},[St,pn,tn,it,dn]);const In=_extends({},o,{closeAfterTransition:it,disableAutoFocus:s,disableEnforceFocus:tt,disableEscapeKeyDown:ot,disablePortal:ct,disableRestoreFocus:yt,disableScrollLock:pt,exited:bt,hideBackdrop:gt,keepMounted:st}),On=useUtilityClasses$x(In),_n=()=>{Bt(!1),It&&It()},Mn=()=>{Bt(!0),xt&&xt(),it&&pn()},Nn=tr=>{tr.target===tr.currentTarget&&(at&&at(tr),ht&&ht(tr,"backdropClick"))},wn=tr=>{mt&&mt(tr),!(tr.key!=="Escape"||!mn())&&(ot||(tr.stopPropagation(),ht&&ht(tr,"escapeKeyDown")))},Pn={};lt.props.tabIndex===void 0&&(Pn.tabIndex="-1"),tn&&(Pn.onEnter=createChainedFunction(_n,lt.props.onEnter),Pn.onExited=createChainedFunction(Mn,lt.props.onExited));const Fn=(rt=Nt.root)!=null?rt:"div",ar=useSlotProps({elementType:Fn,externalSlotProps:At.root,externalForwardedProps:kt,additionalProps:{ref:gn,role:"presentation",onKeyDown:wn},className:On.root,ownerState:In}),Yn=Nt.backdrop,Xn=useSlotProps({elementType:Yn,externalSlotProps:At.backdrop,additionalProps:{"aria-hidden":!0,onClick:Nn,open:St},className:On.backdrop,ownerState:In});return!st&&!St&&(!tn||bt)?null:jsxRuntimeExports.jsx(Portal$1,{ref:yn,container:ut,disablePortal:ct,children:jsxRuntimeExports.jsxs(Fn,_extends({},ar,{children:[!gt&&Yn?jsxRuntimeExports.jsx(Yn,_extends({},Xn)):null,jsxRuntimeExports.jsx(FocusTrap,{disableEnforceFocus:tt,disableAutoFocus:s,disableRestoreFocus:yt,isEnabled:mn,open:St,children:reactExports.cloneElement(lt,Pn)})]}))})}),ModalUnstyled=Modal$2,_excluded$J=["onChange","maxRows","minRows","style","value"];function getStyleValue(a){return parseInt(a,10)||0}const styles$2={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function isEmpty$1(a){return a==null||Object.keys(a).length===0||a.outerHeightStyle===0&&!a.overflow}const TextareaAutosize=reactExports.forwardRef(function(o,_e){const{onChange:et,maxRows:rt,minRows:lt=1,style:it,value:ut}=o,s=_objectWithoutPropertiesLoose(o,_excluded$J),{current:tt}=reactExports.useRef(ut!=null),ot=reactExports.useRef(null),ct=useForkRef(_e,ot),yt=reactExports.useRef(null),pt=reactExports.useRef(0),[gt,st]=reactExports.useState({outerHeightStyle:0}),ft=reactExports.useCallback(()=>{const It=ot.current,At=ownerWindow(It).getComputedStyle(It);if(At.width==="0px")return{outerHeightStyle:0};const Nt=yt.current;Nt.style.width=At.width,Nt.value=It.value||o.placeholder||"x",Nt.value.slice(-1)===`
`&&(Nt.value+=" ");const kt=At.boxSizing,Mt=getStyleValue(At.paddingBottom)+getStyleValue(At.paddingTop),bt=getStyleValue(At.borderBottomWidth)+getStyleValue(At.borderTopWidth),Bt=Nt.scrollHeight;Nt.value="x";const Ht=Nt.scrollHeight;let Wt=Bt;lt&&(Wt=Math.max(Number(lt)*Ht,Wt)),rt&&(Wt=Math.min(Number(rt)*Ht,Wt)),Wt=Math.max(Wt,Ht);const nn=Wt+(kt==="border-box"?Mt+bt:0),gn=Math.abs(Wt-Bt)<=1;return{outerHeightStyle:nn,overflow:gn}},[rt,lt,o.placeholder]),at=(It,xt)=>{const{outerHeightStyle:At,overflow:Nt}=xt;return pt.current<20&&(At>0&&Math.abs((It.outerHeightStyle||0)-At)>1||It.overflow!==Nt)?(pt.current+=1,{overflow:Nt,outerHeightStyle:At}):It},ht=reactExports.useCallback(()=>{const It=ft();isEmpty$1(It)||st(xt=>at(xt,It))},[ft]),mt=()=>{const It=ft();isEmpty$1(It)||reactDomExports.flushSync(()=>{st(xt=>at(xt,It))})};reactExports.useEffect(()=>{const It=debounce$1(()=>{pt.current=0,ot.current&&mt()});let xt;const At=ot.current,Nt=ownerWindow(At);return Nt.addEventListener("resize",It),typeof ResizeObserver<"u"&&(xt=new ResizeObserver(It),xt.observe(At)),()=>{It.clear(),Nt.removeEventListener("resize",It),xt&&xt.disconnect()}}),useEnhancedEffect$1(()=>{ht()}),reactExports.useEffect(()=>{pt.current=0},[ut]);const St=It=>{pt.current=0,tt||ht(),et&&et(It)};return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("textarea",_extends({value:ut,onChange:St,ref:ct,rows:lt,style:_extends({height:gt.outerHeightStyle,overflow:gt.overflow?"hidden":void 0},it)},s)),jsxRuntimeExports.jsx("textarea",{"aria-hidden":!0,className:o.className,readOnly:!0,ref:yt,tabIndex:-1,style:_extends({},styles$2.shadow,it,{padding:0})})]})}),TextareaAutosize$1=TextareaAutosize;function createMixins(a,o){return _extends({toolbar:{minHeight:56,[a.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[a.up("sm")]:{minHeight:64}}},o)}const common={black:"#000",white:"#fff"},common$1=common,grey={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},grey$1=grey,purple={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},purple$1=purple,red={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},red$1=red,orange={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},orange$1=orange,blue={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},blue$1=blue,lightBlue={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},lightBlue$1=lightBlue,green={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},green$1=green,_excluded$I=["mode","contrastThreshold","tonalOffset"],light={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:common$1.white,default:common$1.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},dark={text:{primary:common$1.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:common$1.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function addLightOrDark(a,o,_e,et){const rt=et.light||et,lt=et.dark||et*1.5;a[o]||(a.hasOwnProperty(_e)?a[o]=a[_e]:o==="light"?a.light=lighten(a.main,rt):o==="dark"&&(a.dark=darken(a.main,lt)))}function getDefaultPrimary(a="light"){return a==="dark"?{main:blue$1[200],light:blue$1[50],dark:blue$1[400]}:{main:blue$1[700],light:blue$1[400],dark:blue$1[800]}}function getDefaultSecondary(a="light"){return a==="dark"?{main:purple$1[200],light:purple$1[50],dark:purple$1[400]}:{main:purple$1[500],light:purple$1[300],dark:purple$1[700]}}function getDefaultError(a="light"){return a==="dark"?{main:red$1[500],light:red$1[300],dark:red$1[700]}:{main:red$1[700],light:red$1[400],dark:red$1[800]}}function getDefaultInfo(a="light"){return a==="dark"?{main:lightBlue$1[400],light:lightBlue$1[300],dark:lightBlue$1[700]}:{main:lightBlue$1[700],light:lightBlue$1[500],dark:lightBlue$1[900]}}function getDefaultSuccess(a="light"){return a==="dark"?{main:green$1[400],light:green$1[300],dark:green$1[700]}:{main:green$1[800],light:green$1[500],dark:green$1[900]}}function getDefaultWarning(a="light"){return a==="dark"?{main:orange$1[400],light:orange$1[300],dark:orange$1[700]}:{main:"#ed6c02",light:orange$1[500],dark:orange$1[900]}}function createPalette(a){const{mode:o="light",contrastThreshold:_e=3,tonalOffset:et=.2}=a,rt=_objectWithoutPropertiesLoose(a,_excluded$I),lt=a.primary||getDefaultPrimary(o),it=a.secondary||getDefaultSecondary(o),ut=a.error||getDefaultError(o),s=a.info||getDefaultInfo(o),tt=a.success||getDefaultSuccess(o),ot=a.warning||getDefaultWarning(o);function ct(st){return getContrastRatio(st,dark.text.primary)>=_e?dark.text.primary:light.text.primary}const yt=({color:st,name:ft,mainShade:at=500,lightShade:ht=300,darkShade:mt=700})=>{if(st=_extends({},st),!st.main&&st[at]&&(st.main=st[at]),!st.hasOwnProperty("main"))throw new Error(formatMuiErrorMessage(11,ft?` (${ft})`:"",at));if(typeof st.main!="string")throw new Error(formatMuiErrorMessage(12,ft?` (${ft})`:"",JSON.stringify(st.main)));return addLightOrDark(st,"light",ht,et),addLightOrDark(st,"dark",mt,et),st.contrastText||(st.contrastText=ct(st.main)),st},pt={dark,light};return deepmerge(_extends({common:_extends({},common$1),mode:o,primary:yt({color:lt,name:"primary"}),secondary:yt({color:it,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:yt({color:ut,name:"error"}),warning:yt({color:ot,name:"warning"}),info:yt({color:s,name:"info"}),success:yt({color:tt,name:"success"}),grey:grey$1,contrastThreshold:_e,getContrastText:ct,augmentColor:yt,tonalOffset:et},pt[o]),rt)}const _excluded$H=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function round$1(a){return Math.round(a*1e5)/1e5}const caseAllCaps={textTransform:"uppercase"},defaultFontFamily='"Roboto", "Helvetica", "Arial", sans-serif';function createTypography(a,o){const _e=typeof o=="function"?o(a):o,{fontFamily:et=defaultFontFamily,fontSize:rt=14,fontWeightLight:lt=300,fontWeightRegular:it=400,fontWeightMedium:ut=500,fontWeightBold:s=700,htmlFontSize:tt=16,allVariants:ot,pxToRem:ct}=_e,yt=_objectWithoutPropertiesLoose(_e,_excluded$H),pt=rt/14,gt=ct||(at=>`${at/tt*pt}rem`),st=(at,ht,mt,St,It)=>_extends({fontFamily:et,fontWeight:at,fontSize:gt(ht),lineHeight:mt},et===defaultFontFamily?{letterSpacing:`${round$1(St/ht)}em`}:{},It,ot),ft={h1:st(lt,96,1.167,-1.5),h2:st(lt,60,1.2,-.5),h3:st(it,48,1.167,0),h4:st(it,34,1.235,.25),h5:st(it,24,1.334,0),h6:st(ut,20,1.6,.15),subtitle1:st(it,16,1.75,.15),subtitle2:st(ut,14,1.57,.1),body1:st(it,16,1.5,.15),body2:st(it,14,1.43,.15),button:st(ut,14,1.75,.4,caseAllCaps),caption:st(it,12,1.66,.4),overline:st(it,12,2.66,1,caseAllCaps),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return deepmerge(_extends({htmlFontSize:tt,pxToRem:gt,fontFamily:et,fontSize:rt,fontWeightLight:lt,fontWeightRegular:it,fontWeightMedium:ut,fontWeightBold:s},ft),yt,{clone:!1})}const shadowKeyUmbraOpacity=.2,shadowKeyPenumbraOpacity=.14,shadowAmbientShadowOpacity=.12;function createShadow(...a){return[`${a[0]}px ${a[1]}px ${a[2]}px ${a[3]}px rgba(0,0,0,${shadowKeyUmbraOpacity})`,`${a[4]}px ${a[5]}px ${a[6]}px ${a[7]}px rgba(0,0,0,${shadowKeyPenumbraOpacity})`,`${a[8]}px ${a[9]}px ${a[10]}px ${a[11]}px rgba(0,0,0,${shadowAmbientShadowOpacity})`].join(",")}const shadows=["none",createShadow(0,2,1,-1,0,1,1,0,0,1,3,0),createShadow(0,3,1,-2,0,2,2,0,0,1,5,0),createShadow(0,3,3,-2,0,3,4,0,0,1,8,0),createShadow(0,2,4,-1,0,4,5,0,0,1,10,0),createShadow(0,3,5,-1,0,5,8,0,0,1,14,0),createShadow(0,3,5,-1,0,6,10,0,0,1,18,0),createShadow(0,4,5,-2,0,7,10,1,0,2,16,1),createShadow(0,5,5,-3,0,8,10,1,0,3,14,2),createShadow(0,5,6,-3,0,9,12,1,0,3,16,2),createShadow(0,6,6,-3,0,10,14,1,0,4,18,3),createShadow(0,6,7,-4,0,11,15,1,0,4,20,3),createShadow(0,7,8,-4,0,12,17,2,0,5,22,4),createShadow(0,7,8,-4,0,13,19,2,0,5,24,4),createShadow(0,7,9,-4,0,14,21,2,0,5,26,4),createShadow(0,8,9,-5,0,15,22,2,0,6,28,5),createShadow(0,8,10,-5,0,16,24,2,0,6,30,5),createShadow(0,8,11,-5,0,17,26,2,0,6,32,5),createShadow(0,9,11,-5,0,18,28,2,0,7,34,6),createShadow(0,9,12,-6,0,19,29,2,0,7,36,6),createShadow(0,10,13,-6,0,20,31,3,0,8,38,7),createShadow(0,10,13,-6,0,21,33,3,0,8,40,7),createShadow(0,10,14,-6,0,22,35,3,0,8,42,7),createShadow(0,11,14,-7,0,23,36,3,0,9,44,8),createShadow(0,11,15,-7,0,24,38,3,0,9,46,8)],shadows$1=shadows,_excluded$G=["duration","easing","delay"],easing={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},duration={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function formatMs(a){return`${Math.round(a)}ms`}function getAutoHeightDuration(a){if(!a)return 0;const o=a/36;return Math.round((4+15*o**.25+o/5)*10)}function createTransitions(a){const o=_extends({},easing,a.easing),_e=_extends({},duration,a.duration);return _extends({getAutoHeightDuration,create:(rt=["all"],lt={})=>{const{duration:it=_e.standard,easing:ut=o.easeInOut,delay:s=0}=lt;return _objectWithoutPropertiesLoose(lt,_excluded$G),(Array.isArray(rt)?rt:[rt]).map(tt=>`${tt} ${typeof it=="string"?it:formatMs(it)} ${ut} ${typeof s=="string"?s:formatMs(s)}`).join(",")}},a,{easing:o,duration:_e})}const zIndex={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},zIndex$1=zIndex,_excluded$F=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function createTheme(a={},...o){const{mixins:_e={},palette:et={},transitions:rt={},typography:lt={}}=a,it=_objectWithoutPropertiesLoose(a,_excluded$F);if(a.vars)throw new Error(formatMuiErrorMessage(18));const ut=createPalette(et),s=createTheme$1(a);let tt=deepmerge(s,{mixins:createMixins(s.breakpoints,_e),palette:ut,shadows:shadows$1.slice(),typography:createTypography(ut,lt),transitions:createTransitions(rt),zIndex:_extends({},zIndex$1)});return tt=deepmerge(tt,it),tt=o.reduce((ot,ct)=>deepmerge(ot,ct),tt),tt.unstable_sxConfig=_extends({},defaultSxConfig$1,it==null?void 0:it.unstable_sxConfig),tt.unstable_sx=function(ct){return styleFunctionSx$1({sx:ct,theme:this})},tt}const defaultTheme$1=createTheme(),defaultTheme$2=defaultTheme$1,THEME_ID="$$material",rootShouldForwardProp=a=>shouldForwardProp(a)&&a!=="classes",slotShouldForwardProp=shouldForwardProp,styled=createStyled({themeId:THEME_ID,defaultTheme:defaultTheme$2,rootShouldForwardProp}),styled$1=styled;function useThemeProps({props:a,name:o}){return useThemeProps$1({props:a,name:o,defaultTheme:defaultTheme$2,themeId:THEME_ID})}function useTheme(){const a=useTheme$2(defaultTheme$2);return a[THEME_ID]||a}const GridContext=reactExports.createContext(),GridContext$1=GridContext;function getGridUtilityClass(a){return generateUtilityClass("MuiGrid",a)}const SPACINGS=[0,1,2,3,4,5,6,7,8,9,10],DIRECTIONS=["column-reverse","column","row-reverse","row"],WRAPS=["nowrap","wrap-reverse","wrap"],GRID_SIZES=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],gridClasses=generateUtilityClasses("MuiGrid",["root","container","item","zeroMinWidth",...SPACINGS.map(a=>`spacing-xs-${a}`),...DIRECTIONS.map(a=>`direction-xs-${a}`),...WRAPS.map(a=>`wrap-xs-${a}`),...GRID_SIZES.map(a=>`grid-xs-${a}`),...GRID_SIZES.map(a=>`grid-sm-${a}`),...GRID_SIZES.map(a=>`grid-md-${a}`),...GRID_SIZES.map(a=>`grid-lg-${a}`),...GRID_SIZES.map(a=>`grid-xl-${a}`)]),gridClasses$1=gridClasses,_excluded$E=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function getOffset(a){const o=parseFloat(a);return`${o}${String(a).replace(String(o),"")||"px"}`}function generateGrid({theme:a,ownerState:o}){let _e;return a.breakpoints.keys.reduce((et,rt)=>{let lt={};if(o[rt]&&(_e=o[rt]),!_e)return et;if(_e===!0)lt={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(_e==="auto")lt={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const it=resolveBreakpointValues({values:o.columns,breakpoints:a.breakpoints.values}),ut=typeof it=="object"?it[rt]:it;if(ut==null)return et;const s=`${Math.round(_e/ut*1e8)/1e6}%`;let tt={};if(o.container&&o.item&&o.columnSpacing!==0){const ot=a.spacing(o.columnSpacing);if(ot!=="0px"){const ct=`calc(${s} + ${getOffset(ot)})`;tt={flexBasis:ct,maxWidth:ct}}}lt=_extends({flexBasis:s,flexGrow:0,maxWidth:s},tt)}return a.breakpoints.values[rt]===0?Object.assign(et,lt):et[a.breakpoints.up(rt)]=lt,et},{})}function generateDirection({theme:a,ownerState:o}){const _e=resolveBreakpointValues({values:o.direction,breakpoints:a.breakpoints.values});return handleBreakpoints({theme:a},_e,et=>{const rt={flexDirection:et};return et.indexOf("column")===0&&(rt[`& > .${gridClasses$1.item}`]={maxWidth:"none"}),rt})}function extractZeroValueBreakpointKeys({breakpoints:a,values:o}){let _e="";Object.keys(o).forEach(rt=>{_e===""&&o[rt]!==0&&(_e=rt)});const et=Object.keys(a).sort((rt,lt)=>a[rt]-a[lt]);return et.slice(0,et.indexOf(_e))}function generateRowGap({theme:a,ownerState:o}){const{container:_e,rowSpacing:et}=o;let rt={};if(_e&&et!==0){const lt=resolveBreakpointValues({values:et,breakpoints:a.breakpoints.values});let it;typeof lt=="object"&&(it=extractZeroValueBreakpointKeys({breakpoints:a.breakpoints.values,values:lt})),rt=handleBreakpoints({theme:a},lt,(ut,s)=>{var tt;const ot=a.spacing(ut);return ot!=="0px"?{marginTop:`-${getOffset(ot)}`,[`& > .${gridClasses$1.item}`]:{paddingTop:getOffset(ot)}}:(tt=it)!=null&&tt.includes(s)?{}:{marginTop:0,[`& > .${gridClasses$1.item}`]:{paddingTop:0}}})}return rt}function generateColumnGap({theme:a,ownerState:o}){const{container:_e,columnSpacing:et}=o;let rt={};if(_e&&et!==0){const lt=resolveBreakpointValues({values:et,breakpoints:a.breakpoints.values});let it;typeof lt=="object"&&(it=extractZeroValueBreakpointKeys({breakpoints:a.breakpoints.values,values:lt})),rt=handleBreakpoints({theme:a},lt,(ut,s)=>{var tt;const ot=a.spacing(ut);return ot!=="0px"?{width:`calc(100% + ${getOffset(ot)})`,marginLeft:`-${getOffset(ot)}`,[`& > .${gridClasses$1.item}`]:{paddingLeft:getOffset(ot)}}:(tt=it)!=null&&tt.includes(s)?{}:{width:"100%",marginLeft:0,[`& > .${gridClasses$1.item}`]:{paddingLeft:0}}})}return rt}function resolveSpacingStyles(a,o,_e={}){if(!a||a<=0)return[];if(typeof a=="string"&&!Number.isNaN(Number(a))||typeof a=="number")return[_e[`spacing-xs-${String(a)}`]];const et=[];return o.forEach(rt=>{const lt=a[rt];Number(lt)>0&&et.push(_e[`spacing-${rt}-${String(lt)}`])}),et}const GridRoot=styled$1("div",{name:"MuiGrid",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a,{container:et,direction:rt,item:lt,spacing:it,wrap:ut,zeroMinWidth:s,breakpoints:tt}=_e;let ot=[];et&&(ot=resolveSpacingStyles(it,tt,o));const ct=[];return tt.forEach(yt=>{const pt=_e[yt];pt&&ct.push(o[`grid-${yt}-${String(pt)}`])}),[o.root,et&&o.container,lt&&o.item,s&&o.zeroMinWidth,...ot,rt!=="row"&&o[`direction-xs-${String(rt)}`],ut!=="wrap"&&o[`wrap-xs-${String(ut)}`],...ct]}})(({ownerState:a})=>_extends({boxSizing:"border-box"},a.container&&{display:"flex",flexWrap:"wrap",width:"100%"},a.item&&{margin:0},a.zeroMinWidth&&{minWidth:0},a.wrap!=="wrap"&&{flexWrap:a.wrap}),generateDirection,generateRowGap,generateColumnGap,generateGrid);function resolveSpacingClasses(a,o){if(!a||a<=0)return[];if(typeof a=="string"&&!Number.isNaN(Number(a))||typeof a=="number")return[`spacing-xs-${String(a)}`];const _e=[];return o.forEach(et=>{const rt=a[et];if(Number(rt)>0){const lt=`spacing-${et}-${String(rt)}`;_e.push(lt)}}),_e}const useUtilityClasses$w=a=>{const{classes:o,container:_e,direction:et,item:rt,spacing:lt,wrap:it,zeroMinWidth:ut,breakpoints:s}=a;let tt=[];_e&&(tt=resolveSpacingClasses(lt,s));const ot=[];s.forEach(yt=>{const pt=a[yt];pt&&ot.push(`grid-${yt}-${String(pt)}`)});const ct={root:["root",_e&&"container",rt&&"item",ut&&"zeroMinWidth",...tt,et!=="row"&&`direction-xs-${String(et)}`,it!=="wrap"&&`wrap-xs-${String(it)}`,...ot]};return composeClasses(ct,getGridUtilityClass,o)},Grid=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiGrid"}),{breakpoints:rt}=useTheme(),lt=extendSxProp(et),{className:it,columns:ut,columnSpacing:s,component:tt="div",container:ot=!1,direction:ct="row",item:yt=!1,rowSpacing:pt,spacing:gt=0,wrap:st="wrap",zeroMinWidth:ft=!1}=lt,at=_objectWithoutPropertiesLoose(lt,_excluded$E),ht=pt||gt,mt=s||gt,St=reactExports.useContext(GridContext$1),It=ot?ut||12:St,xt={},At=_extends({},at);rt.keys.forEach(Mt=>{at[Mt]!=null&&(xt[Mt]=at[Mt],delete At[Mt])});const Nt=_extends({},lt,{columns:It,container:ot,direction:ct,item:yt,rowSpacing:ht,columnSpacing:mt,wrap:st,zeroMinWidth:ft,spacing:gt},xt,{breakpoints:rt.keys}),kt=useUtilityClasses$w(Nt);return jsxRuntimeExports.jsx(GridContext$1.Provider,{value:It,children:jsxRuntimeExports.jsx(GridRoot,_extends({ownerState:Nt,className:clsx(kt.root,it),as:tt,ref:_e},At))})}),u=Grid,ListContext=reactExports.createContext({}),ListContext$1=ListContext;function _setPrototypeOf(a,o){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(et,rt){return et.__proto__=rt,et},_setPrototypeOf(a,o)}function _inheritsLoose(a,o){a.prototype=Object.create(o.prototype),a.prototype.constructor=a,_setPrototypeOf(a,o)}const config={disabled:!1},TransitionGroupContext=React$1.createContext(null);var forceReflow=function(o){return o.scrollTop},UNMOUNTED="unmounted",EXITED="exited",ENTERING="entering",ENTERED="entered",EXITING="exiting",Transition=function(a){_inheritsLoose(o,a);function o(et,rt){var lt;lt=a.call(this,et,rt)||this;var it=rt,ut=it&&!it.isMounting?et.enter:et.appear,s;return lt.appearStatus=null,et.in?ut?(s=EXITED,lt.appearStatus=ENTERING):s=ENTERED:et.unmountOnExit||et.mountOnEnter?s=UNMOUNTED:s=EXITED,lt.state={status:s},lt.nextCallback=null,lt}o.getDerivedStateFromProps=function(rt,lt){var it=rt.in;return it&&lt.status===UNMOUNTED?{status:EXITED}:null};var _e=o.prototype;return _e.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},_e.componentDidUpdate=function(rt){var lt=null;if(rt!==this.props){var it=this.state.status;this.props.in?it!==ENTERING&&it!==ENTERED&&(lt=ENTERING):(it===ENTERING||it===ENTERED)&&(lt=EXITING)}this.updateStatus(!1,lt)},_e.componentWillUnmount=function(){this.cancelNextCallback()},_e.getTimeouts=function(){var rt=this.props.timeout,lt,it,ut;return lt=it=ut=rt,rt!=null&&typeof rt!="number"&&(lt=rt.exit,it=rt.enter,ut=rt.appear!==void 0?rt.appear:it),{exit:lt,enter:it,appear:ut}},_e.updateStatus=function(rt,lt){if(rt===void 0&&(rt=!1),lt!==null)if(this.cancelNextCallback(),lt===ENTERING){if(this.props.unmountOnExit||this.props.mountOnEnter){var it=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this);it&&forceReflow(it)}this.performEnter(rt)}else this.performExit();else this.props.unmountOnExit&&this.state.status===EXITED&&this.setState({status:UNMOUNTED})},_e.performEnter=function(rt){var lt=this,it=this.props.enter,ut=this.context?this.context.isMounting:rt,s=this.props.nodeRef?[ut]:[ReactDOM.findDOMNode(this),ut],tt=s[0],ot=s[1],ct=this.getTimeouts(),yt=ut?ct.appear:ct.enter;if(!rt&&!it||config.disabled){this.safeSetState({status:ENTERED},function(){lt.props.onEntered(tt)});return}this.props.onEnter(tt,ot),this.safeSetState({status:ENTERING},function(){lt.props.onEntering(tt,ot),lt.onTransitionEnd(yt,function(){lt.safeSetState({status:ENTERED},function(){lt.props.onEntered(tt,ot)})})})},_e.performExit=function(){var rt=this,lt=this.props.exit,it=this.getTimeouts(),ut=this.props.nodeRef?void 0:ReactDOM.findDOMNode(this);if(!lt||config.disabled){this.safeSetState({status:EXITED},function(){rt.props.onExited(ut)});return}this.props.onExit(ut),this.safeSetState({status:EXITING},function(){rt.props.onExiting(ut),rt.onTransitionEnd(it.exit,function(){rt.safeSetState({status:EXITED},function(){rt.props.onExited(ut)})})})},_e.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},_e.safeSetState=function(rt,lt){lt=this.setNextCallback(lt),this.setState(rt,lt)},_e.setNextCallback=function(rt){var lt=this,it=!0;return this.nextCallback=function(ut){it&&(it=!1,lt.nextCallback=null,rt(ut))},this.nextCallback.cancel=function(){it=!1},this.nextCallback},_e.onTransitionEnd=function(rt,lt){this.setNextCallback(lt);var it=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this),ut=rt==null&&!this.props.addEndListener;if(!it||ut){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var s=this.props.nodeRef?[this.nextCallback]:[it,this.nextCallback],tt=s[0],ot=s[1];this.props.addEndListener(tt,ot)}rt!=null&&setTimeout(this.nextCallback,rt)},_e.render=function(){var rt=this.state.status;if(rt===UNMOUNTED)return null;var lt=this.props,it=lt.children;lt.in,lt.mountOnEnter,lt.unmountOnExit,lt.appear,lt.enter,lt.exit,lt.timeout,lt.addEndListener,lt.onEnter,lt.onEntering,lt.onEntered,lt.onExit,lt.onExiting,lt.onExited,lt.nodeRef;var ut=_objectWithoutPropertiesLoose(lt,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return React$1.createElement(TransitionGroupContext.Provider,{value:null},typeof it=="function"?it(rt,ut):React$1.cloneElement(React$1.Children.only(it),ut))},o}(React$1.Component);Transition.contextType=TransitionGroupContext;Transition.propTypes={};function noop(){}Transition.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:noop,onEntering:noop,onEntered:noop,onExit:noop,onExiting:noop,onExited:noop};Transition.UNMOUNTED=UNMOUNTED;Transition.EXITED=EXITED;Transition.ENTERING=ENTERING;Transition.ENTERED=ENTERED;Transition.EXITING=EXITING;const Transition$1=Transition;function _assertThisInitialized(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function getChildMapping(a,o){var _e=function(lt){return o&&reactExports.isValidElement(lt)?o(lt):lt},et=Object.create(null);return a&&reactExports.Children.map(a,function(rt){return rt}).forEach(function(rt){et[rt.key]=_e(rt)}),et}function mergeChildMappings(a,o){a=a||{},o=o||{};function _e(ot){return ot in o?o[ot]:a[ot]}var et=Object.create(null),rt=[];for(var lt in a)lt in o?rt.length&&(et[lt]=rt,rt=[]):rt.push(lt);var it,ut={};for(var s in o){if(et[s])for(it=0;it<et[s].length;it++){var tt=et[s][it];ut[et[s][it]]=_e(tt)}ut[s]=_e(s)}for(it=0;it<rt.length;it++)ut[rt[it]]=_e(rt[it]);return ut}function getProp(a,o,_e){return _e[o]!=null?_e[o]:a.props[o]}function getInitialChildMapping(a,o){return getChildMapping(a.children,function(_e){return reactExports.cloneElement(_e,{onExited:o.bind(null,_e),in:!0,appear:getProp(_e,"appear",a),enter:getProp(_e,"enter",a),exit:getProp(_e,"exit",a)})})}function getNextChildMapping(a,o,_e){var et=getChildMapping(a.children),rt=mergeChildMappings(o,et);return Object.keys(rt).forEach(function(lt){var it=rt[lt];if(reactExports.isValidElement(it)){var ut=lt in o,s=lt in et,tt=o[lt],ot=reactExports.isValidElement(tt)&&!tt.props.in;s&&(!ut||ot)?rt[lt]=reactExports.cloneElement(it,{onExited:_e.bind(null,it),in:!0,exit:getProp(it,"exit",a),enter:getProp(it,"enter",a)}):!s&&ut&&!ot?rt[lt]=reactExports.cloneElement(it,{in:!1}):s&&ut&&reactExports.isValidElement(tt)&&(rt[lt]=reactExports.cloneElement(it,{onExited:_e.bind(null,it),in:tt.props.in,exit:getProp(it,"exit",a),enter:getProp(it,"enter",a)}))}}),rt}var values=Object.values||function(a){return Object.keys(a).map(function(o){return a[o]})},defaultProps={component:"div",childFactory:function(o){return o}},TransitionGroup=function(a){_inheritsLoose(o,a);function o(et,rt){var lt;lt=a.call(this,et,rt)||this;var it=lt.handleExited.bind(_assertThisInitialized(lt));return lt.state={contextValue:{isMounting:!0},handleExited:it,firstRender:!0},lt}var _e=o.prototype;return _e.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},_e.componentWillUnmount=function(){this.mounted=!1},o.getDerivedStateFromProps=function(rt,lt){var it=lt.children,ut=lt.handleExited,s=lt.firstRender;return{children:s?getInitialChildMapping(rt,ut):getNextChildMapping(rt,it,ut),firstRender:!1}},_e.handleExited=function(rt,lt){var it=getChildMapping(this.props.children);rt.key in it||(rt.props.onExited&&rt.props.onExited(lt),this.mounted&&this.setState(function(ut){var s=_extends({},ut.children);return delete s[rt.key],{children:s}}))},_e.render=function(){var rt=this.props,lt=rt.component,it=rt.childFactory,ut=_objectWithoutPropertiesLoose(rt,["component","childFactory"]),s=this.state.contextValue,tt=values(this.state.children).map(it);return delete ut.appear,delete ut.enter,delete ut.exit,lt===null?React$1.createElement(TransitionGroupContext.Provider,{value:s},tt):React$1.createElement(TransitionGroupContext.Provider,{value:s},React$1.createElement(lt,ut,tt))},o}(React$1.Component);TransitionGroup.propTypes={};TransitionGroup.defaultProps=defaultProps;const TransitionGroup$1=TransitionGroup;function Ripple(a){const{className:o,classes:_e,pulsate:et=!1,rippleX:rt,rippleY:lt,rippleSize:it,in:ut,onExited:s,timeout:tt}=a,[ot,ct]=reactExports.useState(!1),yt=clsx(o,_e.ripple,_e.rippleVisible,et&&_e.ripplePulsate),pt={width:it,height:it,top:-(it/2)+lt,left:-(it/2)+rt},gt=clsx(_e.child,ot&&_e.childLeaving,et&&_e.childPulsate);return!ut&&!ot&&ct(!0),reactExports.useEffect(()=>{if(!ut&&s!=null){const st=setTimeout(s,tt);return()=>{clearTimeout(st)}}},[s,ut,tt]),jsxRuntimeExports.jsx("span",{className:yt,style:pt,children:jsxRuntimeExports.jsx("span",{className:gt})})}const touchRippleClasses=generateUtilityClasses("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),touchRippleClasses$1=touchRippleClasses,_excluded$D=["center","classes","className"];let _$3=a=>a,_t$2,_t2$2,_t3$2,_t4$2;const DURATION=550,DELAY_RIPPLE=80,enterKeyframe=keyframes(_t$2||(_t$2=_$3`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),exitKeyframe=keyframes(_t2$2||(_t2$2=_$3`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),pulsateKeyframe=keyframes(_t3$2||(_t3$2=_$3`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),TouchRippleRoot=styled$1("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),TouchRippleRipple=styled$1(Ripple,{name:"MuiTouchRipple",slot:"Ripple"})(_t4$2||(_t4$2=_$3`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),touchRippleClasses$1.rippleVisible,enterKeyframe,DURATION,({theme:a})=>a.transitions.easing.easeInOut,touchRippleClasses$1.ripplePulsate,({theme:a})=>a.transitions.duration.shorter,touchRippleClasses$1.child,touchRippleClasses$1.childLeaving,exitKeyframe,DURATION,({theme:a})=>a.transitions.easing.easeInOut,touchRippleClasses$1.childPulsate,pulsateKeyframe,({theme:a})=>a.transitions.easing.easeInOut),TouchRipple=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiTouchRipple"}),{center:rt=!1,classes:lt={},className:it}=et,ut=_objectWithoutPropertiesLoose(et,_excluded$D),[s,tt]=reactExports.useState([]),ot=reactExports.useRef(0),ct=reactExports.useRef(null);reactExports.useEffect(()=>{ct.current&&(ct.current(),ct.current=null)},[s]);const yt=reactExports.useRef(!1),pt=reactExports.useRef(null),gt=reactExports.useRef(null),st=reactExports.useRef(null);reactExports.useEffect(()=>()=>{clearTimeout(pt.current)},[]);const ft=reactExports.useCallback(St=>{const{pulsate:It,rippleX:xt,rippleY:At,rippleSize:Nt,cb:kt}=St;tt(Mt=>[...Mt,jsxRuntimeExports.jsx(TouchRippleRipple,{classes:{ripple:clsx(lt.ripple,touchRippleClasses$1.ripple),rippleVisible:clsx(lt.rippleVisible,touchRippleClasses$1.rippleVisible),ripplePulsate:clsx(lt.ripplePulsate,touchRippleClasses$1.ripplePulsate),child:clsx(lt.child,touchRippleClasses$1.child),childLeaving:clsx(lt.childLeaving,touchRippleClasses$1.childLeaving),childPulsate:clsx(lt.childPulsate,touchRippleClasses$1.childPulsate)},timeout:DURATION,pulsate:It,rippleX:xt,rippleY:At,rippleSize:Nt},ot.current)]),ot.current+=1,ct.current=kt},[lt]),at=reactExports.useCallback((St={},It={},xt=()=>{})=>{const{pulsate:At=!1,center:Nt=rt||It.pulsate,fakeElement:kt=!1}=It;if((St==null?void 0:St.type)==="mousedown"&&yt.current){yt.current=!1;return}(St==null?void 0:St.type)==="touchstart"&&(yt.current=!0);const Mt=kt?null:st.current,bt=Mt?Mt.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Bt,Ht,Wt;if(Nt||St===void 0||St.clientX===0&&St.clientY===0||!St.clientX&&!St.touches)Bt=Math.round(bt.width/2),Ht=Math.round(bt.height/2);else{const{clientX:nn,clientY:gn}=St.touches&&St.touches.length>0?St.touches[0]:St;Bt=Math.round(nn-bt.left),Ht=Math.round(gn-bt.top)}if(Nt)Wt=Math.sqrt((2*bt.width**2+bt.height**2)/3),Wt%2===0&&(Wt+=1);else{const nn=Math.max(Math.abs((Mt?Mt.clientWidth:0)-Bt),Bt)*2+2,gn=Math.max(Math.abs((Mt?Mt.clientHeight:0)-Ht),Ht)*2+2;Wt=Math.sqrt(nn**2+gn**2)}St!=null&&St.touches?gt.current===null&&(gt.current=()=>{ft({pulsate:At,rippleX:Bt,rippleY:Ht,rippleSize:Wt,cb:xt})},pt.current=setTimeout(()=>{gt.current&&(gt.current(),gt.current=null)},DELAY_RIPPLE)):ft({pulsate:At,rippleX:Bt,rippleY:Ht,rippleSize:Wt,cb:xt})},[rt,ft]),ht=reactExports.useCallback(()=>{at({},{pulsate:!0})},[at]),mt=reactExports.useCallback((St,It)=>{if(clearTimeout(pt.current),(St==null?void 0:St.type)==="touchend"&&gt.current){gt.current(),gt.current=null,pt.current=setTimeout(()=>{mt(St,It)});return}gt.current=null,tt(xt=>xt.length>0?xt.slice(1):xt),ct.current=It},[]);return reactExports.useImperativeHandle(_e,()=>({pulsate:ht,start:at,stop:mt}),[ht,at,mt]),jsxRuntimeExports.jsx(TouchRippleRoot,_extends({className:clsx(touchRippleClasses$1.root,lt.root,it),ref:st},ut,{children:jsxRuntimeExports.jsx(TransitionGroup$1,{component:null,exit:!0,children:s})}))}),TouchRipple$1=TouchRipple;function getButtonBaseUtilityClass(a){return generateUtilityClass("MuiButtonBase",a)}const buttonBaseClasses=generateUtilityClasses("MuiButtonBase",["root","disabled","focusVisible"]),buttonBaseClasses$1=buttonBaseClasses,_excluded$C=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],useUtilityClasses$v=a=>{const{disabled:o,focusVisible:_e,focusVisibleClassName:et,classes:rt}=a,it=composeClasses({root:["root",o&&"disabled",_e&&"focusVisible"]},getButtonBaseUtilityClass,rt);return _e&&et&&(it.root+=` ${et}`),it},ButtonBaseRoot=styled$1("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(a,o)=>o.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${buttonBaseClasses$1.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),ButtonBase=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiButtonBase"}),{action:rt,centerRipple:lt=!1,children:it,className:ut,component:s="button",disabled:tt=!1,disableRipple:ot=!1,disableTouchRipple:ct=!1,focusRipple:yt=!1,LinkComponent:pt="a",onBlur:gt,onClick:st,onContextMenu:ft,onDragLeave:at,onFocus:ht,onFocusVisible:mt,onKeyDown:St,onKeyUp:It,onMouseDown:xt,onMouseLeave:At,onMouseUp:Nt,onTouchEnd:kt,onTouchMove:Mt,onTouchStart:bt,tabIndex:Bt=0,TouchRippleProps:Ht,touchRippleRef:Wt,type:nn}=et,gn=_objectWithoutPropertiesLoose(et,_excluded$C),tn=reactExports.useRef(null),Gt=reactExports.useRef(null),fn=useForkRef(Gt,Wt),{isFocusVisibleRef:Cn,onFocus:Tn,onBlur:dn,ref:mn}=useIsFocusVisible(),[yn,pn]=reactExports.useState(!1);tt&&yn&&pn(!1),reactExports.useImperativeHandle(rt,()=>({focusVisible:()=>{pn(!0),tn.current.focus()}}),[]);const[In,On]=reactExports.useState(!1);reactExports.useEffect(()=>{On(!0)},[]);const _n=In&&!ot&&!tt;reactExports.useEffect(()=>{yn&&yt&&!ot&&In&&Gt.current.pulsate()},[ot,yt,yn,In]);function Mn(qt,Rt,nt=ct){return useEventCallback(vt=>(Rt&&Rt(vt),!nt&&Gt.current&&Gt.current[qt](vt),!0))}const Nn=Mn("start",xt),wn=Mn("stop",ft),Pn=Mn("stop",at),Fn=Mn("stop",Nt),ar=Mn("stop",qt=>{yn&&qt.preventDefault(),At&&At(qt)}),Yn=Mn("start",bt),Xn=Mn("stop",kt),tr=Mn("stop",Mt),cn=Mn("stop",qt=>{dn(qt),Cn.current===!1&&pn(!1),gt&&gt(qt)},!1),Hn=useEventCallback(qt=>{tn.current||(tn.current=qt.currentTarget),Tn(qt),Cn.current===!0&&(pn(!0),mt&&mt(qt)),ht&&ht(qt)}),Qn=()=>{const qt=tn.current;return s&&s!=="button"&&!(qt.tagName==="A"&&qt.href)},or=reactExports.useRef(!1),Wn=useEventCallback(qt=>{yt&&!or.current&&yn&&Gt.current&&qt.key===" "&&(or.current=!0,Gt.current.stop(qt,()=>{Gt.current.start(qt)})),qt.target===qt.currentTarget&&Qn()&&qt.key===" "&&qt.preventDefault(),St&&St(qt),qt.target===qt.currentTarget&&Qn()&&qt.key==="Enter"&&!tt&&(qt.preventDefault(),st&&st(qt))}),ir=useEventCallback(qt=>{yt&&qt.key===" "&&Gt.current&&yn&&!qt.defaultPrevented&&(or.current=!1,Gt.current.stop(qt,()=>{Gt.current.pulsate(qt)})),It&&It(qt),st&&qt.target===qt.currentTarget&&Qn()&&qt.key===" "&&!qt.defaultPrevented&&st(qt)});let nr=s;nr==="button"&&(gn.href||gn.to)&&(nr=pt);const xn={};nr==="button"?(xn.type=nn===void 0?"button":nn,xn.disabled=tt):(!gn.href&&!gn.to&&(xn.role="button"),tt&&(xn["aria-disabled"]=tt));const Un=useForkRef(_e,mn,tn),vn=_extends({},et,{centerRipple:lt,component:s,disabled:tt,disableRipple:ot,disableTouchRipple:ct,focusRipple:yt,tabIndex:Bt,focusVisible:yn}),kn=useUtilityClasses$v(vn);return jsxRuntimeExports.jsxs(ButtonBaseRoot,_extends({as:nr,className:clsx(kn.root,ut),ownerState:vn,onBlur:cn,onClick:st,onContextMenu:wn,onFocus:Hn,onKeyDown:Wn,onKeyUp:ir,onMouseDown:Nn,onMouseLeave:ar,onMouseUp:Fn,onDragLeave:Pn,onTouchEnd:Xn,onTouchMove:tr,onTouchStart:Yn,ref:Un,tabIndex:tt?-1:Bt,type:nn},xn,gn,{children:[it,_n?jsxRuntimeExports.jsx(TouchRipple$1,_extends({ref:fn,center:lt},Ht)):null]}))}),ButtonBase$1=ButtonBase,dividerClasses=generateUtilityClasses("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),dividerClasses$1=dividerClasses,listItemIconClasses=generateUtilityClasses("MuiListItemIcon",["root","alignItemsFlexStart"]),listItemIconClasses$1=listItemIconClasses;function getTypographyUtilityClass(a){return generateUtilityClass("MuiTypography",a)}generateUtilityClasses("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const _excluded$B=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],useUtilityClasses$u=a=>{const{align:o,gutterBottom:_e,noWrap:et,paragraph:rt,variant:lt,classes:it}=a,ut={root:["root",lt,a.align!=="inherit"&&`align${capitalize(o)}`,_e&&"gutterBottom",et&&"noWrap",rt&&"paragraph"]};return composeClasses(ut,getTypographyUtilityClass,it)},TypographyRoot=styled$1("span",{name:"MuiTypography",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.variant&&o[_e.variant],_e.align!=="inherit"&&o[`align${capitalize(_e.align)}`],_e.noWrap&&o.noWrap,_e.gutterBottom&&o.gutterBottom,_e.paragraph&&o.paragraph]}})(({theme:a,ownerState:o})=>_extends({margin:0},o.variant&&a.typography[o.variant],o.align!=="inherit"&&{textAlign:o.align},o.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},o.gutterBottom&&{marginBottom:"0.35em"},o.paragraph&&{marginBottom:16})),defaultVariantMapping={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},colorTransformations$1={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},transformDeprecatedColors$1=a=>colorTransformations$1[a]||a,Typography=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiTypography"}),rt=transformDeprecatedColors$1(et.color),lt=extendSxProp(_extends({},et,{color:rt})),{align:it="inherit",className:ut,component:s,gutterBottom:tt=!1,noWrap:ot=!1,paragraph:ct=!1,variant:yt="body1",variantMapping:pt=defaultVariantMapping}=lt,gt=_objectWithoutPropertiesLoose(lt,_excluded$B),st=_extends({},lt,{align:it,color:rt,className:ut,component:s,gutterBottom:tt,noWrap:ot,paragraph:ct,variant:yt,variantMapping:pt}),ft=s||(ct?"p":pt[yt]||defaultVariantMapping[yt])||"span",at=useUtilityClasses$u(st);return jsxRuntimeExports.jsx(TypographyRoot,_extends({as:ft,ref:_e,ownerState:st,className:clsx(at.root,ut)},gt))}),Typography$1=Typography,listItemTextClasses=generateUtilityClasses("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),listItemTextClasses$1=listItemTextClasses;function getMenuItemUtilityClass(a){return generateUtilityClass("MuiMenuItem",a)}const menuItemClasses=generateUtilityClasses("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),menuItemClasses$1=menuItemClasses,_excluded$A=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],overridesResolver=(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.dense&&o.dense,_e.divider&&o.divider,!_e.disableGutters&&o.gutters]},useUtilityClasses$t=a=>{const{disabled:o,dense:_e,divider:et,disableGutters:rt,selected:lt,classes:it}=a,s=composeClasses({root:["root",_e&&"dense",o&&"disabled",!rt&&"gutters",et&&"divider",lt&&"selected"]},getMenuItemUtilityClass,it);return _extends({},it,s)},MenuItemRoot=styled$1(ButtonBase$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver})(({theme:a,ownerState:o})=>_extends({},a.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!o.disableGutters&&{paddingLeft:16,paddingRight:16},o.divider&&{borderBottom:`1px solid ${(a.vars||a).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(a.vars||a).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${menuItemClasses$1.selected}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / ${a.vars.palette.action.selectedOpacity})`:alpha(a.palette.primary.main,a.palette.action.selectedOpacity),[`&.${menuItemClasses$1.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:alpha(a.palette.primary.main,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}},[`&.${menuItemClasses$1.selected}:hover`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:alpha(a.palette.primary.main,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / ${a.vars.palette.action.selectedOpacity})`:alpha(a.palette.primary.main,a.palette.action.selectedOpacity)}},[`&.${menuItemClasses$1.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`&.${menuItemClasses$1.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity},[`& + .${dividerClasses$1.root}`]:{marginTop:a.spacing(1),marginBottom:a.spacing(1)},[`& + .${dividerClasses$1.inset}`]:{marginLeft:52},[`& .${listItemTextClasses$1.root}`]:{marginTop:0,marginBottom:0},[`& .${listItemTextClasses$1.inset}`]:{paddingLeft:36},[`& .${listItemIconClasses$1.root}`]:{minWidth:36}},!o.dense&&{[a.breakpoints.up("sm")]:{minHeight:"auto"}},o.dense&&_extends({minHeight:32,paddingTop:4,paddingBottom:4},a.typography.body2,{[`& .${listItemIconClasses$1.root} svg`]:{fontSize:"1.25rem"}}))),MenuItem=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiMenuItem"}),{autoFocus:rt=!1,component:lt="li",dense:it=!1,divider:ut=!1,disableGutters:s=!1,focusVisibleClassName:tt,role:ot="menuitem",tabIndex:ct,className:yt}=et,pt=_objectWithoutPropertiesLoose(et,_excluded$A),gt=reactExports.useContext(ListContext$1),st=reactExports.useMemo(()=>({dense:it||gt.dense||!1,disableGutters:s}),[gt.dense,it,s]),ft=reactExports.useRef(null);useEnhancedEffect$1(()=>{rt&&ft.current&&ft.current.focus()},[rt]);const at=_extends({},et,{dense:st.dense,divider:ut,disableGutters:s}),ht=useUtilityClasses$t(et),mt=useForkRef(ft,_e);let St;return et.disabled||(St=ct!==void 0?ct:-1),jsxRuntimeExports.jsx(ListContext$1.Provider,{value:st,children:jsxRuntimeExports.jsx(MenuItemRoot,_extends({ref:mt,role:ot,tabIndex:St,component:lt,focusVisibleClassName:clsx(ht.focusVisible,tt),className:clsx(ht.root,yt)},pt,{ownerState:at,classes:ht}))})}),MenuItem$1=MenuItem;function getListUtilityClass(a){return generateUtilityClass("MuiList",a)}generateUtilityClasses("MuiList",["root","padding","dense","subheader"]);const _excluded$z=["children","className","component","dense","disablePadding","subheader"],useUtilityClasses$s=a=>{const{classes:o,disablePadding:_e,dense:et,subheader:rt}=a;return composeClasses({root:["root",!_e&&"padding",et&&"dense",rt&&"subheader"]},getListUtilityClass,o)},ListRoot=styled$1("ul",{name:"MuiList",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,!_e.disablePadding&&o.padding,_e.dense&&o.dense,_e.subheader&&o.subheader]}})(({ownerState:a})=>_extends({listStyle:"none",margin:0,padding:0,position:"relative"},!a.disablePadding&&{paddingTop:8,paddingBottom:8},a.subheader&&{paddingTop:0})),List=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiList"}),{children:rt,className:lt,component:it="ul",dense:ut=!1,disablePadding:s=!1,subheader:tt}=et,ot=_objectWithoutPropertiesLoose(et,_excluded$z),ct=reactExports.useMemo(()=>({dense:ut}),[ut]),yt=_extends({},et,{component:it,dense:ut,disablePadding:s}),pt=useUtilityClasses$s(yt);return jsxRuntimeExports.jsx(ListContext$1.Provider,{value:ct,children:jsxRuntimeExports.jsxs(ListRoot,_extends({as:it,className:clsx(pt.root,lt),ref:_e,ownerState:yt},ot,{children:[tt,rt]}))})}),List$1=List,_excluded$y=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function nextItem(a,o,_e){return a===o?a.firstChild:o&&o.nextElementSibling?o.nextElementSibling:_e?null:a.firstChild}function previousItem(a,o,_e){return a===o?_e?a.firstChild:a.lastChild:o&&o.previousElementSibling?o.previousElementSibling:_e?null:a.lastChild}function textCriteriaMatches(a,o){if(o===void 0)return!0;let _e=a.innerText;return _e===void 0&&(_e=a.textContent),_e=_e.trim().toLowerCase(),_e.length===0?!1:o.repeating?_e[0]===o.keys[0]:_e.indexOf(o.keys.join(""))===0}function moveFocus(a,o,_e,et,rt,lt){let it=!1,ut=rt(a,o,o?_e:!1);for(;ut;){if(ut===a.firstChild){if(it)return!1;it=!0}const s=et?!1:ut.disabled||ut.getAttribute("aria-disabled")==="true";if(!ut.hasAttribute("tabindex")||!textCriteriaMatches(ut,lt)||s)ut=rt(a,ut,_e);else return ut.focus(),!0}return!1}const MenuList=reactExports.forwardRef(function(o,_e){const{actions:et,autoFocus:rt=!1,autoFocusItem:lt=!1,children:it,className:ut,disabledItemsFocusable:s=!1,disableListWrap:tt=!1,onKeyDown:ot,variant:ct="selectedMenu"}=o,yt=_objectWithoutPropertiesLoose(o,_excluded$y),pt=reactExports.useRef(null),gt=reactExports.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});useEnhancedEffect$1(()=>{rt&&pt.current.focus()},[rt]),reactExports.useImperativeHandle(et,()=>({adjustStyleForScrollbar:(mt,St)=>{const It=!pt.current.style.width;if(mt.clientHeight<pt.current.clientHeight&&It){const xt=`${getScrollbarSize(ownerDocument(mt))}px`;pt.current.style[St.direction==="rtl"?"paddingLeft":"paddingRight"]=xt,pt.current.style.width=`calc(100% + ${xt})`}return pt.current}}),[]);const st=mt=>{const St=pt.current,It=mt.key,xt=ownerDocument(St).activeElement;if(It==="ArrowDown")mt.preventDefault(),moveFocus(St,xt,tt,s,nextItem);else if(It==="ArrowUp")mt.preventDefault(),moveFocus(St,xt,tt,s,previousItem);else if(It==="Home")mt.preventDefault(),moveFocus(St,null,tt,s,nextItem);else if(It==="End")mt.preventDefault(),moveFocus(St,null,tt,s,previousItem);else if(It.length===1){const At=gt.current,Nt=It.toLowerCase(),kt=performance.now();At.keys.length>0&&(kt-At.lastTime>500?(At.keys=[],At.repeating=!0,At.previousKeyMatched=!0):At.repeating&&Nt!==At.keys[0]&&(At.repeating=!1)),At.lastTime=kt,At.keys.push(Nt);const Mt=xt&&!At.repeating&&textCriteriaMatches(xt,At);At.previousKeyMatched&&(Mt||moveFocus(St,xt,!1,s,nextItem,At))?mt.preventDefault():At.previousKeyMatched=!1}ot&&ot(mt)},ft=useForkRef(pt,_e);let at=-1;reactExports.Children.forEach(it,(mt,St)=>{reactExports.isValidElement(mt)&&(mt.props.disabled||(ct==="selectedMenu"&&mt.props.selected||at===-1)&&(at=St),at===St&&(mt.props.disabled||mt.props.muiSkipListHighlight||mt.type.muiSkipListHighlight)&&(at+=1,at>=it.length&&(at=-1)))});const ht=reactExports.Children.map(it,(mt,St)=>{if(St===at){const It={};return lt&&(It.autoFocus=!0),mt.props.tabIndex===void 0&&ct==="selectedMenu"&&(It.tabIndex=0),reactExports.cloneElement(mt,It)}return mt});return jsxRuntimeExports.jsx(List$1,_extends({role:"menu",ref:ft,className:ut,onKeyDown:st,tabIndex:rt?0:-1},yt,{children:ht}))}),MenuList$1=MenuList,getOverlayAlpha=a=>{let o;return a<1?o=5.11916*a**2:o=4.5*Math.log(a+1)+2,(o/100).toFixed(2)},getOverlayAlpha$1=getOverlayAlpha;function getPaperUtilityClass(a){return generateUtilityClass("MuiPaper",a)}generateUtilityClasses("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const _excluded$x=["className","component","elevation","square","variant"],useUtilityClasses$r=a=>{const{square:o,elevation:_e,variant:et,classes:rt}=a,lt={root:["root",et,!o&&"rounded",et==="elevation"&&`elevation${_e}`]};return composeClasses(lt,getPaperUtilityClass,rt)},PaperRoot=styled$1("div",{name:"MuiPaper",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],!_e.square&&o.rounded,_e.variant==="elevation"&&o[`elevation${_e.elevation}`]]}})(({theme:a,ownerState:o})=>{var _e;return _extends({backgroundColor:(a.vars||a).palette.background.paper,color:(a.vars||a).palette.text.primary,transition:a.transitions.create("box-shadow")},!o.square&&{borderRadius:a.shape.borderRadius},o.variant==="outlined"&&{border:`1px solid ${(a.vars||a).palette.divider}`},o.variant==="elevation"&&_extends({boxShadow:(a.vars||a).shadows[o.elevation]},!a.vars&&a.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${alpha("#fff",getOverlayAlpha$1(o.elevation))}, ${alpha("#fff",getOverlayAlpha$1(o.elevation))})`},a.vars&&{backgroundImage:(_e=a.vars.overlays)==null?void 0:_e[o.elevation]}))}),Paper=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiPaper"}),{className:rt,component:lt="div",elevation:it=1,square:ut=!1,variant:s="elevation"}=et,tt=_objectWithoutPropertiesLoose(et,_excluded$x),ot=_extends({},et,{component:lt,elevation:it,square:ut,variant:s}),ct=useUtilityClasses$r(ot);return jsxRuntimeExports.jsx(PaperRoot,_extends({as:lt,ownerState:ot,className:clsx(ct.root,rt),ref:_e},tt))}),Paper$1=Paper,reflow=a=>a.scrollTop;function getTransitionProps(a,o){var _e,et;const{timeout:rt,easing:lt,style:it={}}=a;return{duration:(_e=it.transitionDuration)!=null?_e:typeof rt=="number"?rt:rt[o.mode]||0,easing:(et=it.transitionTimingFunction)!=null?et:typeof lt=="object"?lt[o.mode]:lt,delay:it.transitionDelay}}const _excluded$w=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function getScale(a){return`scale(${a}, ${a**2})`}const styles$1={entering:{opacity:1,transform:getScale(1)},entered:{opacity:1,transform:"none"}},isWebKit154=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Grow=reactExports.forwardRef(function(o,_e){const{addEndListener:et,appear:rt=!0,children:lt,easing:it,in:ut,onEnter:s,onEntered:tt,onEntering:ot,onExit:ct,onExited:yt,onExiting:pt,style:gt,timeout:st="auto",TransitionComponent:ft=Transition$1}=o,at=_objectWithoutPropertiesLoose(o,_excluded$w),ht=reactExports.useRef(),mt=reactExports.useRef(),St=useTheme(),It=reactExports.useRef(null),xt=useForkRef(It,lt.ref,_e),At=nn=>gn=>{if(nn){const tn=It.current;gn===void 0?nn(tn):nn(tn,gn)}},Nt=At(ot),kt=At((nn,gn)=>{reflow(nn);const{duration:tn,delay:Gt,easing:fn}=getTransitionProps({style:gt,timeout:st,easing:it},{mode:"enter"});let Cn;st==="auto"?(Cn=St.transitions.getAutoHeightDuration(nn.clientHeight),mt.current=Cn):Cn=tn,nn.style.transition=[St.transitions.create("opacity",{duration:Cn,delay:Gt}),St.transitions.create("transform",{duration:isWebKit154?Cn:Cn*.666,delay:Gt,easing:fn})].join(","),s&&s(nn,gn)}),Mt=At(tt),bt=At(pt),Bt=At(nn=>{const{duration:gn,delay:tn,easing:Gt}=getTransitionProps({style:gt,timeout:st,easing:it},{mode:"exit"});let fn;st==="auto"?(fn=St.transitions.getAutoHeightDuration(nn.clientHeight),mt.current=fn):fn=gn,nn.style.transition=[St.transitions.create("opacity",{duration:fn,delay:tn}),St.transitions.create("transform",{duration:isWebKit154?fn:fn*.666,delay:isWebKit154?tn:tn||fn*.333,easing:Gt})].join(","),nn.style.opacity=0,nn.style.transform=getScale(.75),ct&&ct(nn)}),Ht=At(yt),Wt=nn=>{st==="auto"&&(ht.current=setTimeout(nn,mt.current||0)),et&&et(It.current,nn)};return reactExports.useEffect(()=>()=>{clearTimeout(ht.current)},[]),jsxRuntimeExports.jsx(ft,_extends({appear:rt,in:ut,nodeRef:It,onEnter:kt,onEntered:Mt,onEntering:Nt,onExit:Bt,onExited:Ht,onExiting:bt,addEndListener:Wt,timeout:st==="auto"?null:st},at,{children:(nn,gn)=>reactExports.cloneElement(lt,_extends({style:_extends({opacity:0,transform:getScale(.75),visibility:nn==="exited"&&!ut?"hidden":void 0},styles$1[nn],gt,lt.props.style),ref:xt},gn))}))});Grow.muiSupportAuto=!0;const Grow$1=Grow,_excluded$v=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],styles={entering:{opacity:1},entered:{opacity:1}},Fade=reactExports.forwardRef(function(o,_e){const et=useTheme(),rt={enter:et.transitions.duration.enteringScreen,exit:et.transitions.duration.leavingScreen},{addEndListener:lt,appear:it=!0,children:ut,easing:s,in:tt,onEnter:ot,onEntered:ct,onEntering:yt,onExit:pt,onExited:gt,onExiting:st,style:ft,timeout:at=rt,TransitionComponent:ht=Transition$1}=o,mt=_objectWithoutPropertiesLoose(o,_excluded$v),St=reactExports.useRef(null),It=useForkRef(St,ut.ref,_e),xt=Wt=>nn=>{if(Wt){const gn=St.current;nn===void 0?Wt(gn):Wt(gn,nn)}},At=xt(yt),Nt=xt((Wt,nn)=>{reflow(Wt);const gn=getTransitionProps({style:ft,timeout:at,easing:s},{mode:"enter"});Wt.style.webkitTransition=et.transitions.create("opacity",gn),Wt.style.transition=et.transitions.create("opacity",gn),ot&&ot(Wt,nn)}),kt=xt(ct),Mt=xt(st),bt=xt(Wt=>{const nn=getTransitionProps({style:ft,timeout:at,easing:s},{mode:"exit"});Wt.style.webkitTransition=et.transitions.create("opacity",nn),Wt.style.transition=et.transitions.create("opacity",nn),pt&&pt(Wt)}),Bt=xt(gt),Ht=Wt=>{lt&&lt(St.current,Wt)};return jsxRuntimeExports.jsx(ht,_extends({appear:it,in:tt,nodeRef:St,onEnter:Nt,onEntered:kt,onEntering:At,onExit:bt,onExited:Bt,onExiting:Mt,addEndListener:Ht,timeout:at},mt,{children:(Wt,nn)=>reactExports.cloneElement(ut,_extends({style:_extends({opacity:0,visibility:Wt==="exited"&&!tt?"hidden":void 0},styles[Wt],ft,ut.props.style),ref:It},nn))}))}),Fade$1=Fade;function getBackdropUtilityClass(a){return generateUtilityClass("MuiBackdrop",a)}generateUtilityClasses("MuiBackdrop",["root","invisible"]);const _excluded$u=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],useUtilityClasses$q=a=>{const{classes:o,invisible:_e}=a;return composeClasses({root:["root",_e&&"invisible"]},getBackdropUtilityClass,o)},BackdropRoot=styled$1("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.invisible&&o.invisible]}})(({ownerState:a})=>_extends({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},a.invisible&&{backgroundColor:"transparent"})),Backdrop=reactExports.forwardRef(function(o,_e){var et,rt,lt;const it=useThemeProps({props:o,name:"MuiBackdrop"}),{children:ut,className:s,component:tt="div",components:ot={},componentsProps:ct={},invisible:yt=!1,open:pt,slotProps:gt={},slots:st={},TransitionComponent:ft=Fade$1,transitionDuration:at}=it,ht=_objectWithoutPropertiesLoose(it,_excluded$u),mt=_extends({},it,{component:tt,invisible:yt}),St=useUtilityClasses$q(mt),It=(et=gt.root)!=null?et:ct.root;return jsxRuntimeExports.jsx(ft,_extends({in:pt,timeout:at},ht,{children:jsxRuntimeExports.jsx(BackdropRoot,_extends({"aria-hidden":!0},It,{as:(rt=(lt=st.root)!=null?lt:ot.Root)!=null?rt:tt,className:clsx(St.root,s,It==null?void 0:It.className),ownerState:_extends({},mt,It==null?void 0:It.ownerState),classes:St,ref:_e,children:ut}))}))}),Backdrop$1=Backdrop,_excluded$t=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","open","slotProps","slots","theme"],ModalRoot=styled$1("div",{name:"MuiModal",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,!_e.open&&_e.exited&&o.hidden]}})(({theme:a,ownerState:o})=>_extends({position:"fixed",zIndex:(a.vars||a).zIndex.modal,right:0,bottom:0,top:0,left:0},!o.open&&o.exited&&{visibility:"hidden"})),ModalBackdrop=styled$1(Backdrop$1,{name:"MuiModal",slot:"Backdrop",overridesResolver:(a,o)=>o.backdrop})({zIndex:-1}),Modal=reactExports.forwardRef(function(o,_e){var et,rt,lt,it,ut,s;const tt=useThemeProps({name:"MuiModal",props:o}),{BackdropComponent:ot=ModalBackdrop,BackdropProps:ct,classes:yt,className:pt,closeAfterTransition:gt=!1,children:st,container:ft,component:at,components:ht={},componentsProps:mt={},disableAutoFocus:St=!1,disableEnforceFocus:It=!1,disableEscapeKeyDown:xt=!1,disablePortal:At=!1,disableRestoreFocus:Nt=!1,disableScrollLock:kt=!1,hideBackdrop:Mt=!1,keepMounted:bt=!1,onBackdropClick:Bt,onClose:Ht,open:Wt,slotProps:nn,slots:gn,theme:tn}=tt,Gt=_objectWithoutPropertiesLoose(tt,_excluded$t),[fn,Cn]=reactExports.useState(!0),Tn={container:ft,closeAfterTransition:gt,disableAutoFocus:St,disableEnforceFocus:It,disableEscapeKeyDown:xt,disablePortal:At,disableRestoreFocus:Nt,disableScrollLock:kt,hideBackdrop:Mt,keepMounted:bt,onBackdropClick:Bt,onClose:Ht,open:Wt},dn=_extends({},tt,Tn,{exited:fn}),mn=(et=(rt=gn==null?void 0:gn.root)!=null?rt:ht.Root)!=null?et:ModalRoot,yn=(lt=(it=gn==null?void 0:gn.backdrop)!=null?it:ht.Backdrop)!=null?lt:ot,pn=(ut=nn==null?void 0:nn.root)!=null?ut:mt.root,In=(s=nn==null?void 0:nn.backdrop)!=null?s:mt.backdrop;return jsxRuntimeExports.jsx(ModalUnstyled,_extends({slots:{root:mn,backdrop:yn},slotProps:{root:()=>_extends({},resolveComponentProps(pn,dn),!isHostComponent(mn)&&{as:at,theme:tn},{className:clsx(pt,pn==null?void 0:pn.className,yt==null?void 0:yt.root,!dn.open&&dn.exited&&(yt==null?void 0:yt.hidden))}),backdrop:()=>_extends({},ct,resolveComponentProps(In,dn),{className:clsx(In==null?void 0:In.className,yt==null?void 0:yt.backdrop)})},onTransitionEnter:()=>Cn(!1),onTransitionExited:()=>Cn(!0),ref:_e},Gt,Tn,{children:st}))}),Modal$1=Modal;function getPopoverUtilityClass(a){return generateUtilityClass("MuiPopover",a)}generateUtilityClasses("MuiPopover",["root","paper"]);const _excluded$s=["onEntering"],_excluded2$1=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps"];function getOffsetTop(a,o){let _e=0;return typeof o=="number"?_e=o:o==="center"?_e=a.height/2:o==="bottom"&&(_e=a.height),_e}function getOffsetLeft(a,o){let _e=0;return typeof o=="number"?_e=o:o==="center"?_e=a.width/2:o==="right"&&(_e=a.width),_e}function getTransformOriginValue(a){return[a.horizontal,a.vertical].map(o=>typeof o=="number"?`${o}px`:o).join(" ")}function resolveAnchorEl(a){return typeof a=="function"?a():a}const useUtilityClasses$p=a=>{const{classes:o}=a;return composeClasses({root:["root"],paper:["paper"]},getPopoverUtilityClass,o)},PopoverRoot=styled$1(Modal$1,{name:"MuiPopover",slot:"Root",overridesResolver:(a,o)=>o.root})({}),PopoverPaper=styled$1(Paper$1,{name:"MuiPopover",slot:"Paper",overridesResolver:(a,o)=>o.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Popover=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiPopover"}),{action:rt,anchorEl:lt,anchorOrigin:it={vertical:"top",horizontal:"left"},anchorPosition:ut,anchorReference:s="anchorEl",children:tt,className:ot,container:ct,elevation:yt=8,marginThreshold:pt=16,open:gt,PaperProps:st={},transformOrigin:ft={vertical:"top",horizontal:"left"},TransitionComponent:at=Grow$1,transitionDuration:ht="auto",TransitionProps:{onEntering:mt}={}}=et,St=_objectWithoutPropertiesLoose(et.TransitionProps,_excluded$s),It=_objectWithoutPropertiesLoose(et,_excluded2$1),xt=reactExports.useRef(),At=useForkRef(xt,st.ref),Nt=_extends({},et,{anchorOrigin:it,anchorReference:s,elevation:yt,marginThreshold:pt,PaperProps:st,transformOrigin:ft,TransitionComponent:at,transitionDuration:ht,TransitionProps:St}),kt=useUtilityClasses$p(Nt),Mt=reactExports.useCallback(()=>{if(s==="anchorPosition")return ut;const Cn=resolveAnchorEl(lt),dn=(Cn&&Cn.nodeType===1?Cn:ownerDocument(xt.current).body).getBoundingClientRect();return{top:dn.top+getOffsetTop(dn,it.vertical),left:dn.left+getOffsetLeft(dn,it.horizontal)}},[lt,it.horizontal,it.vertical,ut,s]),bt=reactExports.useCallback(Cn=>({vertical:getOffsetTop(Cn,ft.vertical),horizontal:getOffsetLeft(Cn,ft.horizontal)}),[ft.horizontal,ft.vertical]),Bt=reactExports.useCallback(Cn=>{const Tn={width:Cn.offsetWidth,height:Cn.offsetHeight},dn=bt(Tn);if(s==="none")return{top:null,left:null,transformOrigin:getTransformOriginValue(dn)};const mn=Mt();let yn=mn.top-dn.vertical,pn=mn.left-dn.horizontal;const In=yn+Tn.height,On=pn+Tn.width,_n=ownerWindow(resolveAnchorEl(lt)),Mn=_n.innerHeight-pt,Nn=_n.innerWidth-pt;if(yn<pt){const wn=yn-pt;yn-=wn,dn.vertical+=wn}else if(In>Mn){const wn=In-Mn;yn-=wn,dn.vertical+=wn}if(pn<pt){const wn=pn-pt;pn-=wn,dn.horizontal+=wn}else if(On>Nn){const wn=On-Nn;pn-=wn,dn.horizontal+=wn}return{top:`${Math.round(yn)}px`,left:`${Math.round(pn)}px`,transformOrigin:getTransformOriginValue(dn)}},[lt,s,Mt,bt,pt]),[Ht,Wt]=reactExports.useState(gt),nn=reactExports.useCallback(()=>{const Cn=xt.current;if(!Cn)return;const Tn=Bt(Cn);Tn.top!==null&&(Cn.style.top=Tn.top),Tn.left!==null&&(Cn.style.left=Tn.left),Cn.style.transformOrigin=Tn.transformOrigin,Wt(!0)},[Bt]),gn=(Cn,Tn)=>{mt&&mt(Cn,Tn),nn()},tn=()=>{Wt(!1)};reactExports.useEffect(()=>{gt&&nn()}),reactExports.useImperativeHandle(rt,()=>gt?{updatePosition:()=>{nn()}}:null,[gt,nn]),reactExports.useEffect(()=>{if(!gt)return;const Cn=debounce$1(()=>{nn()}),Tn=ownerWindow(lt);return Tn.addEventListener("resize",Cn),()=>{Cn.clear(),Tn.removeEventListener("resize",Cn)}},[lt,gt,nn]);let Gt=ht;ht==="auto"&&!at.muiSupportAuto&&(Gt=void 0);const fn=ct||(lt?ownerDocument(resolveAnchorEl(lt)).body:void 0);return jsxRuntimeExports.jsx(PopoverRoot,_extends({BackdropProps:{invisible:!0},className:clsx(kt.root,ot),container:fn,open:gt,ref:_e,ownerState:Nt},It,{children:jsxRuntimeExports.jsx(at,_extends({appear:!0,in:gt,onEntering:gn,onExited:tn,timeout:Gt},St,{children:jsxRuntimeExports.jsx(PopoverPaper,_extends({elevation:yt},st,{ref:At,className:clsx(kt.paper,st.className)},Ht?void 0:{style:_extends({},st.style,{opacity:0})},{ownerState:Nt,children:tt}))}))}))}),Popover$1=Popover;function getMenuUtilityClass(a){return generateUtilityClass("MuiMenu",a)}generateUtilityClasses("MuiMenu",["root","paper","list"]);const _excluded$r=["onEntering"],_excluded2=["autoFocus","children","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant"],RTL_ORIGIN={vertical:"top",horizontal:"right"},LTR_ORIGIN={vertical:"top",horizontal:"left"},useUtilityClasses$o=a=>{const{classes:o}=a;return composeClasses({root:["root"],paper:["paper"],list:["list"]},getMenuUtilityClass,o)},MenuRoot=styled$1(Popover$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(a,o)=>o.root})({}),MenuPaper=styled$1(Paper$1,{name:"MuiMenu",slot:"Paper",overridesResolver:(a,o)=>o.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),MenuMenuList=styled$1(MenuList$1,{name:"MuiMenu",slot:"List",overridesResolver:(a,o)=>o.list})({outline:0}),Menu=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiMenu"}),{autoFocus:rt=!0,children:lt,disableAutoFocusItem:it=!1,MenuListProps:ut={},onClose:s,open:tt,PaperProps:ot={},PopoverClasses:ct,transitionDuration:yt="auto",TransitionProps:{onEntering:pt}={},variant:gt="selectedMenu"}=et,st=_objectWithoutPropertiesLoose(et.TransitionProps,_excluded$r),ft=_objectWithoutPropertiesLoose(et,_excluded2),at=useTheme(),ht=at.direction==="rtl",mt=_extends({},et,{autoFocus:rt,disableAutoFocusItem:it,MenuListProps:ut,onEntering:pt,PaperProps:ot,transitionDuration:yt,TransitionProps:st,variant:gt}),St=useUtilityClasses$o(mt),It=rt&&!it&&tt,xt=reactExports.useRef(null),At=(Mt,bt)=>{xt.current&&xt.current.adjustStyleForScrollbar(Mt,at),pt&&pt(Mt,bt)},Nt=Mt=>{Mt.key==="Tab"&&(Mt.preventDefault(),s&&s(Mt,"tabKeyDown"))};let kt=-1;return reactExports.Children.map(lt,(Mt,bt)=>{reactExports.isValidElement(Mt)&&(Mt.props.disabled||(gt==="selectedMenu"&&Mt.props.selected||kt===-1)&&(kt=bt))}),jsxRuntimeExports.jsx(MenuRoot,_extends({onClose:s,anchorOrigin:{vertical:"bottom",horizontal:ht?"right":"left"},transformOrigin:ht?RTL_ORIGIN:LTR_ORIGIN,PaperProps:_extends({as:MenuPaper},ot,{classes:_extends({},ot.classes,{root:St.paper})}),className:St.root,open:tt,ref:_e,transitionDuration:yt,TransitionProps:_extends({onEntering:At},st),ownerState:mt},ft,{classes:ct,children:jsxRuntimeExports.jsx(MenuMenuList,_extends({onKeyDown:Nt,actions:xt,autoFocus:rt&&(kt===-1||it),autoFocusItem:It,variant:gt},ut,{className:clsx(St.list,ut.className),children:lt}))}))}),Menu$1=Menu;function getNativeSelectUtilityClasses(a){return generateUtilityClass("MuiNativeSelect",a)}const nativeSelectClasses=generateUtilityClasses("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),nativeSelectClasses$1=nativeSelectClasses,_excluded$q=["className","disabled","error","IconComponent","inputRef","variant"],useUtilityClasses$n=a=>{const{classes:o,variant:_e,disabled:et,multiple:rt,open:lt,error:it}=a,ut={select:["select",_e,et&&"disabled",rt&&"multiple",it&&"error"],icon:["icon",`icon${capitalize(_e)}`,lt&&"iconOpen",et&&"disabled"]};return composeClasses(ut,getNativeSelectUtilityClasses,o)},nativeSelectSelectStyles=({ownerState:a,theme:o})=>_extends({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":_extends({},o.vars?{backgroundColor:`rgba(${o.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:o.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${nativeSelectClasses$1.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(o.vars||o).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},a.variant==="filled"&&{"&&&":{paddingRight:32}},a.variant==="outlined"&&{borderRadius:(o.vars||o).shape.borderRadius,"&:focus":{borderRadius:(o.vars||o).shape.borderRadius},"&&&":{paddingRight:32}}),NativeSelectSelect=styled$1("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:rootShouldForwardProp,overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.select,o[_e.variant],_e.error&&o.error,{[`&.${nativeSelectClasses$1.multiple}`]:o.multiple}]}})(nativeSelectSelectStyles),nativeSelectIconStyles=({ownerState:a,theme:o})=>_extends({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(o.vars||o).palette.action.active,[`&.${nativeSelectClasses$1.disabled}`]:{color:(o.vars||o).palette.action.disabled}},a.open&&{transform:"rotate(180deg)"},a.variant==="filled"&&{right:7},a.variant==="outlined"&&{right:7}),NativeSelectIcon=styled$1("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.icon,_e.variant&&o[`icon${capitalize(_e.variant)}`],_e.open&&o.iconOpen]}})(nativeSelectIconStyles),NativeSelectInput=reactExports.forwardRef(function(o,_e){const{className:et,disabled:rt,error:lt,IconComponent:it,inputRef:ut,variant:s="standard"}=o,tt=_objectWithoutPropertiesLoose(o,_excluded$q),ot=_extends({},o,{disabled:rt,variant:s,error:lt}),ct=useUtilityClasses$n(ot);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(NativeSelectSelect,_extends({ownerState:ot,className:clsx(ct.select,et),disabled:rt,ref:ut||_e},tt)),o.multiple?null:jsxRuntimeExports.jsx(NativeSelectIcon,{as:it,ownerState:ot,className:ct.icon})]})}),NativeSelectInput$1=NativeSelectInput;function hasValue(a){return a!=null&&!(Array.isArray(a)&&a.length===0)}function isFilled(a,o=!1){return a&&(hasValue(a.value)&&a.value!==""||o&&hasValue(a.defaultValue)&&a.defaultValue!=="")}function getSelectUtilityClasses(a){return generateUtilityClass("MuiSelect",a)}const selectClasses=generateUtilityClasses("MuiSelect",["select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),selectClasses$1=selectClasses;var _span$1;const _excluded$p=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],SelectSelect=styled$1("div",{name:"MuiSelect",slot:"Select",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[{[`&.${selectClasses$1.select}`]:o.select},{[`&.${selectClasses$1.select}`]:o[_e.variant]},{[`&.${selectClasses$1.error}`]:o.error},{[`&.${selectClasses$1.multiple}`]:o.multiple}]}})(nativeSelectSelectStyles,{[`&.${selectClasses$1.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),SelectIcon=styled$1("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.icon,_e.variant&&o[`icon${capitalize(_e.variant)}`],_e.open&&o.iconOpen]}})(nativeSelectIconStyles),SelectNativeInput=styled$1("input",{shouldForwardProp:a=>slotShouldForwardProp(a)&&a!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(a,o)=>o.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function areEqualValues(a,o){return typeof o=="object"&&o!==null?a===o:String(a)===String(o)}function isEmpty(a){return a==null||typeof a=="string"&&!a.trim()}const useUtilityClasses$m=a=>{const{classes:o,variant:_e,disabled:et,multiple:rt,open:lt,error:it}=a,ut={select:["select",_e,et&&"disabled",rt&&"multiple",it&&"error"],icon:["icon",`icon${capitalize(_e)}`,lt&&"iconOpen",et&&"disabled"],nativeInput:["nativeInput"]};return composeClasses(ut,getSelectUtilityClasses,o)},SelectInput=reactExports.forwardRef(function(o,_e){const{"aria-describedby":et,"aria-label":rt,autoFocus:lt,autoWidth:it,children:ut,className:s,defaultOpen:tt,defaultValue:ot,disabled:ct,displayEmpty:yt,error:pt=!1,IconComponent:gt,inputRef:st,labelId:ft,MenuProps:at={},multiple:ht,name:mt,onBlur:St,onChange:It,onClose:xt,onFocus:At,onOpen:Nt,open:kt,readOnly:Mt,renderValue:bt,SelectDisplayProps:Bt={},tabIndex:Ht,value:Wt,variant:nn="standard"}=o,gn=_objectWithoutPropertiesLoose(o,_excluded$p),[tn,Gt]=useControlled({controlled:Wt,default:ot,name:"Select"}),[fn,Cn]=useControlled({controlled:kt,default:tt,name:"Select"}),Tn=reactExports.useRef(null),dn=reactExports.useRef(null),[mn,yn]=reactExports.useState(null),{current:pn}=reactExports.useRef(kt!=null),[In,On]=reactExports.useState(),_n=useForkRef(_e,st),Mn=reactExports.useCallback(Rt=>{dn.current=Rt,Rt&&yn(Rt)},[]),Nn=mn==null?void 0:mn.parentNode;reactExports.useImperativeHandle(_n,()=>({focus:()=>{dn.current.focus()},node:Tn.current,value:tn}),[tn]),reactExports.useEffect(()=>{tt&&fn&&mn&&!pn&&(On(it?null:Nn.clientWidth),dn.current.focus())},[mn,it]),reactExports.useEffect(()=>{lt&&dn.current.focus()},[lt]),reactExports.useEffect(()=>{if(!ft)return;const Rt=ownerDocument(dn.current).getElementById(ft);if(Rt){const nt=()=>{getSelection().isCollapsed&&dn.current.focus()};return Rt.addEventListener("click",nt),()=>{Rt.removeEventListener("click",nt)}}},[ft]);const wn=(Rt,nt)=>{Rt?Nt&&Nt(nt):xt&&xt(nt),pn||(On(it?null:Nn.clientWidth),Cn(Rt))},Pn=Rt=>{Rt.button===0&&(Rt.preventDefault(),dn.current.focus(),wn(!0,Rt))},Fn=Rt=>{wn(!1,Rt)},ar=reactExports.Children.toArray(ut),Yn=Rt=>{const nt=ar.map(Tt=>Tt.props.value).indexOf(Rt.target.value);if(nt===-1)return;const vt=ar[nt];Gt(vt.props.value),It&&It(Rt,vt)},Xn=Rt=>nt=>{let vt;if(nt.currentTarget.hasAttribute("tabindex")){if(ht){vt=Array.isArray(tn)?tn.slice():[];const Tt=tn.indexOf(Rt.props.value);Tt===-1?vt.push(Rt.props.value):vt.splice(Tt,1)}else vt=Rt.props.value;if(Rt.props.onClick&&Rt.props.onClick(nt),tn!==vt&&(Gt(vt),It)){const Tt=nt.nativeEvent||nt,Pt=new Tt.constructor(Tt.type,Tt);Object.defineProperty(Pt,"target",{writable:!0,value:{value:vt,name:mt}}),It(Pt,Rt)}ht||wn(!1,nt)}},tr=Rt=>{Mt||[" ","ArrowUp","ArrowDown","Enter"].indexOf(Rt.key)!==-1&&(Rt.preventDefault(),wn(!0,Rt))},cn=mn!==null&&fn,Hn=Rt=>{!cn&&St&&(Object.defineProperty(Rt,"target",{writable:!0,value:{value:tn,name:mt}}),St(Rt))};delete gn["aria-invalid"];let Qn,or;const Wn=[];let ir=!1;(isFilled({value:tn})||yt)&&(bt?Qn=bt(tn):ir=!0);const nr=ar.map(Rt=>{if(!reactExports.isValidElement(Rt))return null;let nt;if(ht){if(!Array.isArray(tn))throw new Error(formatMuiErrorMessage(2));nt=tn.some(vt=>areEqualValues(vt,Rt.props.value)),nt&&ir&&Wn.push(Rt.props.children)}else nt=areEqualValues(tn,Rt.props.value),nt&&ir&&(or=Rt.props.children);return reactExports.cloneElement(Rt,{"aria-selected":nt?"true":"false",onClick:Xn(Rt),onKeyUp:vt=>{vt.key===" "&&vt.preventDefault(),Rt.props.onKeyUp&&Rt.props.onKeyUp(vt)},role:"option",selected:nt,value:void 0,"data-value":Rt.props.value})});ir&&(ht?Wn.length===0?Qn=null:Qn=Wn.reduce((Rt,nt,vt)=>(Rt.push(nt),vt<Wn.length-1&&Rt.push(", "),Rt),[]):Qn=or);let xn=In;!it&&pn&&mn&&(xn=Nn.clientWidth);let Un;typeof Ht<"u"?Un=Ht:Un=ct?null:0;const vn=Bt.id||(mt?`mui-component-select-${mt}`:void 0),kn=_extends({},o,{variant:nn,value:tn,open:cn,error:pt}),qt=useUtilityClasses$m(kn);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(SelectSelect,_extends({ref:Mn,tabIndex:Un,role:"button","aria-disabled":ct?"true":void 0,"aria-expanded":cn?"true":"false","aria-haspopup":"listbox","aria-label":rt,"aria-labelledby":[ft,vn].filter(Boolean).join(" ")||void 0,"aria-describedby":et,onKeyDown:tr,onMouseDown:ct||Mt?null:Pn,onBlur:Hn,onFocus:At},Bt,{ownerState:kn,className:clsx(Bt.className,qt.select,s),id:vn,children:isEmpty(Qn)?_span$1||(_span$1=jsxRuntimeExports.jsx("span",{className:"notranslate",children:""})):Qn})),jsxRuntimeExports.jsx(SelectNativeInput,_extends({"aria-invalid":pt,value:Array.isArray(tn)?tn.join(","):tn,name:mt,ref:Tn,"aria-hidden":!0,onChange:Yn,tabIndex:-1,disabled:ct,className:qt.nativeInput,autoFocus:lt,ownerState:kn},gn)),jsxRuntimeExports.jsx(SelectIcon,{as:gt,className:qt.icon,ownerState:kn}),jsxRuntimeExports.jsx(Menu$1,_extends({id:`menu-${mt||""}`,anchorEl:Nn,open:cn,onClose:Fn,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},at,{MenuListProps:_extends({"aria-labelledby":ft,role:"listbox",disableListWrap:!0},at.MenuListProps),PaperProps:_extends({},at.PaperProps,{style:_extends({minWidth:xn},at.PaperProps!=null?at.PaperProps.style:null)}),children:nr}))]})}),SelectInput$1=SelectInput;function formControlState({props:a,states:o,muiFormControl:_e}){return o.reduce((et,rt)=>(et[rt]=a[rt],_e&&typeof a[rt]>"u"&&(et[rt]=_e[rt]),et),{})}const FormControlContext=reactExports.createContext(void 0),FormControlContext$1=FormControlContext;function useFormControl(){return reactExports.useContext(FormControlContext$1)}function getSvgIconUtilityClass(a){return generateUtilityClass("MuiSvgIcon",a)}generateUtilityClasses("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const _excluded$o=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],useUtilityClasses$l=a=>{const{color:o,fontSize:_e,classes:et}=a,rt={root:["root",o!=="inherit"&&`color${capitalize(o)}`,`fontSize${capitalize(_e)}`]};return composeClasses(rt,getSvgIconUtilityClass,et)},SvgIconRoot=styled$1("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.color!=="inherit"&&o[`color${capitalize(_e.color)}`],o[`fontSize${capitalize(_e.fontSize)}`]]}})(({theme:a,ownerState:o})=>{var _e,et,rt,lt,it,ut,s,tt,ot,ct,yt,pt,gt,st,ft,at,ht;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:(_e=a.transitions)==null||(et=_e.create)==null?void 0:et.call(_e,"fill",{duration:(rt=a.transitions)==null||(lt=rt.duration)==null?void 0:lt.shorter}),fontSize:{inherit:"inherit",small:((it=a.typography)==null||(ut=it.pxToRem)==null?void 0:ut.call(it,20))||"1.25rem",medium:((s=a.typography)==null||(tt=s.pxToRem)==null?void 0:tt.call(s,24))||"1.5rem",large:((ot=a.typography)==null||(ct=ot.pxToRem)==null?void 0:ct.call(ot,35))||"2.1875rem"}[o.fontSize],color:(yt=(pt=(a.vars||a).palette)==null||(gt=pt[o.color])==null?void 0:gt.main)!=null?yt:{action:(st=(a.vars||a).palette)==null||(ft=st.action)==null?void 0:ft.active,disabled:(at=(a.vars||a).palette)==null||(ht=at.action)==null?void 0:ht.disabled,inherit:void 0}[o.color]}}),SvgIcon=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiSvgIcon"}),{children:rt,className:lt,color:it="inherit",component:ut="svg",fontSize:s="medium",htmlColor:tt,inheritViewBox:ot=!1,titleAccess:ct,viewBox:yt="0 0 24 24"}=et,pt=_objectWithoutPropertiesLoose(et,_excluded$o),gt=_extends({},et,{color:it,component:ut,fontSize:s,instanceFontSize:o.fontSize,inheritViewBox:ot,viewBox:yt}),st={};ot||(st.viewBox=yt);const ft=useUtilityClasses$l(gt);return jsxRuntimeExports.jsxs(SvgIconRoot,_extends({as:ut,className:clsx(ft.root,lt),focusable:"false",color:tt,"aria-hidden":ct?void 0:!0,role:ct?"img":void 0,ref:_e},st,pt,{ownerState:gt,children:[rt,ct?jsxRuntimeExports.jsx("title",{children:ct}):null]}))});SvgIcon.muiName="SvgIcon";const SvgIcon$1=SvgIcon;function createSvgIcon(a,o){function _e(et,rt){return jsxRuntimeExports.jsx(SvgIcon$1,_extends({"data-testid":`${o}Icon`,ref:rt},et,{children:a}))}return _e.muiName=SvgIcon$1.muiName,reactExports.memo(reactExports.forwardRef(_e))}const ArrowDropDownIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown");function GlobalStyles(a){return jsxRuntimeExports.jsx(GlobalStyles$1,_extends({},a,{defaultTheme:defaultTheme$2,themeId:THEME_ID}))}function getInputBaseUtilityClass(a){return generateUtilityClass("MuiInputBase",a)}const inputBaseClasses=generateUtilityClasses("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),inputBaseClasses$1=inputBaseClasses,_excluded$n=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],rootOverridesResolver=(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.formControl&&o.formControl,_e.startAdornment&&o.adornedStart,_e.endAdornment&&o.adornedEnd,_e.error&&o.error,_e.size==="small"&&o.sizeSmall,_e.multiline&&o.multiline,_e.color&&o[`color${capitalize(_e.color)}`],_e.fullWidth&&o.fullWidth,_e.hiddenLabel&&o.hiddenLabel]},inputOverridesResolver=(a,o)=>{const{ownerState:_e}=a;return[o.input,_e.size==="small"&&o.inputSizeSmall,_e.multiline&&o.inputMultiline,_e.type==="search"&&o.inputTypeSearch,_e.startAdornment&&o.inputAdornedStart,_e.endAdornment&&o.inputAdornedEnd,_e.hiddenLabel&&o.inputHiddenLabel]},useUtilityClasses$k=a=>{const{classes:o,color:_e,disabled:et,error:rt,endAdornment:lt,focused:it,formControl:ut,fullWidth:s,hiddenLabel:tt,multiline:ot,readOnly:ct,size:yt,startAdornment:pt,type:gt}=a,st={root:["root",`color${capitalize(_e)}`,et&&"disabled",rt&&"error",s&&"fullWidth",it&&"focused",ut&&"formControl",yt==="small"&&"sizeSmall",ot&&"multiline",pt&&"adornedStart",lt&&"adornedEnd",tt&&"hiddenLabel",ct&&"readOnly"],input:["input",et&&"disabled",gt==="search"&&"inputTypeSearch",ot&&"inputMultiline",yt==="small"&&"inputSizeSmall",tt&&"inputHiddenLabel",pt&&"inputAdornedStart",lt&&"inputAdornedEnd",ct&&"readOnly"]};return composeClasses(st,getInputBaseUtilityClass,o)},InputBaseRoot=styled$1("div",{name:"MuiInputBase",slot:"Root",overridesResolver:rootOverridesResolver})(({theme:a,ownerState:o})=>_extends({},a.typography.body1,{color:(a.vars||a).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${inputBaseClasses$1.disabled}`]:{color:(a.vars||a).palette.text.disabled,cursor:"default"}},o.multiline&&_extends({padding:"4px 0 5px"},o.size==="small"&&{paddingTop:1}),o.fullWidth&&{width:"100%"})),InputBaseComponent=styled$1("input",{name:"MuiInputBase",slot:"Input",overridesResolver:inputOverridesResolver})(({theme:a,ownerState:o})=>{const _e=a.palette.mode==="light",et=_extends({color:"currentColor"},a.vars?{opacity:a.vars.opacity.inputPlaceholder}:{opacity:_e?.42:.5},{transition:a.transitions.create("opacity",{duration:a.transitions.duration.shorter})}),rt={opacity:"0 !important"},lt=a.vars?{opacity:a.vars.opacity.inputPlaceholder}:{opacity:_e?.42:.5};return _extends({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":et,"&::-moz-placeholder":et,"&:-ms-input-placeholder":et,"&::-ms-input-placeholder":et,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${inputBaseClasses$1.formControl} &`]:{"&::-webkit-input-placeholder":rt,"&::-moz-placeholder":rt,"&:-ms-input-placeholder":rt,"&::-ms-input-placeholder":rt,"&:focus::-webkit-input-placeholder":lt,"&:focus::-moz-placeholder":lt,"&:focus:-ms-input-placeholder":lt,"&:focus::-ms-input-placeholder":lt},[`&.${inputBaseClasses$1.disabled}`]:{opacity:1,WebkitTextFillColor:(a.vars||a).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},o.size==="small"&&{paddingTop:1},o.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},o.type==="search"&&{MozAppearance:"textfield"})}),inputGlobalStyles=jsxRuntimeExports.jsx(GlobalStyles,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),InputBase=reactExports.forwardRef(function(o,_e){var et;const rt=useThemeProps({props:o,name:"MuiInputBase"}),{"aria-describedby":lt,autoComplete:it,autoFocus:ut,className:s,components:tt={},componentsProps:ot={},defaultValue:ct,disabled:yt,disableInjectingGlobalStyles:pt,endAdornment:gt,fullWidth:st=!1,id:ft,inputComponent:at="input",inputProps:ht={},inputRef:mt,maxRows:St,minRows:It,multiline:xt=!1,name:At,onBlur:Nt,onChange:kt,onClick:Mt,onFocus:bt,onKeyDown:Bt,onKeyUp:Ht,placeholder:Wt,readOnly:nn,renderSuffix:gn,rows:tn,slotProps:Gt={},slots:fn={},startAdornment:Cn,type:Tn="text",value:dn}=rt,mn=_objectWithoutPropertiesLoose(rt,_excluded$n),yn=ht.value!=null?ht.value:dn,{current:pn}=reactExports.useRef(yn!=null),In=reactExports.useRef(),On=reactExports.useCallback(kn=>{},[]),_n=useForkRef(In,mt,ht.ref,On),[Mn,Nn]=reactExports.useState(!1),wn=useFormControl(),Pn=formControlState({props:rt,muiFormControl:wn,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Pn.focused=wn?wn.focused:Mn,reactExports.useEffect(()=>{!wn&&yt&&Mn&&(Nn(!1),Nt&&Nt())},[wn,yt,Mn,Nt]);const Fn=wn&&wn.onFilled,ar=wn&&wn.onEmpty,Yn=reactExports.useCallback(kn=>{isFilled(kn)?Fn&&Fn():ar&&ar()},[Fn,ar]);useEnhancedEffect$1(()=>{pn&&Yn({value:yn})},[yn,Yn,pn]);const Xn=kn=>{if(Pn.disabled){kn.stopPropagation();return}bt&&bt(kn),ht.onFocus&&ht.onFocus(kn),wn&&wn.onFocus?wn.onFocus(kn):Nn(!0)},tr=kn=>{Nt&&Nt(kn),ht.onBlur&&ht.onBlur(kn),wn&&wn.onBlur?wn.onBlur(kn):Nn(!1)},cn=(kn,...qt)=>{if(!pn){const Rt=kn.target||In.current;if(Rt==null)throw new Error(formatMuiErrorMessage(1));Yn({value:Rt.value})}ht.onChange&&ht.onChange(kn,...qt),kt&&kt(kn,...qt)};reactExports.useEffect(()=>{Yn(In.current)},[]);const Hn=kn=>{In.current&&kn.currentTarget===kn.target&&In.current.focus(),Mt&&!Pn.disabled&&Mt(kn)};let Qn=at,or=ht;xt&&Qn==="input"&&(tn?or=_extends({type:void 0,minRows:tn,maxRows:tn},or):or=_extends({type:void 0,maxRows:St,minRows:It},or),Qn=TextareaAutosize$1);const Wn=kn=>{Yn(kn.animationName==="mui-auto-fill-cancel"?In.current:{value:"x"})};reactExports.useEffect(()=>{wn&&wn.setAdornedStart(!!Cn)},[wn,Cn]);const ir=_extends({},rt,{color:Pn.color||"primary",disabled:Pn.disabled,endAdornment:gt,error:Pn.error,focused:Pn.focused,formControl:wn,fullWidth:st,hiddenLabel:Pn.hiddenLabel,multiline:xt,size:Pn.size,startAdornment:Cn,type:Tn}),nr=useUtilityClasses$k(ir),xn=fn.root||tt.Root||InputBaseRoot,Un=Gt.root||ot.root||{},vn=fn.input||tt.Input||InputBaseComponent;return or=_extends({},or,(et=Gt.input)!=null?et:ot.input),jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[!pt&&inputGlobalStyles,jsxRuntimeExports.jsxs(xn,_extends({},Un,!isHostComponent(xn)&&{ownerState:_extends({},ir,Un.ownerState)},{ref:_e,onClick:Hn},mn,{className:clsx(nr.root,Un.className,s,nn&&"MuiInputBase-readOnly"),children:[Cn,jsxRuntimeExports.jsx(FormControlContext$1.Provider,{value:null,children:jsxRuntimeExports.jsx(vn,_extends({ownerState:ir,"aria-invalid":Pn.error,"aria-describedby":lt,autoComplete:it,autoFocus:ut,defaultValue:ct,disabled:Pn.disabled,id:ft,onAnimationStart:Wn,name:At,placeholder:Wt,readOnly:nn,required:Pn.required,rows:tn,value:yn,onKeyDown:Bt,onKeyUp:Ht,type:Tn},or,!isHostComponent(vn)&&{as:Qn,ownerState:_extends({},ir,or.ownerState)},{ref:_n,className:clsx(nr.input,or.className,nn&&"MuiInputBase-readOnly"),onBlur:tr,onChange:cn,onFocus:Xn}))}),gt,gn?gn(_extends({},Pn,{startAdornment:Cn})):null]}))]})}),InputBase$1=InputBase;function getInputUtilityClass(a){return generateUtilityClass("MuiInput",a)}const inputClasses=_extends({},inputBaseClasses$1,generateUtilityClasses("MuiInput",["root","underline","input"])),inputClasses$1=inputClasses,_excluded$m=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],useUtilityClasses$j=a=>{const{classes:o,disableUnderline:_e}=a,rt=composeClasses({root:["root",!_e&&"underline"],input:["input"]},getInputUtilityClass,o);return _extends({},o,rt)},InputRoot=styled$1(InputBaseRoot,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiInput",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[...rootOverridesResolver(a,o),!_e.disableUnderline&&o.underline]}})(({theme:a,ownerState:o})=>{let et=a.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return a.vars&&(et=`rgba(${a.vars.palette.common.onBackgroundChannel} / ${a.vars.opacity.inputUnderline})`),_extends({position:"relative"},o.formControl&&{"label + &":{marginTop:16}},!o.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(a.vars||a).palette[o.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${inputClasses$1.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${inputClasses$1.error}`]:{"&:before, &:after":{borderBottomColor:(a.vars||a).palette.error.main}},"&:before":{borderBottom:`1px solid ${et}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:a.transitions.create("border-bottom-color",{duration:a.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${inputClasses$1.disabled}, .${inputClasses$1.error}):before`]:{borderBottom:`2px solid ${(a.vars||a).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${et}`}},[`&.${inputClasses$1.disabled}:before`]:{borderBottomStyle:"dotted"}})}),InputInput=styled$1(InputBaseComponent,{name:"MuiInput",slot:"Input",overridesResolver:inputOverridesResolver})({}),Input=reactExports.forwardRef(function(o,_e){var et,rt,lt,it;const ut=useThemeProps({props:o,name:"MuiInput"}),{disableUnderline:s,components:tt={},componentsProps:ot,fullWidth:ct=!1,inputComponent:yt="input",multiline:pt=!1,slotProps:gt,slots:st={},type:ft="text"}=ut,at=_objectWithoutPropertiesLoose(ut,_excluded$m),ht=useUtilityClasses$j(ut),St={root:{ownerState:{disableUnderline:s}}},It=gt??ot?deepmerge(gt??ot,St):St,xt=(et=(rt=st.root)!=null?rt:tt.Root)!=null?et:InputRoot,At=(lt=(it=st.input)!=null?it:tt.Input)!=null?lt:InputInput;return jsxRuntimeExports.jsx(InputBase$1,_extends({slots:{root:xt,input:At},slotProps:It,fullWidth:ct,inputComponent:yt,multiline:pt,ref:_e,type:ft},at,{classes:ht}))});Input.muiName="Input";const Input$1=Input;function getFilledInputUtilityClass(a){return generateUtilityClass("MuiFilledInput",a)}const filledInputClasses=_extends({},inputBaseClasses$1,generateUtilityClasses("MuiFilledInput",["root","underline","input"])),filledInputClasses$1=filledInputClasses,_excluded$l=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],useUtilityClasses$i=a=>{const{classes:o,disableUnderline:_e}=a,rt=composeClasses({root:["root",!_e&&"underline"],input:["input"]},getFilledInputUtilityClass,o);return _extends({},o,rt)},FilledInputRoot=styled$1(InputBaseRoot,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[...rootOverridesResolver(a,o),!_e.disableUnderline&&o.underline]}})(({theme:a,ownerState:o})=>{var _e;const et=a.palette.mode==="light",rt=et?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",lt=et?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",it=et?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",ut=et?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return _extends({position:"relative",backgroundColor:a.vars?a.vars.palette.FilledInput.bg:lt,borderTopLeftRadius:(a.vars||a).shape.borderRadius,borderTopRightRadius:(a.vars||a).shape.borderRadius,transition:a.transitions.create("background-color",{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut}),"&:hover":{backgroundColor:a.vars?a.vars.palette.FilledInput.hoverBg:it,"@media (hover: none)":{backgroundColor:a.vars?a.vars.palette.FilledInput.bg:lt}},[`&.${filledInputClasses$1.focused}`]:{backgroundColor:a.vars?a.vars.palette.FilledInput.bg:lt},[`&.${filledInputClasses$1.disabled}`]:{backgroundColor:a.vars?a.vars.palette.FilledInput.disabledBg:ut}},!o.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(_e=(a.vars||a).palette[o.color||"primary"])==null?void 0:_e.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${filledInputClasses$1.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${filledInputClasses$1.error}`]:{"&:before, &:after":{borderBottomColor:(a.vars||a).palette.error.main}},"&:before":{borderBottom:`1px solid ${a.vars?`rgba(${a.vars.palette.common.onBackgroundChannel} / ${a.vars.opacity.inputUnderline})`:rt}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:a.transitions.create("border-bottom-color",{duration:a.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${filledInputClasses$1.disabled}, .${filledInputClasses$1.error}):before`]:{borderBottom:`1px solid ${(a.vars||a).palette.text.primary}`},[`&.${filledInputClasses$1.disabled}:before`]:{borderBottomStyle:"dotted"}},o.startAdornment&&{paddingLeft:12},o.endAdornment&&{paddingRight:12},o.multiline&&_extends({padding:"25px 12px 8px"},o.size==="small"&&{paddingTop:21,paddingBottom:4},o.hiddenLabel&&{paddingTop:16,paddingBottom:17}))}),FilledInputInput=styled$1(InputBaseComponent,{name:"MuiFilledInput",slot:"Input",overridesResolver:inputOverridesResolver})(({theme:a,ownerState:o})=>_extends({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!a.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:a.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:a.palette.mode==="light"?null:"#fff",caretColor:a.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},a.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[a.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},o.size==="small"&&{paddingTop:21,paddingBottom:4},o.hiddenLabel&&{paddingTop:16,paddingBottom:17},o.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0},o.startAdornment&&{paddingLeft:0},o.endAdornment&&{paddingRight:0},o.hiddenLabel&&o.size==="small"&&{paddingTop:8,paddingBottom:9})),FilledInput=reactExports.forwardRef(function(o,_e){var et,rt,lt,it;const ut=useThemeProps({props:o,name:"MuiFilledInput"}),{components:s={},componentsProps:tt,fullWidth:ot=!1,inputComponent:ct="input",multiline:yt=!1,slotProps:pt,slots:gt={},type:st="text"}=ut,ft=_objectWithoutPropertiesLoose(ut,_excluded$l),at=_extends({},ut,{fullWidth:ot,inputComponent:ct,multiline:yt,type:st}),ht=useUtilityClasses$i(ut),mt={root:{ownerState:at},input:{ownerState:at}},St=pt??tt?deepmerge(pt??tt,mt):mt,It=(et=(rt=gt.root)!=null?rt:s.Root)!=null?et:FilledInputRoot,xt=(lt=(it=gt.input)!=null?it:s.Input)!=null?lt:FilledInputInput;return jsxRuntimeExports.jsx(InputBase$1,_extends({slots:{root:It,input:xt},componentsProps:St,fullWidth:ot,inputComponent:ct,multiline:yt,ref:_e,type:st},ft,{classes:ht}))});FilledInput.muiName="Input";const FilledInput$1=FilledInput;var _span;const _excluded$k=["children","classes","className","label","notched"],NotchedOutlineRoot$1=styled$1("fieldset")({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),NotchedOutlineLegend=styled$1("legend")(({ownerState:a,theme:o})=>_extends({float:"unset",width:"auto",overflow:"hidden"},!a.withLabel&&{padding:0,lineHeight:"11px",transition:o.transitions.create("width",{duration:150,easing:o.transitions.easing.easeOut})},a.withLabel&&_extends({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:o.transitions.create("max-width",{duration:50,easing:o.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},a.notched&&{maxWidth:"100%",transition:o.transitions.create("max-width",{duration:100,easing:o.transitions.easing.easeOut,delay:50})})));function NotchedOutline(a){const{className:o,label:_e,notched:et}=a,rt=_objectWithoutPropertiesLoose(a,_excluded$k),lt=_e!=null&&_e!=="",it=_extends({},a,{notched:et,withLabel:lt});return jsxRuntimeExports.jsx(NotchedOutlineRoot$1,_extends({"aria-hidden":!0,className:o,ownerState:it},rt,{children:jsxRuntimeExports.jsx(NotchedOutlineLegend,{ownerState:it,children:lt?jsxRuntimeExports.jsx("span",{children:_e}):_span||(_span=jsxRuntimeExports.jsx("span",{className:"notranslate",children:""}))})}))}function getOutlinedInputUtilityClass(a){return generateUtilityClass("MuiOutlinedInput",a)}const outlinedInputClasses=_extends({},inputBaseClasses$1,generateUtilityClasses("MuiOutlinedInput",["root","notchedOutline","input"])),outlinedInputClasses$1=outlinedInputClasses,_excluded$j=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],useUtilityClasses$h=a=>{const{classes:o}=a,et=composeClasses({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},getOutlinedInputUtilityClass,o);return _extends({},o,et)},OutlinedInputRoot=styled$1(InputBaseRoot,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:rootOverridesResolver})(({theme:a,ownerState:o})=>{const _e=a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return _extends({position:"relative",borderRadius:(a.vars||a).shape.borderRadius,[`&:hover .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:(a.vars||a).palette.text.primary},"@media (hover: none)":{[`&:hover .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:a.vars?`rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:_e}},[`&.${outlinedInputClasses$1.focused} .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:(a.vars||a).palette[o.color].main,borderWidth:2},[`&.${outlinedInputClasses$1.error} .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:(a.vars||a).palette.error.main},[`&.${outlinedInputClasses$1.disabled} .${outlinedInputClasses$1.notchedOutline}`]:{borderColor:(a.vars||a).palette.action.disabled}},o.startAdornment&&{paddingLeft:14},o.endAdornment&&{paddingRight:14},o.multiline&&_extends({padding:"16.5px 14px"},o.size==="small"&&{padding:"8.5px 14px"}))}),NotchedOutlineRoot=styled$1(NotchedOutline,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(a,o)=>o.notchedOutline})(({theme:a})=>{const o=a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:a.vars?`rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:o}}),OutlinedInputInput=styled$1(InputBaseComponent,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:inputOverridesResolver})(({theme:a,ownerState:o})=>_extends({padding:"16.5px 14px"},!a.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:a.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:a.palette.mode==="light"?null:"#fff",caretColor:a.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},a.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[a.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},o.size==="small"&&{padding:"8.5px 14px"},o.multiline&&{padding:0},o.startAdornment&&{paddingLeft:0},o.endAdornment&&{paddingRight:0})),OutlinedInput=reactExports.forwardRef(function(o,_e){var et,rt,lt,it,ut;const s=useThemeProps({props:o,name:"MuiOutlinedInput"}),{components:tt={},fullWidth:ot=!1,inputComponent:ct="input",label:yt,multiline:pt=!1,notched:gt,slots:st={},type:ft="text"}=s,at=_objectWithoutPropertiesLoose(s,_excluded$j),ht=useUtilityClasses$h(s),mt=useFormControl(),St=formControlState({props:s,muiFormControl:mt,states:["required"]}),It=_extends({},s,{color:St.color||"primary",disabled:St.disabled,error:St.error,focused:St.focused,formControl:mt,fullWidth:ot,hiddenLabel:St.hiddenLabel,multiline:pt,size:St.size,type:ft}),xt=(et=(rt=st.root)!=null?rt:tt.Root)!=null?et:OutlinedInputRoot,At=(lt=(it=st.input)!=null?it:tt.Input)!=null?lt:OutlinedInputInput;return jsxRuntimeExports.jsx(InputBase$1,_extends({slots:{root:xt,input:At},renderSuffix:Nt=>jsxRuntimeExports.jsx(NotchedOutlineRoot,{ownerState:It,className:ht.notchedOutline,label:yt!=null&&yt!==""&&St.required?ut||(ut=jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[yt,"","*"]})):yt,notched:typeof gt<"u"?gt:!!(Nt.startAdornment||Nt.filled||Nt.focused)}),fullWidth:ot,inputComponent:ct,multiline:pt,ref:_e,type:ft},at,{classes:_extends({},ht,{notchedOutline:null})}))});OutlinedInput.muiName="Input";const OutlinedInput$1=OutlinedInput,_excluded$i=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],useUtilityClasses$g=a=>{const{classes:o}=a;return o},styledRootConfig={name:"MuiSelect",overridesResolver:(a,o)=>o.root,shouldForwardProp:a=>rootShouldForwardProp(a)&&a!=="variant",slot:"Root"},StyledInput=styled$1(Input$1,styledRootConfig)(""),StyledOutlinedInput=styled$1(OutlinedInput$1,styledRootConfig)(""),StyledFilledInput=styled$1(FilledInput$1,styledRootConfig)(""),Select=reactExports.forwardRef(function(o,_e){const et=useThemeProps({name:"MuiSelect",props:o}),{autoWidth:rt=!1,children:lt,classes:it={},className:ut,defaultOpen:s=!1,displayEmpty:tt=!1,IconComponent:ot=ArrowDropDownIcon,id:ct,input:yt,inputProps:pt,label:gt,labelId:st,MenuProps:ft,multiple:at=!1,native:ht=!1,onClose:mt,onOpen:St,open:It,renderValue:xt,SelectDisplayProps:At,variant:Nt="outlined"}=et,kt=_objectWithoutPropertiesLoose(et,_excluded$i),Mt=ht?NativeSelectInput$1:SelectInput$1,bt=useFormControl(),Bt=formControlState({props:et,muiFormControl:bt,states:["variant","error"]}),Ht=Bt.variant||Nt,Wt=_extends({},et,{variant:Ht,classes:it}),nn=useUtilityClasses$g(Wt),gn=yt||{standard:jsxRuntimeExports.jsx(StyledInput,{ownerState:Wt}),outlined:jsxRuntimeExports.jsx(StyledOutlinedInput,{label:gt,ownerState:Wt}),filled:jsxRuntimeExports.jsx(StyledFilledInput,{ownerState:Wt})}[Ht],tn=useForkRef(_e,gn.ref);return jsxRuntimeExports.jsx(reactExports.Fragment,{children:reactExports.cloneElement(gn,_extends({inputComponent:Mt,inputProps:_extends({children:lt,error:Bt.error,IconComponent:ot,variant:Ht,type:void 0,multiple:at},ht?{id:ct}:{autoWidth:rt,defaultOpen:s,displayEmpty:tt,labelId:st,MenuProps:ft,onClose:mt,onOpen:St,open:It,renderValue:xt,SelectDisplayProps:_extends({id:ct},At)},pt,{classes:pt?deepmerge(nn,pt.classes):nn},yt?yt.props.inputProps:{})},at&&ht&&Ht==="outlined"?{notched:!0}:{},{ref:tn,className:clsx(gn.props.className,ut)},!yt&&{variant:Ht},kt))})});Select.muiName="Select";const Select$1=Select;function getFormControlLabelUtilityClasses(a){return generateUtilityClass("MuiFormControlLabel",a)}const formControlLabelClasses=generateUtilityClasses("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),formControlLabelClasses$1=formControlLabelClasses,_excluded$h=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],useUtilityClasses$f=a=>{const{classes:o,disabled:_e,labelPlacement:et,error:rt,required:lt}=a,it={root:["root",_e&&"disabled",`labelPlacement${capitalize(et)}`,rt&&"error",lt&&"required"],label:["label",_e&&"disabled"],asterisk:["asterisk",rt&&"error"]};return composeClasses(it,getFormControlLabelUtilityClasses,o)},FormControlLabelRoot=styled$1("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[{[`& .${formControlLabelClasses$1.label}`]:o.label},o.root,o[`labelPlacement${capitalize(_e.labelPlacement)}`]]}})(({theme:a,ownerState:o})=>_extends({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${formControlLabelClasses$1.disabled}`]:{cursor:"default"}},o.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},o.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},o.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${formControlLabelClasses$1.label}`]:{[`&.${formControlLabelClasses$1.disabled}`]:{color:(a.vars||a).palette.text.disabled}}})),AsteriskComponent=styled$1("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(a,o)=>o.asterisk})(({theme:a})=>({[`&.${formControlLabelClasses$1.error}`]:{color:(a.vars||a).palette.error.main}})),FormControlLabel=reactExports.forwardRef(function(o,_e){var et,rt;const lt=useThemeProps({props:o,name:"MuiFormControlLabel"}),{className:it,componentsProps:ut={},control:s,disabled:tt,disableTypography:ot,label:ct,labelPlacement:yt="end",required:pt,slotProps:gt={}}=lt,st=_objectWithoutPropertiesLoose(lt,_excluded$h),ft=useFormControl(),at=(et=tt??s.props.disabled)!=null?et:ft==null?void 0:ft.disabled,ht=pt??s.props.required,mt={disabled:at,required:ht};["checked","name","onChange","value","inputRef"].forEach(kt=>{typeof s.props[kt]>"u"&&typeof lt[kt]<"u"&&(mt[kt]=lt[kt])});const St=formControlState({props:lt,muiFormControl:ft,states:["error"]}),It=_extends({},lt,{disabled:at,labelPlacement:yt,required:ht,error:St.error}),xt=useUtilityClasses$f(It),At=(rt=gt.typography)!=null?rt:ut.typography;let Nt=ct;return Nt!=null&&Nt.type!==Typography$1&&!ot&&(Nt=jsxRuntimeExports.jsx(Typography$1,_extends({component:"span"},At,{className:clsx(xt.label,At==null?void 0:At.className),children:Nt}))),jsxRuntimeExports.jsxs(FormControlLabelRoot,_extends({className:clsx(xt.root,it),ownerState:It,ref:_e},st,{children:[reactExports.cloneElement(s,mt),Nt,ht&&jsxRuntimeExports.jsxs(AsteriskComponent,{ownerState:It,"aria-hidden":!0,className:xt.asterisk,children:["","*"]})]}))}),FormControlLabel$1=FormControlLabel;function getSwitchBaseUtilityClass(a){return generateUtilityClass("PrivateSwitchBase",a)}generateUtilityClasses("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const _excluded$g=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],useUtilityClasses$e=a=>{const{classes:o,checked:_e,disabled:et,edge:rt}=a,lt={root:["root",_e&&"checked",et&&"disabled",rt&&`edge${capitalize(rt)}`],input:["input"]};return composeClasses(lt,getSwitchBaseUtilityClass,o)},SwitchBaseRoot=styled$1(ButtonBase$1)(({ownerState:a})=>_extends({padding:9,borderRadius:"50%"},a.edge==="start"&&{marginLeft:a.size==="small"?-3:-12},a.edge==="end"&&{marginRight:a.size==="small"?-3:-12})),SwitchBaseInput=styled$1("input")({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),SwitchBase=reactExports.forwardRef(function(o,_e){const{autoFocus:et,checked:rt,checkedIcon:lt,className:it,defaultChecked:ut,disabled:s,disableFocusRipple:tt=!1,edge:ot=!1,icon:ct,id:yt,inputProps:pt,inputRef:gt,name:st,onBlur:ft,onChange:at,onFocus:ht,readOnly:mt,required:St=!1,tabIndex:It,type:xt,value:At}=o,Nt=_objectWithoutPropertiesLoose(o,_excluded$g),[kt,Mt]=useControlled({controlled:rt,default:!!ut,name:"SwitchBase",state:"checked"}),bt=useFormControl(),Bt=fn=>{ht&&ht(fn),bt&&bt.onFocus&&bt.onFocus(fn)},Ht=fn=>{ft&&ft(fn),bt&&bt.onBlur&&bt.onBlur(fn)},Wt=fn=>{if(fn.nativeEvent.defaultPrevented)return;const Cn=fn.target.checked;Mt(Cn),at&&at(fn,Cn)};let nn=s;bt&&typeof nn>"u"&&(nn=bt.disabled);const gn=xt==="checkbox"||xt==="radio",tn=_extends({},o,{checked:kt,disabled:nn,disableFocusRipple:tt,edge:ot}),Gt=useUtilityClasses$e(tn);return jsxRuntimeExports.jsxs(SwitchBaseRoot,_extends({component:"span",className:clsx(Gt.root,it),centerRipple:!0,focusRipple:!tt,disabled:nn,tabIndex:null,role:void 0,onFocus:Bt,onBlur:Ht,ownerState:tn,ref:_e},Nt,{children:[jsxRuntimeExports.jsx(SwitchBaseInput,_extends({autoFocus:et,checked:rt,defaultChecked:ut,className:Gt.input,disabled:nn,id:gn?yt:void 0,name:st,onChange:Wt,readOnly:mt,ref:gt,required:St,ownerState:tn,tabIndex:It,type:xt},xt==="checkbox"&&At===void 0?{}:{value:At},pt)),kt?lt:ct]}))}),SwitchBase$1=SwitchBase;function getFormGroupUtilityClass(a){return generateUtilityClass("MuiFormGroup",a)}generateUtilityClasses("MuiFormGroup",["root","row","error"]);const _excluded$f=["className","row"],useUtilityClasses$d=a=>{const{classes:o,row:_e,error:et}=a;return composeClasses({root:["root",_e&&"row",et&&"error"]},getFormGroupUtilityClass,o)},FormGroupRoot=styled$1("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.row&&o.row]}})(({ownerState:a})=>_extends({display:"flex",flexDirection:"column",flexWrap:"wrap"},a.row&&{flexDirection:"row"})),FormGroup=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiFormGroup"}),{className:rt,row:lt=!1}=et,it=_objectWithoutPropertiesLoose(et,_excluded$f),ut=useFormControl(),s=formControlState({props:et,muiFormControl:ut,states:["error"]}),tt=_extends({},et,{row:lt,error:s.error}),ot=useUtilityClasses$d(tt);return jsxRuntimeExports.jsx(FormGroupRoot,_extends({className:clsx(ot.root,rt),ownerState:tt,ref:_e},it))}),FormGroup$1=FormGroup;function getUnit(a){return String(a).match(/[\d.\-+]*\s*(.*)/)[1]||""}function toUnitless(a){return parseFloat(a)}const _excluded$e=["theme"];function ThemeProvider(a){let{theme:o}=a,_e=_objectWithoutPropertiesLoose(a,_excluded$e);const et=o[THEME_ID];return jsxRuntimeExports.jsx(ThemeProvider$1,_extends({},_e,{themeId:et?THEME_ID:void 0,theme:et||o}))}const defaultTheme=createTheme(),Box=createBox({themeId:THEME_ID,defaultTheme,defaultClassName:"MuiBox-root",generateClassName:ClassNameGenerator$1.generate}),Box$1=Box;function getIconUtilityClass(a){return generateUtilityClass("MuiIcon",a)}generateUtilityClasses("MuiIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const _excluded$d=["baseClassName","className","color","component","fontSize"],useUtilityClasses$c=a=>{const{color:o,fontSize:_e,classes:et}=a,rt={root:["root",o!=="inherit"&&`color${capitalize(o)}`,`fontSize${capitalize(_e)}`]};return composeClasses(rt,getIconUtilityClass,et)},IconRoot=styled$1("span",{name:"MuiIcon",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.color!=="inherit"&&o[`color${capitalize(_e.color)}`],o[`fontSize${capitalize(_e.fontSize)}`]]}})(({theme:a,ownerState:o})=>({userSelect:"none",width:"1em",height:"1em",overflow:"hidden",display:"inline-block",textAlign:"center",flexShrink:0,fontSize:{inherit:"inherit",small:a.typography.pxToRem(20),medium:a.typography.pxToRem(24),large:a.typography.pxToRem(36)}[o.fontSize],color:{primary:(a.vars||a).palette.primary.main,secondary:(a.vars||a).palette.secondary.main,info:(a.vars||a).palette.info.main,success:(a.vars||a).palette.success.main,warning:(a.vars||a).palette.warning.main,action:(a.vars||a).palette.action.active,error:(a.vars||a).palette.error.main,disabled:(a.vars||a).palette.action.disabled,inherit:void 0}[o.color]})),Icon=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiIcon"}),{baseClassName:rt="material-icons",className:lt,color:it="inherit",component:ut="span",fontSize:s="medium"}=et,tt=_objectWithoutPropertiesLoose(et,_excluded$d),ot=_extends({},et,{baseClassName:rt,color:it,component:ut,fontSize:s}),ct=useUtilityClasses$c(ot);return jsxRuntimeExports.jsx(IconRoot,_extends({as:ut,className:clsx(rt,"notranslate",ct.root,lt),ownerState:ot,"aria-hidden":!0,ref:_e},tt))});Icon.muiName="Icon";const Icon$1=Icon;function getIconButtonUtilityClass(a){return generateUtilityClass("MuiIconButton",a)}const iconButtonClasses=generateUtilityClasses("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),iconButtonClasses$1=iconButtonClasses,_excluded$c=["edge","children","className","color","disabled","disableFocusRipple","size"],useUtilityClasses$b=a=>{const{classes:o,disabled:_e,color:et,edge:rt,size:lt}=a,it={root:["root",_e&&"disabled",et!=="default"&&`color${capitalize(et)}`,rt&&`edge${capitalize(rt)}`,`size${capitalize(lt)}`]};return composeClasses(it,getIconButtonUtilityClass,o)},IconButtonRoot=styled$1(ButtonBase$1,{name:"MuiIconButton",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.color!=="default"&&o[`color${capitalize(_e.color)}`],_e.edge&&o[`edge${capitalize(_e.edge)}`],o[`size${capitalize(_e.size)}`]]}})(({theme:a,ownerState:o})=>_extends({textAlign:"center",flex:"0 0 auto",fontSize:a.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(a.vars||a).palette.action.active,transition:a.transitions.create("background-color",{duration:a.transitions.duration.shortest})},!o.disableRipple&&{"&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.activeChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette.action.active,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},o.edge==="start"&&{marginLeft:o.size==="small"?-3:-12},o.edge==="end"&&{marginRight:o.size==="small"?-3:-12}),({theme:a,ownerState:o})=>{var _e;const et=(_e=(a.vars||a).palette)==null?void 0:_e[o.color];return _extends({},o.color==="inherit"&&{color:"inherit"},o.color!=="inherit"&&o.color!=="default"&&_extends({color:et==null?void 0:et.main},!o.disableRipple&&{"&:hover":_extends({},et&&{backgroundColor:a.vars?`rgba(${et.mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(et.main,a.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),o.size==="small"&&{padding:5,fontSize:a.typography.pxToRem(18)},o.size==="large"&&{padding:12,fontSize:a.typography.pxToRem(28)},{[`&.${iconButtonClasses$1.disabled}`]:{backgroundColor:"transparent",color:(a.vars||a).palette.action.disabled}})}),IconButton=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiIconButton"}),{edge:rt=!1,children:lt,className:it,color:ut="default",disabled:s=!1,disableFocusRipple:tt=!1,size:ot="medium"}=et,ct=_objectWithoutPropertiesLoose(et,_excluded$c),yt=_extends({},et,{edge:rt,color:ut,disabled:s,disableFocusRipple:tt,size:ot}),pt=useUtilityClasses$b(yt);return jsxRuntimeExports.jsx(IconButtonRoot,_extends({className:clsx(pt.root,it),centerRipple:!0,focusRipple:!tt,disabled:s,ref:_e,ownerState:yt},ct,{children:lt}))}),IconButton$1=IconButton,_excluded$b=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],PopperRoot=styled$1(BasePopper,{name:"MuiPopper",slot:"Root",overridesResolver:(a,o)=>o.root})({}),Popper=reactExports.forwardRef(function(o,_e){var et;const rt=useTheme$3(),lt=useThemeProps({props:o,name:"MuiPopper"}),{anchorEl:it,component:ut,components:s,componentsProps:tt,container:ot,disablePortal:ct,keepMounted:yt,modifiers:pt,open:gt,placement:st,popperOptions:ft,popperRef:at,transition:ht,slots:mt,slotProps:St}=lt,It=_objectWithoutPropertiesLoose(lt,_excluded$b),xt=(et=mt==null?void 0:mt.root)!=null?et:s==null?void 0:s.Root,At=_extends({anchorEl:it,container:ot,disablePortal:ct,keepMounted:yt,modifiers:pt,open:gt,placement:st,popperOptions:ft,popperRef:at,transition:ht},It);return jsxRuntimeExports.jsx(PopperRoot,_extends({as:ut,direction:rt==null?void 0:rt.direction,slots:{root:xt},slotProps:St??tt},At,{ref:_e}))}),Popper$1=Popper;function getTooltipUtilityClass(a){return generateUtilityClass("MuiTooltip",a)}const tooltipClasses=generateUtilityClasses("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),tooltipClasses$1=tooltipClasses,_excluded$a=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];function round(a){return Math.round(a*1e5)/1e5}const useUtilityClasses$a=a=>{const{classes:o,disableInteractive:_e,arrow:et,touch:rt,placement:lt}=a,it={popper:["popper",!_e&&"popperInteractive",et&&"popperArrow"],tooltip:["tooltip",et&&"tooltipArrow",rt&&"touch",`tooltipPlacement${capitalize(lt.split("-")[0])}`],arrow:["arrow"]};return composeClasses(it,getTooltipUtilityClass,o)},TooltipPopper=styled$1(Popper$1,{name:"MuiTooltip",slot:"Popper",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.popper,!_e.disableInteractive&&o.popperInteractive,_e.arrow&&o.popperArrow,!_e.open&&o.popperClose]}})(({theme:a,ownerState:o,open:_e})=>_extends({zIndex:(a.vars||a).zIndex.tooltip,pointerEvents:"none"},!o.disableInteractive&&{pointerEvents:"auto"},!_e&&{pointerEvents:"none"},o.arrow&&{[`&[data-popper-placement*="bottom"] .${tooltipClasses$1.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${tooltipClasses$1.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${tooltipClasses$1.arrow}`]:_extends({},o.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${tooltipClasses$1.arrow}`]:_extends({},o.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})),TooltipTooltip=styled$1("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.tooltip,_e.touch&&o.touch,_e.arrow&&o.tooltipArrow,o[`tooltipPlacement${capitalize(_e.placement.split("-")[0])}`]]}})(({theme:a,ownerState:o})=>_extends({backgroundColor:a.vars?a.vars.palette.Tooltip.bg:alpha(a.palette.grey[700],.92),borderRadius:(a.vars||a).shape.borderRadius,color:(a.vars||a).palette.common.white,fontFamily:a.typography.fontFamily,padding:"4px 8px",fontSize:a.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:a.typography.fontWeightMedium},o.arrow&&{position:"relative",margin:0},o.touch&&{padding:"8px 16px",fontSize:a.typography.pxToRem(14),lineHeight:`${round(16/14)}em`,fontWeight:a.typography.fontWeightRegular},{[`.${tooltipClasses$1.popper}[data-popper-placement*="left"] &`]:_extends({transformOrigin:"right center"},o.isRtl?_extends({marginLeft:"14px"},o.touch&&{marginLeft:"24px"}):_extends({marginRight:"14px"},o.touch&&{marginRight:"24px"})),[`.${tooltipClasses$1.popper}[data-popper-placement*="right"] &`]:_extends({transformOrigin:"left center"},o.isRtl?_extends({marginRight:"14px"},o.touch&&{marginRight:"24px"}):_extends({marginLeft:"14px"},o.touch&&{marginLeft:"24px"})),[`.${tooltipClasses$1.popper}[data-popper-placement*="top"] &`]:_extends({transformOrigin:"center bottom",marginBottom:"14px"},o.touch&&{marginBottom:"24px"}),[`.${tooltipClasses$1.popper}[data-popper-placement*="bottom"] &`]:_extends({transformOrigin:"center top",marginTop:"14px"},o.touch&&{marginTop:"24px"})})),TooltipArrow=styled$1("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(a,o)=>o.arrow})(({theme:a})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:a.vars?a.vars.palette.Tooltip.bg:alpha(a.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}));let hystersisOpen=!1,hystersisTimer=null,cursorPosition={x:0,y:0};function composeEventHandler(a,o){return _e=>{o&&o(_e),a(_e)}}const Tooltip=reactExports.forwardRef(function(o,_e){var et,rt,lt,it,ut,s,tt,ot,ct,yt,pt,gt,st,ft,at,ht,mt,St,It;const xt=useThemeProps({props:o,name:"MuiTooltip"}),{arrow:At=!1,children:Nt,components:kt={},componentsProps:Mt={},describeChild:bt=!1,disableFocusListener:Bt=!1,disableHoverListener:Ht=!1,disableInteractive:Wt=!1,disableTouchListener:nn=!1,enterDelay:gn=100,enterNextDelay:tn=0,enterTouchDelay:Gt=700,followCursor:fn=!1,id:Cn,leaveDelay:Tn=0,leaveTouchDelay:dn=1500,onClose:mn,onOpen:yn,open:pn,placement:In="bottom",PopperComponent:On,PopperProps:_n={},slotProps:Mn={},slots:Nn={},title:wn,TransitionComponent:Pn=Grow$1,TransitionProps:Fn}=xt,ar=_objectWithoutPropertiesLoose(xt,_excluded$a),Yn=useTheme(),Xn=Yn.direction==="rtl",[tr,cn]=reactExports.useState(),[Hn,Qn]=reactExports.useState(null),or=reactExports.useRef(!1),Wn=Wt||fn,ir=reactExports.useRef(),nr=reactExports.useRef(),xn=reactExports.useRef(),Un=reactExports.useRef(),[vn,kn]=useControlled({controlled:pn,default:!1,name:"Tooltip",state:"open"});let qt=vn;const Rt=useId(Cn),nt=reactExports.useRef(),vt=reactExports.useCallback(()=>{nt.current!==void 0&&(document.body.style.WebkitUserSelect=nt.current,nt.current=void 0),clearTimeout(Un.current)},[]);reactExports.useEffect(()=>()=>{clearTimeout(ir.current),clearTimeout(nr.current),clearTimeout(xn.current),vt()},[vt]);const Tt=zn=>{clearTimeout(hystersisTimer),hystersisOpen=!0,kn(!0),yn&&!qt&&yn(zn)},Pt=useEventCallback(zn=>{clearTimeout(hystersisTimer),hystersisTimer=setTimeout(()=>{hystersisOpen=!1},800+Tn),kn(!1),mn&&qt&&mn(zn),clearTimeout(ir.current),ir.current=setTimeout(()=>{or.current=!1},Yn.transitions.duration.shortest)}),wt=zn=>{or.current&&zn.type!=="touchstart"||(tr&&tr.removeAttribute("title"),clearTimeout(nr.current),clearTimeout(xn.current),gn||hystersisOpen&&tn?nr.current=setTimeout(()=>{Tt(zn)},hystersisOpen?tn:gn):Tt(zn))},Dt=zn=>{clearTimeout(nr.current),clearTimeout(xn.current),xn.current=setTimeout(()=>{Pt(zn)},Tn)},{isFocusVisibleRef:Et,onBlur:jt,onFocus:Yt,ref:en}=useIsFocusVisible(),[,Kt]=reactExports.useState(!1),rn=zn=>{jt(zn),Et.current===!1&&(Kt(!1),Dt(zn))},hn=zn=>{tr||cn(zn.currentTarget),Yt(zn),Et.current===!0&&(Kt(!0),wt(zn))},an=zn=>{or.current=!0;const Zn=Nt.props;Zn.onTouchStart&&Zn.onTouchStart(zn)},un=wt,Sn=Dt,En=zn=>{an(zn),clearTimeout(xn.current),clearTimeout(ir.current),vt(),nt.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",Un.current=setTimeout(()=>{document.body.style.WebkitUserSelect=nt.current,wt(zn)},Gt)},An=zn=>{Nt.props.onTouchEnd&&Nt.props.onTouchEnd(zn),vt(),clearTimeout(xn.current),xn.current=setTimeout(()=>{Pt(zn)},dn)};reactExports.useEffect(()=>{if(!qt)return;function zn(Zn){(Zn.key==="Escape"||Zn.key==="Esc")&&Pt(Zn)}return document.addEventListener("keydown",zn),()=>{document.removeEventListener("keydown",zn)}},[Pt,qt]);const Dn=useForkRef(Nt.ref,en,cn,_e);!wn&&wn!==0&&(qt=!1);const Bn=reactExports.useRef(),sr=zn=>{const Zn=Nt.props;Zn.onMouseMove&&Zn.onMouseMove(zn),cursorPosition={x:zn.clientX,y:zn.clientY},Bn.current&&Bn.current.update()},fr={},Cr=typeof wn=="string";bt?(fr.title=!qt&&Cr&&!Ht?wn:null,fr["aria-describedby"]=qt?Rt:null):(fr["aria-label"]=Cr?wn:null,fr["aria-labelledby"]=qt&&!Cr?Rt:null);const gr=_extends({},fr,ar,Nt.props,{className:clsx(ar.className,Nt.props.className),onTouchStart:an,ref:Dn},fn?{onMouseMove:sr}:{}),wr={};nn||(gr.onTouchStart=En,gr.onTouchEnd=An),Ht||(gr.onMouseOver=composeEventHandler(un,gr.onMouseOver),gr.onMouseLeave=composeEventHandler(Sn,gr.onMouseLeave),Wn||(wr.onMouseOver=un,wr.onMouseLeave=Sn)),Bt||(gr.onFocus=composeEventHandler(hn,gr.onFocus),gr.onBlur=composeEventHandler(rn,gr.onBlur),Wn||(wr.onFocus=hn,wr.onBlur=rn));const Nr=reactExports.useMemo(()=>{var zn;let Zn=[{name:"arrow",enabled:!!Hn,options:{element:Hn,padding:4}}];return(zn=_n.popperOptions)!=null&&zn.modifiers&&(Zn=Zn.concat(_n.popperOptions.modifiers)),_extends({},_n.popperOptions,{modifiers:Zn})},[Hn,_n]),qr=_extends({},xt,{isRtl:Xn,arrow:At,disableInteractive:Wn,placement:In,PopperComponentProp:On,touch:or.current}),Qr=useUtilityClasses$a(qr),Sr=(et=(rt=Nn.popper)!=null?rt:kt.Popper)!=null?et:TooltipPopper,Dr=(lt=(it=(ut=Nn.transition)!=null?ut:kt.Transition)!=null?it:Pn)!=null?lt:Grow$1,Er=(s=(tt=Nn.tooltip)!=null?tt:kt.Tooltip)!=null?s:TooltipTooltip,Or=(ot=(ct=Nn.arrow)!=null?ct:kt.Arrow)!=null?ot:TooltipArrow,Lr=appendOwnerState(Sr,_extends({},_n,(yt=Mn.popper)!=null?yt:Mt.popper,{className:clsx(Qr.popper,_n==null?void 0:_n.className,(pt=(gt=Mn.popper)!=null?gt:Mt.popper)==null?void 0:pt.className)}),qr),Hr=appendOwnerState(Dr,_extends({},Fn,(st=Mn.transition)!=null?st:Mt.transition),qr),na=appendOwnerState(Er,_extends({},(ft=Mn.tooltip)!=null?ft:Mt.tooltip,{className:clsx(Qr.tooltip,(at=(ht=Mn.tooltip)!=null?ht:Mt.tooltip)==null?void 0:at.className)}),qr),Vn=appendOwnerState(Or,_extends({},(mt=Mn.arrow)!=null?mt:Mt.arrow,{className:clsx(Qr.arrow,(St=(It=Mn.arrow)!=null?It:Mt.arrow)==null?void 0:St.className)}),qr);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[reactExports.cloneElement(Nt,gr),jsxRuntimeExports.jsx(Sr,_extends({as:On??Popper$1,placement:In,anchorEl:fn?{getBoundingClientRect:()=>({top:cursorPosition.y,left:cursorPosition.x,right:cursorPosition.x,bottom:cursorPosition.y,width:0,height:0})}:tr,popperRef:Bn,open:tr?qt:!1,id:Rt,transition:!0},wr,Lr,{popperOptions:Nr,children:({TransitionProps:zn})=>jsxRuntimeExports.jsx(Dr,_extends({timeout:Yn.transitions.duration.shorter},zn,Hr,{children:jsxRuntimeExports.jsxs(Er,_extends({},na,{children:[wn,At?jsxRuntimeExports.jsx(Or,_extends({},Vn,{ref:Qn})):null]}))}))}))]})}),Tooltip$1=Tooltip;function getCircularProgressUtilityClass(a){return generateUtilityClass("MuiCircularProgress",a)}generateUtilityClasses("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const _excluded$9=["className","color","disableShrink","size","style","thickness","value","variant"];let _$2=a=>a,_t$1,_t2$1,_t3$1,_t4$1;const SIZE=44,circularRotateKeyframe=keyframes(_t$1||(_t$1=_$2`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),circularDashKeyframe=keyframes(_t2$1||(_t2$1=_$2`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),useUtilityClasses$9=a=>{const{classes:o,variant:_e,color:et,disableShrink:rt}=a,lt={root:["root",_e,`color${capitalize(et)}`],svg:["svg"],circle:["circle",`circle${capitalize(_e)}`,rt&&"circleDisableShrink"]};return composeClasses(lt,getCircularProgressUtilityClass,o)},CircularProgressRoot=styled$1("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],o[`color${capitalize(_e.color)}`]]}})(({ownerState:a,theme:o})=>_extends({display:"inline-block"},a.variant==="determinate"&&{transition:o.transitions.create("transform")},a.color!=="inherit"&&{color:(o.vars||o).palette[a.color].main}),({ownerState:a})=>a.variant==="indeterminate"&&css(_t3$1||(_t3$1=_$2`
      animation: ${0} 1.4s linear infinite;
    `),circularRotateKeyframe)),CircularProgressSVG=styled$1("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(a,o)=>o.svg})({display:"block"}),CircularProgressCircle=styled$1("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.circle,o[`circle${capitalize(_e.variant)}`],_e.disableShrink&&o.circleDisableShrink]}})(({ownerState:a,theme:o})=>_extends({stroke:"currentColor"},a.variant==="determinate"&&{transition:o.transitions.create("stroke-dashoffset")},a.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:a})=>a.variant==="indeterminate"&&!a.disableShrink&&css(_t4$1||(_t4$1=_$2`
      animation: ${0} 1.4s ease-in-out infinite;
    `),circularDashKeyframe)),CircularProgress=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiCircularProgress"}),{className:rt,color:lt="primary",disableShrink:it=!1,size:ut=40,style:s,thickness:tt=3.6,value:ot=0,variant:ct="indeterminate"}=et,yt=_objectWithoutPropertiesLoose(et,_excluded$9),pt=_extends({},et,{color:lt,disableShrink:it,size:ut,thickness:tt,value:ot,variant:ct}),gt=useUtilityClasses$9(pt),st={},ft={},at={};if(ct==="determinate"){const ht=2*Math.PI*((SIZE-tt)/2);st.strokeDasharray=ht.toFixed(3),at["aria-valuenow"]=Math.round(ot),st.strokeDashoffset=`${((100-ot)/100*ht).toFixed(3)}px`,ft.transform="rotate(-90deg)"}return jsxRuntimeExports.jsx(CircularProgressRoot,_extends({className:clsx(gt.root,rt),style:_extends({width:ut,height:ut},ft,s),ownerState:pt,ref:_e,role:"progressbar"},at,yt,{children:jsxRuntimeExports.jsx(CircularProgressSVG,{className:gt.svg,ownerState:pt,viewBox:`${SIZE/2} ${SIZE/2} ${SIZE} ${SIZE}`,children:jsxRuntimeExports.jsx(CircularProgressCircle,{className:gt.circle,style:st,ownerState:pt,cx:SIZE,cy:SIZE,r:(SIZE-tt)/2,fill:"none",strokeWidth:tt})})}))}),M=CircularProgress,CancelIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function getChipUtilityClass(a){return generateUtilityClass("MuiChip",a)}const chipClasses=generateUtilityClasses("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),chipClasses$1=chipClasses,_excluded$8=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],useUtilityClasses$8=a=>{const{classes:o,disabled:_e,size:et,color:rt,iconColor:lt,onDelete:it,clickable:ut,variant:s}=a,tt={root:["root",s,_e&&"disabled",`size${capitalize(et)}`,`color${capitalize(rt)}`,ut&&"clickable",ut&&`clickableColor${capitalize(rt)}`,it&&"deletable",it&&`deletableColor${capitalize(rt)}`,`${s}${capitalize(rt)}`],label:["label",`label${capitalize(et)}`],avatar:["avatar",`avatar${capitalize(et)}`,`avatarColor${capitalize(rt)}`],icon:["icon",`icon${capitalize(et)}`,`iconColor${capitalize(lt)}`],deleteIcon:["deleteIcon",`deleteIcon${capitalize(et)}`,`deleteIconColor${capitalize(rt)}`,`deleteIcon${capitalize(s)}Color${capitalize(rt)}`]};return composeClasses(tt,getChipUtilityClass,o)},ChipRoot=styled$1("div",{name:"MuiChip",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a,{color:et,iconColor:rt,clickable:lt,onDelete:it,size:ut,variant:s}=_e;return[{[`& .${chipClasses$1.avatar}`]:o.avatar},{[`& .${chipClasses$1.avatar}`]:o[`avatar${capitalize(ut)}`]},{[`& .${chipClasses$1.avatar}`]:o[`avatarColor${capitalize(et)}`]},{[`& .${chipClasses$1.icon}`]:o.icon},{[`& .${chipClasses$1.icon}`]:o[`icon${capitalize(ut)}`]},{[`& .${chipClasses$1.icon}`]:o[`iconColor${capitalize(rt)}`]},{[`& .${chipClasses$1.deleteIcon}`]:o.deleteIcon},{[`& .${chipClasses$1.deleteIcon}`]:o[`deleteIcon${capitalize(ut)}`]},{[`& .${chipClasses$1.deleteIcon}`]:o[`deleteIconColor${capitalize(et)}`]},{[`& .${chipClasses$1.deleteIcon}`]:o[`deleteIcon${capitalize(s)}Color${capitalize(et)}`]},o.root,o[`size${capitalize(ut)}`],o[`color${capitalize(et)}`],lt&&o.clickable,lt&&et!=="default"&&o[`clickableColor${capitalize(et)})`],it&&o.deletable,it&&et!=="default"&&o[`deletableColor${capitalize(et)}`],o[s],o[`${s}${capitalize(et)}`]]}})(({theme:a,ownerState:o})=>{const _e=a.palette.mode==="light"?a.palette.grey[700]:a.palette.grey[300];return _extends({maxWidth:"100%",fontFamily:a.typography.fontFamily,fontSize:a.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(a.vars||a).palette.text.primary,backgroundColor:(a.vars||a).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:a.transitions.create(["background-color","box-shadow"]),cursor:"default",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${chipClasses$1.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${chipClasses$1.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:a.vars?a.vars.palette.Chip.defaultAvatarColor:_e,fontSize:a.typography.pxToRem(12)},[`& .${chipClasses$1.avatarColorPrimary}`]:{color:(a.vars||a).palette.primary.contrastText,backgroundColor:(a.vars||a).palette.primary.dark},[`& .${chipClasses$1.avatarColorSecondary}`]:{color:(a.vars||a).palette.secondary.contrastText,backgroundColor:(a.vars||a).palette.secondary.dark},[`& .${chipClasses$1.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:a.typography.pxToRem(10)},[`& .${chipClasses$1.icon}`]:_extends({marginLeft:5,marginRight:-6},o.size==="small"&&{fontSize:18,marginLeft:4,marginRight:-4},o.iconColor===o.color&&_extends({color:a.vars?a.vars.palette.Chip.defaultIconColor:_e},o.color!=="default"&&{color:"inherit"})),[`& .${chipClasses$1.deleteIcon}`]:_extends({WebkitTapHighlightColor:"transparent",color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.26)`:alpha(a.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.4)`:alpha(a.palette.text.primary,.4)}},o.size==="small"&&{fontSize:16,marginRight:4,marginLeft:-4},o.color!=="default"&&{color:a.vars?`rgba(${a.vars.palette[o.color].contrastTextChannel} / 0.7)`:alpha(a.palette[o.color].contrastText,.7),"&:hover, &:active":{color:(a.vars||a).palette[o.color].contrastText}})},o.size==="small"&&{height:24},o.color!=="default"&&{backgroundColor:(a.vars||a).palette[o.color].main,color:(a.vars||a).palette[o.color].contrastText},o.onDelete&&{[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}},o.onDelete&&o.color!=="default"&&{[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:(a.vars||a).palette[o.color].dark}})},({theme:a,ownerState:o})=>_extends({},o.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity)},[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)},"&:active":{boxShadow:(a.vars||a).shadows[1]}},o.clickable&&o.color!=="default"&&{[`&:hover, &.${chipClasses$1.focusVisible}`]:{backgroundColor:(a.vars||a).palette[o.color].dark}}),({theme:a,ownerState:o})=>_extends({},o.variant==="outlined"&&{backgroundColor:"transparent",border:a.vars?`1px solid ${a.vars.palette.Chip.defaultBorder}`:`1px solid ${a.palette.mode==="light"?a.palette.grey[400]:a.palette.grey[700]}`,[`&.${chipClasses$1.clickable}:hover`]:{backgroundColor:(a.vars||a).palette.action.hover},[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`& .${chipClasses$1.avatar}`]:{marginLeft:4},[`& .${chipClasses$1.avatarSmall}`]:{marginLeft:2},[`& .${chipClasses$1.icon}`]:{marginLeft:4},[`& .${chipClasses$1.iconSmall}`]:{marginLeft:2},[`& .${chipClasses$1.deleteIcon}`]:{marginRight:5},[`& .${chipClasses$1.deleteIconSmall}`]:{marginRight:3}},o.variant==="outlined"&&o.color!=="default"&&{color:(a.vars||a).palette[o.color].main,border:`1px solid ${a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / 0.7)`:alpha(a.palette[o.color].main,.7)}`,[`&.${chipClasses$1.clickable}:hover`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette[o.color].main,a.palette.action.hoverOpacity)},[`&.${chipClasses$1.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.focusOpacity})`:alpha(a.palette[o.color].main,a.palette.action.focusOpacity)},[`& .${chipClasses$1.deleteIcon}`]:{color:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / 0.7)`:alpha(a.palette[o.color].main,.7),"&:hover, &:active":{color:(a.vars||a).palette[o.color].main}}})),ChipLabel=styled$1("span",{name:"MuiChip",slot:"Label",overridesResolver:(a,o)=>{const{ownerState:_e}=a,{size:et}=_e;return[o.label,o[`label${capitalize(et)}`]]}})(({ownerState:a})=>_extends({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},a.size==="small"&&{paddingLeft:8,paddingRight:8}));function isDeleteKeyboardEvent(a){return a.key==="Backspace"||a.key==="Delete"}const Chip=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiChip"}),{avatar:rt,className:lt,clickable:it,color:ut="default",component:s,deleteIcon:tt,disabled:ot=!1,icon:ct,label:yt,onClick:pt,onDelete:gt,onKeyDown:st,onKeyUp:ft,size:at="medium",variant:ht="filled",tabIndex:mt,skipFocusWhenDisabled:St=!1}=et,It=_objectWithoutPropertiesLoose(et,_excluded$8),xt=reactExports.useRef(null),At=useForkRef(xt,_e),Nt=fn=>{fn.stopPropagation(),gt&&gt(fn)},kt=fn=>{fn.currentTarget===fn.target&&isDeleteKeyboardEvent(fn)&&fn.preventDefault(),st&&st(fn)},Mt=fn=>{fn.currentTarget===fn.target&&(gt&&isDeleteKeyboardEvent(fn)?gt(fn):fn.key==="Escape"&&xt.current&&xt.current.blur()),ft&&ft(fn)},bt=it!==!1&&pt?!0:it,Bt=bt||gt?ButtonBase$1:s||"div",Ht=_extends({},et,{component:Bt,disabled:ot,size:at,color:ut,iconColor:reactExports.isValidElement(ct)&&ct.props.color||ut,onDelete:!!gt,clickable:bt,variant:ht}),Wt=useUtilityClasses$8(Ht),nn=Bt===ButtonBase$1?_extends({component:s||"div",focusVisibleClassName:Wt.focusVisible},gt&&{disableRipple:!0}):{};let gn=null;gt&&(gn=tt&&reactExports.isValidElement(tt)?reactExports.cloneElement(tt,{className:clsx(tt.props.className,Wt.deleteIcon),onClick:Nt}):jsxRuntimeExports.jsx(CancelIcon,{className:clsx(Wt.deleteIcon),onClick:Nt}));let tn=null;rt&&reactExports.isValidElement(rt)&&(tn=reactExports.cloneElement(rt,{className:clsx(Wt.avatar,rt.props.className)}));let Gt=null;return ct&&reactExports.isValidElement(ct)&&(Gt=reactExports.cloneElement(ct,{className:clsx(Wt.icon,ct.props.className)})),jsxRuntimeExports.jsxs(ChipRoot,_extends({as:Bt,className:clsx(Wt.root,lt),disabled:bt&&ot?!0:void 0,onClick:pt,onKeyDown:kt,onKeyUp:Mt,ref:At,tabIndex:St&&ot?-1:mt,ownerState:Ht},nn,It,{children:[tn||Gt,jsxRuntimeExports.jsx(ChipLabel,{className:clsx(Wt.label),ownerState:Ht,children:yt}),gn]}))}),Chip$1=Chip,Stack=createStack({createStyledComponent:styled$1("div",{name:"MuiStack",slot:"Root",overridesResolver:(a,o)=>o.root}),useThemeProps:a=>useThemeProps({props:a,name:"MuiStack"})}),Stack$1=Stack;var A$1=function(){return A$1=Object.assign||function(a){for(var o,_e=1,et=arguments.length;_e<et;_e++)for(var rt in o=arguments[_e])Object.prototype.hasOwnProperty.call(o,rt)&&(a[rt]=o[rt]);return a},A$1.apply(this,arguments)};function x(a,o){var _e={};for(var et in a)Object.prototype.hasOwnProperty.call(a,et)&&o.indexOf(et)<0&&(_e[et]=a[et]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function"){var rt=0;for(et=Object.getOwnPropertySymbols(a);rt<et.length;rt++)o.indexOf(et[rt])<0&&Object.prototype.propertyIsEnumerable.call(a,et[rt])&&(_e[et[rt]]=a[et[rt]])}return _e}var S$1=function(a){var o=a.children,_e=x(a,["children"]),et=reactExports.useMemo(function(){var it,ut=React$1.Children.toArray(o);return ut.length<=1?it={xs:12,sx:{height:{xs:"100%"}}}:ut.length<=2?it={xs:12,md:6,sx:{height:{xs:100/ut.length+"%",md:100/Math.ceil(ut.length/2)+"%"}}}:ut.length<=4?it={xs:12,sm:6,sx:{height:{xs:100/ut.length+"%",sm:100/Math.ceil(ut.length/2)+"%"}}}:ut.length<=6?it={xs:6,md:4,sx:{height:{xs:100/Math.ceil(ut.length/2)+"%",md:100/Math.ceil(ut.length/3)+"%"}}}:ut.length<=9?it={xs:6,sm:4,sx:{height:{xs:100/Math.ceil(ut.length/2)+"%",sm:100/Math.ceil(ut.length/3)+"%"}}}:ut.length<=12?it={xs:4,md:3,sx:{height:{xs:100/Math.ceil(ut.length/3)+"%",md:100/Math.ceil(ut.length/4)+"%"}}}:ut.length<=24?it={xs:4,sm:2,sx:{height:{xs:100/Math.ceil(ut.length/3)+"%",sm:100/Math.ceil(ut.length/6)+"%"}}}:ut.length<=42?it={xs:3,sm:2,sx:{height:{xs:100/Math.ceil(ut.length/4)+"%",sm:100/Math.ceil(ut.length/6)+"%"}}}:it={xs:2,lg:1,sx:{height:{xs:100/Math.ceil(ut.length/6)+"%",lg:100/Math.ceil(ut.length/12)+"%"}}},{arrayChildren:ut,responsive:it}},[o]),rt=et.arrayChildren,lt=et.responsive;return React$1.createElement(u,A$1({container:!0,direction:"row",justifyContent:"space-around",alignItems:"center"},_e),React$1.Children.map(rt,function(it,ut){return React$1.createElement(u,A$1({item:!0,key:ut,display:"flex",justifyContent:"center",alignItems:"center"},lt),it)}))},w$1="default";function C(a){var o=a.id,_e=o===void 0?"media-device-selector":o,et=a.testid,rt=et===void 0?"test-media-device-selector":et,lt=a.devices,it=a.selectedDevice,ut=a.setSelectedDevice,s=x(a,["id","testid","devices","selectedDevice","setSelectedDevice"]),tt=reactExports.useMemo(function(){return lt[w$1]},[lt]),ot=Object.values(lt).map(function(ct){return React$1.createElement(MenuItem$1,{key:ct.getId(),value:ct.getId()},ct.getLabel())});return React$1.createElement(Select$1,A$1({id:_e,"data-testid":rt,value:it?it.getId():w$1,onChange:function(ct){ct.preventDefault(),globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug("".concat("MediaDeviceSelect","|onSelectDevice"),ct.target.value),ut(lt[ct.target.value])}},s),!tt&&React$1.createElement(MenuItem$1,{key:w$1,value:w$1},"Default"),ot)}var I=reactExports.createContext({stream:void 0,muted:!1,toggleMuted:function(){}}),z="Audio";function F(a){var o;globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(z+"|Rendering");var _e=a.id,et=_e===void 0?(o=a.stream)===null||o===void 0?void 0:o.getId():_e,rt=a.autoPlay,lt=rt===void 0||rt,it=a.muted,ut=a.stream;a.sinkId;var s=x(a,["id","autoPlay","muted","stream","sinkId"]),tt=reactExports.useContext(I),ot=tt.stream,ct=tt.muted,yt=ct!==void 0&&ct,pt=reactExports.useMemo(function(){return ut??ot},[ot,ut]),gt=reactExports.useMemo(function(){return it??yt},[yt,it]),st=reactExports.useRef(null);return reactExports.useEffect(function(){var ft=st==null?void 0:st.current;if(pt&&ft)return globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(z+"|useEffect stream",ft,pt),pt.attachToElement(ft),function(){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(z+"|useEffect stream destroy"),ft.src=""}},[pt]),reactExports.useEffect(function(){var ft=st==null?void 0:st.current;ft&&a.sinkId&&ft.setSinkId&&ft.setSinkId(a.sinkId)},[a.sinkId]),React$1.createElement(Box$1,A$1({display:"flex",alignItems:"center",justifyContent:"center"},s),pt&&React$1.createElement(Icon$1,{fontSize:"large"},pt.isRemote?"headset_mic":"mic"),React$1.createElement("audio",{id:et,ref:st,autoPlay:lt,muted:gt}))}var W="AudioEnableButton";function j(a){var o,_e=useThemeProps({props:a,name:"ApiRtcMuiReactLib".concat(W)}),et=_e.id,rt=et===void 0?"audio-enable-btn":et,lt=_e.enabledTooltip,it=lt===void 0?"Audio enabled, click to disable":lt,ut=_e.disabledTooltip,s=ut===void 0?"Audio disabled, click to enable":ut,tt=_e.noAudioTooltip,ot=tt===void 0?"No Audio":tt,ct=_e.tooltipProps,yt=ct===void 0?{placement:"left",arrow:!0}:ct,pt=x(_e,["id","enabledTooltip","disabledTooltip","noAudioTooltip","tooltipProps"]),gt=(o=_e["aria-label"])!==null&&o!==void 0?o:"enable or disable audio",st=reactExports.useReducer(function(mt){return mt+1},0)[1],ft=reactExports.useContext(I).stream;reactExports.useEffect(function(){if(ft){var mt=function(St){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(W+"|onAudioFlowStatusChanged",ft,St,ft.isAudioEnabled()),st()};return ft.on("audioFlowStatusChanged",mt),ft.on("remoteAudioFlowStatusChanged",mt),function(){ft.removeListener("audioFlowStatusChanged",mt),ft.removeListener("remoteAudioFlowStatusChanged",mt)}}},[ft]);var at=function(){ft!=null&&ft.isAudioEnabled()?(globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(W+"|stream.disableAudio",ft==null?void 0:ft.isAudioEnabled()),ft==null||ft.disableAudio(!0).catch(function(mt){globalThis.apirtcMuiReactLibLogLevel.isWarnEnabled&&console.warn(W+"|stream.disableAudio failed",mt)})):(globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(W+"|stream.enableAudio",ft==null?void 0:ft.isAudioEnabled()),ft==null||ft.enableAudio(!0).catch(function(mt){globalThis.apirtcMuiReactLibLogLevel.isWarnEnabled&&console.warn(W+"|stream.enableAudio failed",mt)})),st()},ht=ft&&ft.hasAudio()?ft.isAudioEnabled()?it:s:ot;return React$1.createElement(Tooltip$1,A$1({title:ht},yt),React$1.createElement("span",null,React$1.createElement(IconButton$1,A$1({id:rt,"aria-label":gt},pt,{disabled:_e.disabled||ft&&!ft.hasAudio(),onClick:function(mt){mt.preventDefault(),mt.stopPropagation(),at()},onKeyDown:function(mt){mt.preventDefault(),mt.key!==" "||ft!=null&&ft.isAudioEnabled()||at()},onKeyUp:function(mt){mt.preventDefault(),mt.key===" "&&(ft!=null&&ft.isAudioEnabled())&&at()}}),ft&&ft.hasAudio()&&ft.isAudioEnabled()?React$1.createElement(Icon$1,{fontSize:_e.size},"mic"):React$1.createElement(Icon$1,{fontSize:_e.size},"mic_off"))))}var B="MuteButton";function _$1(a){var o;globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug("".concat(B,"|Rendering"));var _e=useThemeProps({props:a,name:"ApiRtcMuiReactLib".concat(B)}),et=_e.id,rt=et===void 0?"mute-btn":et,lt=_e.mutedTooltip,it=lt===void 0?"Muted":lt,ut=_e.unmutedTooltip,s=ut===void 0?"On":ut,tt=_e.noAudioTooltip,ot=tt===void 0?"No Audio":tt,ct=_e.tooltipProps,yt=ct===void 0?{placement:"left",arrow:!0}:ct,pt=x(_e,["id","mutedTooltip","unmutedTooltip","noAudioTooltip","tooltipProps"]),gt=(o=_e["aria-label"])!==null&&o!==void 0?o:"mute",st=reactExports.useContext(I),ft=st.stream,at=st.muted,ht=st.toggleMuted,mt=ft&&ft.hasAudio()?at?it:s:ot,St=ft&&ft.hasAudio()?at?React$1.createElement(Icon$1,{fontSize:_e.size},"volume_off"):React$1.createElement(Icon$1,{fontSize:_e.size},"volume_up"):React$1.createElement(Icon$1,{fontSize:_e.size},"volume_off");return React$1.createElement(Tooltip$1,A$1({title:mt},yt),React$1.createElement("span",null,React$1.createElement(IconButton$1,A$1({id:rt,"aria-label":gt},pt,{disabled:a.disabled||ft&&!ft.hasAudio(),onClick:function(It){It.preventDefault(),It.stopPropagation(),ht()}}),St)))}var q=function(a){var o=reactExports.useState(a),_e=o[0],et=o[1],rt=reactExports.useCallback(function(){et(function(lt){return!lt})},[]);return reactExports.useEffect(function(){et(a)},[a]),reactExports.useMemo(function(){return{value:_e,setValue:et,toggle:rt}},[_e,rt])},N$1={border:1,borderColor:"primary.main"},G="Stream";function K(a){var o=a.id,_e=a.children,et=a.controls,rt=a.detectSpeaking,lt=rt!==void 0&&rt,it=a.muted,ut=it!==void 0&&it,s=a.name,tt=a.nameColor,ot=tt===void 0?void 0:tt,ct=a.stream,yt=a.sx,pt=x(a,["id","children","controls","detectSpeaking","muted","name","nameColor","stream","sx"]);globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(G+"|Rendering");var gt=q(ut),st=gt.value,ft=gt.toggle,at=reactExports.useState(!1),ht=at[0],mt=at[1],St=reactExports.useRef(null),It=reactExports.useRef(null),xt=reactExports.useState({height:0,width:0}),At=xt[0],Nt=xt[1],kt=reactExports.useState({height:0,width:0}),Mt=kt[0],bt=kt[1];reactExports.useEffect(function(){if(ct&&lt){var Ht=ct,Wt=function(nn){mt(nn.isSpeaking)};return Ht.on("audioAmplitude",Wt),function(){Ht.removeListener("audioAmplitude",Wt)}}},[ct,lt]),reactExports.useEffect(function(){var Ht=St.current;if(Ht){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(G+"|setSize",Ht.clientHeight,Ht.clientWidth),Nt({height:Ht.clientHeight,width:Ht.clientWidth});var Wt=new ResizeObserver(function(){Nt({height:Ht.clientHeight,width:Ht.clientWidth})});return Wt.observe(Ht),function(){Wt.disconnect()}}},[St]),reactExports.useEffect(function(){var Ht=It.current;if(Ht){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(G+"|setControlsSize",Ht.clientHeight,Ht.clientWidth),bt({height:Ht.clientHeight,width:Ht.clientWidth});var Wt=new ResizeObserver(function(){bt({height:Ht.clientHeight,width:Ht.clientWidth})});return Wt.observe(Ht),function(){Wt.disconnect()}}},[It]);var Bt=reactExports.useMemo(function(){return Math.max(Math.ceil(.01*At.width),4)},[At]);return React$1.createElement(I.Provider,{value:{stream:ct,muted:st,toggleMuted:ft}},React$1.createElement(Box$1,A$1({id:o,ref:St,sx:A$1(A$1(A$1({minHeight:Mt.height+2*Bt+(s?36:0),minWidth:et?Math.max(2*Mt.width,40)+Bt:0},yt),{position:"relative"}),ht&&N$1),display:"flex",justifyContent:"center",alignItems:"center"},pt),_e,s&&React$1.createElement(Chip$1,{sx:{position:"absolute",top:Bt,left:"50%",transform:"translate(-50%)",opacity:.9},label:s,color:ot}),React$1.createElement(Stack$1,{ref:It,sx:{position:"absolute",float:"right",bottom:Bt,right:Bt,opacity:.9}},et)))}var Q="Video";function X(a){var o,_e=useThemeProps({props:a,name:"ApiRtcMuiReactLib".concat(Q)}),et=_e.id,rt=et===void 0?(o=_e.stream)===null||o===void 0?void 0:o.getId():et,lt=_e.sx,it=_e.style,ut=_e.autoPlay,s=ut===void 0||ut,tt=_e.muted,ot=_e.pointer,ct=_e.pointerColor,yt=_e.progressColor,pt=_e.stream,gt=_e.sinkId,st=_e.videoMutedTooltip,ft=st===void 0?"Video muted":st,at=x(_e,["id","sx","style","autoPlay","muted","pointer","pointerColor","progressColor","stream","sinkId","videoMutedTooltip"]),ht=reactExports.useContext(I),mt=ht.stream,St=ht.muted,It=St!==void 0&&St,xt=reactExports.useMemo(function(){return pt??mt},[mt,pt]),At=reactExports.useMemo(function(){return tt??It},[It,tt]),Nt=reactExports.useRef(null),kt=reactExports.useState(!1),Mt=kt[0],bt=kt[1];return reactExports.useEffect(function(){var Bt=Nt==null?void 0:Nt.current;if(xt&&Bt){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Q+"|useEffect stream",Bt,xt),xt.attachToElement(Bt);var Ht=function(Wt){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Q+"|onVideoFlowStatusChanged",xt,Wt),bt(Wt.muted)};return xt.on("videoFlowStatusChanged",Ht),xt.on("remoteVideoFlowStatusChanged",Ht),function(){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Q+"|useEffect stream destroy"),Bt.src="",xt.removeListener("audioFlowStatusChanged",Ht),xt.removeListener("remoteAudioFlowStatusChanged",Ht)}}},[xt]),reactExports.useEffect(function(){var Bt=Nt==null?void 0:Nt.current;Bt&&gt&&Bt.setSinkId&&Bt.setSinkId(gt)},[gt]),React$1.createElement(Box$1,A$1({sx:A$1(A$1({},lt),{position:"relative"})},at),React$1.createElement("video",{id:rt,ref:Nt,style:it,autoPlay:s,muted:At}),ot&&React$1.createElement(Icon$1,{sx:{position:"absolute",top:ot.top,left:ot.left,transform:"translate(-50%,-50%)",opacity:.9},color:ct},"adjust"),Mt&&React$1.createElement(Tooltip$1,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",opacity:.9},title:ft},React$1.createElement(M,{color:yt})))}var Y="VideoEnableButton";function Z(a){var o,_e=useThemeProps({props:a,name:"ApiRtcMuiReactLib".concat(Y)}),et=_e.id,rt=et===void 0?"video-enable-btn":et,lt=_e.enabledTooltip,it=lt===void 0?"Video enabled, click to disable":lt,ut=_e.disabledTooltip,s=ut===void 0?"Video disabled, click to enable":ut,tt=_e.noVideoTooltip,ot=tt===void 0?"No Video":tt,ct=_e.tooltipProps,yt=ct===void 0?{placement:"left",arrow:!0}:ct,pt=x(_e,["id","enabledTooltip","disabledTooltip","noVideoTooltip","tooltipProps"]),gt=(o=_e["aria-label"])!==null&&o!==void 0?o:"enable or disable video",st=reactExports.useReducer(function(ht){return ht+1},0)[1],ft=reactExports.useContext(I).stream;reactExports.useEffect(function(){if(ft){var ht=function(mt){globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Y+"|onVideoFlowStatusChanged",ft,mt,ft.isVideoEnabled()),st()};return ft.on("videoFlowStatusChanged",ht),ft.on("remoteVideoFlowStatusChanged",ht),function(){ft.removeListener("videoFlowStatusChanged",ht),ft.removeListener("remoteVideoFlowStatusChanged",ht)}}},[ft]);var at=ft&&ft.hasVideo()?ft.isVideoEnabled()?it:s:ot;return React$1.createElement(Tooltip$1,A$1({title:at},yt),React$1.createElement("span",null,React$1.createElement(IconButton$1,A$1({id:rt,"aria-label":gt},pt,{disabled:_e.disabled||ft&&!ft.hasVideo(),onClick:function(ht){ht.preventDefault(),ht.stopPropagation(),ft!=null&&ft.isVideoEnabled()?(globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Y+"|stream.disableVideo",ft==null?void 0:ft.isVideoEnabled()),ft==null||ft.disableVideo(!0).catch(function(mt){globalThis.apirtcMuiReactLibLogLevel.isWarnEnabled&&console.warn(Y+"|stream.disableVideo failed",mt)})):(globalThis.apirtcMuiReactLibLogLevel.isDebugEnabled&&console.debug(Y+"|stream.enableVideo",ft==null?void 0:ft.isVideoEnabled()),ft==null||ft.enableVideo(!0).catch(function(mt){globalThis.apirtcMuiReactLibLogLevel.isWarnEnabled&&console.warn(Y+"|stream.enableVideo failed",mt)})),st()}}),ft&&ft.hasVideo()&&ft.isVideoEnabled()?React$1.createElement(Icon$1,{fontSize:_e.size},"videocam"):React$1.createElement(Icon$1,{fontSize:_e.size},"videocam_off"))))}var $={components:{ApiRtcMuiReactLibAudioEnableButton:{defaultProps:{"aria-label":"activer ou dsactiver l'audio",enabledTooltip:"Audio activ, cliquer pour dsactiver",disabledTooltip:"Audio dsactiv, cliquer pour activer",noAudioTooltip:"Pas d'audio"}},ApiRtcMuiReactLibMuteButton:{defaultProps:{"aria-label":"activer ou dsactiver le son",mutedTooltip:"Son dsactiv, cliquer pour activer",unmutedTooltip:"Son activ, cliquer pour dsactiver",noAudioTooltip:"Pas d'audio"}},ApiRtcMuiReactLibPublishOptions:{defaultProps:{labelText:"Options de publication",audioAndVideoText:"Audio et Vido",audioOnlyText:"Audio seul",videoOnlyText:"Vido seule"}},ApiRtcMuiReactLibSnapshotButton:{defaultProps:{"aria-label":"photo",snapshotTooltip:"Prendre une photo"}},ApiRtcMuiReactLibTorchButton:{defaultProps:{"aria-label":"torche",torchOffTooltip:"Eteindre la torche",torchOnTooltip:"Allumer la torche"}},ApiRtcMuiReactLibVideo:{defaultProps:{videoMutedTooltip:"Vido coupe"}},ApiRtcMuiReactLibVideoEnableButton:{defaultProps:{"aria-label":"activer ou dsactiver la vido",enabledTooltip:"Vido active, cliquer pour dsactiver",disabledTooltip:"Vido dsactive, cliquer pour activer",noVideoTooltip:"Pas de Vido"}}}},ee={level:"info",isDebugEnabled:!1,isInfoEnabled:!0,isWarnEnabled:!0};function te(a){switch(a){case"debug":globalThis.apirtcMuiReactLibLogLevel={level:"debug",isDebugEnabled:!0,isInfoEnabled:!0,isWarnEnabled:!0};break;case"info":default:globalThis.apirtcMuiReactLibLogLevel=ee;break;case"warn":globalThis.apirtcMuiReactLibLogLevel={level:"warn",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!0};break;case"error":globalThis.apirtcMuiReactLibLogLevel={level:"error",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!1}}return globalThis.apirtcMuiReactLibLogLevel}globalThis.apirtcMuiReactLibLogLevel=ee,globalThis.setApirtcMuiReactLibLogLevel=te;const c="useCameraStream";function b(a,o={},_e){const[et,rt]=reactExports.useState(),[lt,it]=reactExports.useState(!1);return reactExports.useEffect(()=>{if(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${c}|useEffect`,a,o),a){const ut=a.getUserAgent();it(!0),ut.createStream(o).then(s=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${c}|createStream`,o,s),rt(s)}).catch(s=>{console.error(`${c}|createStream error`,o,s),rt(void 0),_e&&_e(s)}).finally(()=>{it(!1)})}else rt(void 0)},[a,JSON.stringify(o)]),reactExports.useEffect(()=>{const ut=et;if(ut)return()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${c}|release stream`,ut),ut.release()}},[et]),{stream:et,grabbing:lt}}const g="useConversation";function d(a,o,_e,et=!0,rt){const[lt,it]=reactExports.useState(),[ut,s]=reactExports.useState(!1),[tt,ot]=reactExports.useState(!1),ct=reactExports.useCallback((pt={})=>(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${g}|join`,lt,pt),new Promise((gt,st)=>{lt?lt.isJoined()?st(`${g}|join|conversation already joined`):(ot(!0),lt.join(pt).then(()=>{s(!0),gt()}).catch(ft=>{st(ft)}).finally(()=>{ot(!1)})):st(`${g}|join|conversation not defined`)})),[lt]),yt=reactExports.useCallback(()=>(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${g}|leave`,lt),new Promise((pt,gt)=>{lt?lt.isJoined()?lt.leave().then(()=>{s(!1),pt()}).catch(st=>{gt(st)}):gt(`${g}|leave|conversation is not joined`):gt(`${g}|leave|conversation not defined`)})),[lt]);return reactExports.useEffect(()=>{if(a&&o){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${g}|getOrCreateConversation`,o,_e,et);const pt=a.getOrCreateConversation(o,_e);return it(pt),()=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${g}|useEffect cleanup`,o,_e,et),pt.isJoined()?pt.leave().then(()=>{}).catch(gt=>{globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${g}|useEffect conversation.leave()`,gt)}).finally(()=>{pt.destroy()}):pt.destroy(),it(void 0),s(!1)}}},[a,o,JSON.stringify(_e)]),reactExports.useEffect(()=>{if(lt&&et){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${g}|useEffect`,lt,et,rt);const pt=lt,gt=et;return gt&&(ot(!0),pt.join(rt).then(()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${g}|joined`,pt),s(!0)}).catch(st=>{globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${g}|useEffect conversation.join() error`,pt,rt,st)}).finally(()=>{ot(!1)})),()=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${g}|useEffect cleanup`,pt,gt),pt.isJoined()&&pt.leave().then(()=>{s(!1)}).catch(st=>{globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${g}|useEffect conversation.leave() error`,pt,st)})}}},[lt,et,JSON.stringify(rt)]),{conversation:lt,joining:tt,joined:ut,join:ct,leave:yt}}function v(a){return a!=null}const h="useConversationStreams";function m(a,o=[],_e){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|hook render|${a==null?void 0:a.getName()}`,o.map(st=>st==null?void 0:st.options));const[et]=reactExports.useState([]),[rt]=reactExports.useState(new Array),[lt,it]=reactExports.useState(new Array),[ut]=reactExports.useState(new Array),[s,tt]=reactExports.useState(new Array),ot=reactExports.useCallback((st,ft)=>new Promise((at,ht)=>{a&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|publish|${a.getName()}`,st,ft),a.publish(st,ft).then(mt=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${h}|published|${a.getName()}`,mt),rt.push(mt),it(Array.from(rt)),at(mt)}).catch(mt=>{ht(mt)}))}),[a]),ct=reactExports.useCallback((st,ft)=>new Promise((at,ht)=>{a&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|replacePublishedStream|${a.getName()}|${st.getId()} -> ${ft.getId()}`),a.replacePublishedStream(st,ft).then(mt=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${h}|stream replaced|${a.getName()}`,st,mt);const St=rt.indexOf(st);St>=0&&(rt.splice(St,1,mt),it(Array.from(rt))),at(mt)}).catch(mt=>{ht(mt)}))}),[a]),yt=reactExports.useCallback(st=>{if(a){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|unpublish|${a.getName()}`,st.getId(),st),a.unpublish(st);const ft=rt.indexOf(st);ft>=0&&(rt.splice(ft,1),it(Array.from(rt)))}},[a]),pt=reactExports.useCallback(()=>{const st=Math.max(et.length,o.length);globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|doHandlePublication`,o,JSON.stringify(et.map(St=>St==null?void 0:St.stream.getId())),JSON.stringify(o.map(St=>St==null?void 0:St.stream.getId())),st);const ft=[...et],at=o.map(St=>St&&St.options?{stream:St.stream,options:Object.assign({},St.options)}:St);et.length=0,et.push(...at);const ht=new Set(o.filter(v).map(St=>St.stream)),mt=(St,It)=>{ot(It.stream,It.options).catch(xt=>{et.splice(St,1,null),_e?_e(xt):globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${h}|publish|error`,xt)})};for(let St=0;St<st;St++){const It=ft[St],xt=o[St];if(It&&xt){const At=()=>{yt(It.stream),mt(St,xt)};It.stream===xt.stream?JSON.stringify(It.options)!==JSON.stringify(xt.options)&&At():ht.has(It.stream)?a&&!a.isPublishedStream(xt.stream)&&mt(St,xt):a&&!a.isPublishedStream(xt.stream)?JSON.stringify(It.options)===JSON.stringify(xt.options)?ct(It.stream,xt.stream).catch(Nt=>{et.splice(St,1,null),_e?_e(Nt):globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${h}|replacePublishedStream|error`,Nt)}):At():yt(It.stream)}else It&&!xt?ht.has(It.stream)||yt(It.stream):!It&&xt&&a&&!a.isPublishedStream(xt.stream)&&mt(St,xt)}},[a,JSON.stringify(o.map(st=>(st==null?void 0:st.stream.getId())+"-"+JSON.stringify(st==null?void 0:st.options))),ot,yt,ct]),gt=st=>{rt.forEach(ft=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|unpublish|${st.getName()}`,ft),st.unpublish(ft)}),rt.length=0,et.length=0,ut.forEach(ft=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|unsubscribeToStream|${st.getName()}`,ft),st.unsubscribeToStream(ft.getId())}),ut.length=0,it(new Array),tt(new Array)};return reactExports.useEffect(()=>{if(a){const st=ht=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${h}|on_streamAdded|${a.getName()}`,ht),ut.push(ht),tt(Array.from(ut))},ft=ht=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${h}|on_streamRemoved|${a.getName()}`,ht);const mt=ut.indexOf(ht);mt>=0&&(ut.splice(mt,1),tt(Array.from(ut)))},at=ht=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|on_streamListChanged|${a.getName()}`,ht);const mt=String(ht.streamId);ht.isRemote===!0&&(ht.listEventType==="added"?a.subscribeToStream(mt):ht.listEventType==="removed"&&a.unsubscribeToStream(mt))};return a.on("streamAdded",st),a.on("streamRemoved",ft),a.on("streamListChanged",at),()=>{a.removeListener("streamListChanged",at),a.removeListener("streamRemoved",ft),a.removeListener("streamAdded",st),gt(a)}}},[a]),reactExports.useEffect(()=>{if(a){globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${h}|useEffect doHandlePublication|${a.getName()}`);const st=()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${h}|on_joined|${a.getName()}`,o),pt()},ft=()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${h}|on_left|${a.getName()}`),gt(a)};return a.on("joined",st),a.on("left",ft),a.isJoined()&&pt(),()=>{a.removeListener("joined",st),a.removeListener("left",ft)}}},[pt]),{publishedStreams:lt,subscribedStreams:s,publish:ot,unpublish:yt,replacePublishedStream:ct}}const R="useSession";function y(a,o,_e){const[et,rt]=reactExports.useState(),[lt,it]=reactExports.useState(!1);reactExports.useEffect(()=>{if(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${R}|useEffect credentials, options`,a,o),a)return ut(a,o).catch(s=>{console.error(`${R}|connection failed`,s),rt(void 0),_e?_e(s):globalThis.apirtcReactLibLogLevel.isWarnEnabled&&console.warn(`${R}|connect|error`,s)}),()=>{rt(void 0),it(!1)}},[JSON.stringify(a),JSON.stringify(o)]),reactExports.useEffect(()=>{if(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${R}|useEffect session`,et),et){const s=et;return()=>{globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${R}|useEffect session cleanup`,s),s.disconnect().then(()=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${R}|disconnected`,s)}).catch(tt=>{console.error(`${R}|disconnect`,tt)})}}},[et]);const ut=(s,tt)=>new Promise((ot,ct)=>{const yt=tt||{cloudUrl:"https://cloud.apirtc.com"};let pt;if(typeof(gt=s)=="object"&&"username"in gt)yt.password=s.password,pt=new apiRTC_minExports.UserAgent({uri:"apirtc:"+s.username});else if(function(st){return typeof st=="object"&&"apiKey"in st}(s))pt=new apiRTC_minExports.UserAgent({uri:`apiKey:${s.apiKey}`});else{if(!function(st){return typeof st=="object"&&"token"in st}(s))return void ct("credentials not recognized");pt=new apiRTC_minExports.UserAgent({uri:`token:${s.token}`})}var gt;it(!0),pt.register(yt).then(st=>{globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${R}|connected`,st),rt(st),ot()}).catch(st=>{ct(st)}).finally(()=>{it(!1)})});return{session:et,connecting:lt,connect:ut,disconnect:()=>{rt(void 0)}}}const S="useUserMediaDevices",w=a=>{try{const o=localStorage.getItem(a),_e=o?JSON.parse(o):null;return _e?new apiRTC_minExports.MediaDevice(_e.id,_e.type,_e.label):void 0}catch(o){return void console.warn(`${S}|getMediaDeviceFromLocalStorage`,o)}},D=(a,o)=>{try{localStorage.setItem(a,o)}catch{}};function N(a,o){const _e=o+".audioIn",et=o+".audioOut",rt=o+".videoIn",[lt,it]=reactExports.useState(o?w(_e):void 0),[ut,s]=reactExports.useState(o?w(et):void 0),[tt,ot]=reactExports.useState(o?w(rt):void 0),ct=reactExports.useMemo(()=>({audioinput:lt?{[lt.getId()]:lt}:{},audiooutput:ut?{[ut.getId()]:ut}:{},videoinput:tt?{[tt.getId()]:tt}:{}}),[lt,ut,tt]),[yt,pt]=reactExports.useState(ct);return reactExports.useEffect(()=>{if(a){const gt=a.getUserAgent(),st=()=>{const ft=gt.getUserMediaDevices();if(globalThis.apirtcReactLibLogLevel.isInfoEnabled&&console.info(`${S}|mediaDeviceChanged`,ft),pt(ft),o){const at=w(_e);at&&it(ft.audioinput[at.getId()]);const ht=w(et);ht&&s(ft.audiooutput[ht.getId()]);const mt=w(rt);mt&&ot(ft.videoinput[mt.getId()]),globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${S}|userMediaDevices, audioIn, audioOut, videoIn`,ft,at==null?void 0:at.getId(),ht==null?void 0:ht.getId(),mt==null?void 0:mt.getId())}};return gt.on("mediaDeviceChanged",st),()=>{gt.removeListener("mediaDeviceChanged",st),pt(ct)}}},[a]),reactExports.useEffect(()=>{lt&&o&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${S}|Storing audioIn`,lt),D(_e,JSON.stringify({id:lt.getId(),type:lt.getType(),label:lt.getLabel()})))},[lt==null?void 0:lt.getId()]),reactExports.useEffect(()=>{ut&&o&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${S}|Storing audioOut`,ut),D(et,JSON.stringify({id:ut.getId(),type:ut.getType(),label:ut.getLabel()})))},[ut==null?void 0:ut.getId()]),reactExports.useEffect(()=>{tt&&o&&(globalThis.apirtcReactLibLogLevel.isDebugEnabled&&console.debug(`${S}|Storing videoIn`,tt),D(rt,JSON.stringify({id:tt.getId(),type:tt.getType(),label:tt.getLabel()})))},[tt==null?void 0:tt.getId()]),{userMediaDevices:yt,selectedAudioIn:lt,setSelectedAudioIn:it,selectedAudioOut:ut,setSelectedAudioOut:s,selectedVideoIn:tt,setSelectedVideoIn:ot}}const O={level:"info",isDebugEnabled:!1,isInfoEnabled:!0,isWarnEnabled:!0};function A(a){switch(a){case"debug":globalThis.apirtcReactLibLogLevel={level:"debug",isDebugEnabled:!0,isInfoEnabled:!0,isWarnEnabled:!0};break;case"info":default:globalThis.apirtcReactLibLogLevel=O;break;case"warn":globalThis.apirtcReactLibLogLevel={level:"warn",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!0};break;case"error":globalThis.apirtcReactLibLogLevel={level:"error",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!1}}return globalThis.apirtcReactLibLogLevel}globalThis.apirtcReactLibLogLevel=O,globalThis.setApirtcReactLibLogLevel=A;function getAlertUtilityClass(a){return generateUtilityClass("MuiAlert",a)}const alertClasses=generateUtilityClasses("MuiAlert",["root","action","icon","message","filled","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),alertClasses$1=alertClasses,SuccessOutlinedIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),ReportProblemOutlinedIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),ErrorOutlineIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),InfoOutlinedIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),ClearIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),_excluded$7=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],useUtilityClasses$7=a=>{const{variant:o,color:_e,severity:et,classes:rt}=a,lt={root:["root",`${o}${capitalize(_e||et)}`,`${o}`],icon:["icon"],message:["message"],action:["action"]};return composeClasses(lt,getAlertUtilityClass,rt)},AlertRoot=styled$1(Paper$1,{name:"MuiAlert",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],o[`${_e.variant}${capitalize(_e.color||_e.severity)}`]]}})(({theme:a,ownerState:o})=>{const _e=a.palette.mode==="light"?darken:lighten,et=a.palette.mode==="light"?lighten:darken,rt=o.color||o.severity;return _extends({},a.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px"},rt&&o.variant==="standard"&&{color:a.vars?a.vars.palette.Alert[`${rt}Color`]:_e(a.palette[rt].light,.6),backgroundColor:a.vars?a.vars.palette.Alert[`${rt}StandardBg`]:et(a.palette[rt].light,.9),[`& .${alertClasses$1.icon}`]:a.vars?{color:a.vars.palette.Alert[`${rt}IconColor`]}:{color:a.palette[rt].main}},rt&&o.variant==="outlined"&&{color:a.vars?a.vars.palette.Alert[`${rt}Color`]:_e(a.palette[rt].light,.6),border:`1px solid ${(a.vars||a).palette[rt].light}`,[`& .${alertClasses$1.icon}`]:a.vars?{color:a.vars.palette.Alert[`${rt}IconColor`]}:{color:a.palette[rt].main}},rt&&o.variant==="filled"&&_extends({fontWeight:a.typography.fontWeightMedium},a.vars?{color:a.vars.palette.Alert[`${rt}FilledColor`],backgroundColor:a.vars.palette.Alert[`${rt}FilledBg`]}:{backgroundColor:a.palette.mode==="dark"?a.palette[rt].dark:a.palette[rt].main,color:a.palette.getContrastText(a.palette[rt].main)}))}),AlertIcon=styled$1("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(a,o)=>o.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),AlertMessage=styled$1("div",{name:"MuiAlert",slot:"Message",overridesResolver:(a,o)=>o.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),AlertAction=styled$1("div",{name:"MuiAlert",slot:"Action",overridesResolver:(a,o)=>o.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),defaultIconMapping={success:jsxRuntimeExports.jsx(SuccessOutlinedIcon,{fontSize:"inherit"}),warning:jsxRuntimeExports.jsx(ReportProblemOutlinedIcon,{fontSize:"inherit"}),error:jsxRuntimeExports.jsx(ErrorOutlineIcon,{fontSize:"inherit"}),info:jsxRuntimeExports.jsx(InfoOutlinedIcon,{fontSize:"inherit"})},Alert=reactExports.forwardRef(function(o,_e){var et,rt,lt,it,ut,s;const tt=useThemeProps({props:o,name:"MuiAlert"}),{action:ot,children:ct,className:yt,closeText:pt="Close",color:gt,components:st={},componentsProps:ft={},icon:at,iconMapping:ht=defaultIconMapping,onClose:mt,role:St="alert",severity:It="success",slotProps:xt={},slots:At={},variant:Nt="standard"}=tt,kt=_objectWithoutPropertiesLoose(tt,_excluded$7),Mt=_extends({},tt,{color:gt,severity:It,variant:Nt}),bt=useUtilityClasses$7(Mt),Bt=(et=(rt=At.closeButton)!=null?rt:st.CloseButton)!=null?et:IconButton$1,Ht=(lt=(it=At.closeIcon)!=null?it:st.CloseIcon)!=null?lt:ClearIcon,Wt=(ut=xt.closeButton)!=null?ut:ft.closeButton,nn=(s=xt.closeIcon)!=null?s:ft.closeIcon;return jsxRuntimeExports.jsxs(AlertRoot,_extends({role:St,elevation:0,ownerState:Mt,className:clsx(bt.root,yt),ref:_e},kt,{children:[at!==!1?jsxRuntimeExports.jsx(AlertIcon,{ownerState:Mt,className:bt.icon,children:at||ht[It]||defaultIconMapping[It]}):null,jsxRuntimeExports.jsx(AlertMessage,{ownerState:Mt,className:bt.message,children:ct}),ot!=null?jsxRuntimeExports.jsx(AlertAction,{ownerState:Mt,className:bt.action,children:ot}):null,ot==null&&mt?jsxRuntimeExports.jsx(AlertAction,{ownerState:Mt,className:bt.action,children:jsxRuntimeExports.jsx(Bt,_extends({size:"small","aria-label":pt,title:pt,color:"inherit",onClick:mt},Wt,{children:jsxRuntimeExports.jsx(Ht,_extends({fontSize:"small"},nn))}))}):null]}))}),Alert$1=Alert;function getButtonUtilityClass(a){return generateUtilityClass("MuiButton",a)}const buttonClasses=generateUtilityClasses("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),buttonClasses$1=buttonClasses,ButtonGroupContext=reactExports.createContext({}),ButtonGroupContext$1=ButtonGroupContext,_excluded$6=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],useUtilityClasses$6=a=>{const{color:o,disableElevation:_e,fullWidth:et,size:rt,variant:lt,classes:it}=a,ut={root:["root",lt,`${lt}${capitalize(o)}`,`size${capitalize(rt)}`,`${lt}Size${capitalize(rt)}`,o==="inherit"&&"colorInherit",_e&&"disableElevation",et&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${capitalize(rt)}`],endIcon:["endIcon",`iconSize${capitalize(rt)}`]},s=composeClasses(ut,getButtonUtilityClass,it);return _extends({},it,s)},commonIconStyles=a=>_extends({},a.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},a.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},a.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),ButtonRoot=styled$1(ButtonBase$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiButton",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],o[`${_e.variant}${capitalize(_e.color)}`],o[`size${capitalize(_e.size)}`],o[`${_e.variant}Size${capitalize(_e.size)}`],_e.color==="inherit"&&o.colorInherit,_e.disableElevation&&o.disableElevation,_e.fullWidth&&o.fullWidth]}})(({theme:a,ownerState:o})=>{var _e,et;const rt=a.palette.mode==="light"?a.palette.grey[300]:a.palette.grey[800],lt=a.palette.mode==="light"?a.palette.grey.A100:a.palette.grey[700];return _extends({},a.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(a.vars||a).shape.borderRadius,transition:a.transitions.create(["background-color","box-shadow","border-color","color"],{duration:a.transitions.duration.short}),"&:hover":_extends({textDecoration:"none",backgroundColor:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette.text.primary,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},o.variant==="text"&&o.color!=="inherit"&&{backgroundColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette[o.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},o.variant==="outlined"&&o.color!=="inherit"&&{border:`1px solid ${(a.vars||a).palette[o.color].main}`,backgroundColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(a.palette[o.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},o.variant==="contained"&&{backgroundColor:a.vars?a.vars.palette.Button.inheritContainedHoverBg:lt,boxShadow:(a.vars||a).shadows[4],"@media (hover: none)":{boxShadow:(a.vars||a).shadows[2],backgroundColor:(a.vars||a).palette.grey[300]}},o.variant==="contained"&&o.color!=="inherit"&&{backgroundColor:(a.vars||a).palette[o.color].dark,"@media (hover: none)":{backgroundColor:(a.vars||a).palette[o.color].main}}),"&:active":_extends({},o.variant==="contained"&&{boxShadow:(a.vars||a).shadows[8]}),[`&.${buttonClasses$1.focusVisible}`]:_extends({},o.variant==="contained"&&{boxShadow:(a.vars||a).shadows[6]}),[`&.${buttonClasses$1.disabled}`]:_extends({color:(a.vars||a).palette.action.disabled},o.variant==="outlined"&&{border:`1px solid ${(a.vars||a).palette.action.disabledBackground}`},o.variant==="contained"&&{color:(a.vars||a).palette.action.disabled,boxShadow:(a.vars||a).shadows[0],backgroundColor:(a.vars||a).palette.action.disabledBackground})},o.variant==="text"&&{padding:"6px 8px"},o.variant==="text"&&o.color!=="inherit"&&{color:(a.vars||a).palette[o.color].main},o.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},o.variant==="outlined"&&o.color!=="inherit"&&{color:(a.vars||a).palette[o.color].main,border:a.vars?`1px solid rgba(${a.vars.palette[o.color].mainChannel} / 0.5)`:`1px solid ${alpha(a.palette[o.color].main,.5)}`},o.variant==="contained"&&{color:a.vars?a.vars.palette.text.primary:(_e=(et=a.palette).getContrastText)==null?void 0:_e.call(et,a.palette.grey[300]),backgroundColor:a.vars?a.vars.palette.Button.inheritContainedBg:rt,boxShadow:(a.vars||a).shadows[2]},o.variant==="contained"&&o.color!=="inherit"&&{color:(a.vars||a).palette[o.color].contrastText,backgroundColor:(a.vars||a).palette[o.color].main},o.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},o.size==="small"&&o.variant==="text"&&{padding:"4px 5px",fontSize:a.typography.pxToRem(13)},o.size==="large"&&o.variant==="text"&&{padding:"8px 11px",fontSize:a.typography.pxToRem(15)},o.size==="small"&&o.variant==="outlined"&&{padding:"3px 9px",fontSize:a.typography.pxToRem(13)},o.size==="large"&&o.variant==="outlined"&&{padding:"7px 21px",fontSize:a.typography.pxToRem(15)},o.size==="small"&&o.variant==="contained"&&{padding:"4px 10px",fontSize:a.typography.pxToRem(13)},o.size==="large"&&o.variant==="contained"&&{padding:"8px 22px",fontSize:a.typography.pxToRem(15)},o.fullWidth&&{width:"100%"})},({ownerState:a})=>a.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${buttonClasses$1.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${buttonClasses$1.disabled}`]:{boxShadow:"none"}}),ButtonStartIcon=styled$1("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.startIcon,o[`iconSize${capitalize(_e.size)}`]]}})(({ownerState:a})=>_extends({display:"inherit",marginRight:8,marginLeft:-4},a.size==="small"&&{marginLeft:-2},commonIconStyles(a))),ButtonEndIcon=styled$1("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.endIcon,o[`iconSize${capitalize(_e.size)}`]]}})(({ownerState:a})=>_extends({display:"inherit",marginRight:-4,marginLeft:8},a.size==="small"&&{marginRight:-2},commonIconStyles(a))),Button=reactExports.forwardRef(function(o,_e){const et=reactExports.useContext(ButtonGroupContext$1),rt=resolveProps(et,o),lt=useThemeProps({props:rt,name:"MuiButton"}),{children:it,color:ut="primary",component:s="button",className:tt,disabled:ot=!1,disableElevation:ct=!1,disableFocusRipple:yt=!1,endIcon:pt,focusVisibleClassName:gt,fullWidth:st=!1,size:ft="medium",startIcon:at,type:ht,variant:mt="text"}=lt,St=_objectWithoutPropertiesLoose(lt,_excluded$6),It=_extends({},lt,{color:ut,component:s,disabled:ot,disableElevation:ct,disableFocusRipple:yt,fullWidth:st,size:ft,type:ht,variant:mt}),xt=useUtilityClasses$6(It),At=at&&jsxRuntimeExports.jsx(ButtonStartIcon,{className:xt.startIcon,ownerState:It,children:at}),Nt=pt&&jsxRuntimeExports.jsx(ButtonEndIcon,{className:xt.endIcon,ownerState:It,children:pt});return jsxRuntimeExports.jsxs(ButtonRoot,_extends({ownerState:It,className:clsx(et.className,xt.root,tt),component:s,disabled:ot,focusRipple:!yt,focusVisibleClassName:clsx(xt.focusVisible,gt),ref:_e,type:ht},St,{classes:xt,children:[At,it,Nt]}))}),Button$1=Button;function getCardUtilityClass(a){return generateUtilityClass("MuiCard",a)}generateUtilityClasses("MuiCard",["root"]);const _excluded$5=["className","raised"],useUtilityClasses$5=a=>{const{classes:o}=a;return composeClasses({root:["root"]},getCardUtilityClass,o)},CardRoot=styled$1(Paper$1,{name:"MuiCard",slot:"Root",overridesResolver:(a,o)=>o.root})(()=>({overflow:"hidden"})),Card=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiCard"}),{className:rt,raised:lt=!1}=et,it=_objectWithoutPropertiesLoose(et,_excluded$5),ut=_extends({},et,{raised:lt}),s=useUtilityClasses$5(ut);return jsxRuntimeExports.jsx(CardRoot,_extends({className:clsx(s.root,rt),elevation:lt?8:void 0,ref:_e,ownerState:ut},it))}),Card$1=Card;function getCardContentUtilityClass(a){return generateUtilityClass("MuiCardContent",a)}generateUtilityClasses("MuiCardContent",["root"]);const _excluded$4=["className","component"],useUtilityClasses$4=a=>{const{classes:o}=a;return composeClasses({root:["root"]},getCardContentUtilityClass,o)},CardContentRoot=styled$1("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(a,o)=>o.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),CardContent=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiCardContent"}),{className:rt,component:lt="div"}=et,it=_objectWithoutPropertiesLoose(et,_excluded$4),ut=_extends({},et,{component:lt}),s=useUtilityClasses$4(ut);return jsxRuntimeExports.jsx(CardContentRoot,_extends({as:lt,className:clsx(s.root,rt),ownerState:ut,ref:_e},it))}),CardContent$1=CardContent,Container=createContainer({createStyledComponent:styled$1("div",{name:"MuiContainer",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[`maxWidth${capitalize(String(_e.maxWidth))}`],_e.fixed&&o.fixed,_e.disableGutters&&o.disableGutters]}}),useThemeProps:a=>useThemeProps({props:a,name:"MuiContainer"})}),Container$1=Container;function getSkeletonUtilityClass(a){return generateUtilityClass("MuiSkeleton",a)}generateUtilityClasses("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const _excluded$3=["animation","className","component","height","style","variant","width"];let _=a=>a,_t,_t2,_t3,_t4;const useUtilityClasses$3=a=>{const{classes:o,variant:_e,animation:et,hasChildren:rt,width:lt,height:it}=a;return composeClasses({root:["root",_e,et,rt&&"withChildren",rt&&!lt&&"fitContent",rt&&!it&&"heightAuto"]},getSkeletonUtilityClass,o)},pulseKeyframe=keyframes(_t||(_t=_`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`)),waveKeyframe=keyframes(_t2||(_t2=_`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`)),SkeletonRoot=styled$1("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.variant],_e.animation!==!1&&o[_e.animation],_e.hasChildren&&o.withChildren,_e.hasChildren&&!_e.width&&o.fitContent,_e.hasChildren&&!_e.height&&o.heightAuto]}})(({theme:a,ownerState:o})=>{const _e=getUnit(a.shape.borderRadius)||"px",et=toUnitless(a.shape.borderRadius);return _extends({display:"block",backgroundColor:a.vars?a.vars.palette.Skeleton.bg:alpha(a.palette.text.primary,a.palette.mode==="light"?.11:.13),height:"1.2em"},o.variant==="text"&&{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${et}${_e}/${Math.round(et/.6*10)/10}${_e}`,"&:empty:before":{content:'"\\00a0"'}},o.variant==="circular"&&{borderRadius:"50%"},o.variant==="rounded"&&{borderRadius:(a.vars||a).shape.borderRadius},o.hasChildren&&{"& > *":{visibility:"hidden"}},o.hasChildren&&!o.width&&{maxWidth:"fit-content"},o.hasChildren&&!o.height&&{height:"auto"})},({ownerState:a})=>a.animation==="pulse"&&css(_t3||(_t3=_`
      animation: ${0} 1.5s ease-in-out 0.5s infinite;
    `),pulseKeyframe),({ownerState:a,theme:o})=>a.animation==="wave"&&css(_t4||(_t4=_`
      position: relative;
      overflow: hidden;

      /* Fix bug in Safari https://bugs.webkit.org/show_bug.cgi?id=68196 */
      -webkit-mask-image: -webkit-radial-gradient(white, black);

      &::after {
        animation: ${0} 1.6s linear 0.5s infinite;
        background: linear-gradient(
          90deg,
          transparent,
          ${0},
          transparent
        );
        content: '';
        position: absolute;
        transform: translateX(-100%); /* Avoid flash during server-side hydration */
        bottom: 0;
        left: 0;
        right: 0;
        top: 0;
      }
    `),waveKeyframe,(o.vars||o).palette.action.hover)),Skeleton=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiSkeleton"}),{animation:rt="pulse",className:lt,component:it="span",height:ut,style:s,variant:tt="text",width:ot}=et,ct=_objectWithoutPropertiesLoose(et,_excluded$3),yt=_extends({},et,{animation:rt,component:it,variant:tt,hasChildren:!!ct.children}),pt=useUtilityClasses$3(yt);return jsxRuntimeExports.jsx(SkeletonRoot,_extends({as:it,ref:_e,className:clsx(pt.root,lt),ownerState:yt},ct,{style:_extends({width:ot,height:ut},s)}))}),Skeleton$1=Skeleton,StepperContext=reactExports.createContext({}),StepperContext$1=StepperContext,StepContext=reactExports.createContext({}),StepContext$1=StepContext;function getStepUtilityClass(a){return generateUtilityClass("MuiStep",a)}generateUtilityClasses("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const _excluded$2=["active","children","className","component","completed","disabled","expanded","index","last"],useUtilityClasses$2=a=>{const{classes:o,orientation:_e,alternativeLabel:et,completed:rt}=a;return composeClasses({root:["root",_e,et&&"alternativeLabel",rt&&"completed"]},getStepUtilityClass,o)},StepRoot=styled$1("div",{name:"MuiStep",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[_e.orientation],_e.alternativeLabel&&o.alternativeLabel,_e.completed&&o.completed]}})(({ownerState:a})=>_extends({},a.orientation==="horizontal"&&{paddingLeft:8,paddingRight:8},a.alternativeLabel&&{flex:1,position:"relative"})),Step=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiStep"}),{active:rt,children:lt,className:it,component:ut="div",completed:s,disabled:tt,expanded:ot=!1,index:ct,last:yt}=et,pt=_objectWithoutPropertiesLoose(et,_excluded$2),{activeStep:gt,connector:st,alternativeLabel:ft,orientation:at,nonLinear:ht}=reactExports.useContext(StepperContext$1);let[mt=!1,St=!1,It=!1]=[rt,s,tt];gt===ct?mt=rt!==void 0?rt:!0:!ht&&gt>ct?St=s!==void 0?s:!0:!ht&&gt<ct&&(It=tt!==void 0?tt:!0);const xt=reactExports.useMemo(()=>({index:ct,last:yt,expanded:ot,icon:ct+1,active:mt,completed:St,disabled:It}),[ct,yt,ot,mt,St,It]),At=_extends({},et,{active:mt,orientation:at,alternativeLabel:ft,completed:St,disabled:It,expanded:ot,component:ut}),Nt=useUtilityClasses$2(At),kt=jsxRuntimeExports.jsxs(StepRoot,_extends({as:ut,className:clsx(Nt.root,it),ref:_e,ownerState:At},pt,{children:[st&&ft&&ct!==0?st:null,lt]}));return jsxRuntimeExports.jsx(StepContext$1.Provider,{value:xt,children:st&&!ft&&ct!==0?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[st,kt]}):kt})}),Step$1=Step;function getLinkUtilityClass(a){return generateUtilityClass("MuiLink",a)}const linkClasses=generateUtilityClasses("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),linkClasses$1=linkClasses,colorTransformations={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},transformDeprecatedColors=a=>colorTransformations[a]||a,getTextDecoration=({theme:a,ownerState:o})=>{const _e=transformDeprecatedColors(o.color),et=getPath(a,`palette.${_e}`,!1)||o.color,rt=getPath(a,`palette.${_e}Channel`);return"vars"in a&&rt?`rgba(${rt} / 0.4)`:alpha(et,.4)},getTextDecoration$1=getTextDecoration,_excluded$1=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],useUtilityClasses$1=a=>{const{classes:o,component:_e,focusVisible:et,underline:rt}=a,lt={root:["root",`underline${capitalize(rt)}`,_e==="button"&&"button",et&&"focusVisible"]};return composeClasses(lt,getLinkUtilityClass,o)},LinkRoot=styled$1(Typography$1,{name:"MuiLink",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,o[`underline${capitalize(_e.underline)}`],_e.component==="button"&&o.button]}})(({theme:a,ownerState:o})=>_extends({},o.underline==="none"&&{textDecoration:"none"},o.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},o.underline==="always"&&_extends({textDecoration:"underline"},o.color!=="inherit"&&{textDecorationColor:getTextDecoration$1({theme:a,ownerState:o})},{"&:hover":{textDecorationColor:"inherit"}}),o.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${linkClasses$1.focusVisible}`]:{outline:"auto"}})),Link=reactExports.forwardRef(function(o,_e){const et=useThemeProps({props:o,name:"MuiLink"}),{className:rt,color:lt="primary",component:it="a",onBlur:ut,onFocus:s,TypographyClasses:tt,underline:ot="always",variant:ct="inherit",sx:yt}=et,pt=_objectWithoutPropertiesLoose(et,_excluded$1),{isFocusVisibleRef:gt,onBlur:st,onFocus:ft,ref:at}=useIsFocusVisible(),[ht,mt]=reactExports.useState(!1),St=useForkRef(_e,at),It=kt=>{st(kt),gt.current===!1&&mt(!1),ut&&ut(kt)},xt=kt=>{ft(kt),gt.current===!0&&mt(!0),s&&s(kt)},At=_extends({},et,{color:lt,component:it,focusVisible:ht,underline:ot,variant:ct}),Nt=useUtilityClasses$1(At);return jsxRuntimeExports.jsx(LinkRoot,_extends({color:lt,className:clsx(Nt.root,rt),classes:tt,component:it,onBlur:It,onFocus:xt,ref:St,ownerState:At,variant:ct,sx:[...Object.keys(colorTransformations).includes(lt)?[]:[{color:lt}],...Array.isArray(yt)?yt:[yt]]},pt))}),Link$1=Link,CheckBoxOutlineBlankIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),CheckBoxIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),IndeterminateCheckBoxIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function getCheckboxUtilityClass(a){return generateUtilityClass("MuiCheckbox",a)}const checkboxClasses=generateUtilityClasses("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary"]),checkboxClasses$1=checkboxClasses,_excluded=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],useUtilityClasses=a=>{const{classes:o,indeterminate:_e,color:et}=a,rt={root:["root",_e&&"indeterminate",`color${capitalize(et)}`]},lt=composeClasses(rt,getCheckboxUtilityClass,o);return _extends({},o,lt)},CheckboxRoot=styled$1(SwitchBase$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:_e}=a;return[o.root,_e.indeterminate&&o.indeterminate,_e.color!=="default"&&o[`color${capitalize(_e.color)}`]]}})(({theme:a,ownerState:o})=>_extends({color:(a.vars||a).palette.text.secondary},!o.disableRipple&&{"&:hover":{backgroundColor:a.vars?`rgba(${o.color==="default"?a.vars.palette.action.activeChannel:a.vars.palette.primary.mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(o.color==="default"?a.palette.action.active:a.palette[o.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},o.color!=="default"&&{[`&.${checkboxClasses$1.checked}, &.${checkboxClasses$1.indeterminate}`]:{color:(a.vars||a).palette[o.color].main},[`&.${checkboxClasses$1.disabled}`]:{color:(a.vars||a).palette.action.disabled}})),defaultCheckedIcon=jsxRuntimeExports.jsx(CheckBoxIcon,{}),defaultIcon=jsxRuntimeExports.jsx(CheckBoxOutlineBlankIcon,{}),defaultIndeterminateIcon=jsxRuntimeExports.jsx(IndeterminateCheckBoxIcon,{}),Checkbox=reactExports.forwardRef(function(o,_e){var et,rt;const lt=useThemeProps({props:o,name:"MuiCheckbox"}),{checkedIcon:it=defaultCheckedIcon,color:ut="primary",icon:s=defaultIcon,indeterminate:tt=!1,indeterminateIcon:ot=defaultIndeterminateIcon,inputProps:ct,size:yt="medium",className:pt}=lt,gt=_objectWithoutPropertiesLoose(lt,_excluded),st=tt?ot:s,ft=tt?ot:it,at=_extends({},lt,{color:ut,indeterminate:tt,size:yt}),ht=useUtilityClasses(at);return jsxRuntimeExports.jsx(CheckboxRoot,_extends({type:"checkbox",inputProps:_extends({"data-indeterminate":tt},ct),icon:reactExports.cloneElement(st,{fontSize:(et=st.props.fontSize)!=null?et:yt}),checkedIcon:reactExports.cloneElement(ft,{fontSize:(rt=ft.props.fontSize)!=null?rt:yt}),ownerState:at,ref:_e,className:clsx(ht.root,pt)},gt,{classes:ht}))}),Checkbox$1=Checkbox,OptIn=({id:a,checked:o,labels:_e,link:et,onChange:rt})=>jsxRuntimeExports.jsx(FormControlLabel$1,{required:!0,control:jsxRuntimeExports.jsx(Checkbox$1,{id:`${a}`,"data-testid":`${a}`,checked:o,onChange:()=>rt(a),inputProps:{"aria-label":_e.aria}}),label:jsxRuntimeExports.jsxs(Typography$1,{variant:"body1",component:"span",children:[_e.prefix,jsxRuntimeExports.jsx(Link$1,{target:"_blank",href:et,color:"info.main",children:_e.link})]}),sx:{".MuiFormControlLabel-asterisk":{display:"none"}}}),OptInList=({labels:a,optIns:o,onSubmit:_e})=>{const[et,rt]=reactExports.useState(Object.assign({},...o.map(it=>({[it.id]:!1})))),lt=it=>{rt({...et,[it]:!et[it]})};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(FormGroup$1,{children:o.map(it=>jsxRuntimeExports.jsx(OptIn,{id:it.id,checked:et[it.id],onChange:lt,labels:it.labels,link:it.link},it.id))}),jsxRuntimeExports.jsx(Box$1,{sx:{display:"flex",justifyContent:"end",mt:1},children:jsxRuntimeExports.jsx(Button$1,{variant:"outlined",disabled:!Object.values(et).every(it=>it),onClick:_e,children:a.submit})})]})},TextStepper=({activeStep:a,children:o,header:_e,sx:et={}})=>jsxRuntimeExports.jsxs(Box$1,{sx:{...et},children:[jsxRuntimeExports.jsxs(Box$1,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[_e,jsxRuntimeExports.jsxs(Typography$1,{sx:{fontWeight:500},children:[a+1,"/",React$1.Children.toArray(o).length]})]}),jsxRuntimeExports.jsx(Box$1,{sx:{padding:"16px 16px 0 16px"},children:React$1.Children.toArray(o)[a]})]}),ErrorPage=({errorType:a})=>{let o="An error occurred";switch(a){case 404:o="Invitation not found";break;case 500:o="Internal server error";break;case 401:o="You're not auhorized to join";break;default:o="An error occurred";break}return jsxRuntimeExports.jsx(Container$1,{maxWidth:"sm",sx:{height:"100vh"},children:jsxRuntimeExports.jsx(Box$1,{sx:{height:"100%"},display:"flex",alignItems:"center",justifyContent:"center",children:jsxRuntimeExports.jsx(Card$1,{children:jsxRuntimeExports.jsx(CardContent$1,{children:jsxRuntimeExports.jsx(Box$1,{children:jsxRuntimeExports.jsx(Typography$1,{variant:"h4",children:o})})})})})})},App$1="",logo=""+new URL("apizee-6b3e8e8d.svg",import.meta.url).href;var base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(a){var o=a.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var _e=a.indexOf("=");_e===-1&&(_e=o);var et=_e===o?0:4-_e%4;return[_e,et]}function byteLength(a){var o=getLens(a),_e=o[0],et=o[1];return(_e+et)*3/4-et}function _byteLength(a,o,_e){return(o+_e)*3/4-_e}function toByteArray(a){var o,_e=getLens(a),et=_e[0],rt=_e[1],lt=new Arr(_byteLength(a,et,rt)),it=0,ut=rt>0?et-4:et,s;for(s=0;s<ut;s+=4)o=revLookup[a.charCodeAt(s)]<<18|revLookup[a.charCodeAt(s+1)]<<12|revLookup[a.charCodeAt(s+2)]<<6|revLookup[a.charCodeAt(s+3)],lt[it++]=o>>16&255,lt[it++]=o>>8&255,lt[it++]=o&255;return rt===2&&(o=revLookup[a.charCodeAt(s)]<<2|revLookup[a.charCodeAt(s+1)]>>4,lt[it++]=o&255),rt===1&&(o=revLookup[a.charCodeAt(s)]<<10|revLookup[a.charCodeAt(s+1)]<<4|revLookup[a.charCodeAt(s+2)]>>2,lt[it++]=o>>8&255,lt[it++]=o&255),lt}function tripletToBase64(a){return lookup[a>>18&63]+lookup[a>>12&63]+lookup[a>>6&63]+lookup[a&63]}function encodeChunk(a,o,_e){for(var et,rt=[],lt=o;lt<_e;lt+=3)et=(a[lt]<<16&16711680)+(a[lt+1]<<8&65280)+(a[lt+2]&255),rt.push(tripletToBase64(et));return rt.join("")}function fromByteArray(a){for(var o,_e=a.length,et=_e%3,rt=[],lt=16383,it=0,ut=_e-et;it<ut;it+=lt)rt.push(encodeChunk(a,it,it+lt>ut?ut:it+lt));return et===1?(o=a[_e-1],rt.push(lookup[o>>2]+lookup[o<<4&63]+"==")):et===2&&(o=(a[_e-2]<<8)+a[_e-1],rt.push(lookup[o>>10]+lookup[o>>4&63]+lookup[o<<2&63]+"=")),rt.join("")}var sha256$1={exports:{}};/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.9.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */(function(module){(function(){var ERROR="input is invalid type",WINDOW=typeof window=="object",root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&typeof self=="object",NODE_JS=!root.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&!0&&module.exports,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(a){return typeof a=="object"&&a.buffer&&a.buffer.constructor===ArrayBuffer});var createOutputMethod=function(a,o){return function(_e){return new Sha256(o,!0).update(_e)[a]()}},createMethod=function(a){var o=createOutputMethod("hex",a);NODE_JS&&(o=nodeWrap(o,a)),o.create=function(){return new Sha256(a)},o.update=function(rt){return o.create().update(rt)};for(var _e=0;_e<OUTPUT_TYPES.length;++_e){var et=OUTPUT_TYPES[_e];o[et]=createOutputMethod(et,a)}return o},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(a){if(typeof a=="string")return crypto.createHash(algorithm).update(a,"utf8").digest("hex");if(a==null)throw new Error(ERROR);return a.constructor===ArrayBuffer&&(a=new Uint8Array(a)),Array.isArray(a)||ArrayBuffer.isView(a)||a.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(a)).digest("hex"):method(a)};return nodeMethod},createHmacOutputMethod=function(a,o){return function(_e,et){return new HmacSha256(_e,o,!0).update(et)[a]()}},createHmacMethod=function(a){var o=createHmacOutputMethod("hex",a);o.create=function(rt){return new HmacSha256(rt,a)},o.update=function(rt,lt){return o.create(rt).update(lt)};for(var _e=0;_e<OUTPUT_TYPES.length;++_e){var et=OUTPUT_TYPES[_e];o[et]=createHmacOutputMethod(et,a)}return o};function Sha256(a,o){o?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=a}Sha256.prototype.update=function(a){if(!this.finalized){var o,_e=typeof a;if(_e!=="string"){if(_e==="object"){if(a===null)throw new Error(ERROR);if(ARRAY_BUFFER&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!Array.isArray(a)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(a)))throw new Error(ERROR)}else throw new Error(ERROR);o=!0}for(var et,rt=0,lt,it=a.length,ut=this.blocks;rt<it;){if(this.hashed&&(this.hashed=!1,ut[0]=this.block,ut[16]=ut[1]=ut[2]=ut[3]=ut[4]=ut[5]=ut[6]=ut[7]=ut[8]=ut[9]=ut[10]=ut[11]=ut[12]=ut[13]=ut[14]=ut[15]=0),o)for(lt=this.start;rt<it&&lt<64;++rt)ut[lt>>2]|=a[rt]<<SHIFT[lt++&3];else for(lt=this.start;rt<it&&lt<64;++rt)et=a.charCodeAt(rt),et<128?ut[lt>>2]|=et<<SHIFT[lt++&3]:et<2048?(ut[lt>>2]|=(192|et>>6)<<SHIFT[lt++&3],ut[lt>>2]|=(128|et&63)<<SHIFT[lt++&3]):et<55296||et>=57344?(ut[lt>>2]|=(224|et>>12)<<SHIFT[lt++&3],ut[lt>>2]|=(128|et>>6&63)<<SHIFT[lt++&3],ut[lt>>2]|=(128|et&63)<<SHIFT[lt++&3]):(et=65536+((et&1023)<<10|a.charCodeAt(++rt)&1023),ut[lt>>2]|=(240|et>>18)<<SHIFT[lt++&3],ut[lt>>2]|=(128|et>>12&63)<<SHIFT[lt++&3],ut[lt>>2]|=(128|et>>6&63)<<SHIFT[lt++&3],ut[lt>>2]|=(128|et&63)<<SHIFT[lt++&3]);this.lastByteIndex=lt,this.bytes+=lt-this.start,lt>=64?(this.block=ut[16],this.start=lt-64,this.hash(),this.hashed=!0):this.start=lt}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var a=this.blocks,o=this.lastByteIndex;a[16]=this.block,a[o>>2]|=EXTRA[o&3],this.block=a[16],o>=56&&(this.hashed||this.hash(),a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),a[14]=this.hBytes<<3|this.bytes>>>29,a[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var a=this.h0,o=this.h1,_e=this.h2,et=this.h3,rt=this.h4,lt=this.h5,it=this.h6,ut=this.h7,s=this.blocks,tt,ot,ct,yt,pt,gt,st,ft,at,ht,mt;for(tt=16;tt<64;++tt)pt=s[tt-15],ot=(pt>>>7|pt<<25)^(pt>>>18|pt<<14)^pt>>>3,pt=s[tt-2],ct=(pt>>>17|pt<<15)^(pt>>>19|pt<<13)^pt>>>10,s[tt]=s[tt-16]+ot+s[tt-7]+ct<<0;for(mt=o&_e,tt=0;tt<64;tt+=4)this.first?(this.is224?(ft=300032,pt=s[0]-1413257819,ut=pt-150054599<<0,et=pt+24177077<<0):(ft=704751109,pt=s[0]-210244248,ut=pt-1521486534<<0,et=pt+143694565<<0),this.first=!1):(ot=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),ct=(rt>>>6|rt<<26)^(rt>>>11|rt<<21)^(rt>>>25|rt<<7),ft=a&o,yt=ft^a&_e^mt,st=rt&lt^~rt&it,pt=ut+ct+st+K[tt]+s[tt],gt=ot+yt,ut=et+pt<<0,et=pt+gt<<0),ot=(et>>>2|et<<30)^(et>>>13|et<<19)^(et>>>22|et<<10),ct=(ut>>>6|ut<<26)^(ut>>>11|ut<<21)^(ut>>>25|ut<<7),at=et&a,yt=at^et&o^ft,st=ut&rt^~ut&lt,pt=it+ct+st+K[tt+1]+s[tt+1],gt=ot+yt,it=_e+pt<<0,_e=pt+gt<<0,ot=(_e>>>2|_e<<30)^(_e>>>13|_e<<19)^(_e>>>22|_e<<10),ct=(it>>>6|it<<26)^(it>>>11|it<<21)^(it>>>25|it<<7),ht=_e&et,yt=ht^_e&a^at,st=it&ut^~it&rt,pt=lt+ct+st+K[tt+2]+s[tt+2],gt=ot+yt,lt=o+pt<<0,o=pt+gt<<0,ot=(o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10),ct=(lt>>>6|lt<<26)^(lt>>>11|lt<<21)^(lt>>>25|lt<<7),mt=o&_e,yt=mt^o&et^ht,st=lt&it^~lt&ut,pt=rt+ct+st+K[tt+3]+s[tt+3],gt=ot+yt,rt=a+pt<<0,a=pt+gt<<0;this.h0=this.h0+a<<0,this.h1=this.h1+o<<0,this.h2=this.h2+_e<<0,this.h3=this.h3+et<<0,this.h4=this.h4+rt<<0,this.h5=this.h5+lt<<0,this.h6=this.h6+it<<0,this.h7=this.h7+ut<<0},Sha256.prototype.hex=function(){this.finalize();var a=this.h0,o=this.h1,_e=this.h2,et=this.h3,rt=this.h4,lt=this.h5,it=this.h6,ut=this.h7,s=HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[a&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[o&15]+HEX_CHARS[_e>>28&15]+HEX_CHARS[_e>>24&15]+HEX_CHARS[_e>>20&15]+HEX_CHARS[_e>>16&15]+HEX_CHARS[_e>>12&15]+HEX_CHARS[_e>>8&15]+HEX_CHARS[_e>>4&15]+HEX_CHARS[_e&15]+HEX_CHARS[et>>28&15]+HEX_CHARS[et>>24&15]+HEX_CHARS[et>>20&15]+HEX_CHARS[et>>16&15]+HEX_CHARS[et>>12&15]+HEX_CHARS[et>>8&15]+HEX_CHARS[et>>4&15]+HEX_CHARS[et&15]+HEX_CHARS[rt>>28&15]+HEX_CHARS[rt>>24&15]+HEX_CHARS[rt>>20&15]+HEX_CHARS[rt>>16&15]+HEX_CHARS[rt>>12&15]+HEX_CHARS[rt>>8&15]+HEX_CHARS[rt>>4&15]+HEX_CHARS[rt&15]+HEX_CHARS[lt>>28&15]+HEX_CHARS[lt>>24&15]+HEX_CHARS[lt>>20&15]+HEX_CHARS[lt>>16&15]+HEX_CHARS[lt>>12&15]+HEX_CHARS[lt>>8&15]+HEX_CHARS[lt>>4&15]+HEX_CHARS[lt&15]+HEX_CHARS[it>>28&15]+HEX_CHARS[it>>24&15]+HEX_CHARS[it>>20&15]+HEX_CHARS[it>>16&15]+HEX_CHARS[it>>12&15]+HEX_CHARS[it>>8&15]+HEX_CHARS[it>>4&15]+HEX_CHARS[it&15];return this.is224||(s+=HEX_CHARS[ut>>28&15]+HEX_CHARS[ut>>24&15]+HEX_CHARS[ut>>20&15]+HEX_CHARS[ut>>16&15]+HEX_CHARS[ut>>12&15]+HEX_CHARS[ut>>8&15]+HEX_CHARS[ut>>4&15]+HEX_CHARS[ut&15]),s},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var a=this.h0,o=this.h1,_e=this.h2,et=this.h3,rt=this.h4,lt=this.h5,it=this.h6,ut=this.h7,s=[a>>24&255,a>>16&255,a>>8&255,a&255,o>>24&255,o>>16&255,o>>8&255,o&255,_e>>24&255,_e>>16&255,_e>>8&255,_e&255,et>>24&255,et>>16&255,et>>8&255,et&255,rt>>24&255,rt>>16&255,rt>>8&255,rt&255,lt>>24&255,lt>>16&255,lt>>8&255,lt&255,it>>24&255,it>>16&255,it>>8&255,it&255];return this.is224||s.push(ut>>24&255,ut>>16&255,ut>>8&255,ut&255),s},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var a=new ArrayBuffer(this.is224?28:32),o=new DataView(a);return o.setUint32(0,this.h0),o.setUint32(4,this.h1),o.setUint32(8,this.h2),o.setUint32(12,this.h3),o.setUint32(16,this.h4),o.setUint32(20,this.h5),o.setUint32(24,this.h6),this.is224||o.setUint32(28,this.h7),a};function HmacSha256(a,o,_e){var et,rt=typeof a;if(rt==="string"){var lt=[],it=a.length,ut=0,s;for(et=0;et<it;++et)s=a.charCodeAt(et),s<128?lt[ut++]=s:s<2048?(lt[ut++]=192|s>>6,lt[ut++]=128|s&63):s<55296||s>=57344?(lt[ut++]=224|s>>12,lt[ut++]=128|s>>6&63,lt[ut++]=128|s&63):(s=65536+((s&1023)<<10|a.charCodeAt(++et)&1023),lt[ut++]=240|s>>18,lt[ut++]=128|s>>12&63,lt[ut++]=128|s>>6&63,lt[ut++]=128|s&63);a=lt}else if(rt==="object"){if(a===null)throw new Error(ERROR);if(ARRAY_BUFFER&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!Array.isArray(a)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(a)))throw new Error(ERROR)}else throw new Error(ERROR);a.length>64&&(a=new Sha256(o,!0).update(a).array());var tt=[],ot=[];for(et=0;et<64;++et){var ct=a[et]||0;tt[et]=92^ct,ot[et]=54^ct}Sha256.call(this,o,_e),this.update(ot),this.oKeyPad=tt,this.inner=!0,this.sharedMemory=_e}HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var a=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(a),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)})()})(sha256$1);var sha256Exports=sha256$1.exports;const sha256=getDefaultExportFromCjs(sha256Exports);if(typeof Promise>"u")throw Error("Keycloak requires an environment that supports Promises. Make sure that you include the appropriate polyfill.");var loggedPromiseDeprecation=!1;function logPromiseDeprecation(){loggedPromiseDeprecation||(loggedPromiseDeprecation=!0,console.warn("[KEYCLOAK] Usage of legacy style promise methods such as `.error()` and `.success()` has been deprecated and support will be removed in future versions. Use standard style promise methods such as `.then() and `.catch()` instead."))}function Keycloak(a){if(!(this instanceof Keycloak))return new Keycloak(a);for(var o=this,_e,et=[],rt,lt={enable:!0,callbackList:[],interval:5},it=document.getElementsByTagName("script"),ut=0;ut<it.length;ut++)(it[ut].src.indexOf("keycloak.js")!==-1||it[ut].src.indexOf("keycloak.min.js")!==-1)&&it[ut].src.indexOf("version=")!==-1&&(o.iframeVersion=it[ut].src.substring(it[ut].src.indexOf("version=")+8).split("&")[0]);var s=!0,tt=Tn(console.info),ot=Tn(console.warn);o.init=function(dn){o.authenticated=!1,rt=Cn();var mn=["default","cordova","cordova-native"];if(dn&&mn.indexOf(dn.adapter)>-1?_e=tn(dn.adapter):dn&&typeof dn.adapter=="object"?_e=dn.adapter:window.Cordova||window.cordova?_e=tn("cordova"):_e=tn(),dn){if(typeof dn.useNonce<"u"&&(s=dn.useNonce),typeof dn.checkLoginIframe<"u"&&(lt.enable=dn.checkLoginIframe),dn.checkLoginIframeInterval&&(lt.interval=dn.checkLoginIframeInterval),dn.onLoad==="login-required"&&(o.loginRequired=!0),dn.responseMode)if(dn.responseMode==="query"||dn.responseMode==="fragment")o.responseMode=dn.responseMode;else throw"Invalid value for responseMode";if(dn.flow){switch(dn.flow){case"standard":o.responseType="code";break;case"implicit":o.responseType="id_token token";break;case"hybrid":o.responseType="code id_token token";break;default:throw"Invalid value for flow"}o.flow=dn.flow}if(dn.timeSkew!=null&&(o.timeSkew=dn.timeSkew),dn.redirectUri&&(o.redirectUri=dn.redirectUri),dn.silentCheckSsoRedirectUri&&(o.silentCheckSsoRedirectUri=dn.silentCheckSsoRedirectUri),typeof dn.silentCheckSsoFallback=="boolean"?o.silentCheckSsoFallback=dn.silentCheckSsoFallback:o.silentCheckSsoFallback=!0,dn.pkceMethod){if(dn.pkceMethod!=="S256")throw"Invalid value for pkceMethod";o.pkceMethod=dn.pkceMethod}typeof dn.enableLogging=="boolean"?o.enableLogging=dn.enableLogging:o.enableLogging=!1,typeof dn.scope=="string"&&(o.scope=dn.scope),typeof dn.messageReceiveTimeout=="number"&&dn.messageReceiveTimeout>0?o.messageReceiveTimeout=dn.messageReceiveTimeout:o.messageReceiveTimeout=1e4}o.responseMode||(o.responseMode="fragment"),o.responseType||(o.responseType="code",o.flow="standard");var yn=bt(),pn=bt();pn.promise.then(function(){o.onReady&&o.onReady(o.authenticated),yn.setSuccess(o.authenticated)}).catch(function(Nn){yn.setError(Nn)});var In=mt();function On(){var Nn=function(Fn){Fn||(Pn.prompt="none"),o.login(Pn).then(function(){pn.setSuccess()}).catch(function(ar){pn.setError(ar)})},wn=function(){var Fn=document.createElement("iframe"),ar=o.createLoginUrl({prompt:"none",redirectUri:o.silentCheckSsoRedirectUri});Fn.setAttribute("src",ar),Fn.setAttribute("title","keycloak-silent-check-sso"),Fn.style.display="none",document.body.appendChild(Fn);var Yn=function(Xn){if(!(Xn.origin!==window.location.origin||Fn.contentWindow!==Xn.source)){var tr=Nt(Xn.data);ht(tr,pn),document.body.removeChild(Fn),window.removeEventListener("message",Yn)}};window.addEventListener("message",Yn)},Pn={};switch(dn.onLoad){case"check-sso":lt.enable?Ht().then(function(){nn().then(function(Fn){Fn?pn.setSuccess():o.silentCheckSsoRedirectUri?wn():Nn(!1)}).catch(function(Fn){pn.setError(Fn)})}):o.silentCheckSsoRedirectUri?wn():Nn(!1);break;case"login-required":Nn(!0);break;default:throw"Invalid value for onLoad"}}function _n(){var Nn=Nt(window.location.href);if(Nn&&window.history.replaceState(window.history.state,null,Nn.newUrl),Nn&&Nn.valid)return Ht().then(function(){ht(Nn,pn)}).catch(function(wn){pn.setError(wn)});dn?dn.token&&dn.refreshToken?(It(dn.token,dn.refreshToken,dn.idToken),lt.enable?Ht().then(function(){nn().then(function(wn){wn?(o.onAuthSuccess&&o.onAuthSuccess(),pn.setSuccess(),Wt()):pn.setSuccess()}).catch(function(wn){pn.setError(wn)})}):o.updateToken(-1).then(function(){o.onAuthSuccess&&o.onAuthSuccess(),pn.setSuccess()}).catch(function(wn){o.onAuthError&&o.onAuthError(),dn.onLoad?On():pn.setError(wn)})):dn.onLoad?On():pn.setSuccess():pn.setSuccess()}function Mn(){var Nn=bt(),wn=function(){(document.readyState==="interactive"||document.readyState==="complete")&&(document.removeEventListener("readystatechange",wn),Nn.setSuccess())};return document.addEventListener("readystatechange",wn),wn(),Nn.promise}return In.then(function(){Mn().then(gn).then(_n).catch(function(Nn){yn.setError(Nn)})}),In.catch(function(Nn){yn.setError(Nn)}),yn.promise},o.login=function(dn){return _e.login(dn)};function ct(dn){var mn=null,yn=window.crypto||window.msCrypto;if(yn&&yn.getRandomValues&&window.Uint8Array)return mn=new Uint8Array(dn),yn.getRandomValues(mn),mn;mn=new Array(dn);for(var pn=0;pn<mn.length;pn++)mn[pn]=Math.floor(256*Math.random());return mn}function yt(dn){return pt(dn,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")}function pt(dn,mn){for(var yn=ct(dn),pn=new Array(dn),In=0;In<dn;In++)pn[In]=mn.charCodeAt(yn[In]%mn.length);return String.fromCharCode.apply(null,pn)}function gt(dn,mn){switch(dn){case"S256":var yn=new Uint8Array(sha256.arrayBuffer(mn)),pn=base64Js.fromByteArray(yn).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");return pn;default:throw"Invalid value for pkceMethod"}}function st(dn){var mn={id_token:{acr:dn}};return JSON.stringify(mn)}o.createLoginUrl=function(dn){var mn=At(),yn=At(),pn=_e.redirectUri(dn),In={state:mn,nonce:yn,redirectUri:encodeURIComponent(pn)};dn&&dn.prompt&&(In.prompt=dn.prompt);var On;dn&&dn.action=="register"?On=o.endpoints.register():On=o.endpoints.authorize();var _n=dn&&dn.scope||o.scope;_n?_n.indexOf("openid")===-1&&(_n="openid "+_n):_n="openid";var Mn=On+"?client_id="+encodeURIComponent(o.clientId)+"&redirect_uri="+encodeURIComponent(pn)+"&state="+encodeURIComponent(mn)+"&response_mode="+encodeURIComponent(o.responseMode)+"&response_type="+encodeURIComponent(o.responseType)+"&scope="+encodeURIComponent(_n);if(s&&(Mn=Mn+"&nonce="+encodeURIComponent(yn)),dn&&dn.prompt&&(Mn+="&prompt="+encodeURIComponent(dn.prompt)),dn&&dn.maxAge&&(Mn+="&max_age="+encodeURIComponent(dn.maxAge)),dn&&dn.loginHint&&(Mn+="&login_hint="+encodeURIComponent(dn.loginHint)),dn&&dn.idpHint&&(Mn+="&kc_idp_hint="+encodeURIComponent(dn.idpHint)),dn&&dn.action&&dn.action!="register"&&(Mn+="&kc_action="+encodeURIComponent(dn.action)),dn&&dn.locale&&(Mn+="&ui_locales="+encodeURIComponent(dn.locale)),dn&&dn.acr){var Nn=st(dn.acr);Mn+="&claims="+encodeURIComponent(Nn)}if(o.pkceMethod){var wn=yt(96);In.pkceCodeVerifier=wn;var Pn=gt(o.pkceMethod,wn);Mn+="&code_challenge="+Pn,Mn+="&code_challenge_method="+o.pkceMethod}return rt.add(In),Mn},o.logout=function(dn){return _e.logout(dn)},o.createLogoutUrl=function(dn){var mn=o.endpoints.logout()+"?post_logout_redirect_uri="+encodeURIComponent(_e.redirectUri(dn,!1))+"&id_token_hint="+encodeURIComponent(o.idToken);return mn},o.register=function(dn){return _e.register(dn)},o.createRegisterUrl=function(dn){return dn||(dn={}),dn.action="register",o.createLoginUrl(dn)},o.createAccountUrl=function(dn){var mn=ft(),yn=void 0;return typeof mn<"u"&&(yn=mn+"/account?referrer="+encodeURIComponent(o.clientId)+"&referrer_uri="+encodeURIComponent(_e.redirectUri(dn))),yn},o.accountManagement=function(){return _e.accountManagement()},o.hasRealmRole=function(dn){var mn=o.realmAccess;return!!mn&&mn.roles.indexOf(dn)>=0},o.hasResourceRole=function(dn,mn){if(!o.resourceAccess)return!1;var yn=o.resourceAccess[mn||o.clientId];return!!yn&&yn.roles.indexOf(dn)>=0},o.loadUserProfile=function(){var dn=ft()+"/account",mn=new XMLHttpRequest;mn.open("GET",dn,!0),mn.setRequestHeader("Accept","application/json"),mn.setRequestHeader("Authorization","bearer "+o.token);var yn=bt();return mn.onreadystatechange=function(){mn.readyState==4&&(mn.status==200?(o.profile=JSON.parse(mn.responseText),yn.setSuccess(o.profile)):yn.setError())},mn.send(),yn.promise},o.loadUserInfo=function(){var dn=o.endpoints.userinfo(),mn=new XMLHttpRequest;mn.open("GET",dn,!0),mn.setRequestHeader("Accept","application/json"),mn.setRequestHeader("Authorization","bearer "+o.token);var yn=bt();return mn.onreadystatechange=function(){mn.readyState==4&&(mn.status==200?(o.userInfo=JSON.parse(mn.responseText),yn.setSuccess(o.userInfo)):yn.setError())},mn.send(),yn.promise},o.isTokenExpired=function(dn){if(!o.tokenParsed||!o.refreshToken&&o.flow!="implicit")throw"Not authenticated";if(o.timeSkew==null)return tt("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var mn=o.tokenParsed.exp-Math.ceil(new Date().getTime()/1e3)+o.timeSkew;if(dn){if(isNaN(dn))throw"Invalid minValidity";mn-=dn}return mn<0},o.updateToken=function(dn){var mn=bt();if(!o.refreshToken)return mn.setError(),mn.promise;dn=dn||5;var yn=function(){var In=!1;if(dn==-1?(In=!0,tt("[KEYCLOAK] Refreshing token: forced refresh")):(!o.tokenParsed||o.isTokenExpired(dn))&&(In=!0,tt("[KEYCLOAK] Refreshing token: token expired")),!In)mn.setSuccess(!1);else{var On="grant_type=refresh_token&refresh_token="+o.refreshToken,_n=o.endpoints.token();if(et.push(mn),et.length==1){var Mn=new XMLHttpRequest;Mn.open("POST",_n,!0),Mn.setRequestHeader("Content-type","application/x-www-form-urlencoded"),Mn.withCredentials=!0,On+="&client_id="+encodeURIComponent(o.clientId);var Nn=new Date().getTime();Mn.onreadystatechange=function(){if(Mn.readyState==4)if(Mn.status==200){tt("[KEYCLOAK] Token refreshed"),Nn=(Nn+new Date().getTime())/2;var wn=JSON.parse(Mn.responseText);It(wn.access_token,wn.refresh_token,wn.id_token,Nn),o.onAuthRefreshSuccess&&o.onAuthRefreshSuccess();for(var Pn=et.pop();Pn!=null;Pn=et.pop())Pn.setSuccess(!0)}else{ot("[KEYCLOAK] Failed to refresh token"),Mn.status==400&&o.clearToken(),o.onAuthRefreshError&&o.onAuthRefreshError();for(var Pn=et.pop();Pn!=null;Pn=et.pop())Pn.setError(!0)}},Mn.send(On)}}};if(lt.enable){var pn=nn();pn.then(function(){yn()}).catch(function(In){mn.setError(In)})}else yn();return mn.promise},o.clearToken=function(){o.token&&(It(null,null,null),o.onAuthLogout&&o.onAuthLogout(),o.loginRequired&&o.login())};function ft(){if(typeof o.authServerUrl<"u")return o.authServerUrl.charAt(o.authServerUrl.length-1)=="/"?o.authServerUrl+"realms/"+encodeURIComponent(o.realm):o.authServerUrl+"/realms/"+encodeURIComponent(o.realm)}function at(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function ht(dn,mn){var yn=dn.code,pn=dn.error,In=dn.prompt,On=new Date().getTime();if(dn.kc_action_status&&o.onActionUpdate&&o.onActionUpdate(dn.kc_action_status),pn){if(In!="none"){var _n={error:pn,error_description:dn.error_description};o.onAuthError&&o.onAuthError(_n),mn&&mn.setError(_n)}else mn&&mn.setSuccess();return}else o.flow!="standard"&&(dn.access_token||dn.id_token)&&Pn(dn.access_token,null,dn.id_token,!0);if(o.flow!="implicit"&&yn){var Mn="code="+yn+"&grant_type=authorization_code",Nn=o.endpoints.token(),wn=new XMLHttpRequest;wn.open("POST",Nn,!0),wn.setRequestHeader("Content-type","application/x-www-form-urlencoded"),Mn+="&client_id="+encodeURIComponent(o.clientId),Mn+="&redirect_uri="+dn.redirectUri,dn.pkceCodeVerifier&&(Mn+="&code_verifier="+dn.pkceCodeVerifier),wn.withCredentials=!0,wn.onreadystatechange=function(){if(wn.readyState==4)if(wn.status==200){var Fn=JSON.parse(wn.responseText);Pn(Fn.access_token,Fn.refresh_token,Fn.id_token,o.flow==="standard"),Wt()}else o.onAuthError&&o.onAuthError(),mn&&mn.setError()},wn.send(Mn)}function Pn(Fn,ar,Yn,Xn){On=(On+new Date().getTime())/2,It(Fn,ar,Yn,On),s&&(o.tokenParsed&&o.tokenParsed.nonce!=dn.storedNonce||o.refreshTokenParsed&&o.refreshTokenParsed.nonce!=dn.storedNonce||o.idTokenParsed&&o.idTokenParsed.nonce!=dn.storedNonce)?(tt("[KEYCLOAK] Invalid nonce, clearing token"),o.clearToken(),mn&&mn.setError()):Xn&&(o.onAuthSuccess&&o.onAuthSuccess(),mn&&mn.setSuccess())}}function mt(dn){var mn=bt(),yn;a?typeof a=="string"&&(yn=a):yn="keycloak.json";function pn(wn){wn?o.endpoints={authorize:function(){return wn.authorization_endpoint},token:function(){return wn.token_endpoint},logout:function(){if(!wn.end_session_endpoint)throw"Not supported by the OIDC server";return wn.end_session_endpoint},checkSessionIframe:function(){if(!wn.check_session_iframe)throw"Not supported by the OIDC server";return wn.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!wn.userinfo_endpoint)throw"Not supported by the OIDC server";return wn.userinfo_endpoint}}:o.endpoints={authorize:function(){return ft()+"/protocol/openid-connect/auth"},token:function(){return ft()+"/protocol/openid-connect/token"},logout:function(){return ft()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){var Pn=ft()+"/protocol/openid-connect/login-status-iframe.html";return o.iframeVersion&&(Pn=Pn+"?version="+o.iframeVersion),Pn},thirdPartyCookiesIframe:function(){var Pn=ft()+"/protocol/openid-connect/3p-cookies/step1.html";return o.iframeVersion&&(Pn=Pn+"?version="+o.iframeVersion),Pn},register:function(){return ft()+"/protocol/openid-connect/registrations"},userinfo:function(){return ft()+"/protocol/openid-connect/userinfo"}}}if(yn){var In=new XMLHttpRequest;In.open("GET",yn,!0),In.setRequestHeader("Accept","application/json"),In.onreadystatechange=function(){if(In.readyState==4)if(In.status==200||St(In)){var wn=JSON.parse(In.responseText);o.authServerUrl=wn["auth-server-url"],o.realm=wn.realm,o.clientId=wn.resource,pn(null),mn.setSuccess()}else mn.setError()},In.send()}else{if(!a.clientId)throw"clientId missing";o.clientId=a.clientId;var On=a.oidcProvider;if(On)if(typeof On=="string"){var Nn;On.charAt(On.length-1)=="/"?Nn=On+".well-known/openid-configuration":Nn=On+"/.well-known/openid-configuration";var In=new XMLHttpRequest;In.open("GET",Nn,!0),In.setRequestHeader("Accept","application/json"),In.onreadystatechange=function(){if(In.readyState==4)if(In.status==200||St(In)){var Pn=JSON.parse(In.responseText);pn(Pn),mn.setSuccess()}else mn.setError()},In.send()}else pn(On),mn.setSuccess();else{if(!a.url){for(var _n=document.getElementsByTagName("script"),Mn=0;Mn<_n.length;Mn++)if(_n[Mn].src.match(/.*keycloak\.js/)){a.url=_n[Mn].src.substr(0,_n[Mn].src.indexOf("/js/keycloak.js"));break}}if(!a.realm)throw"realm missing";o.authServerUrl=a.url,o.realm=a.realm,pn(null),mn.setSuccess()}}return mn.promise}function St(dn){return dn.status==0&&dn.responseText&&dn.responseURL.startsWith("file:")}function It(dn,mn,yn,pn){if(o.tokenTimeoutHandle&&(clearTimeout(o.tokenTimeoutHandle),o.tokenTimeoutHandle=null),mn?(o.refreshToken=mn,o.refreshTokenParsed=xt(mn)):(delete o.refreshToken,delete o.refreshTokenParsed),yn?(o.idToken=yn,o.idTokenParsed=xt(yn)):(delete o.idToken,delete o.idTokenParsed),dn){if(o.token=dn,o.tokenParsed=xt(dn),o.sessionId=o.tokenParsed.session_state,o.authenticated=!0,o.subject=o.tokenParsed.sub,o.realmAccess=o.tokenParsed.realm_access,o.resourceAccess=o.tokenParsed.resource_access,pn&&(o.timeSkew=Math.floor(pn/1e3)-o.tokenParsed.iat),o.timeSkew!=null&&(tt("[KEYCLOAK] Estimated time difference between browser and server is "+o.timeSkew+" seconds"),o.onTokenExpired)){var In=(o.tokenParsed.exp-new Date().getTime()/1e3+o.timeSkew)*1e3;tt("[KEYCLOAK] Token expires in "+Math.round(In/1e3)+" s"),In<=0?o.onTokenExpired():o.tokenTimeoutHandle=setTimeout(o.onTokenExpired,In)}}else delete o.token,delete o.tokenParsed,delete o.subject,delete o.realmAccess,delete o.resourceAccess,o.authenticated=!1}function xt(dn){switch(dn=dn.split(".")[1],dn=dn.replace(/-/g,"+"),dn=dn.replace(/_/g,"/"),dn.length%4){case 0:break;case 2:dn+="==";break;case 3:dn+="=";break;default:throw"Invalid token"}return dn=decodeURIComponent(escape(atob(dn))),dn=JSON.parse(dn),dn}function At(){var dn="0123456789abcdef",mn=pt(36,dn).split("");mn[14]="4",mn[19]=dn.substr(mn[19]&3|8,1),mn[8]=mn[13]=mn[18]=mn[23]="-";var yn=mn.join("");return yn}function Nt(dn){var mn=kt(dn);if(mn){var yn=rt.get(mn.state);return yn&&(mn.valid=!0,mn.redirectUri=yn.redirectUri,mn.storedNonce=yn.nonce,mn.prompt=yn.prompt,mn.pkceCodeVerifier=yn.pkceCodeVerifier),mn}}function kt(dn){var mn;switch(o.flow){case"standard":mn=["code","state","session_state","kc_action_status"];break;case"implicit":mn=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status"];break;case"hybrid":mn=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status"];break}mn.push("error"),mn.push("error_description"),mn.push("error_uri");var yn=dn.indexOf("?"),pn=dn.indexOf("#"),In,On;if(o.responseMode==="query"&&yn!==-1?(In=dn.substring(0,yn),On=Mt(dn.substring(yn+1,pn!==-1?pn:dn.length),mn),On.paramsString!==""&&(In+="?"+On.paramsString),pn!==-1&&(In+=dn.substring(pn))):o.responseMode==="fragment"&&pn!==-1&&(In=dn.substring(0,pn),On=Mt(dn.substring(pn+1),mn),On.paramsString!==""&&(In+="#"+On.paramsString)),On&&On.oauthParams){if(o.flow==="standard"||o.flow==="hybrid"){if((On.oauthParams.code||On.oauthParams.error)&&On.oauthParams.state)return On.oauthParams.newUrl=In,On.oauthParams}else if(o.flow==="implicit"&&(On.oauthParams.access_token||On.oauthParams.error)&&On.oauthParams.state)return On.oauthParams.newUrl=In,On.oauthParams}}function Mt(dn,mn){for(var yn=dn.split("&"),pn={paramsString:"",oauthParams:{}},In=0;In<yn.length;In++){var On=yn[In].indexOf("="),_n=yn[In].slice(0,On);mn.indexOf(_n)!==-1?pn.oauthParams[_n]=yn[In].slice(On+1):(pn.paramsString!==""&&(pn.paramsString+="&"),pn.paramsString+=yn[In])}return pn}function bt(){var dn={setSuccess:function(mn){dn.resolve(mn)},setError:function(mn){dn.reject(mn)}};return dn.promise=new Promise(function(mn,yn){dn.resolve=mn,dn.reject=yn}),dn.promise.success=function(mn){return logPromiseDeprecation(),this.then(function(pn){mn(pn)}),this},dn.promise.error=function(mn){return logPromiseDeprecation(),this.catch(function(pn){mn(pn)}),this},dn}function Bt(dn,mn,yn){var pn=null,In=new Promise(function(On,_n){pn=setTimeout(function(){_n({error:yn||"Promise is not settled within timeout of "+mn+"ms"})},mn)});return Promise.race([dn,In]).finally(function(){clearTimeout(pn)})}function Ht(){var dn=bt();if(!lt.enable||lt.iframe)return dn.setSuccess(),dn.promise;var mn=document.createElement("iframe");lt.iframe=mn,mn.onload=function(){var In=o.endpoints.authorize();In.charAt(0)==="/"?lt.iframeOrigin=at():lt.iframeOrigin=In.substring(0,In.indexOf("/",8)),dn.setSuccess()};var yn=o.endpoints.checkSessionIframe();mn.setAttribute("src",yn),mn.setAttribute("title","keycloak-session-iframe"),mn.style.display="none",document.body.appendChild(mn);var pn=function(In){if(!(In.origin!==lt.iframeOrigin||lt.iframe.contentWindow!==In.source)&&(In.data=="unchanged"||In.data=="changed"||In.data=="error")){In.data!="unchanged"&&o.clearToken();for(var On=lt.callbackList.splice(0,lt.callbackList.length),_n=On.length-1;_n>=0;--_n){var Mn=On[_n];In.data=="error"?Mn.setError():Mn.setSuccess(In.data=="unchanged")}}};return window.addEventListener("message",pn,!1),dn.promise}function Wt(){lt.enable&&o.token&&setTimeout(function(){nn().then(function(dn){dn&&Wt()})},lt.interval*1e3)}function nn(){var dn=bt();if(lt.iframe&&lt.iframeOrigin){var mn=o.clientId+" "+(o.sessionId?o.sessionId:"");lt.callbackList.push(dn);var yn=lt.iframeOrigin;lt.callbackList.length==1&&lt.iframe.contentWindow.postMessage(mn,yn)}else dn.setSuccess();return dn.promise}function gn(){var dn=bt();if(lt.enable||o.silentCheckSsoRedirectUri){var mn=document.createElement("iframe");mn.setAttribute("src",o.endpoints.thirdPartyCookiesIframe()),mn.setAttribute("title","keycloak-3p-check-iframe"),mn.style.display="none",document.body.appendChild(mn);var yn=function(pn){mn.contentWindow===pn.source&&(pn.data!=="supported"&&pn.data!=="unsupported"||(pn.data==="unsupported"&&(lt.enable=!1,o.silentCheckSsoFallback&&(o.silentCheckSsoRedirectUri=!1),ot("[KEYCLOAK] 3rd party cookies aren't supported by this browser. checkLoginIframe and silent check-sso are not available.")),document.body.removeChild(mn),window.removeEventListener("message",yn),dn.setSuccess()))};window.addEventListener("message",yn,!1)}else dn.setSuccess();return Bt(dn.promise,o.messageReceiveTimeout,"Timeout when waiting for 3rd party check iframe message.")}function tn(dn){if(!dn||dn=="default")return{login:function(On){return window.location.replace(o.createLoginUrl(On)),bt().promise},logout:function(On){return window.location.replace(o.createLogoutUrl(On)),bt().promise},register:function(On){return window.location.replace(o.createRegisterUrl(On)),bt().promise},accountManagement:function(){var On=o.createAccountUrl();if(typeof On<"u")window.location.href=On;else throw"Not supported by the OIDC server";return bt().promise},redirectUri:function(On,_n){return On&&On.redirectUri?On.redirectUri:o.redirectUri?o.redirectUri:location.href}};if(dn=="cordova"){lt.enable=!1;var mn=function(On,_n,Mn){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(On,_n,Mn):window.open(On,_n,Mn)},yn=function(On){return On&&On.cordovaOptions?Object.keys(On.cordovaOptions).reduce(function(_n,Mn){return _n[Mn]=On.cordovaOptions[Mn],_n},{}):{}},pn=function(On){return Object.keys(On).reduce(function(_n,Mn){return _n.push(Mn+"="+On[Mn]),_n},[]).join(",")},In=function(On){var _n=yn(On);return _n.location="no",On&&On.prompt=="none"&&(_n.hidden="yes"),pn(_n)};return{login:function(On){var _n=bt(),Mn=In(On),Nn=o.createLoginUrl(On),wn=mn(Nn,"_blank",Mn),Pn=!1,Fn=!1,ar=function(){Fn=!0,wn.close()};return wn.addEventListener("loadstart",function(Yn){if(Yn.url.indexOf("http://localhost")==0){var Xn=Nt(Yn.url);ht(Xn,_n),ar(),Pn=!0}}),wn.addEventListener("loaderror",function(Yn){if(!Pn)if(Yn.url.indexOf("http://localhost")==0){var Xn=Nt(Yn.url);ht(Xn,_n),ar(),Pn=!0}else _n.setError(),ar()}),wn.addEventListener("exit",function(Yn){Fn||_n.setError({reason:"closed_by_user"})}),_n.promise},logout:function(On){var _n=bt(),Mn=o.createLogoutUrl(On),Nn=mn(Mn,"_blank","location=no,hidden=yes,clearcache=yes"),wn;return Nn.addEventListener("loadstart",function(Pn){Pn.url.indexOf("http://localhost")==0&&Nn.close()}),Nn.addEventListener("loaderror",function(Pn){Pn.url.indexOf("http://localhost")==0||(wn=!0),Nn.close()}),Nn.addEventListener("exit",function(Pn){wn?_n.setError():(o.clearToken(),_n.setSuccess())}),_n.promise},register:function(On){var _n=bt(),Mn=o.createRegisterUrl(),Nn=In(On),wn=mn(Mn,"_blank",Nn);return wn.addEventListener("loadstart",function(Pn){if(Pn.url.indexOf("http://localhost")==0){wn.close();var Fn=Nt(Pn.url);ht(Fn,_n)}}),_n.promise},accountManagement:function(){var On=o.createAccountUrl();if(typeof On<"u"){var _n=mn(On,"_blank","location=no");_n.addEventListener("loadstart",function(Mn){Mn.url.indexOf("http://localhost")==0&&_n.close()})}else throw"Not supported by the OIDC server"},redirectUri:function(On){return"http://localhost"}}}if(dn=="cordova-native")return lt.enable=!1,{login:function(On){var _n=bt(),Mn=o.createLoginUrl(On);return universalLinks.subscribe("keycloak",function(Nn){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var wn=Nt(Nn.url);ht(wn,_n)}),window.cordova.plugins.browsertab.openUrl(Mn),_n.promise},logout:function(On){var _n=bt(),Mn=o.createLogoutUrl(On);return universalLinks.subscribe("keycloak",function(Nn){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),o.clearToken(),_n.setSuccess()}),window.cordova.plugins.browsertab.openUrl(Mn),_n.promise},register:function(On){var _n=bt(),Mn=o.createRegisterUrl(On);return universalLinks.subscribe("keycloak",function(Nn){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var wn=Nt(Nn.url);ht(wn,_n)}),window.cordova.plugins.browsertab.openUrl(Mn),_n.promise},accountManagement:function(){var On=o.createAccountUrl();if(typeof On<"u")window.cordova.plugins.browsertab.openUrl(On);else throw"Not supported by the OIDC server"},redirectUri:function(On){return On&&On.redirectUri?On.redirectUri:o.redirectUri?o.redirectUri:"http://localhost"}};throw"invalid adapter type: "+dn}var Gt=function(){if(!(this instanceof Gt))return new Gt;localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test");var dn=this;function mn(){for(var yn=new Date().getTime(),pn=0;pn<localStorage.length;pn++){var In=localStorage.key(pn);if(In&&In.indexOf("kc-callback-")==0){var On=localStorage.getItem(In);if(On)try{var _n=JSON.parse(On).expires;(!_n||_n<yn)&&localStorage.removeItem(In)}catch{localStorage.removeItem(In)}}}}dn.get=function(yn){if(yn){var pn="kc-callback-"+yn,In=localStorage.getItem(pn);return In&&(localStorage.removeItem(pn),In=JSON.parse(In)),mn(),In}},dn.add=function(yn){mn();var pn="kc-callback-"+yn.state;yn.expires=new Date().getTime()+60*60*1e3,localStorage.setItem(pn,JSON.stringify(yn))}},fn=function(){if(!(this instanceof fn))return new fn;var dn=this;dn.get=function(In){if(In){var On=yn("kc-callback-"+In);if(pn("kc-callback-"+In,"",mn(-100)),On)return JSON.parse(On)}},dn.add=function(In){pn("kc-callback-"+In.state,JSON.stringify(In),mn(60))},dn.removeItem=function(In){pn(In,"",mn(-100))};var mn=function(In){var On=new Date;return On.setTime(On.getTime()+In*60*1e3),On},yn=function(In){for(var On=In+"=",_n=document.cookie.split(";"),Mn=0;Mn<_n.length;Mn++){for(var Nn=_n[Mn];Nn.charAt(0)==" ";)Nn=Nn.substring(1);if(Nn.indexOf(On)==0)return Nn.substring(On.length,Nn.length)}return""},pn=function(In,On,_n){var Mn=In+"="+On+"; expires="+_n.toUTCString()+"; ";document.cookie=Mn}};function Cn(){try{return new Gt}catch{}return new fn}function Tn(dn){return function(){o.enableLogging&&dn.apply(console,Array.prototype.slice.call(arguments))}}}function loginKeyCloakJS(){return new Promise((a,o)=>{const _e=new Keycloak({url:"https://idp.apizee.com/auth",realm:"APIZEE-POC-DGPN",clientId:"visio-assisted"});_e.init({onLoad:"login-required",checkLoginIframe:!1}).then(et=>{et?(console.log("Keycloak authenticated"),a(_e)):console.log("Keycloak NOT authenticated...")}).catch(et=>{console.error("Authenticated Failed",et),o(et)})})}const ROOM_THEME_OPTIONS={components:{MuiChip:{variants:[{props:{},style:{color:"#F7F7F8",backgroundColor:"#111313",borderRadius:"4px",opacity:"75%",":hover":{backgroundColor:"#1D1F20",opacity:"100%"}}}]},MuiCircularProgress:{variants:[{props:{},style:{color:"#F7F7F8"}}]},MuiIconButton:{variants:[{props:{},style:{padding:4,margin:2,color:"#F7F7F8",backgroundColor:"#111313",borderRadius:"4px",opacity:"75%",":hover":{backgroundColor:"#1D1F20",opacity:"100%"},":disabled":{color:"#7A8085",backgroundColor:"#CACCCE",opacity:"75%"}}}]},MuiSwitch:{styleOverrides:{colorPrimary:{"&.Mui-checked":{color:"#17821A"}},track:{".Mui-checked.Mui-checked + &":{backgroundColor:"#17821A"}}}}}},VIDEO_ROUNDED_CORNERS={borderRadius:"4px",overflow:"hidden"};function isInstanceOfTakeSnapshot(a){return typeof a!="object"?!1:"takeSnapshot"in a}function isInstanceOfSwitchFacingMode(a){return typeof a!="object"?!1:"switchFacingMode"in a}function isInstanceOfFileShared(a){return typeof a!="object"?!1:"fileShared"in a}function isInstanceOfHangup(a){return typeof a!="object"?!1:"hangUp"in a}const video_sizing={height:"100%",width:"100%"},COMPONENT_NAME="App";function App(a){var Pt,wt;const o=useThemeProps({props:a,name:`${COMPONENT_NAME}`}),{optInCGUPrefixText:_e="I agree to the ",optInCGULinkText:et="General Terms of Sale",optInCGUAriaLabel:rt="accept-terms-conditions",optInPrivacyPrefixText:lt="I agree to the ",optInPrivacyLinkText:it="Privacy Policy",optInPrivacyAriaLabel:ut="accept-privacy-policy",optInButtonText:s="Confirm",backButtonText:tt="Back",readyButtonText:ot="Enter",selectDeviceHelperText:ct="Please check what you want to share before entering the room.",hangedUpText:yt="The agent hanged up. Bye!"}=o,pt=useParams(),[gt]=useSearchParams(),[st,ft]=reactExports.useState(void 0),[at,ht]=reactExports.useState(!1),[mt,St]=reactExports.useState(void 0),[It,xt]=reactExports.useState(),[At,Nt]=reactExports.useState(void 0),[kt,Mt]=reactExports.useState(void 0),[bt,Bt]=reactExports.useState(0),Ht=()=>{Bt(Dt=>Dt+1)},Wt=()=>{Bt(Dt=>Dt-1)},nn=reactExports.useMemo(()=>bt>=1,[bt]),{value:gn,toggle:tn}=q(!1),[Gt,fn]=reactExports.useState(),[Cn,Tn]=reactExports.useState(!1),{session:dn,disconnect:mn}=y(st?{apiKey:st.apiKey}:void 0,st?{cloudUrl:st.cloudUrl?st.cloudUrl:"https://cloud.apirtc.com",groups:[st.conversation.name+"-guests"],userData:new apiRTC_minExports.UserData({firstName:st.user.firstName,lastName:st.user.lastName})}:void 0),{userMediaDevices:yn,selectedAudioIn:pn,setSelectedAudioIn:In,selectedVideoIn:On,setSelectedVideoIn:_n}=N(dn,isMobile_1?void 0:"apirtc-web-guest"),Mn=reactExports.useMemo(()=>st?st.streams.find(Dt=>Dt.type==="user-media"):void 0,[st]),Nn=reactExports.useMemo(()=>st?st.streams.find(Dt=>Dt.type==="display-media"):void 0,[st]);reactExports.useEffect(()=>{var Dt;if(Mn){const Et=(Dt=Mn.constraints)==null?void 0:Dt.video;Et instanceof Object&&Et.facingMode&&xt(Et.facingMode)}},[Mn]),reactExports.useEffect(()=>{isMobile_1&&(On&&_n(void 0),It==="environment"&&Wn(!0))},[It]);const wn=reactExports.useMemo(()=>{const Dt={...Mn==null?void 0:Mn.constraints};if(Dt!=null&&Dt.audio&&(At===void 0||At)){const Et=Dt.audio instanceof Object?{...Dt.audio}:{};pn&&(Et.deviceId=pn.id),Dt.audio=Et}else Dt.audio=!1;if(Dt!=null&&Dt.video&&(kt===void 0||kt)){const Et=Dt.video instanceof Object?{...Dt.video}:{};On?(Et.deviceId=On.id,delete Et.facingMode):It&&(Et.facingMode=It,delete Et.deviceId),Dt.video=Et}else Dt.video=!1;return globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|useMemo new_constraints`,Dt),Dt},[Mn,pn,On,It,At,kt]),{stream:Pn}=b(nn&&Mn?dn:void 0,{constraints:wn}),[Fn,ar]=reactExports.useState(),{conversation:Yn,leave:Xn}=d(dn,st?st.conversation.name:void 0,st?st.conversation.getOrCreateOptions:void 0,!0,st?st.conversation.joinOptions:void 0),{publishedStreams:tr,subscribedStreams:cn}=m(Yn,[...Pn&&gn?[{stream:Pn,options:Mn==null?void 0:Mn.publishOptions}]:[],...Fn?[{stream:Fn}]:[]]),Hn=reactExports.useCallback(Dt=>{Yn&&Yn.sendData(Dt).then(()=>{globalThis.logLevel.isDebugEnabled&&console.log(`${COMPONENT_NAME}|conversation sendData`,Dt)}).catch(Et=>{globalThis.logLevel.isWarnEnabled&&console.warn(`${COMPONENT_NAME}|conversation sendData error`,Et)})},[Yn]),Qn=()=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|shareScreen calls createDisplayMediaStream`),apiRTC_minExports.Stream.createDisplayMediaStream({},!1).then(Dt=>{globalThis.logLevel.isInfoEnabled&&console.info(`${COMPONENT_NAME}|createDisplayMediaStream`,Dt),ar(Dt)}).catch(Dt=>{console.error(`${COMPONENT_NAME}|createDisplayMediaStream error`,Dt)}).finally(()=>{})};reactExports.useEffect(()=>{if(Fn)return Fn.on("stopped",()=>{globalThis.logLevel.isInfoEnabled&&console.log(`${COMPONENT_NAME}|The user has ended sharing the screen`),ar(void 0)}),()=>{Fn.release()}},[Fn]);const{value:or,setValue:Wn,toggle:ir}=q(!1),nr=reactExports.useMemo(()=>cn.length===0?!0:or,[cn,or]),[xn,Un]=reactExports.useState({}),vn=async(Dt,Et)=>fetch(`https://is.dev.apizee.com/invitations/${Dt}`,{method:"GET",headers:{Authorization:`Bearer ${Et}`,"Content-Type":"application/json"}}).then(jt=>jt.status!==200?null:jt.json()).catch(jt=>{console.error(`${COMPONENT_NAME}|getInvitationData`,jt)});reactExports.useEffect(()=>{const Dt=Et=>{ft(void 0)};return window.addEventListener("beforeunload",Dt),()=>{window.removeEventListener("beforeunload",Dt)}},[]),reactExports.useEffect(()=>{if(pt.invitationData)try{const Dt=JSON.parse(base64Exports.decode(pt.invitationData));globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|InvitationData`,JSON.stringify(Dt)),ft(Dt)}catch(Dt){if(Dt instanceof SyntaxError){const Et=pt.invitationData;loginKeyCloakJS().then(jt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|keycloak.token`,jt.token),vn(Et).then(Yt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|getInvitationData`,Et,Yt),ft(Yt)})}).catch(jt=>{console.error(`${COMPONENT_NAME}|loginKeyCloakJS error`,jt)})}}},[pt.invitationData]),reactExports.useEffect(()=>{var Dt,Et;Nt(!!((Dt=st==null?void 0:st.streams[0].constraints)!=null&&Dt.audio)),Mt(!!((Et=st==null?void 0:st.streams[0].constraints)!=null&&Et.video))},[st]),reactExports.useEffect(()=>{const Dt=gt.get("i");if(Dt)try{const Et=JSON.parse(base64Exports.decode(Dt));globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|InvitationData`,JSON.stringify(Et)),ft(Et)}catch(Et){if(Et instanceof SyntaxError){vn(Dt).then(jt=>{globalThis.logLevel.isInfoEnabled&&console.info(`${COMPONENT_NAME}|getInvitationData`,Dt,jt),ft(jt.data)});return}else console.error(`${COMPONENT_NAME}|parsing i search parameter error`,Et),ht(!0)}},[gt]),reactExports.useEffect(()=>{if(dn){const Dt=dn.getUserAgent(),Et=new uaParserExports.UAParser;globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|UAParser`,Et.getResult());const jt=Dt.getUserData();jt.setToSession(),jt.setProp("systemInfo",JSON.stringify(Et.getResult())),Dt.setUserData(jt)}},[dn]),reactExports.useEffect(()=>{if(dn&&Pn){const Dt=Et=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|onContactData`,Et);const jt=Et.sender,Yt=Et.content;isInstanceOfTakeSnapshot(Yt)?Pn.takeSnapshot(Yt.takeSnapshot).then(en=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|takeSnapshot of`,Pn,en),jt.sendFile({name:`snapshot_${new Date().toISOString()}.png`,type:"image/png"},en).on("statusChange",rn=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|statusChange`,rn)})}).catch(en=>{globalThis.logLevel.isWarnEnabled&&console.warn(`${COMPONENT_NAME}|takeSnapshot error`,en)}):isInstanceOfSwitchFacingMode(Yt)&&(globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|SwitchFacingMode`),xt(en=>en==="user"?"environment":"user"))};return dn.on("contactData",Dt),()=>{dn.removeListener("contactData",Dt)}}},[dn,Pn]),reactExports.useEffect(()=>{if(Yn){const Dt=Et=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|Conversation onData`,Et);const jt=Et.content;isInstanceOfFileShared(jt)?(globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|fileShared`,jt),fetch(jt.fileShared.link,{method:"get",mode:"cors",headers:new Headers({Authorization:"Bearer "+jt.fileShared.jwt})}).then(Yt=>Yt.blob()).then(Yt=>{const en=window.URL.createObjectURL(Yt);fn(en)}).catch(Yt=>{console.error(`${COMPONENT_NAME}|fetch error`,jt.fileShared.link,Yt)})):isInstanceOfHangup(jt)&&(Yn.leave().then().catch(Yt=>{globalThis.logLevel.isWarnEnabled&&console.warn(`${COMPONENT_NAME}|conversation leave error`,Yt)}).finally(()=>{mn()}),Tn(!0))};return Yn.on("data",Dt),()=>{Yn.removeListener("data",Dt)}}},[Yn,mn]),reactExports.useEffect(()=>{if(Yn){const Dt=jt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|pointerSharingEnabled`,jt)};Yn.on("pointerSharingEnabled",Dt);const Et=jt=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|pointerLocationChanged`,jt),Un(Yt=>({...Yt,[jt.source.contactId]:jt.data})),setTimeout(()=>{Un(Yt=>(delete Yt[jt.source.contactId],{pointer:Yt}))},3e3)};return Yn.on("pointerLocationChanged",Et),Yn.enablePointerSharing(!0),()=>{Yn.removeListener("pointerSharingEnabled",Dt),Yn.removeListener("pointerLocationChanged",Et)}}},[Yn]);const kn=reactExports.useCallback((Dt,Et)=>{globalThis.logLevel.isDebugEnabled&&console.debug(`${COMPONENT_NAME}|onStreamMouseDown`,Dt.getId(),Et),Yn&&Yn.sendPointerLocation({streamId:Dt.getId(),contactId:Dt.getContact()?Dt.getContact().getId():apiRTC.userAgentInstance.userId},0,0,{top:`${Math.round(Et.nativeEvent.offsetY*100/Et.nativeEvent.target.offsetHeight)}%`,left:`${Math.round(Et.nativeEvent.offsetX*100/Et.nativeEvent.target.offsetWidth)}%`})},[Yn]);reactExports.useEffect(()=>{st&&fetch(st.cloudUrl).then(Dt=>{Dt.status===404?(ht(!0),St(404)):Dt.status===401?(ht(!0),St(401)):Dt.status===500&&(ht(!0),St(500))}).catch(Dt=>{ht(!0)})},[st]),reactExports.useEffect(()=>{nn&&Hn({type:"timeline-event",event:"opt-in-accepted"})},[Hn,nn]),reactExports.useEffect(()=>{Pn&&Hn({type:"timeline-event",event:"camera-stream-grabbed"})},[Hn,Pn]),reactExports.useEffect(()=>{gn&&Hn({type:"timeline-event",event:"enter-room"})},[Hn,gn]);const qt=Dt=>{var Yt,en;const Et=(Yt=Dt.getContact())==null?void 0:Yt.getUserData().get("firstName"),jt=(en=Dt.getContact())==null?void 0:en.getUserData().get("lastName");if(!(!Et&&!jt))return`${Et??""} ${jt??""}`},Rt=!nr&&cn.length<=2?"large":void 0,nt=cn.map((Dt,Et)=>jsxRuntimeExports.jsx(K,{id:"subscribed-stream-"+Et,sx:{...Dt.hasVideo()?video_sizing:{backgroundColor:"grey"}},stream:Dt,name:qt(Dt),controls:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(_$1,{size:Rt}),jsxRuntimeExports.jsx(j,{size:Rt,disabled:!0}),jsxRuntimeExports.jsx(Z,{size:Rt,disabled:!0})]}),children:Dt.hasVideo()?jsxRuntimeExports.jsx(X,{sx:video_sizing,style:{...video_sizing,objectFit:xn[Dt.getContact().getId()]?"fill":"cover",...VIDEO_ROUNDED_CORNERS},pointer:xn[Dt.getContact().getId()],onMouseDown:jt=>{kn(Dt,jt)}}):jsxRuntimeExports.jsx(F,{})},Et)),vt=nr&&tr.length<=2?"large":void 0,Tt=tr.map((Dt,Et)=>jsxRuntimeExports.jsx(K,{id:"published-stream-"+Et,sx:{...Dt.hasVideo()?video_sizing:{backgroundColor:"grey"}},stream:Dt,muted:!0,controls:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(j,{size:vt}),jsxRuntimeExports.jsx(Z,{size:vt})]}),children:Dt.hasVideo()?jsxRuntimeExports.jsx(X,{sx:video_sizing,style:{...video_sizing,objectFit:xn[apiRTC.userAgentInstance.userId]?"fill":"cover",...VIDEO_ROUNDED_CORNERS},pointer:xn[apiRTC.userAgentInstance.userId],onMouseDown:jt=>{kn(Dt,jt)}}):jsxRuntimeExports.jsx(F,{})},Et));return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[!dn&&!at&&jsxRuntimeExports.jsx(Box$1,{display:"flex",alignItems:"center",justifyContent:"center",sx:{mt:5},children:jsxRuntimeExports.jsx("img",{height:"320px",width:"320px",src:logo,alt:"logo"})}),at&&jsxRuntimeExports.jsx(ErrorPage,{errorType:mt}),dn&&!at&&!gn&&jsxRuntimeExports.jsx(Container$1,{maxWidth:"sm",sx:{height:"100vh"},children:jsxRuntimeExports.jsx(Box$1,{sx:{height:"100%"},display:"flex",alignItems:"center",justifyContent:"center",children:jsxRuntimeExports.jsx(Card$1,{children:jsxRuntimeExports.jsx(CardContent$1,{children:jsxRuntimeExports.jsxs(TextStepper,{activeStep:bt,header:jsxRuntimeExports.jsx("img",{src:logo,alt:"Apizee Logo",height:24}),children:[jsxRuntimeExports.jsx(Step$1,{children:jsxRuntimeExports.jsx(OptInList,{optIns:[{id:"CGU",labels:{aria:rt,prefix:_e,link:et},link:navigator.language==="fr"||navigator.language==="fr-FR"?"https://cloud.apizee.com/attachments/b87662d7-3e82-4519-a4db-9fb6ba67b5cc/Apizee-ConditionsGeneralesUtilisation.pdf":"https://cloud.apizee.com/attachments/cb744e03-182b-453e-bbdf-0d89cf42e182/Apizee-TermsOfUse.pdf"},{id:"Privacy",labels:{aria:ut,prefix:lt,link:it},link:navigator.language==="fr"||navigator.language==="fr-FR"?"https://cloud.apizee.com/attachments/f87493b0-483e-4723-a3ee-02d59a501b1c/Apizee-PolitiqueConfidentialite.pdf":"https://cloud.apizee.com/attachments/ae61f778-16d1-4dd4-baa1-cd1ba568a0d6/Apizee-PrivacyPolicy.pdf"}],labels:{submit:s},onSubmit:Ht})},"legal"),jsxRuntimeExports.jsxs(Step$1,{children:[Mn&&jsxRuntimeExports.jsxs(Stack$1,{sx:{mt:1},direction:{xs:"column"},alignItems:"center",justifyContent:"center",useFlexGap:!0,flexWrap:"wrap",spacing:1,children:[jsxRuntimeExports.jsx(Box$1,{sx:{width:"100%",paddingTop:"75%",position:"relative","& .MuiBox-root":{position:"absolute",height:"100%",maxWidth:"100%"}},children:Pn?jsxRuntimeExports.jsx(K,{sx:{top:0,left:0,bottom:0,right:0,maxWidth:{xs:"100%",sm:"100%"},...!Pn.hasVideo()&&{position:"absolute",inset:0,borderRadius:"4px",backgroundColor:"#CACCCE"}},stream:Pn,muted:!0,children:Pn.hasVideo()?jsxRuntimeExports.jsx(X,{style:{height:"100%",...VIDEO_ROUNDED_CORNERS},"data-testid":"local-video"}):jsxRuntimeExports.jsx(F,{"data-testid":"local-audio"})}):jsxRuntimeExports.jsx(Skeleton$1,{variant:"rectangular",width:"100%",height:"100%",sx:{position:"absolute",top:0,left:0}})}),jsxRuntimeExports.jsxs(Box$1,{sx:{minWidth:"120px",width:"100%",display:"flex"},children:[jsxRuntimeExports.jsx(Button$1,{sx:{minWidth:0,width:"3em",height:"3em",display:"flex",justifyContent:"center",alignItems:"center",border:"solid 1px rgba(0, 0, 0, 0.23)",borderRadius:"4px",boxSizing:"border-box",flexShrink:0,color:"black"},disabled:!((Pt=st==null?void 0:st.streams[0].constraints)!=null&&Pt.audio),onClick:()=>Nt(!At),children:jsxRuntimeExports.jsx(Icon$1,{children:wn.audio?"mic_on":"mic_off"})}),jsxRuntimeExports.jsx(C,{sx:{marginLeft:"0.25em",minWidth:"120px",flexGrow:"1"},id:"audio-in",size:"small",disabled:!wn.audio,devices:yn.audioinput,selectedDevice:pn,setSelectedDevice:In})]}),jsxRuntimeExports.jsxs(Box$1,{sx:{minWidth:"120px",width:"100%",display:"flex"},children:[jsxRuntimeExports.jsx(Button$1,{sx:{minWidth:0,width:"3em",height:"3em",display:"flex",justifyContent:"center",alignItems:"center",border:"solid 1px rgba(0, 0, 0, 0.23)",borderRadius:"4px",boxSizing:"border-box",flexShrink:0,color:"black"},disabled:!((wt=st==null?void 0:st.streams[0].constraints)!=null&&wt.video),onClick:()=>{Mt(!kt)},children:jsxRuntimeExports.jsx(Icon$1,{children:wn.video?"videocam_on":"videocam_off"})}),jsxRuntimeExports.jsx(C,{sx:{marginLeft:"0.25em",minWidth:"120px",flexGrow:"1"},id:"video-in",size:"small",disabled:!wn.video,devices:yn.videoinput,selectedDevice:On,setSelectedDevice:_n})]})]}),Nn&&jsxRuntimeExports.jsx(Box$1,{sx:{display:"flex",justifyContent:"center",mt:1},children:jsxRuntimeExports.jsx(Button$1,{variant:"outlined",color:"primary",onClick:Qn,children:"share screen"})}),jsxRuntimeExports.jsx(Typography$1,{sx:{mt:1},children:ct}),jsxRuntimeExports.jsxs(Box$1,{sx:{display:"flex",justifyContent:"end",mt:1},children:[jsxRuntimeExports.jsx(Button$1,{onClick:Wt,children:tt}),jsxRuntimeExports.jsx(Button$1,{variant:"outlined",disabled:Nn&&!Fn,onClick:tn,children:ot})]})]},"device-selection")]})})})})}),Yn&&gn&&jsxRuntimeExports.jsxs(Box$1,{sx:{position:"relative",height:"99vh",width:"100vw",maxWidth:"100%"},children:[jsxRuntimeExports.jsx(S$1,{sx:{height:"100%",width:"100%"},children:nr?Tt:nt}),jsxRuntimeExports.jsx(S$1,{sx:{position:"absolute",bottom:4,left:4,opacity:.9,height:"34%",width:{xs:"50%",sm:"40%",md:"30%",lg:"20%"}},onClick:ir,children:nr?nt:Tt})]}),Gt&&jsxRuntimeExports.jsx("img",{src:Gt,alt:"sharedImg"}),Cn&&jsxRuntimeExports.jsx(Container$1,{maxWidth:"md",children:jsxRuntimeExports.jsx(Alert$1,{severity:"info",children:yt})})]})}const index="",frFR={components:{App:{defaultProps:{acceptTitleText:"Documents lgaux",optInCGUPrefixText:"J'accepte les ",optInCGULinkText:"Conditions gnrales d'utilisation",optInCGUAriaLabel:"conditions-gnrales",optInPrivacyPrefixText:"J'accepte la ",optInPrivacyLinkText:"Politique de confidentialit",optInPrivacyAriaLabel:"politique-confidentialit",optInButtonText:"Confirmer",backButtonText:"Retour",readyButtonText:"Entrer en communication",selectDeviceText:"Slection de priphriques",selectDeviceHelperText:"Avant d'entrer en communication, vrifiez ce que vous partagerez avec votre interlocuteur.",hangedUpText:"L'agent a raccroch."}}}},DEBUG={level:"debug",isDebugEnabled:!0,isInfoEnabled:!0,isWarnEnabled:!0},INFO={level:"info",isDebugEnabled:!1,isInfoEnabled:!0,isWarnEnabled:!0},WARN={level:"warn",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!0},ERROR={level:"error",isDebugEnabled:!1,isInfoEnabled:!1,isWarnEnabled:!1};function setLogLevel(a){switch(a){case"debug":globalThis.logLevel=DEBUG;break;case"info":globalThis.logLevel=INFO;break;case"warn":globalThis.logLevel=WARN;break;case"error":globalThis.logLevel=ERROR;break;default:globalThis.logLevel=INFO}}const logLevel="debug";setLogLevel(logLevel);A(logLevel);te(logLevel);function getLangFiles(){switch(navigator.language){case"fr":case"fr-FR":return[frFR,$];default:return[]}}document.documentElement.setAttribute("lang",navigator.language.slice(0,2));const theme=createTheme({palette:{mode:"light",primary:{main:"#F76B40",light:"#ba3108",dark:"#f88562"},secondary:{main:"#5b5baf",light:"#8eabc7",dark:"#2e455c"},success:{main:"#0F5712",light:"#17821A",dark:"#0A340B"},info:{main:"#1355AE"},neutral:{main:"rgba(0, 0, 0, 0.23)"}},typography:{button:{textTransform:"none"}},...ROOM_THEME_OPTIONS},...getLangFiles()),container=document.getElementById("root");container&&createRoot(container).render(jsxRuntimeExports.jsx(ThemeProvider,{theme,children:jsxRuntimeExports.jsx(BrowserRouter,{basename:"/web-assisted",children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(App,{})}),jsxRuntimeExports.jsx(Route,{path:"/:invitationData",element:jsxRuntimeExports.jsx(App,{})})]})})}));
